{"version":3,"sources":["webpack:///./src/ObjLoaderMasterChief.ts"],"names":[],"mappings":"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","file":"js/ObjLoaderMasterChief.js","sourcesContent":["import {BitmapImage2D, Sampler2D} from \"awayjs-full/lib/graphics\";\nimport {LoaderEvent, Vector3D, AssetLibrary, Loader, IAsset, URLRequest, Debug, RequestAnimationFrame} from \"awayjs-full/lib/core\";\nimport {Sprite, DisplayObjectContainer, DirectionalLight, StaticLightPicker} from \"awayjs-full/lib/scene\";\nimport {MethodMaterial} from \"awayjs-full/lib/materials\";\nimport {OBJParser} from \"awayjs-full/lib/parsers\";\nimport {View} from \"awayjs-full/lib/view\";\n\nclass ObjLoaderMasterChief\n{\n\tprivate view:View;\n\tprivate raf:RequestAnimationFrame;\n\tprivate sprites:Array<Sprite> = new Array<Sprite>();\n\tprivate mat:MethodMaterial;\n\n\tprivate terrainMaterial:MethodMaterial;\n\n\tprivate light:DirectionalLight;\n\n\tprivate spartan:DisplayObjectContainer = new DisplayObjectContainer();\n\tprivate terrain:Sprite;\n\n\tconstructor()\n\t{\n\t\tDebug.LOG_PI_ERRORS = false;\n\t\tDebug.THROW_ERRORS = false;\n\n\t\tthis.view = new View();\n\t\tthis.view.camera.z = -50;\n\t\tthis.view.camera.y = 20;\n\t\tthis.view.camera.projection.near = 0.1;\n\t\tthis.view.backgroundColor = 0xCEC8C6;\n\n\t\tthis.raf = new RequestAnimationFrame(this.render, this);\n\n\t\tthis.light = new DirectionalLight();\n\t\tthis.light.color = 0xc1582d;\n\t\tthis.light.direction = new Vector3D(1, 0, 0);\n\t\tthis.light.ambient = 0.4;\n\t\tthis.light.ambientColor = 0x85b2cd;\n\t\tthis.light.diffuse = 2.8;\n\t\tthis.light.specular = 1.8;\n\t\tthis.view.scene.addChild(this.light);\n\n\t\tthis.spartan.transform.scaleTo(.25, .25, .25);\n\t\tthis.spartan.y = 0;\n\t\tthis.view.scene.addChild(this.spartan);\n\n\t\tAssetLibrary.enableParser(OBJParser);\n\n\t\tvar session:Loader;\n\t\t\n\t\tsession = AssetLibrary.getLoader();\n\t\tsession.addEventListener(LoaderEvent.LOAD_COMPLETE, (event:LoaderEvent) => this.onResourceComplete(event));\n\t\tsession.load(new URLRequest('assets/Halo_3_SPARTAN4.obj'));\n\n\t\tsession = AssetLibrary.getLoader();\n\t\tsession.addEventListener(LoaderEvent.LOAD_COMPLETE, (event:LoaderEvent) => this.onResourceComplete(event));\n\t\tsession.load(new URLRequest('assets/terrain.obj'));\n\n\t\tsession = AssetLibrary.getLoader();\n\t\tsession.addEventListener(LoaderEvent.LOAD_COMPLETE, (event:LoaderEvent) => this.onResourceComplete(event));\n\t\tsession.load(new URLRequest('assets/masterchief_base.png'));\n\n\t\tsession = AssetLibrary.getLoader();\n\t\tsession.addEventListener(LoaderEvent.LOAD_COMPLETE, (event:LoaderEvent) => this.onResourceComplete(event));\n\t\tsession.load(new URLRequest('assets/stone_tx.jpg'));\n\n\t\twindow.onresize = (event:UIEvent) => this.onResize();\n\n\t\tthis.raf.start();\n\t}\n\n\tprivate render()\n\t{\n\t\tif ( this.terrain)\n\t\t\tthis.terrain.rotationY += 0.4;\n\n\t\tthis.spartan.rotationY += 0.4;\n\t\tthis.view.render();\n\t}\n\n\tprivate spartanFlag    :boolean = false;\n\n\tpublic onResourceComplete (event:LoaderEvent)\n\t{\n\t\tvar loader:Loader = <Loader> event.target;\n\t\tvar l:number = loader.baseDependency.assets.length;\n\n\t\tconsole.log( '------------------------------------------------------------------------------');\n\t\tconsole.log( 'away.events.LoaderEvent.LOAD_COMPLETE' , event , l , loader );\n\t\tconsole.log( '------------------------------------------------------------------------------');\n\n\t\tvar loader:Loader = <Loader> event.target;\n\t\tvar l:number = loader.baseDependency.assets.length;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\n\t\t\tvar d:IAsset = loader.baseDependency.assets[c];\n\n\t\t\tconsole.log( d.name , event.url);\n\n\t\t\tswitch (d.assetType) {\n\t\t\t\tcase  Sprite.assetType:\n\t\t\t\t\tif (event.url =='assets/Halo_3_SPARTAN4.obj') {\n\t\t\t\t\t\tvar sprite:Sprite = <Sprite> d;\n\n\t\t\t\t\t\tthis.spartan.addChild(sprite);\n\t\t\t\t\t\tthis.spartanFlag = true;\n\t\t\t\t\t\tthis.sprites.push(sprite);\n\t\t\t\t\t} else if (event.url =='assets/terrain.obj') {\n\t\t\t\t\t\tthis.terrain = <Sprite> d;\n\t\t\t\t\t\tthis.terrain.y = 98;\n\t\t\t\t\t\tthis.terrain.graphics.scaleUV(20, 20);\n\t\t\t\t\t\tthis.view.scene.addChild(this.terrain);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase BitmapImage2D.assetType :\n\t\t\t\t\tif (event.url == 'assets/masterchief_base.png' ) {\n\t\t\t\t\t\tthis.mat = new MethodMaterial(<BitmapImage2D> d);\n\t\t\t\t\t\tthis.mat.style.sampler = new Sampler2D(true, true, false);\n\t\t\t\t\t\tthis.mat.lightPicker = new StaticLightPicker([this.light]);\n\t\t\t\t\t} else if (event.url == 'assets/stone_tx.jpg') {\n\t\t\t\t\t\tthis.terrainMaterial = new MethodMaterial(<BitmapImage2D> d);\n\t\t\t\t\t\tthis.terrainMaterial.style.sampler = new Sampler2D(true, true, false);\n\t\t\t\t\t\tthis.terrainMaterial.lightPicker = new StaticLightPicker([this.light]);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.terrain && this.terrainMaterial)\n\t\t\tthis.terrain.material = this.terrainMaterial;\n\n\t\tif (this.mat && this.spartanFlag)\n\t\t\tfor (var c:number = 0; c < this.sprites.length; c++)\n\t\t\t\tthis.sprites[c].material = this.mat;\n\n\t\tthis.onResize();\n\t}\n\n\tpublic onResize(event:UIEvent = null)\n\t{\n\t\tthis.view.y = 0;\n\t\tthis.view.x = 0;\n\n\t\tthis.view.width = window.innerWidth;\n\t\tthis.view.height = window.innerHeight;\n\t}\n}\n\nwindow.onload = function ()\n{\n\tnew ObjLoaderMasterChief(); // Start the demo\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ObjLoaderMasterChief.ts"],"sourceRoot":""}
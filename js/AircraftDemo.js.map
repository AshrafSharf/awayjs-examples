{"version":3,"sources":["webpack:///./src/AircraftDemo.ts"],"names":[],"mappings":"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","file":"js/AircraftDemo.js","sourcesContent":["import {LoaderEvent, Matrix, Vector3D, AssetLibrary, IAsset, Loader, URLRequest, Debug, RequestAnimationFrame} from \"awayjs-full/lib/core\";\nimport {BitmapImage2D, BitmapImageCube, Sampler2D, Style, Single2DTexture, SingleCubeTexture, ElementsType} from \"awayjs-full/lib/graphics\";\nimport {Sprite, Skybox, DirectionalLight, DisplayObjectContainer, StaticLightPicker, PrimitivePlanePrefab} from \"awayjs-full/lib/scene\";\nimport {MethodMaterial, EffectEnvMapMethod, NormalSimpleWaterMethod, SpecularFresnelMethod}\tfrom \"awayjs-full/lib/materials\";\nimport {OBJParser} from \"awayjs-full/lib/parsers\";\nimport {View} from \"awayjs-full/lib/view\";\n\nclass AircraftDemo\n{\n\t//{ state\n\tprivate _maxStates:number = 2;\n\tprivate _cameraIncrement:number = 0;\n\tprivate _rollIncrement:number = 0;\n\tprivate _loopIncrement:number = 0;\n\tprivate _state:number = 0;\n\tprivate _appTime:number = 0;\n\t//}\n\t\n\tprivate _lightPicker:StaticLightPicker;\n\tprivate _view:View;\n\tprivate _timer:RequestAnimationFrame;\n\t\n\t//{ sea\n\tprivate _seaGeom:PrimitivePlanePrefab;\n\tprivate _seaSprite:Sprite;\n\tprivate _seaNormalImage:BitmapImage2D;\n\tprivate _seaInitialized:boolean = false;\n\tprivate _seaMaterial:MethodMaterial;\n\t//}\n\t\n\t//{ f14\n\tprivate _f14Geom:DisplayObjectContainer;\n\tprivate _f14Initialized:boolean = false;\n\t//}\n\t\n\t//{ skybox\n\tprivate _waterMethod:NormalSimpleWaterMethod;\n\tprivate _skyboxImageCube:BitmapImageCube;\n\tprivate _skyboxInitialized:boolean = false;\n\t//}\n\t\n\tconstructor()\n\t{\n\t\tDebug.LOG_PI_ERRORS = false;\n\t\tDebug.THROW_ERRORS = false;\n\t\t\n\t\tthis.initView();\n\t\tthis.initLights();\n\t\tthis.initAnimation();\n\t\tthis.initParsers();\n\t\tthis.loadAssets();\n\t\t\n\t\twindow.onresize = (event:UIEvent) => this.onResize(event);\n\t}\n\t\n\tprivate loadAssets()\n\t{\n\t\tthis.loadAsset('assets/sea_normals.jpg');\n\t\tthis.loadAsset('assets/f14/f14d.obj');\n\t\tthis.loadAsset('assets/skybox/CubeTextureTest.cube');\n\t}\n\t\n\tprivate loadAsset(path:string)\n\t{\n\t\tvar session:Loader = AssetLibrary.getLoader();\n\t\tsession.addEventListener(LoaderEvent.LOAD_COMPLETE, (event:LoaderEvent) => this.onResourceComplete(event));\n\t\tsession.load(new URLRequest(path));\n\t}\n\t\n\tprivate initParsers()\n\t{\n\t\tAssetLibrary.enableParser(OBJParser);\n\t}\n\t\n\tprivate initAnimation()\n\t{\n\t\tthis._timer = new RequestAnimationFrame( this.render, this );\n\t}\n\n\tprivate initView()\n\t{\n\t\tthis._view = new View();\n\t\tthis._view.camera.z\t= -500;\n\t\tthis._view.camera.y\t= 250;\n\t\tthis._view.camera.rotationX\t= 20;\n\t\tthis._view.camera.projection.near = 0.5;\n\t\tthis._view.camera.projection.far = 14000;\n\t\tthis._view.backgroundColor = 0x2c2c32;\n\n\t\tthis.onResize();\n\t}\n\t\n\tprivate initializeScene()\n\t{\n\t\tif(this._skyboxImageCube && this._f14Geom && this._seaNormalImage) {\n\t\t\tthis.initF14();\n\t\t\tthis.initSea();\n\t\t\tthis._timer.start();\n\t\t}\n\t}\n\t\n\tprivate initLights()\n\t{\n\t\tvar light:DirectionalLight = new DirectionalLight();\n\t\tlight.color\t= 0x974523;\n\t\tlight.direction\t= new Vector3D(-300, -300, -5000);\n\t\tlight.ambient = 1;\n\t\tlight.ambientColor = 0x7196ac;\n\t\tlight.diffuse = 1.2;\n\t\tlight.specular = 1.1;\n\t\tthis._view.scene.addChild(light);\n\t\t\n\t\tthis._lightPicker = new StaticLightPicker([light]);\n\t}\n\t\n\tprivate initF14()\n\t{\n\t\tthis._f14Initialized = true;\n\t\t\n\t\tvar f14Material: MethodMaterial = new MethodMaterial(this._seaNormalImage); // will be the cubemap\n\t\tf14Material.style.sampler = new Sampler2D(true, true, false);\n\t\tf14Material.lightPicker = this._lightPicker;\n\t\t\n\t\tthis._view.scene.addChild(this._f14Geom);\n\t\tthis._f14Geom.transform.scaleTo(20, 20, 20);\n\t\tthis._f14Geom.rotationX = 90;\n\t\tthis._f14Geom.y = 200;\n\t\tthis._view.camera.lookAt(this._f14Geom.transform.position);\n\t\t\n\t\tdocument.onmousedown = (event:MouseEvent) => this.onMouseDown(event);\n\t}\n\n\tprivate initSea()\n\t{\n\t\tthis._seaMaterial = new MethodMaterial(this._seaNormalImage); // will be the cubemap\n\t\tthis._seaMaterial.style.sampler = new Sampler2D(true, true, false)\n\t\tthis._waterMethod = new NormalSimpleWaterMethod(new Single2DTexture(this._seaNormalImage), new Single2DTexture(this._seaNormalImage));\n\t\tvar fresnelMethod:SpecularFresnelMethod  = new SpecularFresnelMethod();\n\t\tfresnelMethod.normalReflectance = .3;\n\t\tfresnelMethod.gloss = 10;\n\t\tfresnelMethod.strength = 1;\n\t\t\n\t\tthis._seaMaterial.alphaBlending = true;\n\t\tthis._seaMaterial.lightPicker = this._lightPicker;\n\t\tthis._seaMaterial.style.sampler = new Sampler2D(true);\n\t\tthis._seaMaterial.animateUVs = true;\n\t\tthis._seaMaterial.normalMethod = this._waterMethod ;\n\t\tthis._seaMaterial.addEffectMethod(new EffectEnvMapMethod(new SingleCubeTexture(this._skyboxImageCube)));\n\t\tthis._seaMaterial.specularMethod = fresnelMethod;\n\t\t\n\t\tthis._seaGeom = new PrimitivePlanePrefab(this._seaMaterial, ElementsType.TRIANGLE, 50000, 50000, 1, 1, true, false );\n\t\tthis._seaSprite = <Sprite> this._seaGeom.getNewObject();\n\t\tthis._seaSprite.graphics.scaleUV( 100, 100 );\n\t\tthis._seaSprite.style = new Style();\n\t\tthis._seaSprite.style.uvMatrix = new Matrix();\n\t\tthis._view.scene.addChild( new Skybox(this._skyboxImageCube));\n\t\tthis._view.scene.addChild( this._seaSprite );\n\t}\n\t\n\tpublic onResourceComplete(event:LoaderEvent)\n\t{\n\t\tvar loader:Loader = event.target;\n\t\tvar numAssets:number = loader.baseDependency.assets.length;\n\t\tvar i:number = 0;\n\t\t\n\t\tswitch (event.url) {\n\t\t\tcase \"assets/sea_normals.jpg\":\n\t\t\t\tthis._seaNormalImage = <BitmapImage2D> loader.baseDependency.assets[0];\n\t\t\t\tbreak;\n\t\t\tcase 'assets/f14/f14d.obj':\n\t\t\t\tthis._f14Geom = new DisplayObjectContainer();\n\t\t\t\tfor (i = 0; i < numAssets; ++i) {\n\t\t\t\t\tvar asset:IAsset = loader.baseDependency.assets[i];\n\t\t\t\t\tswitch (asset.assetType) {\n\t\t\t\t\t\tcase Sprite.assetType:\n\t\t\t\t\t\t\tvar sprite:Sprite = <Sprite> asset;\n\t\t\t\t\t\t\tthis._f14Geom.addChild(sprite);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'assets/skybox/CubeTextureTest.cube':\n\t\t\t\tthis._skyboxImageCube = <BitmapImageCube> loader.baseDependency.assets[0];\n\t\t\t\tbreak;\n\t\t}\n\t\t\n\t\tthis.initializeScene();\n\t}\n\t\n\tprivate render(dt:number) //animate based on dt for firefox\n\t{\n\t\tif (this._f14Geom) {\n\t\t\tthis._rollIncrement += 0.02;\n\t\t\t\n\t\t\tswitch (this._state) {\n\t\t\t\tcase 0 :\n\t\t\t\t\tthis._f14Geom.rotationZ = Math.sin(this._rollIncrement)*25;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1 :\n\t\t\t\t\tthis._loopIncrement += 0.05;\n\t\t\t\t\tthis._f14Geom.z += Math.cos(this._loopIncrement)*20;\n\t\t\t\t\tthis._f14Geom.y += Math.sin(this._loopIncrement)*20;\n\t\t\t\t\tthis._f14Geom.rotationX += -1*((Math.PI/180)*Math.atan2(this._f14Geom.z, this._f14Geom.y));//* 20;\n\t\t\t\t\tthis._f14Geom.rotationZ = Math.sin(this._rollIncrement)*25;\n\t\t\t\t\t\n\t\t\t\t\tif (this._loopIncrement > (Math.PI*2)) {\n\t\t\t\t\t\tthis._loopIncrement = 0;\n\t\t\t\t\t\tthis._state = 0;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (this._f14Geom) {\n\t\t\tthis._view.camera.lookAt(this._f14Geom.transform.position);\n\t\t}\n\t\t\n\t\tif (this._view.camera) {\n\t\t\tthis._cameraIncrement += 0.01;\n\t\t\tthis._view.camera.x = Math.cos(this._cameraIncrement)*400;\n\t\t\tthis._view.camera.z = Math.sin(this._cameraIncrement)*400;\n\t\t}\n\t\t\n\t\tif ( this._f14Geom ) {\n\t\t\tthis._view.camera.lookAt(this._f14Geom.transform.position);\n\t\t}\n\t\t\n\t\tif (this._seaMaterial) {\n\t\t\tthis._seaSprite.style.uvMatrix.ty -= 0.04;\n\t\t\t\n\t\t\t/*\n\t\t\t this.waterMethod.water1OffsetX += .001;\n\t\t\t this.waterMethod.water1OffsetY += .1;\n\t\t\t this.waterMethod.water2OffsetX += .0007;\n\t\t\t this.waterMethod.water2OffsetY += .6;\n\t\t\t //*/\n\t\t}\n\t\t\n\t\tthis._appTime += dt;\n\t\tthis._view.render();\n\t}\n\t\n\tpublic onResize(event:UIEvent = null)\n\t{\n\t\tthis._view.y = 0;\n\t\tthis._view.x = 0;\n\t\tthis._view.width = window.innerWidth;\n\t\tthis._view.height = window.innerHeight;\n\t}\n\t\n\tprivate onMouseDown(event:MouseEvent)\n\t{\n\t\tthis._state++;\n\t\t\n\t\tif (this._state >= this._maxStates)\n\t\t\tthis._state = 0;\n\t}\n}\n\nwindow.onload = function ()\n{\n\tnew AircraftDemo();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/AircraftDemo.ts"],"sourceRoot":""}
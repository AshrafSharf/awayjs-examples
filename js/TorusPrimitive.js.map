{"version":3,"sources":["webpack:///./src/TorusPrimitive.ts"],"names":[],"mappings":";;;;;;;;;;;AAAoI;AACvD;AAC2B;AAC/C;AACf;AAE1C;AAWC;AAAA,oBAWC;AATI,aAAY;AAEZ,aAAK,OAAG,IAAyB,4EAAK,KAAO,QAAQ;AACrD,aAAK,KAAS;AAEd,aAAiB;AACf,eAAS,WAAG,UAAc;AAAK,mBAAI,MAAS,SAAO;AAAC;AAEtD,aACL;AAAC;AAIE;;;AACK,6BAAQ,WAAhB;AAEK,aAAM,QAAG,IAAW,8DAAyB;AAC7C,aAAM,MAAgB,kBAAY,UACvC;AAAC;AAIE;;;AACK,6BAAa,gBAArB;AAAA,oBAMC;AAJA,YAAa,YAAa,IAAgB;AACjC,kBAAW,aAAsB,0EAAM;AACvC,kBAAiB,iBAAe,qEAAc,eAAE,UAAqB;AAAK,mBAAI,MAAmB,mBAAO;AAAE;AAC1G,kBAAK,KAAC,IAAc,iEAC9B;AAAC;AAKE;;;;AACK,6BAAkB,qBAA1B,UAAgD;AAAhD,oBAIC;AAFI,aAAO,SAAc,kEAAY,YAAmB,MAAQ,OAAO;AACnE,aAAO,OAAO,SAAG,UAAY;AAAK,mBAAI,MAAqB,qBAAO;AACvE;AAAC;AAIE;;;AACK,6BAAU,aAAlB;AAEK,aAAO,SAAG,IAAuB;AACjC,aAAO,OAAQ,UAAM;AACrB,aAAO,OAAS,WAAK;AACrB,aAAM,MAAM,MAAS,SAAK,KAAS;AAEnC,aAAa,eAAG,IAAqB,yEAAC,CAAK,KAChD;AAAC;AAIE;;;AACK,6BAAY,eAApB,UAA2C;AAEtC,aAAU,YAAG,IAAkB,0EAAW,qEAAqB,qBAAS;AACxE,aAAU,UAAM,MAAQ,UAAG,IAAa,oEAAK,MAAM,MAAS;AAC5D,aAAU,UAAY,cAAO,KAClC;AAAC;AAIE;;;AACK,6BAAS,YAAjB;AAEK,aAAO,SAAG,IAAwB,4EAAK,KAAU,WAAc,uEAAS,UAAK,KAAI,IAAI,IAAI,IAAS;AAElG,aAAQ,UAAgB,KAAO,OAAgB;AAE/C,aAAM,MAAM,MAAS,SAAK,KAC/B;AAAC;AAIE;;;AACK,6BAAoB,uBAA5B,UAAwC;AAEnC,aAAe;AACf,aAAa,aAAyB,MAAS;AAC/C,aACL;AAAC;AAIE;;;AACI,6BAAM,SAAb,UAA8B;AAAhB;AAAA,iBAAgB;;AAE1B,YAAK,KAAS,SACZ,KAAQ,QAAU,aAAM;AAEzB,aAAM,MACX;AAAC;AAIE;;;AACI,6BAAQ,WAAf,UAAoC;AAApB;AAAA,oBAAoB;;AAE/B,aAAM,MAAE,IAAK;AACb,aAAM,MAAE,IAAK;AACb,aAAM,MAAM,QAAS,OAAY;AACjC,aAAM,MAAO,SAAS,OAC3B;AAAC;AACF,WAAC;AAAA;AAEK,OAAO,SAAG;AAEf,QACD;AAAC,E","file":"js/TorusPrimitive.js","sourcesContent":["import {URLLoaderEvent, URLLoader, URLRequest, URLLoaderDataFormat, ParserUtils, RequestAnimationFrame} from \"awayjs-full/lib/core\";\nimport {ElementsType, Sampler2D, ImageUtils} from \"awayjs-full/lib/graphics\";\nimport {Sprite, DirectionalLight, StaticLightPicker, PrimitiveTorusPrefab} from \"awayjs-full/lib/scene\";\nimport {MethodMaterial} from \"awayjs-full/lib/materials\";\nimport {View} from \"awayjs-full/lib/view\";\n\nclass TorusPrimitive\n{\n\tprivate _view:View;\n\tprivate _torus:PrimitiveTorusPrefab;\n\tprivate _sprite:Sprite;\n\tprivate _raf:RequestAnimationFrame;\n\tprivate _image:HTMLImageElement;\n\tprivate _material:MethodMaterial;\n\tprivate _light:DirectionalLight;\n\tprivate _lightPicker:StaticLightPicker;\n\n\tconstructor ()\n\t{\n\t\tthis.initView();\n\n\t\tthis._raf = new RequestAnimationFrame(this.render, this);\n\t\tthis._raf.start();\n\n\t\tthis.loadResources();\n\t\twindow.onresize = (event:UIEvent) => this.onResize(event);\n\n\t\tthis.onResize();\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initView()\n\t{\n\t\tthis._view = new View();// Create the Away3D View\n\t\tthis._view.backgroundColor = 0x000000;// Change the background color to black\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate loadResources()\n\t{\n\t\tvar imgLoader:URLLoader = new URLLoader();\n\t\timgLoader.dataFormat = URLLoaderDataFormat.BLOB;\n\t\timgLoader.addEventListener(URLLoaderEvent.LOAD_COMPLETE, (event:URLLoaderEvent) => this.urlCompleteHandler(event));\n\t\timgLoader.load(new URLRequest(\"assets/dots.png\"));\n\t}\n\n\t/**\n\t *\n\t * @param event\n\t */\n\tprivate urlCompleteHandler (event:URLLoaderEvent)\n\t{\n\t\tthis._image = ParserUtils.blobToImage((<URLLoader> event.target).data);\n\t\tthis._image.onload = (event:Event) => this.imageCompleteHandler(event);\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initLights()\n\t{\n\t\tthis._light = new DirectionalLight();\n\t\tthis._light.diffuse = .7;\n\t\tthis._light.specular = 1;\n\t\tthis._view.scene.addChild(this._light);\n\n\t\tthis._lightPicker = new StaticLightPicker([this._light]);\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initMaterial(image:HTMLImageElement)\n\t{\n\t\tthis._material = new MethodMaterial(ImageUtils.imageToBitmapImage2D(image));\n\t\tthis._material.style.sampler = new Sampler2D(true, true, false);\n\t\tthis._material.lightPicker = this._lightPicker;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initTorus()\n\t{\n\t\tthis._torus = new PrimitiveTorusPrefab(this._material, ElementsType.TRIANGLE, 220, 80, 32, 16, false);\n\n\t\tthis._sprite = <Sprite> this._torus.getNewObject();\n\n\t\tthis._view.scene.addChild(this._sprite);\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate imageCompleteHandler(event:Event)\n\t{\n\t\tthis.initLights ();\n\t\tthis.initMaterial(<HTMLImageElement> event.target);\n\t\tthis.initTorus ();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic render(dt:number = null)\n\t{\n\t\tif (this._sprite)\n\t\t\tthis._sprite.rotationY += 1;\n\n\t\tthis._view.render();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onResize(event:UIEvent = null)\n\t{\n\t\tthis._view.y = 0;\n\t\tthis._view.x = 0;\n\t\tthis._view.width = window.innerWidth;\n\t\tthis._view.height = window.innerHeight;\n\t}\n}\n\nwindow.onload = function()\n{\n\tnew TorusPrimitive();\n}\n\n\n// WEBPACK FOOTER //\n// ./src/TorusPrimitive.ts"],"sourceRoot":""}
{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "src/CubePrimitive.ts",
    "awayjs-core/lib/base/bitmapdata.ts",
    "awayjs-core/lib/errors/abstractmethoderror.ts",
    "awayjs-core/lib/errors/argumenterror.ts",
    "awayjs-core/lib/errors/error.ts",
    "awayjs-core/lib/events/assetevent.ts",
    "awayjs-core/lib/events/event.ts",
    "awayjs-core/lib/events/eventdispatcher.ts",
    "awayjs-core/lib/events/httpstatusevent.ts",
    "awayjs-core/lib/events/ioerrorevent.ts",
    "awayjs-core/lib/events/progressevent.ts",
    "awayjs-core/lib/events/projectionevent.ts",
    "awayjs-core/lib/geom/matrix.ts",
    "awayjs-core/lib/geom/matrix3d.ts",
    "awayjs-core/lib/geom/orientation3d.ts",
    "awayjs-core/lib/geom/point.ts",
    "awayjs-core/lib/geom/rectangle.ts",
    "awayjs-core/lib/geom/vector3d.ts",
    "awayjs-core/lib/library/assettype.ts",
    "awayjs-core/lib/library/namedassetbase.ts",
    "awayjs-core/lib/net/urlloader.ts",
    "awayjs-core/lib/net/urlloaderdataformat.ts",
    "awayjs-core/lib/net/urlrequest.ts",
    "awayjs-core/lib/net/urlrequestmethod.ts",
    "awayjs-core/lib/net/urlvariables.ts",
    "awayjs-core/lib/parsers/parserutils.ts",
    "awayjs-core/lib/projections/coordinatesystem.ts",
    "awayjs-core/lib/projections/perspectiveprojection.ts",
    "awayjs-core/lib/projections/projectionbase.ts",
    "awayjs-core/lib/textures/imagetexture.ts",
    "awayjs-core/lib/textures/mipmapgenerator.ts",
    "awayjs-core/lib/textures/texture2dbase.ts",
    "awayjs-core/lib/textures/textureproxybase.ts",
    "awayjs-core/lib/utils/bytearray.ts",
    "awayjs-core/lib/utils/bytearraybase.ts",
    "awayjs-core/lib/utils/colorutils.ts",
    "awayjs-core/lib/utils/requestanimationframe.ts",
    "awayjs-core/lib/utils/textureutils.ts",
    "awayjs-core/lib/utils/gettimer.ts",
    "awayjs-display/lib/base/alignmentmode.ts",
    "awayjs-display/lib/base/blendmode.ts",
    "awayjs-display/lib/base/displayobject.ts",
    "awayjs-display/lib/base/geometry.ts",
    "awayjs-display/lib/base/lightbase.ts",
    "awayjs-display/lib/base/linesubgeometry.ts",
    "awayjs-display/lib/base/linesubmesh.ts",
    "awayjs-display/lib/base/orientationmode.ts",
    "awayjs-display/lib/base/subgeometrybase.ts",
    "awayjs-display/lib/base/submeshbase.ts",
    "awayjs-display/lib/base/transform.ts",
    "awayjs-display/lib/base/trianglesubgeometry.ts",
    "awayjs-display/lib/base/trianglesubmesh.ts",
    "awayjs-display/lib/containers/displayobjectcontainer.ts",
    "awayjs-display/lib/containers/scene.ts",
    "awayjs-display/lib/containers/view.ts",
    "awayjs-display/lib/entities/camera.ts",
    "awayjs-display/lib/entities/directionallight.ts",
    "awayjs-display/lib/entities/lightprobe.ts",
    "awayjs-display/lib/entities/mesh.ts",
    "awayjs-display/lib/entities/pointlight.ts",
    "awayjs-display/lib/events/cameraevent.ts",
    "awayjs-display/lib/events/displayobjectevent.ts",
    "awayjs-display/lib/events/geometryevent.ts",
    "awayjs-display/lib/events/lightevent.ts",
    "awayjs-display/lib/events/mouseevent.ts",
    "awayjs-display/lib/events/rendererevent.ts",
    "awayjs-display/lib/events/sceneevent.ts",
    "awayjs-display/lib/events/subgeometryevent.ts",
    "awayjs-display/lib/managers/mousemanager.ts",
    "awayjs-display/lib/materials/lightpickers/lightpickerbase.ts",
    "awayjs-display/lib/materials/lightpickers/staticlightpicker.ts",
    "awayjs-display/lib/materials/shadowmappers/cubemapshadowmapper.ts",
    "awayjs-display/lib/materials/shadowmappers/directionalshadowmapper.ts",
    "awayjs-display/lib/materials/shadowmappers/shadowmapperbase.ts",
    "awayjs-display/lib/partition/cameranode.ts",
    "awayjs-display/lib/partition/directionallightnode.ts",
    "awayjs-display/lib/partition/entitynode.ts",
    "awayjs-display/lib/partition/lightprobenode.ts",
    "awayjs-display/lib/partition/nodebase.ts",
    "awayjs-display/lib/partition/nullnode.ts",
    "awayjs-display/lib/partition/partition.ts",
    "awayjs-display/lib/partition/pointlightnode.ts",
    "awayjs-display/lib/pick/pickingcollisionvo.ts",
    "awayjs-display/lib/pick/raycastpicker.ts",
    "awayjs-display/lib/pool/entitylistitem.ts",
    "awayjs-display/lib/pool/entitylistitempool.ts",
    "awayjs-display/lib/prefabs/prefabbase.ts",
    "awayjs-display/lib/prefabs/primitivecubeprefab.ts",
    "awayjs-display/lib/prefabs/primitiveprefabbase.ts",
    "awayjs-display/lib/prefabs/primitivetorusprefab.ts",
    "awayjs-display/lib/traverse/collectorbase.ts",
    "awayjs-display/lib/traverse/raycastcollector.ts",
    "awayjs-display/lib/traverse/shadowcastercollector.ts",
    "awayjs-core/lib/bounds/axisalignedboundingbox.ts",
    "awayjs-core/lib/bounds/boundingsphere.ts",
    "awayjs-core/lib/bounds/boundingvolumebase.ts",
    "awayjs-core/lib/bounds/nullbounds.ts",
    "awayjs-core/lib/errors/partialimplementationerror.ts",
    "awayjs-core/lib/errors/rangeerror.ts",
    "awayjs-core/lib/geom/box.ts",
    "awayjs-core/lib/geom/mathconsts.ts",
    "awayjs-core/lib/geom/matrix3dutils.ts",
    "awayjs-core/lib/geom/plane3d.ts",
    "awayjs-core/lib/geom/planeclassification.ts",
    "awayjs-core/lib/projections/freematrixprojection.ts",
    "awayjs-core/lib/textures/rendertexture.ts",
    "awayjs-renderergl/lib/events/shadingmethodevent.ts",
    "awayjs-renderergl/lib/managers/rttbuffermanager.ts",
    "awayjs-renderergl/lib/materials/linebasicmaterial.ts",
    "awayjs-renderergl/lib/materials/stageglmaterialbase.ts",
    "awayjs-renderergl/lib/materials/trianglebasicmaterial.ts",
    "awayjs-renderergl/lib/materials/trianglematerialbase.ts",
    "awayjs-renderergl/lib/materials/trianglematerialmode.ts",
    "awayjs-renderergl/lib/materials/trianglemethodmaterial.ts",
    "awayjs-renderergl/lib/materials/compilation/methodvo.ts",
    "awayjs-renderergl/lib/materials/compilation/registerpool.ts",
    "awayjs-renderergl/lib/materials/compilation/shadercompilerbase.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderlightingcompiler.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderlightingobject.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderobjectbase.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderregistercache.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderregisterdata.ts",
    "awayjs-renderergl/lib/materials/compilation/shaderregisterelement.ts",
    "awayjs-renderergl/lib/materials/methods/ambientbasicmethod.ts",
    "awayjs-renderergl/lib/materials/methods/diffusebasicmethod.ts",
    "awayjs-renderergl/lib/materials/methods/effectcolortransformmethod.ts",
    "awayjs-renderergl/lib/materials/methods/effectmethodbase.ts",
    "awayjs-renderergl/lib/materials/methods/lightingmethodbase.ts",
    "awayjs-renderergl/lib/materials/methods/normalbasicmethod.ts",
    "awayjs-renderergl/lib/materials/methods/shadingmethodbase.ts",
    "awayjs-renderergl/lib/materials/methods/specularbasicmethod.ts",
    "awayjs-renderergl/lib/materials/passes/depthmappass.ts",
    "awayjs-renderergl/lib/materials/passes/distancemappass.ts",
    "awayjs-renderergl/lib/materials/passes/linebasicpass.ts",
    "awayjs-renderergl/lib/materials/passes/materialpassbase.ts",
    "awayjs-renderergl/lib/materials/passes/materialpassmode.ts",
    "awayjs-renderergl/lib/materials/passes/trianglebasicpass.ts",
    "awayjs-renderergl/lib/materials/passes/trianglemethodpass.ts",
    "awayjs-renderergl/lib/materials/utils/defaultmaterialmanager.ts",
    "awayjs-renderergl/lib/materials/utils/shadercompilerhelper.ts",
    "awayjs-renderergl/lib/pool/billboardrenderable.ts",
    "awayjs-renderergl/lib/pool/linesubmeshrenderable.ts",
    "awayjs-renderergl/lib/pool/materialdata.ts",
    "awayjs-renderergl/lib/pool/materialdatapool.ts",
    "awayjs-renderergl/lib/pool/materialpassdata.ts",
    "awayjs-renderergl/lib/pool/materialpassdatapool.ts",
    "awayjs-renderergl/lib/pool/renderablebase.ts",
    "awayjs-renderergl/lib/pool/skyboxrenderable.ts",
    "awayjs-renderergl/lib/pool/trianglesubmeshrenderable.ts",
    "awayjs-renderergl/lib/render/defaultrenderer.ts",
    "awayjs-renderergl/lib/render/depthrenderer.ts",
    "awayjs-renderergl/lib/render/filter3drenderer.ts",
    "awayjs-renderergl/lib/render/rendererbase.ts",
    "awayjs-core/lib/geom/colortransform.ts",
    "awayjs-core/lib/textures/bitmaptexture.ts",
    "awayjs-display/lib/events/materialevent.ts",
    "awayjs-display/lib/events/stageevent.ts",
    "awayjs-display/lib/materials/lightsources.ts",
    "awayjs-display/lib/materials/materialbase.ts",
    "awayjs-display/lib/pool/renderablepool.ts",
    "awayjs-display/lib/sort/renderablemergesort.ts",
    "awayjs-display/lib/traverse/entitycollector.ts",
    "awayjs-stagegl/lib/aglsl/agaltokenizer.ts",
    "awayjs-stagegl/lib/aglsl/aglslparser.ts",
    "awayjs-stagegl/lib/aglsl/description.ts",
    "awayjs-stagegl/lib/aglsl/destination.ts",
    "awayjs-stagegl/lib/aglsl/header.ts",
    "awayjs-stagegl/lib/aglsl/mapping.ts",
    "awayjs-stagegl/lib/aglsl/oplut.ts",
    "awayjs-stagegl/lib/aglsl/sampler.ts",
    "awayjs-stagegl/lib/aglsl/token.ts",
    "awayjs-stagegl/lib/aglsl/assembler/agalminiassembler.ts",
    "awayjs-stagegl/lib/aglsl/assembler/fs.ts",
    "awayjs-stagegl/lib/aglsl/assembler/flags.ts",
    "awayjs-stagegl/lib/aglsl/assembler/opcode.ts",
    "awayjs-stagegl/lib/aglsl/assembler/opcodemap.ts",
    "awayjs-stagegl/lib/aglsl/assembler/part.ts",
    "awayjs-stagegl/lib/aglsl/assembler/regmap.ts",
    "awayjs-stagegl/lib/aglsl/assembler/sampler.ts",
    "awayjs-stagegl/lib/aglsl/assembler/samplermap.ts",
    "awayjs-stagegl/lib/base/contextglbase.ts",
    "awayjs-stagegl/lib/base/contextglblendfactor.ts",
    "awayjs-stagegl/lib/base/contextglclearmask.ts",
    "awayjs-stagegl/lib/base/contextglcomparemode.ts",
    "awayjs-stagegl/lib/base/contextglmipfilter.ts",
    "awayjs-stagegl/lib/base/contextglprofile.ts",
    "awayjs-stagegl/lib/base/contextglprogramtype.ts",
    "awayjs-stagegl/lib/base/contextgltexturefilter.ts",
    "awayjs-stagegl/lib/base/contextgltextureformat.ts",
    "awayjs-stagegl/lib/base/contextgltriangleface.ts",
    "awayjs-stagegl/lib/base/contextglvertexbufferformat.ts",
    "awayjs-stagegl/lib/base/contextglwrapmode.ts",
    "awayjs-stagegl/lib/base/contextstage3d.ts",
    "awayjs-stagegl/lib/base/contextwebgl.ts",
    "awayjs-stagegl/lib/base/cubetextureflash.ts",
    "awayjs-stagegl/lib/base/cubetexturewebgl.ts",
    "awayjs-stagegl/lib/base/indexbufferflash.ts",
    "awayjs-stagegl/lib/base/indexbufferwebgl.ts",
    "awayjs-stagegl/lib/base/opcodes.ts",
    "awayjs-stagegl/lib/base/programflash.ts",
    "awayjs-stagegl/lib/base/programwebgl.ts",
    "awayjs-stagegl/lib/base/resourcebaseflash.ts",
    "awayjs-stagegl/lib/base/samplerstate.ts",
    "awayjs-stagegl/lib/base/stage.ts",
    "awayjs-stagegl/lib/base/texturebasewebgl.ts",
    "awayjs-stagegl/lib/base/textureflash.ts",
    "awayjs-stagegl/lib/base/texturewebgl.ts",
    "awayjs-stagegl/lib/base/vertexbufferflash.ts",
    "awayjs-stagegl/lib/base/vertexbufferwebgl.ts",
    "awayjs-stagegl/lib/managers/stagemanager.ts",
    "awayjs-stagegl/lib/pool/indexdata.ts",
    "awayjs-stagegl/lib/pool/indexdatapool.ts",
    "awayjs-stagegl/lib/pool/programdata.ts",
    "awayjs-stagegl/lib/pool/programdatapool.ts",
    "awayjs-stagegl/lib/pool/texturedata.ts",
    "awayjs-stagegl/lib/pool/texturedatapool.ts",
    "awayjs-stagegl/lib/pool/vertexdata.ts",
    "awayjs-stagegl/lib/pool/vertexdatapool.ts",
    "node_modules/awayjs-renderergl/node_modules/awayjs-stagegl/lib/swfobject.js",
    "awayjs-core/lib/utils/css.ts",
    "awayjs-display/lib/display/contextmode.ts"
  ],
  "names": [],
  "mappings": "CAAA,QAAA,GAAA,EAAA,EAAA,GAAA,QAAA,GAAA,EAAA,GAAA,IAAA,EAAA,GAAA,CAAA,IAAA,EAAA,GAAA,CAAA,GAAA,SAAA,UAAA,YAAA,OAAA,KAAA,GAAA,EAAA,MAAA,GAAA,GAAA,EAAA,IAAA,EAAA,MAAA,GAAA,GAAA,EAAA,IAAA,GAAA,GAAA,OAAA,uBAAA,EAAA,IAAA,MAAA,GAAA,KAAA,mBAAA,EAAA,GAAA,GAAA,EAAA,IAAA,WAAA,GAAA,GAAA,GAAA,KAAA,EAAA,QAAA,SAAA,GAAA,GAAA,GAAA,EAAA,GAAA,GAAA,EAAA,OAAA,GAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,EAAA,EAAA,EAAA,GAAA,MAAA,GAAA,GAAA,QAAA,GAAA,SAAA,UAAA,YAAA,OAAA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,OAAA,IAAA,EAAA,EAAA,GAAA,OAAA,MAAA,GAAA,SAAA,EAAA,EAAA,GCAA,GAAO,GAAS,EAAe,+BAC/B,IAAO,GAAQ,EAAgB,gCAC/B,IAAO,GAAS,EAAe,gCAC/B,IAAO,GAAmB,EAAa,0CACvC,IAAO,GAAU,EAAe,iCAChC,IAAO,GAAW,EAAe,sCACjC,IAAO,GAAqB,EAAY,oDACxC,IAAO,GAAY,EAAe,wCAClC,IAAO,GAAqB,EAAY,8CAGxC,IAAO,GAAI,EAAiB,qCAC5B,IAAO,GAAgB,EAAc,+CAErC,IAAO,GAAS,EAAe,oCAC/B,IAAO,GAAiB,EAAa,8DACrC,IAAO,GAAmB,EAAa,iDACvC,IAAO,GAAoB,EAAa,kDAExC,IAAO,GAAsB,EAAY,yDACzC,IAAO,GAAe,EAAc,+CAEpC,IAAM,GAAa,WAalB,QAbK,KAeJ,KAAK,UACL,MAAK,YACL,MAAK,YACL,MAAK,cACL,MAAK,gBAME,EAAA,UAAA,SAAR,WAEC,KAAK,MAAQ,GAAI,GAAK,GAAI,GAC1B,MAAK,MAAM,gBAAkB,CAC7B,MAAK,MAAM,OAAO,EAAI,GACtB,MAAK,MAAM,OAAO,EAAI,CACtB,MAAK,MAAM,OAAO,EAAI,EAMf,GAAA,UAAA,aAAR,WAEC,KAAK,MAAQ,GAAI,GAAoB,GAAM,GAAM,GACjD,MAAK,OAAS,GAAI,GAAqB,IAAK,GAAI,GAAI,GAAI,KAExD,MAAK,MAAe,KAAK,OAAO,cAChC,MAAK,OAAgB,KAAK,MAAM,cAChC,MAAK,OAAO,EAAI,GAChB,MAAK,OAAO,EAAI,GAMT,GAAA,UAAA,WAAR,WAEC,KAAK,OAAS,GAAI,EAClB,MAAK,OAAO,MAAQ,QACpB,MAAK,OAAO,UAAY,GAAI,GAAS,EAAG,EAAG,EAC3C,MAAK,OAAO,QAAU,EACtB,MAAK,OAAO,aAAe,OAC3B,MAAK,OAAO,QAAU,GACtB,MAAK,OAAO,SAAW,GAEvB,MAAK,aAAe,GAAI,IAAmB,KAAK,SAMzC,GAAA,UAAA,WAAR,WAEC,KAAK,YAAc,GAAI,GAAS,EAAG,EAAG,EACtC,MAAK,MAAM,OAAO,WAAa,GAAI,GAAsB,IACzD,MAAK,MAAM,OAAO,WAAW,KAAO,GAM7B,GAAA,UAAA,cAAR,WAAA,GAAA,GAAA,IAEC,QAAO,SAAW,SAAC,GAAkB,MAAA,GAAK,SAAS,GACnD,MAAK,UAEL,MAAK,KAAO,GAAI,GAAsB,KAAK,OAAQ,KACnD,MAAK,KAAK,OAEV,IAAI,GAAwB,GAAI,GAAW,2BAC3C,IAAI,GAAsB,GAAI,EAC9B,GAAU,WAAa,EAAoB,IAE3C,GAAU,iBAAiB,EAAU,SAAU,SAAC,GAAoB,MAAA,GAAK,mBAAmB,IAC5F,GAAU,KAAK,GAOR,GAAA,UAAA,mBAAR,SAA2B,GAA3B,GAAA,GAAA,IAEC,IAAI,GAAoC,EAAM,MAE9C,MAAK,OAAS,EAAY,YAAY,EAAY,KAElD,MAAK,OAAO,OAAS,SAAC,GAAgB,MAAA,GAAK,qBAAqB,IAOzD,GAAA,UAAA,qBAAR,SAA6B,GAE5B,GAAI,GAAkB,GAAI,GAAa,KAAK,OAAQ,MACpD,IAAI,GAA+B,GAAI,GAAuB,EAAI,KAAM,KAAM,MAC9E,GAAM,UAAY,EAAU,GAC5B,GAAM,UAAY,IAClB,GAAM,YAAc,KAAK,YAEzB,MAAK,MAAM,SAAW,CACtB,MAAK,OAAO,SAAW,CAEvB,MAAK,MAAM,MAAM,SAAS,KAAK,MAC/B,MAAK,MAAM,MAAM,SAAS,KAAK,QAQzB,GAAA,UAAA,OAAP,SAAc,GAAA,GAAA,QAAA,GAAgB,CAAhB,EAAA,KAEb,KAAK,MAAM,OAAO,OAAO,KAAK,YAAa,EAC3C,MAAK,MAAM,WAAa,CACxB,MAAK,OAAO,WAAa,EACzB,MAAK,OAAO,WAAa,EACzB,MAAK,MAAM,SAML,GAAA,UAAA,SAAP,SAAgB,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,KAEf,KAAK,MAAM,EAAI,CACf,MAAK,MAAM,EAAI,CAEf,MAAK,MAAM,MAAQ,OAAO,UAC1B,MAAK,MAAM,OAAS,OAAO,YAE7B,OAAA,KAEA,QAAO,OAAS,WAEf,GAAI,0yBC9KL,GAAO,GAAS,EAAc,iCAG9B,IAAO,GAAU,EAAc,uCAKzB,GAAU,WAkBf,QAlBK,GAkBO,EAAc,EAAe,EAA4B,GAA5B,GAAA,QAAA,GAA0B,CAA1B,EAAA,KAA4B,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAX7D,KAAA,OAAgB,CAChB,MAAA,QAAkB,KAazB,MAAK,aAAe,CACpB,MAAK,aAAmC,SAAS,cAAc,SAC/D,MAAK,aAAa,MAAQ,CAC1B,MAAK,aAAa,OAAS,CAC3B,MAAK,SAAW,KAAK,aAAa,WAAW,KAC7C,MAAK,MAAQ,GAAI,GAAU,EAAG,EAAG,EAAO,EAExC,IAAI,GAAa,KAAM,CAEtB,GAAI,KAAK,aAAc,CACtB,KAAK,OAAS,EAAW,mBAAmB,GAAW,GAAG,QACpD,CACN,KAAK,OAAS,EAGf,KAAK,SAAS,KAAK,MAAO,IASrB,EAAA,UAAA,QAAP,WAEC,KAAK,SAAW,IAChB,MAAK,aAAe,IACpB,MAAK,WAAa,IAClB,MAAK,MAAQ,IACb,MAAK,aAAe,IACpB,MAAK,QAAU,KAMT,GAAA,UAAA,KAAP,WAEC,KAAK,QAAU,IACf,MAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,QAM1E,GAAA,UAAA,OAAP,WAEC,KAAK,QAAU,KAEf,IAAI,KAAK,WAAY,CACpB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAUb,GAAA,UAAA,SAAP,SAAgB,EAAG,GAElB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,KAAK,QAAS,CAClB,GAAI,GAAsB,KAAK,SAAS,aAAa,EAAG,EAAG,EAAG,EAE9D,GAAI,EAAU,KAAK,EACnB,GAAI,EAAU,KAAK,EACnB,GAAI,EAAU,KAAK,EACnB,GAAI,EAAU,KAAK,OAEb,CACN,GAAI,IAAgB,EAAI,EAAE,KAAK,aAAa,OAAO,CAEnD,KAAK,KAAK,WACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,GAAI,KAAK,WAAW,KAAK,EAAQ,EACjC,GAAI,KAAK,WAAW,KAAK,EAAQ,EACjC,GAAI,KAAK,WAAW,KAAK,EAAQ,EACjC,GAAI,KAAK,WAAW,KAAK,EAAQ,GAIlC,IAAK,KAAK,QAAS,CAClB,KAAK,WAAa,KAGnB,MAAQ,IAAK,GAAO,GAAK,GAAO,GAAK,EAAK,EASpC,GAAA,UAAA,SAAP,SAAgB,EAAG,EAAG,GAErB,GAAI,GAAgB,EAAW,mBAAmB,EAElD,KAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,GAAI,IAAgB,EAAI,EAAE,KAAK,aAAa,OAAO,CAEnD,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,IAGnC,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MASb,GAAA,UAAA,UAAP,SAAiB,EAAgB,GAEhC,IAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,EAAe,SAAW,CAC1B,IAAI,GAAmB,EAAmB,CAC1C,KAAK,EAAI,EAAG,EAAI,EAAK,QAAS,EAAG,CAChC,IAAK,EAAI,EAAG,EAAI,EAAK,SAAU,EAAG,CACjC,GAAS,EAAI,EAAK,GAAK,EAAI,EAAK,GAAG,KAAK,aAAa,OAAO,CAE5D,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAe,iBACjD,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAe,iBACjD,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAe,iBACjD,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAe,oBAKpD,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAUb,GAAA,UAAA,WAAP,SAAkB,EAAG,EAAG,GAEvB,GAAI,GAAgB,EAAW,mBAAmB,EAElD,KAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,GAAI,IAAgB,EAAI,EAAE,KAAK,aAAa,OAAO,CAEnD,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,GAGxC,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAIb,GAAA,UAAA,UAAP,SAAiB,EAAgB,GAEhC,IAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,GAAI,GAAmB,EAAmB,EAAuB,CACjE,KAAK,EAAI,EAAG,EAAI,EAAK,QAAS,EAAG,CAChC,IAAK,EAAI,EAAG,EAAI,EAAK,SAAU,EAAG,CACjC,EAAO,EAAW,mBAAmB,EAAY,EAAI,EAAE,EAAK,OAC5D,IAAS,EAAI,EAAK,GAAK,EAAI,EAAK,GAAG,KAAK,aAAa,OAAO,CAE5D,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,EACvC,MAAK,WAAW,KAAK,EAAQ,GAAK,EAAK,KAK1C,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAab,GAAA,UAAA,UAAP,SAAiB,EAAS,EAAsB,GAE/C,GAAI,KAAK,QAAS,CAOjB,GAAI,KAAK,WAAY,CACpB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,GAGhD,KAAK,WAAW,EAAK,EAAY,EAEjC,IAAI,KAAK,WAAY,CACpB,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,aAG3E,CACN,KAAK,WAAW,EAAK,EAAY,IAM3B,GAAA,UAAA,WAAR,SAAmB,EAAS,EAAsB,GAEjD,GAAI,YAAe,GAClB,KAAK,SAAS,UAAU,EAAI,OAAQ,EAAW,EAAG,EAAW,EAAG,EAAW,MAAO,EAAW,OAAQ,EAAS,EAAG,EAAS,EAAG,EAAS,MAAO,EAAS,YAClJ,IAAI,YAAe,kBACvB,KAAK,SAAS,UAAU,EAAK,EAAW,EAAG,EAAW,EAAG,EAAW,MAAO,EAAW,OAAQ,EAAS,EAAG,EAAS,EAAG,EAAS,MAAO,EAAS,QAW1I,GAAA,UAAA,WAAP,SAAkB,EAAU,EAAsB,GAGjD,GAAI,KAAK,QAAS,CAQjB,GAAI,KAAK,WAAY,CACpB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,GAGhD,KAAK,YAAY,EAAM,EAAY,EAEnC,IAAI,KAAK,WAAY,CACpB,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,aAE3E,CACN,KAAK,YAAY,EAAM,EAAY,IAO7B,GAAA,UAAA,YAAR,SAAoB,EAAU,EAAsB,GAGnD,GAAI,YAAgB,GAAY,CAC/B,KAAK,SAAS,UAAU,EAAK,OAAQ,EAAW,EAAG,EAAW,EAAG,EAAW,MAAO,EAAW,OAAQ,EAAS,EAAG,EAAS,EAAG,EAAS,MAAO,EAAS,YACjJ,IAAI,YAAgB,kBAAkB,CAC5C,KAAK,SAAS,UAAU,EAAM,EAAW,EAAG,EAAW,EAAG,EAAW,MAAO,EAAW,OAAQ,EAAS,EAAG,EAAS,EAAG,EAAS,MAAO,EAAS,SAU3I,GAAA,UAAA,SAAP,SAAgB,EAAgB,GAE/B,GAAI,KAAK,QAAS,CAQjB,GAAI,KAAK,WACR,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAEhD,MAAK,SAAS,UAAY,KAAK,aAAa,EAC5C,MAAK,SAAS,SAAS,EAAK,EAAG,EAAK,EAAG,EAAK,MAAO,EAAK,OAExD,IAAI,KAAK,WACR,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,YAC3E,CACN,KAAK,SAAS,UAAY,KAAK,aAAa,EAC5C,MAAK,SAAS,SAAS,EAAK,EAAG,EAAK,EAAG,EAAK,MAAO,EAAK,SAWnD,GAAA,UAAA,KAAP,SAAY,EAAY,GAEvB,GAAI,KAAK,QAAS,CAQjB,GAAI,KAAK,WACR,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAEhD,MAAK,MAAM,EAAQ,EAEnB,IAAI,KAAK,WACR,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,YAC3E,CACN,KAAK,MAAM,EAAQ,IAMb,GAAA,UAAA,MAAR,SAAc,EAAY,GAEzB,GAAI,YAAkB,GAAY,CACjC,KAAK,SAAS,MAEd,IAAI,GAAU,KACb,KAAK,SAAS,aAAa,EAAO,EAAG,EAAO,EAAG,EAAO,EAAG,EAAO,EAAG,EAAO,GAAI,EAAO,GAEtF,MAAK,SAAS,UAAU,EAAO,OAAQ,EAAG,EAC1C,MAAK,SAAS,cAER,IAAI,YAAkB,kBAAkB,CAC9C,KAAK,SAAS,MAEd,IAAI,GAAU,KACb,KAAK,SAAS,aAAa,EAAO,EAAG,EAAO,EAAG,EAAO,EAAG,EAAO,EAAG,EAAO,GAAI,EAAO,GAEtF,MAAK,SAAS,UAAU,EAAQ,EAAG,EACnC,MAAK,SAAS,WAKT,GAAA,UAAA,YAAP,SAAmB,EAAyB,EAAsB,EAAiB,EAAsB,GAExG,GAAI,GAAsB,EAAa,SAEvC,KAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,GAAI,GAA2B,EAAa,UAAU,IACtD,IAAI,GAAyB,KAAK,WAAW,IAE7C,IAAI,GAAsB,KAAK,MAAM,KAAK,IAAI,GAAe,KAAK,IAAI,GACtE,IAAI,GAAoB,KAAK,MAAM,KAAK,IAAI,GAAa,KAAK,IAAI,GAElE,IAAI,GAAmB,EAAmB,EAA6B,CACvE,KAAK,EAAI,EAAG,EAAI,EAAW,QAAS,EAAG,CACtC,IAAK,EAAI,EAAG,EAAI,EAAW,SAAU,EAAG,CACvC,GAAe,EAAI,EAAW,GAAK,EAAI,EAAW,GAAG,EAAa,OAAO,CACzE,IAAa,EAAI,EAAU,GAAK,EAAI,EAAU,GAAG,KAAK,OAAO,CAE7D,GAAS,EAAY,GAAc,EAAW,EAAc,KAK/D,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAIb,GAAA,UAAA,eAAP,SAAsB,EAAgB,GAErC,IAAK,KAAK,QACT,KAAK,WAAa,KAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,OAEjF,IAAI,KAAK,WAAY,CACpB,GAAI,GAAqB,KAAK,WAAW,IAEzC,IAAI,GAAmB,EAAmB,CAC1C,KAAK,EAAI,EAAG,EAAI,EAAK,QAAS,EAAG,CAChC,IAAK,EAAI,EAAG,EAAI,EAAK,SAAU,EAAG,CACjC,GAAS,EAAI,EAAK,GAAK,EAAI,EAAK,GAAG,KAAK,OAAO,CAE/C,GAAK,GAAS,EAAK,GAAO,EAAe,cAAgB,EAAe,SACxE,GAAK,EAAQ,GAAK,EAAK,EAAQ,GAAG,EAAe,gBAAkB,EAAe,WAClF,GAAK,EAAQ,GAAK,EAAK,EAAQ,GAAG,EAAe,eAAiB,EAAe,UACjF,GAAK,EAAQ,GAAK,EAAK,EAAQ,GAAG,EAAe,gBAAkB,EAAe,cAKrF,IAAK,KAAK,QAAS,CAClB,KAAK,SAAS,aAAa,KAAK,WAAY,EAAG,EAC/C,MAAK,WAAa,MAQpB,QAAA,eAAW,EAAA,UAAA,iBASX,WAEC,MAAO,MAAK,SAAS,aAAa,EAAG,EAAG,KAAK,MAAM,MAAO,KAAK,MAAM,aAXtE,SAAqB,GAEpB,KAAK,SAAS,aAAa,EAAO,EAAG,uCAgBtC,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAgB,MAAK,aAAa,WAOnC,SAAiB,GAEhB,KAAK,MAAM,MAAQ,CACnB,MAAK,aAAa,MAAQ,sCAO3B,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAgB,MAAK,aAAa,YAOnC,SAAkB,GAEjB,KAAK,MAAM,OAAS,CACpB,MAAK,aAAa,OAAS,sCAO5B,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAOb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,iDAOb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,6CAQL,GAAA,UAAA,aAAR,SAAqB,GAEpB,GAAI,GAAgB,EAAW,mBAAmB,EAElD,IAAI,KAAK,cAAgB,MAAO,CAC/B,EAAK,GAAK,CAEV,OAAO,QAAU,EAAK,GAAK,IAAM,EAAK,GAAK,IAAM,EAAK,GAAK,IAAM,EAAK,GAAK,IAG5E,MAAO,QAAU,EAAK,GAAK,IAAM,EAAK,GAAK,IAAM,EAAK,GAAK,IAAM,EAAK,GAAG,IAAM,IAEjF,OAAA,KAEA,GAAoB,QAAX,iQC9jBT,IAAO,GAAK,EAAe,mCAMrB,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAOxB,SAPK,GAOO,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,KAAuB,GAAA,QAAA,GAAa,CAAb,EAAA,EAElC,EAAA,KAAA,KAAM,GAAW,gJAAiJ,GAEpK,MAAA,IAXkC,EAaL,GAAA,QAApB,wNCnBT,IAAO,GAAK,EAAe,mCAMrB,GAAa,SAAA,GAAS,EAAtB,EAAa,EAQlB,SARK,GAQO,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,KAAuB,GAAA,QAAA,GAAa,CAAb,EAAA,EAElC,EAAA,KAAA,KAAM,GAAW,gBAAiB,GAEpC,MAAA,IAZ4B,EAcL,GAAA,QAAd,0DCpBT,GAAM,GAAK,WAOV,QAPK,GAOO,EAAqB,EAAe,GAApC,GAAA,QAAA,GAAmB,CAAnB,EAAA,GAAqB,GAAA,QAAA,GAAa,CAAb,EAAA,EAAe,GAAA,QAAA,GAAiB,CAAjB,EAAA,GAJxC,KAAA,SAAkB,CAClB,MAAA,UAAmB,EACnB,MAAA,MAAe,EAKtB,MAAK,UAAY,CACjB,MAAK,MAAQ,IACb,MAAK,SAAW,EAQjB,OAAA,eAAW,EAAA,UAAA,eAAX,WAGC,MAAO,MAAK,eAQb,SAAmB,GAGlB,KAAK,UAAY,sCAQlB,QAAA,eAAW,EAAA,UAAA,YAAX,WAGC,MAAO,MAAK,WAQb,SAAgB,GAGf,KAAK,MAAQ,sCAQd,QAAA,eAAW,EAAA,UAAA,eAAX,WAGC,MAAO,MAAK,6CAId,OAAA,KAEA,GAAe,QAAN,wLCxET,IAAO,GAAK,EAAe,mCAKrB,GAAU,SAAA,GAAS,EAAnB,EAAU,EA4Bf,SA5BK,GA4BO,EAAa,EAAqB,GAArB,GAAA,QAAA,GAAmB,CAAnB,EAAA,KAAqB,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAE7C,EAAA,KAAA,KAAM,EAEN,MAAK,OAAS,CACd,MAAK,UAAY,IAAa,KAAK,OAAQ,KAAK,OAAO,KAAO,MAM/D,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,2CAMb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,8CAMN,GAAA,UAAA,MAAP,WAEC,MAAe,IAAI,GAAW,KAAK,KAAM,KAAK,MAAO,KAAK,eApD7C,GAAA,eAAwB,eAKxB,GAAA,aAAsB,aAKtB,GAAA,wBAAiC,uBAKjC,GAAA,mBAA4B,kBAuC3C,OAAA,IA3DyB,EA6DL,GAAA,QAAX,0DCnET,GAAM,GAAK,WA4BV,QA5BK,GA4BO,GATL,KAAA,KAAc,SAOd,MAAA,OAAa,SAInB,MAAK,KAAO,EAON,EAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAM,KAAK,MApCT,GAAA,SAAkB,UAClB,GAAA,KAAc,MAEd,GAAA,YAAqB,YACrB,GAAA,WAAoB,WAGpB,GAAA,OAAgB,QAChB,GAAA,MAAe,OACf,GAAA,OAAgB,QA6B/B,OAAA,KAEe,GAAA,QAAN,6BCnCH,GAAe,WAKpB,QALK,GAKO,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAHJ,KAAA,UAAmC,GAAI,MAK9C,MAAK,OAAS,GAAU,KASlB,EAAA,UAAA,iBAAP,SAAwB,EAAa,GAEpC,GAAI,KAAK,UAAW,KAAW,UAC9B,KAAK,UAAW,GAAS,GAAI,MAE9B,IAAI,KAAK,sBAAsB,EAAM,MAAe,EACnD,KAAK,UAAW,GAAO,KAAK,GASvB,GAAA,UAAA,oBAAP,SAA2B,EAAa,GAEvC,GAAI,GAAe,KAAK,sBAAsB,EAAM,EAEpD,IAAI,KAAW,EACd,KAAK,UAAW,GAAO,OAAO,EAAO,GAQhC,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,GAAgC,KAAK,UAAW,EAAM,KAE1D,IAAI,IAAkB,UAAW,CAChC,GAAI,GAAW,EAAc,MAE7B,GAAM,OAAS,KAAK,MAEpB,KAAK,GAAI,GAAW,EAAG,EAAI,EAAG,IAC7B,EAAc,GAAG,IAUZ,GAAA,UAAA,sBAAR,SAA8B,EAAa,GAE1C,GAAI,KAAK,UAAW,KAAW,UAAW,CACzC,GAAI,GAAoB,KAAK,UAAW,EACxC,IAAI,GAAW,EAAE,MAEjB,KAAK,GAAI,GAAW,EAAG,EAAI,EAAG,IAC7B,GAAI,GAAY,EAAE,GACjB,MAAO,GAGV,OAAQ,EASF,GAAA,UAAA,iBAAP,SAAwB,EAAa,GAEpC,GAAI,GAAY,KAAM,CACrB,MAAS,MAAK,sBAAsB,EAAM,MAAe,MACnD,CACN,GAAI,KAAK,UAAW,KAAW,UAC9B,MAAS,MAAK,UAAW,GAAO,OAAS,CAE1C,OAAO,OAGR,MAAO,OAET,OAAA,KAEyB,GAAA,QAAhB,wLC3GT,IAAO,GAAK,EAAe,mCAKrB,GAAe,SAAA,GAAS,EAAxB,EAAe,EAOpB,SAPK,GAOO,EAAa,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,KAExB,EAAA,KAAA,KAAM,EAEN,MAAK,OAAS,EARD,EAAA,YAAqB,YAWpC,OAAA,IAd8B,EAgBL,GAAA,QAAhB,yNCrBT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EAKjB,SALK,GAKO,GAEX,EAAA,KAAA,KAAM,GAJO,EAAA,SAAkB,SAOjC,OAAA,IAV2B,EAY3B,GAAsB,QAAb,yNCdT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EAQlB,SARK,GAQO,GAEX,EAAA,KAAA,KAAM,GARO,EAAA,SAAkB,UAUjC,OAAA,IAZ4B,EAc5B,GAAuB,QAAd,yNChBT,IAAO,GAAK,EAAe,+BAG3B,IAAM,GAAe,SAAA,GAAS,EAAxB,EAAe,EAMpB,SANK,GAMO,EAAa,GAExB,EAAA,KAAA,KAAM,EACN,MAAK,YAAc,EAGpB,OAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAZC,GAAA,eAAwB,eAcvC,OAAA,IAhB8B,EAkB9B,GAAyB,QAAhB,2DCrBT,GAAO,GAAK,EAAe,6BAE3B,IAAO,GAAa,EAAa,2CAyD3B,GAAM,WA2DX,QA3DK,GA2DO,EAAc,EAAc,EAAc,EAAc,EAAe,GAAvE,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAa,CAAb,EAAA,EAAe,GAAA,QAAA,GAAa,CAAb,EAAA,EAElF,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,GAAK,CACV,MAAK,GAAK,EASJ,EAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAO,KAAK,EAAG,KAAK,EAAG,KAAK,EAAG,KAAK,EAAG,KAAK,GAAI,KAAK,IAqB1D,GAAA,UAAA,OAAP,SAAc,GAEb,GAAI,GAAK,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CACzC,MAAK,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CACzC,MAAK,EAAI,CAET,IAAI,GAAK,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CACzC,MAAK,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CAEzC,MAAK,EAAI,CAET,IAAI,GAAM,KAAK,GAAG,EAAO,EAAI,KAAK,GAAG,EAAO,EAAI,EAAO,EACvD,MAAK,GAAK,KAAK,GAAG,EAAO,EAAI,KAAK,GAAG,EAAO,EAAI,EAAO,EACvD,MAAK,GAAK,EAUJ,GAAA,UAAA,eAAP,SAAsB,EAAe,GAEpC,GAAI,EAAS,EAAG,CACf,KAAM,UAAY,EAAS,yBACrB,IAAI,GAAU,EAAG,CACvB,KAAK,EAAI,EAAS,CAClB,MAAK,EAAI,EAAS,MACZ,IAAI,GAAU,EAAG,CACvB,KAAK,EAAI,EAAS,CAClB,MAAK,EAAI,EAAS,MACZ,CACN,KAAK,GAAK,EAAS,CACnB,MAAK,GAAK,EAAS,GAWd,GAAA,UAAA,aAAP,SAAoB,EAAe,GAElC,GAAI,EAAS,EAAG,CACf,KAAM,IAAI,GAAc,yBAA2B,EAAS,kCACtD,IAAI,GAAU,EAAG,CACvB,EAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,CAClB,GAAS,EAAI,MACP,IAAI,GAAU,EAAG,CACvB,EAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,CAClB,GAAS,EAAI,MACP,CACN,EAAS,EAAI,KAAK,EAClB,GAAS,EAAI,KAAK,EAClB,GAAS,EAAI,GAUR,GAAA,UAAA,SAAP,SAAgB,GAEf,KAAK,EAAI,EAAa,CACtB,MAAK,EAAI,EAAa,CACtB,MAAK,EAAI,EAAa,CACtB,MAAK,EAAI,EAAa,CACtB,MAAK,GAAK,EAAa,EACvB,MAAK,GAAK,EAAa,GASjB,GAAA,UAAA,YAAP,SAAmB,EAAY,GAE9B,GAAI,EAAM,EAAG,CACZ,KAAM,IAAI,GAAc,sBAAwB,EAAM,kCAChD,IAAI,GAAO,EAAG,CACpB,KAAK,EAAI,EAAS,CAClB,MAAK,EAAI,EAAS,MACZ,IAAI,GAAO,EAAG,CACpB,KAAK,EAAI,EAAS,CAClB,MAAK,EAAI,EAAS,MACZ,CACN,KAAK,GAAK,EAAS,CACnB,MAAK,GAAK,EAAS,GAWd,GAAA,UAAA,UAAP,SAAiB,EAAY,GAE5B,GAAI,EAAM,EAAG,CACZ,KAAM,IAAI,GAAc,sBAAwB,EAAM,kCAChD,IAAI,GAAO,EAAG,CACpB,EAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,OACZ,IAAI,GAAO,EAAG,CACpB,EAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,CAClB,GAAS,EAAI,KAAK,OACZ,CACN,EAAS,MAAM,EAAG,EAAG,IAsBhB,GAAA,UAAA,UAAP,SAAiB,EAAe,EAAe,EAAqB,EAAe,GAApC,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAAqB,GAAA,QAAA,GAAa,CAAb,EAAA,EAAe,GAAA,QAAA,GAAa,CAAb,EAAA,EAElF,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,GAAK,CACV,MAAK,GAAK,EAoCJ,GAAA,UAAA,kBAAP,SAAyB,EAAc,EAAe,EAAqB,EAAe,GAApC,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAAqB,GAAA,QAAA,GAAa,CAAb,EAAA,EAAe,GAAA,QAAA,GAAa,CAAb,EAAA,EAEzF,KAAK,EAAI,EAAM,MACf,MAAK,EAAI,EAAO,MAEhB,IAAI,GAAY,EAAK,CACpB,GAAI,GAAM,KAAK,IAAI,EACnB,IAAI,GAAM,KAAK,IAAI,EAEnB,MAAK,EAAI,EAAI,KAAK,CAClB,MAAK,GAAK,EAAI,KAAK,CACnB,MAAK,GAAK,CACV,MAAK,GAAK,MACJ,CACN,KAAK,EAAI,KAAK,EAAI,EAGnB,KAAK,GAAK,EAAK,EAAM,CACrB,MAAK,GAAK,EAAK,EAAO,EAehB,GAAA,UAAA,oBAAP,SAA2B,GAE1B,MAAO,IAAI,GAAM,EAAM,EAAE,KAAK,EAAI,EAAM,EAAE,KAAK,EAAG,EAAM,EAAE,KAAK,EAAI,EAAM,EAAE,KAAK,GAgB1E,GAAA,UAAA,SAAP,WAEC,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,GAAK,CACV,MAAK,GAAK,EAQJ,GAAA,UAAA,OAAP,WAEC,GAAI,GAAO,KAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,CAEvC,IAAI,GAAQ,EAAG,CACd,KAAK,EAAI,KAAK,EAAI,KAAK,EAAI,KAAK,EAAI,CACpC,MAAK,IAAM,KAAK,EAChB,MAAK,IAAM,KAAK,OACV,CACN,EAAO,EAAI,CACX,IAAI,GAAK,KAAK,EAAE,CAChB,MAAK,EAAI,KAAK,EAAE,CAChB,MAAK,EAAI,CACT,MAAK,IAAM,CACX,MAAK,IAAM,CAEX,IAAI,IAAO,KAAK,EAAE,KAAK,GAAK,KAAK,EAAE,KAAK,EACxC,MAAK,IAAM,KAAK,EAAE,KAAK,GAAK,KAAK,EAAE,KAAK,EACxC,MAAK,GAAK,GAaL,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAAS,GAAI,EAEjB,GAAO,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CAC3C,GAAO,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CAC3C,GAAO,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CAC3C,GAAO,EAAI,KAAK,EAAE,EAAO,EAAI,KAAK,EAAE,EAAO,CAE3C,GAAO,GAAK,KAAK,GAAG,EAAO,EAAI,KAAK,GAAG,EAAO,EAAI,EAAO,EACzD,GAAO,GAAK,KAAK,GAAG,EAAO,EAAI,KAAK,GAAG,EAAO,EAAI,EAAO,EAEzD,OAAO,GAaD,GAAA,UAAA,OAAP,SAAc,GAEb,GAAI,GAAM,KAAK,IAAI,EACnB,IAAI,GAAM,KAAK,IAAI,EAEnB,IAAI,GAAK,KAAK,EAAE,EAAM,KAAK,EAAE,CAC7B,MAAK,EAAI,KAAK,EAAE,EAAM,KAAK,EAAE,CAC7B,MAAK,EAAI,CAET,IAAI,GAAK,KAAK,EAAE,EAAM,KAAK,EAAE,CAC7B,MAAK,EAAI,KAAK,EAAE,EAAM,KAAK,EAAE,CAC7B,MAAK,EAAI,CAET,IAAI,GAAM,KAAK,GAAG,EAAM,KAAK,GAAG,CAChC,MAAK,GAAK,KAAK,GAAG,EAAM,KAAK,GAAG,CAChC,MAAK,GAAK,EAgBJ,GAAA,UAAA,MAAP,SAAa,EAAW,GAEvB,KAAK,GAAK,CACV,MAAK,GAAK,CAEV,MAAK,GAAK,CACV,MAAK,GAAK,CAEV,MAAK,IAAM,CACX,MAAK,IAAM,EAmBL,GAAA,UAAA,MAAP,SAAa,EAAU,EAAU,EAAU,EAAU,EAAW,GAE/D,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,GAAK,CACV,MAAK,GAAK,EAUJ,GAAA,UAAA,SAAP,WAEC,MAAO,eAAiB,KAAK,EAAI,OAAS,KAAK,EAAI,OAAS,KAAK,EAAI,OAAS,KAAK,EAAI,QAAU,KAAK,GAAK,QAAU,KAAK,GAAK,IAWzH,GAAA,UAAA,eAAP,SAAsB,GAErB,MAAO,IAAI,GAAM,EAAM,EAAE,KAAK,EAAI,EAAM,EAAE,KAAK,EAAI,KAAK,GAAI,EAAM,EAAE,KAAK,EAAI,EAAM,EAAE,KAAK,EAAI,KAAK,IAW7F,GAAA,UAAA,UAAP,SAAiB,EAAW,GAE3B,KAAK,IAAM,CACX,MAAK,IAAM,EAEb,OAAA,KAEgB,GAAA,QAAP,mGC/jBT,GAAO,GAAa,EAAa,qCAEjC,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAa,EAAa,uCAEjC,IAAM,GAAQ,WAab,QAbK,GAaO,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAEX,GAAI,GAAK,MAAQ,EAAE,QAAU,GAC5B,KAAK,QAAU,EAAE,aAEjB,MAAK,SAAY,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAMzD,EAAA,UAAA,OAAP,SAAc,GAEb,GAAI,GAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAE39B,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,EAMtD,GAAA,UAAA,eAAP,SAAsB,EAAgB,GAErC,GAAI,GAAa,EAAS,gBAAgB,EAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAElE,MAAK,OAAO,GAMN,GAAA,UAAA,YAAP,SAAmB,EAAe,EAAe,GAEhD,KAAK,OAAO,GAAI,IAAW,EAAQ,EAAK,EAAK,EAAK,EAAK,EAAQ,EAAK,EAAK,EAAK,EAAK,EAAQ,EAAK,EAAK,EAAK,EAAK,KAMzG,GAAA,UAAA,kBAAP,SAAyB,EAAU,EAAU,GAE5C,KAAK,QAAQ,KAAO,CACpB,MAAK,QAAQ,KAAO,CACpB,MAAK,QAAQ,KAAO,EAMd,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAS,KAAK,QAAQ,MAAM,IAMjC,GAAA,UAAA,eAAP,SAAsB,EAAe,GAEpC,OAAQ,GACP,IAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MACD,KAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MACD,KAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,KAAK,GACJ,KAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,SACC,KAAM,IAAI,GAAc,yBAA2B,EAAS,+BAOxD,GAAA,UAAA,aAAP,SAAoB,EAAe,GAElC,OAAQ,GACP,IAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,SACC,KAAM,IAAI,GAAc,yBAA2B,EAAS,+BAOxD,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAAa,EAAe,QAAQ,MACxC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,QAAQ,GAAK,EAAe,QAAQ,GAGpC,GAAA,UAAA,gBAAP,SAAuB,EAAiB,EAAkB,GAAlB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAyB,CAAzB,EAAA,MAEzD,GAAI,EACH,KAAK,WAEN,IAAI,GAAa,EAAO,OAAS,CACjC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,QAAQ,GAAK,EAAO,EAAI,EAE9B,IAAI,EACH,KAAK,YAGA,GAAA,UAAA,cAAP,SAAqB,EAAiB,EAAkB,GAAlB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAyB,CAAzB,EAAA,MAEvD,GAAI,EACH,KAAK,WAEN,IAAI,GAAa,KAAK,QAAQ,MAC9B,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,EAAO,EAAI,GAAU,KAAK,QAAQ,EAEnC,IAAI,EACH,KAAK,YAMA,GAAA,UAAA,YAAP,SAAmB,EAAY,GAE9B,OAAQ,GACP,IAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,KAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,KAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,KAAK,GACJ,KAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,GAAM,EAAS,CAC7B,MAAK,QAAS,IAAO,EAAS,CAC9B,MAAK,QAAS,IAAO,EAAS,CAC9B,MACD,SACC,KAAM,IAAI,GAAc,sBAAwB,EAAM,+BAOlD,GAAA,UAAA,UAAP,SAAiB,EAAY,GAE5B,OAAQ,GACP,IAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,KAAK,GACJ,EAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,EAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,GAAS,EAAI,KAAK,QAAS,GAC3B,MACD,SACC,KAAM,IAAI,GAAc,sBAAwB,EAAM,+BAOlD,GAAA,UAAA,eAAP,SAAsB,GAErB,EAAK,QAAU,KAAK,QAAQ,MAAM,GAM5B,GAAA,UAAA,UAAP,SAAiB,GAAA,GAAA,QAAA,GAAuC,CAAvC,EAAA,cAEhB,GAAI,MAIA,KACJ,IAAI,GAAI,KAAK,OACb,IAAI,GAAK,EAAE,OAEX,IAAI,GAAe,GAAI,GAAS,EAAG,IAAK,EAAG,IAAK,EAAG,IACnD,GAAG,IAAM,CACT,GAAG,IAAM,CACT,GAAG,IAAM,CAET,IAAI,GAAiB,GAAI,EAEzB,GAAM,EAAI,KAAK,KAAK,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,GACzD,GAAM,EAAI,KAAK,KAAK,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,GACzD,GAAM,EAAI,KAAK,KAAK,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,GAAK,EAAG,IAAI,EAAG,IAE1D,IAAI,EAAG,IAAI,EAAG,GAAG,EAAG,IAAM,EAAG,GAAG,EAAG,IAAM,EAAG,IAAI,EAAG,GAAG,EAAG,IAAM,EAAG,GAAG,EAAG,IAAM,EAAG,IAAI,EAAG,GAAG,EAAG,GAAK,EAAG,GAAG,EAAG,IAAM,EACjH,EAAM,GAAK,EAAM,CAElB,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,IAAM,EAAM,CACf,GAAG,KAAO,EAAM,CAEhB,IAAI,GAAM,GAAI,EAEd,QAAQ,GACP,IAAK,GAAc,WAElB,EAAI,EAAI,KAAK,MAAM,EAAG,GAAK,EAAG,GAAK,EAAG,IAAM,GAAG,EAE/C,IAAI,GAAa,KAAK,MAAM,EAAG,GAAK,EAAG,KAAK,EAAG,GAAK,EAAG,KAAO,EAAG,GAAK,EAAG,KAAK,EAAG,GAAK,EAAG,KAAO,EAAG,GAAK,EAAG,KAAK,EAAG,GAAK,EAAG,IAC3H,GAAI,GAAK,EAAG,GAAK,EAAG,IAAI,CACxB,GAAI,GAAK,EAAG,GAAK,EAAG,IAAI,CACxB,GAAI,GAAK,EAAG,GAAK,EAAG,IAAI,CAExB,MACD,KAAK,GAAc,WAElB,GAAI,GAAK,EAAG,GAAK,EAAG,GAAK,EAAG,GAE5B,IAAI,EAAK,EAAG,CACX,EAAI,EAAI,KAAK,KAAK,EAAI,GAAI,CAE1B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,OACzB,IAAK,EAAG,GAAK,EAAG,IAAQ,EAAG,GAAK,EAAG,IAAM,CAC/C,EAAI,EAAI,KAAK,KAAK,EAAI,EAAG,GAAK,EAAG,GAAK,EAAG,KAAK,CAE9C,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,OACzB,IAAI,EAAG,GAAK,EAAG,IAAK,CAC1B,EAAI,EAAI,KAAK,KAAK,EAAI,EAAG,GAAK,EAAG,GAAK,EAAG,KAAK,CAE9C,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,OACzB,CACN,EAAI,EAAI,KAAK,KAAK,EAAI,EAAG,IAAM,EAAG,GAAK,EAAG,IAAI,CAE9C,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,EAC/B,GAAI,GAAK,EAAG,GAAK,EAAG,KAAK,EAAE,EAAI,GAIhC,KACD,KAAK,GAAc,aAElB,EAAI,EAAI,KAAK,MAAM,EAAG,GAItB,IAAI,EAAG,IAAM,GAAK,EAAG,KAAO,EAAG,CAC9B,EAAI,EAAI,KAAK,MAAM,EAAG,GAAI,EAAG,IAC7B,GAAI,EAAI,KAAK,MAAM,EAAG,GAAI,EAAG,QACvB,CACN,EAAI,EAAI,CACR,GAAI,EAAI,KAAK,MAAM,EAAG,GAAI,EAAG,IAG9B,MAGF,EAAI,KAAK,EACT,GAAI,KAAK,EACT,GAAI,KAAK,EAET,OAAO,GAOD,GAAA,UAAA,qBAAP,SAA4B,GAE3B,GAAI,GAAW,EAAE,CACjB,IAAI,GAAW,EAAE,CACjB,IAAI,GAAW,EAAE,CAEjB,OAAO,IAAI,GAAU,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAM,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAM,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,IAAO,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,KAM9P,GAAA,UAAA,SAAP,WAEC,KAAK,SAAW,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAMvD,GAAA,YAAP,SAAmB,EAAkB,EAAgB,GAEpD,GAAI,GAAa,GAAI,EACrB,KAAK,GAAI,GAAW,EAAG,EAAI,KAAM,EAChC,EAAE,QAAQ,GAAK,EAAQ,QAAQ,IAAM,EAAM,QAAQ,GAAK,EAAQ,QAAQ,IAAI,CAE7E,OAAO,GAMD,GAAA,UAAA,cAAP,SAAqB,EAAgB,GAEpC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAM,EAChC,KAAK,QAAQ,GAAK,KAAK,QAAQ,IAAM,EAAM,QAAQ,GAAK,KAAK,QAAQ,IAAI,EAMpE,GAAA,UAAA,OAAP,WAEC,GAAI,GAAI,KAAK,WACb,IAAI,GAAa,KAAK,IAAI,GAAK,KAE/B,IAAI,EAAY,CACf,EAAI,EAAE,CACN,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,GAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,GAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,GAC9B,IAAI,GAAa,KAAK,QAAQ,GAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,EAC9B,IAAI,GAAa,KAAK,QAAQ,GAC9B,IAAI,GAAa,KAAK,QAAQ,GAE9B,MAAK,QAAQ,GAAK,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC5F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,GAAK,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC5F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,GAAK,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC5F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,GAAK,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC5F,MAAK,QAAQ,GAAK,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC5F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,KAAO,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC9F,MAAK,QAAQ,KAAO,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC9F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC7F,MAAK,QAAQ,KAAO,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAC9F,MAAK,QAAQ,IAAM,GAAG,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,GAAO,GAAK,EAAI,EAAM,EAAI,IAE9F,MAAO,GAYD,GAAA,UAAA,QAAP,SAAe,GAEd,GAAI,GAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,GAAI,EAAc,EAAI,QAAQ,IAAK,EAAc,EAAI,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,GAAI,EAAc,KAAK,QAAQ,IAAK,EAAc,KAAK,QAAQ,GAE39B,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,GAAK,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC3D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAE5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,CAC5D,MAAK,QAAQ,IAAM,EAAK,EAAO,EAAK,EAAO,EAAK,EAAO,EAAK,EAMtD,GAAA,UAAA,gBAAP,SAAuB,EAAgB,GAEtC,GAAI,GAAa,EAAS,gBAAgB,EAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EASlE,MAAK,QAAQ,GAMP,GAAA,UAAA,aAAP,SAAoB,EAAe,EAAe,GAKjD,KAAK,QAAQ,GAAI,IAAW,EAAQ,EAAG,EAAG,EAAG,EAAG,EAAQ,EAAG,EAAG,EAAG,EAAG,EAAQ,EAAG,EAAG,EAAG,EAAG,KAMlF,GAAA,UAAA,mBAAP,SAA0B,EAAU,EAAU,GAK7C,GAAI,GAAI,GAAI,EACZ,GAAE,SAAW,GAAI,GAAS,EAAG,EAAG,EAChC,MAAK,QAAQ,GAOP,GAAA,UAAA,UAAP,SAAiB,GAKhB,GAAI,EAAW,OAAS,EAAG,MAAO,MAIlC,MAAK,UACL,MAAK,YAAY,EAAW,GAAG,EAAG,EAAW,GAAG,EAAG,EAAW,GAAG,EAEjE,IAAI,EACJ,IAAS,EAAW,GAAG,CACvB,MAAK,OAAO,GAAI,IAAU,EAAG,EAAG,EAAG,EAAG,EAAG,KAAK,IAAI,IAAS,KAAK,IAAI,GAAQ,EAAG,EAAG,KAAK,IAAI,GAAQ,KAAK,IAAI,GAAQ,EAAG,EAAG,EAAG,EAAI,IACjI,IAAS,EAAW,GAAG,CACvB,MAAK,OAAO,GAAI,IAAU,KAAK,IAAI,GAAQ,EAAG,KAAK,IAAI,GAAQ,EAAG,EAAG,EAAG,EAAG,GAAI,KAAK,IAAI,GAAQ,EAAG,KAAK,IAAI,GAAQ,EAAG,EAAG,EAAG,EAAG,IAChI,IAAS,EAAW,GAAG,CACvB,MAAK,OAAO,GAAI,IAAU,KAAK,IAAI,IAAS,KAAK,IAAI,GAAQ,EAAG,EAAG,KAAK,IAAI,GAAQ,KAAK,IAAI,GAAQ,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAEhI,MAAK,SAAW,EAAW,EAC3B,MAAK,QAAQ,IAAM,CAEnB,OAAO,MAGD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,GAAW,EAAE,CACjB,IAAI,GAAW,EAAE,CACjB,IAAI,GAAW,EAAE,CAEjB,OAAO,IAAI,GAAU,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,KAAK,QAAQ,IAAO,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,KAAK,QAAQ,IAAO,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAO,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,IAAM,KAAK,QAAQ,KAM1U,GAAA,UAAA,iBAAP,SAAwB,EAAc,GAKrC,GAAI,GAAW,CACf,IAAI,GAAW,EAAG,EAAW,EAAG,EAAW,CAE3C,OAAO,EAAI,GAAK,EAAI,OAAQ,CAC3B,EAAI,EAAI,EACR,GAAI,EAAI,EAAI,EACZ,GAAI,EAAI,EAAI,EACZ,GAAK,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,KAAK,QAAQ,GACnF,GAAK,EAAI,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,KAAK,QAAQ,GACvF,GAAK,EAAI,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,GAAK,EAAE,KAAK,QAAQ,IAAM,KAAK,QAAQ,GACxF,IAAK,GAOA,GAAA,UAAA,UAAP,WAKC,GAAI,GAAoB,KAAK,QAAQ,MAAM,EAE3C,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,GAAK,EAAS,GAC3B,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,GAAK,EAAS,GAC3B,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,GAAK,EAAS,EAC3B,MAAK,QAAQ,IAAM,EAAS,GAC5B,MAAK,QAAQ,IAAM,EAAS,EAC5B,MAAK,QAAQ,IAAM,EAAS,EAC5B,MAAK,QAAQ,IAAM,EAAS,IAGtB,GAAA,gBAAP,SAAuB,EAAU,EAAU,EAAU,GAKpD,GAAI,GAAa,GAAI,EAErB,IAAI,GAAM,GAAU,KAAK,GAAG,IAC5B,IAAI,GAAW,KAAK,IAAI,EACxB,IAAI,GAAW,KAAK,IAAI,EACxB,IAAI,GAAW,EAAI,CACnB,IAAI,GAAa,CAEjB,GAAE,QAAQ,GAAK,EAAI,EAAE,EAAE,CACvB;EAAE,QAAQ,GAAK,EAAI,EAAE,EAAE,CACvB,GAAE,QAAQ,IAAM,EAAI,EAAE,EAAE,CAExB,GAAO,EAAE,EAAE,CACX,GAAO,EAAE,CACT,GAAE,QAAQ,GAAK,EAAO,CACtB,GAAE,QAAQ,GAAK,EAAO,CACtB,GAAO,EAAE,EAAE,CACX,GAAO,EAAE,CACT,GAAE,QAAQ,GAAK,EAAO,CACtB,GAAE,QAAQ,GAAK,EAAO,CACtB,GAAO,EAAE,EAAE,CACX,GAAO,EAAE,CACT,GAAE,QAAQ,GAAK,EAAO,CACtB,GAAE,QAAQ,GAAK,EAAO,CAEtB,OAAO,GAMR,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,OAAY,KAAK,QAAQ,GAAG,KAAK,QAAQ,GAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,KAAK,KAAK,QAAQ,IAAI,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,MAAQ,KAAK,QAAQ,GAAG,KAAK,QAAQ,GAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAO,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAO,KAAK,QAAQ,GAAG,KAAK,QAAQ,GAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAO,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAO,KAAK,QAAQ,GAAG,KAAK,QAAQ,IAAM,KAAK,QAAQ,IAAI,KAAK,QAAQ,KAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,GAAK,KAAK,QAAQ,GAAG,KAAK,QAAQ,wCAOp1B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,IAAI,GAAS,KAAK,QAAQ,IAAK,KAAK,QAAQ,IAAK,KAAK,QAAQ,UAGtE,SAAoB,GAEnB,KAAK,QAAQ,IAAM,EAAM,CACzB,MAAK,QAAQ,IAAM,EAAM,CACzB,MAAK,QAAQ,IAAM,EAAM,sCAGnB,GAAA,UAAA,QAAP,SAAe,GAEd,GAAI,GAAmB,KAAK,IAAI,GAAI,EACpC,OAAO,YAAc,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,GAAW,EAAY,IAG/4B,GAAA,UAAA,SAAP,WAEC,MAAO,YAAc,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,GAAG,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAAM,KAAK,MAAM,KAAK,QAAQ,IAAI,KAAM,IAAO,IAEvvB,OAAA,KAEA,GAAkB,QAAT,iJCvrBH,GAAa,WAAnB,QAAM,MAMS,EAAA,WAAoB,WAMpB,GAAA,aAAsB,aAMtB,GAAA,WAAoB,YACnC,OAAA,KAEA,GAAuB,QAAd,8BCFH,GAAK,WA2BV,QA3BK,GA2BO,EAAc,GAAd,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAEzB,KAAK,EAAI,CACT,MAAK,EAAI,EAfV,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,KAAK,KAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,uCAuBvC,GAAA,UAAA,IAAP,SAAW,GAEV,MAAO,IAAI,GAAM,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,GAQpC,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAM,KAAK,EAAG,KAAK,GAGxB,GAAA,UAAA,SAAP,SAAgB,IAaT,GAAA,UAAA,OAAP,SAAc,GAEb,MAAQ,MAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,EAW/C,GAAA,UAAA,UAAP,SAAiB,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,EAEhB,GAAI,KAAK,QAAU,EAAG,CACrB,GAAI,GAAY,EAAU,KAAK,MAC/B,MAAK,GAAK,CACV,MAAK,GAAK,CACV,QAED,KAAM,gCAaA,GAAA,UAAA,OAAP,SAAc,EAAW,GAExB,KAAK,GAAK,CACV,MAAK,GAAK,EAGJ,GAAA,UAAA,MAAP,SAAa,EAAW,IAYjB,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,IAAI,GAAM,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,GAWpC,GAAA,UAAA,SAAP,WAEC,MAAO,cAAgB,KAAK,EAAI,OAAS,KAAK,EAAI,IAUrC,GAAA,SAAd,SAAuB,EAAW,GAEjC,GAAI,GAAY,EAAI,EAAI,EAAI,CAC5B,IAAI,GAAY,EAAI,EAAI,EAAI,CAE5B,OAAO,MAAK,KAAK,EAAG,EAAK,EAAG,GAsBf,GAAA,YAAd,SAA0B,EAAW,EAAW,GAE/C,MAAO,IAAI,GAAM,EAAI,GAAK,EAAI,EAAI,EAAI,GAAG,EAAG,EAAI,GAAK,EAAI,EAAI,EAAI,GAAG,GAUvD,GAAA,MAAd,SAAoB,EAAY,GAE/B,MAAO,IAAI,GAAM,EAAI,KAAK,IAAI,GAAQ,EAAI,KAAK,IAAI,IAErD,OAAA,KAEA,GAAe,QAAN,2BCpNT,GAAO,GAAK,EAAe,iCA8CrB,GAAS,WAoJd,QApJK,GAoJO,EAAc,EAAc,EAAkB,GAA9C,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAEzD,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,EA5Gf,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,EAAI,KAAK,2CAOtB,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,GAAI,KAAK,cAAgB,KACxB,KAAK,aAAe,GAAI,EAEzB,MAAK,aAAa,EAAI,KAAK,EAAI,KAAK,KACpC,MAAK,aAAa,EAAI,KAAK,EAAI,KAAK,MAEpC,OAAO,MAAK,iDAab,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,sCAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,EAAI,KAAK,0CAOtB,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,GAAI,KAAK,OAAS,KACjB,KAAK,MAAQ,GAAI,EAElB,MAAK,MAAM,EAAI,KAAK,KACpB,MAAK,MAAM,EAAI,KAAK,MAEpB,OAAO,MAAK,0CAab,QAAA,eAAW,EAAA,UAAA,WAAX,WAEC,MAAO,MAAK,sCAOb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,GAAI,KAAK,UAAY,KACpB,KAAK,SAAW,GAAI,EAErB,MAAK,SAAS,EAAI,KAAK,CACvB,MAAK,SAAS,EAAI,KAAK,CAEvB,OAAO,MAAK,6CAmCN,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAU,KAAK,EAAG,KAAK,EAAG,KAAK,MAAO,KAAK,QAYhD,GAAA,UAAA,SAAP,SAAgB,EAAU,GAEzB,MAAQ,MAAK,GAAK,GAAK,KAAK,EAAI,KAAK,OAAS,GAAK,KAAK,GAAK,GAAK,KAAK,EAAI,KAAK,QAAU,EAcpF,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAQ,MAAK,GAAK,EAAM,GAAK,KAAK,EAAI,KAAK,OAAS,EAAM,GAAK,KAAK,GAAK,EAAM,GAAK,KAAK,EAAI,KAAK,QAAU,EAAM,EAc5G,GAAA,UAAA,aAAP,SAAoB,GAEnB,MAAQ,MAAK,GAAK,EAAK,GAAK,KAAK,EAAI,KAAK,OAAS,EAAK,EAAI,EAAK,OAAS,KAAK,GAAK,EAAK,GAAK,KAAK,EAAI,KAAK,QAAU,EAAK,EAAI,EAAK,OAS9H,GAAA,UAAA,SAAP,SAAgB,IAkBT,GAAA,UAAA,OAAP,SAAc,GAEb,MAAQ,MAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,GAAK,KAAK,OAAS,EAAU,OAAS,KAAK,QAAU,EAAU,OAgB9G,GAAA,UAAA,QAAP,SAAe,EAAW,GAEzB,KAAK,GAAK,EAAG,CACb,MAAK,GAAK,EAAG,CACb,MAAK,OAAS,EAAG,CACjB,MAAK,QAAU,EAAG,EAeZ,GAAA,UAAA,aAAP,SAAoB,GAEnB,KAAK,GAAK,EAAM,EAAE,CAClB,MAAK,GAAK,EAAM,EAAE,CAClB,MAAK,OAAS,EAAM,EAAE,CACtB,MAAK,QAAU,EAAM,EAAE,EAkBjB,GAAA,UAAA,aAAP,SAAoB,GAEnB,GAAI,KAAK,WAAW,GAAc,CACjC,GAAI,GAAc,GAAI,EAEtB,IAAI,KAAK,EAAI,EAAY,EAAG,CAC3B,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAY,EAAI,KAAK,EAAI,EAAY,KAE/C,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAY,CAClB,GAAE,MAAQ,KAAK,EAAI,EAAY,EAAI,KAAK,KAExC,IAAI,EAAE,MAAQ,EAAY,MACzB,EAAE,MAAQ,EAAY,MAGxB,GAAI,KAAK,EAAI,EAAY,EAAG,CAC3B,EAAE,EAAI,KAAK,CACX,GAAE,OAAS,EAAY,EAAI,KAAK,EAAI,EAAY,MAEhD,IAAI,EAAE,OAAS,KAAK,OACnB,EAAE,OAAS,KAAK,WACX,CACN,EAAE,EAAI,EAAY,CAClB,GAAE,OAAS,KAAK,EAAI,EAAY,EAAI,KAAK,MAEzC,IAAI,EAAE,OAAS,EAAY,OAC1B,EAAE,OAAS,EAAY,OAGzB,MAAO,GAGR,MAAO,IAAI,GAeL,GAAA,UAAA,WAAP,SAAkB,GAEjB,MAAQ,MAAK,EAAI,KAAK,MAAQ,EAAY,GAAK,KAAK,EAAI,EAAY,EAAI,EAAY,OAAS,KAAK,EAAI,KAAK,OAAS,EAAY,GAAK,KAAK,EAAI,EAAY,EAAI,EAAY,OASpK,GAAA,UAAA,QAAP,WAEC,MAAQ,MAAK,GAAK,GAAK,KAAK,GAAK,GAAK,KAAK,OAAS,GAAK,KAAK,QAAU,EAUlE,GAAA,UAAA,OAAP,SAAc,EAAW,GAExB,KAAK,GAAK,CACV,MAAK,GAAK,EAUJ,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,GAAK,EAAM,CAChB,MAAK,GAAK,EAAM,EAWV,GAAA,UAAA,SAAP,WAEC,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,EAaR,GAAA,UAAA,MAAP,SAAa,EAAW,EAAW,EAAe,GAEjD,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,EAWR,GAAA,UAAA,SAAP,WAEC,MAAO,kBAAoB,KAAK,EAAI,OAAS,KAAK,EAAI,WAAa,KAAK,MAAQ,YAAc,KAAK,OAAS,IActG,GAAA,UAAA,MAAP,SAAa,GAEZ,GAAI,GAAc,GAAI,EAEtB,IAAI,KAAK,EAAI,EAAQ,EAAG,CACvB,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAQ,EAAI,KAAK,EAAI,EAAQ,KAEvC,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAQ,CACd,GAAE,MAAQ,KAAK,EAAI,EAAQ,EAAI,KAAK,KAEpC,IAAI,EAAE,MAAQ,EAAQ,MACrB,EAAE,MAAQ,EAAQ,MAGpB,GAAI,KAAK,EAAI,EAAQ,EAAG,CACvB,EAAE,EAAI,KAAK,CACX,GAAE,OAAS,EAAQ,EAAI,KAAK,EAAI,EAAQ,MAExC,IAAI,EAAE,OAAS,KAAK,OACnB,EAAE,OAAS,KAAK,WACX,CACN,EAAE,EAAI,EAAQ,CACd,GAAE,OAAS,KAAK,EAAI,EAAQ,EAAI,KAAK,MAErC,IAAI,EAAE,OAAS,EAAQ,OACtB,EAAE,OAAS,EAAQ,OAGrB,MAAO,GAET,OAAA,KAEA,GAAmB,QAAV,6DC5fH,GAAQ,WA8Fb,QA9FK,GA8FO,EAAc,EAAc,EAAc,GAA1C,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAErD,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,EAjCV,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,KAAK,KAAK,mDAUvB,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,sCAoC7C,GAAA,UAAA,IAAP,SAAW,GAEV,MAAO,IAAI,GAAS,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,GAoB5D,GAAA,aAAd,SAA2B,EAAY,GAEtC,MAAO,MAAK,KAAK,EAAE,WAAW,IAAI,EAAE,OAAO,EAAE,SAUvC,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAS,KAAK,EAAG,KAAK,EAAG,KAAK,EAAG,KAAK,GAS3C,GAAA,UAAA,SAAP,SAAgB,GAEf,KAAK,EAAI,EAAI,CACb,MAAK,EAAI,EAAI,CACb,MAAK,EAAI,EAAI,CACb,MAAK,EAAI,EAAI,EAoBP,GAAA,UAAA,aAAP,SAAoB,GAEnB,MAAO,IAAI,GAAS,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAG,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAG,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAG,GAczF,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,GAAK,EAAE,CACZ,MAAK,GAAK,EAAE,CACZ,MAAK,GAAK,EAAE,EAaN,GAAA,SAAP,SAAgB,EAAc,GAE7B,GAAI,GAAY,EAAI,EAAI,EAAI,CAC5B,IAAI,GAAY,EAAI,EAAI,EAAI,CAC5B,IAAI,GAAY,EAAI,EAAI,EAAI,CAC5B,OAAO,MAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,GA8BzB,GAAA,UAAA,WAAP,SAAkB,GAEjB,MAAO,MAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAsBpC,GAAA,UAAA,OAAP,SAAc,EAAoB,GAAA,GAAA,QAAA,GAAuB,CAAvB,EAAA,MAEjC,MAAQ,MAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,KAAO,GAAW,KAAK,GAAK,EAAU,GAa9G,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,GAAK,EAAE,CACZ,MAAK,GAAK,EAAE,CACZ,MAAK,GAAK,EAAE,EAoCN,GAAA,UAAA,WAAP,SAAkB,EAAoB,EAAkB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEvD,MAAS,MAAK,IAAI,KAAK,EAAI,EAAU,GAAK,GAAe,KAAK,IAAI,KAAK,EAAI,EAAU,GAAK,GAAe,KAAK,IAAI,KAAK,EAAI,EAAU,GAAK,KAAgB,GAAW,KAAK,IAAI,KAAK,EAAI,EAAU,GAAK,GAShM,GAAA,UAAA,OAAP,WAEC,KAAK,GAAK,KAAK,CACf,MAAK,GAAK,KAAK,CACf,MAAK,GAAK,KAAK,EAiBT,GAAA,UAAA,UAAP,SAAiB,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,EAEhB,GAAI,KAAK,QAAU,EAAG,CACrB,GAAI,GAAY,EAAU,KAAK,MAC/B,MAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,CACV,SAgBK,GAAA,UAAA,QAAP,WAEC,KAAK,GAAK,KAAK,CACf,MAAK,GAAK,KAAK,CACf,MAAK,GAAK,KAAK,EAcT,GAAA,UAAA,QAAP,SAAe,GAEd,KAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,EAUJ,GAAA,UAAA,MAAP,SAAa,EAAW,EAAW,GAElC,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,EAiBH,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,IAAI,GAAS,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,EAAG,KAAK,EAAI,EAAE,GAOrD,GAAA,UAAA,SAAP,WAEC,MAAO,iBAAmB,KAAK,EAAI,OAAS,KAAK,EAAI,MAAQ,KAAK,EAAI,OAAS,KAAK,EAAI,IA/b3E,GAAA,OAAkB,GAAI,GAAS,EAAG,EAAG,EAKrC,GAAA,OAAkB,GAAI,GAAS,EAAG,EAAG,EAKrC,GAAA,OAAkB,GAAI,GAAS,EAAG,EAAG,EAubpD,OAAA,KAEA,GAAkB,QAAT,2BCleT,GAAM,GAAS,WAAf,QAAM,MAES,EAAA,eAAwB,eACxB,GAAA,cAAuB,cACvB,GAAA,gBAAyB,gBACzB,GAAA,SAAkB,UAClB,GAAA,UAAmB,WACnB,GAAA,OAAgB,QAChB,GAAA,UAAmB,WACnB,GAAA,eAAwB,eACxB,GAAA,SAAkB,UAClB,GAAA,aAAsB,aACtB,GAAA,MAAe,OACf,GAAA,aAAsB,aACtB,GAAA,SAAkB,UAClB,GAAA,KAAc,MACd,GAAA,kBAA2B,iBAC3B,GAAA,cAAuB,aACvB,GAAA,iBAA0B,iBAC1B,GAAA,kBAA2B,iBAC3B,GAAA,SAAkB,UAClB,GAAA,cAAuB,cACvB,GAAA,OAAgB,QAChB,GAAA,iBAA0B,iBAC1B,GAAA,QAAiB,SACjB,GAAA,kBAA2B,kBAC1C,OAAA,KAEA,GAAmB,QAAV,yLC3BT,IAAO,GAAmB,EAAY,6CACtC,IAAO,GAAU,EAAc,oCAC/B,IAAO,GAAe,EAAa,yCAEnC,IAAM,GAAc,SAAA,GAAS,EAAvB,EAAc,EAYnB,SAZK,GAYO,GAAA,GAAA,QAAA,GAAkB,CAAlB,EAAA,KAEX,EAAA,KAAA,KAEA,MAAK,IAAM,EAAe,UAE1B,IAAI,GAAQ,KACX,EAAO,MAER,MAAK,MAAQ,CACb,MAAK,cAAgB,CAErB,MAAK,iBAMN,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,KAAM,IAAI,uCAQX,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,UAAX,WAEC,MAAO,MAAK,wCAGb,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,WAGb,SAAgB,GAEf,GAAI,EAEJ,GAAO,KAAK,KACZ,MAAK,MAAQ,CAEb,IAAI,KAAK,OAAS,KACjB,KAAK,MAAQ,MAEd,MAAK,gBAGL,MAAK,cAAc,GAAI,GAAW,EAAW,aAAuB,KAAM,wCAIpE,GAAA,UAAA,QAAP,WAEC,KAAM,IAAI,GAGX,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,+CAGb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,+CAGN,GAAA,UAAA,gBAAP,SAAuB,EAAa,GAEnC,MAAQ,MAAK,OAAS,KAAU,GAAM,KAAK,YAAc,GAGnD,GAAA,UAAA,eAAP,SAAsB,EAAa,EAAkB,GAAlB,GAAA,QAAA,GAAgB,CAAhB,EAAA,KAAkB,GAAA,QAAA,GAA+B,CAA/B,EAAA,KAGpD,KAAK,MAAQ,EAAM,EAAO,MAC1B,MAAK,WAAa,EAAI,EAAK,EAAe,iBAE1C,IAAI,EACH,KAAK,cAAgB,KAAK,KAE3B,MAAK,iBAGE,GAAA,UAAA,eAAR,WAEC,KAAK,YAAe,KAAK,WAAY,KAAK,OA3G7B,GAAA,SAAkB,CAQlB,GAAA,kBAA2B,SAqG1C,OAAA,IA/G6B,EAiHL,GAAA,QAAf,wTCtHT,IAAO,GAAmB,EAAa,0CAEvC,IAAO,GAAgB,EAAc,uCACrC,IAAO,GAAY,EAAe,mCAClC,IAAO,GAAS,EAAe,+BAC/B,IAAO,GAAe,EAAc,yCACpC,IAAO,GAAe,EAAc,yCACpC,IAAO,GAAY,EAAe,sCAClC,IAAO,GAAiB,EAAa,2CAY/B,GAAS,SAAA,GAAS,EAAlB,EAAS,EAmBd,SAnBK,KAqBJ,EAAA,KAAA,KAlBO,MAAA,aAAsB,CACtB,MAAA,YAAqB,CACrB,MAAA,YAAqB,EAAoB,IACzC,MAAA,WAAqB,MAqB7B,OAAA,eAAW,EAAA,UAAA,WAAX,WAGC,MAAO,MAAK,SAAU,KAAK,SAAS,IAAM,uCAM3C,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAYb,QAAA,eAAW,EAAA,UAAA,kBAKX,WAEC,MAAO,MAAK,iBAPb,SAAsB,GAErB,KAAK,YAAc,sCAYpB,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAOb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAQN,GAAA,UAAA,KAAP,SAAY,GAEX,KAAK,SAAW,CAEhB,MAAK,SAEL,IAAI,EAAQ,SAAW,EAAiB,KACvC,KAAK,YAAY,OAEjB,MAAK,WAAW,GAMX,GAAA,UAAA,MAAP,WAEC,KAAK,KAAK,OACV,MAAK,aAMC,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,KACR,KAAK,KAAK,OAEX,MAAK,YAEL,MAAK,MAAQ,IACb,MAAK,YAAc,IACnB,MAAK,aAAe,IACpB,MAAK,YAAc,KAQZ,GAAA,UAAA,gBAAR,SAAwB,EAAoB,GAE3C,OAAQ,GACP,IAAK,GAAoB,aACzB,IAAK,GAAoB,KACzB,IAAK,GAAoB,KACxB,EAAI,aAAe,CACnB,MAED,KAAK,GAAoB,UACxB,EAAI,aAAe,EAAoB,IACvC,MAED,KAAK,GAAoB,OACxB,EAAI,aAAe,EACnB,MAED,WAQM,GAAA,UAAA,WAAR,SAAmB,GAElB,IACC,KAAK,KAAK,KAAK,EAAQ,OAAQ,EAAQ,IAAK,EAAQ,MACpD,MAAK,gBAAgB,KAAK,KAAM,KAAK,YACrC,MAAK,KAAK,OACT,MAAO,GACR,KAAK,8BAA8B,IAQ7B,GAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,WAAa,KAElB,MAAK,KAAK,KAAK,EAAQ,OAAQ,EAAQ,IAAK,EAAQ,MAEpD,IAAI,EAAQ,MAAQ,KAAM,CACzB,GAAI,EAAQ,eAAgB,GAAc,CACzC,GAAI,GAAsC,EAAQ,IAElD,KACC,KAAK,KAAK,aAAe,MACzB,MAAK,KAAK,KAAK,EAAQ,UACtB,MAAO,GACR,KAAK,8BAA8B,QAE9B,CACN,KAAK,gBAAgB,KAAK,KAAM,KAAK,YAErC,IAAI,EAAQ,KACX,KAAK,KAAK,KAAK,EAAQ,UAEvB,MAAK,KAAK,YAEN,CACN,KAAK,KAAK,QASJ,GAAA,UAAA,8BAAR,SAAsC,GAErC,OAAQ,EAAM,MASb,IAAK,KAEJ,OAOK,GAAA,UAAA,QAAR,WAAA,GAAA,GAAA,IAEC,KAAK,KAAK,KAAM,CACf,KAAK,KAAO,GAAI,eAEhB,MAAK,KAAK,YAAc,SAAC,GAAwB,MAAA,GAAK,YAAY,GAClE,MAAK,KAAK,WAAa,SAAC,GAAwB,MAAA,GAAK,WAAW,GAChE,MAAK,KAAK,QAAU,SAAC,GAAkB,MAAA,GAAK,QAAQ,GACpD,MAAK,KAAK,QAAU,SAAC,GAAqB,MAAA,GAAK,YAAY,GAC3D,MAAK,KAAK,OAAS,SAAC,GAAgB,MAAA,GAAK,eAAe,GACxD,MAAK,KAAK,UAAY,SAAC,GAAgB,MAAA,GAAK,UAAU,GACtD,MAAK,KAAK,UAAY,SAAC,GAAwB,MAAA,GAAK,UAAU,GAC9D,MAAK,KAAK,mBAAqB,SAAC,GAAgB,MAAA,GAAK,mBAAmB,KAOlE,GAAA,UAAA,WAAR,WAEC,GAAI,KAAK,OAAS,KAAM,CACvB,KAAK,KAAK,YAAc,IACxB,MAAK,KAAK,WAAa,IACvB,MAAK,KAAK,QAAU,IACpB,MAAK,KAAK,QAAU,IACpB,MAAK,KAAK,OAAS,IACnB,MAAK,KAAK,UAAY,IACtB,MAAK,KAAK,UAAY,IACtB,MAAK,KAAO,MAQP,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,GAAgB,GAAI,OAExB,GAAS,EAAO,MAAM,KAAK,KAAK,IAEhC,IAAI,GAAQ,EAAK,uBAEjB,OAAO,EAAS,EAAG,KAAK,GACvB,EAAO,mBAAmB,EAAO,KAAO,mBAAmB,EAAO,GAEnE,OAAO,GASA,GAAA,UAAA,mBAAR,SAA2B,GAE1B,GAAI,KAAK,KAAK,YAAc,EAAG,CAC9B,GAAI,KAAK,KAAK,QAAU,IAAK,CAC5B,KAAK,WAAa,IAElB,KAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAa,EAAa,SAEtD,MAAK,cAAc,KAAK,iBAGzB,KAAK,cAAc,GAAI,GAAgB,EAAgB,YAAa,KAAK,KAAK,UAQxE,GAAA,UAAA,UAAR,SAAkB,GAEjB,GAAI,KAAK,aAAe,KACvB,OAOM,GAAA,UAAA,UAAR,SAAkB,IASV,GAAA,UAAA,QAAR,SAAgB,IASR,GAAA,UAAA,WAAR,SAAmB,GAElB,IAAK,KAAK,eACT,KAAK,eAAiB,GAAI,GAAkB,EAAkB,SAE/D,MAAK,eAAe,WAAa,EAAM,KACvC,MAAK,eAAe,YAAc,EAAM,MAExC,MAAK,cAAc,KAAK,gBAOjB,GAAA,UAAA,YAAR,SAAoB,GAEnB,IAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAU,EAAU,KAEhD,MAAK,cAAc,KAAK,iBAOjB,GAAA,UAAA,eAAR,SAAuB,GAEtB,GAAI,KAAK,aAAe,KACvB,MAED,QAAQ,KAAK,aACZ,IAAK,GAAoB,KACxB,KAAK,MAAQ,KAAK,KAAK,YACvB,MAED,KAAK,GAAoB,UACxB,KAAK,MAAQ,KAAK,mBAAmB,KAAK,KAAK,aAC/C,MAED,KAAK,GAAoB,KACzB,IAAK,GAAoB,aACzB,IAAK,GAAoB,OACxB,KAAK,MAAQ,KAAK,KAAK,QACvB,MAED,SACC,KAAK,MAAQ,KAAK,KAAK,YACvB,OAGF,IAAK,KAAK,mBACT,KAAK,mBAAqB,GAAI,GAAU,EAAU,SAEnD,MAAK,cAAc,KAAK,oBAOjB,GAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,WAAa,IAElB,KAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAa,EAAa,SAEtD,MAAK,cAAc,KAAK,iBAE1B,OAAA,IA3YwB,EA6YxB,GAAmB,QAAV,iWCjaT,GAAM,GAAmB,WAAzB,QAAM,MAMS,EAAA,KAAc,MAMd,GAAA,UAAmB,WAMnB,GAAA,KAAc,MAMd,GAAA,aAAsB,aAMtB,GAAA,OAAgB,QAC/B,OAAA,KAE6B,GAAA,QAApB,2BCjCT,GAAO,GAAgB,EAAc,uCAErC,IAAM,GAAU,WAsCf,QAtCK,GAsCO,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAjBL,KAAA,OAAgB,EAAiB,GAMjC,MAAA,MAAgB,IAatB,MAAK,KAAO,EAOb,OAAA,eAAW,EAAA,UAAA,WAAX,WAEC,MAAO,MAAK,UAOb,SAAe,GAEd,KAAK,KAAO,sCAMN,GAAA,UAAA,QAAP,WAEC,KAAK,KAAO,IACZ,MAAK,KAAO,KAEd,OAAA,KAEoB,GAAA,QAAX,oECzET,GAAM,GAAgB,WAAtB,QAAM,MAMS,EAAA,KAAc,MAKd,GAAA,IAAa,KAC5B,OAAA,KAE0B,GAAA,QAAjB,2BCdT,GAAM,GAAY,WAQjB,QARK,GAQO,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,KANJ,KAAA,WAAoB,GAAI,OAQ/B,IAAI,IAAW,KACd,KAAK,OAAO,GAOP,EAAA,UAAA,OAAP,SAAc,GAEb,EAAS,EAAO,MAAM,KAAK,KAAK,IAEhC,IAAI,GAAQ,EAAK,uBAEjB,OAAO,EAAS,EAAG,KAAK,GACvB,KAAK,WAAW,mBAAmB,EAAO,KAAO,mBAAmB,EAAO,IAOtE,GAAA,UAAA,SAAP,WAEC,MAAO,GAOR,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAqBb,SAAqB,GAEpB,KAAK,WAAa,sCAhBnB,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,GAAI,GAAc,GAAI,SAEtB,KAAK,GAAI,KAAK,MAAK,WAClB,EAAG,OAAO,EAAG,KAAK,WAAW,GAE9B,OAAO,uCAWT,OAAA,KAEA,GAAsB,QAAb,2BCtET,GAAO,GAAS,EAAc,kCAE9B,IAAM,GAAW,WAAjB,QAAM,MAWS,EAAA,mBAAd,SAAiC,GAEhC,GAAI,GAAiB,EACrB,IAAI,GAAmB,GAAI,YAAW,EACtC,IAAI,GAAa,EAAM,UAEvB,KAAK,GAAI,GAAI,EAAG,EAAI,EAAK,IACxB,GAAW,OAAO,aAAa,EAAO,GAEvC,IAAI,GAAqB,OAAO,KAAK,EACrC,IAAI,GAAa,yBAA2B,CAC5C,IAAI,GAA0C,GAAI,MAClD,GAAI,IAAM,CAEV,OAAO,GAWM,GAAA,iBAAd,SAA+B,GAE9B,GAAI,GAAiB,EACrB,IAAI,GAAmB,GAAI,YAAW,EAAK,WAC3C,IAAI,GAAa,EAAM,UAEvB,KAAK,GAAI,GAAI,EAAG,EAAI,EAAK,IACxB,GAAW,OAAO,aAAa,EAAO,GAEvC,IAAI,GAAqB,OAAO,KAAK,EACrC,IAAI,GAAa,yBAA2B,CAC5C,IAAI,GAA0C,GAAI,MAClD,GAAI,IAAM,CAEV,OAAO,GAWM,GAAA,YAAd,SAA0B,GAEzB,GAAI,GAAa,OAAO,QAAU,OAAO,YACzC,IAAI,GAAM,EAAO,gBAAgB,EACjC,IAAI,GAA0C,GAAI,MAClD,GAAI,IAAM,CAEV,OAAO,GAWM,GAAA,YAAd,SAA0B,GAEzB,GAAI,GAAc,GAAI,EACtB,GAAE,eAAe,EACjB,OAAO,GAYM,GAAA,SAAd,SAAuB,EAAU,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAGhC,SAAW,KAAS,SAAU,CAC7B,GAAI,GAAoB,CAExB,IAAI,EAAE,WAAa,KAClB,MAAO,GAAE,OAAO,EAAG,EAAE,QAGvB,GAAI,YAAgB,GAAW,CAC9B,GAAI,GAA2B,CAC/B,GAAG,SAAW,CACd,OAAO,GAAG,aAAa,KAAK,IAAI,EAAG,oBAAqB,IAGzD,MAAO,MAqBT,OAAA,KAEA,GAAqB,QAAZ,kECnIH,GAAgB,WAAtB,QAAM,MAKS,EAAA,YAAqB,YAKrB,GAAA,aAAsB,aACrC,OAAA,KAEA,GAA0B,QAAjB,yLClBT,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAgB,EAAa,+CACpC,IAAO,GAAc,EAAa,6CAElC,IAAM,GAAqB,SAAA,GAAS,EAA9B,EAAqB,EAS1B,SATK,GASO,EAAyB,GAAzB,GAAA,QAAA,GAAuB,CAAvB,EAAA,GAAyB,GAAA,QAAA,GAAsC,CAAtC,EAAA,aAEpC,EAAA,KAAA,KAAM,EATC,MAAA,aAAsB,EACtB,MAAA,aAAsB,GACtB,MAAA,cAAuB,EACvB,MAAA,cAAuB,GACvB,MAAA,qBAA+B,IAC/B,MAAA,qBAA+B,KAKtC,MAAK,YAAc,EAMpB,OAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,MAAO,MAAK,0BAGb,SAA+B,GAE9B,GAAI,KAAK,sBAAwB,EAChC,MAED,MAAK,qBAAuB,CAE5B,IAAI,KAAK,qBACR,KAAK,wDAMP,QAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,MAAO,MAAK,0BAGb,SAA+B,GAE9B,GAAI,KAAK,sBAAwB,EAChC,MAED,MAAK,qBAAuB,CAE5B,MAAK,wDAMN,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,wDAMN,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,wDAMN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,cAAgB,EAAE,KAAK,IAAI,KAAK,cAAc,KAAK,GAAG,IAE3D,MAAK,wDAMN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,wDAKC,GAAA,UAAA,UAAP,SAAiB,EAAW,EAAW,GAEtC,GAAI,GAAa,GAAI,GAAS,GAAK,EAAI,EAAI,EAE3C,GAAE,GAAK,CACP,GAAE,GAAK,CAEP,GAAI,KAAK,mBAAmB,gBAAgB,EAG5C,GAAE,EAAI,CAEN,OAAO,GAID,GAAA,UAAA,MAAP,WAEC,GAAI,GAA8B,GAAI,GAAsB,KAAK,aACjE,GAAM,OAAS,KAAK,MACpB,GAAM,MAAQ,KAAK,KACnB,GAAM,cAAgB,KAAK,aAC3B,GAAM,mBAAqB,KAAK,kBAChC,OAAO,GAID,GAAA,UAAA,cAAP,WAEC,GAAI,KAEJ,IAAI,KAAK,qBAAsB,CAC9B,GAAI,KAAK,qBACR,KAAK,cAAgB,KAAK,YAE3B,MAAK,aAAe,KAAK,KAAK,GAAI,KAAK,cAAc,OAAO,KAAK,cAAc,IAAI,KAAK,EACxF,MAAK,cAAgB,KAAK,KAAK,GAAI,KAAK,cAAc,MAAM,KAAK,eAAe,IAAI,KAAK,OACnF,CACN,KAAK,aAAe,GAAI,KAAK,cAAc,OAAO,KAAK,IAAI,KAAK,aAAa,KAAK,GAAG,IAErF,IAAI,KAAK,qBACR,KAAK,cAAgB,KAAK,iBAE1B,MAAK,cAAgB,GAAI,KAAK,cAAc,MAAM,KAAK,IAAI,KAAK,cAAc,KAAK,GAAG,KAGxF,GAAI,IAAW,KAAK,UAAU,KAAK,aACnC,IAAI,IAAW,EAAI,KAAK,WAAW,KAAK,aACxC,IAAI,IAAW,KAAK,UAAU,KAAK,YACnC,IAAI,IAAW,EAAI,KAAK,WAAW,KAAK,YAExC,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,MAGA,MAAmB,EAAU,GAAS,KAAK,cAAc,EAAI,EAAQ,KAAK,cAAc,MAC5F,IAAI,IAAkB,EAAU,GAAS,KAAK,cAAc,EAAI,EAAQ,KAAK,cAAc,MAE3F,GAAO,GAAU,EAAU,GAAS,KAAK,WAAW,KACpD,GAAQ,CACR,GAAM,CACN,GAAS,GAAU,EAAU,GAAS,KAAK,WAAW,MAEtD,GAAI,GAAK,GAAG,EAAQ,EACpB,GAAI,GAAK,GAAG,EAAS,EACrB,GAAI,IAAM,EAAQ,IAAO,EAAQ,EACjC,GAAI,IAAM,EAAS,IAAM,EAAS,EAClC,GAAI,KAAO,KAAK,MAAQ,KAAK,SAAS,KAAK,MAAQ,KAAK,OACxD,GAAI,IAAM,CACV,GAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,IAAM,EAAI,IAAM,EAAI,IAAM,CACpF,GAAI,KAAO,EAAE,KAAK,MAAM,KAAK,QAAQ,KAAK,MAAQ,KAAK,OAEvD,IAAI,KAAK,oBAAsB,EAAiB,aAC/C,EAAI,IAAM,EAAI,EAEf,MAAK,SAAS,gBAAgB,EAE9B,MAAK,iBAAiB,GAAK,KAAK,iBAAiB,GAAK,KAAK,OAAO,CAClE,MAAK,iBAAiB,GAAK,KAAK,iBAAiB,GAAK,KAAK,OAAO,CAClE,MAAK,iBAAiB,GAAK,KAAK,iBAAiB,GAAK,KAAK,OAAO,CAClE,MAAK,iBAAiB,GAAK,KAAK,iBAAiB,IAAM,KAAK,OAAO,CAEnE,MAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,MAAM,CACnE,MAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,MAAM,CACnE,MAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,MAAM,CACnE,MAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,MAAM,CAEnE,MAAK,iBAAiB,GAAK,KAAK,iBAAiB,GAAK,KAAK,iBAAiB,GAAK,KAAK,iBAAiB,IAAM,KAAK,MAClH,MAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,iBAAiB,IAAM,KAAK,KAErH,MAAK,gBAAkB,MAIzB,OAAA,IAhOoC,EAkOL,GAAA,QAAtB,6TCtOT,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAS,EAAc,iCAE9B,IAAO,GAAe,EAAa,yCACnC,IAAO,GAAe,EAAa,yCACnC,IAAO,GAAmB,EAAY,6CAGtC,IAAM,GAAc,SAAA,GAAS,EAAvB,EAAc,EAkBnB,SAlBK,GAkBO,GAAA,GAAA,QAAA,GAAsC,CAAtC,EAAA,aAEX,EAAA,KAAA,KAlBM,MAAA,SAAoB,GAAI,EACxB,MAAA,cAA0B,GAAI,EAC9B,MAAA,WAAuB,GAAI,EAC3B,MAAA,OAAgB,EAChB,MAAA,MAAe,GACf,MAAA,cAAuB,CAEvB,MAAA,gBAA0B,IAC1B,MAAA,mBAEA,MAAA,UAAmB,EACnB,MAAA,UAAmB,EAGlB,MAAA,qBAA+B,IAMtC,MAAK,iBAAmB,EAMzB,OAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,wBAGb,SAA4B,GAE3B,GAAI,KAAK,oBAAsB,EAC9B,MAED,MAAK,mBAAqB,CAE1B,MAAK,wDAGN,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,sBAGb,SAA0B,GAEzB,KAAK,iBAAmB,sCAGzB,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,GAAI,KAAK,gBAAiB,CACzB,KAAK,eACL,MAAK,gBAAkB,MAExB,MAAO,MAAK,cAGb,SAAkB,GAEjB,KAAK,SAAW,CAChB,MAAK,wDAGN,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,YAGb,SAAgB,GAEf,GAAI,GAAS,KAAK,OAAQ,CACzB,OAED,KAAK,OAAS,CACd,MAAK,wDAGN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,eAGb,SAAmB,GAElB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,UAAY,sCAGlB,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,eAGb,SAAmB,GAElB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,UAAY,sCAGlB,QAAA,eAAW,EAAA,UAAA,WAAX,WAEC,MAAO,MAAK,WAGb,SAAe,GAEd,GAAI,GAAS,KAAK,MAAO,CACxB,OAED,KAAK,MAAQ,CACb,MAAK,wDAGC,GAAA,UAAA,QAAP,SAAe,GAEd,GAAI,GAAa,KAAK,OAAO,gBAAgB,EAC7C,GAAE,EAAI,EAAE,EAAE,EAAE,CACZ,GAAE,GAAK,EAAE,EAAE,EAAE,CAGb,GAAE,EAAI,EAAQ,CAEd,OAAO,GAGR,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,GAAI,KAAK,qBAAsB,CAC9B,IAAK,KAAK,cACT,KAAK,cAAgB,GAAI,EAE1B,MAAK,cAAc,SAAS,KAAK,OACjC,MAAK,cAAc,QACnB,MAAK,qBAAuB,MAE7B,MAAO,MAAK,kDAGN,GAAA,UAAA,UAAP,SAAiB,EAAW,EAAW,GAEtC,KAAM,IAAI,GAGJ,GAAA,UAAA,MAAP,WAEC,KAAM,IAAI,GAGX,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,mBAGb,SAAyB,GAExB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,wDAGC,GAAA,UAAA,kBAAP,WAEC,KAAK,gBAAkB,IACvB,MAAK,qBAAuB,IAC5B,MAAK,cAAc,GAAI,GAAgB,EAAgB,eAAgB,OAGjE,GAAA,UAAA,cAAP,WAEC,KAAM,IAAI,GAGJ,GAAA,UAAA,oBAAP,SAA2B,EAAU,EAAU,EAAc,GAE5D,KAAK,cAAc,EAAI,CACvB,MAAK,cAAc,EAAI,CACvB,MAAK,cAAc,MAAQ,CAC3B,MAAK,cAAc,OAAS,CAC5B,MAAK,oBAGC,GAAA,UAAA,iBAAP,SAAwB,EAAU,EAAU,EAAc,GAEzD,KAAK,WAAW,EAAI,CACpB,MAAK,WAAW,EAAI,CACpB,MAAK,WAAW,MAAQ,CACxB,MAAK,WAAW,OAAS,CACzB,MAAK,oBAEP,OAAA,IAzM6B,EA2ML,GAAA,QAAf,qYCnNT,IAAO,GAAK,EAAe,+BAC3B,IAAO,GAAa,EAAa,yCACjC,IAAO,GAAY,EAAc,qCAGjC,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EASjB,SATK,GASO,EAAmC,GAAA,GAAA,QAAA,GAA+B,CAA/B,EAAA,MAE9C,EAAA,KAAA,KAAM,EAEN,MAAK,iBAAmB,EAMzB,OAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,GAAI,KAAK,mBAAqB,EAC7B,MAED,KAAK,EAAa,wBAAwB,GACzC,KAAM,IAAI,GAAM,iFAEjB,MAAK,kBAAoB,CAEzB,MAAK,mBACL,MAAK,UAAU,EAAM,MAAO,EAAM,4CAG5B,GAAA,UAAA,iBAAP,WAEC,MAAO,MAAK,kBAEd,OAAA,IA1C2B,EA4CL,GAAA,QAAb,+ICjDT,GAAO,GAAU,EAAc,kCAC/B,IAAO,GAAM,EAAe,8BAC5B,IAAO,GAAS,EAAc,qCAKxB,GAAe,WAArB,QAAM,MAkBS,EAAA,gBAAd,SAA8B,EAAY,EAA2B,GAAA,GAAA,QAAA,GAAqB,CAArB,EAAA,MAEpE,GAAI,GAAW,EAAO,KACtB,IAAI,GAAW,EAAO,MACtB,IAAI,GAAW,CAEf,IAAI,EAEJ,GAAgB,MAAM,MAAQ,CAC9B,GAAgB,MAAM,OAAS,CAE/B,OAAO,GAAK,GAAK,GAAK,EAAG,CAExB,EAAS,EAAO,GAAK,EAAgB,iBAAiB,EAAO,GAAI,EAAG,EAEpE,IAAI,EACH,EAAO,SAAS,EAAgB,MAAO,EAExC,GAAgB,QAAQ,EAAI,EAAgB,MAAM,MAAM,EAAO,KAC/D,GAAgB,QAAQ,EAAI,EAAgB,MAAM,OAAO,EAAO,MAEhE,GAAO,KAAK,EAAQ,EAAgB,QAEpC,KAAM,CACN,KAAM,CAEN,GAAgB,MAAM,MAAQ,EAAI,EAAG,EAAI,CACzC,GAAgB,MAAM,OAAS,EAAI,EAAG,EAAI,CAE1C,MAIa,GAAA,iBAAf,SAAgC,EAAyB,EAAa,GAErE,GAAI,EAAc,CACjB,GAAI,EAAa,OAAS,GAAQ,EAAa,QAAU,EACxD,MAAO,EAER,GAAgB,iBAAiB,GAGlC,IAAK,EAAgB,SAAS,GAAO,CACpC,EAAgB,SAAS,KACzB,GAAgB,YAAY,MAG7B,IAAK,EAAgB,SAAS,GAAM,GAAO,CAC1C,EAAe,EAAgB,SAAS,GAAM,GAAQ,GAAI,GAAW,EAAM,EAAM,KACjF,GAAgB,YAAY,GAAM,GAAQ,MACpC,CACN,EAAgB,YAAY,GAAM,GAAQ,EAAgB,YAAY,GAAM,GAAQ,CACpF,GAAe,EAAgB,SAAS,GAAM,GAG/C,MAAO,GAGM,GAAA,iBAAd,SAA+B,GAE9B,GAAI,GAAqB,EAAa,KACtC,IAAI,GAAsB,EAAa,MAEvC,MAAM,EAAgB,YAAY,GAAa,IAAiB,EAAG,CAClE,EAAgB,SAAS,GAAa,GAAc,SACpD,GAAgB,SAAS,GAAa,GAAgB,MAjFzC,GAAA,WACA,GAAA,cAEA,GAAA,QAAiB,GAAI,EACrB,GAAA,MAAkB,GAAI,EAgFtC,OAAA,KAEyB,GAAA,QAAhB,iSC9FT,IAAO,GAAmB,EAAY,6CACtC,IAAO,GAAe,EAAa,2CACnC,IAAO,GAAgB,EAAa,4CAEpC,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EA8BlB,SA9BK,GA8BO,GAAA,GAAA,QAAA,GAA+B,CAA/B,EAAA,MAEX,EAAA,KAAA,KAAM,GArBP,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,4CAOb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAGb,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,4CAWN,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb;GAAI,KAAK,YAAa,CACrB,GAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,EAAgB,iBAAiB,KAAK,YAAY,KAO9C,GAAA,UAAA,kBAAP,WAEC,EAAA,UAAM,kBAAiB,KAAA,KAEvB,MAAK,iBAAmB,KASlB,GAAA,UAAA,UAAP,SAAiB,EAAc,GAE9B,GAAI,KAAK,SAAW,GAAS,KAAK,UAAY,EAC7C,KAAK,gBAEN,MAAK,iBAAmB,IAExB,MAAK,QAAU,CACf,MAAK,SAAW,EAGV,GAAA,UAAA,gBAAP,WAEC,GAAI,KAAK,iBAAkB,CAC1B,KAAK,iBAAmB,KAExB,KAAK,KAAK,YACT,KAAK,YAAc,GAAI,MAExB,GAAgB,gBAAgB,KAAK,mBAAoB,KAAK,YAAa,MAG5E,MAAO,MAAK,YAGN,GAAA,UAAA,iBAAP,WAEC,KAAM,IAAI,GAEZ,OAAA,IA9F4B,EAgG5B,GAAuB,QAAd,oUCrGT,IAAO,GAAS,EAAc,oCAE9B,IAAO,GAAc,EAAa,6CAM5B,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAWrB,SAXK,GAWO,GAAA,GAAA,QAAA,GAA+B,CAA/B,EAAA,MAEX,EAAA,KAAA,KAVM,MAAA,SAAkB,MAGjB,MAAA,aAAmC,GAAI,MAS9C,MAAK,iBAAmB,KAAK,YAAc,EAG5C,OAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,2CAGb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAOb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAOb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,sBAGb,SAA2B,GAE1B,GAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,iBAAmB,KAAK,YAAc,CAE3C,MAAK,wDAON,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,4CAMX,GAAA,UAAA,kBAAP,WAEC,GAAI,GAAa,KAAK,aAAa,MACnC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,aAAa,GAAG,aAOhB,GAAA,UAAA,eAAP,WAEC,MAAO,KAAK,aAAa,OACxB,KAAK,aAAa,GAAG,UAMhB,GAAA,UAAA,QAAP,WAEC,MAAO,KAAK,aAAa,OACxB,KAAK,aAAa,GAAG,UAIhB,GAAA,UAAA,iBAAP,SAAwB,GAEvB,KAAK,aAAa,KAAK,EAEvB,OAAO,GAGD,GAAA,UAAA,oBAAP,SAA2B,GAE1B,KAAK,aAAa,OAAO,KAAK,aAAa,QAAQ,GAAc,EAEjE,OAAO,GAET,OAAA,IA5G+B,EA8G/B,GAA0B,QAAjB,2QCtHT,IAAO,GAAa,EAAa,sCAEjC,IAAM,GAAS,SAAA,GAAS,EAAlB,EAAS,EAMd,SANK,KAQJ,EAAA,KAAA,KANM,MAAA,UAAmB,CAOzB,MAAK,MAAQ,aACb,MAAK,UAAY,CACjB,MAAK,WAAa,GAAI,aAAY,KAAK,UACvC,MAAK,wBAA0B,GAAI,aAAY,IAGzC,EAAA,UAAA,qBAAP,SAA4B,GAE3B,KAAK,YAAY,EAAI,KAAK,UAGpB,GAAA,UAAA,eAAP,SAAsB,GAGrB,KAAK,YAAY,EAAQ,WAEzB,MAAK,OAAS,EAAQ,UAEtB,IAAI,GAAwB,GAAI,WAAU,EAC1C,IAAI,GAA0B,GAAI,WAAU,KAAK,WAAY,EAAG,KAAK,OAErE,GAAc,IAAI,EAElB,MAAK,SAAW,EAIV,GAAA,UAAA,kBAAP,WAEC,MAAS,MAAW,OAAO,KAAa,SAGlC,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,EAAI,KAAK,UAAW,CACvB,GAAI,GAAuB,EAAI,KAAS,GACxC,IAAI,GAAiB,GAAI,aAAY,EACrC,IAAI,GAAO,GAAI,YAAW,KAAK,WAAY,EAAG,KAAK,OACnD,IAAI,GAAU,GAAI,YAAW,EAAgB,EAAG,KAAK,OACrD,GAAQ,IAAI,EACZ,MAAK,WAAa,CAClB,MAAK,UAAY,GAIZ,GAAA,UAAA,UAAP,SAAiB,GAEhB,KAAK,qBAAqB,EAC1B,IAAI,GAAO,GAAI,WAAU,KAAK,WAC9B,GAAM,KAAK,cAAkB,CAC7B,IAAI,KAAK,SAAW,KAAK,OAAQ,CAChC,KAAK,OAAS,KAAK,UAId,GAAA,UAAA,SAAP,WAEC,GAAI,KAAK,UAAY,KAAK,OAAQ,CACjC,KAAM,yCAA2C,KAAK,SAAW,YAAc,KAAK,OAErF,GAAI,GAAO,GAAI,WAAU,KAAK,WAE9B,OAAO,GAAM,KAAK,YAGZ,GAAA,UAAA,UAAP,SAAiB,EAAiB,EAAmB,GAAnB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAAmB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAGpD,GAAI,GAAU,KAAM,CACnB,EAAS,EAAM,OAGhB,EAAM,qBAAqB,EAAS,EAEpC,IAAI,GAAqB,GAAI,WAAU,EAAM,WAC7C,IAAI,GAA0B,GAAI,WAAU,KAAK,WAEjD,GAAS,IAAI,EAAc,SAAS,KAAK,SAAU,KAAK,SAAW,GAAS,EAE5E,MAAK,UAAY,CAEjB,IAAI,EAAS,EAAS,EAAM,OAAQ,CACnC,EAAM,QAAY,EAAS,EAAW,EAAM,QAKvC,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,qBAAqB,EAC1B,IAAI,GAAO,GAAI,YAAW,KAAK,WAC/B,GAAK,KAAK,cAAiB,EAAK,GAChC,IAAI,KAAK,SAAW,KAAK,OAAQ,CAChC,KAAK,OAAS,KAAK,UAId,GAAA,UAAA,iBAAP,WAEC,GAAI,KAAK,UAAY,KAAK,OAAQ,CACjC,KAAM,yCAA2C,KAAK,SAAW,YAAc,KAAK,OAErF,GAAI,GAAO,GAAI,YAAW,KAAK,WAC/B,OAAO,GAAK,KAAK,YAGX,GAAA,UAAA,mBAAP,SAA0B,GAEzB,KAAK,qBAAqB,EAC1B,KAAM,KAAK,SAAW,IAAO,EAAG,CAC/B,GAAI,GAAO,GAAI,aAAY,KAAK,WAChC,GAAM,KAAK,UAAY,KAAS,EAAK,UAC/B,CACN,GAAI,GAAO,GAAI,aAAY,KAAK,wBAAyB,EAAG,EAC5D,GAAK,KAAQ,EAAK,KAClB,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,GAEX,KAAK,UAAY,CACjB,IAAI,KAAK,SAAW,KAAK,OAAQ,CAChC,KAAK,OAAS,KAAK,UAId,GAAA,UAAA,aAAP,SAAoB,GAGnB,GAAI,GAAe,EACnB,IAAI,GAAa,KAAK,SAAW,CACjC,IAAI,GAAgB,GAAI,UAAS,KAAK,WAGtC,OAAO,KAAK,SAAW,EAAK,CAE3B,GAAI,GAAW,EAAK,SAAS,KAAK,WAElC,IAAI,EAAI,IAAM,CAEb,GAAI,GAAK,EAAG,KACZ,IAAS,OAAO,aAAa,OAEvB,IAAI,EAAI,IAAM,CAEpB,GAAS,OAAO,cAAe,EAAI,KAAS,EAAM,EAAK,SAAS,KAAK,YAAc,SAE7E,IAAI,EAAI,IAAM,CAEpB,GAAI,GAAK,EAAK,SAAS,KAAK,WAC5B,IAAS,OAAO,cAAe,EAAI,KAAS,IAAQ,EAAK,MAAS,EAAM,EAAK,SAAS,KAAK,YAAc,SAEnG,CAEN,GAAI,GAAK,EAAK,SAAS,KAAK,WAC5B,IAAI,GAAK,EAAK,SAAS,KAAK,WAE5B,IAAS,OAAO,cAAe,EAAI,KAAS,IAAQ,EAAK,MAAS,GAAQ,GAAM,EAAK,IAAS,EAAK,SAAS,KAAK,YAAc,MAMjI,MAAO,GAID,GAAA,UAAA,QAAP,WAGC,GAAI,GAAgB,GAAI,UAAS,KAAK,WACtC,IAAI,GAAa,EAAK,SAAS,KAAK,SAAU,KAE9C,MAAK,UAAY,CAEjB,OAAO,GAID,GAAA,UAAA,UAAP,WAGC,GAAI,GAAgB,GAAI,UAAS,KAAK,WACtC,IAAI,GAAe,EAAK,SAAS,KAAK,SAAU,KAEhD,MAAK,UAAY,CACjB,OAAO,GAID,GAAA,UAAA,WAAP,WAEC,GAAI,GAAgB,GAAI,UAAS,KAAK,WACtC,IAAI,GAAgB,EAAK,WAAW,KAAK,SAAU,KAEnD,MAAK,UAAY,CACjB,OAAO,GAID,GAAA,UAAA,kBAAP,WAEC,GAAI,KAAK,SAAW,KAAK,OAAS,EAAG,CACpC,KAAM,0CAA4C,KAAK,SAAW,YAAc,KAAK,OAEtF,IAAM,KAAK,SAAW,IAAO,EAAG,CAC/B,GAAI,GAAO,GAAI,aAAY,KAAK,WAChC,IAAI,GAAY,KAAK,UAAY,CACjC,MAAK,UAAY,CACjB,OAAO,GAAM,OACP,CACN,GAAI,GAAO,GAAI,aAAY,KAAK,wBAAyB,EAAG,EAC5D,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,EACV,MAAK,UAAY,CACjB,OAAO,GAAK,IAIP,GAAA,UAAA,iBAAP,SAAwB,GAEvB,KAAK,qBAAqB,EAC1B,KAAM,KAAK,SAAW,IAAO,EAAG,CAC/B,GAAI,GAAO,GAAI,aAAY,KAAK,WAChC,GAAM,KAAK,UAAY,KAAS,EAAK,eAC/B,CACN,GAAI,GAAO,GAAI,aAAY,KAAK,wBAAyB,EAAG,EAC5D,GAAK,KAAQ,EAAK,UAClB,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,GAEX,KAAK,UAAY,CACjB,IAAI,KAAK,SAAW,KAAK,OAAQ,CAChC,KAAK,OAAS,KAAK,UAId,GAAA,UAAA,gBAAP,WAGC,GAAI,KAAK,SAAW,KAAK,OAAS,EAAG,CACpC,KAAM,0CAA4C,KAAK,SAAW,YAAc,KAAK,OAEtF,IAAM,KAAK,SAAW,IAAO,EAAG,CAC/B,GAAI,GAAO,GAAI,aAAY,KAAK,WAChC,IAAI,GAAY,KAAK,UAAY,CACjC,MAAK,UAAY,CACjB,OAAO,GAAM,OACP,CACN,GAAI,GAAO,GAAI,aAAY,KAAK,wBAAyB,EAAG,EAC5D,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,EACV,MAAK,UAAY,CACjB,OAAO,GAAK,IAIP,GAAA,UAAA,WAAP,SAAkB,GAEjB,KAAK,qBAAqB,EAC1B,KAAM,KAAK,SAAW,IAAO,EAAG,CAC/B,GAAI,GAAO,GAAI,cAAa,KAAK,WACjC,GAAM,KAAK,UAAY,GAAM,MACvB,CACN,GAAI,GAAO,GAAI,cAAa,KAAK,wBAAyB,EAAG,EAC7D,GAAK,GAAK,CACV,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,GAEX,KAAK,UAAY,CACjB,IAAI,KAAK,SAAW,KAAK,OAAQ,CAChC,KAAK,OAAS,KAAK,UAId,GAAA,UAAA,UAAP,WAEC,GAAI,KAAK,SAAW,KAAK,OAAS,EAAG,CACpC,KAAM,yCAA2C,KAAK,SAAW,YAAc,KAAK,OAErF,IAAK,KAAK,SAAW,IAAM,EAAG,CAC7B,GAAI,GAAO,GAAI,cAAa,KAAK,WACjC,IAAI,GAAK,KAAK,UAAY,CAC1B,MAAK,UAAY,CACjB,OAAO,GAAK,OACN,CACN,GAAI,GAAO,GAAI,cAAa,KAAK,wBAAyB,EAAG,EAC7D,IAAI,GAAQ,GAAI,YAAW,KAAK,WAAY,KAAK,SAAU,EAC3D,IAAI,GAAQ,GAAI,YAAW,KAAK,wBAAyB,EAAG,EAC5D,GAAM,IAAI,EACV,MAAK,UAAY,CACjB,OAAO,GAAM,IAGhB,OAAA,IAlTwB,EAoTxB,GAAmB,QAAV,mECtTT,GAAO,GAAmB,EAAY,6CAEtC,IAAM,GAAa,WAQlB,QARK,KAEE,KAAA,SAAkB,CAClB,MAAA,OAAgB,CAChB,MAAA,MAAe,GAQf,EAAA,UAAA,UAAP,SAAiB,GAEhB,KAAM,iBAGA,GAAA,UAAA,SAAP,WAEC,KAAM,iBAGA,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAM,iBAGA,GAAA,UAAA,iBAAP,WAEC,KAAM,iBAGA,GAAA,UAAA,mBAAP,SAA0B,GAEzB,KAAM,iBAGA,GAAA,UAAA,kBAAP,WAEC,KAAM,iBAGA,GAAA,UAAA,iBAAP,SAAwB,GAEvB,KAAM,iBAGA,GAAA,UAAA,gBAAP,WAEC,KAAM,iBAGA,GAAA,UAAA,WAAP,SAAkB,GAEjB,KAAM,iBAGA,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAM,iBAGA,GAAA,UAAA,UAAP,SAAiB,GAEhB,KAAM,iBAGA,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAM,iBAGA,GAAA,UAAA,kBAAP,WAEC,KAAM,IAAI,GAAoB,uDAGxB,GAAA,UAAA,SAAP,WAEC,MAAO,iBAAmB,KAAK,MAAQ,eAAiB,KAAK,SAAW,WAAa,KAAK,OAGpF,GAAA,UAAA,aAAP,SAAoB,EAAO,GAE1B,GAAI,GAAS,WAAa,EAAQ,KAAK,OAAS,KAAK,SACpD,EAAQ,KAAK,OAAS,KAAK,QAC5B,IAAI,EAAQ,EAAM,OAAS,EAAM,SAChC,EAAQ,EAAM,OAAS,EAAM,QAC9B,IAAI,GAAM,CACV,IAAI,GAAI,IACR,OAAO,GAAK,GAAS,EAAG,CACvB,GAAS,CACT,IAAI,KAAK,mBAAqB,EAAM,kBAAmB,EAAI,MAE5D,MAAO,GAAK,GAAS,EAAG,CACvB,GACA,IAAI,KAAK,oBAAsB,EAAM,mBAAoB,EAAI,MAE9D,GAAI,EACJ,MAAK,UAAa,EAAK,CACvB,GAAM,UAAa,EAAK,CACxB,OAAO,GAGD,GAAA,UAAA,kBAAP,SAAyB,GAExB,IAAK,GAAI,GAAW,EAAG,EAAI,EAAE,OAAQ,IAAK,CACzC,GAAI,GAAI,EAAE,OAAO,IAIZ,GAAA,UAAA,cAAP,WAEC,GAAI,GAAS,KAAK,QAClB,MAAK,SAAW,CAChB,IAAI,GAAe,CAEnB,SAAS,GAAY,EAAG,GAEvB,GAAI,IAAsB,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IACrG,IAAI,GAAY,EAChB,KAAK,GAAI,GAAW,EAAG,EAAI,EAAQ,IAAK,CACvC,EAAK,EAAK,IAAM,GAAK,GAAM,IAAO,EAEnC,MAAO,GAGR,IAAK,GAAI,GAAI,EAAG,EAAI,KAAK,OAAQ,GAAK,EAAO,CAC5C,GAAI,GAAW,EAAY,EAAG,GAAK,GACnC,KAAK,GAAI,GAAW,EAAG,EAAI,GAAS,EAAI,EAAI,KAAK,OAAQ,IAAK,CAC7D,GAAK,IAAM,EAAY,KAAK,mBAAoB,GAEjD,QAAQ,IAAI,GAEb,KAAK,SAAW,EAGV,GAAA,UAAA,iBAAP,SAAwB,GAEvB,GAAI,GAAS,WAAa,EAAQ,KAAK,OAAS,KAAK,SACpD,EAAQ,KAAK,OAAS,KAAK,QAC5B,MAAM,EAAQ,GAAI,MAAO,EAEzB,OAAO,GAAc,wBAAwB,EAAO,KAAK,iBAAkB,MAG9D,GAAA,wBAAd,SAAsC,EAAO,EAAqB,GAEjE,GAAI,GAAI,EACR,IAAI,GAAI,EAAI,EAAI,EAAM,EAAM,EAAM,CAClC,IAAI,GAAY,EAAc,SAC9B,OAAO,GAAS,EAAG,CAClB,EAAK,EAAoB,MAAM,EAC/B,GAAK,EAAoB,MAAM,EAC/B,GAAK,EAAoB,MAAM,EAC/B,GAAO,GAAM,CACb,IAAS,EAAK,IAAM,EAAM,GAAM,CAChC,IAAS,EAAK,KAAO,EAAM,GAAM,CACjC,GAAO,EAAK,EACZ,IAAK,EAAU,OAAO,GAAQ,EAAU,OAAO,GAAQ,EAAU,OAAO,GAAQ,EAAU,OAAO,EACjG,IAAS,EAGV,GAAI,GAAS,EAAG,CACf,EAAK,EAAoB,MAAM,EAC/B,GAAK,EAAoB,MAAM,EAC/B,GAAO,GAAM,CACb,IAAS,EAAK,IAAM,EAAM,GAAM,CAChC,IAAS,EAAK,KAAO,CACrB,IAAK,EAAU,OAAO,GAAQ,EAAU,OAAO,GAAQ,EAAU,OAAO,GAAQ,QAC1E,IAAI,GAAS,EAAG,CACtB,EAAK,EAAoB,MAAM,EAC/B,GAAO,GAAM,CACb,IAAS,EAAK,IAAM,CACpB,IAAK,EAAU,OAAO,GAAQ,EAAU,OAAO,GAAQ,KAExD,MAAO,GA1KM,GAAA,UAAY,kEA4K3B,OAAA,KAEA,GAAuB,QAAd,4ECnLH,GAAU,WAAhB,QAAM,MAES,EAAA,mBAAd,SAAiC,GAEhC,GAAI,IAAa,EAAe,cAAiB,EACjD,IAAI,IAAa,EAAe,YAAe,EAC/C,IAAI,IAAa,EAAe,SAAa,CAC7C,IAAI,GAAW,EAAe,GAC9B,IAAI,IAAoB,EAAG,EAAI,EAAI,EAEnC,OAAO,GAGO,GAAA,eAAf,SAA8B,GAE7B,GAAI,GAAM,EAAE,SAAS,GACrB,OAAO,GAAI,QAAU,EAAG,IAAM,EAAM,EAGvB,GAAA,eAAd,SAA6B,GAE5B,MAAO,IAAM,EAAW,eAAe,EAAK,IAAM,EAAW,eAAe,EAAK,IAAM,EAAW,eAAe,EAAK,IAGzG,GAAA,gBAAd,SAA8B,GAE7B,MAAO,IAAM,EAAW,eAAe,EAAK,IAAM,EAAW,eAAe,EAAK,IAAM,EAAW,eAAe,EAAK,IAAM,EAAW,eAAe,EAAK,IAE7J,OAAA,KAEA,GAAoB,QAAX,2BCjCT,GAAO,GAAQ,EAAe,iCAE9B,IAAM,GAAqB,WAY1B,QAZK,GAYO,EAAmB,GAZhC,GAAA,GAAA,IAIS,MAAA,QAAkB,KAKlB,MAAA,WAAwB,GAAI,MAKnC,MAAK,UAAY,CAEjB,MAAK,YAAY,EAAU,EAE3B,MAAK,mBAAqB,WACzB,GAAI,EAAK,QACR,EAAK,QAGP,MAAK,WAAW,KAAK,KAAK,KAUpB,EAAA,UAAA,YAAP,SAAmB,EAAmB,GAErC,KAAK,UAAY,CACjB,MAAK,iBAAmB,EAMlB,GAAA,UAAA,MAAP,WAEC,KAAK,UAAY,KAAK,WACtB,MAAK,QAAU,IAEf,IAAI,OAAO,sBAAuB,CACjC,OAAO,sBAAsB,KAAK,wBAC5B,CACN,GAAI,OAAO,4BACV,OAAO,sBAAwB,OAAO,gCAClC,IAAI,OAAO,+BACf,OAAO,sBAAwB,OAAO,mCAClC,IAAI,OAAO,0BACf,OAAO,sBAAwB,OAAO,2BAOlC,GAAA,UAAA,KAAP,WAEC,KAAK,QAAU,MAShB,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CASL,GAAA,UAAA,MAAR,WAEC,KAAK,aAAe,KAAK,WACzB,MAAK,IAAM,KAAK,aAAe,KAAK,SACpC,MAAK,WAAW,GAAK,KAAK,GAC1B,MAAK,UAAU,MAAM,KAAK,iBAAkB,KAAK,WAEjD,QAAO,sBAAsB,KAAK,mBAElC,MAAK,UAAY,KAAK,aAIxB,OAAA,KAEA,GAA+B,QAAtB,8DCnGT,GAAM,GAAY,WAAlB,QAAM,MAIS,EAAA,kBAAd,SAAgC,GAE/B,GAAI,GAAc,KAAM,CAEvB,MAAO,MAIR,MAAO,GAAa,iBAAiB,EAAW,QAAU,EAAa,iBAAiB,EAAW,QAItF,GAAA,wBAAd,SAAsC,GAErC,GAAI,GAAS,KACZ,MAAO,KAER,OAAO,GAAa,iBAAiB,EAAM,QAAU,EAAa,iBAAiB,EAAM,QAI5E,GAAA,iBAAd,SAA+B,GAG9B,MAAO,IAAK,GAAK,GAAK,EAAa,UAAY,EAAa,aAAa,GAI5D,GAAA,aAAd,SAA2B,GAG1B,MAAO,IAAW,GAAS,IAAW,EAAU,MAInC,GAAA,gBAAd,SAA8B,GAE7B,GAAI,GAAW,CAEf,OAAO,EAAI,EACV,IAAM,CAEP,IAAI,EAAI,EAAa,SACpB,EAAI,EAAa,QAElB,OAAO,GA/CO,GAAA,SAAkB,IAiDlC,OAAA,KAEA,GAAqB,QAAZ,mCClDA,KAKR,MAAO,MAAK,MAGb,EAAkB,QAAT,8BCVH,GAAa,WAAnB,QAAM,MAKS,EAAA,mBAA4B,mBAK5B,GAAA,YAAqB,OACpC,OAAA,KAEA,GAAuB,QAAd,8BCNH,GAAS,WAAf,QAAM,MAYS,EAAA,IAAa,KAUb,GAAA,MAAe,OAcf,GAAA,OAAgB,QAahB,GAAA,WAAoB,YASpB,GAAA,MAAe,OAYf,GAAA,UAAmB,WAKnB,GAAA,OAAgB,QAYhB,GAAA,MAAe,OAcf,GAAA,QAAiB,SAejB,GAAA,SAAkB,UAOlB,GAAA,OAAgB,QAYhB,GAAA,QAAiB,SAQjB,GAAA,OAAgB,QAqBhB,GAAA,OAAgB,QAYhB,GAAA,SAAkB,UACjC,OAAA,KAEA,GAAmB,QAAV,yLC7LT,IAAO,GAAsB,EAAW,gDAExC,IAAO,GAAU,EAAc,kCAC/B,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAa,EAAa,qCACjC,IAAO,GAAK,EAAe,6BAE3B,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAc,EAAa,yCAClC,IAAO,GAAmB,EAAY,6CAKtC,IAAO,GAAa,EAAa,wCAGjC,IAAO,GAAe,EAAa,0CAEnC,IAAO,GAAS,EAAc,oCAI9B,IAAO,GAAkB,EAAY,6CAGrC,IAAO,GAAkB,EAAY,+CACrC,IAAO,GAAU,EAAc,2CAoIzB,GAAa,SAAA,GAAS,EAAtB,EAAa,EA0pClB,SA1pCK,KA4pCJ,EAAA,KAAA,KA9oCM,MAAA,iBAA4B,GAAI,EAChC,MAAA,sBAAgC,IAU/B,MAAA,UAAqB,GAAI,EACzB,MAAA,eAAyB,IAEzB,MAAA,uBAAkC,GAAI,EACtC,MAAA,4BAAsC,IACtC,MAAA,eAA0B,GAAI,EAC9B,MAAA,oBAA8B,IAC9B,MAAA,oBAA8B,IAC/B,MAAA,qBAA+B,IAC9B,MAAA,sBAAgC,IACjC,MAAA,uBAAiC,IAIhC,MAAA,eAAyB,IACzB,MAAA,eAAyB,IACzB,MAAA,YAAsB,IAMtB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CACpB,MAAA,QAAmB,GAAI,EACvB,MAAA,OAAkB,GAAI,EAKtB,MAAA,SAAkB,CAEnB,MAAA,SAAkB,CAClB,MAAA,SAAkB,CAClB,MAAA,SAAkB,CACjB,MAAA,GAAY,CACZ,MAAA,GAAY,CACZ,MAAA,GAAY,CACZ,MAAA,OAAkB,GAAI,EACtB,MAAA,mBAA8B,GAAI,EAClC,MAAA,WAAqB,IACrB,MAAA,YAAsB,IACtB,MAAA,KAAgB,GAAI,EACpB,MAAA,KAAgB,GAAI,EACpB,MAAA,KAAgB,GAAI,EAGrB,MAAA,kBAA4B,KAO5B,MAAA,gBAA0B,IAEzB,MAAA,oBAA8B,IAI/B,MAAA,cAAmC,GAAI,MAOvC,MAAA,cAAuB,EAAc,kBA4HrC,MAAA,aAAuB,IA8VvB,MAAA,gBAAyB,EAAgB,OA0mB/C,MAAK,qBAAuB,GAAI,OAAgB,EAEhD,MAAK,qBAAqB,GAAK,KAAK,IACpC,MAAK,qBAAqB,GAAK,KAAK,IACpC,MAAK,qBAAqB,GAAK,KAAK,IAGpC,MAAK,WAAa,GAAI,GAAU,KAEhC,MAAK,UAAU,UAEf,MAAK,OAAO,YAAY,GAAI,EAAG,EAE/B,MAAK,SAAW,KAAK,8BAErB,MAAK,aAAe,KAAK,+BA5iC1B,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,GAAI,KAAK,gBACR,KAAK,eAEN,OAAO,MAAK,cAGb,SAAkB,GAEjB,GAAI,KAAK,UAAY,EACpB,MAED,MAAK,SAAW,CAEhB,MAAK,aAAe,EAAM,OAE1B,MAAK,mBAEL,IAAI,KAAK,eACR,KAAK,eAAe,2DA6EtB,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,GAAI,KAAK,gBACR,KAAK,eAEN,OAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,QAAU,CAEf,MAAK,SAAW,EAAI,KAAK,OAAO,KAAK,KAErC,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,KAAK,QAAQ,EAAI,KAAK,WAAW,EAAW,kBAC5C,MAAK,QAAQ,EAAI,KAAK,WAAW,EAAW,kBAC5C,MAAK,QAAQ,EAAI,KAAK,WAAW,EAAW,kBAE5C,OAAO,MAAK,aAGb,SAAkB,GAEjB,KAAK,WAAa,EAAM,EAAE,EAAW,kBACrC,MAAK,WAAa,EAAM,EAAE,EAAW,kBACrC,MAAK,WAAa,EAAM,EAAE,EAAW,kBAErC,MAAK,yDAmGN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,GAAI,KAAK,gBACR,KAAK,eAEN,OAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,SAAW,CAEhB,MAAK,SAAW,EAAI,KAAK,OAAO,KAAK,MAErC,MAAK,sDAWN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,GAAI,KAAK,SACR,MAAO,MAAK,SAAS,cAAc,KAEpC,OAAO,uCAMR,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,GAAI,KAAK,4BAA6B,CACrC,KAAK,uBAAuB,SAAS,KAAK,eAC1C,MAAK,uBAAuB,QAC5B,MAAK,4BAA8B,MAEpC,MAAO,MAAK,2DAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,uBAGb,SAA2B,GAE1B,GAAI,KAAK,mBAAqB,EAC7B,MAED,MAAK,kBAAoB,CAEzB,IAAI,EAAO,CACV,KAAK,iBAAiB,UACtB,MAAK,eAAe,MAAM,EAAG,EAAG,GAGjC,KAAK,gEAMN,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,+CAeb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAoDb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,2BAGb,SAAwB,GAEvB,GAAI,KAAK,uBAAyB,EACjC,MAED,MAAK,sBAAwB,CAE7B,MAAK,6BAA6B,KAAK,SAAU,KAAK,SAAS,cAAgB,0CAWhF,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAUb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAkCb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAMb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,wBAGb,SAAqB,GAEpB,GAAI,KAAK,oBAAsB,EAC9B,MAED,IAAI,KAAK,SAAW,KAAK,mBACxB,KAAK,QAAQ,qBAAqB,KAAK,mBAExC,MAAK,mBAAqB,CAE1B,IAAI,KAAK,SAAW,EACnB,KAAK,QAAQ,mBAAmB,EAEjC,MAAK,0BAA0B,KAAK,SAAU,KAAK,SAAS,oBAAsB,0CAMnF,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,IAAK,KAAK,eACT,KAAK,eAAiB,KAAK,4BAE5B,OAAO,MAAK,mDAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,uBAGb,SAA2B,GAE1B,KAAK,kBAAoB,sCAM1B,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAIb,SAAiB,GAEhB,KAAK,OAAS,EAAM,OAEpB,MAAK,sDA6BN,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAoBb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,WAAW,EAAW,wBAGnC,SAAqB,GAEpB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,WAAa,EAAI,EAAW,kBAEjC,MAAK,yDAUN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,WAAW,EAAW,wBAGnC,SAAqB,GAEpB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,WAAa,EAAI,EAAW,kBAEjC,MAAK,yDAUN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,WAAW,EAAW,wBAGnC,SAAqB,GAEpB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,WAAa,EAAI,EAAW,kBAEjC,MAAK,yDA+DN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,GAAI,KAAK,UAAY,EACpB,MAED,MAAK,SAAW,CAEhB,MAAK,sDAWN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,GAAI,KAAK,UAAY,EACpB,MAED,MAAK,SAAW,CAEhB,MAAK,sDAYN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,GAAI,KAAK,UAAY,EACpB,MAED,MAAK,SAAW,CAEhB,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,4CAMb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,GAAI,KAAK,oBAAqB,CAC7B,IAAK,KAAK,YAAc,KAAK,eAAiB,EAAc,YAAa,CACxE,GAAI,GAAsB,GAAI,GAAS,KAAK,OAAO,EAAE,KAAK,SAAU,KAAK,OAAO,EAAE,KAAK,SAAU,KAAK,OAAO,EAAE,KAAK,SACnH,MAAK,eAAiB,KAAK,eAAe,gBAAgB,OAErD,CACN,KAAK,eAAe,aAAa,EAAG,KAAK,gBAG1C,KAAK,oBAAsB,MAE5B,MAAO,MAAK,mDAGb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,GAAI,KAAK,sBACR,KAAK,uBAEN,OAAO,MAAK,qDA8Bb,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,0DAMb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,GAAS,KAAK,eACjB,MAED,MAAK,eAAiB,CAEtB,MAAK,eAAe,cAAgB,sCAyCrC,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,+CAQb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,yBAGb,SAAmB,GAElB,GAAI,KAAK,qBAAuB,EAC/B,MAED,MAAK,oBAAsB,CAE3B,MAAK,2BAA2B,KAAK,SAAU,KAAK,SAAS,cAAgB,0CAa9E,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,GAAI,KAAK,gBACR,KAAK,eAEN,OAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,QAAU,CAEf,MAAK,SAAW,EAAI,KAAK,OAAO,KAAK,KAErC,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,mBAAX,WAKC,GAAI,KAAK,eACR,KAAK,eAAe,YAErB,IAAI,KAAK,oBAAqB,CAC7B,KAAK,oBAAsB,KAC3B,MAAK,aAAa,cAAc,KAAK,OAAQ,KAAK,gBAGnD,MAAO,MAAK,iDAab,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,QAGb,SAAa,GAEZ,GAAI,KAAK,IAAM,EACd,MAED,MAAK,GAAK,CAEV,MAAK,yDAaN,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,QAGb,SAAa,GAEZ,GAAI,KAAK,IAAM,EACd,MAED,MAAK,GAAK,CAEV,MAAK,yDAsBN,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,QAGb,SAAa,GAEZ,GAAI,KAAK,IAAM,EACd,MAED,MAAK,GAAK,CAEV,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,KAAK,SAAW,sCAkCV,GAAA,UAAA,iBAAP,SAAwB,EAAa,GAEpC,EAAA,UAAM,iBAAgB,KAAA,KAAC,EAAM,EAE7B,QAAQ,GACP,IAAK,GAAmB,iBACvB,KAAK,yBAA2B,IAChC,MACD,KAAK,GAAmB,iBACvB,KAAK,yBAA2B,IAChC,MACD,KAAK,GAAmB,cACvB,KAAK,sBAAwB,IAC7B,QAOI,GAAA,UAAA,MAAP,WAEC,GAAI,GAAsB,GAAI,EAC9B,GAAM,MAAQ,KAAK,KACnB,GAAM,WAAa,KAAK,UACxB,GAAM,KAAO,IAGb,OAAO,GAMD,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,OACR,KAAK,OAAO,YAAY,KAEzB,OAAO,KAAK,cAAc,OACzB,KAAK,cAAc,GAAG,UAMjB,GAAA,UAAA,aAAP,WAEC,KAAK,UA2BC,GAAA,UAAA,UAAP,SAAiB,GAEhB,MAAO,MAAK,QAqBN,GAAA,UAAA,QAAP,SAAe,GAEd,MAAO,MAAK,QAoBN,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAO,GAqBD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,MAAO,IAAI,GAWL,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAO,OAmBD,GAAA,UAAA,aAAP,SAAoB,EAAU,EAAU,GAAA,GAAA,QAAA,GAAyB,CAAzB,EAAA,MAEvC,MAAO,OAMD,GAAA,UAAA,kBAAP,SAAyB,EAAsB,GAE9C,GAAI,GAA4B,KAAK,sBAAsB,gBAAgB,EAC3E,IAAI,GAA6B,KAAK,sBAAsB,qBAAqB,EACjF,IAAI,GAAwC,KAAK,oBAEjD,KAAK,EAAmB,YACvB,EAAmB,YAAc,GAAI,EAEtC,IAAI,GAA0B,KAAK,OAAO,gBAAgB,EAAkB,EAAmB,EAAmB,YAElH,IAAI,EAAmB,EACtB,MAAO,MAER,GAAmB,iBAAmB,CACtC,GAAmB,iBAAmB,CACtC,GAAmB,kBAAoB,CACvC,GAAmB,YAAc,CACjC,GAAmB,aAAe,CAClC,GAAmB,wBAA0B,GAAoB,CAEjE,OAAO,MAyBD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,MAAO,IAAI,GASL,GAAA,UAAA,OAAP,SAAc,EAAiB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAG9B,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,GAAU,KACb,EAAS,EAAS,WAElB,GAAO,WAER,GAAQ,EAAO,SAAS,KAAK,WAAW,SACxC,GAAM,WAEN,GAAQ,EAAO,aAAa,EAC5B,GAAM,WAEN,IAAI,EAAM,OAAS,IAAM,CACxB,EAAM,EAAI,EAAO,CACjB,GAAM,EAAI,EAAO,CACjB,GAAM,EAAI,CACV,GAAM,YAGP,EAAQ,EAAM,aAAa,EAE3B,GAAM,EAAc,kBAEpB,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,CAET,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,CAET,GAAI,GAAK,EAAM,CACf,GAAI,GAAK,EAAM,CACf,GAAI,IAAM,EAAM,CAChB,GAAI,IAAM,CAEV,IAAI,GAAa,GAAI,EACrB,GAAE,gBAAgB,EAElB,IAAI,GAAe,EAAE,YAAY,EAEjC,MAAK,WAAa,EAAI,CACtB,MAAK,WAAa,EAAI,CACtB,MAAK,WAAa,EAAI,CAEtB,MAAK,qBA0BC,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAO,IAAI,GAWL,GAAA,UAAA,OAAP,SAAc,EAAW,EAAW,GAEnC,GAAI,KAAK,IAAM,GAAM,KAAK,IAAM,GAAM,KAAK,IAAM,EAChD,MAED,MAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,CAEV,MAAK,qBAUC,GAAA,UAAA,UAAP,SAAiB,EAAW,EAAW,GAEtC,GAAI,KAAK,QAAU,KAClB,KAAK,OAAS,GAAI,EAEnB,MAAK,OAAO,GAAK,CACjB,MAAK,OAAO,GAAK,CACjB,MAAK,OAAO,GAAK,CAEjB,MAAK,kBAQC,GAAA,UAAA,MAAP,SAAa,GAEZ,KAAK,OAAO,EAAS,OAAQ,GAMvB,GAAA,UAAA,wBAAP,SAA+B,GAE9B,GAAI,KAAK,iBAAmB,EAAgB,aAAc,CACzD,GAAI,GAAwB,EAAO,eAAe,WAClD,IAAI,GAAiB,EAAM,EAC3B,GAAM,GAAK,KAAK,aAChB,GAAM,EAAI,KAAK,QACf,GAAM,EAAI,KAAK,QACf,GAAM,EAAI,KAAK,QACf,MAAK,mBAAmB,UAAU,EAGlC,KAAK,KAAK,YAAc,KAAK,eAAiB,EAAc,YAC3D,KAAK,mBAAmB,oBAAoB,KAAK,OAAO,EAAE,KAAK,UAAW,KAAK,OAAO,EAAE,KAAK,UAAW,KAAK,OAAO,EAAE,KAAK,SAE5H,OAAO,MAAK,mBAGb,MAAO,MAAK,eAQN,GAAA,UAAA,KAAP,SAAY,GAEX,KAAK,OAAO,EAAS,OAAQ,GASvB,GAAA,UAAA,OAAP,SAAc,EAAe,GAE5B,GAAI,GAAa,GAAI,EACrB,GAAE,gBAAgB,EAAO,EAEzB,IAAI,GAAe,EAAE,YAAY,EAEjC,MAAK,YAAc,EAAI,CACvB,MAAK,YAAc,EAAI,CACvB,MAAK,YAAc,EAAI,CAEvB,MAAK,qBAUC,GAAA,UAAA,SAAP,SAAgB,EAAW,EAAW,GAErC,KAAK,WAAa,EAAG,EAAW,kBAChC,MAAK,WAAa,EAAG,EAAW,kBAChC,MAAK,WAAa,EAAG,EAAW,kBAEhC,MAAK,qBAMC,GAAA,UAAA,oBAAP,SAA2B,EAAa,GAEvC,EAAA,UAAM,oBAAmB,KAAA,KAAC,EAAM,EAEhC,IAAI,KAAK,iBAAiB,EAAM,GAC/B,MAED,QAAQ,GACP,IAAK,GAAmB,iBACvB,KAAK,yBAA2B,KAChC,MAED,KAAK,GAAmB,iBACvB,KAAK,yBAA2B,KAChC,MAED,KAAK,GAAmB,cACvB,KAAK,sBAAwB,KAC7B,QAUI,GAAA,UAAA,UAAP,SAAiB,EAAe,GAE/B,GAAI,GAAW,EAAK,EAAG,EAAW,EAAK,EAAG,EAAW,EAAK,CAC1D,IAAI,GAAa,EAAS,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EAElD,MAAK,IAAM,EAAE,CACb,MAAK,IAAM,EAAE,CACb,MAAK,IAAM,EAAE,CAEb,MAAK,qBASC,GAAA,UAAA,eAAP,SAAsB,EAAe,GAEpC,GAAI,GAAW,EAAK,EAAG,EAAW,EAAK,EAAG,EAAW,EAAK,CAC1D,IAAI,GAAa,EAAS,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EAElD,MAAK,WAAW,mBAAmB,EAAE,EAAK,EAAE,EAAK,EAAE,EAEnD,MAAK,UAAU,aAAa,EAAG,KAAK,KAEpC,MAAK,GAAK,KAAK,KAAK,CACpB,MAAK,GAAK,KAAK,KAAK,CACpB,MAAK,GAAK,KAAK,KAAK,CAEpB,MAAK,qBAQC,GAAA,UAAA,IAAP,SAAW,GAEV,KAAK,OAAO,EAAS,OAAQ,GAW9B,QAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,MAAO,MAAK,wDAQb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,GAAI,KAAK,eACR,KAAK,kBAEN,OAAO,MAAK,eAGb,SAAsB,MAcjB,GAA2B,EAAI,WACnC,IAAI,EAEJ,GAAM,EAAS,EAEf,IAAI,KAAK,IAAM,EAAI,GAAK,KAAK,IAAM,EAAI,GAAK,KAAK,IAAM,EAAI,EAAG,CAC7D,KAAK,GAAK,EAAI,CACd,MAAK,GAAK,EAAI,CACd,MAAK,GAAK,EAAI,CAEd,MAAK,qBAGN,EAAM,EAAS,EAEf,IAAI,KAAK,YAAc,EAAI,GAAK,KAAK,YAAc,EAAI,GAAK,KAAK,YAAc,EAAI,EAAG,CACrF,KAAK,WAAa,EAAI,CACtB,MAAK,WAAa,EAAI,CACtB,MAAK,WAAa,EAAI,CAEtB,MAAK,qBAGN,EAAM,EAAS,EAEf,IAAI,KAAK,UAAY,EAAI,GAAK,KAAK,UAAY,EAAI,GAAK,KAAK,UAAY,EAAI,EAAG,CAC/E,KAAK,SAAW,EAAI,CACpB,MAAK,SAAW,EAAI,CACpB,MAAK,SAAW,EAAI,CAEpB,MAAK,uDAOP,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,IAAK,KAAK,qBACT,KAAK,qBAAuB,GAAI,GAAmB,KAEpD,OAAO,MAAK,yDAMN,GAAA,UAAA,WAAP,SAAkB,GAEjB,KAAK,SAAW,CAEhB,IAAI,EAAO,CACV,KAAK,6BAA6B,EAAM,cACxC,MAAK,2BAA2B,EAAM,cACtC,MAAK,0BAA0B,EAAM,oBACrC,MAAK,WAAW,EAAM,aAChB,CACN,KAAK,6BAA6B,KAClC,MAAK,2BAA2B,KAChC,MAAK,0BAA0B,KAE/B,MAAK,WAAW,OAOX,GAAA,UAAA,6BAAP,WAIC,MAAO,IAAI,GAML,GAAA,UAAA,2BAAP,WAEC,KAAM,IAAI,GAMJ,GAAA,UAAA,kBAAP,WAEC,KAAK,gBAAkB,IACvB,MAAK,oBAAsB,IAG3B,IAAI,KAAK,SACR,KAAK,sBAMA,GAAA,UAAA,0BAAP,WAEC,KAAK,uBAAyB,KAAK,iBACnC,MAAK,6BAA+B,KAAK,iBACzC,MAAK,qBAAuB,KAAK,iBAEjC,MAAK,qBAAuB,KAAK,iBAEjC,IAAI,KAAK,SACR,KAAK,qBAEN,IAAI,KAAK,+BACR,KAAK,6BAMA,GAAA,UAAA,cAAP,WAEC,KAAK,OAAS,KAAK,SAAS,KAAK,MAAM,KAAK,QAC5C,MAAK,QAAU,KAAK,SAAS,KAAK,OAAO,KAAK,QAC9C,MAAK,OAAS,KAAK,SAAS,KAAK,MAAM,KAAK,QAE5C,MAAK,gBAAkB,MAMjB,GAAA,UAAA,6BAAP,SAAoC,GAEnC,KAAK,uBAAyB,KAAK,uBAAyB,CAG5D,IAAI,KAAK,wBAA0B,KAAK,WAAa,KAAK,kBACzD,KAAK,kBAAqB,KAAK,SAAS,kBAMnC,GAAA,UAAA,0BAAP,SAAiC,GAGhC,KAAK,oBAAsB,KAAK,oBAAsB,EAMhD,GAAA,UAAA,2BAAP,SAAkC,GAEjC,KAAK,qBAAuB,KAAK,qBAAuB,EAMlD,GAAA,UAAA,iBAAP,WAGC,KAAK,KAAK,EAAI,KAAK,EACnB,MAAK,KAAK,EAAI,KAAK,EACnB,MAAK,KAAK,EAAI,KAAK,EAEnB,MAAK,KAAK,EAAI,KAAK,UACnB,MAAK,KAAK,EAAI,KAAK,UACnB,MAAK,KAAK,EAAI,KAAK,UAEnB,MAAK,KAAK,EAAI,KAAK,QACnB,MAAK,KAAK,EAAI,KAAK,QACnB,MAAK,KAAK,EAAI,KAAK,QAEnB,MAAK,UAAU,UAAU,KAAK,qBAE9B,KAAK,KAAK,WAAY,CACrB,KAAK,UAAU,oBAAoB,KAAK,OAAO,EAAE,KAAK,UAAW,KAAK,OAAO,EAAE,KAAK,UAAW,KAAK,OAAO,EAAE,KAAK,SAClH;GAAI,KAAK,eAAiB,EAAc,YACvC,KAAK,UAAU,kBAAkB,KAAK,OAAO,EAAG,KAAK,OAAO,EAAG,KAAK,OAAO,GAG7E,KAAK,eAAiB,KACtB,MAAK,eAAiB,KACtB,MAAK,eAAiB,KACtB,MAAK,YAAc,KACnB,MAAK,YAAc,MAMb,GAAA,UAAA,sBAAP,WAEC,GAAI,KAAK,WAAa,KAAK,SAAS,SAAU,CAC7C,KAAK,iBAAiB,SAAS,KAAK,SAAS,eAC7C,MAAK,iBAAiB,QAAQ,KAAK,gBAC7B,CACN,KAAK,iBAAiB,SAAS,KAAK,YAGrC,KAAK,sBAAwB,MAGvB,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,cAAc,KAAK,EAExB,OAAO,GAID,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,GAAe,KAAK,cAAc,QAAQ,EAE9C,MAAK,cAAc,OAAO,EAAO,EAEjC,OAAO,GAYD,GAAA,UAAA,gBAAP,SAAuB,EAAkC,GAExD,MAAO,OAMD,GAAA,UAAA,iBAAP,WAEC,GAAI,KAAK,aACR,KAAK,aAAa,SAMb,GAAA,UAAA,YAAP,WAEC,MAAO,MAAK,qBAMN,GAAA,UAAA,iBAAP,WAEC,MAAO,MAAK,uBAMN,GAAA,UAAA,WAAP,SAAkB,GAgBjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,cAAc,EAEnB,KAAK,KAAK,wBAA0B,KAAK,kBACxC,KAAK,4BAMA,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,KAAK,QAAS,CACjB,KAAK,QAAQ,cAAc,GAAI,GAAW,EAAW,mBAAoB,MAGzE,MAAK,QAAQ,kBAAkB,MAGhC,KAAK,QAAU,CAEf,IAAI,EAAO,CACV,EAAM,cAAc,GAAI,GAAW,EAAW,eAAgB,MAG9D,GAAM,gBAAgB,MAGvB,KAAK,oBAME,GAAA,UAAA,sBAAR,WAEC,IAAK,KAAK,iBACT,KAAK,iBAAmB,GAAI,GAAmB,EAAmB,iBAAkB,KAErF,MAAK,cAAc,KAAK,kBAMjB,GAAA,UAAA,sBAAR,WAEC,IAAK,KAAK,iBACT,KAAK,iBAAmB,GAAI,GAAmB,EAAmB,iBAAkB,KAErF,MAAK,cAAc,KAAK,kBAMjB,GAAA,UAAA,mBAAR,WAEC,IAAK,KAAK,cACT,KAAK,cAAgB,GAAI,GAAmB,EAAmB,cAAe,KAE/E,MAAK,cAAc,KAAK,eAMjB,GAAA,UAAA,kBAAR,WAEC,GAAI,KAAK,sBAAuB,CAC/B,IAAK,KAAK,cACT,KAAK,cAAgB,GAAI,GAAmB,EAAmB,cAAe,KAE/E,MAAK,cAAc,KAAK,gBAOlB,GAAA,UAAA,2BAAR,WAEC,IAAK,KAAK,uBACT,KAAK,uBAAyB,GAAI,GAAmB,EAAmB,uBAAwB,KAEjG,MAAK,cAAc,KAAK,wBAQjB,GAAA,UAAA,mBAAR,WAEC,GAAI,KAAK,eACR,MAED,MAAK,eAAiB,IAEtB,KAAK,KAAK,wBAA0B,KAAK,kBACxC,KAAK,4BAMC,GAAA,UAAA,oBAAR,WAEC,GAAI,KAAK,oBACR,KAAK,oBAAoB,eAAe,MAMlC,GAAA,UAAA,gBAAR,WAEC,KAAK,WAAc,KAAK,OAAO,GAAK,GAAO,KAAK,OAAO,GAAK,GAAO,KAAK,OAAO,GAAK,CAEpF,IAAI,KAAK,YACR,MAED,MAAK,YAAc,IAEnB,MAAK,qBAME,GAAA,UAAA,mBAAR,WAEC,GAAI,KAAK,eACR,MAED,MAAK,eAAiB,IAEtB,MAAK,oBAEL,IAAI,KAAK,yBACR,KAAK,wBAMC,GAAA,UAAA,mBAAR,WAEC,GAAI,KAAK,eACR,MAED,MAAK,eAAiB,IAEtB,MAAK,oBAEL,IAAI,KAAK,yBACR,KAAK,wBAMC,GAAA,UAAA,gBAAR,WAEC,GAAI,KAAK,YACR,MAED,MAAK,YAAc,IAEnB,MAAK,oBAEL,IAAI,KAAK,sBACR,KAAK,qBAER,OAAA,IA/qE4B,EAirE5B,GAAuB,QAAd,2wBC/0ET,IAAO,GAAS,EAAc,oCAE9B,IAAO,GAAc,EAAa,yCAGlC,IAAO,GAAa,EAAa,8CAgB3B,GAAQ,SAAA,GAAS,EAAjB,EAAQ,EAyBb,SAzBK,KA2BJ,EAAA,KAAA,KAEA,MAAK,eAAiB,GAAI,OAzB3B,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,6CAMlB,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,mDAGN,GAAA,UAAA,iBAAP,WAEC,MAAO,MAAK,eAaN,GAAA,UAAA,oBAAP,SAA2B,GAE1B,GAAI,GAAa,KAAK,eAAe,MACrC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,eAAe,GAAG,oBAAoB,GAOtC,GAAA,UAAA,eAAP,SAAsB,GAErB,KAAK,eAAe,KAAK,EAEzB,GAAY,eAAiB,IAE7B,IAAI,KAAK,iBAAiB,EAAc,oBACvC,KAAK,cAAc,GAAI,GAAc,EAAc,mBAAoB,GAExE,MAAK,kBAAkB,GAOjB,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,eAAe,OAAO,KAAK,eAAe,QAAQ,GAAc,EAErE,GAAY,eAAiB,IAE7B,IAAI,KAAK,iBAAiB,EAAc,sBACvC,KAAK,cAAc,GAAI,GAAc,EAAc,qBAAsB,GAE1E,MAAK,kBAAkB,GAOjB,GAAA,UAAA,MAAP,WAEC,GAAI,GAAiB,GAAI,EACzB,IAAI,GAAa,KAAK,eAAe,MAErC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,EAAM,eAAe,KAAK,eAAe,GAAG,QAE7C,OAAO,GAOD,GAAA,UAAA,MAAP,SAAa,GAEZ,GAAI,GAAqB,KAAK,eAAe,MAC7C,KAAK,GAAI,GAAW,EAAG,EAAI,IAAe,EACzC,KAAK,eAAe,GAAG,MAAM,GAMxB,GAAA,UAAA,QAAP,WAEC,GAAI,GAAqB,KAAK,eAAe,MAE7C,KAAK,GAAI,GAAW,EAAG,EAAI,IAAe,EAAG,CAC5C,GAAI,GAA0B,KAAK,eAAe,EAClD,MAAK,kBAAkB,EACvB,GAAQ,WASH,GAAA,UAAA,QAAP,SAAe,EAAmB,GAAnB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAAmB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAEjC,GAAI,GAAqB,KAAK,eAAe,MAE7C,KAAK,GAAI,GAAW,EAAG,EAAI,IAAe,EACzC,KAAK,eAAe,GAAG,QAAQ,EAAQ,GAGlC,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,KAAK,iBAAiB,EAAc,gBACvC,KAAK,cAAc,GAAI,GAAc,EAAc,eAAgB,IAEtE,OAAA,IAjIuB,EAmIL,GAAA,QAAT,0TCzJT,IAAO,GAAS,EAAc,oCAE9B,IAAO,GAAmB,EAAY,6CAEtC,IAAO,GAAsB,EAAW,uDAGxC,IAAO,GAAU,EAAc,uCAG/B,IAAM,GAAS,SAAA,GAAS,EAAlB,EAAS,EA2Bd,SA3BK,KA6BJ,EAAA,KAAA,KA3BO,MAAA,OAAgB,QAChB,MAAA,QAAiB,CACjB,MAAA,QAAiB,CACjB,MAAA,QAAiB,CAEjB,MAAA,cAAuB,QACvB,MAAA,SAAkB,CACnB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CAEnB,MAAA,UAAmB,CACpB,MAAA,YAAqB,CACrB,MAAA,YAAqB,CACrB,MAAA,YAAqB,CAEpB,MAAA,SAAkB,CACnB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CACpB,MAAA,WAAoB,CAEnB,MAAA,cAAwB,MAShC,OAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,IAAI,EAAO,CACV,GAAI,KAAK,eAAiB,KACzB,KAAK,cAAgB,KAAK,qBAE3B,MAAK,cAAc,MAAQ,SACrB,CACN,KAAK,cAAc,SACnB,MAAK,cAAgB,KAGtB,KAAK,cAAc,GAAI,GAAW,EAAW,0DAGvC,GAAA,UAAA,oBAAP,WAEC,KAAM,IAAI,GAGX,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,EAAQ,EACX,EAAQ,CAET,MAAK,UAAY,CACjB,MAAK,qDAGN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,GAAI,EAAQ,EACX,EAAQ,CAET,MAAK,SAAW,CAChB,MAAK,oDAGN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,CACd,MAAK,SAAY,KAAK,QAAU,GAAM,KAAM,GAC5C,MAAK,SAAY,KAAK,QAAU,EAAK,KAAM,GAC3C,MAAK,SAAW,KAAK,OAAS,KAAM,GAEpC,MAAK,eACL,MAAK,qDAGN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,GAAI,EAAQ,EACX,EAAQ,MACJ,IAAI,EAAQ,EAChB,EAAQ,CAET,MAAK,SAAW,CAChB,MAAK,oDAGN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,CACrB,MAAK,oDAGE,GAAA,UAAA,cAAR,WAEC,KAAK,YAAe,KAAK,eAAiB,GAAM,KAAM,IAAK,KAAK,QAChE,MAAK,YAAe,KAAK,eAAiB,EAAK,KAAM,IAAK,KAAK,QAC/D,MAAK,YAAc,KAAK,cAAgB,KAAM,IAAK,KAAK,SAGlD,GAAA,UAAA,2BAAP,SAAkC,EAAgB,EAAe,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEhE,KAAM,IAAI,GAIX,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,0CAGV,GAAA,UAAA,eAAR,WAEC,KAAK,YAAc,KAAK,QAAQ,KAAK,SACrC,MAAK,YAAc,KAAK,QAAQ,KAAK,SACrC,MAAK,YAAc,KAAK,QAAQ,KAAK,UAG9B,GAAA,UAAA,cAAR,WAEC,KAAK,WAAa,KAAK,QAAQ,KAAK,QACpC,MAAK,WAAa,KAAK,QAAQ,KAAK,QACpC,MAAK,WAAa,KAAK,QAAQ,KAAK,SAGrC,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,CACrB,MAAK,cAAc,MAAQ,yCAE7B,OAAA,IA/KwB,EAiLxB,GAAmB,QAAV,oXCzLT,IAAO,GAAW,EAAc,sCAChC,IAAO,GAAe,EAAa,0CACnC,IAAO,GAAmB,EAAY,8CACtC,IAAO,GAAgB,EAAa,iDAK9B,GAAe,SAAA,GAAS,EAAxB,EAAe,EAmJpB,SAnJK,KAqJJ,EAAA,KAAA,KAAM,KAxIC,MAAA,gBAA0B,IAC1B,MAAA,uBAAyB,IACzB,MAAA,gBAA0B,IAC1B,MAAA,aAAuB,IAuI9B,MAAK,eAAiB,EAxHhB,EAAA,UAAA,qBAAP,WAEC,KAAK,SAAS,EAAgB,aAAe,CAE7C,IAAI,GAAgB,CACpB,MAAK,SAAS,EAAgB,qBAAuB,CACrD,IAAU,CAEV,MAAK,SAAS,EAAgB,mBAAqB,CACnD,IAAU,CAEV,MAAK,SAAS,EAAgB,gBAAkB,CAChD,IAAU,CAEV,MAAK,SAAS,EAAgB,YAAc,CAC5C,IAAU,CAEV,MAAK,SAAS,EAAgB,aAAe,CAC7C,MAAK,SAAS,EAAgB,qBAAuB,CACrD,MAAK,SAAS,EAAgB,mBAAqB,CACnD,MAAK,SAAS,EAAgB,gBAAkB,CAChD,MAAK,SAAS,EAAgB,YAAc,CAE5C,IAAI,GAAa,KAAK,cAAc,CAEpC,IAAI,KAAK,YAAc,KACtB,KAAK,WAAa,GAAI,OAAc,OAChC,IAAI,KAAK,WAAW,QAAU,EAClC,KAAK,WAAW,OAAS,CAE1B,MAAK,oBAAsB,MAM5B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,gBAAiB,KAAK,cAEjD,IAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,WAE3B,IAAI,KAAK,aACR,KAAK,aAAa,KAAK,aAAc,KAAK,WAE3C,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,gBAAiB,KAAK,cAEjD,OAAO,MAAK,oDAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,gBAAiB,KAAK,cAEjD,OAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,WAE3B,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,GAAI,KAAK,aACR,KAAK,aAAa,KAAK,aAAc,KAAK,WAE3C,OAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,GAAI,KAAK,aACR,KAAK,aAAa,KAAK,aAAc,KAAK,WAE3C,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAaN,GAAA,UAAA,qBAAP,WAEC,GAAI,KAAK,uBACR,KAAK,mBAAqB,KAAK,eAAe,OAAO,KAAK,aAE3D,OAAO,MAAK,mBAMN,GAAA,UAAA,gBAAP,SAAuB,EAA2B,GAEjD,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,MAAK,gBAAkB,CAEvB,IAAI,KAAK,iBAAmB,KAC3B,KAAK,gBAAkB,GAAI,MAE5B,MAAK,cAAgB,CAErB,IAAI,KAAK,eAAiB,KACzB,KAAK,cAAgB,GAAI,MAE1B,MAAK,uBAAyB,IAE9B,MAAK,aAAe,KAAK,gBAAgB,OAAO,CAEhD,MAAK,cAAgB,KAAK,aAAa,CAEvC,IAAI,GAAc,KAAK,cAAc,KAAK,UAAU,EAAgB,YAEpE,IAAI,KAAK,YAAc,KACtB,KAAK,WAAa,GAAI,OAAc,OAChC,IAAI,KAAK,WAAW,QAAU,EAClC,KAAK,WAAW,OAAS,CAE1B,GAAI,CACJ,GAAI,CACJ,GAAQ,KAAK,UAAU,EAAgB,oBACvC,GAAS,KAAK,UAAU,EAAgB,oBACxC,GAAY,KAAK,UACjB,GAAU,GAAI,MAEd,OAAO,EAAI,EAAY,OAAQ,CAC9B,EAAU,EAAM,EAAS,EAAI,EAAY,CACzC,GAAU,GAAS,EAAO,EAC1B,GAAU,EAAQ,GAAK,EAAO,EAAI,EAClC,GAAU,EAAQ,GAAK,EAAO,EAAI,EAElC,GAAU,EAAM,EAAS,EAAI,EAAc,CAC3C,GAAU,EAAQ,GAAK,EAAO,EAC9B,GAAU,EAAQ,GAAK,EAAO,EAAI,EAClC,GAAU,EAAQ,GAAK,EAAO,EAAI,EAElC,MAAM,GAAK,EAAG,CACb,GAAI,GAAW,EAAM,EAAS,CAC9B,GAAQ,KAAK,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAAG,EAAI,EAChD,GAAI,CACJ,IAAK,EAGN,GAAS,EAGV,KAAK,cAAc,EAEnB,MAAK,mBAEL,MAAK,uBAEL,MAAK,gBAAkB,MAMjB,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,MAAK,WAAa,CAElB,IAAI,GAAU,KAAM,CACnB,EAAI,CACJ,GAAI,CACJ,GAAS,KAAK,UAAU,EAAgB,eACxC,GAAS,KAAK,UAAU,EAAgB,eACxC,GAAY,KAAK,UAEjB,GAAQ,CACR,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAU,GAAU,KAAK,MAAM,IAAK,EAAQ,GAAQ,EAAS,IAAO,GAAK,EAAO,GAAK,EAAO,EAE5F,MAAM,GAAK,EAAG,CACb,EAAI,CACJ,KAED,GAAS,GAIX,KAAK,uBAEL,MAAK,gBAAkB,MAMjB,GAAA,UAAA,aAAP,SAAoB,EAA2B,GAE9C,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,MAAK,aAAe,CAEpB,MAAK,WAAa,CAGlB,IAAI,KAAK,cAAgB,KAAM,CAC9B,KAAK,aAAe,GAAI,OAAM,KAAK,aAAa,EAEhD,GAAI,CACJ,OAAO,EAAI,KAAK,aAAa,OAC5B,KAAK,aAAa,KAAO,EAG3B,GAAI,KAAK,YAAc,KAAM,CAC5B,KAAK,WAAa,GAAI,OAAM,KAAK,aAAa,EAE9C,GAAI,CACJ,OAAO,EAAI,KAAK,WAAW,OAC1B,KAAK,WAAW,KAAO,EAGzB,EAAI,CACJ,GAAI,CACJ,GAAS,KAAK,UAAU,EAAgB,WACxC,GAAS,KAAK,UAAU,EAAgB,WACxC,GAAS,KAAK,UAEd,GAAQ,CAER,OAAO,EAAI,KAAK,aAAa,OAAQ,CACpC,GAAW,EAAQ,GAAQ,EAAS,EAAI,KAAK,WAAa,KAAK,YAC/D,GAAO,GAAS,EAAO,EACvB,GAAO,EAAQ,GAAK,EAAO,EAAI,EAC/B,GAAO,EAAQ,GAAK,EAAO,EAAI,EAC/B,GAAO,EAAQ,GAAK,EAAO,EAAI,EAE/B,MAAM,GAAK,EAAG,CACb,EAAI,CACJ,IAAK,EAGN,GAAS,EAGV,KAAK,oBAEL,MAAK,aAAe,MAMd,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,MAAK,gBAAkB,IACvB,MAAK,cAAgB,IACrB,MAAK,WAAa,IAClB,MAAK,aAAe,IACpB,MAAK,WAAa,KAMZ,GAAA,UAAA,kBAAP,WAEC,GAAI,KAAK,eACR,KAAK,eAAe,kBAAkB,MAcjC,GAAA,UAAA,MAAP,WAEC,GAAI,GAAwB,GAAI,EAChC,GAAM,cAAc,KAAK,UAAU,SACnC,GAAM,gBAAgB,KAAK,gBAAgB,SAAU,KAAK,cAAc,SACxE,GAAM,gBAAgB,KAAK,WAAW,SACtC,GAAM,gBAAgB,KAAK,gBAAgB,SAAU,KAAK,cAAc,SAExE,OAAO,GAGD,GAAA,UAAA,uBAAP,WAEC,KAAK,oBAAsB,IAE3B,MAAK,uBACL,MAAK,uBACL,MAAK,qBAGE,GAAA,UAAA,sBAAR,WAEC,GAAI,KAAK,gBACR,MAED,MAAK,gBAAkB,IAEvB,KAAK,KAAK,kBACT,KAAK,kBAAoB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,cAEtG,MAAK,cAAc,KAAK,mBAGjB,GAAA,UAAA,sBAAR,WAEC,GAAI,KAAK,gBACR,MAED,MAAK,gBAAkB,IAEvB,KAAK,KAAK,kBACT,KAAK,kBAAoB,GAAI,GAAiB,EAAiB,iBAAkB,EAAgB,eAElG,MAAK,cAAc,KAAK,mBAGjB,GAAA,UAAA,mBAAR,WAEC,GAAI,KAAK,aACR,MAED,MAAK,aAAe,IAEpB,KAAK,KAAK,cACT,KAAK,cAAgB,GAAI,GAAiB,EAAiB,iBAAkB,EAAgB,WAE9F,MAAK,cAAc,KAAK,eAvaX,GAAA,YAAqB,UACrB,GAAA,oBAA6B,gBAC7B,GAAA,kBAA2B,cAC3B,GAAA,eAAwB,WACxB,GAAA,WAAoB,QAGpB,GAAA,gBAAyB,QACzB,GAAA,aAAsB,QACtB,GAAA,iBAA0B,QAgazC,OAAA,IA3a8B,EA6aL,GAAA,QAAhB,+WCvbT,IAAO,GAAS,EAAc,oCAI9B,IAAO,GAAW,EAAc,0CAc1B,GAAW,SAAA,GAAS,EAApB,EAAW,EA0BhB,SA1BK,GA0BO,EAA6B,EAAiB,GAAA,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAEzD,EAAA,KAAA,KAEA,MAAK,aAAe,CACpB,MAAK,aAAe,CACpB,MAAK,SAAW,EAzBjB,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,kDAMlB,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAqBN,GAAA,UAAA,QAAP,WAEC,KAAK,SAAW,IAEhB,GAAA,UAAM,QAAO,KAAA,MAGP,GAAA,UAAA,oBAAP,SAA2B,GAE1B,EAAS,iBAAiB,MAE5B,OAAA,IAjD0B,EAmD1B,GAAqB,QAAZ,2GCrET,GAAM,GAAe,WAArB,QAAM,MAKS,EAAA,QAAiB,SAKjB,GAAA,aAAsB,aAKtB,GAAA,gBAAyB,gBACxC,OAAA,KAEA,GAAyB,QAAhB,yLClBT,IAAO,GAAc,EAAa,yCAGlC,IAAO,GAAmB,EAAY,6CAItC,IAAO,GAAgB,EAAa,iDAK9B,GAAe,SAAA,GAAS,EAAxB,EAAe,EAuFpB,SAvFK,GAuFO,GAEX,EAAA,KAAA,KArFM,MAAA,oBAA8B,IAS9B,MAAA,oBAA8B,IAI9B,MAAA,SAAkB,GAAI,OACtB,MAAA,SAAkB,GAAI,OAyE5B,MAAK,oBAAsB,EAvErB,EAAA,UAAA,qBAAP,WAEC,KAAM,IAAI,GAKX,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mDAMb,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,yBAGb,SAA6B,GAE5B,GAAI,KAAK,qBAAuB,EAC/B,MAED,MAAK,oBAAsB,CAE3B,MAAK,oBAAsB,IAE3B,IAAI,EACH,KAAK,6DAMP,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,KAAK,gBAEL,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAGb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kDAgBN,GAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,KAAK,oBACR,KAAK,sBAEN,OAAO,MAAK,SAAS,GAMf,GAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,KAAK,oBACR,KAAK,sBAEN,OAAO,MAAK,SAAS,GAGf,GAAA,UAAA,eAAP,WAEC,KAAM,IAAI,GAMJ,GAAA,UAAA,QAAP,WAEC,KAAK,UAAY,IACjB,MAAK,WAAa,KAQZ,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,UAAY,CACjB,MAAK,YAAc,EAAQ,MAE3B,MAAK,cAAgB,KAAK,YAAY,CAEtC,MAAK,sBAMC,GAAA,UAAA,kBAAP,WAEC,GAAI,KAAK,eACR,KAAK,eAAe,kBAAkB,MAcjC,GAAA,UAAA,MAAP,WAEC,KAAM,IAAI,GAGJ,GAAA,UAAA,oBAAP,SAA2B,IASpB,GAAA,UAAA,MAAP,SAAa,IAKN,GAAA,UAAA,QAAP,SAAe,EAAmB,GAAnB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAAmB,GAAA,QAAA,GAAiB,CAAjB,EAAA,GAK3B,GAAA,UAAA,qBAAP,WAEC,KAAM,IAAI,GAGH,GAAA,UAAA,oBAAR,WAEC,IAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAiB,EAAiB,gBAE9D,MAAK,cAAc,KAAK,iBAGlB,GAAA,UAAA,uBAAP,WAEC,KAAM,IAAI,GA1MG,GAAA,YAAqB,UA4MpC,OAAA,IA9M8B,EAgN9B,GAAyB,QAAhB,qUC5NT,IAAO,GAAmB,EAAY,6CAGtC,IAAO,GAAc,EAAa,6CAkB5B,GAAW,SAAA,GAAS,EAApB,EAAW,EA4EhB,SA5EK,KA8EJ,EAAA,KAAA,KAzEM,MAAA,QAAiB,CAGhB,MAAA,aAAkC,GAAI,OAY9C,OAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,aAAa,6CAM1B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,WAAa,KAAK,aAAa,cAG5C,SAAoB,GAEnB,GAAI,KAAK,SACR,KAAK,SAAS,aAAa,KAE5B,MAAK,UAAY,CAEjB,IAAI,KAAK,SACR,KAAK,SAAS,UAAU,0CAM1B,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,aAAa,mDAM1B,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,cAAgB,KAAK,aAAa,iBAG/C,SAAuB,GAEtB,KAAK,aAAe,sCAcd,GAAA,UAAA,QAAP,WAEC,KAAK,SAAW,IAEhB,IAAI,GAAa,KAAK,aAAa,MACnC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,aAAa,GAAG,UAQhB,GAAA,UAAA,wBAAP,SAA+B,GAE9B,MAAO,MAAK,aAAa,wBAAwB,GAG3C,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,aAAa,KAAK,EAEvB,OAAO,GAID,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,GAAe,KAAK,aAAa,QAAQ,EAE7C,MAAK,aAAa,OAAO,EAAO,EAEhC,OAAO,GAGD,GAAA,UAAA,+BAAP,WAEC,GAAI,GAAa,KAAK,aAAa,MACnC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,aAAa,GAAG,qBAGhB,GAAA,UAAA,oBAAP,SAA2B,GAE1B,KAAM,IAAI,GAGJ,GAAA,UAAA,sBAAP,WAEC,MAAO,MAAK,UAEd,OAAA,IAxI0B,EA0IL,GAAA,QAAZ,uHC7JT,GAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAa,EAAa,qCAEjC,IAAO,GAAQ,EAAe,oCA2DxB,GAAS,WA0Md,QA1MK,GA0MO,GApML,KAAA,UAAqB,GAAI,EAsM/B,MAAK,eAAiB,EAjMvB,OAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,GAAI,GAAoB,EAAc,WAAW,KAAK,eAAe,WACrE,GAAS,QAET,OAAO,uCAkBR,QAAA,eAAW,EAAA,UAAA,kCAAX,WAEC,MAAO,MAAK,gEAcb,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,wDAMb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,GAAI,GAAoB,EAAc,MAAM,KAAK,eAAe,WAChE,GAAS,QAET,OAAO,uCAMR,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,GAAc,WAAW,KAAK,eAAe,gDAMrD,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,GAAI,GAAoB,EAAc,SAAS,KAAK,eAAe,WACnE,GAAS,QAET,OAAO,uCA6BR,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAAe,gBAG5B,SAAoB,GAEnB,KAAK,eAAe,WAAa,sCAkBlC,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAAe,WAAW,cAGvC,SAAoB,GAEnB,KAAK,eAAe,EAAI,EAAM,CAC9B,MAAK,eAAe,EAAI,EAAM,CAC9B,MAAK,eAAe,EAAI,EAAM,sCAM/B,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,GAAc,SAAS,KAAK,eAAe,gDAMnD,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,IAAI,GAAS,KAAK,eAAe,UAAW,KAAK,eAAe,UAAW,KAAK,eAAe,gBAGvG,SAAoB,GAEnB,KAAK,eAAe,UAAY,EAAM,CACtC,MAAK,eAAe,UAAY,EAAM,CACtC,MAAK,eAAe,UAAY,EAAM,sCAMvC,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,IAAI,GAAS,KAAK,eAAe,OAAQ,KAAK,eAAe,OAAQ,KAAK,eAAe,aAGjG,SAAiB,GAEhB,KAAK,eAAe,OAAS,EAAM,CACnC,MAAK,eAAe,OAAS,EAAM,CACnC,MAAK,eAAe,OAAS,EAAM,sCAMpC,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,GAAc,MAAM,KAAK,eAAe,gDA0BzC,GAAA,UAAA,oBAAP,SAA2B,GAE1B,MAAO,IAAI,GASL,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,eAAe,eAAe,EAAS,OAAQ,GAQ9C,GAAA,UAAA,aAAP,SAAoB,GAEnB,KAAK,eAAe,eAAe,EAAS,QAAS,GAS/C,GAAA,UAAA,SAAP,SAAgB,GAEf,KAAK,eAAe,eAAe,EAAS,QAAS,GAQ/C,GAAA,UAAA,UAAP,SAAiB,GAEhB,KAAK,eAAe,eAAe,EAAS,OAAQ,GAQ9C,GAAA,UAAA,OAAP,SAAc,GAEb,KAAK,eAAe,eAAe,EAAS,OAAQ,GAQ9C,GAAA,UAAA,SAAP,SAAgB,GAEf,KAAK,eAAe,eAAe,EAAS,QAAS,GAEvD,OAAA,KAEA,GAAmB,QAAV,ySCpWT,IAAO,GAAQ,EAAe,gCAE9B,IAAO,GAAe,EAAa,0CACnC,IAAO,GAAe,EAAa,0CACnC,IAAO,GAAgB,EAAa,iDAK9B,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EA+axB,SA/aK,GA+aO,GAEX,EAAA,KAAA,KAAM,EAhaC,MAAA,gBAA0B,IAC1B,MAAA,kBAA4B,IAC5B,MAAA,mBAA6B,IAC7B,MAAA,oBAA8B,IAC9B,MAAA,qBAA+B,IAC/B,MAAA,UAAoB,IACpB,MAAA,mBAA6B,IAC7B,MAAA,mBAA6B,IAC7B,MAAA,mBAA6B,IAiB7B,MAAA,mBAA6B,IAC7B,MAAA,mBAA6B,IAC7B,MAAA,oBAA8B,IAC9B,MAAA,eAAyB,KACzB,MAAA,gBAA0B,KAM1B,MAAA,QAAiB,CACjB,MAAA,QAAiB,CA8XxB,MAAK,eAAiB,EAjXvB,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAMb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAQb,QAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,MAAO,MAAK,0BAGb,SAA+B,GAE9B,GAAI,KAAK,sBAAwB,EAChC,MAED,MAAK,qBAAuB,CAE5B,MAAK,+DAGC,GAAA,UAAA,qBAAP,WAEC,GAAI,KAAK,mBAAoB,CAC5B,KAAK,SAAS,EAAoB,aAAe,CAGjD,MAAK,SAAS,EAAoB,eAAiB,CACnD,IAAI,GAAgB,CAEpB,IAAI,KAAK,gBAAkB,KAAM,CAChC,KAAK,SAAS,EAAoB,aAAe,CACjD,IAAU,EAGX,GAAI,KAAK,iBAAmB,KAAM,CACjC,KAAK,SAAS,EAAoB,cAAgB,CAClD,IAAU,EAGX,GAAI,KAAK,MAAQ,KAAM,CACtB,KAAK,SAAS,EAAoB,SAAW,CAC7C,IAAU,EAGX,GAAI,KAAK,eAAiB,KAAM,CAC/B,KAAK,SAAS,EAAoB,mBAAqB,CACvD,IAAU,EAGX,GAAI,KAAK,eAAiB,KAAM,CAC/B,KAAK,SAAS,EAAoB,kBAAoB,CACtD,IAAU,KAAK,iBAGhB,GAAI,KAAK,eAAiB,KAAM,CAC/B,KAAK,SAAS,EAAoB,mBAAqB,CACvD,IAAU,KAAK,iBAGhB,KAAK,SAAS,EAAoB,aAAe,CACjD,MAAK,SAAS,EAAoB,eAAiB,CACnD,MAAK,SAAS,EAAoB,aAAe,CACjD,MAAK,SAAS,EAAoB,cAAgB,CAClD,MAAK,SAAS,EAAoB,SAAW,CAC7C,MAAK,SAAS,EAAoB,mBAAqB,CACvD,MAAK,SAAS,EAAoB,kBAAoB,CACtD,MAAK,SAAS,EAAoB,mBAAqB,CAEvD,IAAI,GAAa,KAAK,cAAc,CAEpC,IAAI,KAAK,YAAc,KACtB,KAAK,WAAa,GAAI,OAAc,OAChC,IAAI,KAAK,WAAW,QAAU,EAClC,KAAK,WAAW,OAAS,MAEpB,CACN,KAAK,SAAS,EAAoB,eAAiB,CACnD,MAAK,SAAS,EAAoB,aAAe,CACjD,MAAK,SAAS,EAAoB,cAAgB,CAClD,MAAK,SAAS,EAAoB,SAAW,CAC7C,MAAK,SAAS,EAAoB,mBAAqB,CACvD,MAAK,SAAS,EAAoB,kBAAoB,CACtD,MAAK,SAAS,EAAoB,mBAAqB,CAEvD,MAAK,SAAS,EAAoB,eAAiB,CACnD,MAAK,SAAS,EAAoB,aAAe,CACjD,MAAK,SAAS,EAAoB,cAAgB,CAClD,MAAK,SAAS,EAAoB,SAAW,CAC7C,MAAK,SAAS,EAAoB,mBAAqB,CACvD,MAAK,SAAS,EAAoB,kBAAoB,KAAK,gBAC3D,MAAK,SAAS,EAAoB,mBAAqB,KAAK,iBAG7D,KAAK,oBAAsB,MAM5B,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,sBAGb,SAA2B,GAE1B,GAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,iBAAmB,CAExB,MAAK,oBAAsB,IAE3B,IAAI,KAAK,oBACR,KAAK,6DAQP,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,MAAK,eAAiB,CAEtB,IAAI,EACH,KAAK,sDAOP,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wBAGb,SAA6B,GAE5B,GAAI,KAAK,oBAAsB,EAC9B,MAED,MAAK,mBAAqB,CAE1B,IAAI,EACH,KAAK,0DAOP,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,yBAGb,SAA8B,GAE7B,GAAI,KAAK,qBAAuB,EAC/B,MAED,MAAK,oBAAsB,CAE3B,IAAI,EACH,KAAK,2DAMP,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,WAE3B,IAAI,KAAK,oBACR,KAAK,oBAAoB,KAAK,eAE/B,IAAI,KAAK,qBACR,KAAK,qBAAqB,KAAK,gBAEhC,IAAI,KAAK,UACR,KAAK,UAAU,KAAK,KAErB,IAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,IAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,IAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,WAE3B,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,GAAI,KAAK,oBACR,KAAK,oBAAoB,KAAK,eAE/B,OAAO,MAAK,mDAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,GAAI,KAAK,qBACR,KAAK,qBAAqB,KAAK,gBAEhC,OAAO,MAAK,oDAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,GAAI,KAAK,kBACR,KAAK,mBAEN,OAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,mBACR,KAAK,oBAEN,OAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,WAAX,WAEC,GAAI,KAAK,UACR,KAAK,UAAU,KAAK,KAErB,OAAO,MAAK,yCAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,OAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,IAAI,KAAK,qBACR,MAAO,MAAK,sBAEb,OAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,OAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAGb,SAA0B,GAEzB,GAAI,KAAK,iBAAmB,EAC3B,MAED;KAAK,gBAAkB,CAEvB,IAAI,KAAK,mBACR,KAAK,qBAEN,IAAI,KAAK,oBACR,KAAK,sBAEN,MAAK,kBAAoB,yCAG1B,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,OAAO,MAAK,wDAGb,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,KAAK,cAE9B,OAAO,MAAK,0DAaN,GAAA,UAAA,qBAAP,WAEC,GAAI,KAAK,gBACR,KAAK,gBAAgB,KAAK,WAE3B,OAAO,MAAK,WAMN,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,MAAK,WAAa,CAElB,IAAI,KAAK,YAAc,KACtB,KAAK,WAAa,GAAI,MAEvB,MAAK,cAAgB,KAAK,WAAW,OAAO,CAE5C,IAAI,KAAK,mBAAoB,CAC5B,GAAI,GAAa,KAAK,cAAc,KAAK,UAAU,EAAoB,YAEvE,IAAI,KAAK,YAAc,KACtB,KAAK,WAAa,GAAI,OAAc,OAChC,IAAI,KAAK,WAAW,QAAU,EAClC,KAAK,WAAW,OAAS,CAE1B,GAAI,CACJ,GAAQ,KAAK,UAAU,EAAoB,cAC3C,GAAS,KAAK,UAAU,EAAoB,cAC5C,GAAY,KAAK,UAEjB,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAU,GAAS,EAAO,IAC1B,GAAU,EAAQ,GAAK,EAAO,IAC9B,GAAU,EAAQ,GAAK,EAAO,IAC9B,IAAS,GAIX,GAAI,KAAK,mBACR,KAAK,qBAEN,IAAI,KAAK,oBACR,KAAK,sBAEN,IAAI,KAAK,eACR,KAAK,iBAEN,MAAK,mBAEL,MAAK,uBAEL,MAAK,gBAAkB,MAMjB,GAAA,UAAA,oBAAP,SAA2B,GAE1B,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,KAAK,mBAAoB,CAC7B,IAAK,KAAK,gBAAkB,MAAQ,GAAU,QAAU,KAAK,gBAAkB,MAAQ,GAAU,MAAO,CACvG,GAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAG7B,KAAK,eAAiB,CAEtB,IAAI,GAAU,MAAQ,KAAK,mBAAoB,CAC9C,EAAI,CACJ,GAAQ,KAAK,UAAU,EAAoB,YAC3C,GAAS,KAAK,UAAU,EAAoB,YAC5C,GAAU,KAAK,UAEf,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAQ,GAAS,EAAO,IACxB,GAAQ,EAAQ,GAAK,EAAO,IAC5B,GAAQ,EAAQ,GAAK,EAAO,IAC5B,IAAS,QAGL,CACN,GAAI,KAAK,gBAAkB,KAAM,CAChC,KAAK,eAAiB,GAAI,OAAc,KAAK,WAAW,OAExD,IAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAG7B,GAAI,KAAK,kBACR,KAAK,mBAEN,GAAS,KAAK,UAAU,EAAoB,YAC5C,GAAS,KAAK,UAAU,EAAoB,YAG5C,GAAU,KAAK,mBAAoB,KAAK,WAAa,KAAK,cAE1D,IAAI,GAAY,CAChB,IAAI,GAAY,CAChB,IAAI,GAAY,CAEhB,GAAQ,KAGJ,GAAc,EAAQ,MAC1B,OAAO,EAAQ,EAAM,CACpB,EAAQ,GAAS,CACjB,GAAQ,EAAQ,GAAK,CACrB,GAAQ,EAAQ,GAAK,CACrB,IAAS,EAGV,GAAI,GAAW,CACf,IAAI,GAAc,KAAK,UAAU,MACjC,IAAI,EAEJ,GAAI,CAGJ,OAAO,EAAI,EAAM,CAChB,EAAS,KAAK,gBAAiB,KAAK,aAAa,KAAO,CACxD,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAQ,IAAU,KAAK,aAAa,GAAI,CACxC,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAQ,IAAU,KAAK,aAAa,GAAI,CACxC,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAQ,IAAU,KAAK,aAAa,GAAI,CACxC,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,GAAQ,EAAQ,IAAM,KAAK,aAAa,GAAI,CAC5C,IAAM,CACN,IAAM,CACN,IAAM,EAGP,EAAI,CACJ,GAAQ,CAGR,OAAO,EAAQ,EAAM,CACpB,GAAI,GAAY,EAAQ,EACxB,IAAI,GAAY,EAAQ,EAAQ,EAChC,IAAI,GAAY,EAAQ,EAAQ,EAChC,IAAI,GAAW,EAAI,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAEhD,IAAI,KAAK,mBAAoB,CAC5B,KAAK,eAAe,KAAO,EAAQ,GAAS,EAAG,CAC/C,MAAK,eAAe,KAAO,EAAQ,EAAQ,GAAK,EAAG,CACnD,MAAK,eAAe,KAAO,EAAQ,EAAQ,GAAK,EAAG,MAC7C,CACN,EAAQ,GAAS,EAAG,CACpB,GAAQ,EAAQ,GAAK,EAAG,CACxB,GAAQ,EAAQ,GAAK,EAAG,EAGzB,GAAS,GAIX,KAAK,qBAEL,MAAK,oBAAsB,MAMrB,GAAA,UAAA,qBAAP,SAA4B,GAE3B,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,KAAK,oBAAqB,CAC9B,IAAK,KAAK,iBAAmB,MAAQ,GAAU,QAAU,KAAK,iBAAmB,MAAQ,GAAU,MAAO,CACzG,GAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAI7B,KAAK,gBAAkB,CAEvB,IAAI,GAAU,MAAQ,KAAK,mBAAoB,CAC9C,EAAI,CACJ,GAAQ,KAAK,UAAU,EAAoB,aAC3C,GAAS,KAAK,UAAU,EAAoB,aAC5C,GAAW,KAAK,UAEhB,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAS,GAAS,EAAO,IACzB,GAAS,EAAQ,GAAK,EAAO,IAC7B,GAAS,EAAQ,GAAK,EAAO,IAC7B,IAAS,QAGL,CACN,GAAI,KAAK,iBAAmB,KAAM,CACjC,KAAK,gBAAkB,GAAI,OAAc,KAAK,WAAW,OAEzD,IAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAG7B,GAAI,KAAK,mBACR,KAAK,oBAEN,GAAS,KAAK,UAAU,EAAoB,aAC5C,GAAS,KAAK,UAAU,EAAoB,aAG5C,GAAW,KAAK,mBAAoB,KAAK,WAAa,KAAK,eAE3D,GAAQ,KAGJ,GAAc,EAAS,MAC3B,OAAO,EAAQ,EAAM,CACpB,EAAS,GAAS,CAClB,GAAS,EAAQ,GAAK,CACtB,GAAS,EAAQ,GAAK,CAEtB,IAAS,EAGV,GAAI,GAAW,CACf,IAAI,EACJ,IAAI,GAAY,CAChB,IAAI,GAAY,CAChB,IAAI,GAAY,CAEhB,GAAI,KAGA,GAAc,KAAK,UAAU,MACjC,OAAO,EAAI,EAAM,CAChB,EAAS,KAAK,gBAAiB,KAAK,aAAa,KAAO,CACxD,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,IAAU,KAAK,cAAc,GAAI,CAC1C,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,IAAU,KAAK,cAAc,GAAI,CAC1C,GAAQ,EAAS,KAAK,UAAU,KAAK,CACrC,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,MAAY,KAAK,cAAc,GAAI,CAC5C,GAAS,IAAU,KAAK,cAAc,GAAI,CAC1C,IAAM,CACN,IAAM,CACN,IAAM,EAGP,EAAI,CACJ,GAAQ,CAGR,OAAO,EAAQ,EAAM,CACpB,GAAI,GAAY,EAAS,EACzB,IAAI,GAAY,EAAS,EAAQ,EACjC,IAAI,GAAY,EAAS,EAAQ,EACjC,IAAI,GAAW,EAAI,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAEhD,IAAI,KAAK,mBAAoB,CAC5B,KAAK,gBAAgB,KAAO,EAAS,GAAS,EAAG,CACjD,MAAK,gBAAgB,KAAO,EAAS,EAAQ,GAAK,EAAG,CACrD,MAAK,gBAAgB,KAAO,EAAS,EAAQ,GAAK,EAAG,MAC/C,CACN,EAAS,GAAS,EAAG,CACrB,GAAS,EAAQ,GAAK,EAAG,CACzB,GAAS,EAAQ,GAAK,EAAG,EAG1B,GAAS,GAIX,KAAK,sBAEL,MAAK,qBAAuB,MAMtB,GAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,KAAK,eAAgB,CACzB,IAAK,KAAK,MAAQ,MAAQ,GAAU,QAAU,KAAK,MAAQ,MAAQ,GAAU,MAAO,CACnF,GAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAG7B,KAAK,KAAO,CAEZ,IAAI,GAAU,MAAQ,KAAK,mBAAoB,CAC9C,EAAI,CACJ,GAAQ,KAAK,UAAU,EAAoB,QAC3C,GAAS,KAAK,UAAU,EAAoB,QAC5C,GAAM,KAAK,UAEX,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAI,GAAS,EAAO,IACpB,GAAI,EAAQ,GAAK,EAAO,IACxB,IAAS,QAIL,CACN,GAAI,KAAK,MAAQ,KAAM,CACtB,KAAK,KAAO,GAAI,OAAc,KAAK,WAAW,OAAO,EAAE,EAEvD,IAAI,KAAK,mBACR,KAAK,6BAEL,MAAK,oBAAsB,KAG7B,EAAS,KAAK,UAAU,EAAoB,QAC5C,GAAS,KAAK,UAAU,EAAoB,QAG5C,GAAM,KAAK,mBAAoB,KAAK,WAAa,KAAK,IAEtD,GAAI,CACJ,GAAQ,CACR,IAAI,GAAe,KAGf,GAAc,EAAI,MACtB,OAAO,EAAQ,EAAM,CACpB,GAAI,KAAK,mBAAoB,CAC5B,KAAK,KAAK,KAAO,EAAI,GAAS,EAAM,EACpC,MAAK,KAAK,KAAO,EAAI,EAAQ,GAAK,GAAO,EAAQ,OAC3C,CACN,EAAI,GAAS,EAAM,EACnB,GAAI,EAAQ,GAAK,GAAO,EAAQ,GAGjC,KAAM,GAAS,EACd,EAAQ,CAET,IAAS,GAIX,GAAI,KAAK,oBACR,KAAK,sBAEN,MAAK,iBAEL,MAAK,UAAY,MAMX,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,KAAK,qBAAuB,KAAK,eAAiB,MAAQ,GAAU,QAAU,KAAK,eAAiB,MAAQ,GAAU,MACzH,KAAK,wBAEN,MAAK,cAAgB,CAErB,IAAI,GAAU,MAAQ,KAAK,mBAAoB,CAC9C,EAAS,KAAK,UAAU,EAAoB,kBAC5C,GAAS,KAAK,UAAU,EAAoB,kBAE5C,GAAI,CACJ,GAAQ,CACR,GAAM,KAAK,UAEX,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAI,GAAS,EAAO,IACpB,GAAI,EAAQ,GAAK,EAAO,IACxB,IAAS,GAIX,KAAK,0BAEL,MAAK,mBAAqB,MAMpB,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,KAAK,qBAAuB,KAAK,eAAiB,MAAQ,GAAU,QAAU,KAAK,eAAiB,MAAQ,GAAU,MACzH,KAAK,wBAEN,MAAK,cAAgB,CAErB,IAAI,GAAU,KAAM,CACnB,EAAS,KAAK,UAAU,EAAoB,iBAC5C,GAAS,KAAK,UAAU,EAAoB,iBAC5C,IAAI,KAAK,qBAAsB,CAC9B,EAAI,CACJ,GAAI,CACJ,GAAQ,CACR,GAAe,KAAK,mBAAoB,KAAK,WAAa,KAAK,sBAC/D,IAAI,EACJ,IAAI,GAAkB,CACtB,IAAI,GAAa,GAAI,OAErB,KAAK,KAAK,mBACT,KAAK,uBAAyB,GAAI,OAAc,EAAO,OAExD,MAAK,sBAAwB,GAAI,MAEjC,OAAO,EAAI,EAAO,OAAQ,CACzB,IAAK,EAAI,EAAG,EAAI,KAAK,iBAAkB,IAAK,CAC3C,EAAW,EAAO,IAGlB,IAAI,EAAI,IAAa,UAAW,CAC/B,EAAI,GAAY,EAAS,CACzB,MAAK,sBAAsB,KAAc,EAE1C,EAAa,EAAQ,GAAK,EAAI,GAE/B,GAAS,EAEV,KAAK,oBAAsB,MACrB,IAAI,KAAK,mBAAoB,CAEnC,EAAI,CACJ,GAAQ,CACR,GAAe,KAAK,UAEpB,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAI,CACJ,OAAO,EAAI,KAAK,iBACf,EAAa,EAAQ,KAAO,EAAO,IACpC,IAAS,IAKZ,KAAK,0BAEL,MAAK,mBAAqB,MAMpB,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,KAAK,qBAAuB,KAAK,eAAiB,MAAQ,GAAU,QAAU,KAAK,eAAiB,MAAQ,GAAU,MACzH,KAAK,wBAEN,MAAK,cAAgB,CAErB,IAAI,GAAU,MAAQ,KAAK,mBAAoB,CAC9C,EAAS,KAAK,UAAU,EAAoB,kBAC5C,GAAS,KAAK,UAAU,EAAoB,kBAE5C,GAAI,CACJ,GAAQ,CACR,GAAe,KAAK,UAEpB,OAAO,EAAI,EAAO,OAAQ,CACzB,EAAI,CACJ,OAAO,EAAI,KAAK,iBACf,EAAa,EAAQ,KAAO,EAAO,IACpC,IAAS,GAIX,KAAK,0BAEL,MAAK,mBAAqB,MAMpB,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,MAAK,WAAa,IAClB,MAAK,eAAiB,IACtB,MAAK,gBAAkB,IACvB,MAAK,KAAO,IACZ,MAAK,cAAgB,IACrB,MAAK,cAAgB,IACrB,MAAK,cAAgB,IAErB,MAAK,aAAe,IACpB,MAAK,aAAe,IACpB,MAAK,cAAgB,KAQf,GAAA,UAAA,cAAP,SAAqB,GAEpB,EAAA,UAAM,cAAa,KAAA,KAAC,EAEpB,MAAK,kBAAoB,IAEzB,IAAI,KAAK,mBACR,KAAK,oBAAsB,IAE5B,IAAI,KAAK,oBACR,KAAK,qBAAuB,IAE7B,IAAI,KAAK,eACR,KAAK,UAAY,KAOZ,GAAA,UAAA,MAAP,WAEC,GAAI,GAA4B,GAAI,GAAoB,KAAK,mBAC7D,GAAM,cAAc,KAAK,UAAU,SACnC,GAAM,gBAAgB,KAAK,WAAW,SAEtC,IAAI,KAAK,iBAAmB,KAAK,mBAChC,EAAM,oBAAoB,KAAK,eAAe,cAE9C,GAAM,oBAAoB,KAE3B,IAAI,KAAK,OAAS,KAAK,eACtB,EAAM,UAAU,KAAK,KAAK,cAE1B,GAAM,UAAU,KAEjB,IAAI,KAAK,kBAAoB,KAAK,oBACjC,EAAM,qBAAqB,KAAK,gBAAgB,cAEhD,GAAM,qBAAqB,KAE5B,IAAI,KAAK,cACR,EAAM,mBAAmB,KAAK,cAAc,SAE7C,IAAI,KAAK,cAAe,CACvB,EAAM,gBAAkB,KAAK,gBAC7B,GAAM,mBAAmB,KAAK,cAAc,UAG7C,GAAI,KAAK,cACR,EAAM,mBAAmB,KAAK,cAAc,SAE7C,OAAO,GAGD,GAAA,UAAA,QAAP,SAAe,EAAmB,GAAnB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAAmB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAEjC,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,GAAM,KAAK,IAEX,IAAI,GAAgB,EAAO,KAAK,OAChC,IAAI,GAAgB,EAAO,KAAK,OAEhC,MAAK,QAAU,CACf,MAAK,QAAU,CAEf,IAAI,GAAa,EAAI,MAErB,GAAS,CACT,GAAS,CAET,GAAQ,CAER,OAAO,EAAQ,EAAK,CACnB,EAAI,IAAU,CACd,GAAI,EAAQ,IAAM,CAClB,IAAS,EAGV,KAAK,kBAOC,GAAA,UAAA,MAAP,SAAa,GAEZ,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,GAAY,KAAK,UAEjB,IAAI,GAAa,EAAU,MAE3B,GAAS,CACT,GAAS,CAET,GAAI,CACJ,GAAQ,CACR,OAAO,EAAI,EAAK,CACf,EAAU,IAAU,CACpB,GAAU,EAAQ,IAAM,CACxB,GAAU,EAAQ,IAAM,CAExB,IAAK,CACL,IAAS,EAGV,KAAK,wBAGC,GAAA,UAAA,oBAAP,SAA2B,GAE1B,GAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,KAAK,mBAAoB,CAC5B,EAAY,KAAK,UACjB,GAAU,KAAK,UACf,GAAW,KAAK,eACV,CACN,EAAY,KAAK,UACjB,GAAU,KAAK,cACf,GAAW,KAAK,gBAGjB,GAAI,GAAa,KAAK,WAAW,OAAO,CACxC,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAAkB,GAAI,EAE1B,IAAI,GAAsB,KAAK,gBAAkB,IACjD,IAAI,GAAuB,KAAK,iBAAmB,IACnD,IAAI,EAEJ,IAAI,GAAe,EAAc,CAChC,EAAe,EAAU,OACzB,GAAa,QACb,GAAa,YAGd,GAAI,GAAa,KAAK,UAAU,EAAoB,cACpD,IAAI,GAAa,KAAK,UAAU,EAAoB,YACpD,IAAI,GAAa,KAAK,UAAU,EAAoB,aAEpD,IAAI,GAAiB,KAAK,UAAU,EAAoB,cACxD,IAAI,GAAiB,KAAK,UAAU,EAAoB,YACxD,IAAI,GAAiB,KAAK,UAAU,EAAoB,aAExD,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAK,EAAM,CACX,GAAK,EAAM,CAGX,GAAO,EAAI,EAAU,EACrB,GAAO,EAAI,EAAU,EACrB,GAAO,EAAI,EAAU,EACrB,GAAS,EAAU,gBAAgB,EACnC,GAAU,GAAO,EAAO,CACxB,GAAU,GAAM,EAAO,CACvB,GAAU,GAAM,EAAO,CACvB,IAAO,CAGP,IAAI,EAAa,CAChB,EAAK,EAAM,CACX,GAAK,EAAM,CACX,GAAO,EAAI,EAAQ,EACnB,GAAO,EAAI,EAAQ,EACnB,GAAO,EAAI,EAAQ,EACnB,GAAS,EAAa,qBAAqB,EAC3C,GAAO,WACP,GAAQ,GAAO,EAAO,CACtB,GAAQ,GAAM,EAAO,CACrB,GAAQ,GAAM,EAAO,CACrB,IAAO,EAIR,GAAI,EAAc,CACjB,EAAK,EAAM,CACX,GAAK,EAAM,CACX,GAAO,EAAI,EAAS,EACpB,GAAO,EAAI,EAAS,EACpB,GAAO,EAAI,EAAS,EACpB,GAAS,EAAa,qBAAqB,EAC3C,GAAO,WACP,GAAS,GAAO,EAAO,CACvB,GAAS,GAAM,EAAO,CACtB,GAAS,GAAM,EAAO,CACtB,IAAO,GAIT,KAAK,uBACL,MAAK,qBACL,MAAK,uBAME,GAAA,UAAA,mBAAR,WAEC,GAAI,GAAW,CACf,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAY,EAAY,CAC5B,IAAI,GAAY,EAAY,CAC5B,IAAI,GAAW,EAAW,CAE1B,IAAI,GAA0B,KAAK,UACnC,IAAI,GAAoB,KAAK,IAE7B,IAAI,GAAa,KAAK,UAAU,MAEhC,IAAI,KAAK,eAAiB,KACzB,KAAK,cAAgB,GAAI,OAAc,EAExC,OAAO,EAAI,EAAK,CACf,EAAS,KAAK,UAAU,EACxB,GAAS,KAAK,UAAU,EAAI,EAC5B,GAAS,KAAK,UAAU,EAAI,EAE5B,GAAK,EAAI,EAAO,EAAI,EACpB,GAAM,EAAI,EAAO,EAAI,GAAK,CAC1B,GAAM,EAAI,EAAO,EAAI,GAAK,CAE1B,GAAK,EAAO,CACZ,GAAK,EAAU,EACf,GAAK,EAAU,EAAK,EACpB,GAAK,EAAU,EAAK,EACpB,GAAK,EAAO,CACZ,GAAM,EAAU,GAAM,CACtB,GAAM,EAAU,EAAK,GAAK,CAC1B,GAAM,EAAU,EAAK,GAAK,CAC1B,GAAK,EAAO,CACZ,GAAM,EAAU,GAAM,CACtB,GAAM,EAAU,EAAK,GAAK,CAC1B,GAAM,EAAU,EAAK,GAAK,CAE1B,GAAK,EAAI,EAAM,EAAI,CACnB,GAAK,EAAI,EAAM,EAAI,CACnB,GAAK,EAAI,EAAM,EAAI,CACnB,GAAQ,EAAE,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAEvC,MAAK,cAAc,KAAO,EAAM,CAChC,MAAK,cAAc,KAAO,EAAM,CAChC,MAAK,cAAc,KAAO,EAAM,EAGjC,KAAK,mBAAqB,MAMnB,GAAA,UAAA,kBAAR,WAEC,GAAI,GAAW,CACf,IAAI,GAAW,CACf,IAAI,GAAW,CACf,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAY,EAAY,CAC5B,IAAI,GAAY,EAAY,CAC5B,IAAI,GAAW,EAAW,CAC1B,IAAI,EAEJ,IAAI,GAA0B,KAAK,UAEnC,IAAI,GAAa,KAAK,UAAU,MAEhC,IAAI,KAAK,cAAgB,KACxB,KAAK,aAAe,GAAI,OAAc,EAEvC,IAAI,KAAK,iBAAmB,KAAK,cAAgB,KAChD,KAAK,aAAe,GAAI,OAAc,EAAI,EAE3C,OAAO,EAAI,EAAK,CACf,EAAQ,KAAK,UAAU,KAAK,CAC5B,GAAK,EAAU,EACf,GAAK,EAAU,EAAQ,EACvB,GAAK,EAAU,EAAQ,EACvB,GAAQ,KAAK,UAAU,KAAK,CAC5B,GAAK,EAAU,EACf,GAAK,EAAU,EAAQ,EACvB,GAAK,EAAU,EAAQ,EACvB,GAAQ,KAAK,UAAU,KAAK,CAC5B,GAAK,EAAU,EACf,GAAK,EAAU,EAAQ,EACvB,GAAK,EAAU,EAAQ,EACvB,GAAM,EAAK,CACX,GAAM,EAAK,CACX,GAAM,EAAK,CACX,GAAM,EAAK,CACX,GAAM,EAAK,CACX,GAAM,EAAK,CACX,GAAK,EAAI,EAAM,EAAI,CACnB,GAAK,EAAI,EAAM,EAAI,CACnB,GAAK,EAAI,EAAM,EAAI,CACnB,GAAI,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAGjC,IAAI,KAAK,gBAAiB,CACzB,GAAI,GAAW,EAAE,GAEjB,IAAI,EAAI,EACP,EAAI,CAEL,MAAK,aAAa,KAAO,EAG1B,EAAI,EAAE,CAEN,MAAK,aAAa,KAAO,EAAG,CAC5B,MAAK,aAAa,KAAO,EAAG,CAC5B,MAAK,aAAa,KAAO,EAAG,EAG7B,KAAK,kBAAoB,MAGnB,GAAA,UAAA,uBAAP,WAEC,KAAK,oBAAsB,IAE3B,MAAK,uBACL,MAAK,qBACL,MAAK,sBACL,MAAK,iBACL,MAAK,0BACL,MAAK,0BACL,MAAK,2BAGE,GAAA,UAAA,sBAAR,WAEC,GAAI,KAAK,gBACR,MAED,MAAK,gBAAkB,IAEvB,KAAK,KAAK,kBACT,KAAK,kBAAoB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,cAEtG,MAAK,cAAc,KAAK,mBAGjB,GAAA,UAAA,oBAAR,WAEC,GAAI,KAAK,oBACR,MAED,MAAK,oBAAsB,IAE3B,KAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,YAEpG,MAAK,cAAc,KAAK,iBAGjB,GAAA,UAAA,qBAAR,WAEC,GAAI,KAAK,qBACR,MAED,MAAK,qBAAuB,IAE5B,KAAK,KAAK,iBACT,KAAK,iBAAmB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,aAErG,MAAK,cAAc,KAAK,kBAGjB,GAAA,UAAA,gBAAR,WAEC,GAAI,KAAK,UACR,MAED,MAAK,UAAY,IAEjB,KAAK,KAAK,YACT,KAAK,YAAc,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,QAEhG,MAAK,cAAc,KAAK,aAGjB,GAAA,UAAA,yBAAR,WAEC,GAAI,KAAK,mBACR,MAED,MAAK,mBAAqB,IAE1B,KAAK,KAAK,qBACT,KAAK,qBAAuB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,kBAEzG,MAAK,cAAc,KAAK,sBAGjB,GAAA,UAAA,yBAAR,WAEC,GAAI,KAAK,mBACR,MAED,MAAK,mBAAqB,IAE1B,KAAK,KAAK,qBACT,KAAK,qBAAuB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,iBAEzG,MAAK,cAAc,KAAK,sBAGjB,GAAA,UAAA,yBAAR,WAEC,GAAI,KAAK,mBACR,MAED,MAAK,mBAAqB,IAE1B,KAAK,KAAK,qBACT,KAAK,qBAAuB,GAAI,GAAiB,EAAiB,iBAAkB,EAAoB,kBAEzG,MAAK,cAAc,KAAK,sBA95CX,GAAA,cAAuB,WACvB,GAAA,YAAqB,eACrB,GAAA,aAAsB,gBACtB,GAAA,QAAiB,KACjB,GAAA,kBAA2B,cAC3B,GAAA,iBAA0B,cAC1B,GAAA,kBAA2B,cAG3B,GAAA,gBAAyB,QACzB,GAAA,cAAuB,QACvB,GAAA,eAAwB,QACxB,GAAA,UAAmB,QACnB,GAAA,oBAA6B,QAm5C5C,OAAA,IAl6CkC,EAo6CL,GAAA,QAApB,sWC96CT,IAAO,GAAS,EAAc,oCAE9B,IAAO,GAAW,EAAc,0CAgB1B,GAAe,SAAA,GAAS,EAAxB,EAAe,EA0BpB,SA1BK,GA0BO,EAAiC,EAAiB,GAAA,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAE7D,EAAA,KAAA,KAEA,MAAK,aAAe,CACpB,MAAK,aAAe,CACpB,MAAK,SAAW,EAzBjB,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,sDAMlB,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAqBN,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,MAGP,GAAA,UAAA,oBAAP,SAA2B,GAE1B,EAAS,qBAAqB,MAEhC,OAAA,IA/C8B,EAiDL,GAAA,QAAhB,yQClET,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAa,EAAc,uCAClC,IAAO,GAAK,EAAgB,+BAC5B,IAAO,GAAU,EAAe,oCAEhC,IAAO,GAAa,EAAc,4CAyB5B,GAAsB,SAAA,GAAS,EAA/B,EAAsB,EAmF3B,SAnFK,KAqFJ,EAAA,KAAA,KAnFO,MAAA,eAAyB,IACzB,MAAA,UAAiC,GAAI,OAM7C,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,8CAwBlB,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,MAAK,eAAiB,CAEtB,MAAK,6BAA6B,KAAK,SAAU,KAAK,SAAS,cAAgB,0CAMhF,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,UAAU,2CA+DhB,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAAS,KACZ,KAAM,IAAI,GAAM,kCAGjB,IAAI,EAAM,SACT,EAAM,SAAS,oBAAoB,EAEpC,GAAM,WAAW,KAEjB,MAAK,UAAU,KAAK,EAEpB,OAAO,GAiCD,GAAA,UAAA,WAAP,SAAkB,EAAqB,GAEtC,MAAO,GAGD,GAAA,UAAA,YAAP,WAAmB,GAAA,UAAA,GAAA,GAAA,EAAA,EAAA,UAAA,OAAA,IAAkC,CAAlC,EAAA,EAAA,GAAA,UAAA,GAElB,GAAI,GAAa,EAAW,MAC5B,KAAK,GAAI,GAAW,EAAG,EAAK,EAAK,IAChC,KAAK,SAAS,EAAW,IAMpB,GAAA,UAAA,MAAP,WAEC,GAAI,GAA+B,GAAI,EACvC,GAAM,MAAQ,KAAK,KACnB,GAAM,WAAa,KAAK,UACxB,GAAM,UAAY,KAAK,SACvB,GAAM,KAAO,IAEb,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,EAAM,SAAS,KAAK,UAAU,GAAG,QAGlC,OAAO,GAeD,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,MAAK,UAAU,QAAQ,IAAU,EAMlC,GAAA,UAAA,oBAAP,WAEC,KAAK,SAEL,OAAO,KAAK,YAAc,EACzB,KAAK,WAAW,GAAG,UAYd,GAAA,UAAA,WAAP,SAAkB,GAEjB,GAAI,GAAsB,KAAK,UAAU,EAEzC,IAAI,GAAS,KACZ,KAAM,IAAI,GAAW,uDAEtB,OAAO,GAiBD,GAAA,UAAA,eAAP,SAAsB,GAErB,GAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,GAAI,KAAK,UAAU,GAAG,MAAQ,EAC7B,MAAO,MAAK,UAAU,EAExB,OAAO,MAWD,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,GAAoB,KAAK,UAAU,QAAQ,EAE/C,IAAI,IAAe,EAClB,KAAM,IAAI,GAAc,+CAEzB,OAAO,GAsBD,GAAA,UAAA,qBAAP,SAA4B,GAE3B,MAAO,IAAI,OAsBL,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,GAAS,KACZ,KAAM,IAAI,GAAM,iCAEjB,MAAK,oBAAoB,EAEzB,GAAM,WAAW,KAEjB,OAAO,GAyBD,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAO,MAAK,YAAY,KAAK,UAAU,IAmBjC,GAAA,UAAA,eAAP,SAAsB,EAA+B,GAA/B,GAAA,QAAA,GAA6B,CAA7B,EAAA,EAA+B,GAAA,QAAA,GAAoC,CAApC,EAAA,WAEpD,GAAI,EAAa,EAChB,KAAM,IAAI,GAAW,+CAEtB,IAAI,EAAW,KAAK,UAAU,OAC7B,KAAM,IAAI,GAAW,6CAEtB,KAAI,GAAI,GAAoB,EAAY,EAAI,EAAU,IACrD,KAAK,YAAY,KAAK,UAAU,IA+B3B,GAAA,UAAA,cAAP,SAAqB,EAAqB,IAenC,GAAA,UAAA,aAAP,SAAoB,EAAsB,IAcnC,GAAA,UAAA,eAAP,SAAsB,EAAuB,IAQtC,GAAA,UAAA,0BAAP,WAEC,EAAA,UAAM,0BAAyB,KAAA,KAE/B,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,UAAU,GAAG,4BAMb,GAAA,UAAA,cAAP,SAAqB,GAEpB,EAAA,UAAM,cAAa,KAAA,KAAC,EAEpB,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,UAAU,GAAG,cAAc,GAM3B,GAAA,UAAA,6BAAP,SAAoC,GAEnC,EAAA,UAAM,6BAA4B,KAAA,KAAC,EAEnC,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,UAAU,GAAG,6BAA6B,KAAK,gBAM/C,GAAA,UAAA,2BAAP,SAAkC,GAEjC,EAAA,UAAM,2BAA0B,KAAA,KAAC,EAEjC,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,UAAU,GAAG,2BAA2B,KAAK,sBAM7C,GAAA,UAAA,0BAAP,SAAiC,GAEhC,EAAA,UAAM,0BAAyB,KAAA,KAAC,EAEhC,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,UAAU,GAAG,0BAA0B,KAAK,qBAQ3C,GAAA,UAAA,oBAAR,SAA4B,GAE3B,KAAK,UAAU,OAAO,KAAK,cAAc,GAAQ,EAEjD,OAAO,GAET,OAAA,IA/gBqC,EAihBL,GAAA,QAAvB,iYCjjBT,IAAO,GAAe,EAAc,yCAGpC,IAAO,GAAsB,EAAY,uDACzC,IAAO,GAAU,EAAe,uCAChC,IAAO,GAAQ,EAAgB,wCAC/B,IAAO,GAAS,EAAe,yCAG/B,IAAM,GAAK,SAAA,GAAS,EAAd,EAAK,EAQV,SARK,KAUJ,EAAA,KAAA,KARO,MAAA,oBAAuC,GAAI,MAC3C,MAAA,YAA+B,GAAI,MAGpC,MAAA,iBAAmB,CAMzB,MAAK,iBAAmB,GAAI,EAE5B,MAAK,iBAAiB,WAAW,KACjC,MAAK,iBAAiB,SAAW,IACjC,MAAK,iBAAiB,UAAY,GAAI,GAAU,GAAI,IAG9C,EAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,GAAW,CACf,IAAI,GAAa,KAAK,YAAY,MAElC,GAAU,MAAQ,IAElB,OAAO,EAAI,EAAK,CACf,KAAK,kBACL,MAAK,YAAY,KAAK,SAAS,IAIjC,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,iBAAiB,eAG9B,SAAqB,GAEpB,KAAK,iBAAiB,UAAY,CAElC,MAAK,cAAc,GAAI,GAAW,EAAW,kBAAmB,KAAK,uDAG/D,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,MAAK,iBAAiB,SAAS,GAGhC,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,MAAK,iBAAiB,SAAS,GAGhC,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,iBAAiB,YAAY,GAG5B,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,iBAAiB,cAAc,GAI9B,GAAA,UAAA,WAAP,SAAkB,GAEjB,MAAO,MAAK,iBAAiB,WAAW,GAGzC,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iBAAiB,gDAMvB,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EAAc,UACjB,KAAK,mBAAmB,EAAc,UAEvC,IAAI,EAAc,SACjB,EAAc,oBAAoB,eAAe,GAM5C,GAAA,UAAA,mBAAP,SAA0B,GAEzB,KAAK,oBAAoB,KAAK,EAG9B,IAAI,KAAK,YAAY,QAAQ,KAAe,EAC3C,KAAK,YAAY,KAAK,GAMjB,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,EAAc,UACjB,KAAK,qBAAqB,EAAc,UAEzC,IAAI,EAAc,SACjB,EAAc,oBAAoB,cAAc,GAM3C,GAAA,UAAA,qBAAP,SAA4B,GAE3B,KAAK,oBAAoB,OAAO,KAAK,oBAAoB,QAAQ,GAAY,EAG7E,IAAI,KAAK,oBAAoB,QAAQ,KAAe,EACnD,KAAK,YAAY,OAAO,KAAK,YAAY,QAAQ,GAAY,GAEhE,OAAA,IA1HoB,EA4HL,GAAA,QAAN,kQCjIT,GAAO,GAAQ,EAAgB,iCAE/B,IAAO,GAAK,EAAgB,sCAG5B,IAAO,GAAa,EAAc,wCAIlC,IAAO,GAAM,EAAgB,qCAC7B,IAAO,GAAW,EAAe,wCACjC,IAAO,GAAU,EAAe,uCAChC,IAAO,GAAa,EAAc,0CAClC,IAAO,GAAY,EAAe,2CAElC,IAAM,GAAI,WA0DT,QA1DK,GA0DO,EAAoB,EAAoB,GA1DrD,GAAA,GAAA,IA0DiC,IAAA,QAAA,GAAkB,CAAlB,EAAA,KAAoB,GAAA,QAAA,GAAoB,CAApB,EAAA,KAjC5C,KAAA,OAAgB,CAChB,MAAA,QAAiB,CAEjB,MAAA,MAAe,CACf,MAAA,WAAoB,CACpB,MAAA,iBAA0B,CAC1B,MAAA,iBAA0B,CAE1B,MAAA,eAAyB,IACzB,MAAA,cAAwB,IAOxB,MAAA,aAAuB,GAAI,EAmBlC,MAAK,iCAAmC,SAAC,GAAqB,MAAA,GAAK,wBAAwB,GAC3F,MAAK,6BAA+B,SAAC,GAAsB,MAAA,GAAK,oBAAoB,GACpF,MAAK,2BAA6B,SAAC,GAAwB,MAAA,GAAK,kBAAkB,GAClF,MAAK,0BAA4B,SAAC,GAAwB,MAAA,GAAK,iBAAiB,GAEhF,MAAK,MAAQ,GAAS,GAAI,EAC1B,MAAK,OAAS,GAAU,GAAI,EAC5B,MAAK,SAAW,CAGhB,UAAS,KAAK,MAAM,OAAS,KAE7B,MAAK,aAAe,SAAS,cAAc,MAC3C,MAAK,aAAa,MAAM,SAAW,UAEnC,UAAS,KAAK,YAAY,KAAK,aAE/B,MAAK,cAAgB,EAAa,aAClC,MAAK,cAAc,aAAa,MAUzB,EAAA,UAAA,wBAAR,SAAgC,GAE/B,GAAI,KAAK,SACR,KAAK,SAAS,UAAY,KAAK,MAAM,UAKvC,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAGb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAKb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,gBAGb,SAAoB,GAEnB,GAAI,KAAK,YAAc,EACtB,MAED,IAAI,KAAK,WAAY,CACpB,KAAK,WAAW,SAChB,MAAK,WAAW,oBAAoB,EAAc,iBAAkB,KAAK,2BACzE,MAAK,WAAW,oBAAoB,EAAc,gBAAiB,KAAK,2BAGzE,KAAK,WAAa,CAElB,MAAK,WAAW,iBAAiB,EAAc,iBAAkB,KAAK,2BACtE,MAAK,WAAW,iBAAiB,EAAc,gBAAiB,KAAK,0BAGrE,MAAK,kBAAoB,KAAK,WAAW,yBAEzC,IAAI,KAAK,SACR,KAAK,kBAAkB,OAAS,KAAK,QAGtC,MAAK,WAAW,eAAkB,KAAK,kBAAoB,GAAM,KAAM,GACvE,MAAK,WAAW,eAAkB,KAAK,kBAAoB,EAAK,KAAM,GACtE,MAAK,WAAW,eAAiB,KAAK,iBAAmB,KAAM,GAC/D,MAAK,WAAW,kBAAoB,KAAK,gBACzC,MAAK,WAAW,MAAQ,KAAK,MAC7B,MAAK,WAAW,OAAS,KAAK,OAC9B,MAAK,WAAW,aAAe,KAAK,kDAMrC,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,IAAI,KAAK,WACR,KAAK,WAAW,aAAe,KAAK,kDAMtC,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,sBAGb,SAA2B,GAE1B,GAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,iBAAmB,CAExB,MAAK,WAAW,eAAkB,GAAS,GAAM,KAAM,GACvD,MAAK,WAAW,eAAkB,GAAS,EAAK,KAAM,GACtD,MAAK,WAAW,eAAiB,EAAQ,KAAM,wCAOhD,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,sBAOb,SAA2B,GAE1B,GAAI,EAAQ,EACX,EAAQ,MACJ,IAAI,EAAQ,EAChB,EAAQ,CAET,IAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,WAAW,kBAAoB,KAAK,iBAAmB,sCAO7D,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAMb,SAAkB,GAEjB,GAAI,KAAK,UAAY,EACpB,MAED,IAAI,KAAK,SACR,KAAK,SAAS,oBAAoB,EAAY,mBAAoB,KAAK,6BAExE,MAAK,SAAW,CAEhB,IAAI,KAAK,kBACR,KAAK,kBAAkB,OAAS,KAAK,QAEtC,IAAI,KAAK,QACR,KAAK,SAAS,UAAY,KAAK,QAAQ,SAExC,MAAK,SAAS,iBAAiB,EAAY,mBAAoB,KAAK,6BACpE,MAAK,cAAgB,IACrB,MAAK,eAAiB,yCAOvB,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,aAMb,SAAiB,GAEhB,GAAI,KAAK,SAAW,EACnB,MAED,IAAI,KAAK,QACR,KAAK,QAAQ,oBAAoB,EAAW,kBAAmB,KAAK,iCAErE,MAAK,QAAU,CAEf,MAAK,QAAQ,iBAAiB,EAAW,kBAAmB,KAAK,iCAEjE,IAAI,KAAK,SACR,KAAK,SAAS,UAAY,KAAK,QAAQ,8CAOzC,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CACd,MAAK,aAAe,KAAK,OAAO,KAAK,OACrC,MAAK,SAAS,WAAW,cAAgB,KAAK,YAC9C,MAAK,WAAW,MAAQ,CACxB,MAAK,aAAa,MAAM,MAAQ,EAAQ,yCAMzC,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,QAAU,CACf,MAAK,aAAe,KAAK,OAAO,KAAK,OACrC,MAAK,SAAS,WAAW,cAAgB,KAAK,YAC9C,MAAK,WAAW,OAAS,CACzB,MAAK,aAAa,MAAM,OAAS,EAAQ,yCAM1C,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,GAAI,KAAK,cAAgB,EACxB,MAED,IAAI,GAAS,KACZ,KAAK,aAAe,GAAI,OAExB,MAAK,aAAe,sCAMtB,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,WAAW,OAGxB,SAAa,GAEZ,GAAI,KAAK,WAAW,GAAK,EACxB,MAED,MAAK,WAAW,GAAK,CACrB,MAAK,aAAa,MAAM,KAAO,EAAQ,yCAMxC,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,WAAW,OAGxB,SAAa,GAEZ,GAAI,KAAK,WAAW,GAAK,EACxB,MAED,MAAK,WAAW,GAAK,CACrB,MAAK,aAAa,MAAM,IAAM,EAAQ,yCAMvC,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAQ,MAAK,aAAa,MAAM,YAAc,eAG/C,SAAmB,GAElB,KAAK,aAAa,MAAM,WAAa,EAAO,UAAY,6CAQzD,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,uCAOD,GAAA,UAAA,OAAP,WAEC,KAAK,aAGL,MAAK,SAAS,WAAW,cAAgB,KAAK,YAE9C,IAAI,KAAK,cAAe,CACvB,KAAK,cAAgB,KACrB,MAAK,SAAS,WAAW,oBAAoB,KAAK,WAAW,YAAY,EAAG,KAAK,WAAW,YAAY,EAAG,KAAK,WAAW,YAAY,MAAO,KAAK,WAAW,YAAY,QAG3K,GAAI,KAAK,eAAgB,CACxB,KAAK,eAAiB,KACtB,MAAK,SAAS,WAAW,iBAAiB,KAAK,WAAW,SAAS,EAAG,KAAK,WAAW,SAAS,EAAG,KAAK,WAAW,SAAS,MAAO,KAAK,WAAW,SAAS,QAI5J,IAAK,KAAK,cAAe,CACxB,GAAI,KAAK,gBAAkB,KAAK,cAAgB,KAAK,cAAc,cAAgB,KAAK,cAAc,cACrG,KAAK,cAAc,kBAAoB,KAAK,YAAY,iBAAiB,KAAK,SAAU,KAAK,SAAU,KAExG,MAAK,cAAc,gBAAgB,KAAK,gBAMzC,KAAK,kBAAkB,OAGvB,MAAK,QAAQ,mBAAmB,KAAK,kBAGrC,MAAK,WAAW,OAAO,KAAK,mBAMtB,GAAA,UAAA,YAAP,WAEC,GAAI,GAAc,GAElB,IAAI,KAAK,OAAS,EACjB,KAAK,MAAQ,CAEd,MAAK,WAAa,EAAO,KAAK,KAC9B,MAAK,MAAQ,EAMP,GAAA,UAAA,QAAP,WAEC,KAAK,WAAW,SAGhB,MAAK,cAAc,eAAe,KAKlC,MAAK,cAAgB,IAGrB,MAAK,WAAa,IAClB,MAAK,kBAAoB,KAM1B,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,sDAML,GAAA,UAAA,oBAAR,SAA4B,GAE3B,KAAK,cAAgB,IACrB,MAAK,eAAiB,KAMf,GAAA,UAAA,kBAAR,SAA0B,GAEzB,KAAK,eAAiB,KAMf,GAAA,UAAA,iBAAR,SAAyB,GAExB,KAAK,cAAgB,KAGf,GAAA,UAAA,QAAP,SAAe,GAEd,GAAI,GAAa,KAAK,SAAS,QAAQ,EACvC,GAAE,EAAI,EAAE,EAAE,KAAK,WAAW,SAAS,MAAM,EAAI,KAAK,OAAO,KAAK,SAAS,WAAW,OAClF,GAAE,EAAI,EAAE,EAAE,KAAK,WAAW,SAAS,OAAO,EAAI,KAAK,QAAQ,KAAK,SAAS,WAAW,OAEpF,OAAO,GAGD,GAAA,UAAA,UAAP,SAAiB,EAAW,EAAW,GAEtC,MAAO,MAAK,SAAS,UAAU,GAAG,EAAK,KAAK,OAAO,KAAK,SAAS,WAAW,SAAS,KAAK,WAAW,SAAS,MAAO,GAAG,EAAK,KAAK,QAAQ,KAAK,SAAS,WAAW,SAAS,KAAK,WAAW,SAAS,OAAQ,GAIvM,GAAA,UAAA,OAAP,SAAc,EAAW,EAAW,GAEnC,MAAO,MAAK,SAAS,QAAQ,EAAG,EAAI,KAAK,QAAQ,KAAK,QAAS,EAAG,EAAI,KAAK,SAAS,KAAK,QAAS,GAiC5F,GAAA,UAAA,eAAP,WAEC,IAAK,KAAK,cAAe,CACxB,GAAI,KAAK,cAAgB,KAAK,cAAc,YAC3C,KAAK,cAAc,kBAAoB,KAAK,YAAY,iBAAiB,KAAK,SAAU,KAAK,SAAU,UAClG,CACN,GAAI,GAAqC,KAAK,YAAY,iBAAiB,KAAK,SAAU,KAAK,SAAU,KAEzG,IAAI,KAAK,aAAe,KAAK,cAAc,mBAAqB,MAAQ,EAAgB,iBAAmB,KAAK,cAAc,kBAAkB,iBAC/I,KAAK,cAAc,kBAAoB,GAG3C,OAAA,KAEc,GAAA,QAAL;0ECllBT,IAAO,GAAU,EAAc,oCAC/B,IAAO,GAAQ,EAAe,gCAC9B,IAAO,GAAO,EAAe,+BAE7B,IAAO,GAAS,EAAc,oCAC9B,IAAO,GAAe,EAAa,yCAEnC,IAAO,GAAqB,EAAW,oDAEvC,IAAO,GAAsB,EAAW,uDAExC,IAAO,GAAW,EAAc,wCAChC,IAAO,GAAU,EAAc,0CAK/B,IAAM,GAAM,SAAA,GAAS,EAAf,EAAM,EASX,SATK,GASO,GATb,GAAA,GAAA,IASa,IAAA,QAAA,GAA6B,CAA7B,EAAA,KAEX,EAAA,KAAA,KATO,MAAA,gBAA2B,GAAI,EAC/B,MAAA,qBAA+B,IAG/B,MAAA,oBAA8B,IAOrC,MAAK,WAAa,IAElB,MAAK,mCAAqC,SAAC,GAA0B,MAAA,GAAK,0BAA0B,GAEpG,MAAK,YAAc,GAAc,GAAI,EACrC,MAAK,YAAY,iBAAiB,EAAgB,eAAgB,KAAK,mCAEvE,MAAK,iBAEL,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAC/B,KAAK,eAAe,GAAK,GAAI,EAE9B,MAAK,GAAK,IAIJ,EAAA,UAAA,6BAAP,WAEC,MAAO,IAAI,GAML,GAAA,UAAA,2BAAP,WAEC,MAAO,IAAI,GAAW,MAIvB,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,2CAGV,GAAA,UAAA,0BAAR,SAAkC,GAEjC,KAAK,qBAAuB,IAC5B,MAAK,oBAAsB,IAC3B,MAAK,cAAc,GAGpB,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,GAAI,KAAK,oBACR,KAAK,eAEN,OAAO,MAAK,mDAGL,GAAA,UAAA,cAAR,WAEC,GAAI,GAAU,EAAU,KAEpB,GAAY,EAAY,EAAY,CACxC,IAAI,GAAY,EAAY,EAAY,CACxC,IAAI,GAAY,EAAY,EAAY,CACxC,IAAI,GAAY,EAAY,EAAY,CACxC,IAAI,EACJ,IAAI,GAAe,GAAI,OAAc,GAErC,IAAI,EACJ,MAAK,eAAe,cAAc,EAElC,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,GACV,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,GACV,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,GACV,GAAM,EAAI,GACV,GAAM,EAAI,EACV,GAAM,EAAI,EACV,GAAM,EAAI,GACV,GAAM,EAAI,GAGV,GAAI,KAAK,eAAe,EACxB,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,IAAM,EAAM,GAAK,CAGnB,GAAI,KAAK,eAAe,EACxB,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,GAAK,EAAM,GAAK,CAGlB,GAAI,KAAK,eAAe,EACxB,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,IAAM,EAAM,GAAK,CAGnB,GAAI,KAAK,eAAe,EACxB,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,GAAK,EAAM,GAAK,CAGlB,GAAI,KAAK,eAAe,EACxB,GAAI,CACJ,GAAI,CACJ,GAAI,CACJ,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,GAAK,EAAI,CAGX,GAAI,KAAK,eAAe,EACxB,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAI,EAAM,CACV,GAAS,EAAE,KAAK,KAAK,EAAE,EAAI,EAAE,EAAI,EAAE,EACnC,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,EAAI,EAAE,CACR,GAAE,GAAK,EAAM,GAAK,CAElB,MAAK,oBAAsB,MAOrB,GAAA,UAAA,0BAAP,WAEC,EAAA,UAAM,0BAAyB,KAAA,KAE/B,MAAK,qBAAuB,IAC5B,MAAK,oBAAsB,KAMrB,GAAA,UAAA,cAAP,WAEC,KAAK,gBAAkB,KACvB,MAAK,SAAS,UAMf,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,GAAI,KAAK,aAAe,EACvB,MAED,KAAK,EACJ,KAAM,IAAI,OAAM,6BAEjB,MAAK,YAAY,oBAAoB,EAAgB,eAAgB,KAAK,mCAC1E,MAAK,YAAc,CACnB,MAAK,YAAY,iBAAiB,EAAgB,eAAgB,KAAK,mCACvE,MAAK,cAAc,GAAI,GAAY,EAAY,mBAAoB,2CAMpE,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,GAAI,KAAK,qBAAsB,CAC9B,KAAK,gBAAgB,SAAS,KAAK,sBACnC,MAAK,gBAAgB,OAAO,KAAK,YAAY,OAC7C,MAAK,qBAAuB,MAG7B,MAAO,MAAK,oDAWN,GAAA,UAAA,OAAP,SAAc,EAAW,EAAW,GAEnC,MAAO,MAAK,eAAe,qBAAqB,KAAK,YAAY,UAAU,EAAI,EAAI,IAS7E,GAAA,UAAA,QAAP,SAAe,GAEd,MAAO,MAAK,YAAY,QAAQ,KAAK,sBAAsB,gBAAgB,IAWrE,GAAA,UAAA,UAAP,SAAiB,EAAW,EAAW,GAEtC,MAAO,MAAK,eAAe,gBAAgB,KAAK,YAAY,UAAU,EAAI,EAAI,IAGxE,GAAA,UAAA,qBAAP,SAA4B,GAK3B,GAAI,KAAK,eACR,KAAK,eAAe,YAErB,MAAK,oBAAoB,GAGnB,GAAA,UAAA,oBAAP,SAA2B,IAI5B,OAAA,IAhRqB,EAkRrB,GAAgB,QAAP,qkBCnST,IAAO,GAAU,EAAe,oCAChC,IAAO,GAAQ,EAAgB,gCAC/B,IAAO,GAAQ,EAAgB,gCAE/B,IAAO,GAAS,EAAe,oCAC/B,IAAO,GAAoB,EAAa,oDAKxC,IAAO,GAAuB,EAAY,qEAE1C,IAAM,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAOrB,SAPK,GAOO,EAAiB,EAAkB,GAAnC,GAAA,QAAA,GAAe,CAAf,EAAA,EAAiB,GAAA,QAAA,GAAgB,CAAhB,GAAe,EAAG,GAAA,QAAA,GAAe,CAAf,EAAA,EAE9C,EAAA,KAAA,KAEA,MAAK,WAAa,IAElB,MAAK,UAAY,GAAI,GAAS,EAAM,EAAM,EAE1C,MAAK,gBAAkB,GAAI,GAG5B,OAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,GAAI,KAAK,sBACR,KAAK,uBAEN,OAAO,MAAK,oDAGb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAElB,KAAK,KAAK,WACT,KAAK,WAAa,GAAI,EAEvB,MAAK,WAAW,EAAI,KAAK,EAAI,KAAK,WAAW,CAC7C,MAAK,WAAW,EAAI,KAAK,EAAI,KAAK,WAAW,CAC7C,MAAK,WAAW,EAAI,KAAK,EAAI,KAAK,WAAW,CAE7C,MAAK,OAAO,KAAK,gDAOX,GAAA,UAAA,6BAAP,WAGC,MAAO,IAAI,GAML,GAAA,UAAA,cAAP,YAKO,GAAA,UAAA,sBAAP,WAEC,EAAA,UAAM,sBAAqB,KAAA,KAC3B,MAAK,eAAe,aAAa,EAAG,KAAK,gBACzC,MAAK,gBAAgB,YAIf,GAAA,UAAA,oBAAP,WAEC,MAAO,IAAI,GAML,GAAA,UAAA,2BAAP,WAEC,MAAO,IAAI,GAAqB,MAI1B,GAAA,UAAA,2BAAP,SAAkC,EAAgB,EAAe,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEhE,GAAI,GAAoB,GAAI,MAC5B,IAAI,GAA4B,EAAO,MACvC,IAAI,GAAa,GAAI,EAErB,GAAE,SAAS,EAAO,wBAAwB,GAC1C,GAAE,OAAO,KAAK,sBAEd,KAAK,KAAK,gBACT,KAAK,kBAEN,GAAE,iBAAiB,EAAO,WAAY,KAAK,gBAE3C,IAAI,GAAc,SAAU,GAAe,QAC3C,IAAI,GAAc,SAAU,GAAe,QAC3C,IAAI,GAAc,SAAU,GAAe,QAC3C,IAAI,EACJ,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,CAC/B,EAAI,KAAK,gBAAgB,IAEzB,IAAI,EAAI,EACP,EAAO,CAER,IAAI,EAAI,EACP,EAAO,CAER,GAAI,KAAK,gBAAgB,IAEzB,IAAI,EAAI,EACP,EAAO,CAER,IAAI,EAAI,EACP,EAAO,CAER,GAAI,KAAK,gBAAgB,IAEzB,IAAI,EAAI,EACP,EAAO,CAER,IAAI,EAAI,EACP,EAAO,EAGT,GAAI,GAAmB,GAAG,EAAO,EACjC,IAAI,GAAmB,GAAG,EAAO,EACjC,IAAI,GAAmB,GAAG,EAAO,EACjC,GAAI,GAAK,EAAE,CACX,GAAI,GAAK,EAAE,CACX,GAAI,IAAM,CACV,GAAI,MAAQ,EAAO,GAAM,CACzB,GAAI,MAAQ,EAAO,GAAM,CACzB,GAAI,KAAO,EAAK,CAChB,GAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,IAAM,CAClF,GAAI,IAAM,CAEV,KAAK,EACJ,EAAS,GAAI,EAEd,GAAO,gBAAgB,EACvB,GAAO,QAAQ,EAEf,OAAO,GAGD,GAAA,UAAA,qBAAP,SAA4B,IAI7B,OAAA,IA1J+B,EA4J/B,GAA0B,QAAjB,6cCxKT,IAAO,GAAU,EAAe,oCAGhC,IAAO,GAAK,EAAgB,+BAE5B,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAc,EAAc,8CAMnC,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAKf,SALK,GAKO,EAA4B,GAAA,GAAA,QAAA,GAAkC,CAAlC,EAAA,KAEvC,EAAA,KAAA,KAEA,MAAK,WAAa,IAElB,MAAK,YAAc,CACnB,MAAK,aAAe,EAGrB,OAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,KAAK,YAAc,sCAGpB,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,KAAK,aAAe,sCAMd,GAAA,UAAA,2BAAP,WAEC,MAAO,IAAI,GAAe,MAIpB,GAAA,UAAA,cAAP,WAEC,KAAK,gBAAkB,MAIjB,GAAA,UAAA,6BAAP,WAEC,MAAO,IAAI,GAIL,GAAA,UAAA,2BAAP,SAAkC,EAAgB,EAAe,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEhE,KAAM,IAAI,GAAM,wEAGV,GAAA,UAAA,qBAAP,SAA4B,IAI7B,OAAA,IAjEyB,EAmEzB,GAAoB,QAAX,0VChFT,IAAO,GAAS,EAAe,oCAI/B,IAAO,GAAQ,EAAgB,mCAK/B,IAAO,GAAsB,EAAY,uDACzC,IAAO,GAAU,EAAe,0CAEhC,IAAO,GAAa,EAAc,8CAS5B,GAAI,SAAA,GAAS,EAAb,EAAI,EA2LT,SA3LK,GA2LO,EAAmB,GA3LhC,GAAA,GAAA,IA2LgC,IAAA,QAAA,GAA4B,CAA5B,EAAA,KAE9B,EAAA,KAAA,KArLO,MAAA,cAAwB,IACxB,MAAA,wBAAkC,IAsLzC,MAAK,WAAa,IAElB,MAAK,WAAa,GAAI,MAEtB,MAAK,iCAAmC,SAAC,GAAwB,MAAA,GAAK,wBAAwB,GAC9F,MAAK,4BAA8B,SAAC,GAAwB,MAAA,GAAK,mBAAmB,GACpF,MAAK,8BAAgC,SAAC,GAAwB,MAAA,GAAK,qBAAqB,GAGxF,MAAK,SAAW,GAAY,GAAI,EAEhC,MAAK,SAAW,EAxLjB,OAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,KAAK,UACR,KAAK,UAAU,YAAY,KAE5B,MAAK,UAAY,CAEjB,IAAI,GAAa,KAAK,WAAW,MACjC,IAAI,EAEJ,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAU,KAAK,WAAW,EAG1B,IAAI,EAAQ,SAAU,CACrB,EAAQ,SAAS,aAAa,EAC9B,GAAQ,SAAS,UAAU,GAI5B,EAAQ,iCAGT,GAAI,KAAK,UACR,KAAK,UAAU,SAAS,0CAM1B,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,yCAMlB,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,sCAMtB,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,GAAI,KAAK,eACR,KAAK,eAAe,YAErB,OAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,EAEJ,IAAI,KAAK,UAAW,CACnB,KAAK,UAAU,oBAAoB,EAAc,eAAgB,KAAK,iCACtE,MAAK,UAAU,oBAAoB,EAAc,mBAAoB,KAAK,4BAC1E,MAAK,UAAU,oBAAoB,EAAc,qBAAsB,KAAK,8BAE5E,KAAK,EAAI,EAAG,EAAI,KAAK,WAAW,SAAU,EACzC,KAAK,WAAW,GAAG,SAEpB,MAAK,WAAW,OAAS,EAG1B,KAAK,UAAY,CAEjB,IAAI,KAAK,UAAW,CAEnB,KAAK,UAAU,iBAAiB,EAAc,eAAgB,KAAK,iCACnE,MAAK,UAAU,iBAAiB,EAAc,mBAAoB,KAAK,4BACvE,MAAK,UAAU,iBAAiB,EAAc,qBAAsB,KAAK,8BAEzE,IAAI,GAAkC,KAAK,UAAU,aAErD,KAAK,EAAI,EAAG,EAAI,EAAS,SAAU,EAClC,KAAK,WAAW,EAAS,yCAO5B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,GAAS,KAAK,UACjB,MAED,IAAI,EACJ,IAAI,GAAa,KAAK,WAAW,MACjC,IAAI,EAEJ,KAAK,EAAI,EAAG,EAAI,EAAK,IACpB,GAAI,KAAK,YAAc,EAAU,KAAK,WAAW,IAAI,UAAY,KAAK,UACrE,KAAK,UAAU,aAAa,EAE9B,MAAK,UAAY,CAEjB,KAAK,EAAI,EAAG,EAAI,EAAK,IACpB,GAAI,KAAK,YAAc,EAAU,KAAK,WAAW,IAAI,UAAY,KAAK,UACrE,KAAK,UAAU,UAAU,uCAM5B,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,6BAGb,SAAkC,GAEjC,KAAK,wBAA0B,sCAOhC,QAAA,eAAW,EAAA,UAAA,iBAAX,WAKC,GAAI,KAAK,eACR,KAAK,eAAe,YAErB,OAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,KAAK,aAAe,sCA8Bd,GAAA,UAAA,oBAAP,WAEC,KAAK,SAAS,oBAAoB,KAAK,WACvC,MAAK,WAAW,WAMV,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,MAAK,SAAW,IAChB,MAAK,SAAW,KAOV,GAAA,UAAA,+BAAP,WAEC,KAAK,qBAEJ,IAAI,KAAK,UACT,KAAK,UAAU,UAmBV,GAAA,UAAA,MAAP,WAEC,GAAI,GAAa,GAAI,GAAK,KAAK,UAAW,KAAK,UAE/C,GAAM,WAAa,KAAK,UACxB,GAAM,MAAQ,KAAK,KACnB,GAAM,UAAY,KAAK,SACvB,GAAM,OAAS,KAAK,OAAO,OAG3B,GAAM,KAAO,KAAK,IAClB,GAAM,aAAe,KAAK,YAC1B,GAAM,uBAAyB,KAAK,sBACpC,GAAM,aAAe,KAAK,YAC1B,GAAM,cAAgB,KAAK,aAG3B,GAAM,MAAQ,KAAK,KAEnB,IAAI,GAAa,KAAK,WAAW,MACjC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,EAAM,WAAW,GAAG,SAAW,KAAK,WAAW,GAAG,uBAGnD,GAAM,KAAK,WACX,IAAI,EAEJ,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAM,KAAK,WAAW,GAAG,OACzB,GAAM,SAAkC,GAGzC,GAAI,KAAK,UACR,EAAM,SAAW,KAAK,UAAU,OAEjC,OAAO,GASD,GAAA,UAAA,0BAAP,SAAiC,GAEhC,MAAO,MAAK,WAAW,KAAK,UAAU,cAAc,QAAQ,IAMtD,GAAA,UAAA,2BAAP,WAEC,MAAO,IAAI,GAAW,MAQhB,GAAA,UAAA,cAAP,WAEC,GAAI,GAAU,EAAU,CACxB,IAAI,GAAkC,KAAK,UAAU,aACrD,IAAI,EACJ,IAAI,EACJ,IAAI,GAAqB,EAAS,MAClC,IAAI,GAAa,EAAa,CAC9B,IAAI,GAAa,EAAa,CAE9B,IAAI,EAAc,EAAG,CACpB,EAAI,CACJ,GAAU,EAAS,EACnB,GAAoB,EAAQ,sBAC5B,GAAO,EAAO,EAAkB,EAChC,GAAO,EAAO,EAAkB,EAAI,EACpC,GAAO,EAAO,EAAkB,EAAI,EAEpC,GAAI,CACJ,OAAO,IAAK,CACX,EAAU,EAAS,EACnB,GAAoB,EAAQ,sBAC5B,GAAI,EAAkB,MACtB,OAAO,IAAK,CACX,EAAI,EAAkB,EACtB,IAAI,EAAI,EACP,EAAO,MACH,IAAI,EAAI,EACZ,EAAO,CAER,GAAI,EAAkB,EAAI,EAE1B,IAAI,EAAI,EACP,EAAO,MACH,IAAI,EAAI,EACZ,EAAO,CAER,GAAI,EAAkB,EAAI,EAE1B,IAAI,EAAI,EACP,EAAO,MACH,IAAI,EAAI,EACZ,EAAO,GAIV,KAAK,SAAS,aAAa,EAAM,EAAM,EAAM,EAAM,EAAM,OACnD,CACN,KAAK,SAAS,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAG3C,EAAA,UAAM,cAAa,KAAA,MAQZ,GAAA,UAAA,wBAAR,SAAgC,GAE/B,KAAK,oBAQE,GAAA,UAAA,mBAAR,SAA2B,GAE1B,KAAK,WAAW,EAAM,aAQf,GAAA,UAAA,qBAAR,SAA6B,GAE5B,GAAI,EACJ,IAAI,GAA0B,EAAM,WACpC,IAAI,GAAa,KAAK,WAAW,MACjC,IAAI,EAMJ,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CAEzB,EAAU,KAAK,WAAW,EAE1B,IAAI,EAAQ,aAAe,EAAS,CACnC,EAAQ,SAER,MAAK,WAAW,OAAO,EAAG,EAE1B,UAIA,CACF,MAAO,EAAI,IAAO,EACjB,KAAK,WAAW,GAAG,QAAU,EAQvB,GAAA,UAAA,WAAR,SAAmB,GAElB,GAAI,GAA6B,EAAY,YAE7C,IAAI,GAAmB,GAAI,GAAa,EAAa,KAAM,KAC3D,IAAI,GAAa,KAAK,WAAW,MAEjC,GAAQ,QAAU,CAElB,MAAK,WAAW,GAAO,CAEvB,MAAK,oBAYC,GAAA,UAAA,gBAAP,SAAuB,EAAkC,GAExD,MAAO,MAAK,kBAAkB,kBAAkB,KAAM,KAAK,qBAAsB,EAA2B,GAStG,GAAA,UAAA,qBAAP,SAA4B,GAK3B,GAAI,KAAK,eACR,KAAK,eAAe,YAErB,IAAI,GAAsB,KAAK,WAAW,MAC1C,KAAK,GAAI,GAAoB,EAAG,EAAI,EAAK,IACxC,KAAK,WAAW,GAAG,oBAAoB,GAGlC,GAAA,UAAA,iCAAP,WAEC,GAAI,GAAa,KAAK,WAAW,MACjC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,WAAW,GAAG,iCAEtB,OAAA,IAjemB,EAmenB,GAAc,QAAL,0ZCzfT,IAAO,GAAc,EAAc,wCAGnC,IAAO,GAAQ,EAAgB,gCAC/B,IAAO,GAAQ,EAAgB,gCAE/B,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAc,EAAc,8CAInC,IAAO,GAAmB,EAAa,iEAEvC,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAMf,SANK,KAQJ,EAAA,KAAA,KANM,MAAA,SAAkB,GAClB,MAAA,UAAmB,GAOzB,MAAK,WAAa,IAElB,MAAK,gBAAkB,GAAG,KAAK,UAAU,KAAK,UAAY,KAAK,SAAS,KAAK,UAGvE,EAAA,UAAA,oBAAP,WAEC,MAAO,IAAI,GAGZ,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,KAAK,SAAW,CAEhB,IAAI,KAAK,SAAW,EAAG,CACtB,KAAK,SAAW,MACV,IAAI,KAAK,SAAW,KAAK,UAAW,CAC1C,KAAK,UAAY,KAAK,QACtB,MAAK,oBAEN,KAAK,gBAAkB,GAAI,KAAK,UAAU,KAAK,UAAY,KAAK,SAAS,KAAK,8CAGxE,GAAA,UAAA,eAAP,WAEC,MAAO,MAAK,gBAGb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,eAGb,SAAmB,GAElB,KAAK,UAAY,CAEjB,IAAI,KAAK,UAAY,EACpB,KAAK,UAAY,CAElB,IAAI,KAAK,UAAY,KAAK,SACzB,KAAK,SAAW,KAAK,SAEtB,MAAK,gBAAkB,GAAI,KAAK,UAAU,KAAK,UAAY,KAAK,SAAS,KAAK,SAC9E,MAAK,wDAMC,GAAA,UAAA,2BAAP,WAEC,MAAO,IAAI,GAAe,MAGpB,GAAA,UAAA,cAAP,WAEC,KAAK,SAAS,WAAW,GAAI,GAAY,KAAK,UAC9C,MAAK,gBAAkB,MAGjB,GAAA,UAAA,6BAAP,WAGC,MAAO,IAAI,GAGL,GAAA,UAAA,2BAAP,SAAkC,EAAgB,EAAe,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEhE,GAAI,GAAe,GAAI,OAAc,GACrC,IAAI,GAA4B,EAAO,MACvC,IAAI,GAAa,GAAI,EAGrB,GAAE,SAAS,EAAO,wBAAwB,GAC1C,GAAE,OAAO,KAAK,SAAS,sBACvB,MAAK,OAAO,EAAE,SAEd,GAAE,SAAS,EAAO,wBAAwB,GAC1C,GAAE,OAAO,KAAK,sBAEd,IAAI,GAAU,EAAO,IACrB,IAAI,GAAc,EAAE,qBAAqB,GAAI,GAAS,EAAI,KAAM,EAAI,OAAQ,EAAI,OAChF,IAAI,GAAc,EAAE,qBAAqB,GAAI,GAAS,EAAI,MAAO,EAAI,IAAK,EAAI,MAC9E,IAAI,GAAY,EAAG,EAAE,EAAG,EAAI,EAAG,EAAE,EAAG,EAAI,EAAG,EAAE,EAAG,CAChD,IAAI,GAAY,EAAG,EAAE,EAAG,EAAI,EAAG,EAAE,EAAG,EAAI,EAAG,EAAE,EAAG,CAChD,IAAI,GAAW,KAAK,KAAK,EAAK,EAAI,EAAK,EACvC,IAAI,EACJ,IAAI,EAEJ,IAAI,GAAW,EAAE,QAAQ,GACzB,GAAO,EAAI,CACX,GAAO,EAAI,CAEX,GAAI,GAAK,EAAI,GAAK,EAAK,CACvB,GAAI,IAAM,GAAM,EAAO,EACvB,GAAI,IAAM,CACV,GAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,IAAM,EAAI,IAAM,EAAI,IAAM,CACtG,GAAI,KAAO,EAAK,EAAI,GAEpB,KAAK,EACJ,EAAS,GAAI,EAEd,GAAO,gBAAgB,EACvB,GAAO,QAAQ,EAEf,OAAO,GAGD,GAAA,UAAA,qBAAP,SAA4B,IAI7B,OAAA,IAhIyB,EAkIL,GAAA,QAAX,ucChJT,IAAO,GAAK,EAAe,mCAOrB,GAAW,SAAA,GAAS,EAApB,EAAW,EAMhB,SANK,GAMO,EAAa,GAExB,EAAA,KAAA,KAAM,EAEN,MAAK,QAAU,EAGhB,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAbC,GAAA,mBAA4B,mBAe3C,OAAA,IAjB0B,EAmBL,GAAA,QAAZ,2NC1BT,IAAO,GAAK,EAAe,+BAI3B,IAAM,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAWvB,SAXK,GAWO,EAAa,GAExB,EAAA,KAAA,KAAM,EACN,MAAK,OAAS,EAZD,EAAA,kBAA2B,kBAC3B,GAAA,uBAAgC,uBAChC,GAAA,cAAuB,cACvB,GAAA,iBAA0B,iBAC1B,GAAA,iBAA0B,iBAC1B,GAAA,cAAuB,cAStC,OAAA,IAhBiC,EAkBL,GAAA,QAAnB,2NCtBT,IAAO,GAAK,EAAe,mCAUrB,GAAa,SAAA,GAAS,EAAtB,EAAa,EAqBlB,SArBK,GAqBO,EAAa,GAAA,GAAA,QAAA,GAAkC,CAAlC,EAAA,KAExB,EAAA,KAAA,KAAM,EAEN,MAAK,aAAe,EAMrB,OAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAON,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAc,KAAK,KAAM,KAAK,cArC5B,GAAA,mBAA4B,kBAK5B,GAAA,qBAA8B,oBAE9B,GAAA,eAAwB,eAgCvC,OAAA,IA5C4B,EA8C5B,GAAuB,QAAd,2NCxDT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAKf,SALK,GAKO,GAEX,EAAA,KAAA,KAAM,GAIA,EAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAW,KAAK,MAVd,GAAA,oBAA6B,mBAY5C,OAAA,IAfyB,EAiBL,GAAA,QAAX,2NCjBT,IAAO,GAAK,EAAe,mCAWrB,GAAU,SAAA,GAAS,EAAnB,EAAU,EAuIf,SAvIK,GAuIO,GAEX,EAAA,KAAA,KAAM,EAtIA,MAAA,qBAA+B,KA4ItC,OAAA,eAAW,EAAA,UAAA,eAAX,WAEC,GAAI,GAAqB,KAAK,oBAC9B,MAAK,qBAAuB,IAG5B,OAAO,uCAMD,GAAA,UAAA,gBAAP,WAEC,KAAK,qBAAuB,KAE5B,IAAI,KAAK,cACR,KAAK,cAAc,kBAMd,GAAA,UAAA,yBAAP,WAEC,KAAK,qBAAuB,KAE5B,IAAI,KAAK,cACR,KAAK,cAAc,2BAMd,GAAA,UAAA,MAAP,WAEC,GAAI,GAAoB,GAAI,GAAW,KAAK,KAO5C,GAAO,QAAU,KAAK,OACtB,GAAO,QAAU,KAAK,OAEtB,GAAO,KAAO,KAAK,IACnB,GAAO,OAAS,KAAK,MACrB,GAAO,cAAgB,KAAK,aAC5B,GAAO,SAAW,KAAK,QACvB,GAAO,GAAK,KAAK,EACjB,GAAO,cAAgB,KAAK,aAC5B,GAAO,YAAc,KAAK,WAC1B,GAAO,MAAQ,KAAK,KACpB,GAAO,iBAAmB,KAAK,gBAC/B,GAAO,MAAQ,KAAK,KAEpB,GAAO,QAAU,KAAK,OACtB,GAAO,SAAW,KAAK,QAEvB,GAAO,cAAgB,IACvB,GAAO,qBAAuB,KAAK,oBAEnC,OAAO,GAMR,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,OAAO,eAAe,gBAAgB,KAAK,mDAMxD,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,GAAI,GAAuB,KAAK,OAAO,eAAe,qBAAqB,KAAK,YAChF,GAAY,WAEZ,OAAO,uCAxNM,GAAA,WAAoB,aAKpB,GAAA,UAAmB,YAKnB,GAAA,SAAkB,WAKlB,GAAA,WAAoB,aAKpB,GAAA,WAAoB,aAepB,GAAA,MAAe,SAKf,GAAA,aAAsB,eAKtB,GAAA,YAAqB,cA6KpC,OAAA,IAnOyB,EAqOL,GAAA,QAAX,2NClPT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EAKlB,SALK,GAKO,GAEX,EAAA,KAAA,KAAM,GALO,EAAA,iBAA0B,iBAC1B,GAAA,gBAAyB,gBAMxC,OAAA,IAT4B,EAW5B,GAAuB,QAAd,2NCbT,IAAO,GAAK,EAAe,+BAI3B,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAsBf,SAtBK,GAsBO,EAAa,GAExB,EAAA,KAAA,KAAM,EAEN,MAAK,cAAgB,EArBR,EAAA,eAAwB,cAKxB,GAAA,mBAA4B,kBAK5B,GAAA,kBAA2B,kBAa1C,OAAA,IA5ByB,EA8BzB,GAAoB,QAAX,2NClCT,IAAO,GAAK,EAAe,mCAQrB,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAmBrB,SAnBK,GAmBO,EAAa,GAAA,GAAA,QAAA,GAAoB,CAApB,EAAA,GAExB,EAAA,KAAA,KAAM,EAEN,MAAK,UAAY,EAMlB,OAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,8CAQN,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAiB,KAAK,KAAM,KAAK,WApC/B,GAAA,gBAAyB,gBAKzB,GAAA,iBAA0B,iBAiCzC,OAAA,IA3C+B,EA6CL,GAAA,QAAjB,6DCrDT,GAAO,GAAQ,EAAgB,gCAK/B,IAAO,GAAc,EAAc,2CAM7B,GAAY,WAqCjB,QArCK,KAAN,GAAA,GAAA,IAIS,MAAA,YAA0B,GAAI,MAM9B,MAAA,YAAuB,GAAI,EAE3B,MAAA,cAAsC,GAAI,MAI1C,MAAA,SAA0B,GAAI,GAAe,EAAe,SAC5D,MAAA,YAA6B,GAAI,GAAe,EAAe,MAC/D,MAAA,UAA2B,GAAI,GAAe,EAAe,UAC7D,MAAA,WAA4B,GAAI,GAAe,EAAe,WAC9D,MAAA,WAA4B,GAAI,GAAe,EAAe,WAC9D,MAAA,WAA4B,GAAI,GAAe,EAAe,WAC9D,MAAA,YAA6B,GAAI,GAAe,EAAe,YAC/D,MAAA,kBAAmC,GAAI,GAAe,EAAe,aAgB5E,MAAK,gBAAkB,SAAC,GAAqB,MAAA,GAAK,QAAQ,GAC1D,MAAK,sBAAwB,SAAC,GAAqB,MAAA,GAAK,cAAc,GACtE,MAAK,oBAAsB,SAAC,GAAqB,MAAA,GAAK,YAAY,GAClE,MAAK,oBAAsB,SAAC,GAAqB,MAAA,GAAK,YAAY,GAClE,MAAK,kBAAoB,SAAC,GAAqB,MAAA,GAAK,UAAU,GAC9D,MAAK,qBAAuB,SAAC,GAAqB,MAAA,GAAK,aAAa,GACpE,MAAK,oBAAsB,SAAC,GAAqB,MAAA,GAAK,YAAY,GAClE,MAAK,mBAAqB,SAAC,GAAqB,MAAA,GAAK,WAAW,IAGnD,EAAA,YAAd,WAEC,GAAI,KAAK,UACR,MAAO,MAAK,SAEb,OAAQ,MAAK,UAAY,GAAI,GAGvB,GAAA,UAAA,gBAAP,SAAuB,GAGtB,GAAI,KAAK,mBAAqB,KAAK,yBAA0B,CAC5D,GAAI,KAAK,yBACR,KAAK,cAAc,KAAK,UAAW,KAAK,gBAAiB,KAAK,yBAE/D,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,WAAY,KAAK,iBAI3C,GAAI,GAAkB,KAAK,kBAC1B,KAAK,cAAe,KAAK,WAAY,KAAK,gBAE3C,IAAI,EACJ,IAAI,MAGA,GAAa,KAAK,cAAc,MACpC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CAEpC,EAAQ,KAAK,cAAc,EAC3B,GAAa,EAAM,MAEnB,OAAO,IAAe,EAAW,mBAChC,EAAa,EAAW,MAEzB,IAAI,EACH,EAAW,cAAc,GAG3B,KAAK,cAAc,OAAS,CAE5B,MAAK,yBAA2B,KAAK,iBAErC,MAAK,cAAgB,MAmBf,GAAA,UAAA,aAAP,SAAoB,GAEnB,EAAK,YAAY,iBAAiB,QAAS,KAAK,gBAChD,GAAK,YAAY,iBAAiB,WAAY,KAAK,sBACnD,GAAK,YAAY,iBAAiB,YAAa,KAAK,oBACpD,GAAK,YAAY,iBAAiB,YAAa,KAAK,oBACpD,GAAK,YAAY,iBAAiB,UAAW,KAAK,kBAClD,GAAK,YAAY,iBAAiB,aAAc,KAAK,qBACrD,GAAK,YAAY,iBAAiB,YAAa,KAAK,oBACpD,GAAK,YAAY,iBAAiB,WAAY,KAAK,mBAEnD,MAAK,YAAY,KAAK,GAGhB,GAAA,UAAA,eAAP,SAAsB,GAErB,EAAK,YAAY,oBAAoB,QAAS,KAAK,gBACnD,GAAK,YAAY,oBAAoB,WAAY,KAAK,sBACtD,GAAK,YAAY,oBAAoB,YAAa,KAAK,oBACvD,GAAK,YAAY,oBAAoB,YAAa,KAAK,oBACvD,GAAK,YAAY,oBAAoB,UAAW,KAAK,kBACrD,GAAK,YAAY,oBAAoB,aAAc,KAAK,qBACxD,GAAK,YAAY,oBAAoB,YAAa,KAAK,oBACvD,GAAK,YAAY,oBAAoB,WAAY,KAAK,mBAEtD,MAAK,YAAY,MAAM,KAAK,YAAY,QAAQ,GAAO,GAOhD,GAAA,UAAA,cAAR,SAAsB,EAAsB,EAAwB,GAAA,GAAA,QAAA,GAAkC,CAAlC,EAAA,KAGnE,GAAI,EAAa,CAChB,EAAM,QAAU,EAAY,OAC5B,GAAM,OAAS,EAAY,MAC3B,GAAM,SAAW,EAAY,QAC7B,GAAM,QAAU,EAAY,OAC5B,GAAM,QAAU,EAAY,QAG7B,GAAI,GAAY,KACf,EAAW,KAAK,iBAGjB,IAAI,EAAU,CAEb,EAAM,OAAS,EAAS,aACxB,GAAM,cAAgB,EAAS,aAE/B,GAAM,GAAK,EAAS,EAEpB,GAAM,cAAgB,EAAS,cAAe,EAAS,cAAc,QAAU,IAE/E,GAAM,YAAc,EAAS,YAAa,EAAS,YAAY,QAAU,IAEzE,GAAM,MAAQ,EAAS,UACjB,CAEN,EAAM,GAAK,IACX,GAAM,OAAS,IACf,GAAM,cAAgB,KAAK,WAC3B,GAAM,YAAc,KAAK,WACzB,GAAM,MAAQ,CACd,GAAM,iBAAmB,EAI1B,KAAK,cAAc,KAAK,GAOjB,GAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,WAAY,KAAK,gBAAkB,GAGrD,GAAA,UAAA,WAAR,SAAmB,GAElB,KAAK,YAAc,IAEnB,MAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,UAAW,GAG7B,GAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,YAA+B,EAAM,MAE1C,MAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAe,KAAK,WAAY,GAG/B,GAAA,UAAA,QAAR,SAAgB,GAEf,KAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,YAAa,GAG/B,GAAA,UAAA,cAAR,SAAsB,GAErB,KAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,kBAAmB,GAGrC,GAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,YAA+B,EAAM,MAE1C,MAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,WAAY,GAG9B,GAAA,UAAA,UAAR,SAAkB,GAEjB,KAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,SAAW,GAG7B,GAAA,UAAA,aAAR,SAAqB,GAEpB,KAAK,gBAAgB,EAErB,IAAI,KAAK,kBACR,KAAK,cAAc,KAAK,YAAa,GAI/B,GAAA,UAAA,gBAAR,SAAwB,GAEvB,GAAI,KAAK,cACR,MAED,IAAI,EACJ,IAAI,EACJ,IAAI,GAAgB,EAAM,OAC1B,IAAI,GAAgB,EAAM,OAC1B,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAAK,CACpC,EAAO,KAAK,YAAY,EACxB,GAAS,EAAK,YAAY,uBAC1B,IAAI,EAAS,EAAO,MAAQ,EAAS,EAAO,OAAS,EAAS,EAAO,KAAO,EAAS,EAAO,OAAQ,CACnG,EAAK,SAAW,IAChB,GAAK,SAAW,SACV,CACN,EAAK,SAAW,EAAS,EAAO,IAChC,GAAK,SAAW,EAAS,EAAO,GAChC,GAAK,gBAEL,IAAI,EAAK,aAAe,KAAK,kBAC5B,OAIH,KAAK,cAAgB,KAEvB,OAAA,KAEA,GAAsB,QAAb,sQC5ST,IAAO,GAAS,EAAe,oCAC/B,IAAO,GAAc,EAAc,6CAiB7B,GAAe,SAAA,GAAS,EAAxB,EAAe,EAmBpB,SAnBK,KAqBJ,EAAA,KAAA,KAnBM,MAAA,iBAA0B,CAC1B,MAAA,uBAAgC,CAChC,MAAA,wBAAiC,CACjC,MAAA,8BAAuC,CACvC,MAAA,iBAA0B,EAqB1B,EAAA,UAAA,QAAP,YAOA,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,iDAMlB,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,2DAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qDAMb,QAAA,eAAW,EAAA,UAAA,mCAAX,WAEC,MAAO,MAAK,kEAMb,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,4DAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qDAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wDAMb,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,yDAMb,QAAA,eAAW,EAAA,UAAA,gCAAX,WAEC,MAAO,MAAK,+DAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wDAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,sDAMN,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,mBAAmB,GAOjB,GAAA,UAAA,mBAAR,SAA2B,MAGtB,GAAqB,EAAW,aAAa,aACjD,IAAI,EAEJ,IAAI,GAAY,EAAU,EAAG,EAAY,EAAU,EAAG,EAAY,EAAU,CAC5E,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAU,EAAe,CAC7B,IAAI,EAGJ,KAAK,EAAI,EAAG,EAAI,KAAK,mBAAoB,EAAG,CAE3C,EAAW,KAAK,cAAc,GAAG,aACjC,GAAK,EAAK,EAAS,CACnB,GAAK,EAAK,EAAS,CACnB,GAAK,EAAK,EAAS,CAEnB,GAAI,EAAG,EAAK,EAAG,EAAK,EAAG,CAGvB,GAAI,EAAI,KAAQ,EAAE,EAAI,GACtB,MAAK,oBAAoB,GAAK,CAC9B,IAAS,EAIV,EAAQ,EAAE,CAEV,KAAK,EAAI,EAAG,EAAI,KAAK,mBAAoB,EACxC,KAAK,oBAAoB,IAAM,EAElC,OAAA,IApL8B,EAsLL,GAAA,QAAhB,6QCzMT,IAAO,GAAK,EAAgB,+BAG5B;GAAO,GAAgB,EAAc,+CACrC,IAAO,GAAU,EAAe,yCAChC,IAAO,GAAU,EAAe,yCAChC,IAAO,GAAU,EAAe,uCAChC,IAAO,GAAe,EAAc,gEAO9B,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EAStB,SATK,GASO,GATb,GAAA,GAAA,IAWE,GAAA,KAAA,KAEA,MAAK,4BAA8B,SAAC,GAAqB,MAAA,GAAK,mBAAmB,GAEjF,MAAK,OAAS,EAMf,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,GAAwB,CAC5B,IAAI,GAA8B,CAClC,IAAI,GAA+B,CACnC,IAAI,GAAqC,CACzC,IAAI,GAAwB,CAC5B,IAAI,EAEJ,IAAI,KAAK,QACR,KAAK,gBAEN,MAAK,QAAU,CACf,MAAK,kBAAoB,CACzB,MAAK,cAAgB,GAAI,MACzB,MAAK,qBAAuB,GAAI,MAChC,MAAK,oBAAsB,GAAI,MAC/B,MAAK,2BAA6B,GAAI,MACtC,MAAK,cAAgB,GAAI,MAEzB,IAAI,GAAa,EAAM,MAEvB,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAQ,EAAM,EACd,GAAM,iBAAiB,EAAW,oBAAqB,KAAK,4BAE5D,IAAI,YAAiB,GAAY,CAChC,GAAI,EAAM,aACT,KAAK,qBAAqB,KAAwC,MAElE,MAAK,cAAc,KAAiC,MAE/C,IAAI,YAAiB,GAAkB,CAC7C,GAAI,EAAM,aACT,KAAK,2BAA2B,KAAoD,MAEpF,MAAK,oBAAoB,KAA6C,MAEjE,IAAI,YAAiB,GAAY,CACvC,KAAK,cAAc,KAAiC,GAItD,GAAI,KAAK,wBAA0B,GAAwB,KAAK,kBAAoB,GAAkB,KAAK,kBAAoB,GAAkB,KAAK,yBAA2B,GAAyB,KAAK,+BAAiC,EAC/O,MAED,MAAK,uBAAyB,CAC9B,MAAK,8BAAgC,CACrC,MAAK,iBAAmB,CACxB,MAAK,wBAA0B,CAC/B,MAAK,iBAAmB,CAGxB,MAAK,oBAAsB,GAAI,OAAc,KAAK,KAAK,EAAe,GAAG,EAGzE,MAAK,cAAc,GAAI,GAAM,EAAM,6CAO5B,GAAA,UAAA,eAAR,WAEC,GAAI,GAAa,KAAK,QAAQ,MAC9B,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,QAAQ,GAAG,oBAAoB,EAAW,oBAAqB,KAAK,6BAMnE,GAAA,UAAA,mBAAR,SAA2B,GAK1B,GAAI,GAA8B,EAAM,MAExC,IAAI,YAAiB,GACpB,KAAK,mBAAgC,OACjC,IAAI,YAAiB,GACzB,KAAK,yBAA4C,EAElD,MAAK,cAAc,GAAI,GAAM,EAAM,SAM5B,GAAA,UAAA,yBAAR,SAAiC,GAEhC,GAAI,GAAyC,CAE7C,IAAI,EAAM,aAAc,GACrB,KAAK,yBACL,KAAK,6BAGP,MAAK,oBAAoB,OAAO,KAAK,oBAAoB,QAAQ,GAAK,EACtE,MAAK,2BAA2B,KAAK,OAE/B,GACJ,KAAK,yBACL,KAAK,6BAEP,MAAK,2BAA2B,OAAO,KAAK,2BAA2B,QAAQ,GAAK,EACpF,MAAK,oBAAoB,KAAK,IAOxB,GAAA,UAAA,mBAAR,SAA2B,GAE1B,GAAI,GAA6B,CAEjC,IAAI,EAAM,aAAc,GACrB,KAAK,mBACL,KAAK,uBACP,MAAK,cAAc,OAAO,KAAK,cAAc,QAAQ,GAAK,EAC1D,MAAK,qBAAqB,KAAK,OACzB,GACJ,KAAK,mBACL,KAAK,uBAEP,MAAK,qBAAqB,OAAO,KAAK,qBAAqB,QAAQ,GAAK,EACxE,MAAK,cAAc,KAAK,IAG3B,OAAA,IA9JgC,EAgKhC,GAA2B,QAAlB,8cC7KT,IAAO,GAA0B,EAAW,oDAI5C,IAAO,GAAM,EAAgB,qCAE7B,IAAO,GAAgB,EAAc,8DAKrC,IAAM,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAMxB,SANK,KAQJ,EAAA,KAAA,KAEA,MAAK,eAAiB,GACtB,MAAK,aAAe,GAAI,MACxB,MAAK,cAGE,EAAA,UAAA,YAAR,WAEC,KAAK,cAAgB,GAAI,MACzB,MAAK,aAAe,GAAI,MAGxB,MAAK,UAAU,EAAG,GAAI,EACtB,MAAK,UAAU,GAAI,GAAI,EACvB,MAAK,WAAW,GAAI,EAAG,EACvB,MAAK,UAAU,GAAI,EAAG,EACtB,MAAK,UAAU,EAAG,EAAG,EACrB,MAAK,UAAU,EAAG,IAAK,GAGhB,GAAA,UAAA,UAAR,SAAkB,EAAkB,EAAkB,GAErD,GAAI,GAAa,GAAI,EACrB,GAAI,UAAY,CAChB,GAAI,UAAY,CAChB,GAAI,UAAY,CAChB,GAAI,WAAW,KAAO,GAEtB,IAAI,GAA2D,EAAI,UACnE,GAAW,YAAc,EACzB,MAAK,aAAa,KAAK,EACvB,GAAI,WAAW,cAAgB,CAC/B,MAAK,cAAc,KAAK,GAIlB,GAAA,UAAA,oBAAP,WAEC,KAAM,IAAI,GAOJ,GAAA,UAAA,uBAAP,SAA8B,GAE7B,GAAI,GAAgC,KAAY,OAChD,IAAI,GAAqB,EAAM,SAC/B,IAAI,GAAe,KAAK,QAAQ,aAGhC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,KAAK,aAAa,GAAG,IAAM,CAC3B,MAAK,cAAc,GAAG,UAAU,SAAW,CAC3C,MAAK,aAAa,GAAK,MAKlB,GAAA,UAAA,cAAP,SAAqB,EAAsB,EAAa,GAEvD,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,aAAa,GAAI,CACzB,KAAK,kBAAkB,OAAS,KAAK,cAAc,EACnD,MAAK,kBAAkB,OACvB,GAAM,mBAAmB,KAAK,kBAC9B,GAAS,SAAS,KAAK,kBAAmB,EAAQ,KAAM,KAI5D,OAAA,IAhFkC,EAkFL,GAAA,QAApB,yVC9FT,IAAO,GAAQ,EAAgB,gCAG/B,IAAO,GAAoB,EAAa,mDAIxC,IAAO,GAAM,EAAgB,qCAE7B,IAAO,GAAgB,EAAc,8DAIrC,IAAM,GAAuB,SAAA,GAAS,EAAhC,EAAuB,EAc5B,SAdK,KAgBJ,EAAA,KAAA,KAXM,MAAA,cAAuB,GAGvB,MAAA,OAAgB,EAUtB,MAAK,eACL,MAAK,yBAA2B,GAAI,EACpC,MAAK,qBAAuB,GAAI,GAAO,KAAK,yBAC5C,MAAK,iBACL,MAAK,SAAW,GAAI,GAGrB,OAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,YAGb,SAAgB,GAEf,KAAK,OAAS,sCAGf,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,mBAGb,SAAuB,GAEtB,KAAK,cAAgB,sCAItB,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,qBAAqB,mDAIlC,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,OAAS,KAAK,2CAIpB,GAAA,UAAA,cAAP,SAAqB,EAAyB,EAAa,GAE1D,KAAK,kBAAkB,OAAS,KAAK,oBACrC,MAAK,kBAAkB,WAAa,KAAK,YACzC,MAAK,kBAAkB,OACvB,GAAM,mBAAmB,KAAK,kBAC9B,GAAS,SAAS,KAAK,kBAAmB,GAIpC,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,GAAoC,KAAK,qBAAqB,aAClE,IAAI,GAAmC,EAAW,aAClD,MAAK,aAAa,OAAS,CAE3B,MAAK,aAAa,GAAK,EAAmB,EAC1C,MAAK,aAAa,GAAK,EAAmB,EAC1C,MAAK,aAAa,GAAK,EAAmB,EAC1C,MAAK,aAAa,GAAK,EAAmB,EAE1C,IAAI,GAA4C,KAAK,OACrD,IAAI,GAAe,EAAM,cACzB,IAAI,GAAc,EAAI,CACtB,IAAI,GAAc,EAAI,CACtB,IAAI,GAAc,EAAI,CACtB,IAAI,GAAW,CACf,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,GAAgB,EAAkB,EACtC,IAAI,EAAM,EAAE,EAAO,EAAM,EAAE,EAAO,EAAM,EAAE,EAAO,EAChD,KAAK,aAAa,KAAO,GAKrB,GAAA,UAAA,uBAAP,SAA8B,GAE7B,KAAK,oCAAoC,EAAY,EAAW,WAAW,eAAgB,KAAK,SAChG,MAAK,yBAAyB,OAAS,KAAK,QAC5C,MAAK,kBAAkB,GAGjB,GAAA,UAAA,oCAAP,SAA2C,EAAmB,EAAuB,GAEpF,GAAI,GAAoB,GAAI,MAC5B,IAAI,EACJ,IAAI,GAAU,EAAU,CACxB,IAAI,GAAa,CACjB,IAAI,GAAa,CACjB,IAAI,EAEJ,IAAI,GAA4C,KAAK,OACrD,GAAM,EAAM,cACZ,MAAK,qBAAqB,UAAU,SAAW,KAAK,QAAQ,cAC5D,GAAI,KAAK,OAAO,EAAW,EAAI,EAAI,EAAE,KAAK,eAAe,KAAK,QAAQ,KAAK,MAC3E,GAAI,KAAK,OAAO,EAAW,EAAI,EAAI,EAAE,KAAK,eAAe,KAAK,QAAQ,KAAK,MAC3E,GAAI,KAAK,OAAO,EAAW,EAAI,EAAI,EAAE,KAAK,eAAe,KAAK,QAAQ,KAAK,MAC3E,MAAK,qBAAqB,EAAI,CAC9B,MAAK,qBAAqB,EAAI,CAC9B,MAAK,qBAAqB,EAAI,CAE9B,MAAK,SAAS,SAAS,KAAK,qBAAqB,sBACjD,MAAK,SAAS,QAAQ,EAAW,eACjC,MAAK,SAAS,iBAAiB,EAAS,KAAK,eAE7C,GAAO,EAAO,KAAK,eAAe,EAClC,GAAO,EAAO,KAAK,eAAe,EAClC,MAAK,OAAS,KAAK,eAAe,EAElC,GAAI,CACJ,OAAO,EAAI,GAAI,CACd,EAAI,KAAK,eAAe,EACxB,GAAI,KAAK,eAAe,EAAI,EAC5B,GAAI,KAAK,eAAe,EAAI,EAC5B,IAAI,EAAI,EACP,EAAO,CACR,IAAI,EAAI,EACP,EAAO,CACR,IAAI,EAAI,EACP,EAAO,CACR,IAAI,EAAI,EACP,EAAO,CACR,IAAI,EAAI,KAAK,OACZ,KAAK,OAAS,CACf,IAAK,EAGN,KAAK,OAAS,CAEd,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,GAAG,KAAK,OAAS,KAAK,OAErC,IAAI,EAAO,EACV,GAAQ,KAAK,MAEd,IAAI,EAAO,EACV,GAAQ,KAAK,MAEd,GAAO,KAAK,MAAM,EAAK,KAAK,QAAQ,KAAK,MACzC,GAAO,KAAK,MAAM,EAAK,KAAK,QAAQ,KAAK,MAEzC,IAAI,GAAe,EAAE,KAAK,MAC1B,GAAI,KAAK,MAAM,EAAE,EAAQ,GAAG,CAC5B,GAAI,KAAK,MAAM,EAAE,EAAQ,GAAG,CAE5B,GAAO,EAAO,CACd,GAAO,EAAO,CAEd,GAAI,EAAE,CACN,GAAI,EAAE,CAEN,GAAI,GAAK,EAAE,CACX,GAAI,GAAK,EAAE,CACX,GAAI,IAAM,CACV,GAAI,MAAQ,EAAO,GAAM,CACzB,GAAI,MAAQ,EAAO,GAAM,CACzB,GAAI,KAAO,KAAK,OAAO,CACvB,GAAI,IAAM,CACV,GAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,GAAK,EAAI,IAAM,CAElF,GAAO,gBAAgB,GAEzB,OAAA,IArLsC,EAuLL,GAAA,QAAxB,8NCpMT,GAAO,GAAmB,EAAa,6CAMvC,IAAO,GAAqB,EAAY,oDAExC,IAAO,GAAa,EAAc,yCAGlC,IAAM,GAAgB,WAYrB,QAZK,KAME,KAAA,eAAwB,IAGvB,MAAA,mBAA6B,IAKpC,MAAK,kBAAoB,KAAK,yBAGxB,EAAA,UAAA,uBAAP,WAEC,MAAO,IAAI,GAGZ,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wBAGb,SAA6B,GAE5B,KAAK,mBAAqB,sCAGpB,GAAA,UAAA,cAAP,WAEC,KAAK,iBAAmB,KAGlB,GAAA,UAAA,aAAP,SAAoB,GAEnB,GAAI,KAAK,WAAa,EACrB,MAED,IAAI,KAAK,YAAc,KAAK,kBAC3B,KAAK,UAAU,SAEhB,MAAK,UAAY,CAEjB,IAAI,KAAK,UAAW,CACnB,KAAK,kBAAoB,IACzB,MAAK,eAAiB,KAAK,UAAU,SAC/B,CACN,KAAK,kBAAoB,OAI3B,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,aAGb,SAAiB,GAEhB,KAAK,QAAU,sCAGhB,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,IAAK,KAAK,UACT,KAAK,UAAY,KAAK,qBAEvB,OAAO,MAAK,8CAGb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,oBAGb,SAAwB,GAEvB,GAAI,GAAS,KAAK,eACjB,MAED,MAAK,kBAAkB,uCAGjB,GAAA,UAAA,QAAP,WAEC,KAAK,kBAAoB,IAEzB,IAAI,KAAK,YAAc,KAAK,kBAC3B,KAAK,UAAU,SAEhB,MAAK,UAAY,KAGX,GAAA,UAAA,oBAAP,WAEC,MAAO,IAAI,GAAc,KAAK,eAAgB,KAAK,gBAG7C,GAAA,UAAA,gBAAP,SAAuB,EAAiC,GAEvD,KAAK,iBAAmB,KAExB,MAAK,uBAAuB,EAAgB,OAE5C,KAAK,KAAK,UACT,KAAK,UAAY,KAAK,qBAEvB,MAAK,cAAc,KAAK,UAAW,EAAgB,MAAO,GAGpD,GAAA,UAAA,uBAAP,SAA8B,GAE7B,KAAM,IAAI,GAGJ,GAAA,UAAA,cAAP,SAAqB,EAAyB,EAAa,GAE1D,KAAM,IAAI,GAGJ,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,eAAiB,CAEtB,IAAI,KAAK,kBAAmB,CAC3B,KAAM,OAAM,2DACN,IAAI,KAAK,UAAW,CAC1B,KAAK,UAAU,SACf,MAAK,UAAY,MAGpB,OAAA,KAEA,GAA0B,QAAjB,4UCnJT,IAAO,GAAU,EAAe,8CAO1B,GAAU,SAAA,GAAS,EAAnB,EAAU,EAEf,SAFK,GAEO,GAEX,EAAA,KAAA,KAAM,GAMA,EAAA,UAAA,gBAAP,SAAuB,IAIxB,OAAA,IAdyB,EAgBzB,GAAoB,QAAX,qOCvBT,IAAO,GAAU,EAAe,8CAO1B,GAAoB,SAAA,GAAS,EAA7B,EAAoB,EAQzB,SARK,GAQO,GAEX,EAAA,KAAA,KAAM,EAEN,MAAK,kBAAoB,EAMnB,EAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EAAU,UAAU,MACvB,EAAU,sBAAsB,KAAK,mBAOhC,GAAA,UAAA,gBAAP,WAEC,MAAO,OAET,OAAA,IAhCmC,EAkCnC,GAA8B,QAArB,qOCvCT,IAAO,GAA0B,EAAW,oDAE5C,IAAO,GAAQ,EAAgB,4CAOzB,GAAU,SAAA,GAAS,EAAnB,EAAU,EAMf,SANK,GAMO,GAEX,EAAA,KAAA,KACA,MAAK,QAAU,CACf,MAAK,cAAgB,EAGtB,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAGN,GAAA,UAAA,iBAAP,WAEC,GAAI,KAAK,SACR,KAAK,SAAS,YAAY,KAE3B,MAAK,SAAW,KAOV,GAAA,UAAA,gBAAP,WAEC,MAAO,MAAK,OAAO,aASb,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,IAAK,KAAK,QAAQ,cACjB,MAAO,MAER,OAAO,MAAK,QAAQ,YAAY,YAAY,EAAQ,GAM9C,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EAAU,UAAU,MACvB,EAAU,YAAY,KAAK,SAMtB,GAAA,UAAA,kBAAP,SAAyB,EAAsB,GAE9C,IAAK,KAAK,QAAQ,cACjB,MAAO,MAER,OAAO,MAAK,QAAQ,kBAAkB,EAAa,GAO7C,GAAA,UAAA,wBAAP,WAEC,KAAM,IAAI,GAGZ,OAAA,IA9EyB,EAgFzB,GAAoB,QAAX,2RC3FT,IAAO,GAAU,EAAe,8CAO1B,GAAc,SAAA,GAAS,EAAvB,EAAc,EAQnB,SARK,GAQO,GAEX,EAAA,KAAA,KAAM,EAEN,MAAK,YAAc,EAMb,EAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EAAU,UAAU,MACvB,EAAU,gBAAgB,KAAK,aAO1B,GAAA,UAAA,gBAAP,WAEC,MAAO,OAET,OAAA,IAhC6B,EAkC7B,GAAwB,QAAf,0EChCH,GAAQ,WAoEb,QApEK,KAOE,KAAA,gBAAyB,CAGzB,MAAA,cAAuB,CA4D7B,MAAK,aAAe,GAAI,OAtDzB,OAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,4BAGb,SAAyB,GAExB,GAAI,KAAK,wBAA0B,EAClC,MAED,MAAK,uBAAyB,CAE9B,MAAK,8BAA8B,KAAK,SAAU,KAAK,SAAS,sBAAwB,2CAIzF,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,4BAGb,SAAiC,GAEhC,GAAI,KAAK,wBAA0B,EAClC,MAED,MAAK,uBAAyB,CAE9B,KAAK,GAAI,GAAW,EAAG,EAAI,KAAK,kBAAmB,EAClD,KAAK,aAAa,GAAG,8BAA8B,KAAK,4DAM1D,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAOb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kDAkBN,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,MAAO,MASD,GAAA,UAAA,kBAAP,SAAyB,EAAsB,GAE9C,MAAO,MAOD,GAAA,UAAA,gBAAP,WAEC,MAAO,MAQD,GAAA,UAAA,uBAAP,SAA8B,GAE7B,MAAO,MAOD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,KAAK,eAAiB,IAAM,KAAK,uBACpC,MAED,IAAI,EAAU,UAAU,MAAO,CAC9B,GAAI,GAAW,CAEf,OAAO,EAAI,KAAK,gBACf,KAAK,aAAa,KAAK,gBAAgB,EAExC,IAAI,KAAK,uBACR,KAAK,kBAAkB,cAAc,gBAAgB,IAQjD,GAAA,UAAA,wBAAP,WAEC,MAAO,MAQD,GAAA,UAAA,SAAP,SAAgB,GAEf,EAAK,SAAW,IAChB,MAAK,eAAiB,EAAK,aAC3B,MAAK,aAAc,KAAK,mBAAsB,CAE9C,GAAK,8BAA8B,KAAK,sBAExC,IAAI,GAAqB,EAAK,aAC9B,GAAO,IAEP,GAAG,CACF,EAAK,eAAiB,SACb,EAAO,EAAK,WAAa,MAQ7B,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,GAAe,KAAK,aAAa,QAAQ,EAC7C,MAAK,aAAa,GAAS,KAAK,eAAe,KAAK,gBACpD,MAAK,aAAa,KAElB,GAAK,8BAA8B,MAEnC,IAAI,GAAqB,EAAK,aAC9B,GAAO,IAEP,GAAG,CACF,EAAK,eAAiB,SACb,EAAO,EAAK,WAAa,MAG5B,GAAA,UAAA,8BAAR,SAAsC,GAErC,GAAI,KAAK,wBAA0B,KAAK,wBAA0B,EACjE,MAED,MAAK,uBAAyB,KAAK,wBAA0B,CAE7D,MAAK,sBAEL,KAAK,GAAI,GAAW,EAAG,EAAI,KAAK,kBAAmB,EAClD,KAAK,aAAa,GAAG,8BAA8B,KAAK,wBAMnD,GAAA,UAAA,kBAAP,WAEC,MAAO,MAAK,uBAaN,GAAA,UAAA,qBAAP,WAEC,GAAI,KAAK,kBAAmB,CAC3B,KAAK,kBAAkB,SACvB,MAAK,kBAAoB,KAG1B,GAAI,KAAK,uBACR,KAAK,kBAAoB,KAAK,0BAEjC,OAAA,KAEA,GAAkB,QAAT,8BC3OH,GAAQ,WAEb,QAFK,MAKN,MAAA,KAEA,GAAkB,QAAT,2BCPT,GAAO,GAAQ,EAAgB,4CAMzB,GAAS,WAOd,QAPK,GAOO,GAHJ,KAAA,aAAuB,KAK9B,MAAK,UAAY,GAAuB,GAAI,GAG7C,OAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,8CAGN,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,KAAK,aACR,KAAK,gBAEN,MAAK,UAAU,gBAAgB,GAGzB,GAAA,UAAA,eAAP,SAAsB,GAErB,GAAI,GAAkB,EAAO,aAC7B,IAAI,GAAe,KAAK,YAExB,OAAO,EAAG,CACT,GAAI,GAAQ,EACX,MAED,GAAI,EAAE,kBAGP,EAAK,kBAAoB,KAAK,YAE9B,MAAK,aAAe,CACpB,MAAK,aAAe,KAGd,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,GAAkB,EAAO,aAC7B,IAAI,EAEJ,GAAK,kBAEL,IAAI,GAAQ,KAAK,aAAc,CAC9B,KAAK,aAAe,EAAK,sBACnB,CACN,EAAI,KAAK,YACT,OAAO,GAAK,EAAE,mBAAqB,EAClC,EAAI,EAAE,iBAEP,IAAI,EACH,EAAE,kBAAoB,EAAK,kBAG7B,EAAK,kBAAoB,IAEzB,KAAK,KAAK,aACT,KAAK,aAAe,MAGd,GAAA,UAAA,eAAR,WAEC,GAAI,GAAkB,KAAK,YAC3B,IAAI,EACJ,IAAI,EACJ,MAAK,aAAe,IACpB,MAAK,aAAe,KAEpB,GAAG,CACF,EAAa,KAAK,UAAU,uBAAuB,EAAK,OAExD,IAAI,EAAK,QAAU,EAAY,CAC9B,GAAI,EACH,EAAK,kBAEN,GAAW,SAAS,GAGrB,EAAI,EAAK,iBACT,GAAK,kBAAoB,IAGzB,GAAK,OAAO,0BAEH,EAAO,IAAM,MAEzB,OAAA,KAEA,GAAmB,QAAV,mOCvGT,IAAO,GAAU,EAAe,8CAO1B,GAAc,SAAA,GAAS,EAAvB,EAAc,EAQnB,SARK,GAQO,GAEX,EAAA,KAAA,KAAM,EAEN,MAAK,YAAc,EAMb,EAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,EAAU,UAAqB,MAClC,EAAU,gBAAgB,KAAK,aAO1B,GAAA,UAAA,gBAAP,WAEC,MAAO,OAET,OAAA,IAhC6B,EAkCL,GAAA,QAAf,0EC5BH,GAAkB,WA0EvB,QA1EK,GA0EO,GAEX,KAAK,cAAgB,EAGvB,MAAA,KAEA,GAA4B,QAAnB,2BC/FT,GAAO,GAAQ,EAAgB,gCAQ/B,IAAO,GAAgB,EAAc,mDAU/B,GAAa,WA8BlB,QA9BK,GA8BO,GAAA,GAAA,QAAA,GAAoC,CAApC,EAAA,MA1BJ,KAAA,mBACA,MAAA,kBAA4B,IAG5B,MAAA,aAAsB,CAwB7B,MAAK,kBAAoB,GAAI,EAE7B,MAAK,sBAAwB,CAC7B,MAAK,UAAY,GAAI,OArBtB,OAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,KAAK,kBAAoB,sCAoBnB,GAAA,UAAA,iBAAP,SAAwB,EAAU,EAAU,MAGvC,GAAuB,EAAK,UAAU,EAAG,EAAG,EAChD,IAAI,GAAwB,EAAK,UAAU,EAAG,EAAG,GAAG,SAAS,EAE7D,OAAO,MAAK,kBAAkB,EAAa,EAAc,EAAK,OAMxD,GAAA,UAAA,kBAAP,SAAyB,EAAsB,EAAuB,GAGrE,KAAK,kBAAkB,OAGvB,MAAK,kBAAkB,YAAc,CACrC,MAAK,kBAAkB,aAAe,CAGtC,GAAM,mBAAmB,KAAK,kBAE9B,MAAK,aAAe,CACpB,IAAI,GAAsB,KAAK,kBAAkB,UACjD,IAAI,EAEJ,OAAO,EAAM,CACZ,IAAK,KAAK,UAAU,EAAS,EAAK,QACjC,KAAK,UAAU,KAAK,gBAAkB,CAEvC,GAAO,EAAK,KAIb,IAAK,KAAK,aACT,MAAO,KAER,OAAO,MAAK,sBAAsB,KAAK,mBAoBjC,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,iBAAmB,EAGjB,GAAA,UAAA,UAAR,SAAkB,GAEjB,GAAI,KAAK,oBAAsB,EAAO,mBACrC,MAAO,KAER,IAAI,GAAa,KAAK,iBAAiB,MACvC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,GAAI,KAAK,iBAAiB,IAAM,EAC/B,MAAO,KAET,OAAO,OAGA,GAAA,UAAA,YAAR,SAAoB,EAAiB,GAEpC,MAAO,GAAQ,qBAAqB,iBAAmB,EAAQ,qBAAqB,iBAAkB,GAAK,EAGpG,GAAA,UAAA,sBAAR,SAA8B,GAG7B,KAAK,UAAU,OAAS,KAAK,YAG7B,MAAK,UAAY,KAAK,UAAU,KAAK,KAAK,gBAOtC,GAAmC,OAAO,SAC9C,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,EAAI,EAAG,EAAI,KAAK,eAAgB,EAAG,CACvC,EAAS,KAAK,UAAU,EACxB,GAAqB,EAAO,oBAC5B,IAAI,EAAO,gBAAiB,CAE3B,IAAK,GAAmB,MAAQ,EAAmB,iBAAmB,EAAgB,mBAAqB,EAAO,gBAAgB,EAA2B,KAAK,uBAAwB,CACzL,EAA4B,EAAmB,gBAC/C,GAAkB,CAClB,KAAK,KAAK,sBAAuB,CAChC,KAAK,oBAAoB,EACzB,OAAO,SAGH,IAAI,GAAmB,MAAQ,EAAmB,iBAAmB,EAAgB,iBAAkB,CAK7G,IAAK,EAAmB,wBAAyB,CAChD,KAAK,oBAAoB,EACzB,OAAO,KAKV,MAAO,GAGA,GAAA,UAAA,oBAAR,SAA4B,GAE3B,GAAI,GAA0B,EAAmB,eAAiB,KAAQ,GAAI,GAAa,EAAmB,aAE9G,IAAI,GAAkB,EAAmB,iBACzC,IAAI,GAAkB,EAAmB,gBACzC,IAAI,GAAW,EAAmB,gBAClC,GAAa,EAAI,EAAO,EAAI,EAAE,EAAO,CACrC,GAAa,EAAI,EAAO,EAAI,EAAE,EAAO,CACrC,GAAa,EAAI,EAAO,EAAI,EAAE,EAAO,EAG/B,GAAA,UAAA,QAAP,YAID,OAAA,KAEuB,GAAA,QAAd,mHCzMH,GAAc,WAApB,QAAM,MAWN,MAAA,KAEwB,GAAA,QAAf,2BClBT,GAAO,GAAc,EAAc,6CAK7B,GAAkB,WASvB,QATK,KAGG,KAAA,OAAgB,CAChB,MAAA,UAAmB,CAO1B,MAAK,MAAQ,GAAI,OAMX,EAAA,UAAA,QAAP,WAEC,GAAI,EACJ,IAAI,KAAK,QAAU,KAAK,UAAW,CAClC,EAAO,GAAI,EACX,MAAK,MAAM,KAAK,UAAY,IAC1B,KAAK,cACD,CACN,EAAO,KAAK,MAAM,KAAK,UAExB,MAAO,GAMD,GAAA,UAAA,QAAP,WAEC,KAAK,OAAS,EAGR,GAAA,UAAA,QAAP,WAEC,KAAK,MAAM,OAAS,EAEtB,OAAA,KAEA,GAA4B,QAAnB,oOCjDT,IAAO,GAAc,EAAa,yCAClC,IAAO,GAAmB,EAAY,iDAOhC,GAAU,SAAA,GAAS,EAAnB,EAAU,EASf,SATK,KAWJ,EAAA,KAAA,KATM,MAAA,UAAiC,GAAI,OAerC,EAAA,UAAA,aAAP,WAEC,GAAI,GAAuB,KAAK,gBAEhC,MAAK,UAAU,KAAK,EAEpB,OAAO,GAYD,GAAA,UAAA,eAAP,WAEC,KAAM,IAAI,GAGJ,GAAA,UAAA,WAAP,YAID,OAAA,IA5CyB,EA8CzB,GAAoB,QAAX,qRCjDT,IAAO,GAAmB,EAAY,qDAKhC,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAqBxB,SArBK,GAqBO,EAAoB,EAAqB,EAAoB,EAAsB,EAAsB,EAAsB,GAA/H,GAAA,QAAA,GAAkB,CAAlB,EAAA,IAAoB,GAAA,QAAA,GAAmB,CAAnB,EAAA,IAAqB,GAAA,QAAA,GAAkB,CAAlB,EAAA,IAAoB,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAAoB,CAApB,EAAA,KAE1I,EAAA,KAAA,KAEA,MAAK,OAAS,CACd,MAAK,QAAU,CACf,MAAK,OAAS,CACd,MAAK,WAAa,CAClB,MAAK,WAAa,CAClB,MAAK,WAAa,CAClB,MAAK,OAAS,EAMf,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,CAEd,MAAK,2DAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,KAAK,QAAU,CAEf,MAAK,2DAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,CAEd,MAAK,2DAWN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,CAEd,MAAK,2DAMN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAElB,MAAK,sBACL,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAElB,MAAK,sBACL,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAElB,MAAK,sBACL,MAAK,sDAMC,GAAA,UAAA,gBAAP,SAAuB,EAAwB,GAE9C,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,GAAW,EAAW,EAAW,CACrC,IAAI,GAAU,EAAU,EAAa,CAErC,IAAI,GAAa,CACjB,IAAI,GAAW,EAAW,CAC1B,IAAI,GAAW,EAAW,CAE1B,IAAI,EACJ,IAAI,EACJ,IAAI,EAGJ,GAAK,KAAK,OAAO,CACjB,GAAK,KAAK,QAAQ,CAClB,GAAK,KAAK,OAAO,CAEjB,IAAI,GAAgB,sBAAuB,CAE1C,GAAI,GAA6D,CAEjE,KAAgB,KAAK,WAAa,IAAI,KAAK,WAAa,IAAM,KAAK,WAAa,IAAI,KAAK,WAAa,IAAM,KAAK,WAAa,IAAI,KAAK,WAAa,IAAI,CAExJ,IAAe,KAAK,WAAW,KAAK,WAAa,KAAK,WAAW,KAAK,WAAa,KAAK,WAAW,KAAK,YAAY,EAEpH,IAAI,GAAe,EAAiB,aAAe,EAAiB,SAAW,KAAM,CACpF,EAAU,EAAiB,OAC3B,GAAY,EAAiB,SAC7B,GAAU,EAAiB,aAC3B,GAAW,EAAiB,mBACtB,CACN,EAAU,GAAI,OAAc,EAC5B,GAAY,GAAI,OAAc,EAAY,EAC1C,GAAU,GAAI,OAAc,EAAY,EACxC,GAAW,GAAI,OAAc,EAAY,EAEzC,MAAK,kBAGN,EAAO,CACP,GAAO,CAGP,GAAK,KAAK,OAAO,KAAK,UACtB,GAAK,KAAK,QAAQ,KAAK,UACvB,GAAK,KAAK,OAAO,KAAK,UAEtB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,GAAa,EAAK,EAAE,CAEpB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CAEtC,EAAU,GAAQ,CAClB,GAAU,EAAO,IAAM,EAAK,EAAE,CAC9B,GAAU,EAAO,IAAM,CACvB,GAAQ,GAAQ,CAChB,GAAQ,EAAO,GAAK,CACpB,GAAQ,EAAO,IAAM,CACrB,GAAS,GAAQ,CACjB,GAAS,EAAO,GAAK,CACrB,GAAS,EAAO,GAAK,CACrB,IAAQ,CAGR,GAAU,GAAQ,CAClB,GAAU,EAAO,IAAM,EAAK,EAAE,CAC9B,GAAU,EAAO,GAAK,CACtB,GAAQ,GAAQ,CAChB,GAAQ,EAAO,GAAK,CACpB,GAAQ,EAAO,GAAK,CACpB,GAAS,IAAS,CAClB,GAAS,EAAO,GAAK,CACrB,GAAS,EAAO,GAAK,CACrB,IAAQ,CAER,IAAI,GAAK,EAAG,CACX,EAAK,IAAI,EAAI,IAAI,KAAK,WAAa,IAAM,EAAI,GAC7C,GAAK,GAAG,GAAG,KAAK,WAAa,IAAM,EAAI,GACvC,GAAK,EAAK,CACV,GAAK,EAAK,CAEV,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,IAK1B,GAAO,GAAG,KAAK,WAAa,IAAI,KAAK,WAAa,EAElD,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,GAAa,EAAK,EAAE,CAEpB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CAEtC,EAAU,GAAQ,CAClB,GAAU,EAAO,GAAK,CACtB,GAAU,EAAO,IAAM,EAAK,EAAE,CAC9B,GAAQ,GAAQ,CAChB,GAAQ,EAAO,GAAK,CACpB,GAAQ,EAAO,GAAK,CACpB,GAAS,GAAQ,CACjB,GAAS,EAAO,GAAK,CACrB,GAAS,EAAO,GAAK,CACrB,IAAQ,CAGR,GAAU,GAAQ,CAClB,GAAU,EAAO,IAAM,CACvB,GAAU,EAAO,IAAM,EAAK,EAAE,CAC9B,GAAQ,GAAQ,CAChB,GAAQ,EAAO,IAAM,CACrB,GAAQ,EAAO,GAAK,CACpB,GAAS,GAAQ,CACjB,GAAS,EAAO,GAAK,CACrB,GAAS,EAAO,GAAK,CACrB,IAAQ,CAER,IAAI,GAAK,EAAG,CACX,EAAK,EAAM,IAAI,EAAI,IAAI,KAAK,WAAa,IAAM,EAAI,GACnD,GAAK,EAAM,GAAG,GAAG,KAAK,WAAa,IAAM,EAAI,GAC7C,GAAK,EAAK,CACV,GAAK,EAAK,CAEV,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,IAK1B,GAAO,GAAG,KAAK,WAAa,IAAI,KAAK,WAAa,EAElD,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,EAAY,EAAK,EAAE,CAEnB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CAEtC,EAAU,IAAS,CACnB,GAAU,EAAK,IAAM,EAAK,EAAE,CAC5B,GAAU,EAAK,GAAK,CACpB,GAAQ,IAAS,CACjB,GAAQ,EAAK,GAAK,CAClB,GAAQ,EAAK,GAAK,CAClB,GAAS,GAAQ,CACjB,GAAS,EAAK,GAAK,CACnB,GAAS,EAAK,IAAM,CACpB,IAAQ,CAGR,GAAU,GAAQ,CAClB,GAAU,EAAK,IAAM,EAAK,EAAE,CAC5B,GAAU,EAAK,GAAK,CACpB,GAAQ,GAAQ,CAChB,GAAQ,EAAK,GAAK,CAClB,GAAQ,EAAK,GAAK,CAClB,GAAS,GAAQ,CACjB,GAAS,EAAK,GAAK,CACnB,GAAS,EAAK,GAAK,CACnB,IAAQ,CAER,IAAI,GAAK,EAAG,CACX,EAAK,EAAM,IAAI,EAAI,IAAI,KAAK,WAAa,IAAM,EAAI,GACnD,GAAK,EAAM,GAAG,GAAG,KAAK,WAAa,IAAM,EAAI,GAC7C,GAAK,EAAK,CACV,GAAK,EAAK,CAEV,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,CACvB,GAAQ,KAAU,EAAK,IAK1B,EAAiB,cAAc,EAE/B,GAAiB,gBAAgB,EACjC,GAAiB,oBAAoB,EACrC,GAAiB,qBAAqB,OAEhC,IAAI,GAAgB,kBAAmB,CAC7C,GAAI,GAAiD,CAErD,IAAI,GAAqB,KAAK,WAAW,EAAK,KAAK,WAAW,EAAI,KAAK,WAAW,CAClF,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,EAAa,SAAW,MAAQ,GAAe,EAAa,YAAa,CAC5E,EAAiB,EAAa,cAC9B,GAAe,EAAa,YAC5B,GAAY,EAAa,cACnB,CACN,EAAiB,GAAI,OAAc,EAAY,EAC/C,GAAe,GAAI,OAAc,EAAY,EAC7C,GAAY,GAAI,OAAc,GAG/B,EAAO,CAEP,GAAO,CAGP,KAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,IAAS,CACxB,GAAe,EAAO,GAAK,EAAE,KAAK,QAAQ,KAAK,WAAa,CAC5D,GAAe,EAAO,IAAM,CAE5B,GAAa,GAAQ,CACrB,GAAa,EAAO,GAAK,EAAE,KAAK,QAAQ,KAAK,WAAa,CAC1D,GAAa,EAAO,IAAM,CAE1B,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,IAAS,CACxB,GAAe,EAAO,GAAK,EAAK,EAAE,KAAK,QAAQ,KAAK,UACpD,GAAe,EAAO,GAAK,CAE3B,GAAa,GAAQ,CACrB,GAAa,EAAO,GAAK,EAAK,EAAE,KAAK,QAAQ,KAAK,UAClD,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,EAGT,IAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,GAAQ,EAAE,KAAK,OAAO,KAAK,WAAa,CACvD,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,IAAM,CAE5B,GAAa,GAAQ,EAAE,KAAK,OAAO,KAAK,WAAa,CACrD,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,IAAM,CAE1B,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,GAAQ,EAAK,EAAE,KAAK,OAAO,KAAK,UAC/C,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,GAAK,CAE3B,GAAa,GAAQ,EAAK,EAAE,KAAK,OAAO,KAAK,UAC7C,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,EAIT,IAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,IAAS,CACxB,GAAe,EAAO,GAAK,EAAE,KAAK,QAAQ,KAAK,WAAa,CAC5D,GAAe,EAAO,IAAM,CAE5B,GAAa,IAAS,CACtB,GAAa,EAAO,GAAK,EAAE,KAAK,QAAQ,KAAK,WAAa,CAC1D,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,GAAQ,CACvB,GAAe,EAAO,GAAK,EAAK,EAAE,KAAK,QAAQ,KAAK,UACpD,GAAe,EAAO,IAAM,CAE5B,GAAa,GAAQ,CACrB,GAAa,EAAO,GAAK,EAAK,EAAE,KAAK,QAAQ,KAAK,UAClD,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,EAGT,IAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,GAAQ,CACvB,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,GAAK,EAAE,KAAK,OAAO,KAAK,WAAa,CAE3D,GAAa,GAAQ,CACrB,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,GAAK,EAAE,KAAK,OAAO,KAAK,WAAa,CAEzD,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,IAAS,CACxB,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,GAAK,EAAK,EAAE,KAAK,OAAO,KAAK,UAEnD,GAAa,IAAS,CACtB,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,GAAK,EAAK,EAAE,KAAK,OAAO,KAAK,UAEjD,GAAU,KAAU,CAEpB,IAAQ,EAKT,IAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,IAAS,CACxB,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,GAAK,EAAK,EAAE,KAAK,OAAO,KAAK,UAEnD,GAAa,GAAQ,CACrB,GAAa,EAAO,IAAM,CAC1B,GAAa,EAAO,GAAK,EAAK,EAAE,KAAK,OAAO,KAAK,UAEjD,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,IAAS,CACxB,GAAe,EAAO,GAAK,CAC3B,GAAe,EAAO,GAAK,EAAE,KAAK,OAAO,KAAK,WAAa,CAE3D,GAAa,GAAQ,CACrB,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,GAAK,EAAE,KAAK,OAAO,KAAK,WAAa,CAEzD,GAAU,KAAU,CAEpB,IAAQ,EAGT,IAAK,EAAI,EAAG,EAAI,KAAK,aAAc,EAAG,CACrC,EAAe,GAAQ,EAAK,EAAE,KAAK,OAAO,KAAK,UAC/C,GAAe,EAAO,IAAM,CAC5B,GAAe,EAAO,IAAM,CAE5B,GAAa,GAAQ,EAAK,EAAE,KAAK,OAAO,KAAK,UAC7C,GAAa,EAAO,IAAM,CAC1B,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,CAER,GAAe,GAAQ,EAAE,KAAK,OAAO,KAAK,WAAa,CACvD,GAAe,EAAO,GAAK,CAC3B,GAAe,EAAO,IAAM,CAE5B,GAAa,GAAQ,EAAE,KAAK,OAAO,KAAK,WAAa,CACrD,GAAa,EAAO,GAAK,CACzB,GAAa,EAAO,GAAK,CAEzB,GAAU,KAAU,CAEpB,IAAQ,EAIT,EAAa,gBAAgB,EAAgB,EAC7C,GAAa,gBAAgB,IAOxB,GAAA,UAAA,WAAP,SAAkB,EAAwB,GAEzC,GAAI,GAAU,EAAU,CACxB,IAAI,EAEJ,IAAI,GAAmB,CACvB,IAAI,GAAoB,CACxB,IAAI,GAAa,CACjB,IAAI,GAAa,CACjB,IAAI,GAAW,CACf,IAAI,EAEJ,IAAI,GAAgB,sBAAuB,CAE1C,IAAgB,KAAK,WAAa,IAAI,KAAK,WAAa,IAAM,KAAK,WAAa,IAAI,KAAK,WAAa,IAAM,KAAK,WAAa,IAAI,KAAK,WAAa,IAAI,CAExJ,IAAI,GAA6D,CAEjE,IAAI,GAAe,EAAiB,aAAe,EAAiB,KAAO,KAAM,CAChF,EAAM,EAAiB,QACjB,CACN,EAAM,GAAI,OAAc,EAAY,GAGrC,GAAI,KAAK,OAAQ,CAChB,EAAa,EAAc,EAAE,CAC7B,GAAa,EAAc,EAAE,MACvB,CACN,EAAa,EAAa,CAC1B,GAAc,EAAc,EAe7B,EAAQ,CAGR,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAK,EAAW,KAAK,UACrB,GAAK,EAAW,KAAK,UACrB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,IAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,EAAI,MAAa,EAAO,EAAE,GAAK,EAAiB,MAChD,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,MAE9D,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,MAC9D,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,QAKhE,EAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAK,EAAW,KAAK,UACrB,GAAK,EAAW,KAAK,UACrB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,IAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,EAAI,MAAa,EAAO,EAAE,GAAI,EAAiB,MAC/C,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,MAE9D,GAAI,MAAa,EAAO,EAAE,GAAI,EAAiB,MAC/C,GAAI,MAAa,EAAO,EAAE,GAAI,EAAiB,QAKjD,EAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAO,EAAE,CACT,GAAK,EAAW,KAAK,UACrB,GAAK,EAAW,KAAK,UACrB,KAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,IAAK,EAAI,EAAG,GAAK,KAAK,WAAY,IAAK,CACtC,EAAI,MAAa,EAAO,EAAE,GAAI,EAAiB,MAC/C,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,MAE9D,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,MAC9D,GAAI,MAAa,GAAQ,EAAa,EAAE,IAAK,EAAiB,QAIhE,EAAiB,UAAU,OAErB,IAAI,GAAgB,kBAAmB,GAIhD,OAAA,IAjpBkC,EAmpBlC,GAA6B,QAApB,4OC7pBT,IAAO,GAAS,EAAc,oCAC9B,IAAO,GAAmB,EAAY,6CAGtC,IAAO,GAAQ,EAAe,mCAE9B,IAAO,GAAmB,EAAY,8CACtC,IAAO,GAAe,EAAa,0CACnC,IAAO,GAAI,EAAgB,mCAE3B,IAAO,GAAU,EAAc,4CAKzB,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAsExB,SAtEK,GAsEO,EAA8B,GAA9B,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAA8B,GAAA,QAAA,GAA2C,CAA3C,EAAA,sBAEzC,EAAA,KAAA,KAtEM,MAAA,WAAqB,IACrB,MAAA,SAAmB,IAMlB,MAAA,mBAA6B,IAiEpC,MAAK,UAAY,GAAI,EACrB,MAAK,UAAY,CACjB,MAAK,cAAgB,EA7DtB,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,qDAMlB,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,6DAGN,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,KAAK,YAEL,OAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,GAAS,KAAK,UACjB,MAED,MAAK,UAAY,CAEjB,IAAI,GAAa,KAAK,UAAU,MAChC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IACvB,KAAK,UAAU,GAAI,SAAW,KAAK,8CAqBtC,GAAA,UAAA,gBAAP,SAAuB,EAAwB,GAE9C,KAAM,IAAI,GAOJ,GAAA,UAAA,WAAP,SAAkB,EAAwB,GAEzC,KAAM,IAAI,GAMJ,GAAA,UAAA,uBAAP,WAEC,KAAK,mBAAqB,IAC1B,MAAK,WAAa,IAClB,MAAK,SAAW,KAMV,GAAA,UAAA,qBAAP,WAEC,KAAK,WAAa,KAMZ,GAAA,UAAA,gBAAP,WAEC,KAAK,SAAW,KAMT,GAAA,UAAA,mBAAR,WAGC,GAAI,KAAK,aACR,KAAK,UAAU,kBAAkB,KAAK,aAEvC,IAAI,KAAK,eAAiB,sBAAuB,CAChD,GAAI,GAAuC,GAAI,GAAoB,KACnE,GAAiB,kBAAoB,KACrC,GAAiB,mBAAqB,KACtC,GAAiB,cAAgB,KACjC,MAAK,UAAU,eAAe,EAC9B,MAAK,aAAe,MACd,IAAI,KAAK,eAAiB,kBAAmB,CACnD,KAAK,UAAU,eAAe,KAAK,aAAe,GAAI,IAGvD,KAAK,mBAAqB,MAOnB,GAAA,UAAA,eAAR,WAEC,KAAK,gBAAgB,KAAK,aAAc,KAAK,cAE7C;KAAK,WAAa,MAMX,GAAA,UAAA,UAAR,WAEC,KAAK,WAAW,KAAK,aAAc,KAAK,cAExC,MAAK,SAAW,MAGV,GAAA,UAAA,WAAP,WAEC,GAAI,KAAK,mBACR,KAAK,oBAEN,IAAI,KAAK,WACR,KAAK,gBAEN,IAAI,KAAK,SACR,KAAK,YAIA,GAAA,UAAA,eAAP,WAEC,GAAI,GAAY,GAAI,GAAK,KAAK,UAAW,KAAK,UAC9C,GAAK,eAAiB,IAEtB,OAAO,GAWT,OAAA,IApMkC,EAsML,GAAA,QAApB,qeCjNT,IAAO,GAAmB,EAAY,qDAKhC,GAAoB,SAAA,GAAS,EAA7B,EAAoB,EAyFzB,SAzFK,GAyFO,EAAoB,EAAwB,EAAuB,EAAsB,GAAzF,GAAA,QAAA,GAAkB,CAAlB,EAAA,GAAoB,GAAA,QAAA,GAAsB,CAAtB,EAAA,GAAwB,GAAA,QAAA,GAAqB,CAArB,EAAA,GAAuB,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAAkB,CAAlB,EAAA,KAEpG,EAAA,KAAA,KApFO,MAAA,aAAsB,CAsF7B,MAAK,QAAU,CACf,MAAK,YAAc,CACnB,MAAK,WAAa,CAClB,MAAK,WAAa,CAClB,MAAK,KAAO,EArFb,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,KAAK,QAAU,CACf,MAAK,2DAMN,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,KAAK,YAAc,CACnB,MAAK,2DAMN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAClB,MAAK,sBACL,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAClB,MAAK,sBACL,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,WAAX,WAEC,MAAO,MAAK,UAGb,SAAe,GAEd,KAAK,KAAO,CACZ,MAAK,2DA0BC,GAAA,UAAA,gBAAP,SAAuB,EAAwB,GAE9C,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,IAAI,GAAU,CACd,IAAI,GAAU,EAAU,EAAU,EAAW,EAAW,EAAW,EAAyB,CAC5F,IAAI,EACJ,IAAI,EACJ,IAAI,GAAoB,CAExB,IAAI,GAAgB,sBAAuB,CAE1C,GAAI,GAA6D,CAGjE,MAAK,cAAgB,KAAK,WAAa,IAAI,KAAK,WAAa,EAC7D,GAAa,KAAK,WAAW,KAAK,WAAW,CAG7C,IAAI,KAAK,cAAgB,EAAiB,YAAa,CACtD,EAAU,EAAiB,OAC3B,GAAY,EAAiB,SAC7B,GAAU,EAAiB,aAC3B,GAAW,EAAiB,mBACtB,CACN,EAAU,GAAI,OAAc,EAC5B,GAAY,GAAI,OAAc,KAAK,aAAa,EAChD,GAAU,GAAI,OAAc,KAAK,aAAa,EAC9C,GAAW,GAAI,OAAc,KAAK,aAAa,EAE/C,MAAK,kBAIN,EAAO,CACP,GAAO,KAGH,GAA+B,EAAE,KAAK,GAAG,KAAK,UAClD,IAAI,GAA+B,EAAE,KAAK,GAAG,KAAK,UAElD,IAAI,GAAc,CAClB,IAAI,GAAW,EAAW,EAAW,CACrC,IAAI,GAAoB,CACxB,IAAI,GAAyB,KAGzB,GAAU,EAAU,EAAU,EAAU,CAE5C,KAAK,EAAI,EAAG,GAAK,KAAK,aAAc,EAAG,CAEtC,EAAa,EAAgB,CAE7B,KAAK,EAAI,EAAG,GAAK,KAAK,aAAc,EAAG,CAGtC,EAAmB,EAAE,CACrB,GAAmB,EAAE,CAErB,GAAS,KAAK,IAAI,EAClB,GAAK,EAAO,KAAK,IAAI,EACrB,GAAK,EAAO,KAAK,IAAI,EACrB,GAAK,KAAK,IAAI,EAEd,GAAI,KAAK,QAAQ,KAAK,IAAI,GAAoB,KAAK,YAAY,CAC/D,GAAI,KAAK,QAAQ,KAAK,IAAI,GAAoB,KAAK,YAAY,CAC/D,GAAK,GAAK,KAAK,WAAa,EAAI,KAAK,YAAY,CAEjD,IAAI,KAAK,KAAM,CAEd,GAAM,CACN,GAAK,CACL,GAAK,CACL,GAAM,EAAQ,EAAG,EAAS,EAAE,KAAK,OACjC,IAAS,CACT,GAAQ,MAEF,CACN,EAAK,CACL,GAAK,CACL,GAAM,EAAQ,EAAG,EAAS,EAAE,KAAK,OACjC,GAAK,CACL,GAAQ,CACR,GAAQ,EAGT,GAAI,GAAK,KAAK,WAAY,CACzB,EAAU,GAAQ,CAClB,GAAU,EAAO,GAAK,EAAU,EAAa,EAC7C,GAAU,EAAO,GAAK,EAAU,EAAa,OACvC,CACN,EAAU,GAAQ,CAClB,GAAU,EAAO,GAAK,CACtB,GAAU,EAAO,GAAK,EAGvB,EAAQ,GAAQ,CAChB,GAAQ,EAAO,GAAK,CACpB,GAAQ,EAAO,GAAK,CACpB,GAAS,KAAU,EAAQ,EAAG,EAAS,EAAE,KAAK,QAC9C,GAAS,EAAO,GAAK,CACrB,GAAS,EAAO,GAAK,CAErB,IAAQ,CAGR,IAAI,EAAI,GAAK,EAAI,EAAG,CACnB,EAAI,CACJ,GAAI,EAAkB,CACtB,GAAI,EAAI,KAAK,WAAa,CAC1B,GAAI,EAAI,KAAK,WAAa,CAE1B,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAElB,GAAQ,KAAU,CAClB,GAAQ,KAAU,CAClB,GAAQ,KAAU,EAGnB,KAKF,EAAiB,cAAc,EAE/B,GAAiB,gBAAgB,EACjC,GAAiB,oBAAoB,EACrC,GAAiB,qBAAqB,OAEhC,IAAI,GAAgB,kBAAmB,GAQxC,GAAA,UAAA,WAAP,SAAkB,EAAwB,GAGzC,GAAI,GAAU,CACd,IAAI,EAGJ,IAAI,GAAgB,sBAAuB,CAE1C,GAAI,GAA6D,CAGjE,IAAI,EAAiB,KAAO,KAAK,cAAgB,EAAiB,YAAa,CAC9E,EAAM,EAAiB,QACjB,CACN,EAAM,GAAI,OAAc,KAAK,aAAa,MAIvC,GAAe,CAGnB,KAAK,EAAI,EAAG,GAAK,KAAK,aAAc,EAAG,CACtC,IAAK,EAAI,EAAG,GAAK,KAAK,aAAc,EAAG,CAEtC,EAAI,KAAa,EAAE,KAAK,WAAa,EAAiB,MACtD,GAAI,KAAa,EAAE,KAAK,WAAa,EAAiB,QAKxD,EAAiB,UAAU,OAErB,IAAI,GAAgB,kBAAmB,GAIhD,OAAA,IA5RmC,EA8RnC,GAA8B,QAArB,8ECnST,GAAO,GAAkB,EAAa,iDAUhC,GAAa,WAalB,QAbK,KASG,KAAA,eAAwB,CACzB,MAAA,cAAuB,CACvB,MAAA,yBAAkC,CAIxC,MAAK,qBAAuB,GAAI,GAMjC,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,KAAK,SAAW,CAChB,MAAK,YAAc,KAAK,SAAS,kDAMlC,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,uBAGb,SAAsB,GAErB,KAAK,kBAAoB,sCAM1B,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,6DAMN,GAAA,UAAA,MAAP,WAEC,KAAK,cAAgB,KAAK,yBAA2B,CACrD,MAAK,YAAc,KAAK,kBAAmB,KAAK,kBAAsB,KAAK,SAAU,KAAK,SAAS,cAAgB,IACnH,MAAK,eAAiB,KAAK,YAAa,KAAK,YAAY,OAAS,CAClE,MAAK,aAAe,IACpB,MAAK,qBAAqB,UAQpB,GAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,GAAgB,KAAK,MAAM,kBAAoB,EAAK,kBAAoB,EAAK,YAAY,KAAK,YAAa,KAAK,eAEpH,GAAK,iBAAmB,KAAK,MAAM,gBAEnC,OAAO,GAOD,GAAA,UAAA,sBAAP,SAA6B,IAStB,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,eAEL,IAAI,EAAO,mBACV,KAAK,0BAEN,IAAI,GAAsB,KAAK,qBAAqB,SACpD,GAAK,OAAS,CAEd,GAAK,KAAO,KAAK,YACjB,MAAK,aAAe,EAOd,GAAA,UAAA,gBAAP,SAAuB,IAShB,GAAA,UAAA,gBAAP,SAAuB,IAShB,GAAA,UAAA,YAAP,SAAmB,IAIpB,OAAA,KAEA,GAAuB,QAAd,wOCpKT,IAAO,GAAQ,EAAgB,gCAG/B,IAAO,GAAa,EAAc,gDAa5B,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAoCrB,SApCK,KAsCJ,EAAA,KAAA,KApCO,MAAA,aAAwB,GAAI,EAC5B,MAAA,cAAyB,GAAI,EAE9B,MAAA,iBAA0B,EAKjC,OAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,KAAK,aAAe,sCAMrB,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,sCAgBf,GAAA,UAAA,UAAP,SAAiB,GAEhB,MAAO,GAAK,kBAAkB,KAAK,aAAc,KAAK,eAExD,OAAA,IAlD+B,EAoDL,GAAA,QAAjB,2QCnET,IAAO,GAAa,EAAc,gDAK5B,GAAqB,SAAA,GAAS,EAA9B,EAAqB,EAE1B,SAFK,KAIJ,EAAA,KAAA,MAMM,EAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,GAAgB,KAAK,MAAM,kBAAoB,EAAK,kBAAoB,EAAK,iBAEjF,KAAK,EAAO,CACX,EAAK,iBAAmB,KAAK,MAAM,gBAEnC,OAAO,OAGR,MAAO,GAAA,UAAM,UAAS,KAAA,KAAC,GAEzB,OAAA,IAtBoC,EAwBL,GAAA,QAAtB,icC9BT,IAAO,GAAkB,EAAa,4CAEtC,IAAO,GAAa,EAAc,qCAClC,IAAO,GAAmB,EAAa,2CAEvC,IAAO,GAAQ,EAAgB,oCAMzB,GAAsB,SAAA,GAAS,EAA/B,EAAsB,EAY3B,SAZK,KAcJ,EAAA,KAAA,KAZO,MAAA,SAAkB,CAClB,MAAA,SAAkB,CAClB,MAAA,SAAkB,CAClB,MAAA,cAAuB,CACvB,MAAA,cAAuB,CACvB,MAAA,cAAuB,EAaxB,EAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,MAAK,SAAW,KAAK,SAAW,KAAK,SAAW,CAChD,MAAK,cAAgB,KAAK,cAAgB,KAAK,cAAgB,EAMzD,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAa,EAAG,CAE1C,GAAI,GAAgB,EAAO,EAC3B,IAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAwB,EAAI,GAAI,KAAK,cAAgB,KAAK,aAC9D,IAAI,GAAwB,EAAI,GAAI,KAAK,cAAgB,KAAK,aAC9D,IAAI,GAAwB,EAAI,GAAI,KAAK,cAAgB,KAAK,aAC9D,IAAI,GAAkB,GAAG,KAAK,SAAW,GAAkB,GAAG,KAAK,SAAW,GAAkB,GAAG,KAAK,SAAW,GAAkB,EAAM,CAE3I,IAAI,EAAW,EACd,MAAO,OAGT,MAAO,MAGD,GAAA,UAAA,gBAAP,SAAuB,EAAmB,EAAoB,GAG7D,GAAI,KAAK,cAAc,GACtB,MAAO,EAER,IAAI,GAAY,EAAS,EAAI,KAAK,QAClC,IAAI,GAAY,EAAS,EAAI,KAAK,QAClC,IAAI,GAAY,EAAS,EAAI,KAAK,QAElC,IAAI,GAAY,EAAU,CAC1B,IAAI,GAAY,EAAU,CAC1B,IAAI,GAAY,EAAU,CAE1B,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,MAGA,EACJ,IAAI,EAAK,EAAG,CACX,GAAqB,KAAK,cAAgB,GAAK,CAC/C,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,EAAI,CAEjB,GAAa,OAIhB,IAAK,GAAc,EAAK,EAAG,CAC1B,IAAsB,KAAK,cAAgB,GAAK,CAChD,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,GAAK,CAClB,GAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,OAIhB,IAAK,GAAc,EAAK,EAAG,CAC1B,GAAqB,KAAK,cAAgB,GAAK,CAC/C,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,OAIhB,IAAK,GAAc,EAAK,EAAG,CAC1B,IAAsB,KAAK,cAAgB,GAAK,CAChD,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,EAAI,CACjB,GAAa,GAAK,CAClB,GAAa,EAAI,CACjB,GAAa,OAIhB,IAAK,GAAc,EAAK,EAAG,CAC1B,GAAqB,KAAK,cAAgB,GAAK,CAC/C,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,OAIhB,IAAK,GAAc,EAAK,EAAG,CAC1B,IAAsB,KAAK,cAAgB,GAAK,CAChD,IAAI,EAAmB,EAAG,CACzB,EAAK,EAAK,EAAiB,CAC3B,GAAK,EAAK,EAAiB,CAC3B,IAAI,GAAM,KAAK,eAAiB,EAAK,KAAK,eAAiB,GAAM,KAAK,eAAiB,EAAK,KAAK,cAAe,CAC/G,EAAa,EAAI,CACjB,GAAa,EAAI,CACjB,GAAa,GAAK,CAClB,GAAa,OAKhB,MAAO,GAAY,GAAoB,EAMjC,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,GAAY,EAAS,EAAI,KAAK,SAAU,EAAY,EAAS,EAAI,KAAK,SAAU,EAAY,EAAS,EAAI,KAAK,QAClH,OAAO,IAAM,KAAK,eAAiB,IAAO,KAAK,eAAiB,GAAM,KAAK,eAAiB,IAAO,KAAK,eAAiB,GAAM,KAAK,eAAiB,IAAO,KAAK,cAM3J,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAa,EAAa,EAAa,EAAa,GAGpF,KAAK,UAAY,EAAO,GAAM,EAC9B,MAAK,UAAY,EAAO,GAAM,EAC9B,MAAK,UAAY,EAAO,GAAM,EAC9B,MAAK,eAAiB,EAAO,GAAM,EACnC,MAAK,eAAiB,EAAO,GAAM,EACnC,MAAK,eAAiB,EAAO,GAAM,EAEnC,GAAA,UAAM,aAAY,KAAA,KAAC,EAAM,EAAM,EAAM,EAAM,EAAM,GAO3C,GAAA,UAAA,MAAP,WAEC,GAAI,GAA+B,GAAI,EACvC,GAAM,aAAa,KAAK,MAAM,EAAG,KAAK,MAAM,EAAI,KAAK,MAAM,OAAQ,KAAK,MAAM,EAAG,KAAK,MAAM,EAAI,KAAK,MAAM,MAAO,KAAK,MAAM,EAAG,KAAK,MAAM,EAAI,KAAK,MAAM,MAC1J,OAAO,GAGR,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAGb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAGb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDASN,GAAA,UAAA,oBAAP,SAA2B,EAAgB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAE1C,GAAI,EAEJ,IAAI,GAAU,KACb,EAAS,GAAI,EAEd,GAAI,EAAM,CACV,IAAI,EAAI,KAAK,MAAM,EAClB,EAAI,KAAK,MAAM,CAChB,IAAI,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,MACjC,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,KAC/B,GAAO,EAAI,CAEX,GAAI,EAAM,CACV,IAAI,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,OACjC,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,MAC/B,IAAI,EAAI,KAAK,MAAM,EAClB,EAAI,KAAK,MAAM,CAChB,GAAO,EAAI,CAEX,GAAI,EAAM,CACV,IAAI,EAAI,KAAK,MAAM,EAClB,EAAI,KAAK,MAAM,CAChB,IAAI,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,MACjC,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,KAC/B,GAAO,EAAI,CAEX,OAAO,GAGD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAwB,EAAE,KAAK,SAAW,EAAE,KAAK,SAAW,EAAE,KAAK,SAAW,EAAM,CAExF,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,GAAqB,EAAE,KAAK,cAAgB,EAAE,KAAK,cAAgB,EAAE,KAAK,aAE9E,OAAO,GAAiB,EAAa,EAAoB,MAAQ,GAAkB,EAAa,EAAoB,KAAO,EAAoB,UAGzI,GAAA,UAAA,cAAP,SAAqB,EAA2B,GAE/C,GAAI,GAAuD,CAC3D,IAAI,GAAY,EAAK,QACrB,IAAI,GAAY,EAAK,QACrB,IAAI,GAAY,EAAK,QACrB,IAAI,GAAe,EAAc,kBAEjC,GAAO,cAAc,EAErB,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GACpF,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GACpF,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,IAAK,EAAa,EAAI,GAErF,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAC3C,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAC3C,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAE3C,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,GAAY,EAAK,aACrB,IAAI,GAAY,EAAK,aACrB,IAAI,GAAY,EAAK,aACrB,MAAK,cAAgB,EAAG,EAAM,EAAG,EAAM,EAAG,CAC1C,MAAK,cAAgB,EAAG,EAAM,EAAG,EAAM,EAAG,CAC1C,MAAK,cAAgB,EAAG,EAAM,EAAG,EAAM,EAAG,CAE1C,MAAK,MAAM,MAAQ,KAAK,MAAM,OAAS,KAAK,MAAM,MAAQ,KAAK,cAAc,CAC7E,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,aACpC,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,aACpC,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,cAEtC,OAAA,IAxTqC,EA0TrC,GAAgC,QAAvB,mWCrUT,IAAO,GAAkB,EAAa,4CAGtC,IAAO,GAAmB,EAAa,2CAEvC,IAAO,GAAQ,EAAgB,gCAE/B,IAAM,GAAc,SAAA,GAAS,EAAvB,EAAc,EAQnB,SARK,KAUJ,EAAA,KAAA,KAPO,MAAA,QAAiB,CACjB,MAAA,SAAkB,CAClB,MAAA,SAAkB,CAClB,MAAA,SAAkB,EAO1B,OAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAGN,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KACb,MAAK,SAAW,KAAK,SAAW,KAAK,SAAW,CAChD,MAAK,QAAU,EAGT,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAa,EAAG,CAC1C,GAAI,GAAgB,EAAO,EAC3B,IAAI,GAAwB,EAAM,EAAI,GAAI,KAAK,QAAU,KAAK,OAC9D,IAAI,GAAwB,EAAM,EAAI,GAAI,KAAK,QAAU,KAAK,OAC9D,IAAI,GAAwB,EAAM,EAAI,GAAI,KAAK,QAAU,KAAK,OAC9D,IAAI,GAAkB,EAAM,GAAI,KAAK,SAAW,GAAmB,EAAM,GAAI,KAAK,SAAW,GAAkB,EAAM,GAAI,KAAK,SAAW,GAAmB,EAAM,CAClK,IAAI,EAAW,EAAG,CACjB,MAAO,QAGT,MAAO,MAGD,GAAA,UAAA,WAAP,SAAkB,EAAiB,GAElC,KAAK,SAAW,EAAO,CACvB,MAAK,SAAW,EAAO,CACvB,MAAK,SAAW,EAAO,CACvB,MAAK,QAAU,CACf,MAAK,MAAM,MAAQ,KAAK,MAAM,OAAS,KAAK,MAAM,MAAQ,EAAO,CACjE,MAAK,MAAM,EAAI,KAAK,SAAW,CAC/B,MAAK,MAAM,EAAI,KAAK,SAAW,CAC/B,MAAK,MAAM,EAAI,KAAK,SAAW,CAC/B,MAAK,kBAAoB,KAGnB,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAa,EAAa,EAAa,EAAa,GAEpF,KAAK,UAAY,EAAO,GAAM,EAC9B,MAAK,UAAY,EAAO,GAAM,EAC9B,MAAK,UAAY,EAAO,GAAM,EAE9B,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CAEtB,IAAI,EAAI,EACP,EAAI,CAEL,IAAI,EAAI,EACP,EAAI,CAEL,MAAK,QAAU,EAAE,KAAK,KAAK,GAC3B,GAAA,UAAM,aAAY,KAAA,KAAC,EAAM,EAAM,EAAM,EAAM,EAAM,GAG3C,GAAA,UAAA,MAAP,WAEC,GAAI,GAAuB,GAAI,EAC/B,GAAM,WAAW,GAAI,GAAS,KAAK,SAAU,KAAK,SAAU,KAAK,UAAW,KAAK,QACjF,OAAO,GAGD,GAAA,UAAA,gBAAP,SAAuB,EAAmB,EAAoB,GAE7D,GAAI,KAAK,cAAc,GAAW,CACjC,MAAO,GAGR,GAAI,GAAY,EAAS,EAAI,KAAK,SAAU,EAAY,EAAS,EAAI,KAAK,SAAU,EAAY,EAAS,EAAI,KAAK,QAClH,IAAI,GAAY,EAAU,EAAG,EAAY,EAAU,EAAG,EAAY,EAAU,CAC5E,IAAI,EAEJ,IAAI,GAAW,EAAG,EAAK,EAAG,EAAK,EAAG,CAClC,IAAI,GAAW,GAAI,EAAG,EAAK,EAAG,EAAK,EAAG,EACtC,IAAI,GAAW,EAAG,EAAK,EAAG,EAAK,EAAG,EAAK,KAAK,QAAQ,KAAK,OACzD,IAAI,GAAa,EAAE,EAAI,EAAE,EAAE,CAE3B,IAAI,GAAO,EAAG,CACb,GAAI,GAAiB,KAAK,KAAK,EAC/B,KAAsB,EAAI,IAAY,EAAE,EACxC,IAAI,GAAoB,EAAG,CAC1B,EAAa,EAAI,EAAK,EAAiB,CACvC,GAAa,EAAI,EAAK,EAAiB,CACvC,GAAa,EAAI,EAAK,EAAiB,CACvC,GAAa,WAEb,OAAO,IAKT,OAAQ,EAGF,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,GAAY,EAAS,EAAI,KAAK,QAClC,IAAI,GAAY,EAAS,EAAI,KAAK,QAClC,IAAI,GAAY,EAAS,EAAI,KAAK,QAClC,IAAI,GAAkB,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EACnD,OAAO,IAAY,KAAK,QAIlB,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAW,EAAM,CACrB,IAAI,GAAY,EAAE,KAAK,SAAW,EAAE,KAAK,SAAW,EAAE,KAAK,SAAW,EAAM,CAE5E,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,EAAI,EACP,GAAK,CAEN,IAAI,IAAa,EAAI,EAAI,GAAG,KAAK,OAEjC,OAAO,GAAK,EAAI,EAAoB,MAAQ,GAAM,EAAI,EAAoB,KAAO,EAAoB,UAG/F,GAAA,UAAA,cAAP,SAAqB,EAA2B,GAE/C,GAAI,GAAyC,CAC7C,IAAI,GAAY,EAAO,QACvB,IAAI,GAAY,EAAO,QACvB,IAAI,GAAY,EAAO,QACvB,IAAI,GAAoB,GAAI,OAAc,GAE1C,GAAO,cAAc,EAErB,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GACpF,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,GACpF,IAAI,GAAa,EAAI,GAAI,EAAa,EAAI,GAAI,EAAa,EAAI,IAAK,EAAa,EAAI,GAErF,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAC3C,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAC3C,MAAK,SAAW,EAAG,EAAM,EAAG,EAAM,EAAG,EAAM,CAE3C,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CACR,IAAI,EAAM,EACT,GAAO,CAER,IAAI,GAAW,EAAO,OACtB,IAAI,GAAY,EAAM,EAAM,CAC5B,IAAI,GAAY,EAAM,EAAM,CAC5B,IAAI,GAAY,EAAM,EAAM,CAC5B,MAAK,QAAU,EAAE,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,EAE9C,MAAK,MAAM,MAAQ,KAAK,MAAM,OAAS,KAAK,MAAM,MAAQ,KAAK,QAAQ,CACvE,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,OACpC,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,OACpC,MAAK,MAAM,EAAI,KAAK,SAAW,KAAK,QAEtC,OAAA,IA/L6B,EAiM7B,GAAwB,QAAf,4JCxMT,GAAO,GAAG,EAAiB,2BAI3B,IAAO,GAAmB,EAAa,6CAEvC,IAAM,GAAkB,WAMvB,QANK,KAGE,KAAA,aAA6B,GAAI,MACjC,MAAA,kBAA4B,IAIlC,MAAK,MAAQ,GAAI,GAGlB,OAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAGb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,GAAI,KAAK,kBACR,KAAK,mBAEN,OAAO,MAAK,iDAGN,GAAA,UAAA,QAAP,WAEC,KAAK,MAAM,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,EAAI,CAC7C,MAAK,MAAM,MAAQ,KAAK,MAAM,OAAS,KAAK,MAAM,MAAQ,CAC1D,MAAK,kBAAoB,KAGnB,GAAA,UAAA,aAAP,SAAoB,GAEnB,GAAI,EACJ,IAAI,GAAa,EAAS,MAC1B,IAAI,GAAa,EAAa,CAC9B,IAAI,GAAa,EAAa,CAE9B,IAAI,GAAO,EAAG,CACb,KAAK,SACL,QAGD,GAAI,EAEJ,GAAO,EAAO,EAAS,IACvB,GAAO,EAAO,EAAS,IACvB,GAAO,EAAO,EAAS,IAEvB,OAAO,EAAI,EAAK,CACf,EAAI,EAAS,IACb,IAAI,EAAI,EACP,EAAO,MAAQ,IAAI,EAAI,EACvB,EAAO,CACR,GAAI,EAAS,IACb,IAAI,EAAI,EACP,EAAO,MAAQ,IAAI,EAAI,EACvB,EAAO,CACR,GAAI,EAAS,IACb,IAAI,EAAI,EACP,EAAO,MAAQ,IAAI,EAAI,EACvB,EAAO,EAGT,KAAK,aAAa,EAAM,EAAM,EAAM,EAAM,EAAM,GAG1C,GAAA,UAAA,WAAP,SAAkB,EAAiB,GAElC,KAAK,aAAa,EAAO,EAAI,EAAQ,EAAO,EAAI,EAAQ,EAAO,EAAI,EAAQ,EAAO,EAAI,EAAQ,EAAO,EAAI,EAAQ,EAAO,EAAI,GAGtH,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAa,EAAa,EAAa,EAAa,GAEpF,KAAK,MAAM,EAAI,CACf,MAAK,MAAM,EAAI,CACf,MAAK,MAAM,EAAI,CACf,MAAK,MAAM,MAAQ,EAAO,CAC1B,MAAK,MAAM,OAAS,EAAO,CAC3B,MAAK,MAAM,MAAQ,EAAO,CAC1B,MAAK,kBAAoB,KAGnB,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,KAAM,IAAI,GAGJ,GAAA,UAAA,SAAP,SAAgB,GAEf,MAAO,MAAK,MAAM,WAAW,EAAO,MAG9B,GAAA,UAAA,MAAP,WAEC,KAAM,IAAI,GAGJ,GAAA,UAAA,gBAAP,SAAuB,EAAmB,EAAoB,GAE7D,OAAQ,EAGF,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAO,OAGD,GAAA,UAAA,kBAAP,WAEC,GAAI,GAAc,KAAK,MAAM,CAC7B,IAAI,GAAc,KAAK,MAAM,EAAI,KAAK,MAAM,MAC5C,IAAI,GAAc,KAAK,MAAM,CAC7B,IAAI,GAAc,KAAK,MAAM,EAAI,KAAK,MAAM,KAC5C,IAAI,GAAc,KAAK,MAAM,CAC7B,IAAI,GAAc,KAAK,MAAM,EAAI,KAAK,MAAM,KAE5C,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,GAAK,CACvB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,aAAa,IAAM,CACxB,MAAK,kBAAoB,MAGnB,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAM,IAAI,GAGJ,GAAA,UAAA,cAAP,SAAqB,EAA2B,GAE/C,KAAM,IAAI,GAEZ,OAAA,KAE4B,GAAA,QAAnB,uQCjKT,IAAO,GAAkB,EAAa,4CAEtC,IAAO,GAAmB,EAAa,2CAIvC,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAIf,SAJK,GAIO,GAAA,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAEX,EAAA,KAAA,KAEA,MAAK,UAAY,CAEjB,MAAK,MAAM,MAAQ,KAAK,MAAM,OAAS,KAAK,MAAM,MAAQ,OAAO,iBACjE,MAAK,MAAM,EAAI,KAAK,MAAM,EAAI,KAAK,MAAM,EAAI,KAAK,UAAW,OAAO,kBAAkB,EAAI,OAAO,kBAI3F,EAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAW,KAAK,WAIrB,GAAA,UAAA,YAAP,SAAmB,EAAuB,GAEzC,MAAO,MAAK,UASN,GAAA,UAAA,WAAP,SAAkB,EAAiB,IAK5B,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAa,EAAa,EAAa,EAAa,IAI9E,GAAA,UAAA,gBAAP,SAAuB,GAEtB,MAAO,GAAoB,UAIrB,GAAA,UAAA,cAAP,SAAqB,EAA2B,GAE/C,KAAK,UAA0B,EAAQ,UAEzC,OAAA,IAnDyB,EAqDzB,GAAoB,QAAX,sxBC3DT,IAAO,GAAK,EAAe,mCAMrB,GAA0B,SAAA,GAAS,EAAnC,EAA0B,EAO/B,SAPK,GAOO,EAAwB,GAAxB,GAAA,QAAA,GAAsB,CAAtB,EAAA,GAAwB,GAAA,QAAA,GAAa,CAAb,EAAA,EAEnC,EAAA,KAAA,KAAM,sFAAwF,EAAY,GAE5G,MAAA,IAXyC,EAazC,GAAoC,QAA3B,4NCnBT,IAAO,GAAK,EAAe,mCAMrB,GAAU,SAAA,GAAS,EAAnB,EAAU,EAQf,SARK,GAQO,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,KAAuB,GAAA,QAAA,GAAa,CAAb,EAAA,EAElC,EAAA,KAAA,KAAM,GAAW,aAAc,GAEjC,MAAA,IAZyB,EAczB,GAAoB,QAAX,+sBCpBT,GAAO,GAAQ,EAAe,oCA8BxB,GAAG,WAsOR,QAtOK,GAsOO,EAAc,EAAc,EAAc,EAAkB,EAAmB,GAA/E,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAiB,CAAjB,EAAA,EAAmB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAE1F,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,CACd,MAAK,MAAQ,EA9Kd,OAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,EAAI,KAAK,WAGtB,SAAgB,GAEf,KAAK,MAAQ,EAAM,KAAK,sCAMzB,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,EAAI,KAAK,YAGtB,SAAkB,GAEjB,KAAK,OAAS,EAAM,KAAK,sCAO1B,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,GAAI,KAAK,kBAAoB,KAC5B,KAAK,iBAAmB,GAAI,EAE7B,MAAK,iBAAiB,EAAI,KAAK,EAAI,KAAK,KACxC,MAAK,iBAAiB,EAAI,KAAK,EAAI,KAAK,MACxC,MAAK,iBAAiB,EAAI,KAAK,EAAI,KAAK,KAExC,OAAO,MAAK,qDAcb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,OAGb,SAAiB,GAEhB,KAAK,OAAS,KAAK,EAAI,CACvB,MAAK,EAAI,sCAaV,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,OAGb,SAAgB,GAEf,KAAK,OAAS,KAAK,EAAI,CACvB,MAAK,EAAI,sCAMV,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,EAAI,KAAK,WAGtB,SAAiB,GAEhB,KAAK,MAAQ,EAAM,KAAK,sCAQzB,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,GAAI,KAAK,OAAS,KACjB,KAAK,MAAQ,GAAI,EAElB,MAAK,MAAM,EAAI,KAAK,KACpB,MAAK,MAAM,EAAI,KAAK,MACpB,MAAK,MAAM,EAAI,KAAK,KAEpB,OAAO,MAAK,0CAab,QAAA,eAAW,EAAA,UAAA,WAAX,WAEC,MAAO,MAAK,OAGb,SAAe,GAEd,KAAK,QAAW,KAAK,EAAI,CACzB,MAAK,EAAI,sCAOV,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,GAAI,KAAK,eAAiB,KACzB,KAAK,cAAgB,GAAI,EAE1B,MAAK,cAAc,EAAI,KAAK,CAC5B,MAAK,cAAc,EAAI,KAAK,CAC5B,MAAK,cAAc,EAAI,KAAK,CAE5B,OAAO,MAAK,kDAyCN,GAAA,UAAA,MAAP,WAEC,MAAO,IAAI,GAAI,KAAK,EAAG,KAAK,EAAG,KAAK,EAAG,KAAK,MAAO,KAAK,OAAQ,KAAK,OAa/D,GAAA,UAAA,SAAP,SAAgB,EAAU,EAAU,GAEnC,MAAQ,MAAK,GAAK,GAAK,KAAK,EAAI,KAAK,OAAS,GAAK,KAAK,GAAK,GAAK,KAAK,EAAI,KAAK,QAAU,GAAK,KAAK,GAAK,GAAK,KAAK,EAAI,KAAK,OAAS,EAc/H,GAAA,UAAA,cAAP,SAAqB,GAEpB,MAAQ,MAAK,GAAK,EAAS,GAAK,KAAK,EAAI,KAAK,OAAS,EAAS,GAAK,KAAK,GAAK,EAAS,GAAK,KAAK,EAAI,KAAK,QAAU,EAAS,GAAK,KAAK,GAAK,EAAS,GAAK,KAAK,EAAI,KAAK,OAAS,EAAS,EAarL,GAAA,UAAA,aAAP,SAAoB,GAEnB,MAAQ,MAAK,GAAK,EAAI,GAAK,KAAK,EAAI,KAAK,OAAS,EAAI,EAAI,EAAI,OAAS,KAAK,GAAK,EAAI,GAAK,KAAK,EAAI,KAAK,QAAU,EAAI,EAAI,EAAI,QAAU,KAAK,GAAK,EAAI,GAAK,KAAK,EAAI,KAAK,OAAS,EAAI,EAAI,EAAI,MASxL,GAAA,UAAA,SAAP,SAAgB,IAkBT,GAAA,UAAA,OAAP,SAAc,GAEb,MAAQ,MAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,GAAK,KAAK,GAAK,EAAU,GAAK,KAAK,OAAS,EAAU,OAAS,KAAK,QAAU,EAAU,QAAU,KAAK,OAAS,EAAU,MAoBzK,GAAA,UAAA,QAAP,SAAe,EAAW,EAAW,GAEpC,KAAK,GAAK,EAAG,CACb,MAAK,GAAK,EAAG,CACb,MAAK,GAAK,EAAG,CACb,MAAK,OAAS,EAAG,CACjB,MAAK,QAAU,EAAG,CAClB,MAAK,OAAS,EAAG,EAiBX,GAAA,UAAA,aAAP,SAAoB,GAEnB,KAAK,GAAK,EAAM,EAAE,CAClB,MAAK,GAAK,EAAM,EAAE,CAClB,MAAK,GAAK,EAAM,EAAE,CAClB,MAAK,OAAS,EAAM,EAAE,CACtB,MAAK,QAAU,EAAM,EAAE,CACvB,MAAK,OAAS,EAAM,EAAE,EAiBhB,GAAA,UAAA,aAAP,SAAoB,GAEnB,GAAI,KAAK,WAAW,GAAc,CACjC,GAAI,GAAQ,GAAI,EAEhB,IAAI,KAAK,EAAI,EAAY,EAAG,CAC3B,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAY,EAAI,KAAK,EAAI,EAAY,KAE/C,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAY,CAClB,GAAE,MAAQ,KAAK,EAAI,EAAY,EAAI,KAAK,KAExC,IAAI,EAAE,MAAQ,EAAY,MACzB,EAAE,MAAQ,EAAY,MAGxB,GAAI,KAAK,EAAI,EAAY,EAAG,CAC3B,EAAE,EAAI,KAAK,CACX,GAAE,OAAS,EAAY,EAAI,KAAK,EAAI,EAAY,MAEhD,IAAI,EAAE,OAAS,KAAK,OACnB,EAAE,OAAS,KAAK,WACX,CACN,EAAE,EAAI,EAAY,CAClB,GAAE,OAAS,KAAK,EAAI,EAAY,EAAI,KAAK,MAEzC,IAAI,EAAE,OAAS,EAAY,OAC1B,EAAE,OAAS,EAAY,OAIzB,GAAI,KAAK,EAAI,EAAY,EAAG,CAC3B,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAY,EAAI,KAAK,EAAI,EAAY,KAE/C,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAY,CAClB,GAAE,MAAQ,KAAK,EAAI,EAAY,EAAI,KAAK,KAExC,IAAI,EAAE,MAAQ,EAAY,MACzB,EAAE,MAAQ,EAAY,MAGxB,MAAO,GAGR,MAAO,IAAI,GAcL,GAAA,UAAA,WAAP,SAAkB,GAEjB,MAAQ,MAAK,EAAI,KAAK,MAAQ,EAAY,GAAK,KAAK,EAAI,EAAY,EAAI,EAAY,OAAS,KAAK,EAAI,KAAK,OAAS,EAAY,GAAK,KAAK,EAAI,EAAY,EAAI,EAAY,QAAU,KAAK,EAAI,KAAK,MAAQ,EAAY,GAAK,KAAK,EAAI,EAAY,EAAI,EAAY,MAS1P,GAAA,UAAA,QAAP,WAEC,MAAQ,MAAK,GAAK,GAAK,KAAK,GAAK,GAAK,KAAK,GAAK,GAAK,KAAK,OAAS,GAAK,KAAK,QAAU,GAAK,KAAK,OAAS,EAWpG,GAAA,UAAA,OAAP,SAAc,EAAW,EAAW,GAEnC,KAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,EAUJ,GAAA,UAAA,eAAP,SAAsB,GAErB,KAAK,GAAK,EAAS,CACnB,MAAK,GAAK,EAAS,CACnB,MAAK,GAAK,EAAS,EAYb,GAAA,UAAA,SAAP,WAEC,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,CACd,MAAK,MAAQ,EAgBP,GAAA,UAAA,MAAP,SAAa,EAAW,EAAW,EAAW,EAAe,EAAgB,GAE5E,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,OAAS,CACd,MAAK,MAAQ,EAWP,GAAA,UAAA,SAAP,WAEC,MAAO,YAAc,KAAK,EAAI,OAAS,KAAK,EAAI,OAAS,KAAK,EAAI,WAAa,KAAK,MAAQ,YAAc,KAAK,OAAS,WAAa,KAAK,MAAQ,IAc5I,GAAA,UAAA,MAAP,SAAa,GAEZ,GAAI,GAAQ,GAAI,EAEhB,IAAI,KAAK,EAAI,EAAQ,EAAG,CACvB,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAQ,EAAI,KAAK,EAAI,EAAQ,KAEvC,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAQ,CACd,GAAE,MAAQ,KAAK,EAAI,EAAQ,EAAI,KAAK,KAEpC,IAAI,EAAE,MAAQ,EAAQ,MACrB,EAAE,MAAQ,EAAQ,MAGpB,GAAI,KAAK,EAAI,EAAQ,EAAG,CACvB,EAAE,EAAI,KAAK,CACX,GAAE,OAAS,EAAQ,EAAI,KAAK,EAAI,EAAQ,MAExC,IAAI,EAAE,OAAS,KAAK,OACnB,EAAE,OAAS,KAAK,WACX,CACN,EAAE,EAAI,EAAQ,CACd,GAAE,OAAS,KAAK,EAAI,EAAQ,EAAI,KAAK,MAErC,IAAI,EAAE,OAAS,EAAQ,OACtB,EAAE,OAAS,EAAQ,OAGrB,GAAI,KAAK,EAAI,EAAQ,EAAG,CACvB,EAAE,EAAI,KAAK,CACX,GAAE,MAAQ,EAAQ,EAAI,KAAK,EAAI,EAAQ,KAEvC,IAAI,EAAE,MAAQ,KAAK,MAClB,EAAE,MAAQ,KAAK,UACV,CACN,EAAE,EAAI,EAAQ,CACd,GAAE,MAAQ,KAAK,EAAI,EAAQ,EAAI,KAAK,KAEpC,IAAI,EAAE,MAAQ,EAAQ,MACrB,EAAE,MAAQ,EAAQ,MAGpB,MAAO,GAET,OAAA,KAEA,GAAa,QAAJ,kECxoBH,GAAU,WAAhB,QAAM,MAKS,EAAA,mBAA4B,IAAI,KAAK,EAKrC,GAAA,mBAA4B,KAAK,GAAG,GACnD,OAAA,KAEA,GAAoB,QAAX,4fCfT,GAAO,GAAQ,EAAe,gCAE9B,IAAO,GAAQ,EAAe,oCAMxB,GAAa,WAAnB,QAAM,MAeS,EAAA,kBAAd,SAAgC,EAAwB,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAEvD,GAAI,GAAW,EAAY,CAC3B,IAAI,GAAW,EAAY,CAC3B,IAAI,GAAW,EAAY,CAC3B,IAAI,GAAW,EAAY,CAE3B,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAElB,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAElB,IAAI,GAAY,EAAE,CAClB,IAAI,GAAY,EAAE,CAElB,IAAI,GAAe,EAAc,kBACjC,GAAI,GAAK,EAAI,GAAG,EAAK,EACrB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,GAAK,EAAI,GAAG,EAAK,EACrB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,GAAK,GAAG,EAAK,EACjB,GAAI,IAAM,EAAI,GAAG,EAAK,EACtB,GAAI,GAAK,EAAI,GAAK,EAAI,IAAM,EAAI,IAAM,EAAI,IAAM,EAAI,IAAM,CAC1D,GAAI,IAAM,CAEV,IAAI,EAAG,CACN,EAAE,gBAAgB,EAClB,OAAO,OAEP,OAAO,IAAI,GAAS,GASR,GAAA,WAAd,SAAyB,EAAY,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAGpC,GAAI,IAAM,KAAM,CAEf,EAAI,GAAI,GAAS,EAAK,EAAK,GAI5B,EAAE,aAAa,EAAG,EAClB,GAAE,WAEF,OAAO,GASM,GAAA,MAAd,SAAoB,EAAY,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAI/B,GAAI,IAAM,KAAM,CAEf,EAAI,GAAI,GAAS,EAAK,EAAK,GAI5B,EAAE,aAAa,EAAG,EAClB,GAAE,WAEF,OAAO,GASM,GAAA,SAAd,SAAuB,EAAY,GAAA,GAAA,QAAA,GAAiB,CAAjB,EAAA,KAGlC,GAAI,IAAM,KAAM,CAEf,EAAI,GAAI,GAAS,EAAK,EAAK,GAI5B,EAAE,aAAa,EAAG,EAClB,GAAE,WAEF,OAAO,GAMM,GAAA,QAAd,SAAsB,EAAa,GAElC,GAAI,GAAc,EAAc,kBAChC,IAAI,GAAc,EAAG,OACrB,GAAG,cAAc,EAEjB,KAAK,GAAI,GAAW,EAAG,EAAI,KAAM,EAAG,CACnC,GAAI,EAAG,IAAM,EAAG,GACf,MAAO,OAGT,MAAO,MAGM,GAAA,OAAd,SAAqB,EAAiB,EAAc,EAAc,GAEjE,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAAe,EAAc,kBAEjC,GAAO,EAAI,aAAa,EACxB,GAAK,WAEL,GAAM,EAAK,aAAa,EACxB,GAAI,WACJ,GAAO,EAAI,OACX,GAAK,WAEL,GAAI,GAAK,EAAK,CACd,GAAI,GAAK,EAAI,CACb,GAAI,IAAM,EAAK,CACf,GAAI,GAAK,CAET,GAAI,GAAK,EAAK,CACd,GAAI,GAAK,EAAI,CACb,GAAI,IAAM,EAAK,CACf,GAAI,GAAK,CAET,GAAI,GAAK,EAAK,CACd,GAAI,GAAK,EAAI,CACb,GAAI,KAAO,EAAK,CAChB,GAAI,IAAM,CAEV,GAAI,KAAO,EAAK,WAAW,EAC3B,GAAI,KAAO,EAAI,WAAW,EAC1B,GAAI,IAAM,EAAK,WAAW,EAC1B,GAAI,IAAM,CAEV,GAAO,gBAAgB,GAGV,GAAA,WAAd,SAAyB,EAAe,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEvC,GAAI,IAAW,KACd,EAAS,GAAI,EAEd,IAAI,GAAW,EAAM,EAAG,EAAW,EAAM,EAAG,EAAW,EAAM,EAAG,EAAW,EAAM,CACjF,IAAI,GAAmB,EAAc,kBACrC,IAAI,IAAc,EAAE,EAAE,CACtB,IAAI,IAAc,EAAE,EAAE,CACtB,IAAI,IAAc,EAAE,EAAE,CAEtB,GAAQ,GAAK,EAAI,EAAE,EAAE,CACrB,GAAQ,GAAK,CACb,GAAQ,GAAK,CACb,GAAQ,KAAO,EAAE,EAAE,CACnB,GAAQ,GAAK,CACb,GAAQ,GAAK,EAAI,EAAE,EAAE,CACrB,GAAQ,GAAK,CACb,GAAQ,KAAO,EAAE,EAAE,CACnB,GAAQ,GAAK,CACb,GAAQ,GAAK,CACb,GAAQ,IAAM,EAAI,EAAE,EAAE,CACtB,GAAQ,KAAO,EAAE,EAAE,CACnB,GAAQ,GAAK,CACb,GAAQ,GAAK,CACb,GAAQ,IAAM,CACd,GAAQ,IAAM,CACd,GAAO,gBAAgB,EAEvB,OAAO,GAIM,GAAA,gBAAd,SAA8B,EAAiB,EAAiB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAE/D,IAAK,EACJ,EAAS,GAAI,EAEd,IAAI,GAAoB,EAAc,kBACtC,GAAO,cAAc,EACrB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GAEnB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CACnC,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CACnC,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CACnC,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CACnC,OAAO,GAGM,GAAA,qBAAd,SAAmC,EAAiB,EAAiB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEpE,IAAK,EACJ,EAAS,GAAI,EAEd,IAAI,GAAoB,EAAc,kBACtC,GAAO,cAAc,EACrB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,IAAI,GAAW,EAAO,CACtB,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CAC/B,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CAC/B,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CAC/B,GAAO,EAAI,EAAI,EAAI,EAAI,EAAI,EAAI,CAC/B,OAAO,GAGM,GAAA,eAAd,SAA6B,EAAoB,GAAA,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAEhD,IAAI,EACH,EAAS,GAAI,EAEd,GAAU,aAAa,EAAG,EAC1B,OAAO,GAGM,GAAA,sBAAd,SAAoC,EAAiB,EAAmB,GAEvE,GAAI,GAAoB,EAAc,kBACtC,GAAO,cAAc,EACrB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAW,EAAI,GACnB,IAAI,GAAkB,CACtB,IAAI,GAAgB,EAAI,MACxB,KAAI,GAAI,GAAe,EAAG,EAAM,EAAQ,GAAO,EAAG,CACjD,GAAI,GAAW,EAAI,EACnB,IAAI,GAAW,EAAI,EAAM,EACzB,IAAI,GAAW,EAAI,EAAM,EACzB,GAAK,KAAc,EAAI,EAAI,EAAI,EAAI,EAAI,CACvC,GAAK,KAAc,EAAI,EAAI,EAAI,EAAI,EAAI,CACvC,GAAK,KAAc,EAAI,EAAI,EAAI,EAAI,EAAI,GAzS3B,GAAA,mBAA8B,GAAI,OAAc,GAGhD,GAAA,mBAA8B,GAAI,EAySjD,OAAA,KAEA,GAAuB,QAAd,uPC5TT,GAAO,GAAmB,EAAW,2CAGrC,IAAM,GAAO,WAiCZ,QAjCK,GAiCO,EAAc,EAAc,EAAc,GAA1C,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAAc,GAAA,QAAA,GAAY,CAAZ,EAAA,EAErD,KAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,EAAI,CAET,IAAI,GAAK,GAAK,GAAK,EAAG,CAErB,KAAK,YAAc,EAAQ,kBAErB,IAAI,GAAK,GAAK,GAAK,EAAG,CAE5B,KAAK,YAAc,EAAQ,kBAErB,IAAI,GAAK,GAAK,GAAK,EAAG,CAE5B,KAAK,YAAc,EAAQ,kBAErB,CAEN,KAAK,YAAc,EAAQ,WAYtB,EAAA,UAAA,WAAP,SAAkB,EAAa,EAAa,GAE3C,GAAI,GAAa,EAAG,EAAI,EAAG,CAC3B,IAAI,GAAa,EAAG,EAAI,EAAG,CAC3B,IAAI,GAAa,EAAG,EAAI,EAAG,CAE3B,IAAI,GAAa,EAAG,EAAI,EAAG,CAC3B,IAAI,GAAa,EAAG,EAAI,EAAG,CAC3B,IAAI,GAAa,EAAG,EAAI,EAAG,CAE3B,MAAK,EAAI,EAAI,EAAM,EAAI,CACvB,MAAK,EAAI,EAAI,EAAM,EAAI,CACvB,MAAK,EAAI,EAAI,EAAM,EAAI,CACvB,MAAK,EAAI,KAAK,EAAE,EAAG,EAAI,KAAK,EAAE,EAAG,EAAI,KAAK,EAAE,EAAG,CAG/C,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAE/B,KAAK,YAAc,EAAQ,kBAErB,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAEtC,KAAK,YAAc,EAAQ,kBAErB,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAEtC,KAAK,YAAc,EAAQ,kBAErB,CAEN,KAAK,YAAc,EAAQ,WAWtB,GAAA,UAAA,mBAAP,SAA0B,EAAiB,GAE1C,KAAK,EAAI,EAAO,CAChB,MAAK,EAAI,EAAO,CAChB,MAAK,EAAI,EAAO,CAChB,MAAK,EAAI,KAAK,EAAE,EAAM,EAAI,KAAK,EAAE,EAAM,EAAI,KAAK,EAAE,EAAM,CACxD,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAE/B,KAAK,YAAc,EAAQ,kBAErB,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAEtC,KAAK,YAAc,EAAQ,kBAErB,IAAI,KAAK,GAAK,GAAK,KAAK,GAAK,EAAG,CAEtC,KAAK,YAAc,EAAQ,kBAErB,CAEN,KAAK,YAAc,EAAQ,WAUtB,GAAA,UAAA,UAAP,WAEC,GAAI,GAAa,EAAE,KAAK,KAAK,KAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,EAAI,KAAK,EAAE,KAAK,EACzE;KAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,CACV,MAAK,GAAK,CACV,OAAO,MAQD,GAAA,UAAA,SAAP,SAAgB,GAGf,GAAI,KAAK,aAAe,EAAQ,cAAe,CAE9C,MAAO,MAAK,EAAE,EAAE,EAAI,KAAK,MAEnB,IAAI,KAAK,aAAe,EAAQ,cAAe,CACrD,MAAO,MAAK,EAAE,EAAE,EAAI,KAAK,MAGrB,IAAI,KAAK,aAAe,EAAQ,cAAe,CAEnD,MAAO,MAAK,EAAE,EAAE,EAAI,KAAK,MAEnB,CAEN,MAAO,MAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAI,KAAK,GAW9C,GAAA,UAAA,cAAP,SAAqB,EAAY,GAAA,GAAA,QAAA,GAAqB,CAArB,EAAA,IAGhC,GAAI,KAAK,GAAK,KAAK,EAClB,MAAO,GAAoB,KAE5B,IAAI,EACJ,IAAI,KAAK,aAAe,EAAQ,cAC/B,EAAM,KAAK,EAAE,EAAE,EAAI,KAAK,MAAQ,IAAI,KAAK,aAAe,EAAQ,cAChE,EAAM,KAAK,EAAE,EAAE,EAAI,KAAK,MAAQ,IAAI,KAAK,aAAe,EAAQ,cAChE,EAAM,KAAK,EAAE,EAAE,EAAI,KAAK,MACxB,GAAM,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAI,KAAK,EAAE,EAAE,EAAI,KAAK,CAEnD,IAAI,GAAO,EACV,MAAO,GAAoB,SAAW,IAAI,EAAM,EAChD,MAAO,GAAoB,UAC3B,OAAO,GAAoB,UAGtB,GAAA,UAAA,SAAP,WAEC,MAAO,cAAgB,KAAK,EAAI,OAAS,KAAK,EAAI,OAAS,KAAK,EAAI,OAAS,KAAK,EAAI,IAhLzE,GAAA,UAAmB,CACnB,GAAA,cAAuB,CACvB,GAAA,cAAuB,CACvB,GAAA,cAAuB,CA+KtC,OAAA,KAEiB,GAAA,QAAR,0EChNT,GAAM,GAAmB,WAAzB,QAAM,MAGS,EAAA,KAAc,CACd,GAAA,MAAe,CAEf,GAAA,GAAY,CACZ,GAAA,IAAa,CACb,GAAA,UAAmB,CAElC,OAAA,KAEA,GAA6B,QAApB,otCCZT,IAAO,GAAqB,EAAW,oDACvC,IAAO,GAAc,EAAa,6CAElC,IAAM,GAAoB,SAAA,GAAS,EAA7B,EAAoB,EAEzB,SAFK,KAIJ,EAAA,KAAA,KAEA,MAAK,SAAS,UAAS,GAAI,IAAwB,QAIpD,OAAA,eAAW,EAAA,UAAA,YAAX,SAAgB,GAEf,KAAK,OAAS,sCAIf,QAAA,eAAW,EAAA,UAAA,WAAX,SAAe,GAEd,KAAK,MAAQ,sCAId,QAAA,eAAW,EAAA,UAAA,oBAAX,SAAwB,GAEvB,KAAK,cAAgB,sCAIf,GAAA,UAAA,MAAP,WAEC,GAAI,GAA6B,GAAI,EACrC,GAAM,SAAS,SAAS,KAAK,SAC7B,GAAM,OAAS,KAAK,MACpB,GAAM,MAAQ,KAAK,KACnB,GAAM,cAAgB,KAAK,aAC3B,GAAM,mBACN,OAAO,GAID,GAAA,UAAA,cAAP,WAEC,KAAK,gBAAkB,MAEzB,OAAA,IA5CmC,EA8CnC,GAA8B,QAArB,ksCCjDT,IAAO,GAAK,EAAe,+BAC3B,IAAO,GAAa,EAAa,yCACjC,IAAO,GAAY,EAAc,qCAGjC,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EA6ClB,SA7CK,GA6CO,EAAc,GAEzB,EAAA,KAAA,KAAM,MAEN,MAAK,UAAU,EAAO,GA3CvB,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,aAGb,SAAiB,GAEhB,GAAI,GAAS,KAAK,QACjB,MAED,KAAK,EAAa,iBAAiB,GAClC,KAAM,IAAI,GAAM,2EAEjB,MAAK,mBAEL,MAAK,UAAU,EAAO,KAAK,8CAO5B,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,cAGb,SAAkB,GAEjB,GAAI,GAAS,KAAK,SACjB,MAED,KAAK,EAAa,iBAAiB,GAClC,KAAM,IAAI,GAAM,2EAEjB,MAAK,mBACL,MAAK,UAAU,KAAK,QAAS,uCAS/B,OAAA,IAnD4B,EAqD5B,GAAuB,QAAd,+vCC1DT,IAAO,GAAK,EAAgB,+BAE5B,IAAM,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAIvB,SAJK,GAIO,GAGX,EAAA,KAAA,KAAM,GALO,EAAA,mBAA4B,mBAQ3C,OAAA,IAViC,EAYL,GAAA,QAAnB,4NCdT,IAAO,GAAS,EAAe,iCAC/B,IAAO,GAAK,EAAgB,+BAC5B,IAAO,GAAe,EAAc,yCACpC,IAAO,GAAY,EAAe,qCAOlC,IAAM,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAmBrB,SAnBK,GAmBO,GAEX,EAAA,KAAA,KAZO,MAAA,YAAqB,CACrB,MAAA,aAAsB,CACtB,MAAA,eAAwB,CACxB,MAAA,gBAAyB,CAEzB,MAAA,gBAA0B,IASjC,MAAK,qBAAuB,GAAI,EAEhC,MAAK,OAAS,EAID,EAAA,YAAd,SAA0B,GAEzB,IAAK,EACJ,KAAM,IAAI,OAAM,4BAEjB,IAAI,EAAiB,YAAc,KAClC,EAAiB,WAAa,GAAI,MAEnC,IAAI,GAAoC,EAAiB,6BAA6B,EAEtF,IAAI,GAAoB,KAAM,CAC7B,EAAmB,GAAI,GAAiB,EAExC,IAAI,GAAwB,GAAI,EAEhC,GAAG,QAAU,CACb,GAAG,OAAS,CAEZ,GAAiB,WAAW,KAAK,GAGlC,MAAO,GAIO,GAAA,6BAAf,SAA4C,GAG3C,GAAI,GAAW,EAAiB,WAAW,MAC3C,IAAI,EAEJ,KAAK,GAAI,GAAW,EAAG,EAAI,EAAG,IAAK,CAClC,EAAI,EAAiB,WAAY,EAEjC,IAAI,EAAE,UAAY,EACjB,MAAO,GAAE,OAGX,MAAO,MAGO,GAAA,uBAAf,SAAsC,GAErC,GAAI,GAAW,EAAiB,WAAW,MAC3C,IAAI,EAEJ,KAAK,GAAI,GAAW,EAAG,EAAI,EAAG,IAAK,CAClC,EAAI,EAAiB,WAAY,EAEjC,IAAI,EAAE,UAAY,EAAO,CACxB,EAAiB,WAAW,OAAO,EAAG,EACtC,UAKH,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,mDAGb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,mDAGb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,GAAI,GAAS,KAAK,WACjB,MAED,MAAK,WAAa,CAElB,MAAK,gBAAkB,IAEvB,MAAK,cAAgB,EAAa,gBAAgB,KAAK,WAEvD,IAAI,KAAK,cAAgB,KAAK,WAAY,CACzC,KAAK,qBAAqB,EAAI,KAAK,OAAO,KAAK,cAAgB,KAAK,YAAY,GAChF,MAAK,qBAAqB,MAAQ,KAAK,eACjC,CACN,KAAK,qBAAqB,EAAI,CAC9B,MAAK,qBAAqB,MAAQ,KAAK,cAGxC,KAAK,cAAc,GAAI,GAAM,EAAM,6CAGpC,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,GAAI,GAAS,KAAK,YACjB,MAED,MAAK,YAAc,CAEnB,MAAK,gBAAkB,IAEvB,MAAK,eAAiB,EAAa,gBAAgB,KAAK,YAExD,IAAI,KAAK,eAAiB,KAAK,YAAa,CAC3C,KAAK,qBAAqB,EAAI,KAAK,OAAO,KAAK,eAAiB,KAAK,aAAa,GAClF,MAAK,qBAAqB,OAAS,KAAK,gBAClC,CACN,KAAK,qBAAqB,EAAI,CAC9B,MAAK,qBAAqB,OAAS,KAAK,eAGzC,KAAK,cAAc,GAAI,GAAM,EAAM,6CAGpC,QAAA,eAAW,EAAA,UAAA,mCAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,iEAGb,QAAA,eAAW,EAAA,UAAA,kCAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,gEAIb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAGb,QAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,yDAGb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAGb,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,mDAGN,GAAA,UAAA,QAAP,WAEC,EAAiB,uBAAuB,KAAK,OAE7C,IAAI,KAAK,aAAc,CACtB,KAAK,aAAa,SAClB,MAAK,4BAA4B,SACjC,MAAK,6BAA6B,SAClC,MAAK,4BAA8B,IACnC,MAAK,6BAA+B,IACpC,MAAK,aAAe,MAOd,GAAA,UAAA,iBAAR,WAEC,GAAI,GAA0B,KAAK,OAAO,OAC1C,IAAI,EACJ,IAAI,EAEJ,IAAI,EACJ,IAAI,EAEJ,IAAI,KAAK,8BAAgC,KACxC,KAAK,6BAA+B,EAAQ,mBAAmB,EAAG,EAEnE,IAAI,KAAK,6BAA+B,KACvC,KAAK,4BAA8B,EAAQ,mBAAmB,EAAG,EAElE,KAAK,KAAK,aAAc,CACvB,KAAK,aAAe,EAAQ,kBAAkB,EAE9C,MAAK,aAAa,iBAAiB,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,GAG1D,KAAK,eAAiB,EAAI,KAAK,IAAI,KAAK,WAAW,KAAK,cAAe,EACvE,MAAK,eAAiB,EAAI,KAAK,IAAI,KAAK,YAAY,KAAK,eAAgB,EAEzE,IAAI,IAAa,EAAI,GAAG,EACxB,IAAI,IAAa,EAAI,GAAG,EACxB,IAAI,IAAa,EAAI,GAAG,EACxB,IAAI,IAAa,EAAI,GAAG,EAGxB,KAAqB,GAAI,EAAG,EAAI,EAAI,EAAG,GAAI,EAAG,EAAI,EAAI,EAAG,EAAG,EAAG,EAAI,EAAI,GAAI,EAAG,EAAG,EAAI,EAAI,EAEzF,KAAqB,GAAI,EAAG,EAAI,EAAI,EAAG,GAAI,EAAG,EAAI,EAAI,EAAG,EAAG,EAAG,EAAI,EAAI,GAAI,EAAG,EAAG,EAAI,EAAI,EAEzF,MAAK,6BAA6B,gBAAgB,EAAc,EAAG,EACnE,MAAK,4BAA4B,gBAAgB,EAAa,EAAG,EAEjE,MAAK,gBAAkB,MAEzB,OAAA,IA3P+B,EA+P/B,IAAM,GAAkB,WAAxB,QAAM,MAKN,MAAA,KAPA,GAAA,QAAS,uVCvQT,IAAO,GAAQ,EAAgB,gCAE/B,IAAO,GAAe,EAAc,0CAGpC,IAAO,GAAoB,EAAa,+CAMxC,IAAO,GAAmB,EAAa,sDAIvC,IAAO,GAAa,EAAc,2DAQ5B,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EAgBtB,SAhBK,GAgBO,GAAA,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAEX,EAAA,KAAA,KAbO,MAAA,WAA2B,GAAI,OAAc,EAAG,EAAG,EAAG,EAe7D,MAAK,WAAa,CAElB,MAAK,UAAY,IAEjB,MAAK,gBAAgB,KAAK,YAAc,GAAI,GAE5C,MAAK,YAAc,GAAI,EAEvB,MAAK,WAAW,GAAK,EAAE,IAOjB,EAAA,UAAA,gBAAP,SAAuB,EAA+B,EAA8B,GAEnF,MAAO,yBACN,yBACA,0BAKA,+BACA,+BAQA,+BACA,+BAGA,8BACA,+BAEA,+BAEA,mCACA,mCACA,wBAGA,8BACA,8BACA,0BAGA,0BACA,4BACA,4BACA,yBACA,6BACA,4BAGA,mCACA,wBAIA,2BACA,+BACA,mCAGA,mCAEA,wBAGA,oBAMK,GAAA,UAAA,eAAP,SAAsB,EAAuB,EAAuB,GAEnE,EAAA,UAAM,eAAc,KAAA,KAAC,EAAM,EAAU,EAErC,IAAI,GAA0B,EAAS,OACvC,IAAI,GAAc,EAAS,KAE3B,MAAK,WAAW,GAAK,KAAK,YAAa,EAAiB,YAAG,KAAK,IAAI,EAAM,YAAY,MAAO,EAAM,YAAY,QAAU,KAAK,IAAI,EAAM,MAAO,EAAM,QAGrJ,MAAK,WAAW,GAAK,EAAO,WAAW,IAEvC,GAAQ,6BAA6B,EAAqB,OAAQ,EAAG,EAAkB,YAAa,EACpG,GAAQ,6BAA6B,EAAqB,OAAQ,EAAG,EAAkB,cAAe,EACtG,GAAQ,6BAA6B,EAAqB,OAAQ,EAAG,KAAK,WAAY,EAGtF,GAAQ,8BAA8B,EAAqB,OAAQ,EAAG,EAAO,WAAW,OAAQ,MAM1F,GAAA,UAAA,aAAP,SAAoB,EAAuB,EAA2B,EAAa,EAAe,GAEjG,EAAA,UAAM,aAAY,KAAA,KAAC,EAAM,EAAY,EAAO,EAAQ,EAEpD,IAAI,GAA4C,EAAM,OACtD,MAAK,YAAY,SAAS,EAAW,aAAa,eAClD,MAAK,YAAY,OAAO,EAAO,sBAE/B,GAAQ,8BAA8B,EAAqB,OAAQ,EAAG,KAAK,YAAa,KAExF,GAAQ,eAAe,EAAG,EAAW,cAAc,EAAgB,qBAAsB,EAAW,gBAAgB,EAAgB,qBAAsB,EAAgB,gBAC1K,GAAQ,eAAe,EAAG,EAAW,cAAc,EAAgB,mBAAoB,EAAW,gBAAgB,EAAgB,mBAAoB,EAAgB,gBACtK,GAAQ,eAAe,EAAG,EAAW,cAAc,EAAgB,gBAAiB,EAAW,gBAAgB,EAAgB,gBAAiB,EAAgB,iBAChK,GAAQ,eAAe,EAAG,EAAW,cAAc,EAAgB,YAAa,EAAW,gBAAgB,EAAgB,YAAa,EAAgB,aAExJ,GAAQ,cAAc,EAAQ,eAAe,EAAW,gBAAiB,EAAG,EAAW,cAzI1E,GAAA,YAA4B,MAAc,EAAG,EAAG,EAAG,EACnD,GAAA,cAA8B,MAAc,EAAG,GAAI,EAAG,EA0IrE,OAAA,IA7IgC,EA+IL,GAAA,QAAlB,mbCtKT,IAAO,GAAY,EAAe,4CAMlC,IAAM,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAAzB,SAAM,KAA4B,EAAA,MAAA,KAAA,WAE1B,EAAA,UAAA,gBAAP,SAAuB,EAA+B,EAAmC,GAExF,MAAO,GAGD,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAAmC,GAE1F,MAAO,GAET,OAAA,IAXkC,EAaL,GAAA,QAApB,yOCnBT,IAAO,GAAa,EAAc,yCAElC,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAoB,EAAa,+CAExC,IAAO,GAAoB,EAAa,uDACxC,IAAO,GAAiB,EAAa,+DAM/B,GAAqB,SAAA,GAAS,EAA9B,EAAqB,EAmB1B,SAnBK,GAmBO,EAAyB,EAAwB,EAAwB,GAAzE,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAAyB,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAAwB,GAAA,QAAA,GAAsB,CAAtB,EAAA,MAAwB,GAAA,QAAA,GAAsB,CAAtB,EAAA,MAEpF,EAAA,KAAA,KAjBO,MAAA,eAAyB,KACzB,MAAA,OAAgB,CAEhB,MAAA,kBAA2B,EAAqB,UAgBvD,MAAK,YAAc,GAAI,EAEvB,IAAI,YAAwB,GAAe,CAC1C,KAAK,QAA0B,CAE/B,MAAK,OAAU,GAAe,KAAO,KAAO,KAC5C,MAAK,OAAS,CACd,MAAK,OAAS,MACR,CACN,KAAK,MAAQ,EAAc,OAAO,GAAgB,QAClD,MAAK,MAAS,GAAe,KAAO,EAAI,OAAO,IAUjD,OAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,GAAI,KAAK,mBAAqB,EAC7B,MAED,MAAK,kBAAoB,CAEzB,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,EAAQ,EACX,EAAQ,MACJ,IAAI,EAAQ,EAChB,EAAQ,CAET,IAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CAEd,MAAK,yDAON,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,MAAK,eAAiB,CAEtB,MAAK,yDAMC,GAAA,UAAA,gBAAP,WAEC,GAAI,EAEJ,IAAI,KAAK,sBAAuB,CAC/B,KAAK,qBACL,GAAgB,KAGjB,GAAI,EAAe,CAClB,KAAK,qBAEL,MAAK,gBAAgB,KAAK,cAOrB,GAAA,UAAA,oBAAP,WAEC,KAAK,YAEL,MAAK,yBAEL,MAAK,sBAAwB,MAMtB,GAAA,UAAA,WAAR,YAQQ,GAAA,UAAA,wBAAR,WAEC,KAAK,mBAAsB,KAAK,aAAe,EAAU,QAAU,KAAK,gBAAkB,KAAK,OAAS,CACxG,MAAK,YAAY,iBAAmB,KAAK,iBACzC,MAAK,YAAY,cAAgB,KAAK,kBACtC,MAAK,YAAY,aAAc,KAAK,aAAe,EAAU,QAAU,KAAK,mBAAqB,EAAU,MAAQ,KAAK,YACxH,MAAK,YAAY,iBAAmB,MAEtC,OAAA,IAtJoC,EAwJpC,GAA+B,QAAtB,2bCnKT,IAAO,GAAa,EAAc,qCAGlC,IAAO,GAAmB,EAAa,8CAIvC,IAAO,GAAoB,EAAa,+CAUxC,IAAO,GAAmB,EAAa,0DAMjC,GAAoB,SAAA,GAAS,EAA7B,EAAoB,EAA1B,SAAM,KAA6B,EAAA,MAAA,KAAA,WAE3B,EAAA,UAAA,gBAAP,SAAuB,EAA+B,EAAmC,GAExF,GAAI,GAAc,MAGd,GAAkC,EAAa,sBAAwB,EAAI,EAAgB,qBAAuB,EAAgB,iBAGlI,GAAsC,EAAc,uBACxD,GAAc,uBACd,GAAc,uBACd,GAAc,uBACd,GAAa,gBAAkB,EAAc,MAAM,CAEnD,IAAI,EAAa,uBAAyB,EAAG,CAC5C,EAAgB,mBAAqB,EAAc,gBACnD,IAAI,GAA6B,EAAc,yBAC/C,IAAQ,OAAS,EAAO,KAAO,EAAW,KAAO,EAAgB,KAChE,OAAS,EAAgB,mBAAqB,KAAO,EAAO,KAC5D,WAAa,EAAO,SACf,CACN,GAAQ,WAAa,EAAW,KAAO,EAAgB,KAGxD,MAAO,GAMD,GAAA,UAAA,aAAP,SAAoB,EAAuB,EAA2B,EAAa,EAAe,GAEjG,EAAA,UAAM,aAAY,KAAA,KAAC,EAAM,EAAY,EAAO,EAAQ,EAEpD,IAAI,GAAgC,EAAK,YAEzC,IAAI,EAAa,kBAAoB,EAAG,CACvC,EAAW,aAAa,wBAAwB,GAAQ,cAAc,EAAa,mBAAoB,EAAa,iBAAkB,KACtI,GAAe,cAAc,EAAa,mBAAoB,EAAa,gBAAiB,UACtF,CACN,GAAI,GAAoB,EAAc,kBAEtC,GAAS,SAAS,EAAW,aAAa,wBAAwB,GAClE,GAAS,OAAO,EAEhB,GAAS,cAAc,EAAa,mBAAoB,EAAa,gBAAiB,MAGvF,GAAI,GAA4C,EAAM,OAEtD,GAAQ,6BAA6B,EAAqB,OAAQ,EAAG,EAAa,mBAAoB,EAAa,uBACnH,GAAQ,6BAA6B,EAAqB,SAAU,EAAG,EAAa,qBAAsB,EAAa,yBAEvH,GAAQ,eAAe,EAAG,EAAW,cAAc,EAAoB,eAAgB,EAAW,gBAAgB,EAAoB,eAAgB,EAAoB,gBAC1K,GAAQ,cAAc,EAAQ,eAAe,EAAW,gBAAiB,EAAG,EAAW,cAEzF,OAAA,IA1DmC,EA4DL,GAAA,QAArB,mOCrFT,GAAM,GAAoB,WAA1B,QAAM,MAKS,EAAA,YAAqB,YAKrB,GAAA,WAAoB,WACnC,OAAA,KAE8B,GAAA,QAArB,0LCbT,IAAO,GAAc,EAAc,sCACnC,IAAO,GAAa,EAAc,yCAElC,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAiB,EAAa,8DAGrC,IAAO,GAAoB,EAAa,+CAExC,IAAO,GAAoB,EAAa,uDACxC,IAAO,GAAoB,EAAa,uDACxC,IAAO,GAAkB,EAAa,6DACtC,IAAO,GAAkB,EAAa,6DAEtC,IAAO,GAAiB,EAAa,4DAErC,IAAO,GAAmB,EAAa,8DACvC,IAAO,GAAgB,EAAc,0DACrC,IAAO,GAAkB,EAAa,gEAMhC,GAAsB,SAAA,GAAS,EAA/B,EAAsB,EA6B3B,SA7BK,GA6BO,EAAyB,EAAwB,EAAwB,GAAzE,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAAyB,GAAA,QAAA,GAAsB,CAAtB,EAAA,KAAwB,GAAA,QAAA,GAAsB,CAAtB,EAAA,MAAwB,GAAA,QAAA,GAAsB,CAAtB,EAAA,MAEpF,EAAA,KAAA,KA7BO,MAAA,eAAyB,KACzB,MAAA,OAAgB,CAOhB,MAAA,eAAoC,GAAI,EAExC,MAAA,eAAoC,GAAI,EACxC,MAAA,cAAkC,GAAI,EACtC,MAAA,gBAAsC,GAAI,EAG1C,MAAA,kBAA2B,EAAqB,UAgBvD,MAAK,cAAgB,EAAqB,WAE1C,IAAI,YAAwB,GAAe,CAC1C,KAAK,QAA0B,CAE/B,MAAK,OAAU,GAAe,KAAO,KAAO,KAC5C,MAAK,OAAS,CACd,MAAK,OAAS,MACR,CACN,KAAK,MAAS,GAAgB,KAAO,SAAW,OAAO,EACvD,MAAK,MAAS,GAAe,KAAO,EAAI,OAAO,IAKjD,OAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,+DASN,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,GAAI,KAAK,mBAAqB,EAC7B,MAED,MAAK,kBAAoB,CAEzB,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,EAAQ,EACX,EAAQ,MACJ,IAAI,EAAQ,EAChB,EAAQ,CAET,IAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CAEd,IAAI,KAAK,iBAAmB,KAC3B,KAAK,gBAAkB,GAAI,EAE5B,MAAK,gBAAgB,gBAAkB,CAEvC,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,YAAY,oBAGzB,SAA0B,GAEzB,KAAK,YAAY,eAAiB,sCAMnC,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,eAAe,aAG5B,SAA0B,GAEzB,KAAK,eAAe,QAAU,sCAM/B,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,IAAI,GAAS,KAAK,eACjB,EAAM,SAAS,KAAK,eAErB,MAAK,eAAiB,CAEtB,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,IAAI,GAAS,KAAK,cACjB,EAAM,SAAS,KAAK,cAErB,MAAK,cAAgB,CAErB,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,IAAI,GAAS,KAAK,eACjB,EAAM,SAAS,KAAK,eAErB,MAAK,eAAiB,CAEtB,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAGb,SAA0B,GAEzB,GAAI,KAAK,iBAAmB,EAC3B,MAED,IAAI,GAAS,KAAK,gBACjB,EAAM,SAAS,KAAK,gBAErB,MAAK,gBAAkB,CAEvB,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,IAAI,GAAS,KAAK,cACjB,EAAM,SAAS,KAAK,cAErB,MAAK,cAAgB,CAErB,MAAK,+DAQC,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,KAAK,aAAe,KACvB,KAAK,YAAc,GAAI,EAExB,MAAK,YAAY,gBAAgB,EAEjC,MAAK,2BAMN,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,YAAa,KAAK,YAAY,iBAAmB,sCASvD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,MAAO,MAAK,YAAa,KAAK,YAAY,gBAAgB,GAAU,MAQ9D,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,KAAK,aAAe,KACvB,MAAO,KAER,OAAO,MAAK,YAAY,kBAAkB,GAQpC,GAAA,UAAA,kBAAP,SAAyB,EAAyB,GAEjD,GAAI,KAAK,aAAe,KACvB,KAAK,YAAc,GAAI,EAExB,MAAK,YAAY,kBAAkB,EAAQ,EAE3C,MAAK,qBAOC,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,KAAK,aAAe,KACvB,MAED,MAAK,YAAY,mBAAmB,EAGpC,IAAI,KAAK,YAAY,kBAAoB,EACxC,KAAK,qBAOP,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,cAAc,eAG3B,SAAqB,GAEpB,KAAK,cAAc,UAAY,sCAQhC,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,gBAAgB,aAG7B,SAAuB,GAEtB,KAAK,gBAAgB,QAAU,sCAMhC,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,gBAAgB,WAG7B,SAAiB,GAEhB,KAAK,gBAAgB,MAAQ,sCAM9B,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,eAAe,aAG5B,SAAmB,GAElB,KAAK,eAAe,QAAU,sCAM/B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,gBAAgB,cAG7B,SAAoB,GAEnB,KAAK,gBAAgB,SAAW,sCAMjC,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,eAAe,kBAG5B,SAAwB,GAEvB,KAAK,eAAe,aAAe,sCAMpC,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,eAAe,kBAG5B,SAAwB,GAEvB,KAAK,eAAe,aAAe,sCAMpC,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,gBAAgB,mBAG7B,SAAyB,GAExB,KAAK,gBAAgB,cAAgB,sCAQtC,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,MAAK,eAAiB,CAEtB,MAAK,yDAMC,GAAA,UAAA,iBAAP,WAEC,GAAI,KAAK,sBAAuB,CAE/B,KAAK,sBAAwB,KAE7B,MAAK,YAEL,MAAK,yBAEL,MAAK,qBAEL,IAAI,KAAK,eAAiB,EAAqB,WAAY,CAC1D,GAAI,KAAK,iBACR,KAAK,gBAAgB,KAAK,iBAE3B,IAAI,KAAK,sBACR,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,sBAAsB,SAAU,EAC/D,KAAK,gBAAgB,KAAK,sBAAsB,IAGnD,GAAI,KAAK,YACR,KAAK,gBAAgB,KAAK,cAOrB,GAAA,UAAA,WAAR,WAIC,GAAI,KAAK,WAAa,GAAK,KAAK,iBAAmB,GAAK,KAAK,eAAiB,EAAqB,YAClG,KAAK,qBACD,IAAI,KAAK,YACb,KAAK,kBAGN,IAAI,KAAK,eAAiB,KAAK,eAAiB,EAAqB,WACpE,KAAK,0BACD,IAAI,KAAK,iBACb,KAAK,uBAGN,IAAI,KAAK,cAAgB,GAAK,KAAK,eAAiB,EAAqB,WACxE,KAAK,+BACD,IAAI,KAAK,sBACb,KAAK,6BAMC,GAAA,UAAA,wBAAR,WAEC,GAAI,GAA2B,QAAQ,KAAK,kBAAoB,KAAK,YAGrE,IAAI,KAAK,iBAAkB,CAC1B,KAAK,iBAAiB,iBAAmB,CACzC,MAAK,iBAAiB,aAAa,EAAU,OAC7C,MAAK,iBAAiB,iBAAmB,KAAK,kBAG/C,GAAI,KAAK,sBAAuB,CAC/B,GAAI,GAA4B,CAIhC,KAAK,KAAK,iBAAkB,CAC3B,KAAK,sBAAsB,GAAG,iBAAmB,CACjD,MAAK,sBAAsB,GAAG,aAAa,EAAU,OACrD,MAAK,sBAAsB,GAAG,iBAAmB,KAAK,iBACtD,GAAqB,EAItB,IAAK,GAAI,GAAW,EAAoB,EAAI,KAAK,sBAAsB,SAAU,EAAG,CACnF,KAAK,sBAAsB,GAAG,iBAAmB,CACjD,MAAK,sBAAsB,GAAG,aAAa,EAAU,IACrD,MAAK,sBAAsB,GAAG,iBAAmB,EAAqB,YAIxE,GAAI,KAAK,kBAAoB,KAAK,sBAAuB,CAExD,KAAK,mBAAqB,KAG1B,IAAI,KAAK,YAAa,CACrB,KAAK,YAAY,SAAW,EAAiB,OAC7C,MAAK,YAAY,iBAAmB,EAAqB,UACzD,MAAK,YAAY,aAAa,EAAU,MACxC,MAAK,YAAY,iBAAmB,OAG/B,IAAI,KAAK,YAAa,CAC5B,KAAK,mBAAsB,KAAK,aAAe,EAAU,QAAU,KAAK,gBAAmB,KAAK,iBAAmB,KAAK,gBAAgB,gBAAkB,CAE1J,MAAK,YAAY,SAAW,EAAiB,YAC7C,MAAK,YAAY,iBAAmB,KAAK,iBACzC,MAAK,YAAY,cAAgB,KAAK,kBACtC,MAAK,YAAY,eAAiB,KAAK,eACvC,MAAK,YAAY,aAAc,KAAK,aAAe,EAAU,QAAU,KAAK,mBAAqB,EAAU,MAAQ,KAAK,YACxH,MAAK,YAAY,iBAAmB,OAI9B,GAAA,UAAA,oBAAR,WAGC,GAAI,KAAK,kBAAoB,KAC5B,KAAK,iBAAmB,GAAI,GAAmB,EAAiB,SAEjE,MAAK,iBAAiB,YAAc,GAAI,IAAmB,KAAK,cAAc,cAC9E,MAAK,iBAAiB,aAAe,KAAK,aAC1C,MAAK,iBAAiB,cAAgB,KAAK,cAC3C,MAAK,iBAAiB,cAAgB,KAAK,cAC3C,MAAK,iBAAiB,aAAe,KAAK,aAC1C,MAAK,iBAAiB,eAAiB,KAAK,gBAGrC,GAAA,UAAA,sBAAR,WAEC,KAAK,iBAAiB,SACtB,MAAK,mBAAmB,KAAK,iBAC7B,MAAK,iBAAmB,KAGjB,GAAA,UAAA,yBAAR,WAEC,KAAK,4BACL,IAAI,EACJ,IAAI,GAAsB,KAAK,cAAc,oBAC7C,IAAI,GAAwB,KAAK,cAAc,cAC/C,IAAI,GAAwB,KAAK,cAAc,cAC/C,IAAI,GAAwB,CAC5B,IAAI,GAA0B,CAC9B,IAAI,GAAqB,CAEzB,KAAK,KAAK,iBAAkB,CAC3B,GAAgB,KAAK,cAAc,2BACnC,IAAkB,KAAK,cAAc,sBAGtC,KAAK,sBAAwB,GAAI,MAEjC,OAAO,EAAiB,GAAgB,EAAmB,GAAkB,EAAc,EAAgB,CAC1G,EAAO,GAAI,GAAmB,EAAiB,SAC/C,GAAK,eAAiB,KAAK,eAAiB,IAC5C,GAAK,wBAA0B,CAC/B,GAAK,kBAAoB,CACzB,GAAK,kBAAoB,CACzB,GAAK,YAAc,KAAK,aACxB,GAAK,cAAgB,KAAK,cAC1B,GAAK,cAAgB,KAAK,cAC1B,GAAK,aAAe,KAAK,aACzB,GAAK,eAAiB,KAAK,eAC3B,MAAK,sBAAsB,KAAK,EAEhC,IAAkB,EAAK,qBACvB,IAAoB,EAAK,eACzB,IAAe,EAAK,iBAId,GAAA,UAAA,2BAAR,WAEC,IAAK,KAAK,sBACT,MAED,KAAK,GAAI,GAAW,EAAG,EAAI,KAAK,sBAAsB,SAAU,EAC/D,KAAK,mBAAmB,KAAK,sBAAsB,GAEpD,MAAK,sBAAwB,KAGtB,GAAA,UAAA,iBAAR,WAEC,GAAI,KAAK,YAAY,eAAiB,KAAK,eAC1C,KAAK,YAAY,cAAc,SAEhC,IAAI,KAAK,YAAY,eAAiB,KAAK,eAC1C,KAAK,YAAY,cAAc,SAEhC,IAAI,KAAK,YAAY,gBAAkB,KAAK,gBAC3C,KAAK,YAAY,eAAe,SAEjC,IAAI,KAAK,YAAY,cAAgB,KAAK,cACzC,KAAK,YAAY,aAAa,SAE/B,MAAK,mBAAmB,KAAK,YAC7B,MAAK,YAAc,KAGZ,GAAA,UAAA,eAAR,WAEC,GAAI,KAAK,aAAe,KACvB,KAAK,YAAc,GAAI,EAExB,IAAI,KAAK,eAAiB,EAAqB,YAAa,CAC3D,KAAK,YAAY,cAAgB,KAAK,cACtC,MAAK,YAAY,cAAgB,KAAK,cACtC,MAAK,YAAY,eAAiB,KAAK,eACvC,MAAK,YAAY,aAAe,KAAK,aACrC;KAAK,YAAY,aAAe,KAAK,kBAC/B,IAAI,KAAK,eAAiB,EAAqB,WAAY,CACjE,GAAI,KAAK,WAAa,EAAG,CACxB,KAAK,YAAY,cAAgB,KAAK,mBAChC,CACN,KAAK,YAAY,cAAgB,KAGlC,KAAK,YAAY,cAAgB,KACjC,MAAK,YAAY,aAAe,KAAK,eAOvC,QAAA,eAAY,EAAA,UAAA,iBAAZ,WAEC,MAAO,MAAK,cAAe,KAAK,cAAc,eAAiB,KAAK,cAAc,qBAAuB,KAAK,cAAc,eAAiB,KAAK,cAAc,4BAA8B,KAAK,cAAc,sBAAwB,sCAM1O,QAAA,eAAY,EAAA,UAAA,qBAAZ,WAEC,MAAO,MAAK,cAAe,KAAK,cAAc,eAAiB,KAAK,cAAc,qBAAuB,KAAK,cAAc,eAAiB,sCAE/I,OAAA,IA7qBqC,EA+qBrC,GAAgC,QAAvB,0wBClsBH,GAAQ,WA6Bb,QA7BK,GA6BO,GA3BL,KAAA,UAAoB,IA6B1B,MAAK,OAAS,EAMR,EAAA,UAAA,MAAP,WAEC,KAAK,OAAO,QAEZ,MAAK,eAAiB,CACtB,MAAK,sBAAwB,CAC7B,MAAK,wBAA0B,CAE/B,MAAK,gBAAkB,KACvB,MAAK,UAAY,KACjB,MAAK,aAAe,KACpB,MAAK,cAAgB,KACrB,MAAK,QAAU,KACf,MAAK,iBAAmB,KACxB,MAAK,qBAAuB,KAC5B,MAAK,uBAAyB,MAEhC,OAAA,KAEkB,GAAA,QAAT,4BC9DT,GAAO,GAAqB,EAAY,wEAUlC,GAAY,WAqBjB,QArBK,GAqBO,EAAgB,EAAiB,GAAA,GAAA,QAAA,GAAyB,CAAzB,EAAA,KAE5C,KAAK,SAAW,CAChB,MAAK,UAAY,CACjB,MAAK,YAAc,CACnB,MAAK,cAAc,EAAS,GAMtB,EAAA,UAAA,qBAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,YAAa,EAAG,CAC/C,IAAK,KAAK,eAAe,GAAI,CAC5B,GAAI,KAAK,YACR,KAAK,iBAAiB,IAEvB,OAAO,MAAK,iBAAiB,IAI/B,KAAM,IAAI,OAAM,sBAMV,GAAA,UAAA,wBAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,YAAa,EAAG,CAC/C,GAAI,KAAK,iBAAiB,GAAK,EAC9B,QAED,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,iBAAiB,GAAG,IAAM,EAAG,CACrC,GAAI,KAAK,YACR,KAAK,iBAAiB,GAAG,IAE1B,OAAO,MAAK,oBAAoB,GAAG,KAKtC,KAAM,IAAI,OAAM,sBASV,GAAA,UAAA,SAAP,SAAgB,EAAgC,GAE/C,GAAI,EAAS,YAAc,EAC1B,KAAK,iBAAiB,EAAS,YAAY,EAAS,QAAU,MAE9D,MAAK,iBAAiB,EAAS,QAAU,EAOpC,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,EAAS,YAAc,EAAG,CAC7B,KAAM,KAAK,iBAAiB,EAAS,YAAY,EAAS,OAAS,EAClE,KAAM,IAAI,OAAM,uCACX,CACN,KAAM,KAAK,iBAAiB,EAAS,OAAS,EAC7C,KAAM,IAAI,OAAM,oCAOZ,GAAA,UAAA,QAAP,WAEC,KAAK,iBAAmB,IACxB,MAAK,oBAAsB,IAC3B,MAAK,iBAAmB,IACxB,MAAK,iBAAmB,KAMlB,GAAA,UAAA,kBAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,YAAa,EAC5C,GAAI,KAAK,eAAe,GACvB,MAAO,KAET,OAAO,OAMA,GAAA,UAAA,cAAR,SAAsB,EAAgB,GAErC,GAAI,GAAc,EAAa,UAAU,EAAS,EAElD,MAAK,iBAAmB,EAAa,SAAS,EAC9C,MAAK,oBAAsB,EAAa,cAAc,EAEtD,MAAK,iBAAmB,KAAK,WAAW,MAAc,GAAW,EAEjE,MAAK,iBAAmB,GAAI,OAAqB,EACjD,MAAK,iBAAiB,GAAK,KAAK,WAAW,GAAI,OAAc,GAAW,EACxE,MAAK,iBAAiB,GAAK,KAAK,WAAW,GAAI,OAAc,GAAW,EACxE,MAAK,iBAAiB,GAAK,KAAK,WAAW,GAAI,OAAc,GAAW,EACxE,MAAK,iBAAiB,GAAK,KAAK,WAAW,GAAI,OAAc,GAAW,GAG1D,GAAA,UAAf,SAAyB,EAAgB,GAExC,GAAI,GAAc,EAAU,CAE5B,IAAI,EAAa,SAAS,IAAS,UAClC,MAAO,EAER,IAAI,GAA+C,GAAI,OAA6B,EACpF,GAAa,SAAS,GAAQ,CAE9B,IAAI,gBAMJ,GAAa,cAAc,GAAQ,CAEnC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAY,EAAG,CAEzC,EAAgB,GAAK,GAAI,GAAsB,EAAS,EAExD,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAC/B,EAAmB,GAAG,GAAK,GAAI,GAAsB,EAAS,EAAG,GAGnE,MAAO,GAOA,GAAA,UAAA,eAAR,SAAuB,GAEtB,GAAI,KAAK,iBAAiB,GAAS,EAClC,MAAO,KAER,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAC/B,GAAI,KAAK,iBAAiB,GAAG,GAAS,EACrC,MAAO,KAET,OAAO,OAIA,GAAA,UAAA,WAAR,SAAmB,EAAc,GAEhC,GAAI,GAAW,EAAE,MAEjB,KAAK,GAAI,GAAW,EAAG,EAAI,EAAG,IAC7B,EAAE,GAAK,CAER,OAAO,GA9LO,GAAA,SAAkB,GAAI,OACtB,GAAA,cAAuB,GAAI,OA+L3C,OAAA,KAEA,GAAsB,QAAb,mGC3MT,GAAO,GAAmB,EAAa,kEACvC,IAAO,GAAkB,EAAa,iEAGtC,IAAO,GAAgB,EAAc,8DAQ/B,GAAkB,WA8BvB,QA9BK,GA8BO,EAA8B,EAAmC,GAtBtE,KAAA,aAAsB,EACtB,MAAA,eAAwB,EACxB,MAAA,4BAAqC,EAsB3C,MAAK,WAAa,CAClB,MAAK,eAAiB,CAEtB,MAAK,eAAiB,CACtB,MAAK,UAAY,EAAa,OAE9B,MAAK,kBAAoB,GAAI,EAE7B,MAAK,gBAAkB,GAAI,GAAoB,KAAK,UACpD,MAAK,gBAAgB,uBAAyB,CAC9C,MAAK,gBAAgB,QAMf,EAAA,UAAA,QAAP,WAEC,KAAK,eAAe,OAEpB,MAAK,wBAEL,MAAK,sBAEL,MAAK,sBAGL,MAAK,cAAgB,KAAK,eAAe,gBAAgB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBACzG,MAAK,6BAA+B,KAAK,eAAe,kBAAkB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBAG1H,MAAK,6BAA+B,OAAS,KAAK,gBAAgB,uBAAyB,KAAO,KAAK,kBAAkB,aAAe,IACxI,MAAK,gBAAgB,wBAAwB,KAAK,kBAAkB,aAGpE,MAAK,eAAe,iBAAiB,KAAK,gBAAiB,KAAK,uBAAwB,KAAK,2BAA4B,KAAK,UAAW,KAAK,UAC9I,MAAK,eAAe,mBAAmB,KAAK,gBAMtC,GAAA,UAAA,qBAAP,WAEC,KAAK,kBAAkB,aAAe,KAAK,gBAAgB,2BAC3D,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,aAAc,EAGhF,IAAI,KAAK,eAAe,sBAAwB,EAC/C,KAAK,2BAGN,IAAI,KAAK,eAAe,eAAiB,EACxC,KAAK,eAEN,IAAI,KAAK,eAAe,wBAA0B,EACjD,KAAK,wBAEN,IAAI,KAAK,eAAe,mBAAqB,EAC5C,KAAK,mBAEN,IAAI,KAAK,eAAe,oBAAsB,EAC7C,KAAK,oBAGN,MAAK,cAAgB,KAAK,WAAW,gBAAgB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBACrG,MAAK,gBAAkB,KAAK,WAAW,kBAAkB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBAGzG,MAAK,cAAgB,KAAK,eAAe,2BAA2B,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBACpH,MAAK,gBAAkB,KAAK,eAAe,6BAA6B,KAAK,eAAgB,KAAK,gBAAiB,KAAK,mBAMjH,GAAA,UAAA,0BAAR,WAEC,KAAK,gBAAgB,oBAAoB,KAAK,kBAAkB,qBAAuB,KAAK,gBAAgB,0BAA2B,KAAK,eAAe,sBAE3J,IAAI,GAAuC,KAAK,gBAAgB,uBAChE,MAAK,gBAAgB,uBACrB,MAAK,gBAAgB,uBACrB,MAAK,gBAAgB,uBAErB,MAAK,eAAe,iBAAmB,EAAe,MAAM,CAE5D,MAAK,cAAgB,OAAS,KAAK,kBAAkB,qBAAuB,KAAO,KAAK,kBAAkB,cAAgB,KAAO,EAAiB,IAElJ,IAAI,KAAK,eAAe,sBAAuB,CAC9C,KAAK,kBAAkB,sBAAwB,KAAK,gBAAgB,gBACpE,MAAK,cAAgB,OAAS,KAAK,kBAAkB,sBAAwB,KAAO,KAAK,kBAAkB,qBAAuB,MAO5H,GAAA,UAAA,cAAR,WAEC,GAAI,GAAuC,KAAK,gBAAgB,wBAChE,MAAK,eAAe,cAAgB,EAAe,KAEnD,IAAI,GAAgC,KAAK,gBAAgB,gBAEzD,MAAK,kBAAkB,UAAY,CAEnC,IAAI,KAAK,eAAe,gBAAiB,IAGpC,GAAqC,KAAK,gBAAgB,uBAC9D,IAAI,GAAqC,KAAK,gBAAgB,uBAC9D,MAAK,eAAe,iBAAmB,EAAa,MAAM,CAE1D,MAAK,cAAgB,OAAS,EAAU,OAAS,EAAiB,KAAO,EAAe,KAClF,OAAS,EAAU,OAAS,EAAiB,KAAO,EAAe,KACnE,OAAS,EAAU,QAAU,EAAiB,aAC9C,CACN,KAAK,eAAe,kBAAoB,CACxC,MAAK,UAAY,EAAQ,UACzB,MAAK,UAAY,EAAe,YAO1B,GAAA,UAAA,uBAAR,WAEC,GAAI,GAAuC,KAAK,gBAAgB,wBAChE,MAAK,eAAe,uBAAyB,EAAe,KAC5D,MAAK,kBAAkB,mBAAqB,KAAK,gBAAgB,gBACjE,MAAK,cAAgB,OAAS,KAAK,kBAAkB,mBAAqB,KAAO,EAAiB,KAM5F,GAAA,UAAA,mBAAP,WAEC,GAAI,GAA0C,KAAK,gBAAgB,uBACnE,MAAK,kBAAkB,eAAiB,KAAK,gBAAgB,gBAC7D,MAAK,kBAAkB,gBAAkB,KAAK,gBAAgB,2BAC9D,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,gBAAiB,KAAK,eAAe,oBAEvG,MAAK,eAAe,oBAAsB,EAAkB,MAAM,CAElE,IAAI,KAAK,eAAe,iBAAkB,CACzC,GAAI,GAA6B,KAAK,gBAAgB,yBACtD,MAAK,cAAgB,OAAS,EAAO,KAAO,EAAoB,KAAO,KAAK,kBAAkB,cAAgB,KAC7G,OAAS,KAAK,kBAAkB,eAAiB,SAAW,EAAO,KAAO,KAAK,kBAAkB,gBAAkB,KACnH,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,cAAgB,WAC5F,CACN,KAAK,cAAgB,OAAS,KAAK,kBAAkB,eAAiB,KAAO,EAAoB,KAAO,KAAK,kBAAkB,qBAAuB,IACtJ,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,sBAInE,KAAK,gBAAkB,OAAS,KAAK,kBAAkB,gBAAkB,SAAW,KAAK,kBAAkB,eAAiB,KAC3H,OAAS,KAAK,kBAAkB,gBAAkB,SAAW,KAAK,kBAAkB,eAAiB,OAMhG,GAAA,UAAA,kBAAP,WAEC,KAAK,kBAAkB,eAAiB,KAAK,gBAAgB,2BAC7D,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,eAAgB,KAAK,eAAe,mBAGtG,IAAI,KAAK,eAAe,iBAAmB,KAAK,eAAe,sBAAuB,CACrF,KAAK,cAAgB,KAAK,eAAe,sBAAsB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBAC/G,MAAK,gBAAkB,KAAK,eAAe,wBAAwB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,kBAEnH,QAGD,GAAI,EAEJ,KAAK,KAAK,eAAe,iBAAmB,KAAK,eAAe,iBAAkB,CACjF,EAAe,GAAI,OAA6B,EAChD,GAAa,GAAK,KAAK,gBAAgB,uBACvC,GAAa,GAAK,KAAK,gBAAgB,uBACvC,GAAa,GAAK,KAAK,gBAAgB,uBAEvC,MAAK,gBAAgB,uBAErB,MAAK,eAAe,uBAAyB,EAAa,GAAG,MAAM,CAEnE,MAAK,kBAAkB,cAAgB,KAAK,gBAAgB,iBAG7D,GAAI,KAAK,eAAe,eAAgB,CACvC,GAAI,KAAK,eAAe,iBAAkB,CAEzC,KAAK,cAAgB,OAAS,KAAK,kBAAkB,eAAiB,SAAW,KAAK,kBAAkB,eAAiB,KACxH,OAAS,KAAK,kBAAkB,gBAAkB,SAAW,KAAK,kBAAkB,gBAAkB,KACtG,OAAS,KAAK,kBAAkB,UAAY,SAAW,KAAK,kBAAkB,eAAiB,KAAO,KAAK,kBAAkB,gBAAkB,IAEhJ,MAAK,gBAAkB,KAAK,eAAe,wBAAwB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,uBAC7G,CAEN,KAAK,kBAAkB,eAAiB,KAAK,gBAAgB,gBAC7D,MAAK,kBAAkB,iBAAmB,KAAK,gBAAgB,gBAC/D,IAAI,GAA6B,KAAK,gBAAgB,yBAEtD,MAAK,cAAgB,OAAS,EAAO,SAAW,KAAK,kBAAkB,eAAiB,KAAO,EAAa,GAAK,KAChH,OAAS,KAAK,kBAAkB,eAAiB,SAAW,EAAO,KACnE,OAAS,EAAO,SAAW,KAAK,kBAAkB,gBAAkB,KAAO,EAAa,GAAK,KAC7F,OAAS,KAAK,kBAAkB,gBAAkB,SAAW,EAAO,KACpE,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,gBAAkB,SACnG,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,eAAiB,SAClG,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,YAAc,SAC/F,OAAS,KAAK,kBAAkB,iBAAmB,OAAS,KAAK,kBAAkB,gBAAkB,SACrG,OAAS,KAAK,kBAAkB,iBAAmB,OAAS,KAAK,kBAAkB,eAAiB,SACpG,OAAS,KAAK,kBAAkB,iBAAmB,OAAS,KAAK,kBAAkB,YAAc,SACjG,OAAS,KAAK,kBAAkB,cAAgB,OAAS,KAAK,kBAAkB,gBAAkB,SAClG,OAAS,KAAK,kBAAkB,cAAgB,OAAS,KAAK,kBAAkB,eAAiB,SACjG,OAAS,KAAK,kBAAkB,cAAgB,OAAS,KAAK,kBAAkB,YAAc,SAC9F,OAAS,EAAO,SAAW,KAAK,kBAAkB,eAAiB,KAAO,KAAK,kBAAkB,gBAAkB,KACnH,OAAS,KAAK,kBAAkB,eAAiB,OAAS,EAAO,WACjE,OAAS,KAAK,kBAAkB,iBAAmB,OAAS,EAAO,SACnE,OAAS,KAAK,kBAAkB,cAAgB,OAAS,EAAO,UAEjE,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,oBAG9D,EACJ,IAAI,EACJ,IAAI,EAEJ,GAAI,KAAK,gBAAgB,2BACzB,MAAK,gBAAgB,sBAAsB,EAAG,EAC9C,GAAI,KAAK,gBAAgB,2BACzB,MAAK,gBAAgB,sBAAsB,EAAG,EAC9C,GAAI,KAAK,gBAAgB,2BACzB,MAAK,gBAAgB,sBAAsB,EAAG,EAE9C,MAAK,gBAAkB,OAAS,EAAI,SAAW,KAAK,kBAAkB,eAAiB,KACtF,OAAS,EAAI,OAAS,KAAK,kBAAkB,eAAiB,QAC9D,OAAS,EAAI,SAAW,KAAK,kBAAkB,iBAAmB,KAClE,OAAS,EAAI,SAAW,KAAK,kBAAkB,cAAgB,IAGhE,MAAK,gBAAkB,KAAK,eAAe,wBAAwB,KAAK,eAAgB,KAAK,gBAAiB,KAAK,mBAClH,OAAS,KAAK,kBAAkB,eAAiB,SAAW,KAAK,kBAAkB,eAAiB,KAAO,EAAI,KAC/G,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,cAAgB,MAElG,MAAK,gBAAgB,wBAAwB,EAC7C,MAAK,gBAAgB,wBAAwB,EAC7C,MAAK,gBAAgB,wBAAwB,QAExC,CAEN,KAAK,cAAgB,OAAS,KAAK,kBAAkB,cAAgB,SAAW,KAAK,kBAAkB,eAAiB,KAAO,EAAa,GAAK,KAChJ,OAAS,KAAK,kBAAkB,cAAgB,OAAS,KAAK,kBAAkB,eAAiB,MAElG,MAAK,gBAAkB,OAAS,KAAK,kBAAkB,eAAiB,SAAW,KAAK,kBAAkB,cAAgB,KACzH,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,cAAgB,MAElG,IAAI,KAAK,eAAe,oBAAsB,EAAG,CAChD,KAAK,kBAAkB,eAAiB,KAAK,gBAAgB,gBAE7D,MAAK,cAAgB,OAAS,KAAK,kBAAkB,eAAiB,SAAW,KAAK,kBAAkB,gBAAkB,KAAO,EAAa,GAAK,KAClJ,OAAS,KAAK,kBAAkB,eAAiB,OAAS,KAAK,kBAAkB,gBAAkB,QAItG,IAAK,KAAK,eAAe,iBACxB,KAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,gBAM7D,GAAA,UAAA,qBAAP,WAEC,KAAK,eAAe,sBAEpB,MAAK,uBAAyB,GAAI,OAAc,MAChD,MAAK,2BAA6B,GAAI,OAAc,MACpD,MAAK,aAAe,EACpB,MAAK,eAAiB,EACtB,MAAK,4BAA8B,EAEnC,MAAK,gBAAgB,oBAAoB,KAAK,kBAAkB,cAAgB,KAAK,gBAAgB,0BAA2B,EAGhI,MAAK,kBAAkB,QAAU,KAAK,gBAAgB,yBACtD,MAAK,eAAe,iBAAmB,KAAK,kBAAkB,QAAQ,MAAM,CAI5E,IAAI,KAAK,eAAe,oBAAsB,GAAK,KAAK,eAAe,eAAgB,CACtF,KAAK,kBAAkB,aAAe,KAAK,gBAAgB,wBAC3D,MAAK,eAAe,mBAAqB,KAAK,kBAAkB,aAAa,KAE7E,MAAK,kBAAkB,gBAAkB,KAAK,gBAAgB,yBAC9D,MAAK,gBAAgB,oBAAoB,KAAK,kBAAkB,gBAAiB,EAEjF,IAAI,KAAK,eAAe,iBAAkB,CACzC,KAAK,kBAAkB,UAAY,KAAK,gBAAgB,yBACxD,MAAK,gBAAgB,oBAAoB,KAAK,kBAAkB,UAAW,GAG5E,KAAK,uBAAuB,KAAK,KAAK,kBAAkB,aAAa,WACrE,MAAK,2BAA2B,KAAK,KAAK,kBAAkB,gBAAgB,YAG7E,GAAI,KAAK,eAAe,mBAAqB,EAAG,CAC/C,KAAK,kBAAkB,YAAc,KAAK,gBAAgB,wBAC1D,MAAK,eAAe,kBAAoB,KAAK,kBAAkB,YAAY,KAE3E,MAAK,kBAAkB,eAAiB,KAAK,gBAAgB,yBAC7D,MAAK,gBAAgB,oBAAoB,KAAK,kBAAkB,eAAgB,EAEhF,MAAK,uBAAuB,KAAK,KAAK,kBAAkB,YAAY,WACpE,MAAK,2BAA2B,KAAK,KAAK,kBAAkB,eAAe,aAOtE,GAAA,UAAA,uBAAP,WAEC,KAAK,eAAe,sBAAwB,KAAK,WAAW,kBAC5D,MAAK,eAAe,aAAe,KAAK,WAAW,SACnD,MAAK,eAAe,cAAgB,KAAK,WAAW,MACpD,MAAK,eAAe,kBAAoB,KAAK,WAAW,MACxD,MAAK,eAAe,eAAiB,KAAK,WAAW,MACrD,MAAK,eAAe,gBAAkB,KAAK,WAAW,UACtD,MAAK,eAAe,eAAiB,KAAK,WAAW,cACrD,MAAK,eAAe,QAAU,KAAK,WAAW,OAC9C,MAAK,eAAe,MAAQ,KAAK,WAAW,KAE5C,MAAK,eAAe,sBAAwB,QAAQ,KAAK,eAAe,UAAY,EAAiB,aAErG,MAAK,eAAe,sBAAsB,KAAK,gBAMzC,GAAA,UAAA,QAAP,WAEC,KAAK,gBAAgB,SACrB,MAAK,gBAAkB,IACvB,MAAK,kBAAoB,KAM1B,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mDAMb,QAAA,eAAW,EAAA,UAAA,iCAAX,WAEC,MAAO,MAAK,gEAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kBAAkB,aAAa,+CAE7C,OAAA,KAEA,GAA4B,QAAnB,kYChbT,IAAO,GAAY,EAAe,4CAElC,IAAO,GAAgB,EAAc,2CAGrC,IAAO,GAAkB,EAAa,qEAWhC,GAAsB,SAAA,GAAS,EAA/B,EAAsB,EAe3B,SAfK,GAeO,EAA8B,EAAmC,GAE5E,EAAA,KAAA,KAAM,EAAU,EAAc,EAE9B,MAAK,sBAAwB,CAC7B,MAAK,sBAAwB,EAMvB,EAAA,UAAA,qBAAP,WAEC,EAAA,UAAM,qBAAoB,KAAA,KAG1B,IAAI,KAAK,sBAAsB,YAC9B,KAAK,oBAEN,IAAI,KAAK,sBAAsB,WAAY,CAC1C,KAAK,oBACL,MAAK,mBAGN,GAAI,KAAK,sBAAsB,WAC9B,KAAK,uBAEN,MAAK,cAAgB,KAAK,sBAAsB,4BAA4B,KAAK,sBAAuB,KAAK,gBAAiB,KAAK,kBACnI,MAAK,gBAAkB,KAAK,sBAAsB,8BAA8B,KAAK,sBAAuB,KAAK,gBAAiB,KAAK,mBAMjI,GAAA,UAAA,mBAAP,WAEC,GAAI,KAAK,sBAAsB,mBAAqB,EAAG,CACtD,KAAK,kBAAkB,aAAe,KAAK,kBAAkB,mBACvD,CACN,KAAK,kBAAkB,aAAe,KAAK,gBAAgB,2BAC3D,MAAK,gBAAgB,sBAAsB,KAAK,kBAAkB,aAAc,IAO1E,GAAA,UAAA,mBAAR,cAGK,GAAU,CAEd,IAAI,KAAK,yBAA0B,CAClC,EAAM,KAAK,yBAAyB,MACpC,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,KAAK,yBAAyB,GAAK,KAAK,gBAAgB,uBAExD,IAAI,KAAK,sBAAsB,2BAA6B,EAC3D,KAAK,sBAAsB,yBAA2B,KAAK,yBAAyB,GAAG,MAAM,GAIhG,GAAI,KAAK,2BAA4B,CACpC,EAAM,KAAK,2BAA2B,MACtC,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,KAAK,2BAA2B,GAAK,KAAK,gBAAgB,uBAE1D,IAAI,KAAK,sBAAsB,2BAA6B,EAC3D,KAAK,sBAAsB,yBAA2B,KAAK,2BAA2B,GAAG,MAAM,GAIlG,EAAM,KAAK,2BAA2B,MACtC,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,KAAK,2BAA2B,GAAK,KAAK,gBAAgB,yBAE1D,IAAI,KAAK,sBAAsB,6BAA+B,EAC7D,KAAK,sBAAsB,2BAA6B,KAAK,2BAA2B,GAAG,MAAM,EAGnG,EAAM,KAAK,6BAA6B,MACxC,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,KAAK,6BAA6B,GAAK,KAAK,gBAAgB,yBAE5D,IAAI,KAAK,sBAAsB,6BAA+B,EAC7D,KAAK,sBAAsB,2BAA6B,KAAK,6BAA6B,GAAG,MAAM,GAO9F,GAAA,UAAA,iBAAR,WAEC,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAAwB,CAC5B,IAAI,GAA0B,CAC9B,IAAI,GAAkB,KAAK,sBAAsB,qBACjD,IAAI,GAAkB,KAAK,sBAAsB,oBAGjD,KAAK,GAAI,GAAW,EAAG,EAAI,KAAK,sBAAsB,wBAAyB,EAAG,CACjF,GAAI,KAAK,sBAAsB,iBAAkB,CAChD,EAAc,KAAK,yBAAyB,IAE5C,IAAI,GAAqC,KAAK,gBAAgB,gBAE9D,MAAK,cAAgB,OAAS,EAAe,SAAW,EAAc,KAAO,KAAK,kBAAkB,gBAAkB,KACrH,OAAS,EAAe,OAAS,EAAc,MAEhD,GAAc,KAAK,gBAAgB,2BACnC,MAAK,gBAAgB,oBAAoB,EAAa,EAEtD,MAAK,gBAAkB,OAAS,EAAc,SAAW,EAAe,KACvE,OAAS,EAAc,OAAS,EAAe,WAE1C,CACN,EAAc,KAAK,2BAA2B,KAG/C,EAAkB,KAAK,2BAA2B,IAClD,GAAmB,KAAK,2BAA2B,IAEnD,IAAI,EACH,KAAK,gBAAkB,KAAK,sBAAsB,iCAAiC,KAAK,sBAAuB,EAAa,EAAiB,KAAK,gBAAiB,KAAK,kBAEzK,IAAI,EACH,KAAK,gBAAkB,KAAK,sBAAsB,kCAAkC,KAAK,sBAAuB,EAAa,EAAkB,KAAK,gBAAiB,KAAK,kBAE3K,IAAI,KAAK,sBAAsB,iBAC9B,KAAK,gBAAgB,sBAAsB,GAG7C,EAAiB,CACjB,GAAmB,CAGnB,KAAK,GAAI,GAAW,EAAG,EAAI,KAAK,sBAAsB,kBAAmB,EAAG,CAE3E,GAAI,KAAK,sBAAsB,mBAAqB,KAAK,sBAAsB,sBAC9E,EAAc,KAAK,2BAA2B,SAE9C,GAAc,KAAK,6BAA6B,IAEjD,GAAkB,KAAK,6BAA6B,IACpD,GAAmB,KAAK,6BAA6B,IAErD,GAAc,KAAK,gBAAgB,2BACnC,MAAK,gBAAgB,sBAAsB,EAAa,EAExD,IAAI,EAEJ,IAAI,KAAK,sBAAsB,iBAAkB,CAChD,EAAe,KAAK,gBAAgB,gBACpC,IAAI,GAA6B,KAAK,gBAAgB,yBACtD,MAAK,cAAgB,OAAS,EAAO,KAAO,EAAc,KAAO,KAAK,kBAAkB,cAAgB,KACvG,OAAS,EAAe,SAAW,EAAO,KAAO,KAAK,kBAAkB,gBAAkB,KAC1F,OAAS,EAAe,OAAS,KAAK,kBAAkB,cAAgB,WACnE,KAAK,KAAK,sBAAsB,sBAAuB,CAC7D,EAAe,KAAK,gBAAgB,gBACpC,MAAK,cAAgB,OAAS,EAAe,KAAO,EAAc,KAAO,KAAK,kBAAkB,qBAAuB,SACjH,CACN,EAAe,CACf,MAAK,gBAAkB,OAAS,EAAc,KAAO,EAAc,KAAO,KAAK,kBAAkB,sBAAwB,KAG1H,GAAI,KAAK,sBAAsB,iBAAkB,CAEhD,KAAK,gBACJ,OAAS,EAAc,OAAS,EAAe,KAAO,EAAe,KACrE,OAAS,EAAc,OAAS,EAAc,OAAS,EAAkB,OACzE,OAAS,EAAc,OAAS,EAAc,OAAS,EAAmB,OAC1E,OAAS,EAAc,OAAS,EAAc,OAC9C,OAAS,EAAc,OAAS,KAAK,kBAAkB,QAAU,OAAS,EAAc,OACxF,OAAS,EAAc,SAAW,EAAe,SAC5C,CACN,KAAK,gBAAkB,OAAS,EAAc,SAAW,EAAe,KACvE,OAAS,EAAc,OAAS,EAAe,OAGjD,GAAI,KAAK,sBAAsB,6BAA+B,EAC7D,KAAK,sBAAsB,2BAA6B,EAAY,MAAM,CAE3E,IAAI,EACH,KAAK,gBAAkB,KAAK,sBAAsB,iCAAiC,KAAK,sBAAuB,EAAa,EAAiB,KAAK,gBAAiB,KAAK,kBAEzK,IAAI,EACH,KAAK,gBAAkB,KAAK,sBAAsB,kCAAkC,KAAK,sBAAuB,EAAa,EAAkB,KAAK,gBAAiB,KAAK,kBAE3K,MAAK,gBAAgB,wBAAwB,IAOvC,GAAA,UAAA,sBAAR,WAEC,GAAI,EACJ,IAAI,IAAqB,KAAM,KAAM,KAAM,KAC3C,IAAI,GAA+C,GAAI,MACvD,IAAI,EACJ,IAAI,EACJ,IAAI,GAAkB,KAAK,sBAAsB,qBACjD,IAAI,GAAkB,KAAK,sBAAsB,oBAEjD,IAAI,EACH,KAAK,sBAAsB,yBAA2B,GAAI,MAE3D,IAAI,EACH,KAAK,sBAAsB,0BAA4B,GAAI,MAE5D,KAAK,EAAI,EAAG,EAAI,KAAK,sBAAuB,EAAG,CAC9C,EAAgB,GAAK,KAAK,gBAAgB,yBAE1C,IAAI,GAAK,EACR,KAAK,sBAAsB,kBAAoB,EAAgB,GAAG,MAAM,EAG1E,IAAK,EAAI,EAAG,EAAI,KAAK,sBAAsB,kBAAmB,EAAG,CAChE,EAAY,EAAgB,KAAK,MAAM,EAAE,IAAI,WAAa,EAAiB,EAAE,EAE7E,IAAI,EAAS,CACZ,EAAS,KAAK,gBAAgB,mBAC9B,MAAK,sBAAsB,yBAAyB,GAAK,EAAO,KAChE,MAAK,gBAAkB,KAAK,sBAAsB,iCAAiC,KAAK,sBAAuB,EAAQ,EAAW,KAAK,gBAAiB,KAAK,mBAG9J,GAAI,EAAS,CACZ,EAAS,KAAK,gBAAgB,mBAC9B,MAAK,sBAAsB,0BAA0B,GAAK,EAAO,KACjE,MAAK,gBAAkB,KAAK,sBAAsB,kCAAkC,KAAK,sBAAuB,EAAQ,EAAW,KAAK,gBAAiB,KAAK,qBAQ1J,GAAA,UAAA,qBAAP,WAEC,EAAA,UAAM,qBAAoB,KAAA,KAE1B,MAAK,sBAAsB,0BAA4B,CACvD,MAAK,sBAAsB,4BAA8B,CACzD,MAAK,sBAAsB,mBAAqB,CAEhD,MAAK,oBAAsB,KAAK,KAAK,KAAK,sBAAsB,gBAAgB,EAGhF,IAAI,KAAK,sBAAsB,mBAAqB,KAAK,sBAAsB,sBAAuB,CACrG,KAAK,2BAA6B,GAAI,OAA6B,KAAK,sBAAsB,gBAC9F,MAAK,6BAA+B,GAAI,OAA6B,KAAK,sBAAsB,gBAAgB,OAC1G,CACN,KAAK,6BAA+B,GAAI,OAA6B,KAAK,sBAAsB,gBAAgB,GAGjH,GAAI,KAAK,sBAAsB,iBAAkB,CAChD,KAAK,yBAA2B,GAAI,OAA6B,KAAK,sBAAsB,sBAC5F,MAAK,2BAA6B,GAAI,OAA6B,KAAK,sBAAsB,sBAAsB,OAC9G,CACN,KAAK,2BAA6B,GAAI,OAA6B,KAAK,sBAAsB,sBAAsB,IAQ/G,GAAA,UAAA,uBAAP,WAEC,GAAI,GAAsB,KAAK,sBAAsB,gBAAkB,KAAK,sBAAsB,qBAClG,IAAI,GAAwB,KAAK,sBAAsB,eACvD,IAAI,GAA6B,KAAK,WAAW,mBACjD,IAAI,GAA8B,KAAK,sBAAsB,iBAAkB,KAAK,WAAW,qBAAuB,CACtH,IAAI,GAA8B,EAAsB,CAExD,MAAK,sBAAsB,iBAAmB,KAAK,WAAW,oBAAsB,KAAK,sBAAsB,SAAW,EAAiB,oBAC3I,MAAK,sBAAsB,UAAY,EAAe,CACtD,MAAK,sBAAsB,eAAiB,KAAK,sBAAsB,eACvE,MAAK,sBAAsB,qBAAuB,KAAK,sBAAsB,qBAC7E,MAAK,sBAAsB,eAAiB,CAC5C,MAAK,sBAAsB,kBAAoB,KAAK,sBAAsB,iBAC1E,MAAK,sBAAsB,wBAA0B,KAAK,sBAAsB,uBAChF,MAAK,sBAAsB,kBAAoB,KAAK,sBAAsB,iBAC1E,MAAK,sBAAsB,YAAc,KAAK,sBAAsB,WACpE,MAAK,sBAAsB,WAAa,EAAe,IAAM,EAAuB,EAAa,SAAW,CAC5G,MAAK,sBAAsB,WAAa,EAAiB,IAAM,EAAuB,EAAa,SAAW,CAC9G,MAAK,sBAAsB,sBAAwB,EAAe,IAAM,EAAuB,EAAa,SAAW,CACvH,MAAK,sBAAsB,sBAAwB,EAAiB,IAAM,EAAuB,EAAa,SAAW,CACzH,MAAK,sBAAsB,qBAAuB,EAAe,IAAM,EAAsB,EAAa,SAAW,CACrH,MAAK,sBAAsB,qBAAuB,EAAiB,IAAM,EAAsB,EAAa,SAAW,CACvH,MAAK,sBAAsB,YAAc,KAAK,sBAAsB,eAEpE,GAAA,UAAM,uBAAsB,KAAA,MAE9B,OAAA,IA1TqC,EA4TL,GAAA,QAAvB,6VC7TT,IAAO,GAAsB,EAAY,qEACzC,IAAO,GAAgB,EAAc,mEAW/B,GAAoB,SAAA,GAAS,EAA7B,EAAoB,EAyEzB,SAzEK,GAyEO,GAEX,EAAA,KAAA,KAAM,GASA,EAAA,UAAA,eAAP,SAAsB,EAA8B,GAEnD,MAAO,IAAI,GAAuB,EAAU,EAAc,MAMpD,GAAA,UAAA,MAAP,WAEC,EAAA,UAAM,MAAK,KAAA,KAEX,MAAK,UAAY,CACjB,MAAK,iBAAmB,KAMlB,GAAA,UAAA,0BAAP,SAAiC,GAEhC,EAAA,UAAM,0BAAyB,KAAA,KAAC,EAEhC,IAAI,KAAK,eAAiB,GAAK,KAAK,WAAY,GAC7C,KAAK,qBAEP,IAAI,EACH,KAAK,sBAAwB,MAWzB,GAAA,UAAA,eAAP,SAAsB,EAA2B,EAAa,EAAe,GAE5E,EAAA,UAAM,eAAc,KAAA,KAAC,EAAY,EAAO,EAAQ,EAEhD,IAAI,KAAK,WACR,KAAK,cAEN,IAAI,KAAK,WACR,KAAK,aAAa,GAMZ,GAAA,UAAA,aAAR,WAEC,GAAI,EACJ,IAAI,EACJ,IAAI,GAAW,CACf,IAAI,GAAW,CACf,IAAI,EACJ,IAAI,EACJ,IAAI,GAAe,CACnB,IAAI,GAAuB,KAAK,YAAa,EAAI,CACjD,IAAI,EACJ,IAAI,EAEJ,MAAK,SAAW,KAAK,SAAW,KAAK,SAAW,CAEhD,GAAI,KAAK,wBACT,GAAI,KAAK,0BAET,IAAI,GAAc,CAClB,IAAI,GAAoC,KAAK,YAAY,iBACzD,GAAS,KAAK,uBACd,GAAM,KAAK,YAAY,kBAAkB,MAEzC,IAAI,EAAS,EAAK,CACjB,EAAO,CACP,IAAU,EAGX,KAAO,EAAO,IAAiB,EAAM,CACpC,GAAI,EACH,EAAY,KAAK,YAAY,wBAE9B,GAAM,EAAU,MAEhB,IAAI,EAAM,KAAK,qBACd,EAAM,KAAK,oBAEZ,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAW,EAAU,EAAS,EAC9B,GAAS,EAAS,cAElB,MAAK,UAAY,EAAS,UAC1B,MAAK,UAAY,EAAS,UAC1B,MAAK,UAAY,EAAS,UAE1B,IAAI,KAAK,iBAAkB,CAC1B,GAAI,IAAY,EAAO,CACvB,IAAI,IAAY,EAAO,CACvB,IAAI,IAAY,EAAO,CAEvB,MAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,CAC9H,MAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,CAC9H,MAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,IAAI,CAC/H,MAAK,mBAAmB,KAAO,MACzB,CACN,KAAK,qBAAqB,MAAQ,EAAO,CACzC,MAAK,qBAAqB,MAAQ,EAAO,CACzC,MAAK,qBAAqB,MAAQ,EAAO,CACzC,MAAK,qBAAqB,KAAO,EAGlC,KAAK,qBAAqB,KAAO,EAAS,UAC1C,MAAK,qBAAqB,KAAO,EAAS,UAC1C,MAAK,qBAAqB,KAAO,EAAS,UAC1C,MAAK,qBAAqB,KAAO,CAEjC,MAAK,qBAAqB,KAAO,EAAS,WAC1C,MAAK,qBAAqB,KAAO,EAAS,WAC1C,MAAK,qBAAqB,KAAO,EAAS,WAC1C,MAAK,qBAAqB,KAAO,CAEjC,MAAM,GAAS,KAAK,qBAAsB,CAEzC,EAAI,CACJ,GAAO,IAMV,GAAI,KAAK,qBAAuB,EAAO,CACtC,EAAI,GAAK,KAAK,qBAAuB,GAAO,EAE5C,OAAO,EAAI,EACV,KAAK,qBAAqB,KAAO,EAGnC,EAAQ,CAER,IAAI,GAAgC,KAAK,YAAY,WACrD,GAAS,KAAK,iBACd,GAAM,KAAK,YAAY,YAAY,MAEnC,IAAI,EAAS,EAAK,CACjB,EAAO,CACP,IAAU,MACJ,CACN,EAAO,EAGR,KAAO,EAAO,IAAiB,EAAM,CACpC,GAAI,EACH,EAAc,KAAK,YAAY,kBAEhC,GAAM,EAAY,MAElB,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAa,EAAY,EAAS,EAClC,GAAS,EAAW,aAEpB,MAAK,UAAY,EAAW,UAC5B,MAAK,UAAY,EAAW,UAC5B,MAAK,UAAY,EAAW,UAE5B,IAAI,KAAK,iBAAkB,CAC1B,EAAI,EAAO,CACX,GAAI,EAAO,CACX,GAAI,EAAO,CAEX,MAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAC5J;KAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAC5J,MAAK,mBAAmB,KAAO,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,IAAI,EAAI,KAAK,qBAAqB,GAC7J,MAAK,mBAAmB,KAAO,MACzB,KAAK,KAAK,sBAAuB,CACvC,KAAK,mBAAmB,KAAO,EAAO,CACtC,MAAK,mBAAmB,KAAO,EAAO,CACtC,MAAK,mBAAmB,KAAO,EAAO,CACtC,MAAK,mBAAmB,KAAO,MACzB,CACN,KAAK,qBAAqB,KAAO,EAAO,CACxC,MAAK,qBAAqB,KAAO,EAAO,CACxC,MAAK,qBAAqB,KAAO,EAAO,CACxC,MAAK,qBAAqB,KAAO,EAGlC,KAAK,qBAAqB,KAAO,EAAW,UAC5C,MAAK,qBAAqB,KAAO,EAAW,UAC5C,MAAK,qBAAqB,KAAO,EAAW,UAE5C,IAAI,GAAgB,EAAW,QAC/B,MAAK,qBAAqB,KAAO,EAAO,CAExC,MAAK,qBAAqB,KAAO,EAAW,WAC5C,MAAK,qBAAqB,KAAO,EAAW,WAC5C,MAAK,qBAAqB,KAAO,EAAW,WAC5C,MAAK,qBAAqB,KAAO,EAAW,eAE5C,MAAM,GAAS,KAAK,eAAgB,CAEnC,EAAI,CACJ,GAAO,IAMV,GAAI,KAAK,eAAiB,EAAO,CAChC,EAAI,GAAK,EAAQ,KAAK,gBAAgB,EAEtC,MAAO,EAAI,IAAK,EACf,KAAK,qBAAqB,GAAK,GAO1B,GAAA,UAAA,aAAR,SAAqB,GAEpB,GAAI,EACJ,IAAI,GAAgC,KAAK,YAAY,WACrD,IAAI,GAAwB,KAAK,YAAY,iBAC7C,IAAI,GAAa,EAAY,OAAS,KAAK,iBAC3C,IAAI,GAAkB,KAAK,oBAC3B,IAAI,GAAkB,KAAK,qBAE3B,MAAM,GAAW,GAChB,MAED,IAAI,EAAM,KAAK,eACd,EAAM,KAAK,cAEZ,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAQ,EAAa,KAAK,kBAAoB,EAE9C,IAAI,EACgB,EAAM,QAAS,oBAAoB,KAAK,yBAAyB,GAAI,EAAM,WAE/F,IAAI,EACgB,EAAM,QAAS,oBAAoB,KAAK,0BAA0B,GAAI,EAAM,aAGjG,IAAK,EAAI,EAAG,EAAI,IAAO,EACtB,KAAK,qBAAqB,KAAK,kBAAoB,GAAK,EAAQ,KAAK,kBAAoB,GAE5F,OAAA,IA3UmC,EA6UnC,GAA8B,QAArB,uKCjWT,GAAO,GAAmB,EAAa,8CAIvC,IAAO,GAAqB,EAAY,gDAQxC,IAAO,GAAkB,EAAa,qEAYhC,GAAgB,WAqLrB,QArLK,GAqLO,GAlLJ,KAAA,gBAAyB,EAAsB,IAEhD,MAAA,qBAAqC,GAAI,MAgDzC,MAAA,SAAkB,GAClB,MAAA,SAAkB,GAClB,MAAA,SAAkB,GAoElB,MAAA,sBAAgC,KAEhC,MAAA,mBAAmC,GAAI,MACvC,MAAA,qBAAqC,GAAI,MAyD/C,MAAK,QAAU,EAST,EAAA,UAAA,eAAP,SAAsB,EAA8B,GAEnD,MAAO,IAAI,GAAmB,EAAU,EAAc,MAMhD,GAAA,UAAA,MAAP,WAEC,KAAK,uBAAyB,CAC9B,MAAK,mBAAqB,CAC1B,MAAK,oBAAsB,CAC3B,MAAK,eAAiB,CACtB,MAAK,wBAA0B,CAC/B,MAAK,sBAAwB,CAC7B,MAAK,oBAAsB,CAC3B,MAAK,sBAAwB,KAC7B,MAAK,sBAAwB,KAC7B,MAAK,iBAAmB,KACxB,MAAK,eAAiB,KACtB,MAAK,sBAAwB,MAMvB,GAAA,UAAA,0BAAP,SAAiC,GAEhC,GAAI,KAAK,oBAAsB,IAC5B,KAAK,sBAGF,GAAA,UAAA,qBAAP,WAEC,KAAK,kBAAoB,CACzB,MAAK,qBAAuB,CAC5B,MAAK,eAAiB,CACtB,MAAK,kBAAoB,CACzB,MAAK,wBAA0B,CAC/B,MAAK,mBAAqB,CAC1B,MAAK,oBAAsB,CAC3B,MAAK,kBAAoB,CACzB,MAAK,wBAA0B,EAMzB,GAAA,UAAA,iBAAP,SAAwB,EAAmC,EAAoC,EAAwC,EAAiB,GAGvJ,KAAK,uBAAyB,EAAc,sBAC5C,MAAK,yBAA2B,EAAc,wBAC9C,MAAK,eAAiB,EAAc,cACpC,MAAK,gBAAkB,EAAc,eACrC,MAAK,gBAAkB,EAAc,eACrC,MAAK,yBAA2B,EAAc,wBAE9C,MAAK,qBAAuB,CAC5B,MAAK,yBAA2B,CAChC,MAAK,SAAW,CAChB,MAAK,SAAW,CAEhB,MAAK,mBAAmB,OAAS,KAAK,uBAAuB,CAC7D,MAAK,qBAAqB,OAAS,KAAK,yBAAyB,CAGjE,MAAK,qBAAqB,KAAK,kBAAoB,EACnD,MAAK,qBAAqB,KAAK,iBAAmB,GAAK,CACvD,MAAK,qBAAqB,KAAK,iBAAmB,GAAK,EAAE,GACzD,MAAK,qBAAqB,KAAK,iBAAmB,GAAK,CAGvD,IAAI,KAAK,kBAAoB,EAAG,CAC/B,KAAK,mBAAmB,KAAK,kBAAoB,CACjD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAGtD,GAAI,KAAK,qBAAuB,EAC/B,KAAK,mBAAmB,KAAK,oBAAsB,GAAK,EAOnD,GAAA,UAAA,UAAP,SAAiB,EAAa,GAE7B,EAAM,QAAQ,WAAW,KAAK,aAAc,EAAsB,KAAO,KAAK,gBAAiB,EAAO,WAAW,iBAEjH,KAAK,KAAK,kBAAoB,KAAK,qBAAuB,EAAG,CAC5D,GAAI,GAAe,EAAO,aAE1B,MAAK,mBAAmB,KAAK,qBAAuB,EAAI,CACxD,MAAK,mBAAmB,KAAK,oBAAsB,GAAK,EAAI,CAC5D,MAAK,mBAAmB,KAAK,oBAAsB,GAAK,EAAI,GAOvD,GAAA,UAAA,YAAP,SAAmB,IAaZ,GAAA,UAAA,eAAP,SAAsB,EAA2B,EAAa,EAAe,GAE5E,GAAI,GAA0B,EAAM,OAEpC,IAAI,EAAW,cAAc,SACZ,EAAW,cAAc,SAAU,eAAe,KAAM,EAAY,EAAO,EAAQ,KAAK,uBAAwB,KAAK,eAEtI,IAAI,KAAK,eAAiB,EACzB,EAAQ,eAAe,KAAK,cAAe,EAAW,cAAc,EAAoB,SAAU,EAAW,gBAAgB,EAAoB,SAAU,EAAoB,UAEhL,IAAI,KAAK,wBAA0B,EAClC,EAAQ,eAAe,KAAK,uBAAwB,EAAW,cAAc,EAAoB,mBAAoB,EAAW,gBAAgB,EAAoB,mBAAoB,EAAoB,oBAE7M,IAAI,KAAK,mBAAqB,EAC7B,EAAQ,eAAe,KAAK,kBAAmB,EAAW,cAAc,EAAoB,aAAc,EAAW,gBAAgB,EAAoB,aAAc,EAAoB,cAE5L,IAAI,KAAK,oBAAsB,EAC9B,EAAQ,eAAe,KAAK,mBAAoB,EAAW,cAAc,EAAoB,cAAe,EAAW,gBAAgB,EAAoB,cAAe,EAAoB,eAG/L,IAAI,KAAK,gBAAiB,CACzB,GAAI,GAAqB,EAAW,cAAc,YAAY,MAE9D,IAAI,EAAa,CAChB,KAAK,mBAAmB,KAAK,kBAAoB,EAAY,CAC7D,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAAY,CACjE,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAAY,EACjE,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAAY,CACjE,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAAY,CACjE,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,EAAY,OAC3D,CACN,KAAK,mBAAmB,KAAK,kBAAoB,CACjD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,CACrD,MAAK,mBAAmB,KAAK,iBAAmB,GAAK,GAIvD,GAAI,KAAK,wBAA0B,EAClC,EAAW,aAAa,sBAAsB,cAAc,KAAK,mBAAoB,KAAK,uBAAwB,MAEnH,IAAI,KAAK,kBAAoB,KAAK,qBAAuB,EAAG,CAE3D,EAAW,aAAa,sBAAsB,cAAc,KAAK,qBACjE,IAAI,GAAe,EAAO,aAC1B,IAAI,GAAW,EAAI,CACnB,IAAI,GAAW,EAAI,CACnB,IAAI,GAAW,EAAI,CAEnB,MAAK,mBAAmB,KAAK,qBAAuB,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GACjL,MAAK,mBAAmB,KAAK,oBAAsB,GAAK,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GACrL,MAAK,mBAAmB,KAAK,oBAAsB,GAAK,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,GAAG,EAAI,KAAK,qBAAqB,IAAI,EAAI,KAAK,qBAAqB,KAIjL,GAAA,UAAA,QAAP,YAID,OAAA,KAEA,GAA0B,QAAjB,sMCxZT,GAAO,GAAY,EAAe,2DAClC,IAAO,GAAqB,EAAY,wEAKlC,GAAmB,WA4BxB,QA5BK,GA4BO,GAZJ,KAAA,wBAAiC,CACjC,MAAA,0BAAmC,CACnC,MAAA,gBAAyB,CACzB,MAAA,iBAA0B,CAC1B,MAAA,iBAA0B,CAUjC,MAAK,SAAW,EAMV,EAAA,UAAA,MAAP,WAEC,KAAK,mBAAqB,GAAI,GAAa,KAAM,EAAG,MACpD,MAAK,iBAAmB,GAAI,GAAa,KAAM,EAAG,MAClD,MAAK,cAAgB,GAAI,GAAa,IAAK,EAC3C,MAAK,cAAgB,GAAI,GAAa,KAAM,EAC5C,MAAK,uBAAyB,GAAI,GAAa,KAAM,EACrD,MAAK,wBAA0B,GAAI,GAAa,KAAM,GACtD,MAAK,sBAAwB,GAAI,GAAa,KAAM,IACpD,MAAK,wBAA0B,GAAI,GAAsB,MAAO,EAChE,MAAK,sBAAwB,GAAI,GAAsB,MAAO,EAC9D,MAAK,wBAA0B,CAC/B,MAAK,gBAAkB,CACvB,MAAK,iBAAmB,CACxB,MAAK,iBAAmB,CACxB,MAAK,0BAA4B,CAEjC,IAAI,EAEJ,KAAK,EAAI,EAAG,EAAI,KAAK,0BAA2B,EAC/C,KAAK,wBAEN,KAAK,EAAI,EAAG,EAAI,KAAK,wBAAyB,EAC7C,KAAK,uBAEN,KAAK,EAAI,EAAG,EAAI,KAAK,kBAAmB,EACvC,KAAK,gBAEN,KAAK,EAAI,EAAG,EAAI,KAAK,0BAA2B,EAC/C,KAAK,0BAMA,GAAA,UAAA,QAAP,WAEC,KAAK,mBAAmB,SACxB,MAAK,iBAAiB,SACtB,MAAK,cAAc,SACnB,MAAK,wBAAwB,SAC7B,MAAK,uBAAuB,SAE5B,MAAK,mBAAqB,IAC1B,MAAK,iBAAmB,IACxB,MAAK,cAAgB,IACrB,MAAK,wBAA0B,IAC/B,MAAK,uBAAyB,IAC9B,MAAK,wBAA0B,IAC/B,MAAK,sBAAwB,KASvB,GAAA,UAAA,sBAAP,SAA6B,EAAgC,GAE5D,KAAK,mBAAmB,SAAS,EAAU,GAOrC,GAAA,UAAA,wBAAP,SAA+B,GAE9B,KAAK,mBAAmB,YAAY,GAS9B,GAAA,UAAA,oBAAP,SAA2B,EAAgC,GAE1D,KAAK,iBAAiB,SAAS,EAAU,GAOnC,GAAA,UAAA,sBAAP,SAA6B,GAE5B,KAAK,iBAAiB,YAAY,GAO5B,GAAA,UAAA,0BAAP,WAEC,MAAO,MAAK,mBAAmB,uBAMzB,GAAA,UAAA,0BAAP,WAEC,MAAO,MAAK,mBAAmB,0BAMzB,GAAA,UAAA,eAAP,aAEG,KAAK,gBACP,OAAO,MAAK,cAAc,uBAMpB,GAAA,UAAA,wBAAP,aAEG,KAAK,yBACP,OAAO,MAAK,wBAAwB,uBAM9B,GAAA,UAAA,sBAAP,aAEG,KAAK,uBACP,OAAO,MAAK,sBAAsB,uBAM5B,GAAA,UAAA,wBAAP,WAEC,MAAO,MAAK,iBAAiB,uBAMvB,GAAA,UAAA,wBAAP,WAEC,MAAO,MAAK,iBAAiB,0BAMvB,GAAA,UAAA,uBAAP,aAEG,KAAK,eACP,OAAO,MAAK,uBAAuB,uBAM7B,GAAA,UAAA,kBAAP,aAEG,KAAK,gBACP,OAAO,MAAK,cAAc,uBAM3B,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,2BAGb,SAAgC,GAE/B,KAAK,sBAAwB,sCAM9B,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,6BAGb,SAAkC,GAEjC,KAAK,wBAA0B,sCAMhC,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAGb,SAA0B,GAEzB,KAAK,gBAAkB,sCAMxB,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,6BAGb,SAAkC,GAEjC,KAAK,wBAA0B,sCAMhC,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,4DAMb,QAAA,eAAW,EAAA,UAAA,8BAAX,WAEC,MAAO,MAAK,4DAMb,QAAA,eAAW,EAAA,UAAA,gCAAX,WAEC,MAAO,MAAK,8DAMb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,oDAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAEd,OAAA,KAEA,GAA6B,QAApB,qKCpTH,GAAkB,WAuBvB,QAvBK,MA2BN,MAAA,KAEA,GAA4B,QAAnB,+BC/BH,GAAqB,WAiB1B,QAjBK,GAiBO,EAAgB,EAAc,GAAA,GAAA,QAAA,GAAqB,CAArB,GAAoB,EAE7D,KAAK,WAAa,CAClB,MAAK,SAAW,CAChB,MAAK,OAAS,CAEd,MAAK,OAAS,KAAK,QAEnB,IAAI,KAAK,QAAU,EAClB,KAAK,QAAU,KAAK,MAErB,IAAI,GAAa,EAChB,KAAK,QAAU,IAAM,EAAsB,WAAW,GAMjD,EAAA,UAAA,SAAP,WAEC,MAAO,MAAK,OAMb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,6CAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,2CA/CE,GAAA,YAAc,IAAK,IAAK,IAAK,IAiD7C,OAAA,KAE+B,GAAA,QAAtB,0LC1DT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAQrC,IAAO,GAAiB,EAAa,4DACrC,IAAO,GAAoB,EAAa,iEAKlC,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAcvB,SAdK,KAgBJ,EAAA,KAAA,KAdO,MAAA,OAAgB,QAChB,MAAA,OAAgB,CAEhB,MAAA,QAAiB,CACjB,MAAA,QAAiB,CACjB,MAAA,QAAiB,CAEjB,MAAA,SAAkB,EAanB,EAAA,UAAA,QAAP,SAAe,EAA+B,GAE7C,EAAS,QAAU,QAAQ,EAAa,SAAW,MAM7C,GAAA,UAAA,eAAP,SAAsB,EAA+B,GAEpD,IAAK,EAAS,QAAS,CACtB,KAAK,OAAS,EAAa,KAC3B,MAAK,eAOP,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,GAAI,KAAK,UAAY,EACpB,MAED,MAAK,SAAW,CAEhB,MAAK,kDAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CAEd,MAAK,kDAMC,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAAQ,CACZ,IAAI,GAA4C,EAM1C,GAAA,UAAA,iBAAP,SAAwB,EAA+B,EAAmB,EAAiC,EAAmC,GAE7I,GAAI,GAAc,EAClB,IAAI,EAEJ,IAAI,EAAS,QAAS,CACrB,EAAuB,EAAc,mBAErC,GAAS,cAAgB,EAAqB,KAE9C,IAAQ,EAAqB,mBAAmB,EAAW,EAAiB,EAAsB,EAAa,QAAS,EAAa,kBAAmB,EAAa,eAAgB,EAAa,cAElM,IAAI,EAAa,eAAiB,EAAG,CACpC,GAAI,GAAkC,EAAc,yBACpD,GAAS,uBAAyB,EAAU,MAAM,CAElD,IAAQ,OAAS,EAAY,OAAS,EAAY,OAAS,EAAY,OACtE,OAAS,EAAY,OACrB,OAAS,EAAY,OAAS,EAAY,OAAS,EAAY,YAG3D,CACN,EAAuB,EAAc,yBACrC,GAAS,uBAAyB,EAAqB,MAAM,CAE7D,IAAQ,OAAS,EAAY,KAAO,EAAuB,KAG5D,MAAO,GAMD,GAAA,UAAA,UAAP,SAAiB,EAA+B,EAAmB,GAElE,GAAI,EAAS,QAAS,CACrB,EAAM,QAAQ,kBAAkB,EAAS,cAAe,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAO,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAU,EAAmB,QACjT,GAAM,QAAQ,gBAAgB,EAAS,cAAe,EAAa,QAEnE,IAAI,EAAa,eAAiB,EACjC,EAAa,qBAAqB,EAAS,wBAA0B,EAAa,mBAC7E,CACN,GAAI,GAAe,EAAS,sBAC5B,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,KAAK,OACnB,GAAK,EAAQ,GAAK,KAAK,OACvB,GAAK,EAAQ,GAAK,KAAK,OACvB,GAAK,EAAQ,GAAK,KAAK,QAOjB,GAAA,UAAA,YAAR,WAEC,KAAK,SAAY,KAAK,QAAU,GAAM,KAAM,IAAK,KAAK,QACtD,MAAK,SAAY,KAAK,QAAU,EAAK,KAAM,IAAK,KAAK,QACrD,MAAK,SAAW,KAAK,OAAS,KAAM,IAAK,KAAK,SAEhD,OAAA,IAnJiC,EAqJL,GAAA,QAAnB,gdClKT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAQrC,IAAO,GAAkB,EAAa,6DACtC,IAAO,GAAoB,EAAa,iEAMlC,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAuBvB,SAvBK,KAyBJ,EAAA,KAAA,KAvBO,MAAA,UAAoB,IAOpB,MAAA,cAAuB,QACvB,MAAA,cAAuB,QACvB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,EAYpB,EAAA,UAAA,QAAP,SAAe,GAEd,IAAK,EAAa,UACjB,MAAO,MAER,OAAO,MAMR,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,UAAY,CAEjB,MAAK,+DAGC,GAAA,UAAA,QAAP,SAAe,EAAmC,GAEjD,EAAS,QAAU,KAAK,YACxB,GAAS,aAAe,EAAa,UAAY,EAO3C,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,KAAK,aACR,EAAM,QAAQ,gBAAgB,EAAG,KAAK,UAMxC,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,oDAMN,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,oDAON,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,GAAI,GAAa,GAAS,IAE1B,IAAI,GAAK,KAAK,cAAiB,GAAS,KAAK,WAAa,EAAM,YAAc,KAAK,SAAS,YAAc,EAAM,QAAU,KAAK,SAAS,QACvI,KAAK,0BAEN,MAAK,aAAe,CACpB,MAAK,SAAW,sCAMV,GAAA,UAAA,QAAP,WAEC,KAAK,SAAW,KAMV,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAA+C,CAEnD,MAAK,QAAU,EAAK,OACpB,MAAK,SAAW,EAAK,QACrB,MAAK,aAAe,EAAK,YACzB,MAAK,aAAe,EAAK,aAMnB,GAAA,UAAA,sBAAP,WAEC,EAAA,UAAM,sBAAqB,KAAA,KAE3B,MAAK,qBAAuB,IAC5B,MAAK,uBAAyB,KAMxB,GAAA,UAAA,4BAAP,SAAmC,EAAmC,EAAmB,EAAmC,GAE3H,GAAI,GAAc,EAElB,MAAK,eAAiB,IAEtB,MAAK,qBAAuB,EAAc,2BAC1C,GAAc,sBAAsB,KAAK,qBAAsB,EAE/D,OAAO,GAMD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAmC,EAAmC,EAAmC,GAE9L,GAAI,GAAc,EAClB,IAAI,EAGJ,IAAI,KAAK,eAAgB,CACxB,EAAI,KAAK,yBACH,CACN,EAAI,EAAc,2BAClB,GAAc,sBAAsB,EAAG,GAGxC,GAAQ,OAAS,EAAI,OAAS,EAAc,KAAO,EAAgB,eAAiB,KAClF,OAAS,EAAI,OAAS,EAAI,OAAS,EAAgB,QAAU,MAE/D,IAAI,EAAa,iBAChB,GAAQ,OAAS,EAAI,OAAS,EAAI,OAAS,EAAc,MAE1D,IAAI,KAAK,kBAAoB,KAC5B,GAAQ,KAAK,iBAAiB,EAAc,EAAU,EAAG,EAAe,EAEzE,IAAQ,OAAS,EAAI,KAAO,EAAI,OAAS,EAAc,IAEvD,KAAK,KAAK,eAAgB,CACzB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAI,IAC/F,GAAc,wBAAwB,GAGvC,KAAK,eAAiB,KAEtB,OAAO,GAMD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAkC,EAAuB,EAAmC,GAEjL,GAAI,GAAc,EAClB,IAAI,EAGJ,IAAI,KAAK,eAAgB,CACxB,EAAI,KAAK,yBACH,CACN,EAAI,EAAc,2BAClB,GAAc,sBAAsB,EAAG,GAGxC,GAAQ,OAAS,EAAI,KAAO,EAAgB,eAAiB,KAAO,EAAa,6BAC/E,OAAS,EAAI,SAAW,EAAI,SAAW,EAAiB,IAE1D,IAAI,KAAK,kBAAoB,KAC5B,GAAQ,KAAK,iBAAiB,EAAc,EAAU,EAAG,EAAe,EAEzE,KAAK,KAAK,eAAgB,CACzB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAI,IAC/F,GAAc,wBAAwB,GAGvC,KAAK,eAAiB,KAEtB,OAAO,GAMD,GAAA,UAAA,6BAAP,SAAoC,EAAmC,EAAmB,EAAiC,EAAmC,GAE7J,GAAI,GAAc,EAElB,IAAI,EACJ,IAAI,EAGJ,IAAI,EAAgB,aACnB,GAAQ,KAAK,aAAa,EAAc,EAAU,EAAe,EAElE,GAAS,EAAc,2BACvB,GAAc,sBAAsB,EAAQ,EAE5C,IAAI,GAA6C,EAAc,yBAC/D,GAAS,uBAAyB,EAAqB,MAAM,CAE7D,IAAI,KAAK,aAAc,CACtB,KAAK,uBAAyB,EAAc,mBAE5C,GAAS,cAAgB,KAAK,uBAAuB,KAErD,IAAQ,EAAqB,mBAAmB,EAAQ,EAAiB,KAAK,uBAAwB,KAAK,SAAU,EAAa,kBAAmB,EAAa,eAAgB,EAAa,mBAEzL,CACN,KAAK,uBAAyB,EAAc,yBAE5C,IAAQ,OAAS,EAAS,KAAO,KAAK,uBAAyB,KAGhE,GAAQ,OAAS,KAAK,qBAAuB,KAAO,KAAK,qBAAuB,KAC/E,OAAS,EAAS,SAAW,EAAS,KAAO,KAAK,qBAAuB,IAE1E,IAAI,KAAK,UAAW,CACnB,GAAQ,OAAS,EAAS,SAAW,EAAS,KAAO,EAAuB,KAC3E,OAAS,EAAY,SAAW,EAAY,KAAO,EAAS,SACvD,CACN,GAAQ,OAAS,EAAY,SAAW,EAAY,KAAO,EAAuB,KACjF,OAAS,KAAK,qBAAuB,SAAW,EAAY,KAAO,KAAK,qBAAuB,KAC/F,OAAS,EAAY,SAAW,EAAY,KAAO,KAAK,qBAAuB,KAC/E,OAAS,EAAY,SAAW,EAAY,KAAO,EAAS,KAG9D,EAAc,wBAAwB,KAAK,qBAC3C,GAAc,wBAAwB,EAEtC,OAAO,GAQD,GAAA,UAAA,aAAP,SAAoB,EAAmC,EAAmB,EAA8B,GAEvG,MAAO,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAgB,aAAe,OAMnH,GAAA,UAAA,UAAP,SAAiB,EAAmC,EAAmB,GAEtE,GAAI,KAAK,aAAc,CACtB,EAAM,QAAQ,kBAAkB,EAAS,cAAe,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAS,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAY,EAAmB,QACrT,GAAM,QAAQ,gBAAgB,EAAS,cAAe,KAAK,cACrD,CACN,GAAI,GAAe,EAAS,sBAC5B,IAAI,GAAqB,EAAa,oBACtC,GAAK,EAAQ,GAAK,KAAK,SACvB,GAAK,EAAQ,GAAK,KAAK,SACvB,GAAK,EAAQ,GAAK,KAAK,SACvB,GAAK,EAAQ,GAAK,GAOZ,GAAA,UAAA,cAAR,WAEC,KAAK,WAAc,KAAK,eAAiB,GAAM,KAAM,GACrD,MAAK,WAAc,KAAK,eAAiB,EAAK,KAAM,GACpD,MAAK,WAAa,KAAK,cAAgB,KAAM,IAMtC,GAAA,UAAA,cAAR,WAEC,KAAK,WAAc,KAAK,eAAiB,GAAM,KAAM,GACrD,MAAK,WAAc,KAAK,eAAiB,EAAK,KAAM,GACpD,MAAK,WAAa,KAAK,cAAgB,KAAM,IAMvC,GAAA,UAAA,gBAAP,SAAuB,EAAmC,EAAmB,EAA2B,EAAa,GAGpH,GAAI,EAAa,UAAY,EAAG,CAC/B,GAAI,GAAe,EAAS,sBAC5B,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,EAAa,SAAS,KAAK,SACzC,GAAK,EAAQ,GAAK,EAAa,SAAS,KAAK,SAC7C,GAAK,EAAQ,GAAK,EAAa,SAAS,KAAK,SAC7C,GAAK,EAAQ,GAAK,GAGrB,OAAA,IArWiC,EAuWjC,GAA4B,QAAnB,idCpXT,IAAO,GAAgB,EAAc,+DAM/B,GAA0B,SAAA,GAAS,EAAnC,EAA0B,EAO/B,SAPK,KASJ,EAAA,KAAA,MAMD,OAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAGb,SAA0B,GAEzB,KAAK,gBAAkB,sCAMjB,GAAA,UAAA,iBAAP,SAAwB,EAA+B,EAAmB,EAAiC,EAAmC,GAE7I,GAAI,GAAc,EAClB,IAAI,GAAqC,EAAc,yBACvD,IAAI,GAAqC,EAAc,yBAEvD,GAAS,uBAAyB,EAAa,MAAM,CAIrD,IAAQ,OAAS,EAAY,KAAO,EAAY,KAAO,EAAe,KAAO,OAAS,EAAY,KAAO,EAAY,KAAO,EAAe,IAE3I,OAAO,GAMD,GAAA,UAAA,UAAP,SAAiB,EAA+B,EAAmB,GAElE,GAAI,GAAa,EAAE,GACnB,IAAI,GAAe,EAAS,sBAC5B,IAAI,GAAqB,EAAa,oBAEtC,GAAK,GAAS,KAAK,gBAAgB,aACnC,GAAK,EAAQ,GAAK,KAAK,gBAAgB,eACvC,GAAK,EAAQ,GAAK,KAAK,gBAAgB,cACvC,GAAK,EAAQ,GAAK,KAAK,gBAAgB,eACvC,GAAK,EAAQ,GAAK,KAAK,gBAAgB,UAAU,CACjD,GAAK,EAAQ,GAAK,KAAK,gBAAgB,YAAY,CACnD,GAAK,EAAQ,GAAK,KAAK,gBAAgB,WAAW,CAClD,GAAK,EAAQ,GAAK,KAAK,gBAAgB,YAAY,EAGrD,OAAA,IA9DyC,EAgEzC,GAAoC,QAA3B,wPC/ET,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAmB,EAAa,6CAOvC,IAAO,GAAiB,EAAa,gEAM/B,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAErB,SAFK,KAIJ,EAAA,KAAA,MAMD,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,mDAUX,GAAA,UAAA,iBAAP,SAAwB,EAA+B,EAAmB,EAAiC,EAAmC,GAE7I,KAAM,IAAI,EACV,OAAO,GAET,OAAA,IA3B+B,EA6B/B,GAA0B,QAAjB,kVCtCT,IAAO,GAAiB,EAAa,gEAM/B,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAUvB,SAVK,KAYJ,EAAA,KAAA,MASM,EAAA,UAAA,4BAAP,SAAmC,EAAmC,EAAmB,EAAmC,GAE3H,MAAO,GAWD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAmC,EAAmC,EAAmC,GAE9L,MAAO,GAWD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAkC,EAAuB,EAAmC,GAEjL,MAAO,GAWD,GAAA,UAAA,6BAAP,SAAoC,EAAmC,EAAmB,EAAiC,EAAmC,GAE7J,MAAO,GAET,OAAA,IAhEiC,EAkEjC,GAA4B,QAAnB,yPC3ET,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAOrC,IAAO,GAAiB,EAAa,4DACrC,IAAO,GAAoB,EAAa,iEAKlC,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EAStB,SATK,KAWJ,EAAA,KAAA,MAGM,EAAA,UAAA,QAAP,SAAe,GAEd,IAAK,KAAK,cAAgB,EAAa,mBACtC,MAAO,MAER,OAAO,MAMD,GAAA,UAAA,QAAP,SAAe,EAA+B,GAE7C,EAAS,QAAU,KAAK,YAMlB,GAAA,UAAA,uBAAP,WAEC,MAAO,MAMD,GAAA,UAAA,SAAP,SAAgB,GAEf,GAAI,GAAQ,CACZ,IAAI,GAA4C,CAEhD,IAAI,EAAI,WAAa,KACpB,KAAK,UAAY,EAAI,UAMvB,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,cAGb,SAAqB,GAEpB,GAAI,GAAa,GAAS,IAE1B,IAAI,GAAK,KAAK,aAAgB,GAAS,KAAK,WAAa,EAAM,YAAc,KAAK,SAAS,YAAc,EAAM,QAAU,KAAK,SAAS,QACtI,KAAK,0BAEN,MAAK,YAAc,CACnB,MAAK,SAAW,sCAOV,GAAA,UAAA,sBAAP,WAEC,EAAA,UAAM,sBAAqB,KAAA,KAC3B,MAAK,wBAA0B,KAMzB,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,SACR,KAAK,SAAW,KAMX,GAAA,UAAA,UAAP,SAAiB,EAA+B,EAAmB,GAElE,GAAI,EAAS,eAAiB,EAAG,CAChC,EAAM,QAAQ,kBAAkB,EAAS,cAAe,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAS,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAY,EAAmB,QACrT,GAAM,QAAQ,gBAAgB,EAAS,cAAe,KAAK,WAOtD,GAAA,UAAA,iBAAP,SAAwB,EAA+B,EAAmB,EAAiC,EAAmC,GAE7I,KAAK,wBAA0B,EAAc,mBAE7C,GAAS,cAAgB,KAAK,wBAAwB,KAEtD,OAAO,GAAqB,mBAAmB,EAAW,EAAiB,KAAK,wBAAyB,KAAK,SAAU,EAAa,kBAAmB,EAAa,eAAgB,EAAa,eACjM,OAAS,EAAY,SAAW,EAAY,SAAW,EAAgB,QAAU,SACjF,OAAS,EAAY,SAAW,EAAY,KAE/C,OAAA,IAhHgC,EAkHL,GAAA,QAAlB,gdCpIT,IAAO,GAAc,EAAc,yCAOnC,IAAO,GAAkB,EAAa,sDAahC,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EAOtB,SAPK,KASJ,EAAA,KAAA,MAGM,EAAA,UAAA,QAAP,SAAe,GAEd,MAAO,MAUD,GAAA,UAAA,QAAP,SAAe,EAA+B,IAYvC,GAAA,UAAA,eAAP,SAAsB,EAA+B,IAS9C,GAAA,UAAA,kBAAP,WAEC,MAAO,MAMR,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAMN,GAAA,UAAA,QAAP,YAUO,GAAA,UAAA,OAAP,WAEC,KAAK,wBAQC,GAAA,UAAA,sBAAP,YAWO,GAAA,UAAA,eAAP,SAAsB,EAA+B,EAAmB,EAAmC,GAE1G,MAAO,GAMD,GAAA,UAAA,iBAAP,SAAwB,EAA+B,EAAmB,EAAiC,EAAmC,GAE7I,MAAO,MAWD,GAAA,UAAA,UAAP,SAAiB,EAA+B,EAAmB,IAe5D,GAAA,UAAA,gBAAP,SAAuB,EAA+B,EAAmB,EAA2B,EAAa,IAY1G,GAAA,UAAA,YAAP,SAAmB,EAA+B,EAAmB,IAU9D,GAAA,UAAA,yBAAP,WAEC,KAAK,cAAc,GAAI,GAAmB,EAAmB,qBAMvD,GAAA,UAAA,SAAP,SAAgB,IAGjB,OAAA,IAjKgC,EAmKhC,GAA2B,QAAlB,4RCpLT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAQrC,IAAO,GAAkB,EAAa,6DAEtC,IAAO,GAAoB,EAAa,iEAMlC,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAqBxB,SArBK,KAuBJ,EAAA,KAAA,KAbO,MAAA,OAAgB,EAChB,MAAA,UAAmB,CACnB,MAAA,eAAwB,QACzB,MAAA,YAAqB,CACrB,MAAA,YAAqB,CACrB,MAAA,YAAqB,EAWrB,EAAA,UAAA,QAAP,SAAe,GAEd,IAAK,EAAa,UACjB,MAAO,MAER,OAAO,MAMD,GAAA,UAAA,QAAP,SAAe,EAAmC,GAEjD,EAAS,QAAU,KAAK,YACxB,GAAS,aAAe,EAAa,UAAY,CACjD,GAAS,UAAY,EAAa,UAAY,EAM/C,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,sCAMf,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,GAAI,GAAS,KAAK,UACjB,MAED,MAAK,UAAY,CACjB,MAAK,qDAMN,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAGD,IAAI,KAAK,gBAAkB,GAAK,GAAS,EACxC,KAAK,0BAEN,MAAK,eAAiB,CACtB,MAAK,qDAQN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,GAAI,GAAc,GAAS,IAE3B,IAAI,GAAK,KAAK,cAAiB,GAAS,KAAK,WAAa,EAAM,YAAc,KAAK,SAAS,YAAc,EAAM,QAAU,KAAK,SAAS,QACvI,KAAK,0BAEN,MAAK,aAAe,CACpB,MAAK,SAAW,sCAOV,GAAA,UAAA,SAAP,SAAgB,GAGf,GAAI,GAAQ,CACZ,IAAI,GAAgD,CAEpD,IAAI,GAA2B,CAC/B,MAAK,QAAU,EAAK,OACpB,MAAK,SAAW,EAAK,QACrB,MAAK,cAAgB,EAAK,aAC1B,MAAK,MAAQ,EAAK,MAMZ,GAAA,UAAA,sBAAP,WAEC,EAAA,UAAM,sBAAqB,KAAA,KAC3B,MAAK,qBAAuB,IAC5B,MAAK,0BAA4B,IACjC,MAAK,kBAAoB,IACzB,MAAK,uBAAyB,KAMxB,GAAA,UAAA,4BAAP,SAAmC,EAAmC,EAAmB,EAAmC,GAE3H,GAAI,GAAc,EAElB,MAAK,eAAiB,IAEtB,MAAK,uBAAyB,EAAc,yBAC5C,GAAS,uBAAyB,KAAK,uBAAuB,MAAM,CAEpE,IAAI,KAAK,aAAc,CAEtB,KAAK,kBAAoB,EAAc,2BACvC,GAAc,sBAAsB,KAAK,kBAAmB,EAC5D,MAAK,0BAA4B,EAAc,mBAC/C,GAAS,cAAgB,KAAK,0BAA0B,KACxD,GAAO,EAAqB,mBAAmB,KAAK,kBAAmB,EAAiB,KAAK,0BAA2B,KAAK,SAAU,EAAa,kBAAmB,EAAa,eAAgB,EAAa,mBAE3M,CAEN,KAAK,0BAA4B,KAGlC,KAAK,qBAAuB,EAAc,2BAC1C,GAAc,sBAAsB,KAAK,qBAAsB,EAE/D,OAAO,GAMD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAmC,EAAmC,EAAmC,GAE9L,GAAI,GAAc,EAClB,IAAI,EAEJ,IAAI,KAAK,eAAgB,CACxB,EAAI,KAAK,yBACH,CACN,EAAI,EAAc,2BAClB,GAAc,sBAAsB,EAAG,GAGxC,GAAI,GAAmC,EAAgB,eACvD,IAAI,GAAkC,EAAgB,cAGtD,IAAQ,OAAS,EAAI,KAAO,EAAc,KAAO,EAAa,KAC5D,OAAS,EAAI,SAAW,EAAI,KAC5B,OAAS,EAAI,OAAS,EAAY,KAAO,EAAI,KAC7C,OAAS,EAAI,OAAS,EAAI,MAE5B,IAAI,KAAK,aAAc,CAEtB,GAAQ,OAAS,KAAK,kBAAoB,OAAS,KAAK,kBAAoB,OAAS,KAAK,uBAAyB,OACjH,OAAS,EAAI,OAAS,EAAI,OAAS,KAAK,kBAAoB,WACxD,CACN,GAAQ,OAAS,EAAI,OAAS,EAAI,OAAS,KAAK,uBAAyB,OAI1E,GAAI,EAAa,iBAChB,GAAQ,OAAS,EAAI,OAAS,EAAI,OAAS,EAAc,MAE1D,IAAI,KAAK,kBAAoB,KAC5B,GAAQ,KAAK,iBAAiB,EAAc,EAAU,EAAG,EAAe,EAEzE,IAAQ,OAAS,EAAI,SAAW,EAAc,KAAO,EAAI,MAEzD,KAAK,KAAK,eAAgB,CACzB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAI,IAC/F;EAAc,wBAAwB,GAGvC,KAAK,eAAiB,KAEtB,OAAO,GAMD,GAAA,UAAA,yBAAP,SAAgC,EAAmC,EAAmB,EAAkC,EAAuB,EAAmC,GAEjL,GAAI,GAAc,EAClB,IAAI,EAGJ,IAAI,KAAK,eAAgB,CACxB,EAAI,KAAK,yBACH,CACN,EAAI,EAAc,2BAClB,GAAc,sBAAsB,EAAG,GAGxC,GAAI,GAAkC,EAAgB,cACtD,IAAI,GAAmC,EAAgB,eAEvD,IAAQ,OAAS,EAAI,OAAS,EAAY,KAAO,EAAa,KAC5D,OAAS,EAAI,OAAS,EAAI,OAAS,EAAI,OACvC,OAAS,EAAI,KAAO,EAAI,OAAS,EAAY,KAC7C,OAAS,EAAI,KAAO,EAAI,KAAO,EAAa,KAC5C,OAAS,EAAI,KAAO,EAAI,KAAO,EAAa,WAAa,EAAa,kBAAmB,SAAS,WAAa,gBAC/G,OAAS,EAAI,SAAW,EAAI,KAAO,EAAiB,IAEtD,IAAI,KAAK,kBAAoB,KAC5B,GAAQ,KAAK,iBAAiB,EAAc,EAAU,EAAG,EAAe,EAEzE,KAAK,KAAK,eAAgB,CACzB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAI,IAC/F,GAAc,wBAAwB,GAGvC,KAAK,eAAiB,KAEtB,OAAO,GAMD,GAAA,UAAA,6BAAP,SAAoC,EAAmC,EAAmB,EAAiC,EAAmC,GAE7J,GAAI,GAAc,EAElB,IAAI,EAAgB,aACnB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,EAAgB,aAAe,MAE3H,IAAI,KAAK,aAAc,CAEtB,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,KAAK,kBAAoB,MACpH,GAAc,wBAAwB,KAAK,mBAI5C,GAAQ,OAAS,KAAK,qBAAuB,SAAW,KAAK,qBAAuB,KAAO,KAAK,uBAAyB,KACxH,OAAS,EAAY,SAAW,EAAY,KAAO,KAAK,qBAAuB,IAChF,GAAc,wBAAwB,KAAK,qBAE3C,OAAO,GAMD,GAAA,UAAA,UAAP,SAAiB,EAAmC,EAAmB,GAEtE,GAAI,KAAK,aAAc,CACtB,EAAM,QAAQ,kBAAkB,EAAS,cAAe,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAO,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAU,EAAmB,QACjT,GAAM,QAAQ,gBAAgB,EAAS,cAAe,KAAK,UAG5D,GAAI,GAAe,EAAS,sBAC5B,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,KAAK,WACnB,GAAK,EAAQ,GAAK,KAAK,WACvB,GAAK,EAAQ,GAAK,KAAK,WACvB,GAAK,EAAQ,GAAK,KAAK,OAMhB,GAAA,UAAA,eAAR,WAEC,KAAK,aAAiB,KAAK,gBAAkB,GAAM,KAAM,IAAK,KAAK,SACnE,MAAK,aAAiB,KAAK,gBAAkB,EAAK,KAAM,IAAK,KAAK,SAClE,MAAK,aAAgB,KAAK,eAAiB,KAAM,IAAK,KAAK,UAE7D,OAAA,IA7TkC,EA+TlC,GAA6B,QAApB,idC7UT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAWrC,IAAO,GAAgB,EAAc,0DACrC,IAAO,GAAoB,EAAa,iEAOlC,GAAY,SAAA,GAAS,EAArB,EAAY,EAUjB,SAVK,KAYJ,EAAA,KAAA,MAMM,EAAA,UAAA,mBAAP,SAA0B,GAEzB,EAAA,UAAM,mBAAkB,KAAA,KAAC,EAEzB,IAAI,GAAe,KAAK,uBACxB,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,CACd,GAAK,EAAQ,GAAK,GAClB,GAAK,EAAQ,GAAK,KAClB,GAAK,EAAQ,GAAK,QAClB,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAGZ,GAAA,UAAA,sBAAP,SAA6B,GAE5B,EAAa,wBAEb,IAAI,EAAa,eAAiB,EACjC,EAAa,iBAMR,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAAmC,GAE1F,GAAI,GAAc,EAClB,IAAI,GAAkC,EAAgB,YACtD,IAAI,GAAwC,EAAc,mBAC1D,IAAI,GAAiC,EAAc,yBACnD,IAAI,GAAiC,EAAc,yBAEnD,MAAK,wBAA0B,EAAS,MAAM,CAE9C,IAAI,GAA8B,EAAc,2BAChD,GAAc,sBAAsB,EAAO,EAC3C,IAAI,GAA8B,EAAc,2BAChD,GAAc,sBAAsB,EAAO,EAE3C,IAAQ,OAAS,EAAQ,KAAO,EAAgB,mBAAqB,KAAO,EAAgB,mBAAqB,OAChH,OAAS,EAAQ,KAAO,EAAW,KAAO,EAAQ,OAClD,OAAS,EAAQ,KAAO,EAAQ,KAChC,OAAS,EAAQ,KAAO,EAAQ,UAAY,EAAW,IAKxD,IAAI,EAAa,eAAiB,EAAG,CACpC,EAAkB,EAAc,mBAEhC,MAAK,eAAiB,EAAgB,KAEtC,IAAI,GAA+B,EAAc,2BACjD,IAAQ,EAAqB,mBAAmB,EAAQ,EAAiB,EAAiB,EAAa,QAAS,EAAa,kBAAmB,EAAa,eAAgB,EAAa,cAE1L,IAAI,GAAkC,EAAc,yBAEpD,IAAQ,OAAS,EAAS,OAAS,EAAS,OAAS,EAAY,OAChE,OAAS,EAAS,OAGpB,GAAQ,OAAS,EAAY,KAAO,EAAQ,KAAO,EAAQ,IAE3D,GAAc,wBAAwB,EACtC,GAAc,wBAAwB,EAEtC,OAAO,GAGD,GAAA,UAAA,SAAP,SAAgB,EAAuB,EAA2B,EAAa,EAAe,IAQvF,GAAA,UAAA,WAAP,SAAkB,EAAuB,EAAuB,GAE/D,EAAA,UAAM,WAAU,KAAA,KAAC,EAAM,EAAU,EAEjC,IAAI,GAA0B,EAAS,OACvC,IAAI,GAAgC,EAAK,YAEzC,IAAI,EAAa,eAAiB,EAAG,CACpC,EAAQ,kBAAkB,KAAK,eAAgB,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAS,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAY,EAAmB,QAC5S,GAAQ,gBAAgB,KAAK,eAAgB,EAAa,QAE1D,GAAa,qBAAqB,KAAK,wBAA0B,GAAK,EAAK,aAAa,gBAG3F,OAAA,IAhH2B,EAkH3B,GAAsB,QAAb,8cCxIT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CAUrC,IAAO,GAAgB,EAAc,0DACrC,IAAO,GAAoB,EAAa,iEAOlC,GAAe,SAAA,GAAS,EAAxB,EAAe,EAUpB,SAVK,KAYJ,EAAA,KAAA,MAMM,EAAA,UAAA,mBAAP,SAA0B,GAEzB,EAAA,UAAM,mBAAkB,KAAA,KAAC,EAEzB,IAAI,GAAe,KAAK,uBACxB,IAAI,GAAqB,EAAa,oBACtC,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAAI,GACtB,GAAK,EAAQ,GAAK,EAGZ,GAAA,UAAA,sBAAP,SAA6B,GAE5B,EAAa,wBACb,GAAa,qBAEb,IAAI,EAAa,eAAiB,EACjC,EAAa,gBAEd,GAAa,0BAA0B,OAMjC,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAAmC,GAE1F,GAAI,EACJ,IAAI,GAAkC,EAAgB,YACtD,IAAI,GAAwC,EAAc,mBAC1D,IAAI,GAAiC,EAAc,yBACnD,IAAI,GAAiC,EAAc,yBAEnD,MAAK,wBAA0B,EAAS,MAAM,CAE9C,IAAI,GAA8B,EAAc,2BAChD,GAAc,sBAAsB,EAAO,EAC3C,IAAI,GAA8B,EAAc,2BAChD,GAAc,sBAAsB,EAAO,EAG3C,GAAO,OAAS,EAAQ,OAAS,EAAgB,eAAiB,SAAW,EAAgB,eAAiB,SAC1G,OAAS,EAAQ,KAAO,EAAW,KAAO,EAAQ,OAClD,OAAS,EAAQ,KAAO,EAAQ,KAChC,OAAS,EAAQ,KAAO,EAAQ,UAAY,EAAW,IAE3D,IAAI,EAAa,eAAiB,EAAG,CACpC,EAAkB,EAAc,mBAEhC,MAAK,eAAiB,EAAgB,KAEtC,IAAI,GAA+B,EAAc,2BACjD,IAAQ,EAAqB,mBAAmB,EAAQ,EAAiB,EAAiB,EAAa,QAAS,EAAa,kBAAmB,EAAa,eAAgB,EAAa,cAE1L,IAAI,GAAkC,EAAc,yBAEpD,IAAQ,OAAS,EAAS,OAAS,EAAS,OAAS,EAAY,OAChE,OAAS,EAAS,OAGpB,GAAQ,OAAS,EAAY,KAAO,EAAQ,KAAO,EAAQ,IAE3D,OAAO,GAMD,GAAA,UAAA,WAAP,SAAkB,EAAuB,EAAuB,GAE/D,EAAA,UAAM,WAAU,KAAA,KAAC,EAAM,EAAU,EAEjC,IAAI,GAA0B,EAAS,OACvC,IAAI,GAAgC,EAAK,YAEzC,IAAI,GAAW,EAAO,WAAW,GAEjC,GAAI,GAAG,EAAE,EAAE,MAEP,GAAe,KAAK,uBACxB,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,EAAI,CAClB,GAAK,EAAQ,GAAK,IAAM,CACxB,GAAK,EAAQ,GAAK,MAAQ,CAC1B,GAAK,EAAQ,GAAK,SAAW,CAE7B,IAAI,EAAa,eAAiB,EAAG,CACpC,EAAQ,kBAAkB,KAAK,eAAgB,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAS,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAY,EAAmB,QAC5S,GAAQ,gBAAgB,KAAK,eAAgB,EAAa,QAE1D,GAAK,EAAQ,GAAK,EAAK,aAAa,gBAGvC,OAAA,IAhH8B,EAkH9B,GAAyB,QAAhB,8cCxIT,IAAO,GAAgB,EAAc,8DAK/B,GAAa,SAAA,GAAS,EAAtB,EAAa,EAOlB,SAPK,KASJ,EAAA,KAAA,MAMM,EAAA,UAAA,kBAAP,SAAyB,EAA+B,EAA8B,GAErF,GAAI,GAAkC,EAAU,YAEhD,OAAO,OAAS,EAAY,SAE9B,OAAA,IArB4B,EAuBL,GAAA,QAAd,uPC9BT,IAAO,GAAc,EAAc,yCACnC,IAAO,GAAa,EAAc,uCAClC,IAAO,GAAK,EAAgB,+BAE5B,IAAO,GAAS,EAAe,oCAM/B,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAoB,EAAa,+CAKxC,IAAO,GAAgB,EAAc,+DAIrC,IAAO,GAAgB,EAAc,8DAQ/B,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAkJrB,SAlJK,GAkJO,GAlJb,GAAA,GAAA,IAkJa,IAAA,QAAA,GAAsB,CAAtB,EAAA,EAEX,EAAA,KAAA,KAlJO,MAAA,kBAA4C,GAAI,MAChD,MAAA,WAAoB,CACpB,MAAA,eAAyB,IACzB,MAAA,gBAA0B,IAC1B,MAAA,kBAA4B,KAE5B,MAAA,yBAAkC,CAClC,MAAA,mBAA4B,CAC5B,MAAA,mBAA4B,CAE7B,MAAA,iBAA0B,CAC1B,MAAA,uBAAgC,CAChC,MAAA,iBAA0B,CAC1B,MAAA,YAAqB,CAIpB,MAAA,kBAA2B,EAAqB,UAEhD,MAAA,mBAA4B,EAAqB,GACjD,MAAA,iBAA0B,EAAqB,IAEhD,MAAA,iBAA2B,KAI1B,MAAA,YAAsB,IA0H7B,MAAK,UAAY,CAEjB,MAAK,wBAA0B,SAAC,GAAgB,MAAA,GAAK,eAAe,IAtHrE,OAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,oBAGb,SAAyB,GAExB,GAAI,KAAK,gBAAkB,EAC1B,MAED,MAAK,eAAiB,CAEtB,MAAK,uDAMN,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAGb,SAA0B,GAEzB,GAAI,KAAK,iBAAmB,EAC3B,MAED,MAAK,gBAAkB,CAEvB,MAAK,uDAQN,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,GAAI,KAAK,mBAAqB,EAC7B,MAED,MAAK,kBAAoB,CAEzB,MAAK,uDAMN,QAAA,eAAW,EAAA,UAAA,+BAAX,WAEC,MAAO,MAAK,8BAGb,SAAmC,GAElC,KAAK,yBAA2B,sCAOjC,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wBAGb,SAA6B,GAE5B,KAAK,mBAAqB,sCAO3B,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,wBAGb,SAA6B,GAE5B,KAAK,mBAAqB,sCAM3B,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,eAGb,SAAoB,GAEnB,KAAK,UAAY,CAEjB,MAAK,uDAoBC,GAAA,UAAA,mBAAP,SAA0B,GAEzB,MAAO,IAAI,GAAiB,GAM7B,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,KAAK,YAAc,sCAQpB,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uBAGb,SAA4B,GAE3B,KAAK,kBAAoB,sCAOnB,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,cACR,KAAK,cAAc,oBAAoB,EAAM,OAAQ,KAAK,wBAE3D,OAAO,KAAK,kBAAkB,OAC7B,KAAK,kBAAkB,GAAG,SAE3B,MAAK,kBAAoB,KAQnB,GAAA,UAAA,SAAP,SAAgB,EAAuB,EAA2B,EAAa,EAAe,GAE7F,KAAK,eAAe,EAAM,EAAY,EAAO,EAAQ,GAU/C,GAAA,UAAA,eAAP,SAAsB,EAAuB,EAA2B,EAAa,EAAe,GAEnG,EAAK,aAAa,eAAe,EAAY,EAAO,EAAQ,GAatD,GAAA,UAAA,aAAP,SAAoB,GAEnB,OAAQ,GAEP,IAAK,GAAU,OAEd,KAAK,mBAAqB,EAAqB,GAC/C,MAAK,iBAAmB,EAAqB,IAC7C,MAAK,iBAAmB,KAExB,MAED,KAAK,GAAU,MAEd,KAAK,mBAAqB,EAAqB,YAC/C,MAAK,iBAAmB,EAAqB,sBAC7C,MAAK,iBAAmB,IAExB,MAED,KAAK,GAAU,SAEd,KAAK,mBAAqB,EAAqB,IAC/C,MAAK,iBAAmB,EAAqB,YAC7C,MAAK,iBAAmB,IAExB,MAED,KAAK,GAAU,IAEd,KAAK,mBAAqB,EAAqB,YAC/C,MAAK,iBAAmB,EAAqB,GAC7C,MAAK,iBAAmB,IAExB,MAED,KAAK,GAAU,MAEd,KAAK,mBAAqB,EAAqB,IAC/C,MAAK,iBAAmB,EAAqB,YAC7C,MAAK,iBAAmB,IAExB,MAED,SAEC,KAAM,IAAI,GAAc,4BAYpB,GAAA,UAAA,WAAP,SAAkB,EAAuB,EAAuB,GAE/D,EAAS,QAAQ,aAAe,KAAK,cAAgB,KAAK,iBAAoB,KAAK,kBAEnF,IAAI,KAAK,iBACR,EAAS,QAAQ,gBAAgB,KAAK,mBAAoB,KAAK,iBAEhE,GAAS,qBAAqB,EAAM,GAS9B,GAAA,UAAA,aAAP,SAAoB,EAAuB,GAE1C,EAAS,uBAAuB,EAEhC,GAAS,QAAQ,aAAa,KAAM,EAAqB,YAQnD,GAAA,UAAA,iBAAP,WAEC,GAAI,GAAa,KAAK,kBAAkB,MACxC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,kBAAkB,GAAG,YAE3B,MAAK,cAAc,GAAI,GAAM,EAAM,SASpC,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,mBAGb,SAAuB,GAEtB,GAAI,KAAK,cACR,KAAK,cAAc,oBAAoB,EAAM,OAAQ,KAAK,wBAE3D,MAAK,cAAgB,CAErB,IAAI,KAAK,cACR,KAAK,cAAc,iBAAiB,EAAM,OAAQ,KAAK,wBAExD,MAAK,oDAME,GAAA,UAAA,eAAR,SAAuB,GAEtB,KAAK,gBAMC,GAAA,UAAA,cAAP,WAEC,GAAI,GAAiC,KAAK,sBAC1C,IAAI,GAA2B,KAAK,gBACpC,IAAI,GAA2B,KAAK,gBAEpC,IAAI,KAAK,eAAkB,KAAK,UAAY,EAAiB,SAAW,CACvE,KAAK,uBAAyB,KAAK,8BAA8B,KAAK,cAAc,qBACpF,MAAK,iBAAmB,KAAK,wBAAwB,KAAK,cAAc,eACxE,MAAK,iBAAmB,KAAK,mBAAmB,KAAK,cAAc,eAEnE,IAAI,KAAK,gBAAiB,CACzB,KAAK,wBAA0B,KAAK,cAAc,2BAClD,MAAK,kBAAoB,KAAK,cAAc,2BAGvC,CACN,KAAK,uBAAyB,CAC9B,MAAK,iBAAmB,CACxB,MAAK,iBAAmB,EAGzB,KAAK,YAAc,KAAK,uBAAyB,KAAK,gBAEtD,IAAI,GAA2B,KAAK,wBAA0B,GAAqB,KAAK,kBAAoB,GAAqB,KAAK,iBACrI,KAAK,mBAGA,GAAA,UAAA,sBAAP,SAA6B,GAE5B,GAAI,KAAK,kBACR,EAAa,uBAEd,GAAa,eAAiB,KAAK,iBAAiB,EACpD,GAAa,sBAAwB,EAAa,gBAAkB,KAAK,wBAAwB,EACjG,GAAa,iBAAmB,EAAa,uBAAyB,KAAK,mBAAmB,EAE9F,KAAK,EAAa,iBACjB,EAAa,0BAA0B,QAAQ,KAAK,UAAY,EAAiB,UAI5E,GAAA,UAAA,mBAAP,SAA0B,IAKnB,GAAA,UAAA,2BAAP,SAAkC,EAA+B,EAAmC,GAEnG,MAAO,GAGD,GAAA,UAAA,6BAAP,SAAoC,EAA+B,EAAmC,GAErG,MAAO,GAGD,GAAA,UAAA,gBAAP,SAAuB,EAA+B,EAAmC,GAExF,MAAO,GAGD,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAAmC,GAE1F,MAAO,GAGD,GAAA,UAAA,sBAAP,SAA6B,EAA+B,EAAmC,GAE9F,MAAO,GAGD,GAAA,UAAA,wBAAP,SAA+B,EAA+B,EAAmC,GAEhG,MAAO,GAMR,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAMb,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,2DAMb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAMN,GAAA,UAAA,iBAAP,SAAwB,GAEvB,MAAO,OAMD,GAAA,UAAA,wBAAP,SAA+B,GAE9B,MAAO,OAOD,GAAA,UAAA,mBAAP,SAA0B,GAEzB,MAAO,OAQA,GAAA,UAAA,8BAAR,SAAsC,GAErC,MAAO,MAAK,IAAI,EAAuB,KAAK,yBAA0B,KAAK,YAQpE,GAAA,UAAA,wBAAR,SAAgC,GAE/B,GAAI,GAAiB,KAAK,WAAa,KAAK,sBAC5C,OAAO,MAAK,IAAI,EAAiB,KAAK,mBAAoB,GAQnD,GAAA,UAAA,mBAAR,SAA2B,GAE1B,GAAI,GAAqB,CAQzB,OAAO,MAAK,IAAI,EAAiB,KAAK,mBAAqB,EAAE,EAAe,GAGtE,GAAA,UAAA,sBAAP,SAA6B,GAE5B,KAAK,kBAAkB,KAAK,EAE5B,OAAO,GAGD,GAAA,UAAA,yBAAP,SAAgC,GAE/B,KAAK,kBAAkB,OAAO,KAAK,kBAAkB,QAAQ,GAAmB,EAEhF,OAAO,GAET,OAAA,IApiB+B,EAsiB/B,GAA0B,QAAjB,qaCpkBT,GAAM,GAAgB,WAAtB,QAAM,MAES,EAAA,QAAiB,CAIjB,GAAA,SAAkB,CAIlB,GAAA,aAAsB,CACrC,OAAA,KAEA,GAA0B,QAAjB,0LCVT,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAiB,EAAa,4CASrC,IAAO,GAAgB,EAAc,0DACrC,IAAO,GAAoB,EAAa,iEAOlC,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EA8CtB,SA9CK,KAgDJ,EAAA,KAAA,KA9CO,MAAA,cAAuB,QACvB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,CACnB,MAAA,UAAmB,EAQ3B,OAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,eAGb,SAAwB,GAEvB,KAAK,UAAY,sCAMlB,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,CAErB,MAAK,WAAc,KAAK,eAAiB,GAAM,KAAM,GACrD,MAAK,WAAc,KAAK,eAAiB,EAAK,KAAM,GACpD,MAAK,WAAa,KAAK,cAAgB,KAAM,wCAgBvC,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAA8B,GAErF,GAAI,GAAc,EAClB,IAAI,GAAkC,EAAU,YAChD,IAAI,EAEJ,IAAI,EAAa,SAAW,KAAM,CACjC,EAAkB,EAAS,mBAE3B,MAAK,eAAiB,EAAgB,KAEtC,IAAQ,EAAqB,mBAAmB,EAAW,EAAW,EAAiB,EAAa,QAAS,EAAa,kBAAmB,EAAa,eAAgB,EAAa,cAEvL,IAAI,EAAa,eAAiB,EAAG,CACpC,GAAI,GAAkC,EAAS,yBAC/C,MAAK,wBAA0B,EAAU,MAAM,CAE/C,IAAQ,OAAS,EAAY,OAAS,EAAY,OAAS,EAAY,OACtE,OAAS,EAAY,OACrB,OAAS,EAAY,OAAS,EAAY,OAAS,EAAY,YAG3D,CACN,EAAkB,EAAS,yBAE3B,MAAK,wBAA0B,EAAgB,MAAM,CAErD,IAAQ,OAAS,EAAY,KAAO,EAAkB,KAGvD,MAAO,GAGD,GAAA,UAAA,sBAAP,SAA6B,GAE5B,GAAI,EAAkB,SAAW,KAChC,EAAkB,iBAMb,GAAA,UAAA,WAAP,SAAkB,EAAuB,EAAuB,GAE/D,EAAA,UAAM,WAAU,KAAA,KAAC,EAAM,EAAU,EAEjC,IAAI,GAAgC,EAAK,YAEzC,IAAI,EAAa,SAAW,KAAM,CACjC,EAAS,QAAQ,kBAAkB,KAAK,eAAgB,EAAa,eAAgB,EAAkB,OAAO,EAAkB,MAAO,EAAa,kBAAmB,EAAuB,OAAS,EAAuB,QAAS,EAAa,cAAe,EAAmB,UAAY,EAAmB,QACrT,GAAS,QAAQ,gBAAgB,KAAK,eAAgB,EAAa,QAEnE,IAAI,EAAa,eAAiB,EACjC,EAAa,qBAAqB,KAAK,yBAA2B,EAAa,mBAC1E,CACN,GAAI,GAAe,KAAK,uBACxB,IAAI,GAAqB,EAAa,oBACtC,GAAK,GAAS,KAAK,SACnB,GAAK,EAAQ,GAAK,KAAK,SACvB,GAAK,EAAQ,GAAK,KAAK,SACvB,GAAK,EAAQ,GAAK,KAAK,WAG1B,OAAA,IArHgC,EAuHhC,GAA2B,QAAlB,8cC9HT,IAAO,GAAkB,EAAc,kDACvC,IAAO,GAAQ,EAAiB,uDAChC,IAAO,GAAoB,EAAc,mEACzC,IAAO,GAAgB,EAAe,+DAMtC,IAAO,GAA0B,EAAY,qEAO7C,IAAO,GAAgB,EAAe,0DACtC,IAAO,GAAgB,EAAe,8DAOhC,GAAkB,SAAA,GAAS,EAA3B,EAAkB,EAmBvB,SAnBK,GAmBO,GAnBb,GAAA,GAAA,IAmBa,IAAA,QAAA,GAAsB,CAAtB,EAAA,EAEX,EAAA,KAAA,KAAM,EAbA,MAAA,YAA8B,GAAI,MAElC,MAAA,uBAAgC,CAatC,MAAK,6BAA+B,SAAC,GAA6B,MAAA,GAAK,oBAAoB,IAQrF,EAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,KAAK,eAAkB,KAAK,SAAW,EAAiB,SAC3D,MAAO,IAAI,GAAqB,EAEjC,OAAO,IAAI,GAAiB,GAMtB,GAAA,UAAA,mBAAP,SAA0B,GAEzB,EAAA,UAAM,mBAAkB,KAAA,KAAC,MAGrB,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,KAAK,YAAY,GAAG,OAAO,eAAe,EAAc,KAAK,YAAY,IAM3E,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,qBAAsB,KAAK,qBAAqB,eAAiB,UAG9E,SAA0B,GAEzB,GAAI,EAAO,CACV,GAAI,KAAK,sBAAwB,KAChC,KAAK,qBAAuB,GAAI,EAEjC,MAAK,qBAAqB,eAAiB,MAErC,KAAK,EAAO,CAClB,GAAI,KAAK,qBACR,KAAK,qBAAuB,0CAO/B,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,yBAAuD,KAAK,yBAAyB,OAAS,UAG3G,SAAgC,GAE/B,GAAI,KAAK,0BAA4B,KAAK,yBAAyB,QAAU,EAC5E,MAED,IAAI,KAAK,yBAA0B,CAClC,KAAK,kBAAkB,KAAK,yBAC5B,MAAK,yBAA2B,KAGjC,GAAI,EAAO,CACV,KAAK,yBAA2B,GAAI,GAAS,EAC7C,MAAK,eAAe,KAAK,+DAInB,GAAA,UAAA,kBAAR,SAA0B,EAAmB,GAAA,GAAA,QAAA,GAAiC,CAAjC,EAAA,MAE5C,GAAI,GAAe,KAAK,YAAY,QAAQ,EAE5C,KAAK,EACJ,KAAK,wBAEN,GAAS,OAAO,oBAAoB,EAAmB,mBAAoB,KAAK,6BAChF,MAAK,YAAY,OAAO,EAAO,EAE/B,MAAK,mBAGE,GAAA,UAAA,eAAR,SAAuB,EAAmB,EAAmC,GAAnC,GAAA,QAAA,GAAiC,CAAjC,EAAA,MAAmC,GAAA,QAAA,GAAiB,CAAjB,GAAgB,EAE5F,EAAS,OAAO,iBAAiB,EAAmB,mBAAoB,KAAK,6BAE7E,IAAI,EAAmB,CACtB,GAAI,IAAU,EACb,KAAK,YAAY,OAAO,EAAQ,KAAK,YAAY,OAAS,KAAK,uBAAwB,EAAG,OAE1F,MAAK,YAAY,KAAK,EACvB,MAAK,6BACC,CACN,KAAK,YAAY,OAAO,KAAK,YAAY,OAAS,KAAK,uBAAwB,EAAG,GAGnF,KAAK,mBAQC,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,eAAe,GAAI,GAAS,GAAS,MAM3C,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,2DASN,GAAA,UAAA,gBAAP,SAAuB,GAEtB,MAAO,MAAK,uBAAuB,IAAW,KAQxC,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,EAAQ,GAAK,EAAQ,KAAK,uBAAyB,EACtD,MAAO,KAER,OAA0B,MAAK,YAAY,EAAQ,KAAK,YAAY,OAAS,KAAK,wBAAwB,OAQpG,GAAA,UAAA,kBAAP,SAAyB,EAAyB,GAEjD,KAAK,eAAe,GAAI,GAAS,GAAS,KAAM,GAO1C,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,GAAoB,KAAK,uBAAuB,EAEpD,IAAI,GAAY,KACf,KAAK,kBAAkB,EAAU,MAI3B,GAAA,UAAA,uBAAR,SAA+B,GAE9B,GAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,GAAI,KAAK,YAAY,GAAG,QAAU,EACjC,MAAO,MAAK,YAAY,EAE1B,OAAO,MAMR,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,iBAAsC,KAAK,iBAAiB,OAAS,UAGlF,SAAwB,GAEvB,GAAI,KAAK,kBAAoB,KAAK,iBAAiB,QAAU,EAC5D,MAED,IAAI,KAAK,iBAAkB,CAC1B,KAAK,kBAAkB,KAAK,iBAC5B,MAAK,iBAAmB,KAGzB,GAAI,EAAO,CACV,KAAK,iBAAmB,GAAI,GAAS,EACrC,MAAK,eAAe,KAAK,uDAO3B,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kBAAwC,KAAK,kBAAkB,OAAS,UAGrF,SAAyB,GAExB,GAAI,KAAK,mBAAqB,KAAK,kBAAkB,QAAU,EAC9D,MAED,IAAI,KAAK,kBAAmB,CAC3B,KAAK,kBAAkB,KAAK,kBAC5B,MAAK,kBAAoB,KAG1B,GAAI,EAAO,CACV,KAAK,kBAAoB,GAAI,GAAS,EACtC,MAAK,eAAe,KAAK,wDAO3B,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,iBAAwC,KAAK,iBAAiB,OAAS,UAGpF,SAAwB,GAEvB,GAAI,KAAK,kBAAoB,KAAK,iBAAiB,QAAU,EAC5D,MAED,IAAI,KAAK,iBAAkB,CAC1B,KAAK,kBAAkB,KAAK,iBAC5B,MAAK,iBAAmB,KAGzB,GAAI,EAAO,CACV,KAAK,iBAAmB,GAAI,GAAS,EACrC,MAAK,eAAe,KAAK,uDAO3B,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kBAAwC,KAAK,kBAAkB,OAAS,UAGrF,SAAyB,GAExB,GAAI,KAAK,mBAAqB,KAAK,kBAAkB,QAAU,EAC9D,MAED,IAAI,KAAK,kBAAmB,CAC3B,KAAK,kBAAkB,KAAK,kBAC5B,MAAK,kBAAoB,KAG1B,GAAI,EAAO,CACV,KAAK,kBAAoB,GAAI,GAAS,EACtC,MAAK,eAAe,KAAK,wDAO3B,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,mBAA0C,KAAK,mBAAmB,OAAS,UAGxF,SAA0B,GAEzB,GAAI,KAAK,oBAAsB,KAAK,mBAAmB,QAAU,EAChE,MAED,IAAI,KAAK,mBAAoB,CAC5B,KAAK,kBAAkB,KAAK,mBAC5B,MAAK,mBAAqB,KAG3B,GAAI,EAAO,CACV,KAAK,mBAAqB,GAAI,GAAS,EACvC,MAAK,eAAe,KAAK,yDAOpB,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,OAAO,KAAK,YAAY,OACvB,KAAK,kBAAkB,KAAK,YAAY,GAEzC,MAAK,YAAc,KAMZ,GAAA,UAAA,oBAAR,SAA4B,GAE3B,KAAK,mBAQC,GAAA,UAAA,WAAP,SAAkB,EAAuB,EAAuB,GAE/D,EAAA,UAAM,WAAU,KAAA,KAAC,EAAM,EAAU,EAEjC,IAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,UACZ,EAAS,OAAO,UAAU,EAAK,aAAc,EAAU,EAAS,QAW5D,GAAA,UAAA,eAAP,SAAsB,EAAuB,EAA2B,EAAa,EAAe,GAEnG,EAAA,UAAM,eAAc,KAAA,KAAC,EAAM,EAAY,EAAO,EAAQ,EAEtD,IAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,UACZ,EAAS,OAAO,gBAAgB,EAAK,aAAc,EAAU,EAAY,EAAO,IAO5E,GAAA,UAAA,aAAP,SAAoB,EAAuB,GAE1C,EAAA,UAAM,aAAY,KAAA,KAAC,EAAM,EAEzB,IAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,UACZ,EAAS,OAAO,YAAY,EAAK,aAAc,EAAU,EAAS,QAI9D,GAAA,UAAA,sBAAP,SAA6B,GAE5B,GAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,EAAI,EAAG,EAAI,IAAO,EACtB,KAAK,0BAA0B,EAAc,KAAK,YAAY,GAE/D,KAAK,EAAI,EAAG,EAAI,IAAO,EACtB,KAAK,YAAY,GAAG,UAAY,KAAK,YAAY,GAAG,OAAO,QAAQ,EAEpE,GAAA,UAAM,sBAAqB,KAAA,KAAC,GASrB,GAAA,UAAA,0BAAR,SAAkC,EAA+B,GAEhE,EAAS,OAET,GAAS,OAAO,QAAQ,EAAc,EAEtC,IAAI,EAAS,gBACZ,EAAa,wBAEd,IAAI,EAAS,qBAAsB,CAElC,EAAa,uBAEb,IAAI,EAAS,uBACZ,EAAa,sBAAwB,SAEhC,IAAI,EAAS,uBAAwB,CAC3C,EAAa,uBACb,GAAa,sBAAwB,KAGtC,GAAI,EAAS,aACZ,EAAa,oBAEd,IAAI,EAAS,cACZ,EAAa,qBAEd,IAAI,EAAS,UACZ,EAAa,qBAEd,IAAI,EAAS,QACZ,EAAa,gBAEd,IAAI,EAAS,iBACZ,EAAa,0BAGR,GAAA,UAAA,2BAAP,SAAkC,EAA+B,EAAmC,GAEnG,GAAI,GAAc,EAElB,IAAI,KAAK,mBAAqB,KAAK,kBAAkB,UACpD,GAAQ,KAAK,kBAAkB,OAAO,eAAe,EAAc,KAAK,kBAAmB,EAAe,EAE3G,IAAI,KAAK,mBAAqB,KAAK,kBAAkB,UACpD,GAAQ,KAAK,kBAAkB,OAAO,eAAe,EAAc,KAAK,kBAAmB,EAAe,EAE3G,IAAI,KAAK,oBAAsB,KAAK,mBAAmB,UACtD,GAAQ,KAAK,mBAAmB,OAAO,eAAe,EAAc,KAAK,mBAAoB,EAAe,EAE7G,OAAO,GAGD,GAAA,UAAA,6BAAP,SAAoC,EAA+B,EAAmC,GAErG,GAAI,GAAc,EAElB,IAAI,KAAK,mBAAqB,KAAK,kBAAkB,UAAW,CAC/D,GAAQ,KAAK,kBAAkB,OAAO,iBAAiB,EAAc,KAAK,kBAAmB,EAAgB,aAAc,EAAe,EAE1I,IAAI,KAAK,kBAAkB,aAC1B,EAAc,wBAAwB,EAAgB,eAEvD,IAAI,KAAK,kBAAkB,UAC1B,EAAc,wBAAwB,EAAgB,iBAGxD,GAAI,KAAK,mBAAqB,KAAK,kBAAkB,UACpD,GAA8B,KAAK,kBAAkB,OAAQ,4BAAmD,EAAc,KAAK,kBAAmB,EAAe,EAEtK,IAAI,KAAK,oBAAsB,KAAK,mBAAmB,UACtD,GAA8B,KAAK,mBAAmB,OAAQ,4BAAmD,EAAc,KAAK,mBAAoB,EAAe,EAExK,OAAO,GAGD,GAAA,UAAA,iCAAP,SAAwC,EAAmC,EAAmC,EAAuC,EAAmC,GAEvL,MAA6B,MAAK,kBAAkB,OAAQ,yBAAyB,EAAc,KAAK,kBAAmB,EAAa,EAAiB,EAAe,GAGlK,GAAA,UAAA,kCAAP,SAAyC,EAAmC,EAAmC,EAAwC,EAAmC,GAEzL,MAA6B,MAAK,mBAAmB,OAAQ,yBAAyB,EAAc,KAAK,mBAAoB,EAAa,EAAkB,EAAe,GAGrK,GAAA,UAAA,iCAAP,SAAwC,EAAmC,EAA8B,EAAkB,EAAmC,GAE7J,MAA6B,MAAK,kBAAkB,OAAQ,yBAAyB,EAAc,KAAK,kBAAmB,EAAQ,EAAW,EAAe,GAGvJ,GAAA,UAAA,kCAAP,SAAyC,EAAmC,EAA8B,EAAkB,EAAmC,GAE9J,MAA6B,MAAK,mBAAmB,OAAQ,yBAAyB,EAAc,KAAK,mBAAoB,EAAQ,EAAW,EAAe,GAGzJ,GAAA,UAAA,4BAAP,SAAmC,EAAmC,EAAmC,GAExG,GAAI,GAAc,EAElB,IAAI,KAAK,iBACR,GAAQ,KAAK,iBAAiB,OAAO,eAAe,EAAc,KAAK,iBAAkB,EAAe,EAEzG,OAAO,GAGD,GAAA,UAAA,8BAAP,SAAqC,EAAmC,EAAmC,GAE1G,GAAI,GAAc,EAElB,IAAI,EAAa,uBAAyB,KAAK,iBAAkB,CAChE,GAAQ,OAAS,EAAgB,aAAe,OAAS,EAAgB,aAAe,OAAS,EAAgB,QAAU,OAC1H,OAAS,EAAgB,aAAe,SAAW,EAAgB,aAAe,KAAO,EAAgB,aAAe,OACxH,OAAS,EAAgB,aAAe,OAAS,EAAgB,aAAe,OAAS,EAAgB,QAAU,OACnH,OAAS,EAAgB,aAAe,SAAW,EAAgB,aAAe,KAGpF,GAAI,KAAK,iBACR,GAAQ,KAAK,iBAAiB,OAAO,iBAAiB,EAAc,KAAK,iBAAkB,EAAgB,aAAc,EAAe,EAEzI,IAAI,KAAK,mBAAqB,KAAK,kBAAkB,UAAW,CAC/D,GAA8B,KAAK,kBAAkB,OAAQ,6BAA6B,EAAc,KAAK,kBAAmB,EAAgB,aAAc,EAAe,EAG7K,IAAI,KAAK,kBAAkB,aAC1B,EAAc,wBAAwB,EAAgB,eAEvD,IAAI,KAAK,kBAAkB,UAC1B,EAAc,wBAAwB,EAAgB,iBAGxD,GAAI,KAAK,oBAAsB,KAAK,mBAAmB,UAAW,CACjE,GAA8B,KAAK,mBAAmB,OAAQ,6BAA6B,EAAc,KAAK,mBAAoB,EAAgB,aAAc,EAAe,EAC/K,IAAI,KAAK,mBAAmB,aAC3B,EAAc,wBAAwB,EAAgB,eACvD,IAAI,KAAK,mBAAmB,UAC3B,EAAc,wBAAwB,EAAgB,iBAGxD,GAAI,KAAK,iBACR,EAAc,wBAAwB,EAAgB,aAEvD,OAAO,GAOD,GAAA,UAAA,mBAAP,SAA0B,GAEzB,GAAI,EAAa,WAChB,MAAO,MAER,IAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EAAG,CACpC,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,YAAc,EAAS,OAAO,oBAC1C,MAAO,OAGT,MAAO,MAMD,GAAA,UAAA,wBAAP,SAA+B,GAE9B,MAA4B,MAAK,iBAAiB,OAAQ,yBAMpD,GAAA,UAAA,iBAAP,SAAwB,GAEvB,MAAO,MAAK,kBAAoB,KAAK,iBAAiB,UAIhD,GAAA,UAAA,sBAAP,SAA6B,EAA+B,EAAmC,GAE9F,MAAO,MAAK,iBAAiB,OAAO,eAAe,EAAc,KAAK,iBAAkB,EAAe,GAGjG,GAAA,UAAA,wBAAP,SAA+B,EAA+B,EAAmC,GAEhG,GAAI,GAAc,KAAK,iBAAiB,OAAO,iBAAiB,EAAc,KAAK,iBAAkB,EAAgB,eAAgB,EAAe,EAEpJ,IAAI,KAAK,iBAAiB,UACzB,EAAc,wBAAwB,EAAgB,gBAEvD,IAAI,KAAK,iBAAiB,wBAA0B,KAAK,iBAAiB,qBACzE,EAAc,sBAAsB,EAAgB,qBAErD,OAAO,GAMD,GAAA,UAAA,gBAAP,SAAuB,EAA+B,EAA8B,GAEnF,GAAI,GAAc,EAClB,IAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAM,KAAK,uBAAwB,EAAI,EAAK,IAAK,CACpE,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,UAAW,CACvB,GAAQ,EAAS,OAAO,eAAe,EAAc,EAAU,EAAU,EAEzE,IAAI,EAAS,sBAAwB,EAAS,uBAC7C,EAAS,sBAAsB,EAAU,uBAI5C,GAAI,KAAK,0BAA4B,KAAK,yBAAyB,UAClE,GAAQ,KAAK,yBAAyB,OAAO,eAAe,EAAc,KAAK,yBAA0B,EAAU,EAEpH,OAAO,GAMD,GAAA,UAAA,kBAAP,SAAyB,EAA+B,EAA8B,GAErF,GAAI,GAAc,EAClB,IAAI,EAEJ,IAAI,KAAK,eAAiB,KAAK,uBAAyB,EAAG,CAC1D,EAAW,EAAS,2BACpB,GAAS,sBAAsB,EAAU,EACzC,IAAQ,OAAS,EAAW,KAAO,EAAU,aAAe,OAG7D,GAAI,EACJ,IAAI,GAAa,KAAK,YAAY,MAClC,KAAK,GAAI,GAAW,EAAM,KAAK,uBAAwB,EAAI,EAAK,IAAK,CACpE,EAAW,KAAK,YAAY,EAC5B,IAAI,EAAS,UAAW,CACvB,GAAQ,EAAS,OAAO,iBAAiB,EAAc,EAAU,EAAU,aAAc,EAAU,EAEnG,IAAI,EAAS,aACZ,EAAS,wBAAwB,EAAU,eAE5C,IAAI,EAAS,UACZ,EAAS,wBAAwB,EAAU,kBAK9C,GAAI,KAAK,eAAiB,KAAK,uBAAyB,EAAG,CAC1D,GAAQ,OAAS,EAAU,aAAe,OAAS,EAAW,IAC9D,GAAS,wBAAwB,GAGlC,GAAI,KAAK,0BAA4B,KAAK,yBAAyB,UAClE,GAAQ,KAAK,yBAAyB,OAAO,iBAAiB,EAAc,KAAK,yBAA0B,EAAU,aAAc,EAAU,EAE9I;MAAO,GAKD,GAAA,UAAA,cAAP,WAEC,MAAO,SAAQ,KAAK,kBAAoB,KAAK,YAAY,yBAAyB,OAAS,GAAK,KAAK,YAAY,mBAAmB,OAAS,GAMvI,GAAA,UAAA,eAAP,WAEC,MAAO,SAAQ,KAAK,oBAEtB,OAAA,IAxrBiC,EA0rBL,GAAA,QAAnB,2dCjuBT,GAAO,GAAU,EAAe,kCAChC,IAAO,GAAS,EAAe,oCAC/B,IAAO,GAAa,EAAc,yCAIlC,IAAO,GAAiB,EAAa,oDACrC,IAAO,GAAqB,EAAY,wDAGxC,IAAM,GAAsB,WAA5B,QAAM,MAOS,EAAA,mBAAd,SAAiC,GAAA,GAAA,QAAA,GAAmC,CAAnC,EAAA,KAEhC,GAAI,GAAiB,MAAQ,EAAc,WAAa,EAAU,cAAe,CAChF,IAAK,EAAuB,qBAC3B,EAAuB,2BAExB,OAAO,GAAuB,yBACxB,CACN,IAAK,EAAuB,yBAC3B,EAAuB,+BAExB,OAAO,GAAuB,0BAIlB,GAAA,kBAAd,SAAgC,GAAA,GAAA,QAAA,GAAmC,CAAnC,EAAA,KAE/B,IAAK,EAAuB,gBAC3B,EAAuB,sBAExB,OAAO,GAAuB,gBAGhB,GAAA,qBAAf,WAEC,EAAuB,mBAAqB,EAAuB,2BACnE,GAAuB,gBAAkB,GAAI,GAAc,EAAuB,mBAAoB,KACtG,GAAuB,gBAAgB,KAAO,iBAGjC,GAAA,0BAAd,WAEC,GAAI,GAAe,GAAI,GAAW,EAAG,EAAG,MAAO,MAG3C,GAAU,CACd,KAAK,EAAI,EAAG,EAAI,EAAG,IAAK,CACvB,IAAK,EAAI,EAAG,EAAI,EAAG,IAAK,CACvB,GAAK,EAAI,EAAM,EAAI,EAAI,CACtB,EAAE,SAAS,EAAG,EAAG,YAKpB,MAAO,GAGO,GAAA,8BAAf,WAEC,IAAK,EAAuB,gBAC3B,EAAuB,sBAExB,GAAuB,yBAA2B,GAAI,GAAsB,EAAuB,gBACnG,GAAuB,yBAAyB,OAAS,KACzD,GAAuB,yBAAyB,OAAS,KACzD,GAAuB,yBAAyB,KAAO,0BAGzC,GAAA,0BAAf,WAEC,EAAuB,qBAAuB,GAAI,EAClD,GAAuB,qBAAqB,KAAO,yBAErD,OAAA,KAEA,GAAgC,QAAvB,0QChFT,GAAO,GAAsB,EAAY,iDAKzC,IAAM,GAAoB,WAA1B,QAAM,MAcS,EAAA,mBAAd,SAAiC,EAAiC,EAA8B,EAAgC,EAA0B,EAAgB,EAAgB,EAAiB,EAAoC,GAApC,GAAA,QAAA,GAAkC,CAAlC,EAAA,KAAoC,GAAA,QAAA,GAAuB,CAAvB,EAAA,KAE9O,GAAI,GAAc,IAAc,EAAQ,OAAO,QAC/C,IAAI,GAAgB,EAAqB,0BAA0B,EACnE,IAAI,GAAwB,GAAW,EAAQ,UAC/C,IAAI,GAAgB,EAAW,EAAe,mBAAqB,SAAa,EAAe,qBAAuB,SAEtH,IAAI,GAAS,KACZ,EAAQ,EAAU,SAEnB,OAAO,OAAS,EAAY,KAAO,EAAQ,KAAO,EAAW,QAAU,EAAS,IAAM,EAAS,EAAO,MAezF,GAAA,qBAAd,SAAmC,EAAiC,EAAgC,EAA0B,EAAgB,EAAiB,GAE9J,GAAI,EACJ,IAAI,GAAgB,EAAqB,0BAA0B,EACnE,IAAI,GAAwB,GAAW,EAAQ,UAC/C,IAAI,GAAgB,EAAW,EAAe,mBAAqB,SAAa,EAAe,qBAAuB,SAEtH,OAAO,OAAS,EAAY,KAAO,EAAQ,KAAO,EAAW,UAAY,EAAS,EAAS,MAU9E,GAAA,0BAAd,SAAwC,GAEvC,OAAQ,EAAQ,QACf,IAAK,GAAuB,WAC3B,MAAO,OACP,MACD,KAAK,GAAuB,iBAC3B,MAAO,OACP,MACD,SACC,MAAO,IAGX,OAAA,KAE8B,GAAA,QAArB,8OC7ET,IAAO,GAAmB,EAAa,8CAKvC,IAAO,GAAc,EAAc,gDAK7B,GAAmB,SAAA,GAAS,EAA5B,EAAmB,EAoBxB,SApBK,GAoBO,EAAqB,GAEhC,EAAA,KAAA,KAAM,EAAM,EAAW,EAEvB,MAAK,WAAa,EAQZ,EAAA,UAAA,iBAAP,WAEC,GAAI,GAAwB,KAAK,WAAW,QAE5C,IAAI,GAA+B,EAAoB,kBAAkB,EAAS,GAElF,KAAK,EAAU,CACd,EAAW,EAAoB,kBAAkB,EAAS,IAAM,GAAI,GAAoB,KACxF,GAAS,kBAAoB,KAC7B,GAAS,mBAAqB,KAC9B,GAAS,cAAc,MAAc,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,GAAS,gBAAgB,MAAc,EAAG,EAAS,OAAQ,EAAG,EAAS,MAAO,EAAS,OAAQ,EAAG,EAAS,MAAO,EAAG,EAAG,EAAG,EAAG,GAC9H,GAAS,oBAAoB,MAAc,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC5E,GAAS,qBAAqB,MAAc,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,GACjF,GAAS,UAAU,MAAc,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,QAChD,CACN,EAAS,gBAAgB,MAAc,EAAG,EAAS,OAAQ,EAAG,EAAS,MAAO,EAAS,OAAQ,EAAG,EAAS,MAAO,EAAG,EAAG,EAAG,EAAG,IAG/H,KAAK,kBAAkB,EAAoB,eAAiB,IAC5D,MAAK,kBAAkB,EAAoB,aAAe,IAC1D,MAAK,kBAAkB,EAAoB,cAAgB,IAC3D,MAAK,kBAAkB,EAAoB,SAAW,IAEtD,OAAO,GAtDO,GAAA,kBAA2B,GAAI,OAKhC,GAAA,GAAY,WAmD3B,OAAA,IA1DkC,EA4DlC,GAA6B,QAApB,2RCrET,IAAO,GAAe,EAAc,0CAIpC,IAAO,GAAc,EAAc,gDAK7B,GAAqB,SAAA,GAAS,EAA9B,EAAqB,EAoB1B,SApBK,GAoBO,EAAqB,EAAqB,EAAkB,GAAlB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAsB,CAAtB,EAAA,EAEvE,EAAA,KAAA,KAAM,EAAM,EAAQ,WAAY,EAAS,EAAO,EAEhD,MAAK,QAAU,EAST,EAAA,UAAA,iBAAP,WAEC,GAAI,GAA8B,KAAK,QAAQ,WAE/C,MAAK,kBAAkB,EAAgB,qBAAuB,IAC9D,MAAK,kBAAkB,EAAgB,mBAAqB,IAE5D,IAAI,EAAY,UACf,KAAK,kBAAkB,EAAgB,gBAAkB,IAE1D,IAAI,EAAY,YACf,KAAK,kBAAkB,EAAgB,YAAc,IAEtD,OAAO,GAaD,GAAA,UAAA,wBAAP,SAA+B,EAAqB,EAA8B,EAAc,GAE/F,MAAO,IAAI,GAAsB,EAAoB,EAAe,EAAO,GAxD9D,GAAA,GAAY,aA0D3B,OAAA,IA/DoC,EAiEpC,GAA+B,QAAtB,yHClET,GAAO,GAAoB,EAAa,sDAMlC,GAAY,WAcjB,QAdK,GAcO,EAAuB,GAF5B,KAAA,iBAA2B,IAIjC,MAAK,MAAQ,CACb,MAAK,SAAW,CAEhB,MAAK,sBAAwB,GAAI,GAAqB,GAGhD,EAAA,UAAA,gBAAP,SAAuB,EAA+B,GAErD,GAAI,GAAoC,KAAK,sBAAsB,QAAQ,EAE3E,KAAK,EAAiB,aAAc,CACnC,EAAiB,aAAe,EAAa,mBAAmB,EAChE,GAAiB,QAAU,KAG5B,GAAI,EAAiB,QAAS,CAC7B,EAAiB,QAAU,KAC3B,IAAI,GAA8B,EAAiB,aAAa,eAAe,KAAK,SAAU,EAC9F,GAAS,SAET,GAAiB,aAAe,EAAS,YACzC,GAAiB,WAAa,EAAS,UACvC,GAAiB,aAAe,EAAS,YACzC,GAAiB,0BAA4B,EAAS,yBACtD,GAAiB,IAAM,GAGxB,MAAO,GAGD,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,KAAK,SAAW,KAAM,CACzB,GAAI,GAA2D,KAAK,SAAS,cAC7E,IAAI,GAAmB,EAAO,MAG9B,MAAK,QAAU,GAAI,OAAwB,EAG3C,KAAK,GAAI,GAAW,EAAG,EAAI,EAAW,IACrC,KAAK,QAAQ,GAAK,KAAK,gBAAgB,EAAO,GAAI,GAGpD,MAAO,MAAK,QAMN,GAAA,UAAA,QAAP,WAEC,KAAK,sBAAsB,aAE3B,MAAK,sBAAwB,IAE7B,MAAK,MAAM,YAAY,KAAK,SAE5B,MAAK,QAAU,KAMT,GAAA,UAAA,mBAAP,WAEC,KAAK,QAAU,IAEf,MAAK,sBAMC,GAAA,UAAA,oBAAP,WAEC,KAAK,iBAAmB,KAE1B,OAAA,KAEsB,GAAA,QAAb,iFC9GT,GAAO,GAAY,EAAe,8CAM5B,GAAgB,WASrB,QATK,KAEG,KAAA,MAAe,GAAI,QAiBpB,EAAA,UAAA,QAAP,SAAe,GAEd,MAAQ,MAAK,MAAM,EAAS,MAAQ,KAAK,MAAM,EAAS,IAAM,EAAS,kBAAkB,GAAI,GAAa,KAAM,KAQ1G,GAAA,UAAA,YAAP,SAAmB,GAElB,EAAS,qBAAqB,KAAK,MAAM,EAAS,IAElD,MAAK,MAAM,EAAS,IAAM,KAE5B,OAAA,KAEA,GAA0B,QAAjB,4EC/BH,GAAgB,WA8BrB,QA9BK,GA8BO,EAA2B,EAA8B,GAV9D,KAAA,oBAA6B,EAE7B,MAAA,sBAA+B,EAUrC,MAAK,MAAQ,CACb,MAAK,SAAW,CAChB,MAAK,aAAe,EAMd,EAAA,UAAA,QAAP,WAEC,KAAK,MAAM,YAAY,KAAK,aAE5B,MAAK,aAAa,SAClB,MAAK,aAAe,IAEpB,MAAK,YAAY,SACjB,MAAK,YAAc,KAMb,GAAA,UAAA,WAAP,WAEC,KAAK,QAAU,KAEjB,OAAA,KAE0B,GAAA,QAAjB,4BC1ET,GAAO,GAAgB,EAAc,kDAO/B,GAAoB,WAUzB,QAVK,GAUO,GARJ,KAAA,MAAe,GAAI,OAU1B,MAAK,UAAY,EASX,EAAA,UAAA,QAAP,SAAe,GAEd,MAAQ,MAAK,MAAM,EAAa,MAAQ,KAAK,MAAM,EAAa,IAAM,KAAK,UAAU,sBAAsB,EAAa,sBAAsB,GAAI,GAAiB,KAAM,KAAK,UAAW,MAQnL,GAAA,UAAA,YAAP,SAAmB,GAElB,EAAa,yBAAyB,KAAK,MAAM,EAAa,WAEvD,MAAK,MAAM,EAAa,IAGzB,GAAA,UAAA,YAAP,WAEC,IAAK,GAAI,KAAM,MAAK,MACC,KAAK,MAAM,GAAK,aAAa,yBAAyB,KAAK,MAAM,UAE/E,MAAK,MAEd,OAAA,KAEA,GAA8B,QAArB,6ECrDT,GAAO,GAAmB,EAAa,6CAGvC,IAAO,GAAe,EAAc,0CACpC,IAAO,GAAmB,EAAa,8CAIvC,IAAO,GAAgB,EAAc,6CAGrC,IAAO,GAAa,EAAc,wCAElC,IAAO,GAAc,EAAc,6CAO7B,GAAc,WA0InB,QA1IK,GA0IO,EAAqB,EAAsB,EAA8B,EAAkB,GA1IxG,GAAA,GAAA,IA0IsF,IAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAsB,CAAtB,EAAA,EApI/F,KAAA,eAAyB,IAEzB,MAAA,gBAA0B,IAC1B,MAAA,YAAqB,GAAI,OAC1B,MAAA,kBAA2B,GAAI,OAC9B,MAAA,cAAuB,GAAI,OAiIlC,MAAK,0BAA4B,SAAC,GAA2B,MAAA,GAAK,kBAAkB,GACpF,MAAK,2BAA6B,SAAC,GAA2B,MAAA,GAAK,mBAAmB,GAGtF,MAAK,MAAQ,CAGb,MAAK,OAAS,CAGd,MAAK,aAAe,CAEpB,MAAK,aAAe,CACpB,MAAK,cAAgB,EA1HtB,OAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAmDN,GAAA,UAAA,aAAP,WAEC,GAAI,KAAK,gBACR,KAAK,kBAEN,OAAO,MAAK,WAMN,GAAA,UAAA,cAAP,SAAqB,GAEpB,GAAI,KAAK,gBACR,KAAK,kBAEN,IAAI,KAAK,kBAAkB,GAC1B,KAAK,kBAAkB,EAExB,OAAO,MAAK,YAAY,KAAK,mBAAoB,EAAoB,YAAc,GAM7E,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,KAAK,gBACR,KAAK,kBAEN,IAAI,KAAK,kBAAkB,GAC1B,KAAK,kBAAkB,EAExB,OAAO,MAAK,cAAc,GA4BpB,GAAA,UAAA,QAAP,WAEC,KAAK,MAAM,YAAY,KAAK,cAE5B,MAAK,WAAW,SAChB,MAAK,WAAa,IAElB,KAAK,GAAI,KAAY,MAAK,YAAa,CACxB,KAAK,YAAY,GAAW,SAC1C,MAAK,YAAY,GAAY,KAG9B,GAAI,KAAK,UAAW,CACnB,KAAK,UAAU,SACf,MAAK,UAAY,MAIZ,GAAA,UAAA,mBAAP,WAEC,KAAK,eAAiB,IAGtB,IAAI,KAAK,QAAU,EAClB,KAAK,gBAAkB,IAExB,IAAI,KAAK,UACR,KAAK,UAAU,qBAMV,GAAA,UAAA,oBAAP,WAEC,KAAK,gBAAkB,KAQjB,GAAA,UAAA,qBAAP,SAA4B,GAE3B,KAAK,kBAAkB,GAAY,KAG7B,GAAA,UAAA,iBAAP,WAEC,KAAM,IAAI,GAUJ,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,KAAK,eACR,KAAK,iBAEN,MAAK,WAAa,EAAc,QAAQ,KAAK,aAAc,KAAK,OAAQ,EAExE,MAAK,cAAgB,KAAK,WAAW,KAAK,OAAO,CAEjD,GAAc,KAAK,WAAW,MAG9B,IAAI,EAAc,KAAK,aAAa,QAAQ,OAAQ,CACnD,IAAK,KAAK,UACT,KAAK,UAAY,KAAK,wBAAwB,KAAK,MAAO,KAAK,cAAe,EAAa,KAAK,OAAS,EAE1G,MAAK,UAAU,gBAAgB,OACzB,IAAI,KAAK,UAAW,CAC1B,KAAK,UAAU,SACf,MAAK,UAAY,MAIZ,GAAA,UAAA,wBAAP,SAA+B,EAAqB,EAA8B,EAAc,GAE/F,KAAM,IAAI,GAQH,GAAA,UAAA,gBAAR,WAEC,GAAI,KAAK,aAAc,CACtB,GAAI,KAAK,QAAU,EAClB,KAAK,aAAa,oBAAoB,EAAiB,gBAAiB,KAAK,0BAC9E,MAAK,aAAa,oBAAoB,EAAiB,iBAAkB,KAAK,4BAG/E,KAAK,aAAe,KAAK,kBAEzB,MAAK,mBAAqB,KAAK,aAAa,iBAE5C,IAAI,KAAK,aAAc,CACtB,GAAI,KAAK,QAAU,EAClB,KAAK,aAAa,iBAAiB,EAAiB,gBAAiB,KAAK,0BAC3E,MAAK,aAAa,iBAAiB,EAAiB,iBAAkB,KAAK,4BAc5E,KAAK,eAAiB,MAUf,GAAA,UAAA,iBAAR,WAEC,KAAK,gBAAgB,KAAK,aAE1B,MAAK,gBAAkB,MAShB,GAAA,UAAA,kBAAR,SAA0B,GAEzB,KAAK,cAAc,GAAY,KAAK,aAAa,UAAU,EAE3D,IAAI,KAAK,aAAa,kBACrB,EAAW,EAAgB,WAE5B,MAAK,YAAY,GAAY,EAAe,QAAQ,KAAK,aAAc,KAAK,eAAgB,EAE5F,MAAK,kBAAkB,GAAY,MAS5B,GAAA,UAAA,kBAAR,SAA0B,GAEzB,KAAK,sBASE,GAAA,UAAA,mBAAR,SAA2B,GAE1B,KAAK,mBAAwC,EAAM,OAAQ,iBAE3D,MAAK,qBAAqB,EAAM,UAElC,OAAA,KAEA,GAAwB,QAAf,odCvWT,IAAO,GAAmB,EAAa,8CAIvC,IAAO,GAAc,EAAc,gDAK7B,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAkBrB,SAlBK,GAkBO,EAAqB,GAEhC,EAAA,KAAA,KAAM,EAAM,EAAQ,GASd,EAAA,UAAA,iBAAP,WAEC,GAAI,GAA+B,EAAiB,SAEpD,KAAK,EAAU,CACd,EAAW,EAAiB,UAAY,GAAI,GAAoB,KAChE,GAAS,kBAAoB,KAC7B,GAAS,mBAAqB,KAC9B,GAAS,cAAc,MAAc,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC9I,GAAS,gBAAgB,OAAe,EAAG,GAAI,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,GAAI,GAAI,GAAI,EAAG,GAAI,GAAI,EAAG,GAAI,EAAG,GAAI,GAAI,EAAG,IAGzH,KAAK,kBAAkB,EAAoB,eAAiB,IAE5D,OAAO,GAtCM,GAAA,GAAY,QAwC3B,OAAA,IA7C+B,EA+C/B,GAA0B,QAAjB,2RCtDT,IAAO,GAAmB,EAAa,8CAGvC,IAAO,GAA2B,EAAW,sDAE7C,IAAO,GAAc,EAAc,gDAK7B,GAAyB,SAAA,GAAS,EAAlC,EAAyB,EAqB9B,SArBK,GAqBO,EAAqB,EAAyB,EAAkB,GAAlB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAsB,CAAtB,EAAA,EAE3E,EAAA,KAAA,KAAM,EAAM,EAAQ,WAAY,EAAS,EAAO,EAEhD,MAAK,QAAU,EAQT,EAAA,UAAA,iBAAP,WAEC,GAAI,EAEJ,IAAI,KAAK,QAAQ,SAChB,EAAoC,KAAK,QAAQ,SAAS,yBAAyB,KAAM,KAAK,QAAQ,iBAEtG,GAAc,KAAK,QAAQ,WAE5B,MAAK,kBAAkB,EAAoB,eAAiB,IAE5D,IAAI,EAAY,cACf,KAAK,kBAAkB,EAAoB,aAAe,IAE3D,IAAI,EAAY,eACf,KAAK,kBAAkB,EAAoB,cAAgB,IAE5D,IAAI,EAAY,IACf,KAAK,kBAAkB,EAAoB,SAAW,IAEvD,IAAI,EAAY,aACf,KAAK,kBAAkB,EAAoB,mBAAqB,IAEjE,IAAI,EAAY,aACf,KAAK,kBAAkB,EAAoB,kBAAoB,IAEhE,IAAI,EAAY,aACf,KAAK,kBAAkB,EAAoB,mBAAqB,IAEjE,QAAO,EAAY,iBAClB,IAAK,GACJ,KAAK,mBAAqB,KAAK,oBAAsB,EAA4B,OACjF,MACD,KAAK,GACJ,KAAK,mBAAqB,KAAK,oBAAsB,EAA4B,OACjF,MACD,KAAK,GACJ,KAAK,mBAAqB,KAAK,oBAAsB,EAA4B,OACjF,MACD,KAAK,GACJ,KAAK,mBAAqB,KAAK,oBAAsB,EAA4B,OACjF,MACD,UAGD,MAAO,GAaD,GAAA,UAAA,wBAAP,SAA+B,EAAqB,EAA8B,EAAc,GAE/F,MAAO,IAAI,GAA0B,EAAwB,EAAe,EAAO,GAxFtE,GAAA,GAAY,iBA0F3B,OAAA,IA/FwC,EAiGxC,GAAmC,QAA1B,qVC7GT,IAAO,GAAQ,EAAgB,gCAE/B,IAAO,GAAQ,EAAgB,gCAC/B,IAAO,GAAa,EAAc,yCAIlC,IAAO,GAAc,EAAc,yCAYnC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAkB,EAAa,6CAGtC,IAAO,GAAY,EAAe,2CAKlC,IAAO,GAAgB,EAAc,8CACrC,IAAO,GAAa,EAAc,6CAClC,IAAO,GAAgB,EAAc,gDACrC,IAAO,GAAY,EAAe,4CAClC,IAAO,GAAgB,EAAc,kDACrC,IAAO,GAAY,EAAe,sDAClC,IAAO,GAAe,EAAc,6DAU9B,GAAe,SAAA,GAAS,EAAxB,EAAe,EAmFpB,SAnFK,GAmFO,EAA+B,EAA6B,GAA5D,GAAA,QAAA,GAA6B,CAA7B,EAAA,MAA+B,GAAA,QAAA,GAA2B,CAA3B,EAAA,WAA6B,GAAA,QAAA,GAAa,CAAb,EAAA,OAEvE,EAAA,KAAA,KA7EO,MAAA,kBAA6B,GAAI,EA+ExC,MAAK,sBAAwB,EAAe,QAAQ,EAEpD,MAAK,gBAAkB,GAAI,GAAc,GAAI,GAC7C,MAAK,mBAAqB,GAAI,GAAc,GAAI,GAEhD,IAAI,KAAK,SAAW,KACnB,KAAK,MAAQ,EAAa,cAAc,aAAa,EAAe,EAAS,EAE9E,MAAK,mBAAqB,EAAiB,YAAY,KAAK,QAE5D,IAAI,KAAK,QAAU,EAClB,KAAK,MAAQ,OAAO,eAEpB,MAAK,mBAAmB,UAAY,KAAK,MAE1C,IAAI,KAAK,SAAW,EACnB,KAAK,OAAS,OAAO,gBAErB,MAAK,mBAAmB,WAAa,KAAK,QA1F5C,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,GAAI,KAAK,YAAc,EACtB,MAED,MAAK,WAAa,CAElB,MAAK,oBAAsB,yCAM5B,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,sCAOtB,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,mBAAoB,KAAK,mBAAmB,QAAU,UAEnE,SAAqB,GAEpB,GAAI,GAAS,EAAM,QAAU,EAC5B,EAAQ,IAET,IAAI,KAAK,qBAAuB,EAAO,CACtC,KAAK,mBAAmB,SACxB,MAAK,mBAAqB,SACpB,KAAK,KAAK,oBAAsB,EAAO,CAC7C,KAAK,mBAAqB,GAAI,GAAiB,KAAK,QACpD,MAAK,mBAAmB,QAAU,EAGnC,GAAI,KAAK,mBAAoB,CAC5B,KAAK,mBAAmB,QAAU,CAClC,MAAK,qBAAuB,KAAK,mBAAmB,uBAC9C,CACN,KAAK,qBAAuB,KAE5B,IAAI,KAAK,cAAe,CACvB,KAAK,cAAc,SACnB,MAAK,cAAgB,2CAoCjB,GAAA,UAAA,OAAP,SAAc,GAEb,EAAA,UAAM,OAAM,KAAA,KAAC,EAEb,KAAK,KAAK,QAAQ,sBAAuB,CACxC,KAAK,oBAAsB,IAC3B,QAGD,GAAI,KAAK,oBACR,KAAK,mBAEN,IAAI,KAAK,eAAiB,KAAK,UAC9B,KAAK,UAAU,MAAM,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAmB,MAE3D,IAAI,KAAK,mBAAoB,CAC5B,KAAK,cAAgB,KAAK,mBAAmB,aAC7C,MAAK,cAAgB,KAAK,mBAAmB,kBACvC,CACN,KAAK,cAAgB,CACrB,MAAK,cAAgB,EAGtB,GAAI,KAAK,qBACR,KAAK,2BAA6C,EAEnD,IAAI,KAAK,cACR,KAAK,oBAAsC,EAE5C,IAAI,KAAK,oBAAsB,KAAK,UAAW,MAIxC,CAEN,GAAI,KAAK,cACR,KAAK,SAAS,EAAiB,KAAM,KAAK,mBAE1C,MAAK,SAAS,GAGhB,EAAA,UAAM,OAAM,KAAA,KAAC,EAEb,KAAK,KAAK,eAAiB,KAAK,UAC/B,KAAK,UAAU,SAGhB,MAAK,QAAQ,YAAc,MAGrB,GAAA,UAAA,eAAP,SAAsB,EAAiC,EAAgC,EAA8B,GAA9D,GAAA,QAAA,GAA8B,CAA9B,EAAA,KAAgC,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAA8B,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAEpH,KAAK,aAAa,EAGlB,IAAI,EAAQ,CACX,KAAK,oBAAoB,EAEzB,MAAK,gBAAgB,KAAK,uBAAwB,EAClD,MAAK,gBAAgB,KAAK,wBAAyB,GAGpD,EAAA,UAAM,eAAc,KAAA,KAAC,EAAiB,EAAQ,EAAa,GAGpD,GAAA,UAAA,aAAR,SAAqB,GAEpB,GAAI,GAAoC,EAAgB,iBACxD,IAAI,GAAgC,EAAgB,WACpD,IAAI,GAAY,CAChB,IAAI,EACJ,IAAI,EAEJ,GAAM,EAAU,MAChB,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAQ,EAAU,EAElB,GAAe,EAAM,YAErB,IAAI,EAAM,eAAiB,EAAa,mBAAqB,EAAa,kBACzE,EAAa,gBAAgB,EAAiB,KAAK,iBAGrD,EAAM,EAAY,MAClB,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,EAAQ,EAAY,EAEpB,GAAe,EAAM,YAErB,IAAI,EAAM,eAAiB,EAAa,mBAAqB,EAAa,kBACzE,EAAa,gBAAgB,EAAiB,KAAK,qBAO/C,GAAA,UAAA,MAAP,SAAa,EAAiC,GAE7C,IAAK,EACJ,KAAK,oBAAoB,EAE1B,MAAK,UAAU,gBAAgB,EAAqB,IAAK,EAAqB,KAE9E,IAAI,EAAgB,OAAQ,CAC3B,KAAK,UAAU,aAAa,MAAO,EAAqB,OAExD,MAAK,WAAW,GAGjB,KAAK,UAAU,aAAa,KAAM,EAAqB,WAEvD,MAAK,gBAAgB,KAAK,uBAAwB,EAClD,MAAK,gBAAgB,KAAK,wBAAyB,GAQ5C,GAAA,UAAA,WAAR,SAAmB,GAElB,GAAI,GAA6C,KAAK,sBAAsB,QAAQ,EAAgB,OAEpG,IAAI,GAAqD,EAAgB,OAAO,QAEhF,IAAI,GAAgB,EAAgB,MAEpC,MAAK,uBAAuB,EAE5B,IAAI,GAA8B,KAAK,YAAY,EAAU,KAAK,QAAQ,SAAS,gBAAmC,EAAS,eAAe,GAAI,KAAK,QAAQ,QAE/J,GAAS,eAAe,EAAY,KAAM,EAC1C,GAAS,aAAa,EAAY,EAAQ,KAAK,QAAS,EAAQ,KAAK,kBACrE,GAAS,iBAAiB,EAAY,MAG/B,GAAA,UAAA,uBAAR,SAA+B,GAE9B,GAAI,GAAgB,GAAI,EAExB,MAAK,kBAAkB,SAAS,KAAK,0BACrC,MAAK,kBAAkB,UAAU,EAAG,EAEpC,IAAI,GAAkB,EAAO,aAE7B,IAAI,GAAY,EAAK,CACrB,IAAI,GAAY,EAAK,CACrB,IAAI,GAAY,EAAK,CACrB,IAAI,KAAc,EAAK,EAAE,EAAO,EAAI,EAAK,EAAE,EAAO,EAAI,EAAK,EAAE,EAAO,EAAI,KAAK,KAAK,EAAG,EAAK,EAAG,EAAK,EAAG,GAErG,IAAI,GAAe,GAAM,EAAG,GAAK,CACjC,IAAI,GAAe,GAAM,EAAG,GAAK,CAEjC,IAAI,GAAa,GAAI,GAAS,EAAO,EAAO,EAAG,EAE/C,IAAI,GAAmB,KAAK,kBAAkB,OAC9C,GAAQ,QAER,IAAI,GAAa,EAAQ,gBAAgB,EAEzC,MAAK,kBAAkB,UAAU,EAAG,EAEpC,IAAI,IAAY,EAAE,EAAE,EAAE,EAAI,EAAE,EAAE,EAAE,EAAI,EAAE,EAAE,EAAE,EAAI,EAAE,EAAE,EAAE,IAAI,EAAG,EAAE,EAAI,EAAG,EAAE,EAAI,EAAG,EAAE,EAAI,EAAG,EAAE,EAExF,MAAK,kBAAkB,YAAY,EAAG,GAAI,GAAS,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IASjE,GAAA,UAAA,gBAAR,SAAwB,EAA2B,GAElD,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAA4C,KAAK,QAAQ,OAC7D,IAAI,GAAgB,EAAgB,MACpC,IAAI,EAEJ,OAAO,EAAY,CAClB,EAAiB,KAAK,YAAY,EAAW,SAAU,KAAK,QAAQ,QAGpE,GAAS,EAAW,SAAS,cAC7B,GAAM,EAAW,SAAS,mBAC1B,KAAK,EAAI,EAAG,EAAI,EAAK,IAAK,CACzB,EAAc,CAEd,GAAa,EAAe,gBAAmC,EAAO,GAAI,KAAK,QAAQ,QAEvF,GAAW,SAAS,eAAe,EAAY,KAAM,EAErD,GAAG,CACF,EAAW,SAAS,aAAa,EAAY,EAAa,KAAK,QAAS,EAAQ,KAAK,0BAErF,GAAc,EAAY,WAElB,GAAe,EAAY,UAAY,EAAW,SAE3D,GAAe,SAAS,iBAAiB,EAAY,MAGtD,EAAa,GAIR,GAAA,UAAA,QAAP,WAEC,IAAK,KAAK,cACT,KAAK,QAAQ,SAEd,MAAK,gBAAgB,SACrB,MAAK,mBAAmB,SACxB,MAAK,gBAAkB,IACvB,MAAK,mBAAqB,IAE1B,MAAK,cAAgB,IAErB,GAAA,UAAM,QAAO,KAAA,MAOP,GAAA,UAAA,oBAAP,SAA2B,GAE1B,KAAK,gBAAgB,aAAe,IAEpC,IAAI,KAAK,mBAAoB,MAItB,CACN,KAAK,gBAAgB,cAAgB,CACrC,MAAK,gBAAgB,cAAgB,CACrC,MAAK,gBAAgB,SAAS,GAG/B,KAAK,gBAAgB,aAAe,MAO9B,GAAA,UAAA,2BAAP,SAAkC,GAEjC,GAAI,KAAK,wBAA0B,KAAK,cACvC,KAAK,iBAAmC,KAAK,QAAQ,QAEtD,MAAK,gBAAgB,cAAgB,KAAK,mBAAmB,aAC7D,MAAK,gBAAgB,cAAgB,KAAK,mBAAmB,aAC7D,MAAK,gBAAgB,SAAS,EAAiB,KAAK,eAO9C,GAAA,UAAA,kBAAP,WAKC,GAAI,KAAK,QAAQ,UAAY,KAAK,cAAe,CAChD,GAAI,KAAK,QAAU,KAAK,QAAS,CAChC,KAAK,QAAQ,oBAAoB,KAAK,OAAQ,KAAK,QAAS,KAAK,WAAY,KAC7E,MAAK,oBAAsB,QAKvB,GAAA,UAAA,UAAP,SAAiB,GAEhB,EAAA,UAAM,UAAS,KAAA,KAAC,EAEhB,MAAK,mBAAmB,UAAU,EAClC,MAAK,gBAAgB,UAAU,GAMxB,GAAA,UAAA,iBAAR,SAAyB,GAExB,KAAK,sBAAwB,KAE7B,IAAI,KAAK,cACR,KAAK,cAAc,SAEpB,MAAK,cAAgB,GAAI,GAAc,KAAK,mBAAmB,aAAc,KAAK,mBAAmB,eAEvG,OAAA,IAxZ8B,EA0ZL,GAAA,QAAhB,q5BC9bT,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAoB,EAAa,+CAMxC,IAAO,GAAY,EAAe,gDAS5B,GAAa,SAAA,GAAS,EAAtB,EAAa,EAWlB,SAXK,GAWO,EAAuB,GAAA,GAAA,QAAA,GAA6B,CAA7B,EAAA,MAElC,EAAA,KAAA,KAEA,MAAK,MAAQ,CAEb,MAAK,eAAiB,CACtB,MAAK,cAAgB,CACrB,MAAK,cAAgB,CACrB,MAAK,cAAgB,EAItB,OAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,KAAK,cAAgB,sCAGf,GAAA,UAAA,iBAAP,SAAwB,EAAuC,EAAyB,EAAoB,EAA+B,GAE1I,KAAK,oBAAoB,EAEzB,MAAK,UAAU,gBAAgB,EAAQ,KAAM,EAC7C,MAAK,UAAU,MAAM,EAAG,EAAG,EAAG,EAAG,EAAG,EAEpC,MAAK,UAAU,gBAAgB,EAAqB,IAAK,EAAqB,KAC9E,MAAK,UAAU,aAAa,KAAM,EAAqB,KAEvD,IAAI,GAAsB,KAAK,sBAE/B,IAAI,GAAgB,IAEpB,KAAK,GAAI,GAAW,EAAc,EAAG,GAAK,IAAK,EAAG,CACjD,KAAK,QAAQ,YAAc,EAAa,EACxC,MAAK,uBAAuB,EAAM,EAAQ,GAAI,EAAO,KAAO,EAAQ,GAAG,cACvE,GAAQ,MAIT,KAAK,UAAU,aAAa,MAAO,EAAqB,WAExD,MAAK,QAAQ,YAAc,KAIpB,GAAA,UAAA,uBAAR,SAA+B,EAA2B,EAAe,GAExE,GAAI,EACJ,IAAI,EACJ,IAAI,GAA0B,KAAK,QAAQ,OAC3C,IAAI,EAEJ,OAAO,EAAY,CAClB,EAAiB,KAAK,YAAY,EAAW,SAAU,KAAK,QAAQ,QAEpE,GAAc,CAEd,GAAa,EAAe,gBAAgB,KAAK,MAAO,KAAK,QAAQ,QAGrE,IAAI,EAAW,KAAO,GACrB,KAAK,kBAAkB,EAAW,SAAU,EAE7C,GAAW,SAAS,eAAe,EAAY,KAAM,EAErD,GAAG,CAGF,IAAK,GAAc,EAAY,aAAa,YAAY,YAAY,EAAY,GAAI,CACnF,EAAY,SAAS,aAAa,EAAY,EAAa,KAAK,QAAS,EAAQ,KAAK,+BAChF,CACN,EAAY,SAAW,KAGxB,EAAc,EAAY,WAElB,GAAe,EAAY,UAAY,EAAW,WAAa,EAAY,SAEpF,GAAW,SAAS,iBAAiB,EAAY,KAEjD,GAAa,GAOR,GAAA,UAAA,MAAP,SAAa,EAAiC,GAE7C,KAAK,oBAAoB,EAEzB,MAAK,UAAU,gBAAgB,EAAqB,IAAK,EAAqB,KAE9E,MAAK,UAAU,aAAa,KAAM,EAAqB,KAEvD,MAAK,gBAAgB,KAAK,uBAAwB,EAElD,IAAI,KAAK,cACR,KAAK,UAAU,aAAa,MAAO,MAAO,MAAO,MAElD,IAAI,KAAK,eACR,KAAK,gBAAgB,KAAK,wBAAyB,EAEpD,IAAI,KAAK,cACR,KAAK,UAAU,aAAa,KAAM,KAAM,KAAM,MAQxC,GAAA,UAAA,gBAAR,SAAwB,EAA2B,GAElD,GAAI,EACJ,IAAI,EACJ,IAAI,GAA0B,KAAK,QAAQ,OAC3C,IAAI,GAAgB,EAAgB,MACpC,IAAI,EAEJ,OAAO,EAAY,CAClB,EAAiB,KAAK,YAAY,EAAW,SAAU,KAAK,QAAQ,QAGpE,IAAI,KAAK,eAAiB,EAAW,SAAS,gBAAkB,EAAG,CAClE,EAAc,CAEd,GAAG,CACF,EAAc,EAAY,WAElB,GAAe,EAAY,UAAY,EAAW,cACrD,CACN,EAAc,CAEd,GAAa,EAAe,gBAAgB,KAAK,MAAO,KAAK,QAAQ,QAGrE,IAAI,EAAW,KAAO,GACrB,KAAK,kBAAkB,EAAW,SAAU,EAE7C,GAAW,SAAS,eAAe,EAAY,KAAM,EAErD,GAAG,CACF,EAAY,SAAS,aAAa,EAAY,EAAa,KAAK,QAAS,EAAQ,KAAK,0BAEtF,GAAc,EAAY,WAElB,GAAe,EAAY,UAAY,EAAW,SAE3D,GAAW,SAAS,iBAAiB,EAAY,MAGlD,EAAa,GAGhB,OAAA,IA3K4B,EA6KL,GAAA,QAAd,iLCtMT,GAAO,GAAK,EAAgB,+BAK5B,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAA2B,EAAW,sDAQ7C,IAAO,GAAgB,EAAc,sDAK/B,GAAgB,WAYrB,QAZK,GAYO,GAZb,GAAA,GAAA,IASS,MAAA,oBAA8B,IAKrC,MAAK,qBAAuB,SAAC,GAAgB,MAAA,GAAK,YAAY,GAE9D,MAAK,OAAS,CACd,MAAK,YAAc,EAAiB,YAAY,EAChD,MAAK,YAAY,iBAAiB,EAAM,OAAQ,KAAK,sBAI9C,EAAA,UAAA,YAAR,SAAoB,GAEnB,KAAK,oBAAsB,KAG5B,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,wDAGN,GAAA,UAAA,oBAAP,SAA2B,GAE1B,GAAI,KAAK,oBAAqB,CAE7B,KAAK,kBAAkB,GAIxB,MAAO,MAAK,kBAGb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,cAGb,SAAmB,GAElB,KAAK,SAAW,CAEhB,MAAK,oBAAsB,IAE3B,MAAK,oBAAsB,KAE3B,KAAK,KAAK,SAAU,CAEnB,OAID,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,SAAS,SAAU,EAAG,IAKjD,GAAQ,KAAK,SAAS,EAC1B,IAAI,GAAwB,EAAE,oBAAsB,KAAQ,MAAQ,EAAE,kBAEtE,MAAK,oBAAsB,KAAK,qBAAuB,EAIxD,KAAK,oBAAsB,yCAIpB,GAAA,UAAA,kBAAR,SAA0B,GAEzB,GAAI,EAEJ,IAAI,KAAK,oBAAqB,CAE7B,KAAK,oBAIN,IAAK,KAAK,SAAU,CACnB,KAAK,OAAS,IACd,QAGD,KAAK,OAAS,GAAI,MAElB,GAAM,KAAK,SAAS,OAAS,CAE7B,IAAI,EAEJ,KAAK,GAAI,GAAW,EAAG,GAAK,IAAO,EAAG,CAGrC,EAAS,KAAK,SAAS,EAKvB,GAAO,iBAAiB,GAAK,EAAK,KAAO,KAAK,SAAS,EAAI,GAAG,oBAAoB,GAAQ,EAE1F,MAAK,OAAS,KAAK,OAAO,OAAO,EAAO,OAIzC,KAAK,kBAAoB,KAAK,SAAS,GAAG,oBAAoB,GAIxD,GAAA,UAAA,OAAP,SAAc,EAAa,EAAe,GAEzC,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAA4C,EAAM,OAEtD,IAAI,GAA2B,KAAK,YAAY,WAEhD,IAAI,GAA6B,KAAK,YAAY,2BAElD,KAAK,KAAK,SAAU,CACnB,OAGD,GAAI,KAAK,oBAAqB,CAC7B,KAAK,oBAGN,GAAI,KAAK,oBAAqB,CAC7B,KAAK,kBAAkB,GAGxB,EAAM,KAAK,SAAS,MAEpB,KAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CACzB,KAAK,SAAS,GAAG,OAAO,EAAO,GAGhC,EAAM,KAAK,OAAO,MAElB,IAAI,EAAM,EAAG,CACZ,EAAQ,kBAAkB,EAAG,EAAc,EAAG,EAA4B,QAC1E,GAAQ,kBAAkB,EAAG,EAAc,EAAG,EAA4B,SAG3E,IAAK,EAAI,EAAG,EAAI,IAAO,EAAG,CAEzB,EAAO,KAAK,OAAO,EAInB,KAAK,EAAK,OAAQ,CAEjB,EAAM,YAAc,IACpB,GAAe,KAAK,YAAY,0BAChC,GAAQ,kBAAkB,EAAG,EAAc,EAAG,EAA4B,QAC1E,GAAQ,kBAAkB,EAAG,EAAc,EAAG,EAA4B,SAI3E,EAAQ,aAAa,EAAG,EAAK,oBAAoB,GACjD,GAAQ,WAAW,EAAK,WAAW,GACnC,GAAQ,MAAM,EAAK,EAAK,EAAK,EAE7B,GAAK,SAAS,EAAO,EAAQ,EAE7B,GAAQ,gBAAgB,EAAqB,IAAK,EAAqB,KACvE,GAAQ,cAAc,EAAa,EAAG,EAEtC,GAAK,WAAW,GAGjB,EAAQ,aAAa,EAAG,KACxB,GAAQ,kBAAkB,EAAG,KAC7B,GAAQ,kBAAkB,EAAG,MAGtB,GAAA,UAAA,kBAAR,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,SAAS,SAAU,EAAG,CACrD,KAAK,SAAS,GAAG,aAAe,KAAK,YAAY,YACjD,MAAK,SAAS,GAAG,cAAgB,KAAK,YAAY,cAGnD,KAAK,oBAAsB,KAIrB,GAAA,UAAA,QAAP,WAEC,KAAK,YAAY,oBAAoB,EAAM,OAAQ,KAAK,qBACxD,MAAK,YAAc,IACnB,MAAK,OAAS,KAEhB,OAAA,KAEA,GAA0B,QAAjB,+XC9NT,IAAO,GAAQ,EAAgB,gCAC/B,IAAO,GAAK,EAAgB,6BAC5B,IAAO,GAAS,EAAe,iCAE/B,IAAO,GAAmB,EAAa,6CACvC,IAAO,GAAe,EAAc,yCAQpC,IAAO,GAAc,EAAc,yCAEnC,IAAO,GAAmB,EAAa,8CAMvC,IAAO,GAAa,EAAc,0CAClC,IAAO,GAAU,EAAe,uCAEhC,IAAO,GAAe,EAAc,8CAIpC,IAAO,GAAiB,EAAa,uDACrC,IAAO,GAAoB,EAAa,+CAOxC,IAAO,GAAmB,EAAa,iDACvC,IAAO,GAAqB,EAAY,mDAExC,IAAO,GAAgB,EAAc,8CAIrC,IAAO,GAAyB,EAAW,uDAI3C,IAAO,GAAsB,EAAY,mEAQnC,GAAY,SAAA,GAAS,EAArB,EAAY,EAiLjB,SAjLK,KAAN,GAAA,GAAA,IAmLE,GAAA,KAAA,KAjLO,MAAA,gBAAyB,CACzB,MAAA,iBAA0B,CAe1B,MAAA,UAAsB,GAAI,EAI3B,MAAA,oBAA8B,IAC9B,MAAA,sBAAgC,IAChC,MAAA,cAAwB,KACvB,MAAA,aAAsB,CACtB,MAAA,aAAsB,CACtB,MAAA,aAAsB,CACtB,MAAA,iBAA0B,CAC3B,MAAA,cAAwB,KAMxB,MAAA,cAAuB,CACvB,MAAA,cAAuB,CAKvB,MAAA,0BAAqC,GAAI,EAExC,MAAA,UAAkB,GAAI,EACtB,MAAA,WAAmB,GAAI,EACxB,MAAA,cAA0B,GAAI,EAQ9B,MAAA,eAAwB,CAgI9B,MAAK,2BAA6B,SAAC,GAAqB,MAAA,GAAK,kBAAkB,GAE/E,MAAK,kBAAoB,GAAI,EAE7B,MAAK,yBAA2B,EAAe,QAAQ,EACvD,MAAK,+BAAiC,EAAe,QAAQ,EAC7D,MAAK,2BAA6B,EAAe,QAAQ,EAEzD,MAAK,yBAA2B,SAAC,GAAgB,MAAA,GAAK,gBAAgB,GAGtE,MAAK,iBAAmB,GAAI,GAnI7B,OAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mDAYb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kDAMb,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,UAAU,OAGvB,SAAa,GAEZ,GAAI,KAAK,GAAK,EACb,MAED,MAAK,WAAW,EAAI,KAAK,UAAU,EAAI,CAEvC,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,UAAU;MAGvB,SAAa,GAEZ,GAAI,KAAK,GAAK,EACb,MAED,MAAK,WAAW,EAAI,KAAK,UAAU,EAAI,CAEvC,MAAK,sDAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CACd,MAAK,cAAc,MAAQ,CAE3B,IAAI,KAAK,mBACR,KAAK,mBAAmB,UAAY,CAErC,MAAK,oBAAsB,IAC3B,MAAK,sBAAwB,IAE7B,MAAK,0DAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,QAAU,CACf,MAAK,cAAc,OAAS,CAE5B,IAAI,KAAK,mBACR,KAAK,mBAAmB,WAAa,CAEtC,MAAK,oBAAsB,IAC3B,MAAK,sBAAwB,IAE7B,MAAK,0DAyBC,GAAA,UAAA,WAAP,SAAkB,GAGjB,IAAK,EAAiB,IAAI,OAAQ,CACjC,EAAiB,IAAM,EAAiB,oBACxC,EAAiB,WACjB,MACA,EAAiB,aACjB,EAAiB,sBACjB,EAAiB,8BACX,CACN,MAAO,GAAiB,YAGzB,GAAI,GAA0B,KAAK,UAAU,eAAe,EAAiB,IAG7E,IAAI,EAAiB,aAAe,EAAa,CAChD,GAAI,EAAiB,YACpB,EAAiB,YAAY,SAE9B,GAAiB,YAAc,CAE/B,GAAY,SAGb,MAAO,GAOD,GAAA,UAAA,YAAP,SAAmB,EAA8B,GAEhD,GAAI,GAA4B,KAAK,kBAAkB,QAAQ,EAE/D,IAAI,EAAa,iBAAkB,CAClC,EAAa,iBAAmB,KAEhC,IAAI,GAA6C,EAAa,kBAAkB,EAEhF,IAAI,GAA8B,KAAK,uBAAuB,EAAU,EAExE,IAAI,GAAgB,CACpB,IAAI,GAAc,CAClB,IAAI,EACJ,IAAI,GAAa,EAAmB,MACpC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAAK,CACpC,EAAmB,EAAmB,EAEtC,IAAI,EAAiB,eAAiB,EAAqB,CAC1D,EAAiB,cAAgB,CACjC,GAAiB,KAAO,GAGzB,GAAI,EAAiB,KAAO,GAC3B,KAAK,kBAAkB,EAAU,EAElC,IAAiB,KAAK,WAAW,GAAkB,GAAG,CACtD,IAAQ,IAGT,EAAa,cAAgB,EAG9B,MAAO,GAGD,GAAA,UAAA,qBAAP,SAA4B,EAAmC,GAE9D,GAAI,GAAgC,EAAiB,YAGrD,KAAK,GAAI,GAAI,EAAa,eAAgB,EAAI,KAAK,gBAAiB,IACnE,KAAK,UAAU,kBAAkB,EAAG,KAGrC,KAAK,GAAI,GAAI,EAAa,gBAAiB,EAAI,KAAK,iBAAkB,IACrE,KAAK,UAAU,aAAa,EAAG,KAEhC,IAAI,EAAiB,cACA,EAAiB,SAAS,aAAc,SAAS,EAAc,KAAK,QAGzF,GAAa,UAAU,KAAK,QAAS,MAGjC,GAA0B,KAAK,WAAW,EAE9C,KAAK,EAAY,QAAS,CACzB,EAAY,QAAU,KAAK,UAAU,eACrC,IAAI,IAA4B,GAAI,IAAoB,SAAS,kBAAoB,EAAiB,oBAAsB,EAAiB,WAAa,WAAY,UAAU,IAChL,IAAI,IAA8B,GAAI,IAAoB,SAAS,oBAAsB,EAAiB,aAAe,EAAiB,sBAAwB,EAAiB,0BAA4B,WAAY,YAAY,IACvO,GAAY,QAAQ,OAAO,EAAgB,GAI5C,KAAK,UAAU,WAAW,EAAY,SAGhC,GAAA,UAAA,uBAAP,SAA8B,GAE7B,GAAI,GAAgC,EAAiB,YAErD,IAAI,EAAiB,cACA,EAAiB,SAAS,aAAc,WAAW,EAAc,KAAK,QAE3F,GAAiB,aAAa,YAAY,KAAK,QAE/C,MAAK,gBAAkB,EAAa,cACpC,MAAK,iBAAmB,EAAa,gBAG/B,GAAA,UAAA,wBAAP,WAEC,MAAO,IAAI,GAQZ,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kBAGb,SAAyB,GAExB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,oBAAsB,yCAQ5B,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kBAGb,SAAyB,GAExB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,oBAAsB,yCAQ5B,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,kBAGb,SAAyB,GAExB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,oBAAsB,yCAG5B,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,aAGb,SAAiB,GAEhB,GAAI,GAAS,KAAK,QACjB,MAED,MAAK,UAAU,uCAGT,GAAA,UAAA,UAAP,SAAiB,GAEhB,GAAI,KAAK,QAAS,CACjB,KAAK,QAAQ,oBAAoB,EAAW,gBAAiB,KAAK,yBAClE,MAAK,QAAQ,oBAAoB,EAAW,kBAAmB,KAAK,yBACpE,MAAK,QAAQ,oBAAoB,EAAW,iBAAkB,KAAK,4BAGpE,IAAK,EAAO,CACX,KAAK,QAAU,IACf,MAAK,UAAY,SACX,CACN,KAAK,QAAU,CACf,MAAK,QAAQ,iBAAiB,EAAW,gBAAiB,KAAK,yBAC/D,MAAK,QAAQ,iBAAiB,EAAW,kBAAmB,KAAK,yBACjE,MAAK,QAAQ,iBAAiB,EAAW,iBAAkB,KAAK,2BAMhE,IAAI,KAAK,QAAQ,QAChB,KAAK,UAA8B,KAAK,QAAQ,QAGlD,KAAK,oBAAsB,IAE3B,MAAK,kBAON,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,mBAGb,SAAwB,GAEvB,GAAI,KAAK,eAAiB,EACzB,MAED,MAAK,cAAgB,CAErB,MAAK,sDAMC,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,mBACR,KAAK,mBAAmB,SAEzB,MAAK,mBAAqB,IAE1B,MAAK,QAAQ,oBAAoB,EAAW,gBAAiB,KAAK,yBAClE,MAAK,QAAQ,oBAAoB,EAAW,kBAAmB,KAAK,yBACpE,MAAK,QAAQ,oBAAoB,EAAW,iBAAkB,KAAK,2BAEnE,MAAK,QAAU,KAUT,GAAA,UAAA,OAAP,SAAc,GAEb,KAAK,eAAiB,KACtB,MAAK,cAAgB,MAUf,GAAA,UAAA,SAAP,SAAgB,EAA4B,EAAgC,EAA8B,GAA9D,GAAA,QAAA,GAA8B,CAA9B,EAAA,KAAgC,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAA8B,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAGzG,IAAK,KAAK,UAAY,KAAK,UAC1B,MAED,MAAK,0BAA0B,SAAS,EAAgB,OAAO,eAC/D,MAAK,0BAA0B,YAAY,KAAK,cAAe,KAAK,cAAe,EAEnF,MAAK,eAAe,EAAiB,EAAQ,EAAa,EAO1D,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,KAAK,UAAU,kBAAkB,EAAG,KACpC,MAAK,UAAU,aAAa,EAAG,OAI1B,GAAA,UAAA,iBAAP,SAAwB,EAAuC,EAAyB,EAAoB,EAA+B,IAKpI,GAAA,UAAA,oBAAP,SAA2B,GAG1B,KAAK,wBAA0B,IAC/B,MAAK,uBAAyB,IAC9B,MAAK,eAAiB,KAGlB,GAAsB,EAAgB,UAG1C,MAAK,SAAW,EAAgB,MAChC,MAAK,aAAe,KAAK,SAAS,aAClC,MAAK,gBAAkB,KAAK,SAAS,UAAU,aAG/C,OAAO,EAAM,CACZ,EAAK,OAAO,qBAAqB,KACjC,GAAO,EAAK,KAIb,KAAK,uBAA0C,KAAK,iBAAiB,sBAAsB,KAAK,uBAChG,MAAK,wBAA2C,KAAK,iBAAiB,uBAAuB,KAAK,yBAW5F,GAAA,UAAA,eAAP,SAAsB,EAA4B,EAAgC,EAA8B,GAA9D,GAAA,QAAA,GAA8B,CAA9B,EAAA,KAAgC,GAAA,QAAA,GAA4B,CAA5B,EAAA,KAA8B,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAE/G,KAAK,UAAU,gBAAgB,EAAQ,KAAM,EAE7C,KAAK,IAAW,KAAK,iBAAmB,KAAK,cAC5C,KAAK,UAAU,MAAM,KAAK,aAAc,KAAK,aAAc,KAAK,aAAc,KAAK,iBAAkB,EAAG,EAEzG,MAAK,UAAU,aAAa,MAAO,EAAqB,OAExD,MAAK,QAAQ,YAAc,CAO3B,MAAK,MAAM,EAAiB,EAK5B,KAAK,KAAK,cAAe,CACxB,GAAI,KAAK,mBAAqB,KAAK,oBAAqB,CACvD,KAAK,UAAU,iBAAiB,KAAK,oBACrC,MAAK,kBAAoB,OAI3B,KAAK,QAAQ,YAAc,KAMrB,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,kBAAoB,IACzB,MAAK,oBAAsB,EAOrB,GAAA,UAAA,MAAP,SAAa,EAA4B,GAExC,KAAM,IAAI,GAMH,GAAA,UAAA,gBAAR,SAAwB,GAEvB,KAAK,UAA8B,KAAK,QAAQ,QAGjD,QAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,sBAGb,SAA6B,GAE5B,GAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,iBAAmB,CAExB,MAAK,oBAAsB,yCA2CpB,GAAA,UAAA,oBAAR,WAEC,GAAI,KAAK,cACR,MAED,MAAK,cAAgB,IAErB,KAAK,KAAK,gBACT,KAAK,gBAAkB,GAAI,GAAc,EAAc,gBAExD,MAAK,cAAc,KAAK,iBAOjB,GAAA,UAAA,qBAAR,WAEC,GAAI,KAAK,eACR,MAED,MAAK,eAAiB,IAEtB,KAAK,KAAK,iBACT,KAAK,iBAAmB,GAAI,GAAc,EAAc,iBAEzD,MAAK,cAAc,KAAK,kBAMlB,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,UAAY,KAAK,QAAQ,QAG9B,IAAI,KAAK,cAAe,CACvB,KAAK,cAAc,EAAI,KAAK,WAAW,EAAI,KAAK,QAAQ,CACxD,MAAK,cAAc,EAAI,KAAK,WAAW,EAAI,KAAK,QAAQ,CACxD,MAAK,sBAGN,KAAK,uBAMC,GAAA,UAAA,gBAAP,WAEC,GAAI,KAAK,cAAe,CACvB,KAAK,cAAc,EAAI,KAAK,WAAW,EAAI,KAAK,UAAU,CAC1D,MAAK,cAAc,EAAI,KAAK,WAAW,EAAI,KAAK,UAAU,MACpD,CACN,KAAK,cAAc,EAAI,CACvB,MAAK,cAAc,EAAI,CACvB,MAAK,UAAU,EAAI,KAAK,WAAW,CACnC,MAAK,UAAU,EAAI,KAAK,WAAW,EAGpC,KAAK,sBASC,GAAA,UAAA,eAAP,SAAsB,GAErB,KAAK,iBAAkC,KAAK,yBAAyB,QAAQ,IAOvE,GAAA,UAAA,qBAAP,SAA4B,GAE3B,KAAK,iBAAkC,KAAK,+BAA+B,QAAQ,IAO7E,GAAA,UAAA,iBAAP,SAAwB,GAEvB,KAAK,iBAAkC,KAAK,2BAA2B,QAAQ,IAQxE,GAAA,UAAA,iBAAR,SAAyB,GAExB,GAAI,GAAqD,EAAW,cAAc,QAClF,IAAI,GAAiB,EAAW,YAChC,IAAI,GAAoB,EAAO,aAE/B,KAAK,EACJ,EAAW,EAAuB,mBAAmB,EAAW,cAGjE,GAAS,kBAGT,GAAW,SAAW,CACtB,GAAW,WAAa,EAAS,YACjC,GAAW,cAAgB,KAAK,YAAY,EAAU,KAAK,QAAQ,SAAS,aAC5E,GAAW,SAAW,KAGtB,GAAW,KAAK,aAAa,SAAS,EACtC,GAAW,OAAS,EAAO,QAAU,EAAS,WAAW,KAAK,gBAG9D,GAAW,qBAAuB,EAAW,aAAa,wBAAwB,KAAK,SAEvF,IAAI,EAAS,iBAAkB,CAC9B,EAAW,KAAO,KAAK,uBACvB,MAAK,wBAA0B,MACzB,CACN,EAAW,KAAO,KAAK,sBACvB,MAAK,uBAAyB,EAG/B,KAAK,gBAAkB,EAAW,YAGlC,IAAI,EAAW,SACd,KAAK,iBAAiB,EAAW,UAU3B,GAAA,UAAA,uBAAR,SAA+B,EAAuB,GAErD,GAAI,EAAS,aAAc,CAC1B,EAAS,aAAa,uBAEtB,IAAI,GAA+B,EAAS,OAC5C,IAAI,GAAmB,EAAO,MAE9B,IAAI,GAAa,EAAmB,MACpC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,IAAK,GAAI,GAAW,EAAG,EAAI,EAAW,IACrC,GAAI,EAAO,GAAG,SACG,EAAO,GAAG,SAAU,qBAAqB,EAAmB,GAAG,aAElF,QAAQ,EAAS,aAAa,QAG/B,MAAO,OAGD,GAAA,UAAA,kBAAP,SAAyB,EAAuB,GAG/C,EAAiB,IAAM,EACvB,GAAiB,oBAAsB,EACvC,GAAiB,sBAAwB,EAEzC,IAAI,GAAgC,EAAiB,YAGrD,IAAI,EAAiB,cAAe,CAEnC,GAAI,GAAmD,EAAS,YAEhE,GAAiB,qBAAuB,EAAa,kBAAkB,EAEvE,IAAI,EAAa,eAAiB,IAAM,EAAa,gBACpD,EAAiB,qBAAuB,EAAa,cAAc,EAEpE,IAAI,EAAa,sBAChB,EAAiB,uBAAyB,EAAa,oBAAoB,EAAc,EAAiB,aAE3G,GAAa,aAAa,OAEpB,IAGF,GAAa,EAAa,qBAAqB,MACnD,KAAK,GAAI,GAAW,EAAG,EAAI,IAAO,EACjC,EAAiB,qBAAuB,OAAS,EAAa,yBAAyB,GAAK,KAAO,EAAa,qBAAqB,GAAK,IAE3I,IAAI,EAAa,eAAiB,IAAM,EAAa,gBACpD,EAAiB,qBAAuB,OAAS,EAAa,SAAW,IAAM,EAAa,SAAW,MAG3G,OAAA,IAx1B2B,EA01B3B,GAAsB,QAAb,wgECl5BT,GAAO,GAAU,EAAc,uCA0CzB,GAAc,WA4GnB,QA5GK,GA4GO,EAA0B,EAA4B,EAA2B,EAA4B,EAAsB,EAAwB,EAAuB,GAAlL,GAAA,QAAA,GAAwB,CAAxB,EAAA,EAA0B,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAA4B,GAAA,QAAA,GAAyB,CAAzB,EAAA,EAA2B,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAA4B,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAAsB,CAAtB,EAAA,EAAwB,GAAA,QAAA,GAAqB,CAArB,EAAA,EAAuB,GAAA,QAAA,GAAsB,CAAtB,EAAA,EAE7L,KAAK,cAAgB,CACrB,MAAK,gBAAkB,CACvB,MAAK,eAAiB,CACtB,MAAK,gBAAkB,CACvB,MAAK,UAAY,CACjB,MAAK,YAAc,CACnB,MAAK,WAAa,CAClB,MAAK,YAAc,EAhDpB,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAQ,MAAK,WAAa,GAAQ,KAAK,aAAe,EAAK,KAAK,gBAGjE,SAAiB,GAEhB,GAAI,GAAgB,EAAW,mBAAmB,EAElD,MAAK,UAAY,EAAK,EACtB,MAAK,YAAc,EAAK,EACxB,MAAK,WAAa,EAAK,EAEvB,MAAK,cAAgB,CACrB,MAAK,gBAAkB,CACvB,MAAK,eAAiB,sCA+ChB,GAAA,UAAA,OAAP,SAAc,GAEb,KAAK,eAAiB,EAAO,aAC7B,MAAK,iBAAmB,EAAO,eAC/B,MAAK,gBAAkB,EAAO,cAC9B,MAAK,iBAAmB,EAAO,gBAEjC,OAAA,KAEwB,GAAA,QAAf,28DCrLT,IAAO,GAAK,EAAe,+BAC3B,IAAO,GAAa,EAAa,yCACjC,IAAO,GAAY,EAAc,qCAGjC,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EA4BlB,SA5BK,GA4BO,EAAuB,GAAA,GAAA,QAAA,GAA+B,CAA/B,EAAA,MAElC,EAAA,KAAA,KAAM,EAEN,MAAK,WAAa,EAxBnB,OAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iBAGb,SAAsB,GAErB,GAAI,KAAK,aAAe,EACvB,MAED,KAAK,EAAa,kBAAkB,GACnC,KAAM,IAAI,GAAM,iFAEjB,MAAK,YAAc,CAEnB,MAAK,mBAEL,MAAK,UAAU,EAAM,MAAO,EAAM,4CAU5B,GAAA,UAAA,QAAP,WAEC,EAAA,UAAM,QAAO,KAAA,KAEb,MAAK,YAAY,SACjB,MAAK,YAAc,KAGb,GAAA,UAAA,iBAAP,WAEC,MAAO,MAAK,YAEd,OAAA,IA/C4B,EAiD5B,GAAuB,QAAd,wqPCvDT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAa,SAAA,GAAS,EAAtB,EAAa,EAIlB,SAJK,GAIO,GAEX,EAAA,KAAA,KAAM,GAJO,EAAA,aAAsB,aAMrC,OAAA,IAR4B,EAUL,GAAA,QAAd,ilBCZT,IAAO,GAAK,EAAe,+BAE3B,IAAM,GAAU,SAAA,GAAS,EAAnB,EAAU,EAOf,SAPK,GAOO,GAEX,EAAA,KAAA,KAAM,GAPO,EAAA,gBAAyB,gBACzB,GAAA,iBAA0B,iBAC1B,GAAA,kBAA2B,kBAC3B,GAAA,iBAA0B,iBAMzC,OAAA,IAXyB,EAaL,GAAA,QAAX,gQCJH,GAAY,WAAlB,QAAM,MAMS,EAAA,OAAgB,CAMhB,GAAA,OAAgB,CAMhB,GAAA,IAAa,CAC5B,OAAA,KAEA,GAAsB,QAAb,0LC/BT,IAAO,GAAK,EAAgB,+BAC5B,IAAO,GAAS,EAAe,oCAE/B,IAAO,GAAc,EAAc,yCAKnC,IAAO,GAAS,EAAe,oCAO/B,IAAO,GAAa,EAAc,8CAiB5B,GAAY,SAAA,GAAS,EAArB,EAAY,EAsEjB,SAtEK,KAAN,GAAA,GAAA,IAwEE,GAAA,KAAA,KArEO,MAAA,kBAA6C,GAAI,MACjD,MAAA,cAAqC,GAAI,MAE1C,MAAA,iBAA0B,CAC1B,MAAA,aAAuB,KACtB,MAAA,oBAA8B,IAC9B,MAAA,sBAA+B,CAC/B,MAAA,qBAA8B,CAsB/B,MAAA,aAAsB,CAEtB,MAAA,sBAA+B,CAE9B,MAAA,WAAqB,KAEtB,MAAA,sBAAgC,IAShC,MAAA,YAAqB,EAAU,MAE9B,MAAA,WAAoB,CAGpB,MAAA,QAAkB,KAClB,MAAA,QAAkB,IAClB,MAAA,QAAkB,KAClB,MAAA,OAAgB,QAKjB,MAAA,SAAkB,CAClB,MAAA,QAAiB,CACjB,MAAA,mBAA6B,KAYnC,MAAK,aAAe,OAAO,KAAK,GAEhC,MAAK,QAAU,GAAI,MACnB,MAAK,QAAU,GAAI,MAEnB,MAAK,sBAAwB,SAAC,GAAgB,MAAA,GAAK,aAAa,GAChE,MAAK,uBAAyB,SAAC,GAAgB,MAAA,GAAK,eAAe,GAEnE,MAAK,mBAAqB,MAM3B,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,GAAU,6CAMlB,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAMb,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAUb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,mBAGb,SAAuB,GAEtB,GAAI,KAAK,eAAiB,EACzB,MAED,IAAI,KAAK,cACR,KAAK,cAAc,oBAAoB,EAAM,OAAQ,KAAK,uBAE3D,MAAK,cAAgB,CAErB,IAAI,KAAK,cACR,KAAK,cAAc,iBAAiB,EAAM,OAAQ,KAAK,uBAExD,MAAK,+DAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,QAAU,CAEf,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,QAAU,CAEf,MAAK,yDAON,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,MAAK,QAAU,CAEf,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,MAAK,OAAS,CAEd,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,eAGb,SAAmB,GAElB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,UAAY,CAEjB,MAAK,oBAEL,MAAK,SAAW,KAAK,UAAU,MAC/B,MAAK,QAAU,KAAK,UAAU,KAE9B,MAAK,0DAMN,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,kBAGb,SAAsB,GAErB,GAAI,KAAK,cAAgB,EACxB,MAED,MAAK,aAAe,CAEpB,MAAK,yDAON,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,yBAGb,SAA8B,GAE7B,GAAI,KAAK,qBAAuB,EAC/B,MAED,MAAK,oBAAsB,CAE3B,MAAK,yDASN,QAAA,eAAW,EAAA,UAAA,2BAAX,WAEC,MAAO,MAAK,0BAGb,SAA+B,GAE9B,GAAI,KAAK,sBAAwB,EAChC,MAED,MAAK,qBAAuB,CAE5B,MAAK,yDASN,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,2BAGb,SAAgC,GAE/B,GAAI,KAAK,uBAAyB,EACjC,MAED,MAAK,sBAAwB,CAE7B,MAAK,yDAOC,GAAA,UAAA,QAAP,WAEC,GAAI,EACJ,IAAI,EAEJ,MAAK,qBAEL,GAAM,KAAK,cAAc,MACzB,KAAK,EAAI,EAAG,EAAI,EAAK,IACpB,KAAK,cAAc,GAAG,SAEvB,MAAK,cAAgB,GAAI,MAEzB,GAAM,KAAK,kBAAkB,MAC7B,KAAK,EAAI,EAAG,EAAI,EAAK,IACpB,KAAK,kBAAkB,GAAG,SAE3B,MAAK,kBAAoB,GAAI,OAM9B,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,GAAI,KAAK,WAAa,EACrB,MAED,MAAK,WAAa,CAElB,MAAK,yDAaN,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,iBAGb,SAAqB,GAEpB,GAAI,KAAK,aAAe,EACvB,MAED,MAAK,YAAc,CAEnB,MAAK,yDAQN,QAAA,eAAW,EAAA,UAAA,0BAAX,WAEC,MAAO,MAAK,yBAGb,SAA8B,GAE7B,GAAI,KAAK,qBAAuB,EAC/B,MAED,MAAK,oBAAsB,CAE3B,MAAK,yDAQN,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,sBAGb,SAA0B,GAEzB,GAAI,EAAQ,EACX,EAAQ,MACJ,IAAI,EAAQ,EAChB,EAAQ,CAET,IAAI,KAAK,kBAAoB,EAC5B,MAED,MAAK,iBAAmB,CAExB,MAAK,yDAMN,QAAA,eAAW,EAAA,UAAA,wBAAX,WAEC,MAAO,MAAK,uDAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,4CAWN,GAAA,UAAA,eAAP,SAAsB,EAAwB,EAAoB,GAEjE,EAAK,aAAa,WAAW,EAAM,EAAU,GAUvC,GAAA,UAAA,iBAAP,SAAwB,EAAwB,GAE/C,EAAK,aAAa,aAAa,EAAM,GAc/B,GAAA,UAAA,aAAP,SAAoB,EAAwB,EAAwB,EAAc,EAAe,GAEhG,GAAI,KAAK,cACR,KAAK,cAAc,cAAc,EAElC,GAAK,aAAa,SAAS,EAAM,EAAY,EAAO,EAAQ,GAetD,GAAA,UAAA,UAAP,SAAiB,GAEhB,KAAK,QAAQ,KAAK,EAElB,IAAI,EACJ,IAAI,GAAiC,EAAM,QAE3C,IAAI,EACH,EAA+B,EAAS,YAEzC,IAAI,EAAM,SAAU,CACnB,GAAI,KAAK,eAAiB,GAAgB,KAAK,cAAe,CAC7D,KAAM,IAAI,OAAM,iGACV,CACN,GAAI,KAAK,eAAiB,EAAc,CAEvC,KAAK,cAAgB,CAErB,MAAK,yBAYF,GAAA,UAAA,aAAP,SAAoB,GAEnB,KAAK,QAAQ,OAAO,KAAK,QAAQ,QAAQ,GAAQ,EAEjD,IAAI,KAAK,QAAQ,QAAU,EAAG,CAC7B,KAAK,cAAgB,IAErB,MAAK,uBASP,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,4CAQN,GAAA,UAAA,kBAAP,WAEC,MAAO,MAAK,WAQb,QAAA,eAAW,EAAA,UAAA,sBAAX,WAEC,MAAO,MAAK,4CAQN,GAAA,UAAA,mBAAP,WAEC,GAAI,GAAa,KAAK,kBAAkB,MACxC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,kBAAkB,GAAG,YAE3B,MAAK,qBAMC,GAAA,UAAA,yBAAP,WAEC,KAAK,sBAAwB;CAOvB,GAAA,UAAA,mBAAP,SAA0B,GAEzB,EAAK,oBAAoB,EAAM,OAAQ,KAAK,sBAC5C,MAAK,QAAQ,OAAO,KAAK,QAAQ,QAAQ,GAAO,EAEhD,MAAK,aAMC,GAAA,UAAA,oBAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,KAAK,aAAc,EAC7C,KAAK,QAAQ,GAAG,oBAAoB,EAAM,OAAQ,KAAK,sBAExD,MAAK,QAAQ,OAAS,KAAK,WAAa,EAOlC,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,QAAQ,KAAK,cAAgB,CAElC,GAAK,YAAc,KAAK,aACxB,GAAK,iBAAiB,EAAM,OAAQ,KAAK,sBAEzC,MAAK,qBAGC,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,cAAc,KAAK,EAExB,OAAO,GAGD,GAAA,UAAA,qBAAP,SAA4B,GAE3B,KAAK,cAAc,OAAO,KAAK,cAAc,QAAQ,GAAe,EAEpE,OAAO,GAQD,GAAA,UAAA,iBAAP,YAOQ,GAAA,UAAA,aAAR,SAAqB,GAEpB,KAAK,qBAGE,GAAA,UAAA,oBAAR,WAEC,GAAI,GAAa,KAAK,cAAc,MACpC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,cAAc,GAAG,sBAGhB,GAAA,UAAA,mBAAR,WAEC,GAAI,GAAa,KAAK,cAAc,MACpC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAC/B,KAAK,cAAc,GAAG,qBAMhB,GAAA,UAAA,eAAR,SAAuB,GAEtB,KAAK,2BAGC,GAAA,UAAA,oBAAP,WAEC,IAAK,KAAK,aACT,KAAK,aAAe,GAAI,GAAc,EAAc,aAErD,MAAK,cAAc,KAAK,cAGlB,GAAA,UAAA,sBAAP,SAA6B,GAE5B,KAAK,kBAAkB,KAAK,EAE5B,OAAO,GAGD,GAAA,UAAA,yBAAP,SAAgC,GAE/B,KAAK,kBAAkB,OAAO,KAAK,kBAAkB,QAAQ,GAAmB,EAEhF,OAAO,GAET,OAAA,IA5rB2B,EA8rBL,GAAA,QAAb,moHCxtBH,GAAc,WAYnB,QAZK,GAYO,GARJ,KAAA,MAAe,GAAI,OAU1B,MAAK,iBAAmB,EASlB,EAAA,UAAA,QAAP,SAAe,GAEd,MAAsB,MAAK,MAAM,EAAc,MAAQ,KAAK,MAAM,EAAc,IAAM,EAAc,gBAAgB,GAAI,MAAK,iBAAiB,KAAM,KAQ9I,GAAA,UAAA,YAAP,SAAmB,GAElB,EAAc,mBAAmB,KAAK,MAAM,EAAc,IAE1D,MAAK,MAAM,EAAc,IAAM,KASlB,GAAA,QAAd,SAAsB,GAErB,GAAI,GAAsB,EAAe,OAAO,EAAgB,GAEhE,IAAI,GAAQ,UACX,MAAO,EAER,OAAyB,GAAe,OAAO,EAAgB,IAAM,GAAI,GAAe,GAQ3E,GAAA,YAAd,SAA0B,GAEzB,GAAI,EAAe,OAAO,EAAgB,IACzC,EAAe,OAAO,EAAgB,IAAM,UA9D/B,GAAA,OAAgB,GAAI,OAgEpC,OAAA,KAEwB,GAAA,QAAf,+BCrEH,GAAmB,WAAzB,QAAM,MAEE,EAAA,UAAA,uBAAP,SAA8B,GAE7B,GAAI,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,IAAS,EAAK,KAAM,CACxB,MAAO,GAIR,EAAO,CACP,GAAO,EAAK,IAEZ,OAAO,EAAM,CACZ,EAAO,EAAK,IACZ,IAAI,EAAM,CACT,EAAO,EAAK,IACZ,GAAO,EAAK,MAId,EAAQ,EAAK,IACb,GAAK,KAAO,IAGZ,GAAO,KAAK,uBAAuB,EACnC,GAAQ,KAAK,uBAAuB,MAGhC,EACJ,IAAI,EACJ,IAAI,EAEJ,KAAK,EACJ,MAAO,EACR,KAAK,EACJ,MAAO,EAER,OAAO,GAAQ,EAAO,CACrB,GAAI,EAAK,OAAS,EAAM,OAAQ,CAC/B,EAAI,CACJ,GAAO,EAAK,SACN,CACN,EAAI,CACJ,GAAQ,EAAM,KAGf,IAAK,EACJ,EAAS,MACT,GAAK,KAAO,CAEb,GAAO,EAGR,GAAI,EACH,EAAK,KAAO,MAAW,IAAI,EAC3B,EAAK,KAAO,CAEb,OAAO,GAGD,GAAA,UAAA,sBAAP,SAA6B,GAE5B,GAAI,EACJ,IAAI,GAAkB,CAEtB,KAAK,IAAS,EAAK,KAAM,CACxB,MAAO,GAIR,EAAO,CACP,GAAO,EAAK,IAEZ,OAAO,EAAM,CACZ,EAAO,EAAK,IACZ,IAAI,EAAM,CACT,EAAO,EAAK,IACZ,GAAO,EAAK,MAId,EAAQ,EAAK,IACb,GAAK,KAAO,IAGZ,GAAO,KAAK,sBAAsB,EAClC,GAAQ,KAAK,sBAAsB,MAG/B,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAAa,CAEjB,KAAK,EACJ,MAAO,EACR,KAAK,EACJ,MAAO,EAER,OAAO,GAAQ,GAAS,GAAQ,MAAQ,GAAS,KAAM,IAKlD,GAAa,EAAK,aACtB,IAAI,GAAa,EAAM,aAEvB,IAAI,GAAO,EAAK,CACf,GAAI,GAAY,EAAK,UACrB,IAAI,GAAY,EAAM,UAEtB,IAAI,GAAM,EAAI,CACb,GAAI,EAAK,OAAS,EAAM,OACvB,EAAM,MACN,IAAO,MACF,IAAI,EAAK,EAAI,CACnB,EAAM,MACA,CACN,GAAO,OAEF,IAAI,EAAM,EAAK,CACrB,EAAM,MACA,CACN,GAAO,EAGR,GAAI,EAAM,EAAG,CACZ,EAAI,CACJ,GAAO,EAAK,SACN,CACN,EAAI,CACJ,GAAQ,EAAM,KAGf,IAAK,EAAQ,CACZ,EAAS,CACT,GAAO,MACD,CACN,EAAK,KAAO,CACZ,GAAO,GAIT,GAAI,EACH,EAAK,KAAO,MAAW,IAAI,EAC3B,EAAK,KAAO,CAEb,OAAO,GAET,OAAA,KAEA,GAA6B,QAApB,sYChKT,IAAO,GAAa,EAAc,gDAU5B,GAAe,SAAA,GAAS,EAAxB,EAAe,EAsDpB,SAtDK,KAwDJ,EAAA,KAAA,KAhDM,MAAA,YAAqB,CAEpB,MAAA,sBAA+B,CAC/B,MAAA,gBAAyB,CACzB,MAAA,gBAAyB,CA8ChC,MAAK,SAAW,GAAI,MACpB,MAAK,mBAAqB,GAAI,MAC9B,MAAK,aAAe,GAAI,MACxB,MAAK,aAAe,GAAI,OA5CzB,OAAA,eAAW,EAAA,UAAA,yBAAX,WAEC,MAAO,MAAK,uDAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAMb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAMb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,6CAiBN,GAAA,UAAA,sBAAP,SAA6B,GAE5B,KAAK,mBAAoB,KAAK,yBAA+C,EAOvE,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,aAAc,KAAK,mBAAmC,EAOrD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,KAAK,aAAc,KAAK,mBAAmC,EAOrD,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,SAAoB,EAMnB,GAAA,UAAA,MAAP,WAEC,EAAA,UAAM,MAAK,KAAA,KAEX,MAAK,SAAW,IAEhB,IAAI,KAAK,YAAc,EACtB,KAAK,SAAS,OAAS,KAAK,YAAc,CAE3C,IAAI,KAAK,sBAAwB,EAChC,KAAK,mBAAmB,OAAS,KAAK,sBAAwB,CAE/D,IAAI,KAAK,gBAAkB,EAC1B,KAAK,aAAa,OAAS,KAAK,gBAAkB,CAEnD,IAAI,KAAK,gBAAkB,EAC1B,KAAK,aAAa,OAAS,KAAK,gBAAkB,EAErD,OAAA,IAzH8B,EA2H9B,GAAyB,QAAhB,msQCpIT,GAAO,GAAW,EAAc,uCAChC,IAAO,GAAM,EAAe,kCAC5B,IAAO,GAAO,EAAe,mCAC7B,IAAO,GAAK,EAAe,iCAE3B,IAAM,GAAa,WAElB,QAFK,MAME,EAAA,UAAA,qBAAP,SAA4B,GAE3B,GAAI,GAAgB,GAAI,EAExB,IAAI,EAAM,oBAAsB,IAAM,CACrC,KAAM,qCAGP,EAAO,QAAU,EAAM,iBACvB,IAAI,EAAO,SAAW,GAAM,CAC3B,EAAM,kBACN,GAAO,UAAY,EAEpB,GAAI,EAAM,oBAAsB,IAAM,CACrC,KAAM,qCAGP,EAAO,OAAS,EAAM,kBACtB,QAAQ,EAAO,QACd,IAAK,GACJ,EAAO,KAAO,UACd,MACD,KAAK,GACJ,EAAO,KAAO,QACd,MACD,KAAK,GACJ,EAAO,KAAO,KACd,MACD,SACC,EAAO,KAAO,EACd,OAGF,GAAI,GAAmB,GAAI,EAC3B,IAAI,KACJ,OAAO,EAAM,SAAW,EAAM,OAAQ,CACrC,GAAI,GAAc,GAAI,EAEtB,GAAM,OAAS,EAAM,iBACrB,IAAI,GAAW,EAAQ,aAAa,EAAM,OAC1C,KAAK,EAAU,CACd,KAAM,4CAA8C,EAAM,OAE3D,GAAI,EAAS,aAAc,CAC1B,EAAK,UAAY,KAElB,GAAI,EAAS,KAAM,CAClB,EAAM,KAAK,OAAS,EAAM,mBAC1B,GAAM,KAAK,KAAO,EAAM,kBACxB,GAAM,KAAK,QAAU,EAAM,kBAC3B,GAAK,SAAS,EAAM,KAAK,SAAS,EAAM,KAAK,SAAW,EAAM,KAAK,SAC7D,CACN,EAAM,KAAO,IACb,GAAM,kBAEP,GAAI,EAAS,EAAG,CACf,KAAK,QAAQ,EAAM,EAAG,EAAG,EAAM,OACzB,CACN,EAAM,EAAI,IACV,GAAM,iBACN,GAAM,kBAEP,GAAI,EAAS,EAAG,CACf,KAAK,QAAQ,EAAM,EAAG,EAAS,aAAe,EAAG,EAAM,OACjD,CACN,EAAM,EAAI,IACV,GAAM,iBACN,GAAM,kBAEP,EAAO,KAAK,GAEb,EAAK,OAAS,CACd,GAAK,OAAS,CAEd,OAAO,GAGD,GAAA,UAAA,QAAP,SAAe,EAAG,EAAI,EAAM,GAE3B,EAAE,OAAS,EAAM,mBACjB,GAAE,YAAc,EAAM,UACtB,GAAE,QAAU,EAAM,kBAClB,GAAE,QAAU,EAAM,kBAClB,GAAK,QAAQ,EAAE,SAAS,EAAE,QAAU,EACpC,IAAI,EAAE,SAAW,EAAK,CAErB,EAAE,QAAU,EAAE,WACd,GAAE,YAAc,SAChB,GAAE,QAAU,SAGZ,GAAE,SAAW,EAAM,kBACnB,GAAE,IAAM,EAAE,UAAY,CACtB,GAAE,UAAY,EACd,GAAE,QAAU,EAAM,kBAClB,GAAE,KAAO,EAAE,SAAW,CACtB,GAAE,SAAW,EACb,GAAE,OAAS,EAAM,kBACjB,GAAE,OAAS,EAAE,QAAU,CACvB,GAAE,QAAU,EACZ,GAAK,SAAS,EAAE,QAAU,MACpB,CACN,EAAE,aAAe,EAAM,kBACvB,GAAE,YAAc,EAAM,kBACtB,GAAE,aAAe,EAAM,mBAExB,GAAI,EAAE,aAAc,CACnB,EAAK,YAAc,KAEpB,IAAK,EAAE,cAAgB,EAAI,CAC1B,IAAK,GAAI,GAAa,EAAG,EAAM,EAAI,IACnC,CACC,EAAK,QAAQ,EAAE,SAAS,EAAE,OAAS,GAAO,EAAK,QAAQ,EAAE,SAAS,EAAE,UAIxE,OAAA,KAEuB,GAAA,QAAd,wLClIT,GAAO,GAAO,EAAe,mCAC7B,IAAO,GAAc,EAAa,yCAElC,IAAM,GAAW,WAAjB,QAAM,MAEE,EAAA,UAAA,MAAP,SAAa,GAEZ,GAAI,GAAgB,EACpB,IAAI,GAAc,EAElB,IAAU,0BACV,IAAI,GAAM,EAAK,OAAO,KAAK,EAG3B,IAAI,EAAK,OAAO,MAAQ,SAAU,CACjC,GAAU,yBAEX,IAAK,EAAK,YAAa,CACtB,IAAK,GAAI,GAAW,EAAG,EAAI,EAAK,QAAQ,GAAK,OAAQ,IAAK,CACzD,GAAI,EAAK,QAAQ,GAAK,GAAI,CACzB,GAAU,gBAAkB,EAAM,IAAM,EAAI,YAGxC,CACN,GAAU,gBAAkB,EAAM,SAAW,EAAe,mBAAqB,OAIlF,IAAK,GAAI,GAAI,EAAG,EAAI,EAAK,QAAQ,GAAK,QAAU,EAAI,EAAK,SAAS,GAAK,OAAQ,IAAK,CACnF,GAAI,EAAK,QAAQ,GAAK,IAAM,EAAK,SAAS,GAAK,GAC/C,CACC,GAAU,QAAU,EAAM,IAAM,EAAI,OAKtC,IAAK,GAAI,GAAW,EAAG,EAAI,EAAK,QAAQ,GAAK,OAAQ,IAAK,CACzD,GAAI,EAAK,QAAQ,GAAK,GAAI,CACzB,GAAU,oBAAsB,EAAI,OAKtC,IAAK,GAAI,GAAW,EAAG,EAAI,EAAK,QAAQ,GAAK,QAAU,EAAI,EAAK,SAAS,GAAK,OAAQ,IAAK,CAC1F,GAAI,EAAK,QAAQ,GAAK,IAAM,EAAK,SAAS,GAAK,GAAI,CAClD,GAAU,kBAAoB,EAAI,UAKhC,IAA0B,KAAM,OAAQ,KAAM,GAClD,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,SAAS,OAAQ,IAAK,CACrD,GAAI,EAAK,SAAS,GAAI,CACrB,GAAU,kBAAoB,EAAU,EAAK,SAAS,GAAG,IAAM,GAAM,MAAQ,EAAI,OAKnF,GAAI,EAAK,OAAO,MAAQ,SAAU,CACjC,GAAU,iBAEX,GAAI,EAAK,WAAY,CACpB,GAAU,wBAMX,GAAQ,iBAER,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,OAAO,OAAQ,IAAK,CACnD,GAAI,GAAW,EAAQ,aAAa,EAAK,OAAO,GAAG,OACnD,KAAK,EAAU,CACd,KAAM,4CAGP,GAAI,GAAW,EAAS,cAAgB,CAExC,KAAK,GAAI,GAAY,EAAG,EAAK,EAAU,IAAM,CAC5C,GAAI,GAAc,KAAO,EAAS,CAClC,IAAI,EAAK,OAAO,GAAG,KAAM,CACxB,GAAI,EAAS,aAAc,CAC1B,IAAM,EAAK,OAAO,GAAG,KAAK,MAAQ,EAAM,IAAM,EAAG,CAChD,SAED,GAAI,GAAuB,KAAK,YAAY,EAAK,OAAO,GAAG,KAAK,QAAS,EAAK,OAAO,GAAG,KAAK,OAAQ,EAAM,EAC3G,IAAI,GAAwB,OAC5B,IAAI,IAAkB,IAAK,IAAK,IAAK,KAAK,EAC1C,IAAiB,IAAM,MACjB,CACN,GAAI,GAAuB,KAAK,YAAY,EAAK,OAAO,GAAG,KAAK,QAAS,EAAK,OAAO,GAAG,KAAK,OAAQ,EAAM,EAC3G,IAAI,EACJ,IAAI,EACJ,IAAI,EAAK,OAAO,GAAG,KAAK,MAAQ,GAAK,CACpC,GAAI,GAAe,CACnB,GAAiB,EACjB,IAAI,EAAK,OAAO,GAAG,KAAK,KAAO,EAAG,CACjC,GACA,IAAkB,IAEnB,GAAI,EAAK,OAAO,GAAG,KAAK,KAAO,EAAG,CACjC,GACA,IAAkB,IAEnB,GAAI,EAAK,OAAO,GAAG,KAAK,KAAO,EAAG,CACjC,GACA,IAAkB,IAEnB,GAAI,EAAK,OAAO,GAAG,KAAK,KAAO,EAAG,CACjC,GACA,IAAkB,IAEnB,GAAiB,IAAM,CACvB,QAAQ,GACP,IAAK,GACJ,EAAiB,OACjB,MACD,KAAK,GACJ,EAAiB,MACjB,MACD,KAAK,GACJ,EAAiB,MACjB,MACD,SACC,KAAM,mCAEF,CACN,EAAiB,MACjB,GAAiB,QAGnB,EAAO,EAAK,QAAQ,QAAS,EAC7B,GAAO,EAAK,QAAQ,QAAS,EAC7B,GAAO,EAAK,QAAQ,MAAO,GAE5B,GAAI,GAAa,EACjB,KAAK,EAAS,MAAQ,EAAS,MAAQ,EAAK,OAAO,GAAG,KAAM,CAC3D,EAAM,EAAK,OAAO,GAAG,KAAK,KAE3B,GAAI,EAAK,OAAO,GAAG,EAAG,CACrB,EAAO,EAAK,QAAQ,KAAM,KAAK,eAAe,EAAK,OAAO,GAAG,EAAG,EAAG,EAAK,EAAS,OAAQ,EAAM,IAEhG,GAAI,EAAK,OAAO,GAAG,EAAG,CACrB,EAAO,EAAK,QAAQ,KAAM,KAAK,eAAe,EAAK,OAAO,GAAG,EAAG,EAAI,EAAK,EAAS,OAAQ,EAAM,GAChG,IAAI,EAAK,OAAO,GAAG,EAAE,SAAW,EAAK,IAEhC,IAAU,KAAM,OAAQ,MAAM,EAAK,OAAO,GAAG,EAAE,IACnD,IAAI,IAAW,OAAQ,OAAQ,QAAQ,EAAK,OAAO,GAAG,EAAE,IACxD,GAAO,EAAK,QAAQ,UAAW,EAC/B,GAAO,EAAK,QAAQ,WAAY,EAChC,IAAI,GAAgB,EACpB,GAAO,EAAK,QAAQ,OAAQ,IAG9B,GAAQ,GAKV,GAAI,EAAK,OAAO,MAAQ,SAAU,CACjC,GAAQ,iFAIT,GAAI,EAAK,WAAY,CACpB,GAAQ,mDAIT,GAAQ,KAER,OAAO,GAAS,EAGV,GAAA,UAAA,YAAP,SAAmB,EAAgB,EAAe,EAAkB,GAEnE,OAAQ,GACP,IAAK,GACJ,MAAO,KAAO,CACf,KAAK,GACJ,GAAI,EAAK,aAAe,EAAK,OAAO,MAAQ,SAAU,CACrD,MAAO,UAAY,EAAS,QACtB,CACN,MAAO,GAAM,IAAM,EAErB,IAAK,GACJ,MAAO,GAAM,IAAM,CACpB,KAAK,GACJ,MAAO,GAAK,OAAO,MAAQ,SAAU,SAAW,cACjD,KAAK,GACJ,MAAO,KAAO,CACf,KAAK,GACJ,MAAO,KAAO,CACf,KAAK,GACJ,MAAO,eACR,SACC,KAAM,yBAIF,GAAA,UAAA,eAAP,SAAsB,EAAG,EAAS,EAAK,EAAU,EAAM,GAEtD,GAAI,IAAS,IAAK,IAAK,IAAK,IAC5B,IAAI,EAEJ,IAAI,EAAE,aAAc,CACnB,EAAI,cAAgB,KAAK,YAAY,EAAE,aAAc,EAAE,OAAQ,EAAM,GAAO,IAAM,EAAK,EAAE,aAAe,GACxG,IAAI,GAAU,EAAU,EAAE,WAC1B,IAAI,EAAU,EAAG,GAAK,EAAQ,UAC9B,IAAI,EAAU,EAAG,GAAK,IAAM,EAAQ,UACpC,IAAK,QACC,CACN,EAAI,KAAK,YAAY,EAAE,QAAS,EAAE,OAAS,EAAS,EAAM,GAI3D,GAAI,EAAE,SAAW,EAAK,CACrB,MAAO,GAIR,GAAI,EAAU,CACb,MAAO,GAAI,IAAM,EAAM,EAAE,SAAW,EAAK,GAI1C,GAAI,EAAE,SAAW,KAAQ,GAAO,GAAK,CACpC,MAAO,GAIR,GAAK,GACL,IAAI,EAAM,EAAG,GAAK,EAAM,EAAE,SAAW,EAAK,EAC1C,IAAI,EAAM,EAAG,GAAK,EAAM,EAAE,SAAW,EAAK,EAC1C,IAAI,EAAM,EAAG,GAAK,EAAM,EAAE,SAAW,EAAK,EAC1C,IAAI,EAAM,EAAG,GAAK,EAAM,EAAE,SAAW,EAAK,EAC1C,OAAO,GAET,OAAA,KAEA,GAAqB,QAAZ,+GCjPT,GAAO,GAAM,EAAe,kCAG5B,IAAM,GAAW,WA6BhB,QA7BK,KAEE,KAAA,8BASA,MAAA,+BASA,MAAA,YAAsB,KACtB,MAAA,WAAqB,KACrB,MAAA,UAAoB,KACpB,MAAA,WAGA,MAAA,SACA,MAAA,OAAgB,GAAI,GAK5B,MAAA,KAEqB,GAAA,QAAZ,iECrCT,GAAM,GAAW,WAOhB,QAPK,KAEE,KAAA,KAAc,CACd,MAAA,OAAgB,CAChB,MAAA,QAAiB,CACjB,MAAA,IAAa,EAKrB,MAAA,KAEA,GAAqB,QAAZ,4BCZT,GAAM,GAAM,WAMX,QANK,KAEE,KAAA,OAAgB,CAChB,MAAA,QAAiB,CACjB,MAAA,KAAc,GAKtB,MAAA,KAEgB,GAAA,QAAP,4BCXT,GAAO,GAAK,EAAe,iCAE3B,IAAM,GAAO,WA2CZ,QA3CK,GA2CO,IAzCL,EAAA,cAGN,GAAI,GAAM,uBAAwB,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MACtF,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1F,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1F,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1F,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1F,GAAI,GAAM,6BAA8B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC5F,GAAI,GAAM,+BAAgC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC7F,GAAI,GAAM,+BAAgC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC7F,GAAI,GAAM,8BAA+B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC7F,GAAI,GAAM,kCAAmC,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MACjG,GAAI,GAAM,yCAA0C,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MACxG,GAAI,GAAM,oCAAqC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAClG,GAAI,GAAM,kCAAmC,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MACjG,GAAI,GAAM,6BAA8B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAG5F,GAAI,GAAM,2CAA4C,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC1G,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC3F,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC3F,GAAI,GAAM,6CAA8C,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAC3G,GAAI,GAAM,2CAA4C,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACzG,GAAI,GAAM,2CAA4C,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MACzG,GAAI,GAAM,4BAA6B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC3F,GAAI,GAAM,8BAA+B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC7F,GAAI,GAAM,sCAAuC,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MACrG,GAAI,GAAM,2CAA4C,KAAM,KAAM,KAAM,KAAM,EAAG,EAAG,KAAM,KAAM,KAAM,MACtG,GAAI,GAAM,2CAA4C,KAAM,KAAM,KAAM,KAAM,EAAG,EAAG,KAAM,KAAM,KAAM,MACtG,GAAI,GAAM,2CAA4C,KAAM,KAAM,KAAM,KAAM,EAAG,EAAG,KAAM,KAAM,KAAM,MACtG,GAAI,GAAM,6BAA8B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC5F,GAAI,GAAM,6BAA8B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAC5F,GAAI,GAAM,iCAAkC,EAAG,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,iCAAkC,EAAG,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,iCAAkC,EAAG,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,gCAAiC,EAAG,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,cAAe,EAAG,MAAO,MAAO,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,OAAQ,EAAG,MAAO,MAAO,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,KAAM,KAAM,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,KAAM,KAAM,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,KAAM,KAAM,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,KAAM,KAAM,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAGj3B,GAAI,GAAM,2DAA4D,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,kCAAmC,KAAM,MAAO,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,4DAA6D,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,gDAAiD,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,wCAAyC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,6BAA8B,EAAG,KAAM,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,qCAAsC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAAO,GAAI,GAAM,wCAAyC,EAAG,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,MAS14B,OAAA,KAEiB,GAAA,QAAR,gECnDT,GAAM,GAAK,WAeV,QAfK,GAeO,EAAU,EAAc,EAAc,EAAW,EAAW,EAAoB,EAAqB,EAAc,EAAgB,EAAY,GAE1J,KAAK,EAAI,CACT,MAAK,MAAQ,CACb,MAAK,KAAO,CACZ,MAAK,EAAI,CACT,MAAK,EAAI,CACT,MAAK,YAAc,CACnB,MAAK,aAAe,CACpB,MAAK,KAAO,CACZ,MAAK,OAAS,CACd,MAAK,GAAK,CACV,MAAK,IAAM,EAEb,MAAA,KAEA,GAAe,QAAN,4BC/BT,GAAM,GAAO,WAUZ,QAVK,KAEE,KAAA,QAAiB,CACjB,MAAA,IAAa,CACb,MAAA,SAAkB,CAClB,MAAA,QAAiB,CACjB,MAAA,KAAc,CACd,MAAA,OAAgB,CAChB,MAAA,OAAgB,EAKxB,MAAA,KAEA,GAAiB,QAAR,4BCfT,GAAO,GAAW,EAAc,uCAEhC,IAAM,GAAK,WAOV,QAPK,KAEE,KAAA,KAAmB,GAAI,EACvB,MAAA,OAAgB,CAChB,MAAA,EAAgB,GAAI,EACpB,MAAA,EAAgB,GAAI,GAK5B,MAAA,KAEA,GAAe,QAAN,sECZT,GAAO,GAAS,EAAc,+CAC9B,IAAO,GAAI,EAAgB,0CAC3B,IAAO,GAAM,EAAe,4CAC5B,IAAO,GAAU,EAAc,gDAG/B,IAAM,GAAiB,WAKtB,QALK,KAOJ,KAAK,IACL,MAAK,IAAM,GAAI,GAGT,EAAA,UAAA,SAAP,SAAgB,EAAe,EAAiB,GAAjB,GAAA,QAAA,GAAe,CAAf,EAAA,KAAiB,GAAA,QAAA,GAAkB,CAAlB,EAAA,KAE/C,IAAK,EAAa,CACjB,EAAc,EAGf,GAAI,EAAU,CACb,KAAK,UAAU,EAAU,GAG1B,GAAI,GAAQ,EAAO,QAAQ,eAAgB,MAAM,MAAM,KAEvD,KAAK,GAAI,KAAK,GAAO,CACpB,KAAK,YAAY,EAAM,GAAI,GAG5B,MAAO,MAAK,EAGL,GAAA,UAAA,YAAR,SAAoB,EAAM,GAEzB,GAAI,GAAsB,EAAK,OAAO,KACtC,IAAI,IAAiB,EAAG,CACvB,EAAO,EAAK,MAAM,EAAG,GAEtB,EAAO,EAAK,QAAQ,aAAc,GAClC,MAAM,EAAK,OAAS,GAAK,CACxB,OAED,GAAI,GAAe,EAAK,OAAO,QAC/B,IAAI,GAAgB,IACpB,IAAI,IAAU,EAAG,CAChB,EAAO,EAAK,MAAM,GAAO,MAAM,kBAC/B,GAAO,EAAK,MAAM,EAAG,MAIlB,GAAS,EAAK,MAAM,oBACxB,KAAK,GAAU,EAAO,OAAS,EAAG,CACjC,GAAI,EAAK,QAAU,EAAG,CACrB,QAAQ,IAAI,qBAAuB,EAAS,KAAO,GAEpD,OAID,OAAQ,EAAO,IACd,IAAK,OACJ,KAAK,UAAU,EAAO,GAAI,OAAO,EAAO,IACxC,MACD,KAAK,UACJ,IAAK,KAAK,IAAK,CACd,KAAM,qBAEP,KAAK,IAAI,KAAK,SAAW,CACzB,MAAK,IAAM,IACX,OACD,SACC,IAAK,KAAK,IAAK,CACd,QAAQ,IAAI,qBAAuB,EAAS,KAAO,EAAO,oCAC1D,QAED,GAAI,KAAK,IAAI,MAAQ,UAAW,CAC/B,OAED,GAAI,GAAqB,EAAU,IAAI,EAAO,GAC9C,KAAK,EAAI,CACR,KAAM,cAAgB,EAAO,GAAK,IAAM,EAAS,KAAO,EAIzD,KAAK,WAAW,KAAK,IAAK,EAAG,OAC7B,IAAI,GAAY,CAChB,IAAI,EAAG,MAAQ,EAAG,MAAQ,OAAQ,CACjC,IAAK,KAAK,SAAS,KAAK,IAAK,EAAO,KAAO,EAAG,MAAO,CACpD,KAAM,4BAA8B,EAAO,EAAK,GAAK,IAAM,EAAS,KAAO,OAEtE,CACN,KAAK,cAAc,KAAK,KAGzB,GAAI,EAAG,GAAK,EAAG,EAAE,QAAU,OAAQ,CAClC,IAAK,KAAK,WAAW,KAAK,IAAK,EAAO,KAAO,EAAG,GAAI,KAAM,uBAAyB,EAAO,EAAK,GAAK,IAAM,EAAS,KAAO,MACpH,CACN,KAAK,cAAc,KAAK,KAGzB,GAAI,EAAG,GAAK,EAAG,EAAE,QAAU,OAAQ,CAClC,GAAI,EAAG,EAAE,QAAU,UAAW,CAC7B,IAAK,KAAK,YAAY,KAAK,IAAK,EAAO,KAAO,EAAG,EAAG,GAAO,CAC1D,KAAM,wBAA0B,EAAO,EAAK,GAAK,IAAM,EAAS,KAAO,OAElE,CACN,IAAK,KAAK,WAAW,KAAK,IAAK,EAAO,KAAO,EAAG,GAAI,CACnD,KAAM,uBAAyB,EAAO,EAAK,GAAK,IAAM,EAAS,KAAO,QAGlE,CACN,KAAK,cAAc,KAAK,KAEzB,OAII,GAAA,UAAA,WAAP,SAAkB,GAEjB,EAAG,KAAK,kBAAkB,IAC1B,GAAG,KAAK,iBAAiB,EAAG,QAC5B,IAAI,EAAG,SAAW,GAAM,CACvB,EAAG,KAAK,kBAAkB,GAE3B,EAAG,KAAK,kBAAkB,IAC1B,QAAQ,EAAG,MACV,IAAK,WACJ,EAAG,KAAK,kBAAkB,EAC1B,MACD,KAAK,SACJ,EAAG,KAAK,kBAAkB,EAC1B,MACD,KAAK,MACJ,EAAG,KAAK,kBAAkB,EAC1B,MACD,SACC,EAAG,KAAK,kBAAkB,IAC1B,QAII,GAAA,UAAA,WAAP,SAAkB,EAAS,GAE1B,EAAG,KAAK,iBAAiB,GAInB,GAAA,UAAA,cAAP,SAAqB,GAEpB,EAAG,KAAK,iBAAiB,GAGnB,GAAA,UAAA,cAAP,SAAqB,GAEpB,EAAG,KAAK,iBAAiB,EACzB,GAAG,KAAK,iBAAiB,GAGnB,GAAA,UAAA,SAAP,SAAgB,EAAI,EAAO,MAItB,GAAM,EAAM,MAAM,4CAKtB,KAAK,EAAO,IAAI,EAAI,IAAK,MAAO,MAChC,IAAI,IAAO,IAAI,EAAI,GAAI,EAAI,GAAK,EAAG,KAAK,EAAO,IAAI,EAAI,IAAI,KAAM,KAAK,KAAK,aAAa,EAAI,IAC5F,GAAG,KAAK,mBAAmB,EAAG,IAC9B,GAAG,KAAK,kBAAkB,EAAG,KAC7B,GAAG,KAAK,kBAAkB,EAAG,KAE7B,OAAO,MAGD,GAAA,UAAA,aAAP,SAAoB,GAEnB,IAAK,EAAG,MAAO,GACf,IAAI,GAAI,CACR,IAAI,EAAE,QAAQ,OAAS,EAAG,GAAK,CAC/B,IAAI,EAAE,QAAQ,OAAS,EAAG,GAAK,CAC/B,IAAI,EAAE,QAAQ,OAAS,EAAG,GAAK,CAC/B,IAAI,EAAE,QAAQ,OAAS,EAAG,GAAK,CAC/B,OAAO,GAGD,GAAA,UAAA,gBAAP,SAAuB,GAEtB,IAAK,EAAG,CACP,MAAO,KAER,GAAI,IAAgB,EAAE,EAAG,EAAE,EAAG,EAAE,EAAG,EAAE,EACrC,IAAI,GAAK,CAET,IAAI,EAAE,OAAO,IAAM,IAAK,CACvB,KAAM,wBAGP,GAAI,EAAE,OAAS,EAAG,CACjB,GAAM,EAAY,EAAE,OAAO,IAG5B,GAAI,EAAE,OAAS,EAAG,CACjB,GAAM,EAAY,EAAE,OAAO,KAAO,MAC5B,CACN,IAAO,EAAK,IAAM,EAGnB,GAAI,EAAE,OAAS,EAAG,CACjB,GAAM,EAAY,EAAE,OAAO,KAAO,MAC5B,CACN,IAAO,EAAM,GAAK,IAAO,EAG1B,GAAI,EAAE,OAAS,EAAG,CACjB,GAAM,EAAY,EAAE,OAAO,KAAO,MAC5B,CACN,IAAO,EAAM,GAAK,IAAO;CAG1B,MAAO,GAGD,GAAA,UAAA,YAAP,SAAmB,EAAS,EAAO,EAAO,GAEzC,GAAI,GAAe,EAAM,MAAM,WAC/B,KAAK,IAAQ,EAAI,GAAI,CACpB,MAAO,OAER,EAAG,KAAK,mBAAmB,SAAS,EAAI,IACxC,GAAG,KAAK,kBAAkB,EAC1B,GAAG,KAAK,kBAAkB,MAOtB,GAAqB,CACzB,IAAI,GAAuB,CAC3B,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,OAAQ,IAAK,CAC5C,GAAI,GAAsB,EAAW,IAAK,EAAK,GAAG,cAIlD,IAAI,EAAG,CACN,IAAM,GAAiB,EAAE,MAAS,EAAE,OAAS,EAAG,CAC/C,QAAQ,IAAI,qCAEb,GAAiB,EAAE,MAAQ,EAAE,KAC7B,MAAiB,EAAE,MAAQ,EAAE,MAC7B,IAAe,EAAE,OAAS,EAAE,UACtB,CACN,QAAQ,IAAI,oCAAqC,EAAK,KAIxD,EAAG,KAAK,iBAAiB,EACzB,OAAO,MAGD,GAAA,UAAA,WAAP,SAAkB,EAAI,EAAO,GAE5B,GAAI,GAAU,EAAM,MAAM,8DAC1B,IAAI,EACJ,IAAI,EAAS,CACZ,IAAK,EAAO,IAAI,EAAQ,IAAK,CAC5B,MAAO,OAER,GAAI,IAAa,EAAE,EAAG,EAAE,EAAG,EAAE,EAAG,EAAE,EAClC,IAAI,IAAW,IAAI,EAAQ,GAAK,EAAG,KAAK,EAAO,IAAI,EAAQ,IAAI,KAAM,QAAQ,KAAK,gBAAgB,EAAQ,IAAK,OAAO,EAAS,EAAQ,IAAK,OAAO,EAAQ,GAAK,EAChK,GAAG,KAAK,mBAAmB,EAAG,IAC9B,GAAG,KAAK,UAAU,EAAG,OACrB,GAAG,KAAK,kBAAkB,EAAG,QAC7B,GAAG,KAAK,kBAAkB,EAC1B,GAAG,KAAK,kBAAkB,EAAG,KAC7B,GAAG,KAAK,kBAAkB,EAAG,OAC7B,GAAG,KAAK,kBAAkB,GAAK,OACzB,CACN,EAAM,EAAM,MAAM,4CAClB,KAAK,EAAO,IAAI,EAAI,IAAK,CACxB,MAAO,OAER,GAAI,IAAW,IAAI,EAAI,GAAK,EAAG,KAAK,EAAO,IAAI,EAAI,IAAI,KAAM,QAAQ,KAAK,gBAAgB,EAAI,IAC9F,GAAG,KAAK,mBAAmB,EAAG,IAC9B,GAAG,KAAK,kBAAkB,EAC1B,GAAG,KAAK,kBAAkB,EAAG,QAC7B,GAAG,KAAK,kBAAkB,EAAG,KAC7B,GAAG,KAAK,kBAAkB,EAC1B,GAAG,KAAK,kBAAkB,EAC1B,GAAG,KAAK,kBAAkB,GAG3B,MAAO,MAGD,GAAA,UAAA,UAAP,SAAiB,EAAU,GAE1B,IAAK,EAAS,CACb,EAAU,EAEX,GAAI,KAAK,EAAE,IAAa,UAAW,CAClC,KAAK,EAAE,GAAY,GAAI,GAAK,EAAU,EACtC,MAAK,WAAW,KAAK,EAAG,QAClB,IAAI,KAAK,EAAE,GAAU,SAAW,EAAS,CAC/C,KAAM,8BAAgC,EAEvC,KAAK,IAAM,KAAK,EAAE,GAEpB,OAAA,KAEA,GAA2B,QAAlB,gOC9TT,GAAM,GAAE,WAAR,QAAM,MAIN,MAAA,KAEA,GAAY,QAAH,4BCNT,GAAM,GAAK,WAAX,QAAM,MAMN,MAAA,KAEA,GAAe,QAAN,4BCRT,GAAO,GAAK,EAAc,2CAC1B,IAAO,GAAE,EAAe,4CAKlB,GAAM,WAQX,QARK,GAQO,EAAa,EAAgB,EAAc,EAAgB,EAAc,EAAe,EAAgB,EAAoB,EAAkB,GAEzJ,KAAK,EAAI,GAAI,EACb,MAAK,EAAI,GAAI,EACb,MAAK,MAAQ,GAAI,EAEjB,MAAK,KAAO,CACZ,MAAK,EAAE,OAAS,CAChB,MAAK,EAAE,KAAO,CACd,MAAK,EAAE,OAAS,CAChB,MAAK,EAAE,KAAO,CACd,MAAK,OAAS,CACd,MAAK,MAAM,OAAS,CACpB,MAAK,MAAM,WAAa,CACxB,MAAK,MAAM,SAAW,CACtB,MAAK,MAAM,OAAS,EAEtB,MAAA,KAEA,GAAgB,QAAP,sHCjCT,GAAO,GAAM,EAAe,4CAE5B,IAAM,GAAS,WAmGd,QAnGK,MA+CL,OAAA,eAAkB,EAAA,WAAlB,WAGC,IAAK,EAAU,KAAM,CAEpB,EAAU,KAAO,GAAI,MACrB,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,EAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,EAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,EAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,EAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,EAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAE7F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,UAAW,EAAG,GAAM,KAAM,KAAM,KAAM,KAChG,GAAU,KAAK,OAAS,GAAI,GAAO,OAAQ,SAAU,EAAG,OAAQ,EAAG,GAAM,KAAM,KAAM,KAAM,KAC3F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,UAAW,EAAG,GAAM,KAAM,KAAM,KAAM,KAEhG,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAE/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,KAC/F,GAAU,KAAK,OAAS,GAAI,GAAO,SAAU,SAAU,EAAG,SAAU,EAAG,GAAM,KAAM,KAAM,KAAM,MAKhG,MAAO,GAAU,yCAQnB,OAAA,KAEmB,GAAA,QAAV,2EC1GT,GAAO,GAAS,EAAc,kCAE9B,IAAM,GAAI,WAMT,QANK,GAMO,EAAoB,GAApB,GAAA,QAAA,GAAkB,CAAlB,EAAA,KAAoB,GAAA,QAAA,GAAqB,CAArB,EAAA,KAJzB,KAAA,KAAc,EACd,MAAA,QAAiB,CAKvB,MAAK,KAAO,CACZ,MAAK,QAAU,CACf,MAAK,KAAO,GAAI,GAElB,MAAA,KAEc,GAAA,QAAL,iECfT,GAAM,GAAG,WAMR,QANK,GAMO,EAAa,GAExB,KAAK,KAAO,CACZ,MAAK,KAAO,EAEd,MAAA,KAEA,IAAM,GAAM,WAiEX,QAjEK,MAqBL,OAAA,eAAkB,EAAA,WAAlB,WAGC,IAAK,EAAO,KAAM,CAEjB,EAAO,KAAO,GAAI,MAClB,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,mBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,oBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,kBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,qBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,mBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,gBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,gBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,wBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,kBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,kBAClC,GAAO,KAAK,KAAO,GAAI,GAAI,EAAM,UACjC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,iBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,gBAClC,GAAO,KAAK,MAAQ,GAAI,GAAI,EAAM,WAKnC,MAAO,GAAO,yCAuBhB,OAAA,KAEA,GAAgB,QAAP,4BCpFT,GAAM,GAAO,WAMZ,QANK,GAMO,EAAc,EAAa,GAEtC,KAAK,MAAQ,CACb,MAAK,KAAO,CACZ,MAAK,MAAQ,EAEf,MAAA,KAEiB,GAAA,QAAR,4BCdT,GAAO,GAAO,EAAc,6CAE5B,IAAM,GAAU,WAmHf,QAnHK,MAKL,OAAA,eAAkB,EAAA,WAAlB,WAGC,IAAK,EAAW,KAAM,CAErB,EAAW,KAAO,GAAI,MACtB,GAAW,KAAK,QAAU,GAAI,GAAQ,EAAG,GAAK,EAC9C,GAAW,KAAK,MAAQ,GAAI,GAAQ,EAAG,GAAK,EAC5C,GAAW,KAAK,KAAO,GAAI,GAAQ,EAAG,GAAK,EAC3C,GAAW,KAAK,cAAgB,GAAI,GAAQ,EAAG,GAAK,EACpD,GAAW,KAAK,oBAAsB,GAAI,GAAQ,EAAG,GAAK,EAC1D,GAAW,KAAK,QAAU,GAAI,GAAQ,EAAG,GAAK,EAC9C,GAAW,KAAK,QAAU,GAAI,GAAQ,EAAG,GAAK,EAG9C,GAAW,KAAK,MAAQ,GAAI,GAAQ,GAAI,GAAK,EAC7C,GAAW,KAAK,QAAU,GAAI,GAAQ,GAAI,GAAK,EAC/C,GAAW,KAAK,MAAQ,GAAI,GAAQ,GAAI,GAAK,EAG7C,GAAW,KAAK,YAAc,GAAI,GAAQ,GAAI,EAAG,EACjD,GAAW,KAAK,iBAAmB,GAAI,GAAQ,GAAI,EAAG,EAGtD,GAAW,KAAK,SAAW,GAAI,GAAQ,GAAI,GAAK,EAChD,GAAW,KAAK,UAAY,GAAI,GAAQ,GAAI,GAAK,EACjD,GAAW,KAAK,QAAU,GAAI,GAAQ,GAAI,GAAK,EAG/C,GAAW,KAAK,SAAW,GAAI,GAAQ,GAAI,GAAK,EAChD,GAAW,KAAK,WAAa,GAAI,GAAQ,GAAI,GAAK,EAClD,GAAW,KAAK,cAAgB,GAAI,GAAQ,GAAI,GAAK,EACrD,GAAW,KAAK,aAAe,GAAI,GAAQ,GAAI,GAAK,EAGpD,GAAW,KAAK,WAAa,GAAI,GAAQ,GAAI,GAAK,EAClD,GAAW,KAAK,UAAY,GAAI,GAAQ,GAAI,GAAK,GAIlD,MAAO,GAAW,yCAyEpB,OAAA,KAEoB,GAAA,QAAX,4ECvHT,GAAO,GAAmB,EAAa,6CAEvC,IAAO,GAAa,EAAc,yCAalC,IAAO,GAAe,EAAc,0CAEpC,IAAO,GAAe,EAAc,0CAEpC,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAsB,EAAY,qDAgBnC,GAAa,WA0BlB,QA1BK,GA0BO,GAxBJ,KAAA,aAAkC,GAAI,MAatC,MAAA,aAAsB,CACtB,MAAA,WAAoB,CAEpB,MAAA,cAAiC,IACjC,MAAA,uBAAgC,CASvC,MAAK,YAAc,CACnB,MAAK,aAAe,GAAI,GAAgB,KACxC,MAAK,iBAAmB,GAAI,GAAgB,MAT7C,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gDAUN,GAAA,UAAA,eAAP,SAAsB,GAErB,MAAO,MAAK,iBAAiB,QAAQ,GAG/B,GAAA,UAAA,gBAAP,SAAuB,EAAyB,EAAuC,GAAvC,GAAA,QAAA,GAAqC,CAArC,EAAA,MAAuC,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAEtF,GAAI,KAAK,gBAAkB,GAAU,GAAmB,KAAK,wBAA0B,KAAK,wBAA0B,EACrH,MAED,MAAK,cAAgB,CACrB,MAAK,uBAAyB,CAC9B,MAAK,uBAAyB,CAC9B,IAAI,YAAkB,GAAe,CACpC,KAAK,mBAAmB,KAAK,iBAAiC,GAAS,EAAuB,KAAK,WAAY,OACzG,CACN,KAAK,uBACL,MAAK,oBAAoB,KAAK,OAAQ,KAAK,QAAS,KAAK,WAAY,KAAK,yBAIrE,GAAA,UAAA,iBAAP,SAAwB,GAEvB,GAAI,GAA0B,KAAK,aAAa,QAAQ,EAExD,KAAK,EAAY,QAChB,EAAY,QAAU,KAAK,cAAc,EAAa,MAAO,EAAa,OAAQ,EAAuB,KAAM,KAEhH,OAAO,GAAY,QAYb,GAAA,UAAA,eAAP,SAAsB,EAAc,EAAmB,EAAe,GAErE,IAAK,EAAO,SAAS,KAAK,aACzB,EAAO,SAAS,KAAK,aAAe,IAErC,KAAK,EAAO,QAAQ,KAAK,aAAc,CACtC,EAAO,QAAQ,KAAK,aAAe,KAAK,mBAAmB,EAAO,KAAK,OAAO,EAAO,cAAe,EAAO,cAC3G,GAAO,QAAQ,KAAK,aAAe,KAGpC,GAAI,EAAO,QAAQ,KAAK,aAAc,CACrC,EAAO,QAAQ,KAAK,aAAa,gBAAgB,EAAO,KAAM,EAAG,EAAO,KAAK,OAAO,EAAO,cAC3F,GAAO,QAAQ,KAAK,aAAe,MAGpC,KAAK,kBAAkB,EAAO,EAAO,QAAQ,KAAK,aAAc,EAAQ,GAGlE,GAAA,UAAA,kBAAP,SAAyB,GAExB,EAAO,QAAQ,KAAK,aAAa,SACjC,GAAO,QAAQ,KAAK,aAAe,KAG7B,GAAA,UAAA,sBAAP,SAA6B,EAAc,GAE1C,KAAK,aAAa,EAAO,KAAK,iBAAiB,IAGzC,GAAA,UAAA,gBAAP,SAAuB,EAAc,GAEpC,GAAI,GAAwC,KAAK,aAAa,QAAQ,EAEtE,KAAK,EAAY,QAAS,CACzB,EAAY,QAAU,KAAK,cAAc,EAAa,MAAO,EAAa,OAAQ,EAAuB,KAAM,KAC/G,GAAY,QAAU,KAGvB,GAAI,EAAY,QAAS,CACxB,EAAY,QAAU,KACtB,IAAI,EAAa,gBAAiB,CACjC,GAAI,GAA+B,EAAa,iBAChD,IAAI,GAAa,EAAW,MAC5B,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IACnB,EAAY,QAAS,eAAe,EAAW,GAAI,OAC1D,CACM,EAAY,QAAS,eAAe,EAAa,mBAAoB,IAInF,KAAK,aAAa,EAAO,EAAY,SAG/B,GAAA,UAAA,oBAAP,SAA2B,EAAc,GAExC,GAAI,GAAwC,KAAK,aAAa,QAAQ,EAEtE,KAAK,EAAY,QAAS,CACzB,EAAY,QAAU,KAAK,kBAAkB,EAAa,KAAM,EAAuB,KAAM,MAC7F,GAAY,QAAU,KAGvB,GAAI,EAAY,QAAS,CACxB,EAAY,QAAU,KACtB,KAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,EAAa,gBAAiB,CACjC,GAAI,GAA+B,EAAa,gBAAgB,EAChE,IAAI,GAAa,EAAW,MAC5B,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IACf,EAAY,QAAS,eAAe,EAAW,GAAI,EAAG,OACjE,CACU,EAAY,QAAS,eAAe,EAAa,iBAAiB,GAAI,EAAG,KAK5F,KAAK,aAAa,EAAO,EAAY,SAQ/B,GAAA,UAAA,eAAP,SAAsB,GAErB,IAAK,EAAO,SAAS,KAAK,aACzB,EAAO,SAAS,KAAK,aAAe,IAErC,KAAK,EAAO,QAAQ,KAAK,aAAc,CACtC,EAAO,QAAQ,KAAK,aAAe,KAAK,kBAAkB,EAAO,KAAK,OACtE,GAAO,QAAQ,KAAK,aAAe,KAGpC,GAAI,EAAO,QAAQ,KAAK,aAAc,CACrC,EAAO,QAAQ,KAAK,aAAa,gBAAgB,EAAO,KAAM,EAAG,EAAO,KAAK,OAC7E,GAAO,QAAQ,KAAK,aAAe,MAGpC,MAAO,GAAO,QAAQ,KAAK,aAGrB,GAAA,UAAA,iBAAP,SAAwB,GAEvB,EAAO,QAAQ,KAAK,aAAa,SACjC,GAAO,QAAQ,KAAK,aAAe,KAG7B,GAAA,UAAA,MAAP,SAAa,EAAgB,EAAkB,EAAiB,EAAkB,EAAkB,EAAoB,GAA3G,GAAA,QAAA,GAAc,CAAd,EAAA,EAAgB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAe,CAAf,EAAA,EAAiB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAkB,CAAlB,EAAA,EAAoB,GAAA,QAAA,GAAoC,CAApC,EAAc,EAAmB,KAKlJ,GAAA,UAAA,oBAAP,SAA2B,EAAc,EAAe,EAAkB,GAAA,GAAA,QAAA,GAAoC,CAApC,EAAA,KAEzE,KAAK,OAAS,CACd,MAAK,QAAU,EAGT,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAM,IAAI,GAGJ,GAAA,UAAA,mBAAP,SAA0B,EAAoB,GAE7C,KAAM,IAAI,GAGJ,GAAA,UAAA,cAAP,SAAqB,EAAc,EAAe,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAEpG,KAAM,IAAI,GAGJ,GAAA,UAAA,kBAAP,SAAyB,EAAa,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAExF,KAAM,IAAI,GAGJ,GAAA,UAAA,cAAP,WAEC,KAAM,IAAI,GAGJ,GAAA,UAAA,QAAP,YAKO,GAAA,UAAA,QAAP,YAKO,GAAA,UAAA,mBAAP,SAA0B,EAAqB,EAAuC,EAAsB,GAA7D,GAAA,QAAA,GAAqC,CAArC,EAAA,MAAuC,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAA0B,CAA1B,EAAA,GAKrG,GAAA,UAAA,sBAAP,YAKO,GAAA,UAAA,oBAAP,SAA2B,IAKpB,GAAA,UAAA,aAAP,SAAoB,EAAgB,IAK7B,GAAA,UAAA,kBAAP,SAAyB,EAAc,EAAsB,EAAyB,GAAzB,GAAA,QAAA,GAAuB,CAAvB,EAAA,EAAyB,GAAA,QAAA,GAAoB,CAApB,EAAA,MAK/E,GAAA,UAAA,WAAP,SAAkB,IAKX,GAAA,UAAA,gBAAP,SAAuB,GAEtB,GAAI,GAAW,CACf,OAAO,KAAK,aAAa,IAAM,KAC9B,GAED,MAAK,aAAa,GAAK,CACvB,GAAY,GAAK,EAGX,GAAA,UAAA,kBAAP,SAAyB,GAExB,KAAK,aAAa,EAAY,IAAM,IACpC,GAAY,IAAM,EAEpB,OAAA,KAEuB,GAAA,QAAd,2TCzTT,GAAM,GAAoB,WAA1B,QAAM,MAES,EAAA,kBAA2B,kBAC3B,GAAA,kBAA2B,kBAC3B,GAAA,IAAa,KACb,GAAA,4BAAqC,0BACrC,GAAA,4BAAqC,0BACrC,GAAA,uBAAgC,qBAChC,GAAA,uBAAgC,qBAChC,GAAA,aAAsB,aACtB,GAAA,aAAsB,aACtB,GAAA,KAAc,MAC7B,OAAA,KAE8B,GAAA,QAArB,4BCdT,GAAM,GAAkB,WAAxB,QAAM,MAEE,EAAA,MAAe,CACf,GAAA,MAAe,CACf,GAAA,QAAiB,CACjB,GAAA,IAAa,EAAmB,MAAQ,EAAmB,MAAQ,EAAmB,OAC9F,OAAA,KAEA,GAA4B,QAAnB,4BCRT,GAAM,GAAoB,WAA1B,QAAM,MAES,EAAA,OAAgB,QAChB,GAAA,MAAe,OACf,GAAA,QAAiB,SACjB,GAAA,cAAuB,cACvB,GAAA,KAAc,MACd,GAAA,WAAoB,WACpB,GAAA,MAAe,OACf,GAAA,UAAmB,UAClC,OAAA,KAEA,GAA8B,QAArB,4BCZT,GAAM,GAAkB,WAAxB,QAAM,MAES,EAAA,UAAmB,WACnB,GAAA,WAAoB,YACpB,GAAA,QAAiB,SAChC,OAAA,KAE4B,GAAA,QAAnB,4BCPT,GAAM,GAAgB,WAAtB,QAAM,MAES,EAAA,SAAkB,UAClB,GAAA,qBAA8B,qBAC9B,GAAA,kBAA2B,kBAC1C,OAAA,KACA,GAA0B,QAAjB,4BCNT,GAAM,GAAoB,WAA1B,QAAM,MAEE,EAAA,SAAkB,UAClB,GAAA,OAAgB,QACxB,OAAA,KAEA,GAA8B,QAArB,4BCNT,GAAM,GAAsB,WAA5B,QAAM,MAES,EAAA,OAAgB,QAChB,GAAA,QAAiB,SAChC,OAAA,KAEgC,GAAA,QAAvB,4BCNT,GAAM,GAAsB,WAA5B,QAAM,MAEE,EAAA,KAAc,MACd,GAAA,YAAqB,gBACrB,GAAA,WAAoB,cACpB,GAAA,WAAoB,YACpB,GAAA,iBAA0B,iBAClC,OAAA,KAEA,GAAgC,QAAvB,4BCTT,GAAM,GAAqB,WAA3B,QAAM,MAEE,EAAA,KAAc,MACd,GAAA,MAAe,OACf,GAAA,eAAwB,cACxB,GAAA,KAAc,MACtB,OAAA,KAE+B,GAAA,QAAtB,4BCRT,GAAM,GAA2B,WAAjC,QAAM,MAEE,EAAA,QAAiB,QACjB,GAAA,QAAiB,QACjB,GAAA,QAAiB,QACjB,GAAA,QAAiB,QACjB,GAAA,QAAiB,QACzB,OAAA,KAEA,GAAqC,QAA5B,4BCTT,GAAM,GAAiB,WAAvB,QAAM,MAES,EAAA,MAAe,OACf,GAAA,OAAgB,QAC/B,OAAA,KAEA,GAA2B,QAAlB,0LCFT,IAAO,GAAS,EAAe,+BAC/B,IAAO,GAAO,EAAgB,mCAC9B,IAAO,GAAa,EAAc,wCAClC,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAgB,EAAc,2CAErC,IAAO,GAAgB,EAAc,2CACrC,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAY,EAAe,uCAClC,IAAO,GAAY,EAAe,uCAElC,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAc,SAAA,GAAS,EAAvB,EAAc,EAmDnB,SAnDK,GAmDO,EAA6B,EAAmB,EAA4C,GAEvG,EAAA,KAAA,KAAM,EAzCC,MAAA,WAAoB,EA2C3B,MAAK,WAAa,GAAI,MAEtB,IAAI,GAAgB,YAGhB,IACH,GAAG,EAAU,GAGd,IAAI,IACH,QAAQ,OACR,QAAQ,UACR,kBAAkB,aAClB,gBAAgB,OAChB,MAAM,SAGP,MAAK,sBAAwB,KAC7B,MAAK,aAAe,SAEpB,IAAI,IACH,OAAO,KACP,GAAG,EAAU,GACb,KAAK,EAAU,QAGhB,MAAK,WAAiC,EAAU,WAChD,MAAK,WAA2B,EAAU,UAE1C,IAAI,GAAe,IACnB,GAAe,SAAS,EAAU,IAAM,IAExC,SAAS,GAAkB,GAE1B,IAAK,EAAa,QACjB,MAED,GAAa,YAAc,EAAa,GACxC,GAAa,WAAa,EAG3B,EAAU,SAAS,mCAAoC,EAAU,GAAI,OAAO,EAAU,OAAQ,OAAO,EAAU,QAAS,EAAe,GAAI,EAAW,EAAQ,EAAY,GAxE3K,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gDAGb,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,iDAGb,QAAA,eAAW,EAAA,UAAA,4BAAX,WAEC,MAAO,MAAK,2BAGb,SAAgC,GAE/B,GAAI,KAAK,uBAAyB,EACjC,MAED,MAAK,sBAAwB,CAE7B,MAAK,UAAU,OAAO,aAAa,EAAQ,oBAAqB,EAAO,EAAQ,UAAY,EAAQ,YACnG,MAAK,8CAoDC,GAAA,UAAA,cAAP,SAAqB,GAEpB,KAAK,WAAW,KAAK,GAGf,GAAA,UAAA,iBAAP,SAAwB,GAEvB,KAAK,WAAW,OAAO,KAAK,WAAW,QAAQ,IAGzC,GAAA,UAAA,cAAP,SAAqB,EAAc,EAAe,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAGpG,MAAO,IAAI,GAAa,KAAM,EAAO,EAAQ,EAAQ,GAG/C,GAAA,UAAA,kBAAP,SAAyB,EAAa,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAGxF,MAAO,IAAI,GAAiB,KAAM,EAAM,EAAQ,GAI1C,GAAA,UAAA,aAAP,SAAoB,EAAgB,GAEnC,GAAI,EAAS,CACZ,KAAK,UAAU,OAAO,aAAa,EAAQ,cAAgB,EAAU,IAAM,EAAQ,GAAK,SAClF,CACN,KAAK,UAAU,OAAO,aAAa,EAAQ,gBAAkB,EAAQ,WAAa,KAGnF,GAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,kBAAP,SAAyB,EAAgB,EAAa,EAAe,IAK9D,GAAA,UAAA,kBAAP,SAAyB,EAAsC,EAA+B,EAAkC,EAAmC,GAA1I,GAAA,QAAA,GAAoC,CAApC,EAAA,eAAsC,GAAA,QAAA,GAA6B,CAA7B,EAAA,SAA+B,GAAA,QAAA,GAAgC,CAAhC,EAAA,OAAkC,GAAA,QAAA,GAAiC,CAAjC,EAAA,OAAmC,GAAA,QAAA,GAA4C,CAA5C,EAAA,OAElK,KAAK,UAAU,OAAO,aAAa,EAAQ,mBAAqB,EAAe,IAAM,EAAc,IAAM,EAAmB,IAAM,EAAoB,IAAM,EAA+B,IAE3L,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,yBAAP,SAAgC,EAAuB,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,IAAuB,GAAA,QAAA,GAAsB,CAAtB,EAAA,IAE7E,KAAK,UAAU,OAAO,aAAa,EAAQ,yBAA0B,EAAiB,EAAQ,QAAS,EAAW,EAAQ,QAAS,EAAY,EAAQ,SAEvJ,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,WAAP,SAAkB,EAA2B,GAAA,GAAA,QAAA,GAAsC,CAAtC,EAAA,aAG5C,KAAK,UAAU,OAAO,aAAa,EAAQ,YAAc,EAAqB,IAE9E,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,cAAP,SAAqB,EAA8B,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,EAAuB,GAAA,QAAA,GAAwB,CAAxB,GAAuB,EAEhG,EAAa,GAAc,CAC3B,KAAK,GAAgB,EAAe,EACnC,EAAe,EAAY,WAAW,CAEvC,MAAK,UAAU,OAAO,aAAa,EAAQ,cAAe,EAAY,GAAK,EAAQ,SAAW,EAAa,IAAM,EAAe,IAEhI,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,8BAAP,SAAqC,EAAoB,EAAsB,EAAiB,GAAA,GAAA,QAAA,GAAgC,CAAhC,EAAA,SAK3F,GAAa,EAAO,OACxB,IAAI,EAAkB,CACrB,KAAK,6BAA6B,EAAa,GAAiB,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,KAAO,EAC3F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,KAAO,EAC/F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,EAChG,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,OAC1F,CACN,KAAK,6BAA6B,EAAa,GAAiB,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,IAAM,EAC1F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,IAAM,EAC9F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,EAChG,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,IAAK,EAAE,IAAK,EAAE,IAAK,EAAE,KAAO,IAI7F,GAAA,UAAA,6BAAP,SAAoC,EAAoB,EAAsB,EAAe,GAAA,GAAA,QAAA,GAAwB,CAAxB,GAAuB,EAEnH,GAAI,EACJ,IAAI,GAAiB,GAAe,EAAqB,OAAS,EAAQ,UAAY,EAAQ,UAC9F,KAAK,GAAI,GAAW,EAAG,EAAI,EAAc,IAAK,CAC7C,EAAa,EAAE,CACf,MAAK,UAAU,OAAO,aAAa,EAAQ,mBAAoB,EAAS,EAAgB,EAAK,EAAQ,SAAW,EAAK,GAAc,IAAM,EAAK,EAAa,GAAK,IAAM,EAAK,EAAa,GAAK,IAAM,EAAK,EAAa,GAAK,IAE1N,IAAI,EAAe,MAClB,KAAK,WAID,GAAA,UAAA,WAAP,SAAkB,GAEjB,KAAK,UAAU,OAAO,aAAa,EAAQ,WAAY,EAAQ,GAAK,EAAQ,SAE5E,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,QAAP,WAEC,KAAK,UAAU,OAAO,aAAa,EAAQ,SAC3C,MAAK,UAGC,GAAA,UAAA,MAAP,SAAa,EAAgB,EAAkB,EAAiB,EAAkB,EAAkB,EAAoB,GAA3G,GAAA,QAAA,GAAc,CAAd,EAAA,EAAgB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAe,CAAf,EAAA,EAAiB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAkB,CAAlB,EAAA,EAAoB,GAAA,QAAA,GAAoC,CAApC,EAAc,EAAmB,IAExJ,KAAK,UAAU,OAAO,aAAa,EAAQ,OAAS,EAAM,IAAM,EAAQ,IAAM,EAAO,IAAM,EAAQ,IAAM,EAAQ,IAAM,EAAU,IAAM,EAAO,IAE9I,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,cAAP,WAEC,MAAO,IAAI,GAAa,MAGlB,GAAA,UAAA,mBAAP,SAA0B,EAAoB,GAE7C,MAAO,IAAI,GAAkB,KAAM,EAAa,GAG1C,GAAA,UAAA,kBAAP,SAAyB,GAExB,MAAO,IAAI,GAAiB,KAAM,GAG5B,GAAA,UAAA,oBAAP,SAA2B,EAAc,EAAe,EAAkB,GAAA,GAAA,QAAA,GAAoC,CAApC,EAAA,KAEzE,EAAA,UAAM,oBAAmB,KAAA,KAAC,EAAO,EAAQ,EAAW,EAGpD,MAAK,UAAU,OAAO,aAAa,EAAQ,qBAAuB,EAAQ,IAAM,EAAS,KAGnF,GAAA,UAAA,iBAAP,SAAwB,IAKjB,GAAA,UAAA,kBAAP,SAAyB,EAAc,EAA0B,EAAyB,GAAzB,GAAA,QAAA,GAAuB,CAAvB,EAAA,EAAyB,GAAA,QAAA,GAAoB,CAApB,EAAA,KAEzF,GAAI,EAAQ,CACX,KAAK,UAAU,OAAO,aAAa,EAAQ,kBAAmB,EAAQ,EAAQ,SAAW,EAAO,GAAK,IAAM,EAAe,IAAM,EAAS,SACnI,CACN,KAAK,UAAU,OAAO,aAAa,EAAQ,oBAAqB,EAAQ,EAAQ,UAGjF,GAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAe,EAAc,GAE7D,KAAK,UAAU,OAAO,aAAa,EAAQ,aAAc,EAAK,EAAQ,UAAY,EAAQ,WAAY,EAAO,EAAQ,UAAY,EAAQ,WAAY,EAAM,EAAQ,UAAY,EAAQ,WAAY,EAAO,EAAQ,UAAY,EAAQ,YAEtO,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,gBAAP,SAAuB,EAAqB,GAE3C,KAAK,UAAU,OAAO,aAAa,EAAQ,iBAAmB,EAAe,IAAM,EAAoB,IAEvG,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,mBAAP,SAA0B,EAA0B,EAAuC,EAAsB,GAA7D,GAAA,QAAA,GAAqC,CAArC,EAAA,MAAuC,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAEhH,GAAI,IAAW,MAAQ,IAAW,UAAW,CAC5C,KAAK,UAAU,OAAO,aAAa,EAAQ,2BACrC,CACN,KAAK,UAAU,OAAO,aAAa,EAAQ,mBAAoB,EAAuB,EAAQ,UAAY,EAAQ,YAAc,EAAO,GAAK,KAAO,GAAa,GAAK,KAGtK,GAAI,EAAe,MAClB,KAAK,UAIA,GAAA,UAAA,sBAAP,WAEC,KAAK,UAAU,OAAO,aAAa,EAAQ,sBAE3C,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,oBAAP,SAA2B,GAE1B,GAAI,EAAW,CACd,KAAK,UAAU,OAAO,aAAa,EAAQ,gBAAkB,EAAU,EAAI,IAAM,EAAU,EAAI,IAAM,EAAU,MAAQ,IAAM,EAAU,OAAS,SAC1I,CACN,KAAK,UAAU,OAAO,aAAa,EAAQ,mBAG5C,GAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,aAAP,SAAoB,EAAmB,GAEtC,KAAK,UAAU,OAAO,aAAa,EAAQ,aAAc,EAAW,EAAQ,UAAY,EAAQ,YAAc,EAAkB,IAEhI,IAAI,EAAe,MAClB,KAAK,UAGA,GAAA,UAAA,QAAP,WAEC,GAAI,KAAK,aAAe,KACvB,MAED,SAAQ,IAAI,gCAAkC,KAAK,WAAW,OAAS,cAEvE,OAAO,KAAK,WAAW,OACtB,KAAK,WAAW,GAAG,SAEpB,IAAI,KAAK,YAAa,CAErB,KAAK,UAAU,OAAO,aAAa,EAAQ,gBAC3C,MAAK,SACL,GAAU,UAAU,KAAK,WAAW,GACpC,IAAI,KAAK,YAAc,KAAK,WAAY,CACvC,KAAK,WAAW,YAAY,KAAK,WACjC,MAAK,WAAa,KAEnB,KAAK,YAAc,KAGpB,KAAK,WAAa,KAGZ,GAAA,UAAA,UAAP,SAAiB,GAEhB,KAAK,YAAc,EAGb,GAAA,UAAA,QAAP,WAEC,GAAI,EAAe,UAClB,QAAQ,IAAI,KAAK,WAElB,IAAI,GAAgB,KAAK,YAAY,gBAAgB,iFAAuF,KAAK,WAAa,iCAE9J,IAAI,OAAO,KAAY,EACtB,KAAM,oBAEP,MAAK,WAAa,EAElB,OAAO,QAAO,GA/WD,GAAA,SAAkB,GAAI,OACtB,GAAA,mBAA4B,GAC5B,GAAA,iBAA0B,EAC1B,GAAA,QAAiB,CACjB,GAAA,WAAoB,CACpB,GAAA,YAAqB,CACrB,GAAA,eAAiB,GAAI,EAWrB,GAAA,MAAgB,KAChB,GAAA,UAAoB,KA+VnC,OAAA,IAnX6B,WA0XpB,GAA8B,EAAI,GAE1C,GAAI,GAAqB,EAAe,SAAS,EACjD,IAAI,EAAI,WAAY,CACnB,EAAI,aAAe,KAEf,GAAY,OAAO,WAAW,WAEjC,OAAO,aAAa,EACpB,KACC,EAAI,WAAW,GACd,MAAO,GACR,QAAQ,IAAI,qDAAuD,EAAE,WAAa,OAEjF,IAnBL,EAAA,QAAS,6pBCrYT,IAAO,GAAS,EAAe,iCAC/B,IAAO,GAAS,EAAe,kCAE/B,IAAO,GAAa,EAAc,wCAClC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAkB,EAAa,6CACtC,IAAO,GAAoB,EAAa,+CACxC,IAAO,GAAsB,EAAY,iDACzC,IAAO,GAAqB,EAAY,gDACxC,IAAO,GAA2B,EAAW,sDAC7C,IAAO,GAAiB,EAAa,4CACrC,IAAO,GAAgB,EAAc,2CAErC,IAAO,GAAgB,EAAc,2CACrC,IAAO,GAAY,EAAe,uCAElC,IAAO,GAAY,EAAe,uCAClC,IAAO,GAAY,EAAe,uCAClC,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EAuCjB,SAvCK,GAuCO,EAA0B,GAErC,EAAA,KAAA,KAAM,EAvCC,MAAA,uBAAgC,GAAI,OACpC,MAAA,qBAA8B,GAAI,OAClC,MAAA,wBAAwC,GAAI,OAAc,EAC1D,MAAA,uBAAgC,GAAI,OACpC,MAAA,gBAAyB,GAAI,OAC7B,MAAA,kBAA2B,GAAI,OAC/B,MAAA,wBAAiC,GAAI,OACrC,MAAA,+BAAwC,GAAI,OAC5C,MAAA,iCAA0C,GAAI,OAO9C,MAAA,iBAA2C,GAAI,MAC/C,MAAA,kBAA6C,GAAI,MACjD,MAAA,aAAuC,GAAI,MAC3C,MAAA,aAAmC,GAAI,MAEvC,MAAA,eAAqC,GAAI,OAAoB,EAqBpE,MAAK,YAAc,CAEnB,KACC,KAAK,IAA8B,EAAO,WAAW,sBAAwB,mBAAmB,MAAO,MAAM,OAE7G,KAAK,KAAK,IACT,KAAK,IAA8B,EAAO,WAAW,SAAW,mBAAmB,MAAO,MAAM,QAChG,MAAO,IAIT,GAAI,KAAK,IAAK,CAGb,KAAK,uBAAuB,EAAqB,KAAO,KAAK,IAAI,GACjE,MAAK,uBAAuB,EAAqB,mBAAqB,KAAK,IAAI,SAC/E,MAAK,uBAAuB,EAAqB,mBAAqB,KAAK,IAAI,SAC/E,MAAK,uBAAuB,EAAqB,KAAO,KAAK,IAAI,GACjE,MAAK,uBAAuB,EAAqB,6BAA+B,KAAK,IAAI,mBACzF,MAAK,uBAAuB,EAAqB,6BAA+B,KAAK,IAAI,mBACzF,MAAK,uBAAuB,EAAqB,wBAA0B,KAAK,IAAI,mBACpF,MAAK,uBAAuB,EAAqB,wBAA0B,KAAK,IAAI,mBACpF,MAAK,uBAAuB,EAAqB,cAAgB,KAAK,IAAI,SAC1E,MAAK,uBAAuB,EAAqB,cAAgB,KAAK,IAAI,SAC1E,MAAK,uBAAuB,EAAqB,MAAQ,KAAK,IAAI,IAElE,MAAK,qBAAqB,EAAqB,QAAU,KAAK,IAAI,MAClE,MAAK,qBAAqB,EAAqB,OAAS,KAAK,IAAI,KACjE,MAAK,qBAAqB,EAAqB,SAAW,KAAK,IAAI,OACnE,MAAK,qBAAqB,EAAqB,eAAiB,KAAK,IAAI,MACzE,MAAK,qBAAqB,EAAqB,MAAQ,KAAK,IAAI,IAChE,MAAK,qBAAqB,EAAqB,YAAc,KAAK,IAAI,MACtE,MAAK,qBAAqB,EAAqB,OAAS,KAAK,IAAI,KACjE,MAAK,qBAAqB,EAAqB,WAAa,KAAK,IAAI,QAErE,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAC3C,MAAK,wBAAwB,GAAK,KAAK,IAAI,QAE3C,MAAK,uBAAuB,aAAe,KAAK,IAAI,UACpD,MAAK,uBAAuB,eAAiB,KAAK,IAAI,gBAEtD,MAAK,gBAAgB,EAAkB,QAAU,KAAK,IAAI,MAC1D,MAAK,gBAAgB,EAAkB,OAAS,KAAK,IAAI,aAEzD,MAAK,kBAAkB,EAAuB,QAAU,KAAK,IAAI,MACjE,MAAK,kBAAkB,EAAuB,SAAW,KAAK,IAAI,OAElE,MAAK,wBAAwB,EAAuB,QAAU,GAAI,OAClE,MAAK,wBAAwB,EAAuB,QAAQ,EAAmB,YAAc,KAAK,IAAI,qBACtG,MAAK,wBAAwB,EAAuB,QAAQ,EAAmB,WAAa,KAAK,IAAI,oBACrG,MAAK,wBAAwB,EAAuB,QAAQ,EAAmB,SAAW,KAAK,IAAI,MACnG,MAAK,wBAAwB,EAAuB,SAAW,GAAI,OACnE,MAAK,wBAAwB,EAAuB,SAAS,EAAmB,YAAc,KAAK,IAAI,sBACvG,MAAK,wBAAwB,EAAuB,SAAS,EAAmB,WAAa,KAAK,IAAI,qBACtG,MAAK,wBAAwB,EAAuB,SAAS,EAAmB,SAAW,KAAK,IAAI,OAEpG,MAAK,+BAA+B,EAAqB,QAAU,IACnE,MAAK,+BAA+B,EAAqB,UAAY,IAErE,MAAK,iCAAiC,EAA4B,SAAW,CAC7E,MAAK,iCAAiC,EAA4B,SAAW,CAC7E,MAAK,iCAAiC,EAA4B,SAAW,CAC7E,MAAK,iCAAiC,EAA4B,SAAW,CAC7E,MAAK,iCAAiC,EAA4B,SAAW,MACvE,CAEN,MAAM,2BAIP,IAAK,GAAI,GAAW,EAAG,EAAI,EAAa,eAAgB,EAAG,CAC1D,KAAK,eAAe,GAAK,GAAI,EAC7B,MAAK,eAAe,GAAG,KAAO,KAAK,IAAI,MACvC,MAAK,eAAe,GAAG,OAAS,KAAK,IAAI,MACzC,MAAK,eAAe,GAAG,UAAY,KAAK,IAAI,QAzF9C,OAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gDA2FN,GAAA,UAAA,GAAP,WAEC,MAAO,MAAK,IAGN,GAAA,UAAA,MAAP,SAAa,EAAgB,EAAkB,EAAiB,EAAkB,EAAkB,EAAoB,GAA3G,GAAA,QAAA,GAAc,CAAd,EAAA,EAAgB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAe,CAAf,EAAA,EAAiB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAgB,CAAhB,EAAA,EAAkB,GAAA,QAAA,GAAkB,CAAlB,EAAA,EAAoB,GAAA,QAAA,GAAoC,CAApC,EAAc,EAAmB,IAExJ,IAAK,KAAK,SAAU,CACnB,KAAK,mBACL,MAAK,SAAW,KAGjB,GAAI,GAAgB,CACpB,IAAI,EAAO,EAAmB,MAAO,GAAU,KAAK,IAAI,gBACxD,IAAI,EAAO,EAAmB,QAAS,GAAU,KAAK,IAAI,kBAC1D,IAAI,EAAO,EAAmB,MAAO,GAAU,KAAK,IAAI,gBAExD,MAAK,IAAI,WAAW,EAAK,EAAO,EAAM,EACtC,MAAK,IAAI,WAAW,EACpB,MAAK,IAAI,aAAa,EACtB,MAAK,IAAI,MAAM,GAGT,GAAA,UAAA,oBAAP,SAA2B,EAAc,EAAe,EAAkB,GAAA,GAAA,QAAA,GAAoC,CAApC,EAAA,KAEzE,EAAA,UAAM,oBAAmB,KAAA,KAAC,EAAO,EAAQ,EAAW,EAEpD,IAAI,EAAuB,CAC1B,KAAK,IAAI,OAAO,KAAK,IAAI,aACzB,MAAK,IAAI,OAAO,KAAK,IAAI,YAG1B,KAAK,IAAI,SAAS,SAAW,CAC7B,MAAK,IAAI,SAAS,UAAY,CAE9B,MAAK,IAAI,SAAS,EAAG,EAAG,EAAO,GAGzB,GAAA,UAAA,kBAAP,SAAyB,EAAa,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAExF,GAAI,GAA2B,GAAI,GAAiB,KAAK,IAAK,EAC9D,MAAK,aAAa,KAAK,EACvB,OAAO,GAGD,GAAA,UAAA,kBAAP,SAAyB,GAExB,GAAI,GAA+B,GAAI,GAAiB,KAAK,IAAK,EAClE,MAAK,iBAAiB,KAAK,EAC3B,OAAO,GAGD,GAAA,UAAA,cAAP,WAEC,GAAI,GAAuB,GAAI,GAAa,KAAK,IACjD,MAAK,aAAa,KAAK,EACvB,OAAO,GAGD,GAAA,UAAA,cAAP,SAAqB,EAAc,EAAe,EAAe,EAAoC,GAAA,GAAA,QAAA,GAA0B,CAA1B,EAAA,KAGhG,GAAuB,GAAI,GAAa,KAAK,IAAK,EAAO,EAC7D,MAAK,aAAa,KAAK,EACvB,OAAO,GAGD,GAAA,UAAA,mBAAP,SAA0B,EAAoB,GAE7C,GAAI,GAAiC,GAAI,GAAkB,KAAK,IAAK,EAAa,EAClF,MAAK,kBAAkB,KAAK,EAC5B,OAAO,GAGD,GAAA,UAAA,QAAP,WAEC,GAAI,EACJ,KAAK,EAAI,EAAG,EAAI,KAAK,iBAAiB,SAAU,EAC/C,KAAK,iBAAiB,GAAG,SAE1B,MAAK,iBAAmB,IAExB,KAAK,EAAI,EAAG,EAAI,KAAK,kBAAkB,SAAU,EAChD,KAAK,kBAAkB,GAAG,SAE3B,MAAK,kBAAoB,IAEzB,KAAK,EAAI,EAAG,EAAI,KAAK,aAAa,SAAU,EAC3C,KAAK,aAAa,GAAG,SAEtB,MAAK,aAAe,IAEpB,KAAK,EAAI,EAAG,EAAI,KAAK,aAAa,SAAU,EAC3C,KAAK,aAAa,GAAG,SAEtB,KAAK,EAAI,EAAG,EAAI,KAAK,eAAe,SAAU,EAC7C,KAAK,eAAe,GAAK,IAE1B,MAAK,aAAe,KAGd,GAAA,UAAA,iBAAP,SAAwB,GAEvB,GAAI,GAA0B,GAAI,aAAY,EAAY,MAAM,EAAY,OAAO,EAEnF,MAAK,IAAI,WAAW,EAAG,EAAG,EAAY,MAAO,EAAY,OAAQ,KAAK,IAAI,KAAM,KAAK,IAAI,cAAe,GAAI,YAAW,GAEvH,IAAI,GAAsB,GAAI,EAC9B,GAAU,eAAe,EAEzB,GAAY,UAAU,GAAI,GAAU,EAAG,EAAG,EAAY,MAAO,EAAY,QAAS,GAG5E,GAAA,UAAA,cAAP,SAAqB,EAA8B,EAAuB,GAAvB,GAAA,QAAA,GAAqB,CAArB,EAAA,EAAuB,GAAA,QAAA,GAAwB,CAAxB,GAAuB,EAEhG,IAAK,KAAK,SACT,KAAM,gGAEP,MAAK,IAAI,WAAW,KAAK,IAAI,qBAAsB,EAAY,SAC/D,MAAK,IAAI,aAAa,KAAK,IAAI,UAAY,IAAiB,EAAI,EAAY,WAAa,EAAa,EAAG,KAAK,IAAI,eAAgB,GAG5H,GAAA,UAAA,QAAP,WAEC,KAAK,SAAW,MAGV,GAAA,UAAA,gBAAP,SAAuB,EAAqB,GAE3C,KAAK,cAAgB,IAErB,MAAK,mBAAqB,KAAK,uBAAuB,EAEtD,MAAK,wBAA0B,KAAK,uBAAuB,EAE3D,MAAK,oBAGC,GAAA,UAAA,aAAP,SAAoB,EAAa,EAAe,EAAc,GAE7D,KAAK,IAAI,UAAU,EAAK,EAAO,EAAM,GAG/B,GAAA,UAAA,WAAP,SAAkB,EAA2B,GAAA,GAAA,QAAA,GAAsC,CAAtC,EAAA,aAE5C,GAAI,GAAsB,EAAsB,KAAM,CACrD,KAAK,IAAI,QAAQ,KAAK,IAAI,eACpB,CACN,KAAK,IAAI,OAAO,KAAK,IAAI,UACzB,QAAQ,GACP,IAAK,GAAsB,KAC1B,KAAK,IAAI,SAAU,GAAoB,aAAe,KAAK,IAAI,MAAQ,KAAK,IAAI,KAChF,MACD,KAAK,GAAsB,MAC1B,KAAK,IAAI,SAAU,GAAoB,aAAe,KAAK,IAAI,KAAO,KAAK,IAAI,MAC/E,MACD,KAAK,GAAsB,eAC1B,KAAK,IAAI,SAAS,KAAK,IAAI,eAC3B,MACD,SACC,KAAM,wCAMH,GAAA,UAAA,aAAP,SAAoB,EAAmB,GAEtC,KAAK,IAAI,UAAU,KAAK,qBAAqB,GAE7C,MAAK,IAAI,UAAU,GAGb,GAAA,UAAA,WAAP,SAAkB,GAGjB,KAAK,gBAAkB,CACvB,GAAQ,eAGF,GAAA,UAAA,8BAAP,SAAqC,EAAoB,EAAsB,EAAiB,GAAA,GAAA,QAAA,GAAgC,CAAhC,EAAA,SAK3F,GAAa,EAAO,OACxB,IAAI,EAAkB,CACrB,KAAK,6BAA6B,EAAa,GAAiB,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,KAAO,EAC3F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,KAAO,EAC/F;KAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,EAChG,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,OAC1F,CACN,KAAK,6BAA6B,EAAa,GAAiB,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,IAAM,EAC1F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,GAAI,EAAE,IAAM,EAC9F,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,GAAI,EAAE,GAAI,EAAE,IAAK,EAAE,KAAO,EAChG,MAAK,6BAA6B,EAAa,EAAgB,GAAK,EAAE,IAAK,EAAE,IAAK,EAAE,IAAK,EAAE,KAAO,IAM7F,GAAA,UAAA,6BAAP,SAAoC,EAAoB,EAAsB,EAAe,GAAA,GAAA,QAAA,GAAwB,CAAxB,GAAuB,EAEnH,GAAI,GAAsB,KAAK,+BAA+B,EAC9D,IAAI,EACJ,KAAK,GAAI,GAAW,EAAG,EAAI,EAAc,IAAK,CAC7C,EAAa,EAAE,CACf,MAAK,IAAI,UAAU,KAAK,IAAI,mBAAmB,KAAK,gBAAgB,UAAW,GAAgB,EAAgB,IAAK,EAAK,GAAa,EAAK,EAAa,GAAI,EAAK,EAAa,GAAI,EAAK,EAAa,KAI/L,GAAA,UAAA,oBAAP,SAA2B,GAE1B,IAAK,EAAW,CACf,KAAK,IAAI,QAAQ,KAAK,IAAI,aAC1B,QAGD,KAAK,IAAI,OAAO,KAAK,IAAI,aACzB,MAAK,IAAI,QAAQ,EAAU,EAAG,EAAU,EAAG,EAAU,MAAO,EAAU,QAGhE,GAAA,UAAA,aAAP,SAAoB,EAAgB,GAEnC,GAAI,GAA4B,KAAK,eAAe,EAEpD,IAAI,KAAK,gBAAkB,IAAY,GAAW,EAAa,MAAO,CACrE,KAAK,eAAiB,CACtB,MAAK,IAAI,cAAc,KAAK,wBAAwB,IAGrD,IAAK,EAAS,CACb,GAAI,EAAa,KAAM,CACtB,KAAK,IAAI,YAAY,EAAa,KAAM,KACxC,GAAa,KAAO,KAGrB,OAGD,GAAI,GAAqB,KAAK,uBAAuB,EAAQ,YAC7D,GAAa,KAAO,CAEpB,MAAK,IAAI,YAAY,EAAa,EAAQ,UAE1C,MAAK,IAAI,UAAU,KAAK,IAAI,mBAAmB,KAAK,gBAAgB,UAAW,KAAO,GAAU,EAEhG,MAAK,IAAI,cAAc,EAAa,KAAK,IAAI,eAAgB,EAAa,KAC1E,MAAK,IAAI,cAAc,EAAa,KAAK,IAAI,eAAgB,EAAa,KAE1E,MAAK,IAAI,cAAc,EAAa,KAAK,IAAI,mBAAoB,EAAa,OAC9E,MAAK,IAAI,cAAc,EAAa,KAAK,IAAI,mBAAoB,EAAa,WAGxE,GAAA,UAAA,kBAAP,SAAyB,EAAgB,EAAa,EAAe,GAEpE,GAAI,GAAK,GAAW,EAAU,EAAa,aAAc,CACxD,KAAK,eAAe,GAAS,KAAO,KAAK,gBAAgB,EACzD,MAAK,eAAe,GAAS,OAAS,KAAK,kBAAkB,EAC7D,MAAK,eAAe,GAAS,UAAY,KAAK,wBAAwB,GAAQ,OACxE,CACN,KAAM,6BAID,GAAA,UAAA,kBAAP,SAAyB,EAAc,EAA0B,EAAyB,GAAzB,GAAA,QAAA,GAAuB,CAAvB,EAAA,EAAyB,GAAA,QAAA,GAAoB,CAApB,EAAA,KAEzF,GAAI,GAAkB,KAAK,gBAAiB,KAAK,IAAI,kBAAkB,KAAK,gBAAgB,UAAW,KAAO,IAAU,CAExH,KAAK,EAAQ,CACZ,GAAI,GAAY,EACf,KAAK,IAAI,yBAAyB,EAEnC,QAGD,KAAK,IAAI,WAAW,KAAK,IAAI,aAAc,EAAO,SAClD,MAAK,IAAI,wBAAwB,EACjC,MAAK,IAAI,oBAAoB,EAAU,KAAK,iCAAiC,GAAS,KAAK,IAAI,MAAO,MAAO,EAAO,gBAAgB,EAAG,EAAa,GAG9I,GAAA,UAAA,mBAAP,SAA0B,EAAyB,EAAuC,EAAsB,GAA7D,GAAA,QAAA,GAAqC,CAArC,EAAA,MAAuC,GAAA,QAAA,GAAoB,CAApB,EAAA,EAAsB,GAAA,QAAA,GAA0B,CAA1B,EAAA,EAE/G,GAAI,GAAsC,CAC1C,IAAI,GAA+B,EAAQ,WAC3C,MAAK,IAAI,gBAAgB,KAAK,IAAI,YAAa,EAE/C,IAAI,EAAuB,CAC1B,KAAK,IAAI,OAAO,KAAK,IAAI,aACzB,MAAK,IAAI,OAAO,KAAK,IAAI,YAG1B,KAAK,IAAI,SAAS,EAAG,EAAG,EAAQ,MAAO,EAAQ,QAGzC,GAAA,UAAA,sBAAP,WAEC,KAAK,IAAI,gBAAgB,KAAK,IAAI,YAAa,MAGxC,GAAA,UAAA,kBAAR,WAEC,GAAI,KAAK,cAAe,CACvB,KAAK,IAAI,OAAO,KAAK,IAAI,MACzB,MAAK,IAAI,cAAc,KAAK,IAAI,SAChC,MAAK,IAAI,UAAU,KAAK,mBAAoB,KAAK,6BAC3C,CACN,KAAK,IAAI,QAAQ,KAAK,IAAI,QA1Zd,GAAA,aAAsB,CA8StB,GAAA,OAAgB,CA+G/B,OAAA,IArb2B,EAub3B,GAAsB,QAAb,6gCC/cT,IAAO,GAAU,EAAe,kCAEhC,IAAO,GAAa,EAAc,sCAIlC,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAUrB,SAVK,GAUO,EAAwB,EAAa,EAAe,EAAgB,GAAA,GAAA,QAAA,GAAyB,CAAzB,EAAA,MAE/E,EAAA,KAAA,KAEA,MAAK,SAAW,CAChB,MAAK,MAAQ,CAEb,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,gBAAkB,EAAQ,EAAQ,UAAY,EAAQ,YAAe,EAAO,IAAM,EAAY,IAAM,EAAS,IACjK,MAAK,KAAO,KAAK,SAAS,SAC1B,MAAK,SAAS,cAAc,MAd7B,OAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAeN,GAAA,UAAA,QAAP,WAEC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,oBAAsB,KAAK,KAAK,WAAa,IACjG,MAAK,SAAS,SACd,MAAK,SAAS,iBAAiB,KAE/B,MAAK,SAAW,KAKV,GAAA,UAAA,eAAP,SAAsB,EAAU,EAAa,GAAA,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAE5C,GAAI,YAAgB,GAAY,CAC/B,EAAqB,EAAM,UAAU,SAC/B,IAAI,YAAgB,kBAAkB,CAC5C,GAAI,GAAM,SAAS,cAAc,SACjC,IAAI,GAAI,EAAK,KACb,IAAI,GAAI,EAAK,MACb,GAAI,MAAQ,CACZ,GAAI,OAAS,CACb,IAAI,GAAM,EAAI,WAAW,KACzB,GAAI,UAAU,EAAM,EAAG,EACvB,GAAO,EAAI,aAAa,EAAG,EAAG,EAAG,GAAG,KAGrC,GAAI,GAAM,CACV,IAAI,GAAQ,EAAc,wBAAwB,EAAK,OAAQ,WAC9D,MAAO,GAAK,MACV,KAEH,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,wBAA0B,KAAK,KAAO,IAAM,EAAW,IAAM,EAAO,KAAO,KAAK,MAAQ,GAAY,IAAM,EAAQ,IACtK,MAAK,SAAS,UAGR,GAAA,UAAA,qCAAP,SAA4C,EAAgB,EAAiC,GAAA,GAAA,QAAA,GAAqB,CAArB,EAAA,OAI9F,OAAA,IA7D+B,EA+D/B,GAA0B,QAAjB,+VCxET,IAAO,GAAU,EAAe,kCAIhC,IAAO,GAAgB,EAAc,2CAErC,IAAM,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EASrB,SATK,GASO,EAA0B,GAErC,EAAA,KAAA,KAAM,EARC,MAAA,2BAA2C,GAAI,OAAc,EAE9D,MAAA,YAAqB,aAO3B,MAAK,MAAQ,CACb,MAAK,SAAW,KAAK,IAAI,eAEzB,MAAK,2BAA2B,GAAK,EAAG,2BACxC,MAAK,2BAA2B,GAAK,EAAG,2BACxC,MAAK,2BAA2B,GAAK,EAAG,2BACxC,MAAK,2BAA2B,GAAK,EAAG,2BACxC,MAAK,2BAA2B,GAAK,EAAG,2BACxC,MAAK,2BAA2B,GAAK,EAAG,4BAGlC,EAAA,UAAA,QAAP,WAEC,KAAK,IAAI,cAAc,KAAK,UAKtB,GAAA,UAAA,eAAP,SAAsB,EAAU,EAAa,GAAA,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAE5C,GAAI,YAAgB,GACnB,EAAqB,EAAM,SAE5B,MAAK,IAAI,YAAY,KAAK,IAAI,iBAAkB,KAAK,SACrD,MAAK,IAAI,WAAW,KAAK,2BAA2B,GAAO,EAAU,KAAK,IAAI,KAAM,KAAK,IAAI,KAAM,KAAK,IAAI,cAAe,EAC3H,MAAK,IAAI,YAAY,KAAK,IAAI,iBAAkB,MAG1C,GAAA,UAAA,qCAAP,SAA4C,EAAgB,EAAiC,GAAA,GAAA,QAAA,GAAqB,CAArB,EAAA,OAK7F,QAAA,eAAW,EAAA,UAAA,YAAX,WAEC,MAAO,MAAK,0CAGb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,6CAEd,OAAA,IAtD+B,EAwDL,GAAA,QAAjB,8QC5DT,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAgB,SAAA,GAAS,EAAzB,EAAgB,EAKrB,SALK,GAKO,EAAwB,GAEnC,EAAA,KAAA,KAEA,MAAK,SAAW,CAChB,MAAK,YAAc,CACnB,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,gBAAiB,EAAa,EAAQ,SAC1F,MAAK,KAAO,KAAK,SAAS,SAC1B,MAAK,SAAS,cAAc,MAGtB,EAAA,UAAA,gBAAP,SAAuB,EAAe,EAAoB,GAEzD,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,uBAAwB,KAAK,KAAO,EAAQ,SAAW,EAAK,OAAS,IAAM,EAAc,IAAM,EAAQ,IAC3J,MAAK,SAAS,UAGR,GAAA,UAAA,QAAP,WAEC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,mBAAoB,KAAK,KAAO,EAAQ,SAC5F,MAAK,SAAS,SACd,MAAK,SAAS,iBAAiB,KAE/B,MAAK,SAAW,KAGjB,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAEd,OAAA,IAnC+B,EAqC/B,GAA0B,QAAjB,iHCxCT,GAAM,GAAgB,WAOrB,QAPK,GAOO,EAA0B,GAErC,KAAK,IAAM,CACX,MAAK,QAAU,KAAK,IAAI,cACxB,MAAK,YAAc,EAGb,EAAA,UAAA,gBAAP,SAAuB,EAAe,EAAoB,GAEzD,KAAK,IAAI,WAAW,KAAK,IAAI,qBAAsB,KAAK,QAGxD,MAAK,IAAI,WAAW,KAAK,IAAI,qBAAsB,GAAI,aAAY,GAAO,KAAK,IAAI,aAG7E,GAAA,UAAA,QAAP,WAEC,KAAK,IAAI,aAAa,KAAK,SAG5B,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAGb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,4CAEd,OAAA,KAEA,GAA0B,QAAjB,4BCxCT,GAAM,GAAO,WAAb,QAAM,MAES,EAAA,UAAmB,EACnB,GAAA,WAAoB,EACpB,GAAA,QAAiB,EACjB,GAAA,cAAuB,EACvB,GAAA,mBAA4B,EAC5B,GAAA,WAAoB,EACpB,GAAA,QAAiB,EACjB,GAAA,MAAe,EACf,GAAA,YAAqB,EACrB,GAAA,iBAA0B,EAC1B,GAAA,gBAAyB,EACzB,GAAA,oBAA6B,EAC7B,GAAA,uBAAgC,EAChC,GAAA,wBAAiC,EACjC,GAAA,uBAAgC,EAChC,GAAA,kBAA2B,EAC3B,GAAA,uBAAgC,EAChC,GAAA,wBAAiC,EACjC,GAAA,aAAsB,EACtB,GAAA,aAAsB,EACtB,GAAA,eAAwB,EACxB,GAAA,eAAwB,EAExB,GAAA,oBAA6B,EAE7B,GAAA,mBAA4B,EAC5B,GAAA,YAAqB,EACrB,GAAA,aAAsB,EACtB,GAAA,mBAA4B,EAC5B,GAAA,eAAwB,EACxB,GAAA,WAAoB,EACpB,GAAA,eAAwB,EACxB,GAAA,iBAA0B,EAC1B,GAAA,gBAAyB,EACzB,GAAA,mBAA4B,EAC5B,GAAA,eAAwB,EACxB,GAAA,oBAA6B,EAC7B,GAAA,kBAA2B,EAC3B,GAAA,yBAAkC,EAClC,GAAA,gBAAyB,EACzB,GAAA,mBAA4B,EAC5B,GAAA,uBAAgC,EAChC,GAAA,qBAA8B,EAC9B,GAAA,oBAA6B,EAC5C,OAAA,KAEA,GAAiB,QAAR,0LC9CT,IAAO,GAAc,EAAc,yCAEnC,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EAIjB,SAJK,GAIO,GAEX,EAAA,KAAA,KAEA,MAAK,SAAW,CAChB,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,aACpD,MAAK,KAAO,KAAK,SAAS,SAC1B,MAAK,SAAS,cAAc,MAGtB,EAAA,UAAA,OAAP,SAAc,EAAyB,GAEtC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,uBAAwB,KAAK,KAAO,EAAQ,SAAW,EAAc,iBAAiB,EAAc,QAAU,IAAM,EAAgB,iBAAiB,EAAgB,QAAU,IAEnO,IAAI,EAAe,MAClB,KAAK,SAAS,UAGT,GAAA,UAAA,QAAP,WAEC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,eAAgB,KAAK,KAAO,EAAQ,SACxF,MAAK,SAAS,SACd,MAAK,SAAS,iBAAiB,KAE/B,MAAK,SAAW,KAElB,OAAA,IA9B2B,EAgC3B,GAAsB,QAAb,8JCrCT,GAAO,GAAa,EAAc,yCAClC,IAAO,GAAW,EAAe,uCAIjC,IAAM,GAAY,WAUjB,QAVK,GAUO,GAEX,KAAK,IAAM,CACX,MAAK,SAAW,KAAK,IAAI,gBAGnB,EAAA,UAAA,OAAP,SAAc,EAAyB,GAEtC,GAAI,GAAsB,EAAa,aAAa,MAAM,EAAa,WAAW,qBAAqB,GACvG,IAAI,GAAwB,EAAa,aAAa,MAAM,EAAa,WAAW,qBAAqB,GAEzG,MAAK,cAAgB,KAAK,IAAI,aAAa,KAAK,IAAI,cACpD,MAAK,gBAAkB,KAAK,IAAI,aAAa,KAAK,IAAI,gBAEtD,MAAK,IAAI,aAAa,KAAK,cAAe,EAC1C,MAAK,IAAI,cAAc,KAAK,cAE5B,KAAK,KAAK,IAAI,mBAAmB,KAAK,cAAe,KAAK,IAAI,gBAAiB,CAC9E,KAAM,IAAI,OAAM,KAAK,IAAI,iBAAiB,KAAK,eAC/C,QAGD,KAAK,IAAI,aAAa,KAAK,gBAAiB,EAC5C,MAAK,IAAI,cAAc,KAAK,gBAE5B,KAAK,KAAK,IAAI,mBAAmB,KAAK,gBAAiB,KAAK,IAAI,gBAAiB,CAChF,KAAM,IAAI,OAAM,KAAK,IAAI,iBAAiB,KAAK,iBAC/C,QAGD,KAAK,IAAI,aAAa,KAAK,SAAU,KAAK,cAC1C,MAAK,IAAI,aAAa,KAAK,SAAU,KAAK,gBAC1C,MAAK,IAAI,YAAY,KAAK,SAE1B,KAAK,KAAK,IAAI,oBAAoB,KAAK,SAAU,KAAK,IAAI,aAAc,CACvE,KAAM,IAAI,OAAM,KAAK,IAAI,kBAAkB,KAAK,YAI3C,GAAA,UAAA,QAAP,WAEC,KAAK,IAAI,cAAc,KAAK,UAGtB,GAAA,UAAA,aAAP,WAEC,KAAK,IAAI,WAAW,KAAK,UAG1B,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,6CA3DE,GAAA,WAA2B,GAAI,EAC/B,GAAA,aAA2B,GAAI,EA4D/C,OAAA,KAEsB,GAAA,QAAb,mHCxET,GAAM,GAAiB,WAAvB,QAAM,MAIL,OAAA,eAAW,EAAA,UAAA,UAAX,WAEC,MAAO,MAAK,yCAGN,GAAA,UAAA,QAAP,YAID,OAAA,KAEA,GAA2B,QAAlB,4BCfT,GAAM,GAAY,WAAlB,QAAM,MAMN,MAAA,KAEA,GAAsB,QAAb,0LCRT,IAAO,GAAS,EAAc,iCAC9B,IAAO,GAAK,EAAe,+BAC3B,IAAO,GAAe,EAAa,yCAInC,IAAO,GAAG,EAAgB,4BAE1B,IAAO,GAAW,EAAc,yCAChC,IAAO,GAAU,EAAc,uCAE/B,IAAO,GAAc,EAAa,yCAClC,IAAO,GAAY,EAAc,2CAY3B,GAAK,SAAA,GAAS,EAAd,EAAK,EAuCV,SAvCK,GAuCO,EAA6B,EAAmB,EAA2B,EAA+B,GAA/B,GAAA,QAAA,GAA6B,CAA7B,EAAA,MAA+B,GAAA,QAAA,GAA2B,CAA3B,EAAA,WAErH,EAAA,KAAA,KAnCO,MAAA,GAAY,CACZ,MAAA,GAAY,CAIZ,MAAA,aAAsB,CAKtB,MAAA,WAAoB,CAMpB,MAAA,cAAiC,IACjC,MAAA,uBAAgC,CAchC,MAAA,aAAuB,KAM9B,MAAK,WAAa,CAElB,MAAK,YAAc,CAEnB,MAAK,cAAgB,CAErB,MAAK,UAAY,GAAI,EAErB,MAAK,uBAAyB,IAE9B,GAAI,YAAY,KAAK,WAAY,EACjC,GAAI,YAAY,KAAK,WAAY,EAEjC,MAAK,QAAU,KAMT,EAAA,UAAA,eAAP,SAAsB,EAA+B,EAA6B,GAAlF,GAAA,GAAA,IAAsB,IAAA,QAAA,GAA6B,CAA7B,EAAA,MAA+B,GAAA,QAAA,GAA2B,CAA3B,EAAA,WAA6B,GAAA,QAAA,GAAoB,CAApB,EAAA,OAOjF,GAAI,KAAK,wBAA0B,KAClC,KAAK,uBAAyB,CAE/B,MAAK,SAAW,CAEhB,KACC,GAAI,GAAQ,EAAY,MACvB,GAAI,GAAmC,KAAK,WAAY,KAAK,YAAa,SAAC,GAA4B,MAAA,GAAK,UAAU,SAEtH,MAAK,SAAW,GAAI,GAAiC,KAAK,WAAY,KAAK,aAE3E,MAAO,GACR,IACC,GAAI,GAAQ,EAAY,KACvB,GAAI,GAAmC,KAAK,WAAY,KAAK,YAAa,SAAC,GAA4B,MAAA,GAAK,UAAU,SAEtH,MAAK,cAAc,GAAI,GAAM,EAAM,QACnC,MAAO,GACR,KAAK,cAAc,GAAI,GAAM,EAAM,SAKrC,GAAI,KAAK,SACR,KAAK,UAAU,KAAK,UAMtB,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,GAAI,KAAK,QAAU,EAClB,MAED,GAAI,gBAAgB,KAAK,WAAY,EAErC,MAAK,OAAS,KAAK,UAAU,MAAQ,CAErC,MAAK,iBAAmB,IAExB,MAAK,4DAMN,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,aAGb,SAAkB,GAEjB,GAAI,KAAK,SAAW,EACnB,MAED,GAAI,iBAAiB,KAAK,WAAY,EAEtC,MAAK,QAAU,KAAK,UAAU,OAAS,CAEvC,MAAK,iBAAmB,IAExB,MAAK,4DAMN,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,QAGb,SAAa,GAEZ,GAAI,KAAK,IAAM,EACd,MAED,GAAI,YAAY,KAAK,WAAY,EAEjC,MAAK,GAAK,KAAK,UAAU,EAAI,CAE7B,MAAK,4DAMN,QAAA,eAAW,EAAA,UAAA,SAAX,WAEC,MAAO,MAAK,QAGb,SAAa,GAEZ,GAAI,KAAK,IAAM,EACd,MAED,GAAI,YAAY,KAAK,WAAY,EAEjC,MAAK,GAAK,KAAK,UAAU,EAAI,CAE7B,MAAK,4DAGN,QAAA,eAAW,EAAA,UAAA,eAKX,WAEC,MAAO,GAAI,qBAAqB,KAAK,iBAPtC,SAAmB,GAElB,EAAI,qBAAqB,KAAK,WAAY,uCAQ3C,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,+CAMb,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,6CAGL,GAAA,UAAA,sBAAR,WAEC,GAAI,KAAK,eACR,MAED,MAAK,eAAiB,IAMtB,MAAK,iBAAmB,GAAI,GAAW,EAAW,iBAElD,MAAK,cAAc,KAAK,kBAGjB,GAAA,UAAA,iBAAR,WAKC,IAAK,KAAK,YACT,KAAK,YAAc,GAAI,GAAM,EAAM,YAEpC,MAAK,cAAc,KAAK,aAIjB,GAAA,UAAA,gBAAR,WAKC,IAAK,KAAK,WACT,KAAK,WAAa,GAAI,GAAM,EAAM,WAEnC,MAAK,cAAc,KAAK,YAGzB,QAAA,eAAW,EAAA,UAAA,eAAX,WAEC,MAAO,MAAK,6CAMN,GAAA,UAAA,QAAP,WAEC,KAAK,cAAc,aAAa,KAChC,MAAK,aACL,MAAK,cAAgB,IACrB,MAAK,aAAe,EAUd,GAAA,UAAA,oBAAP,SAA2B,EAAwB,EAAyB,EAAkB,GAE7F,KAAK,MAAQ,CACb,MAAK,OAAS,CAEd,MAAK,WAAa,CAClB,MAAK,uBAAyB,CAE9B,IAAI,KAAK,SACR,KAAK,SAAS,oBAAoB,EAAiB,EAAkB,EAAW,GAMlF,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,4BAGb,SAAiC,GAEhC,KAAK,uBAAyB,CAC9B,MAAK,iBAAmB,yCAGzB,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,MAAK,kDAGb,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,2DAMN,GAAA,UAAA,MAAP,WAEC,IAAK,KAAK,SACT,MAED,IAAI,KAAK,iBAAkB,CAC1B,KAAK,oBAAoB,KAAK,OAAQ,KAAK,QAAS,KAAK,WAAY,KAAK,uBAC1E,MAAK,iBAAmB,MAGzB,KAAK,SAAS,OAAQ,KAAK,OAAS,cAAiB,IAC5C,KAAK,OAAS,YAAe,IAC7B,KAAK,OAAS,SAAa,EAC9B,KAAK,OAAS,IAEpB,MAAK,aAAe,KAad,GAAA,UAAA,iBAAP,SAAwB,EAAa,GAEpC,EAAA,UAAM,iBAAgB,KAAA,KAAC,EAAM,GA4BvB,GAAA,UAAA,oBAAP,SAA2B,EAAa,GAEvC,EAAA,UAAM,oBAAmB,KAAA,KAAC,EAAM,GAcjC,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,KAAK,aAAe,CAEpB,MAAK,SAAS,oBAAoB,KAAK,kDAMxC,QAAA,eAAW,EAAA,UAAA,kBAAX,WAEC,MAAO,MAAK,gDAQb,QAAA,eAAW,EAAA,UAAA,6BAAX,WAEC,MAAO,MAAK,2DAMb,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,gBAGb,SAAqB,GAEpB,KAAK,WAAa,CAClB,MAAK,iBAAmB,yCAMzB,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,KAAK,eAAiB,KAEtB,OAAO,MAAK,8CAMb,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,YAGb,SAAiB,GAEhB,KAAK,OAAS,sCAMf,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,kBAGb,SAAuB,GAEtB,KAAK,aAAe,sCA+Bb,GAAA,UAAA,YAAR,WAEC,GAAI,KAAK,SAAU,CAClB,KAAK,SAAS,SAEd,MAAK,cAAc,GAAI,GAAW,EAAW,mBAG9C,KAAK,SAAW,IAEhB,MAAK,aAAe,MAOb,GAAA,UAAA,aAAR,SAAqB,GAEpB,IAAK,KAAK,SACT,MAGD,MAAK,OAEL,MAAK,kBAEL,KAAK,KAAK,SACT,KAAK,SAAS,SAEf,MAAK,kBAGC,GAAA,UAAA,oBAAP,WAEC,IAAK,KAAK,SACT,MAAO,MAaR,OAAO,MAIA,GAAA,UAAA,UAAR,SAAkB,GAEjB,KAAK,SAAW,CAEhB,MAAK,WAAa,KAAK,SAAS,SAKhC,IAAI,KAAK,QAAU,KAAK,QACvB,KAAK,SAAS,oBAAoB,KAAK,OAAQ,KAAK,QAAS,KAAK,WAAY,KAAK,uBAIpF,MAAK,cAAc,GAAI,GAAW,KAAK,aAAc,EAAW,kBAAoB,EAAW,iBAE/F,MAAK,aAAe,KAEtB,OAAA,IA7iBoB,EA+iBpB,GAAe,QAAN,gWCvkBT,GAAO,GAAmB,EAAa,6CAEvC,IAAM,GAAgB,WAKrB,QALK,GAKO,GAHL,KAAA,YAAqB,EAK3B,MAAK,IAAM,EAGL,EAAA,UAAA,QAAP,WAEC,KAAM,sCAGP,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,KAAM,IAAI,uCAEZ,OAAA,KAEA,GAA0B,QAAjB,0OCvBT,IAAO,GAAU,EAAe,kCAChC,IAAO,GAAa,EAAc,sCAIlC,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EAgBjB,SAhBK,GAgBO,EAAwB,EAAc,EAAe,EAAe,EAAgB,GAAA,GAAA,QAAA,GAAyB,CAAzB,EAAA,MAE/F,EAAA,KAAA,KAEA,MAAK,SAAW,CAChB,MAAK,OAAS,CACd,MAAK,QAAU,CAEf,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,YAAc,EAAQ,EAAQ,UAAY,EAAQ,YAAe,EAAQ,IAAM,EAAS,IAAM,EAAY,IAAM,EAAS,IAC7K,MAAK,KAAO,KAAK,SAAS,SAC1B,MAAK,SAAS,cAAc,MApB7B,OAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,2CAGb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAgBN,GAAA,UAAA,QAAP,WAEC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,gBAAkB,KAAK,KAAK,WAAa,IAC7F,MAAK,SAAS,SACd,MAAK,SAAS,iBAAiB,KAE/B,MAAK,SAAW,KAKV,GAAA,UAAA,eAAP,SAAsB,EAAU,GAAA,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAE/B,GAAI,YAAgB,GAAY,CAC/B,EAAqB,EAAM,UAAU,SAC/B,IAAI,YAAgB,kBAAkB,CAC5C,GAAI,GAAM,SAAS,cAAc,SACjC,IAAI,GAAI,EAAK,KACb,IAAI,GAAI,EAAK,MACb,GAAI,MAAQ,CACZ,GAAI,OAAS,CACb,IAAI,GAAM,EAAI,WAAW,KACzB,GAAI,UAAU,EAAM,EAAG,EACvB,GAAO,EAAI,aAAa,EAAG,EAAG,EAAG,GAAG,KAGrC,GAAI,GAAM,CACV,IAAI,GAAQ,EAAc,wBAAwB,EAAK,OAAQ,WAC9D,MAAO,GAAK,MACV,KAEH,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,oBAAsB,KAAK,KAAO,IAAM,EAAW,KAAO,KAAK,QAAU,GAAY,KAAO,KAAK,SAAW,GAAY,IAAM,EAAQ,IAC1L,MAAK,SAAS,UAEhB,OAAA,IA/D2B,EAiE3B,GAAsB,QAAb,+VCzET,IAAO,GAAU,EAAe,kCAIhC,IAAO,GAAgB,EAAc,2CAErC,IAAM,GAAY,SAAA,GAAS,EAArB,EAAY,EAYjB,SAZK,GAYO,EAA0B,EAAc,GAEnD,EAAA,KAAA,KAAM,EAXA,MAAA,YAAqB,WAY3B,MAAK,OAAS,CACd,MAAK,QAAU,CAEf,MAAK,WAAa,KAAK,IAAI,gBAGrB,EAAA,UAAA,QAAP,WAEC,KAAK,IAAI,cAAc,KAAK,YAG7B,QAAA,eAAW,EAAA,UAAA,aAAX,WAEC,MAAO,MAAK,2CAGb,QAAA,eAAW,EAAA,UAAA,cAAX,WAEC,MAAO,MAAK,4CAGb,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,IAAK,KAAK,aAAc,CACvB,KAAK,aAAe,KAAK,IAAI,mBAC7B,MAAK,IAAI,gBAAgB,KAAK,IAAI,YAAa,KAAK,aACpD,MAAK,IAAI,YAAY,KAAK,IAAI,WAAY,KAAK,WAC/C,MAAK,IAAI,WAAW,KAAK,IAAI,WAAY,EAAG,KAAK,IAAI,KAAM,KAAK,OAAQ,KAAK,QAAS,EAAG,KAAK,IAAI,KAAM,KAAK,IAAI,cAAe,KAEhI,IAAI,GAAiC,KAAK,IAAI,oBAC9C,MAAK,IAAI,iBAAiB,KAAK,IAAI,aAAc,EACjD,MAAK,IAAI,oBAAoB,KAAK,IAAI,aAAc,KAAK,IAAI,kBAAmB,KAAK,OAAQ,KAAK,QAElG,MAAK,IAAI,qBAAqB,KAAK,IAAI,YAAa,KAAK,IAAI,kBAAmB,KAAK,IAAI,WAAY,KAAK,WAAY,EACtH,MAAK,IAAI,wBAAwB,KAAK,IAAI,YAAa,KAAK,IAAI,iBAAkB,KAAK,IAAI,aAAc,EAEzG,MAAK,IAAI,YAAY,KAAK,IAAI,WAAY,KAC1C,MAAK,IAAI,iBAAiB,KAAK,IAAI,aAAc,KACjD,MAAK,IAAI,gBAAgB,KAAK,IAAI,YAAa,MAGhD,MAAO,MAAK,iDAKN,GAAA,UAAA,eAAP,SAAsB,EAAU,GAAA,GAAA,QAAA,GAAmB,CAAnB,EAAA,EAE/B,GAAI,YAAgB,GACnB,EAAqB,EAAM,SAE5B,MAAK,IAAI,YAAY,KAAK,IAAI,WAAY,KAAK,WAC/C,MAAK,IAAI,WAAW,KAAK,IAAI,WAAY,EAAU,KAAK,IAAI,KAAM,KAAK,IAAI,KAAM,KAAK,IAAI,cAAe,EACzG,MAAK,IAAI,YAAY,KAAK,IAAI,WAAY,MAGpC,GAAA,UAAA,qCAAP,SAA4C,EAAgB,EAAiC,GAAA,GAAA,QAAA,GAAqB,CAArB,EAAA,MAE5F,GAAI,GAAa,KAAK,IAAI,aAAa,wCAIxC,QAAA,eAAW,EAAA,UAAA,iBAAX,WAEC,MAAO,MAAK,+CAGN,GAAA,UAAA,gBAAP,YAOD,OAAA,IAzF2B,EA2FL,GAAA,QAAb,8QC/FT,IAAO,GAAO,EAAgB,kCAC9B,IAAO,GAAiB,EAAa,4CAErC,IAAM,GAAiB,SAAA,GAAS,EAA1B,EAAiB,EAMtB,SANK,GAMO,EAAwB,EAAoB,GAEvD,EAAA,KAAA,KAEA,MAAK,SAAW,CAChB,MAAK,aAAe,CACpB,MAAK,iBAAmB,CACxB,MAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,iBAAkB,EAAkB,EAAQ,SAAW,EAAY,WAAa,IACpI,MAAK,KAAO,KAAK,SAAS,SAC1B,MAAK,SAAS,cAAc,MAGtB,EAAA,UAAA,gBAAP,SAAuB,EAAe,EAAoB,GAEzD,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,wBAAyB,KAAK,KAAO,EAAQ,SAAW,EAAK,OAAS,KAAO,EAAa,GAAa,OAAS,IACpK,MAAK,SAAS,UAGf,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAGb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAGN,GAAA,UAAA,QAAP,WAEC,KAAK,SAAS,UAAU,OAAO,aAAa,EAAQ,oBAAqB,KAAK,KAAO,EAAQ,SAC7F,MAAK,SAAS,SACd,MAAK,SAAS,iBAAiB,KAE/B,MAAK,SAAW,KAElB,OAAA,IA1CgC,EA4ChC,GAA2B,QAAlB,iHC/CT,GAAM,GAAiB,WAQtB,QARK,GAQO,EAA0B,EAAoB,GAEzD,KAAK,IAAM,CACX,MAAK,QAAU,KAAK,IAAI,cACxB,MAAK,aAAe,CACpB,MAAK,iBAAmB,EAGlB,EAAA,UAAA,gBAAP,SAAuB,EAAmB,EAAoB,GAE7D,KAAK,IAAI,WAAW,KAAK,IAAI,aAAc,KAAK,QAIhD,MAAK,IAAI,WAAW,KAAK,IAAI,aAAc,GAAI,cAAa,GAAW,KAAK,IAAI,aAGjF,QAAA,eAAW,EAAA,UAAA,mBAAX,WAEC,MAAO,MAAK,iDAGb,QAAA,eAAW,EAAA,UAAA,uBAAX,WAEC,MAAO,MAAK,qDAGb,QAAA,eAAW,EAAA,UAAA,gBAAX,WAEC,MAAO,MAAK,4CAGN,GAAA,UAAA,QAAP,WAEC,KAAK,IAAI,aAAa,KAAK,SAE7B,OAAA,KAEA,GAA2B,QAAlB,0LChDT,IAAO,GAAe,EAAc,yCACpC,IAAO,GAAa,EAAc,uCAElC,IAAO,GAAU,EAAe,uCAEhC,IAAO,GAAK,EAAgB,oCAOtB,GAAY,SAAA,GAAS,EAArB,EAAY,EAcjB,SAdK,KAAN,GAAA,GAAA,IAgBE,GAAA,KAAA,KAEA,MAAK,QAAU,GAAI,OAAa,EAAa,mBAE7C,MAAK,0BAA4B,SAAC,GAAgB,MAAA,GAAK,iBAAiB,IAQ3D,EAAA,YAAd,WAEC,GAAI,KAAK,WAAa,KACrB,KAAK,UAAY,GAAI,EAEtB,OAAO,MAAK,UAWN,GAAA,UAAA,WAAP,SAAkB,EAAc,EAA+B,EAA6B,GAA5D,GAAA,QAAA,GAA6B,CAA7B,EAAA,MAA+B,GAAA,QAAA,GAA2B,CAA3B,EAAA,WAA6B,GAAA,QAAA,GAAoB,CAApB,EAAA,OAE3F,GAAI,EAAQ,GAAK,GAAS,EAAa,mBACtC,KAAM,IAAI,GAAc,8BAAgC,EAAa,mBAAqB,IAE3F,KAAK,KAAK,QAAQ,GAAQ,CACzB,EAAa,YAEb,IAAI,GAA2B,SAAS,cAAc,SACtD,GAAO,GAAK,QAAU,CACtB,UAAS,KAAK,YAAY,EAC1B,IAAI,GAAc,KAAK,QAAQ,GAAS,GAAI,GAAM,EAAQ,EAAO,KAAM,EAAe,EACtF,GAAM,iBAAiB,EAAW,gBAAiB,KAAK,0BACxD,GAAM,eAAe,EAAe,EAAS,GAG9C,MAAO,GAQD,GAAA,UAAA,aAAP,SAAoB,GAEnB,EAAa,YAEb,GAAM,oBAAoB,EAAW,gBAAiB,KAAK,0BAE3D,MAAK,QAAQ,EAAM,YAAc,KAS3B,GAAA,UAAA,aAAP,SAAoB,EAA+B,EAA6B,GAA5D,GAAA,QAAA,GAA6B,CAA7B,EAAA,MAA+B,GAAA,QAAA,GAA2B,CAA3B,EAAA,WAA6B,GAAA,QAAA,GAAoB,CAApB,EAAA,OAE/E,GAAI,GAAW,CACf,IAAI,GAAa,KAAK,QAAQ,MAE9B,OAAO,EAAI,EAAK,CACf,IAAK,KAAK,QAAQ,GACjB,MAAO,MAAK,WAAW,EAAG,EAAe,EAAS,KAEjD,EAGH,MAAO,MAOR,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,GAAa,WAAa,EAAa,mBAAoB,KAAO,0CAO1E,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,GAAa,mBAAqB,EAAa,+CAOvD,QAAA,eAAW,EAAA,UAAA,oBAAX,WAEC,MAAO,GAAa,+CAMrB,QAAA,eAAW,EAAA,UAAA,qBAAX,WAEC,MAAO,MAAK,QAAQ,2CAGb,GAAA,UAAA,iBAAR,SAAyB,IAnIV,GAAA,mBAA4B,CAI5B,GAAA,WAAoB,CAoIpC,OAAA,IA1I2B,EA4IL,GAAA,QAAb,qMChJH,GAAS,WAwBd,QAxBK,GAwBO,GAlBJ,KAAA,WAAa,IAEd,MAAA,QAAyB,GAAI,OAAM,EAEnC,MAAA,SAAgC,GAAI,OAAqB,EAEzD,MAAA,QAA8B,GAAI,OAAoB,EAc5D,MAAK,MAAQ,EAGP,EAAA,UAAA,WAAP,SAAkB,EAAe,EAAuB,GAEvD,GAAI,KAAK,WAAY,CACpB,KAAK,WAAa,KAElB,IAAI,EAAQ,OAAS,EAAU,eAAiB,EAAc,EAAU,YAAa,CAEpF,KAAK,cAAgB,IACrB,MAAK,gBAAkB,IACvB,MAAK,QAAQ,EACb,MAAK,OAAS,EAAQ,WAChB,CACN,GAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,EACJ,IAAI,GAA6B,GAAI,MAErC,MAAK,cAAgB,GAAI,OAAc,EAAQ,OAC/C,MAAK,gBAAkB,GAAI,MAE3B,GAAI,KAAK,cAAc,MAEvB,OAAO,IACN,KAAK,cAAc,IAAM,CAE1B,IAAI,EACJ,IAAI,EAGJ,GAAW,CACX,GAAM,EAAQ,MACd,GAAI,CACJ,GAAI,CACJ,OAAO,EAAI,GAAO,EAAW,EAAI,EAAU,eAAiB,EAAI,EAAI,EAAU,YAAa,CAE1F,IAAK,EAAI,EAAG,EAAI,EAAG,IAAK,CAEvB,EAAgB,EAAQ,EAAI,EAE5B,IAAI,KAAK,cAAc,IAAkB,EAAG,CAC3C,EAAa,KAAK,cAAc,OAC1B,CAIN,EAAa,GACb,MAAK,cAAc,GAAiB,CACpC,MAAK,gBAAgB,KAAK,GAK3B,EAAa,EAAW,GAAK,EAG9B,GAAY,CACZ,IAAK,EAGN,KAAK,QAAQ,EACb,MAAK,OAAS,IAKV,GAAA,UAAA,eAAP,WAEC,KAAK,WAAa,KAGZ,GAAA,UAAA,QAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,SAAS,GAAI,CACrB,KAAK,SAAS,GAAG,iBAAiB,KAClC,MAAK,SAAS,GAAK,OAQd,GAAA,UAAA,eAAR,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,QAAQ,GAAI,CACpB,KAAK,QAAQ,GAAG,SAChB,MAAK,QAAQ,GAAK,OAQb,GAAA,UAAA,kBAAR,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAC/B,KAAK,QAAQ,GAAK,KAQZ,GAAA,UAAA,QAAR,SAAgB,GAEf,GAAI,KAAK,MAAQ,KAAK,KAAK,QAAU,EAAK,OACzC,KAAK,qBAEL,MAAK,mBAEN,MAAK,KAAO,EA/IE,GAAA,YAAqB,KAErB,GAAA,cAAuB,QA+IvC,OAAA,KAEA,GAAmB,QAAV,4BC3JT,GAAO,GAAS,EAAe,wCAKzB,GAAa,WAIlB,QAJK,MAQS,EAAA,QAAd,SAAsB,EAA6B,EAAc,GAEhE,GAAI,GAAuD,EAAc,MAAM,EAAY,MAAQ,EAAc,MAAM,EAAY,IAAM,GAAI,OAE7I,IAAI,GAAsB,EAAgB,KAAW,EAAgB,GAAS,GAAI,GAAU,GAC5F,GAAU,WAAW,EAAa,EAAY,QAAS,EAAY,YAEnE,OAAO,GAGM,GAAA,YAAd,SAA0B,EAAW,GAEpC,GAAI,GAAsD,KAAK,MAAM,EAErE,GAAgB,GAAO,SACvB,GAAgB,GAAS,KAGnB,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,GAAsD,EAAc,MAAM,EAE9E,IAAI,GAAa,EAAgB,MACjC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAAK,CACpC,EAAgB,GAAG,SACnB,GAAgB,GAAK,KAGtB,EAAc,MAAM,GAAM,KAlCZ,GAAA,MAAe,GAAI,OAoCnC,OAAA,KAEuB,GAAA,QAAd,sECvCH,GAAW,WAehB,QAfK,GAeO,EAAsB,EAAuB,GANlD,KAAA,OAAgB,CAQtB,MAAK,MAAQ,CACb,MAAK,QAAU,CACf,MAAK,KAAO,CACZ,MAAK,QAAQ,gBAAgB,MAMvB,EAAA,UAAA,QAAP,WAEC,KAAK,QAEL,KAAK,KAAK,OAAQ,CACjB,KAAK,MAAM,YAAY,KAAK,KAE5B,MAAK,QAAQ,kBAAkB,KAE/B,IAAI,KAAK,QACR,KAAK,QAAQ,UAGf,KAAK,QAAU,KArCF,GAAA,qBAA8B,CAuC7C,OAAA,KAEqB,GAAA,QAAZ,4BCjDT,GAAO,GAAW,EAAe;GAM3B,GAAe,WAUpB,QAVK,GAUO,GARJ,KAAA,MAAe,GAAI,OAU1B,MAAK,SAAW,EASV,EAAA,UAAA,QAAP,SAAe,GAEd,MAAO,MAAK,MAAM,KAAS,KAAK,MAAM,GAAO,GAAI,GAAY,KAAM,KAAK,SAAU,IAQ5E,GAAA,UAAA,YAAP,SAAmB,GAElB,KAAK,MAAM,GAAO,KAEpB,OAAA,KAEA,GAAyB,QAAhB,wEClCH,GAAW,WAYhB,QAZK,GAYO,EAAsB,EAAuB,GAExD,KAAK,MAAQ,CACb,MAAK,QAAU,CACf,MAAK,aAAe,EAMd,EAAA,UAAA,QAAP,WAEC,KAAK,MAAM,YAAY,KAAK,aAE5B,MAAK,QAAQ,SACb,MAAK,QAAU,KAMT,GAAA,UAAA,WAAP,WAEC,KAAK,QAAU,KAEjB,OAAA,KAEqB,GAAA,QAAZ,4BChDT,GAAO,GAAW,EAAe,0CAM3B,GAAe,WAUpB,QAVK,GAUO,GARJ,KAAA,MAAe,GAAI,OAU1B,MAAK,SAAW,EASV,EAAA,UAAA,QAAP,SAAe,GAEd,MAAQ,MAAK,MAAM,EAAa,MAAQ,KAAK,MAAM,EAAa,IAAM,EAAa,iBAAiB,GAAI,GAAY,KAAM,KAAK,SAAU,KAQnI,GAAA,UAAA,YAAP,SAAmB,GAElB,EAAa,oBAAoB,KAAK,MAAM,EAAa,IAEzD,MAAK,MAAM,EAAa,IAAM,KAEhC,OAAA,KAEA,GAAyB,QAAhB,qEC/CT,GAAO,GAAe,EAAc,0CACpC,IAAO,GAAgB,EAAc,iDAQ/B,GAAU,WAiBf,QAjBK,GAiBO,EAA6B,GAjB1C,GAAA,GAAA,IAKS,MAAA,WAAa,IAEd,MAAA,QAAyB,GAAI,OAAe,EAE5C,MAAA,QAA+B,GAAI,OAAqB,EAExD,MAAA,SAAgC,GAAI,OAAqB,EAQ/D,MAAK,aAAe,CACpB,MAAK,UAAY,CAEjB,MAAK,2BAA6B,SAAC,GAA2B,MAAA,GAAK,mBAAmB,GACtF,MAAK,aAAa,iBAAiB,EAAiB,iBAAkB,KAAK,4BAGrE,EAAA,UAAA,WAAP,SAAkB,EAAsC,GAAtC,GAAA,QAAA,GAAoC,CAApC,EAAA,KAAsC,GAAA,QAAA,GAAkC,CAAlC,EAAA,KAEvD,GAAI,KAAK,WAAY,CACpB,KAAK,WAAa,KAElB,MAAK,cAAgB,KAAK,aAAa,UAAU,KAAK,UAEtD,IAAI,GAAyB,KAAK,aAAa,KAAK,UAEpD,IAAI,GAAiB,KAAM,CAC1B,KAAK,QAAQ,OACP,CACN,GAAI,GAA2B,GAAI,OAAc,EAAgB,OAAO,KAAK,cAC7E,IAAI,EACJ,IAAI,EACJ,IAAI,GAAW,CACf,IAAI,GAAW,CACf,OAAM,EAAI,EAAgB,OAAQ,CACjC,EAAgB,EAAgB,EAEhC,GAAa,EAAc,GAAe,KAAK,aAC/C,IAAiB,KAAK,aAEtB,KAAK,EAAI,EAAG,EAAI,KAAK,cAAe,IACnC,EAAW,EAAa,GAAK,EAAS,EAAgB,EAEvD,KAGD,KAAK,QAAQ,KAKT,GAAA,UAAA,QAAP,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,SAAS,GAAI,CACrB,KAAK,SAAS,GAAG,kBAAkB,KACnC,MAAK,SAAS,GAAK,OAQd,GAAA,UAAA,eAAR,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAAG,CAClC,GAAI,KAAK,QAAQ,GAAI,CACpB,KAAK,QAAQ,GAAG,SAChB,MAAK,QAAQ,GAAK,OAQb,GAAA,UAAA,kBAAR,WAEC,IAAK,GAAI,GAAW,EAAG,EAAI,IAAK,EAC/B,KAAK,QAAQ,GAAK,KASZ,GAAA,UAAA,QAAR,SAAgB,GAEf,GAAI,KAAK,MAAQ,KAAK,KAAK,QAAU,EAAK,OACzC,KAAK,qBAEL,MAAK,mBAEN,MAAK,KAAO,EASL,GAAA,UAAA,mBAAR,SAA2B,GAE1B,GAAI,GAAkB,KAAK,aAAa,kBAAmB,EAAgB,YAAc,EAAM,QAE/F,IAAI,GAAY,KAAK,UACpB,KAAK,WAAa,KAErB,OAAA,KAEA,GAAoB,QAAX,0HCpIT,GAAO,GAAe,EAAc,0CAGpC,IAAO,GAAU,EAAe,yCAK1B,GAAc,WAInB,QAJK,MAQS,EAAA,QAAd,SAAsB,EAA6B,EAAqB,GAEvE,GAAI,EAAY,kBACf,EAAW,EAAgB,WAE5B,IAAI,GAAyC,EAAe,MAAM,EAAY,MAAQ,EAAe,MAAM,EAAY,IAAM,GAAI,QACjI,IAAI,GAAyD,EAAsB,KAAc,EAAsB,GAAY,GAAI,OAEvI,IAAI,GAAwB,EAAgB,EAAU,SAAW,EAAgB,EAAU,OAAS,GAAI,GAAW,EAAa,GAChI,GAAW,WAAW,EAAU,gBAAiB,EAAU,cAE3D,OAAO,GAGM,GAAA,YAAd,SAA0B,EAA6B,EAAc,GAEpE,GAAI,GAAwC,EAAe,MAAM,EAAY,GAC7E,IAAI,GAAwD,EAAsB,EAElF,GAAgB,GAAO,SACvB,GAAgB,GAAS,KAGnB,GAAA,UAAA,YAAP,SAAmB,GAElB,GAAI,GAAwC,EAAe,MAAM,EAAY,GAE7E,KAAK,GAAI,KAAO,GAAuB,CACtC,GAAI,GAAwD,EAAsB,EAElF,IAAI,GAAa,EAAgB,MACjC,KAAK,GAAI,GAAW,EAAG,EAAI,EAAK,IAAK,CACpC,EAAgB,GAAG,SACnB,GAAgB,GAAK,MAIvB,EAAe,MAAM,EAAY,IAAM,KA3CzB,GAAA,MAAe,GAAI,OA6CnC,OAAA,KAEA,GAAwB,QAAf,kHCrDT,GAAA,GAAA,WAEA,GAAA,GAAA,YACA,EAAA,SACA,EAAA,kBACA,EAAA,gCACA,EAAA,gCACA,EAAA,oBACA,EAAA,qBAEA,EAAA,OACA,EAAA,SACA,EAAA,UAEA,EAAA,MACA,GAAA,GACA,KACA,KACA,KACA,EACA,EACA,EACA,EACA,EAAA,MACA,EAAA,MACA,EACA,EACA,EAAA,KAMA,EAAA,WACA,GAAA,SAAA,GAAA,gBAAA,SAAA,GAAA,sBAAA,SAAA,GAAA,eAAA,EACA,EAAA,EAAA,UAAA,cACA,EAAA,EAAA,SAAA,cACA,EAAA,EAAA,MAAA,KAAA,GAAA,MAAA,KAAA,GACA,EAAA,EAAA,MAAA,KAAA,GAAA,MAAA,KAAA,GACA,EAAA,SAAA,KAAA,GAAA,WAAA,EAAA,QAAA,8BAAA,OAAA,MACA,IAAA,KACA,GAAA,EAAA,EAAA,GACA,EAAA,IACA,UAAA,GAAA,SAAA,SAAA,GAAA,QAAA,IAAA,EAAA,CACA,EAAA,EAAA,QAAA,GAAA,WACA,IAAA,WAAA,GAAA,WAAA,GAAA,EAAA,UAAA,KAAA,EAAA,UAAA,GAAA,eAAA,CACA,EAAA,IACA,GAAA,KACA,GAAA,EAAA,QAAA,qBAAA,KACA,GAAA,GAAA,SAAA,EAAA,QAAA,aAAA,MAAA,GACA,GAAA,GAAA,SAAA,EAAA,QAAA,iBAAA,MAAA,GACA,GAAA,GAAA,WAAA,KAAA,GAAA,SAAA,EAAA,QAAA,oBAAA,MAAA,IAAA,OAGA,UAAA,GAAA,eAAA,EAAA,CACA,IACA,GAAA,GAAA,GAAA,eAAA,EACA,IAAA,EAAA,CACA,EAAA,EAAA,YAAA,WACA,IAAA,EAAA,CACA,EAAA,IACA,GAAA,EAAA,MAAA,KAAA,GAAA,MAAA,IACA,IAAA,SAAA,EAAA,GAAA,IAAA,SAAA,EAAA,GAAA,IAAA,SAAA,EAAA,GAAA,OAIA,MAAA,KAEA,OAAA,GAAA,EAAA,GAAA,EAAA,GAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,MAQA,EAAA,WACA,IAAA,EAAA,GAAA,CAAA,OACA,SAAA,GAAA,YAAA,GAAA,EAAA,YAAA,kBAAA,GAAA,YAAA,IAAA,EAAA,qBAAA,QAAA,IAAA,EAAA,MAAA,CACA,IAEA,IAAA,EAAA,CACA,SAAA,GAAA,kBAAA,EAAA,CACA,EAAA,iBAAA,mBAAA,EAAA,OAEA,GAAA,EAAA,IAAA,EAAA,IAAA,CACA,EAAA,YAAA,EAAA,WACA,GAAA,EAAA,YAAA,WAAA,CACA,EAAA,YAAA,EAAA,UAAA,OACA,OAGA,IAAA,GAAA,IAAA,EACA,WACA,GAAA,EAAA,CAAA,OACA,IACA,EAAA,gBAAA,SAAA,QAEA,MAAA,GACA,WAAA,UAAA,OAAA,EACA,QAEA,SAIA,GAAA,EAAA,GAAA,EACA,WACA,GAAA,EAAA,CAAA,OACA,IAAA,kBAAA,KAAA,EAAA,YAAA,CACA,WAAA,UAAA,OAAA,EACA,QAEA,QAGA,EAAA,MAIA,SAAA,KACA,GAAA,EAAA,CAAA,OACA,IACA,GAAA,GAAA,EAAA,qBAAA,QAAA,GAAA,YAAA,EAAA,QACA,GAAA,WAAA,YAAA,GAEA,MAAA,GAAA,OACA,EAAA,IACA,IAAA,GAAA,EAAA,MACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,EAAA,MAIA,QAAA,GAAA,GACA,GAAA,EAAA,CACA,QAEA,CACA,EAAA,EAAA,QAAA,GAQA,QAAA,GAAA,GACA,SAAA,GAAA,kBAAA,EAAA,CACA,EAAA,iBAAA,OAAA,EAAA,WAEA,UAAA,GAAA,kBAAA,EAAA,CACA,EAAA,iBAAA,OAAA,EAAA,WAEA,UAAA,GAAA,aAAA,EAAA,CACA,EAAA,EAAA,SAAA,OAEA,UAAA,GAAA,QAAA,WAAA,CACA,GAAA,GAAA,EAAA,MACA,GAAA,OAAA,WACA,GACA,UAGA,CACA,EAAA,OAAA,GAOA,QAAA,KACA,GAAA,EAAA,CACA,QAEA,CACA,KAWA,QAAA,KACA,GAAA,GAAA,EAAA,qBAAA,QAAA,EACA,IAAA,GAAA,EAAA,EACA,GAAA,aAAA,OAAA,EACA,IAAA,GAAA,EAAA,YAAA,EACA,IAAA,EAAA,CACA,GAAA,GAAA,GACA,WACA,SAAA,GAAA,aAAA,EAAA,CACA,GAAA,GAAA,EAAA,YAAA,WACA,IAAA,EAAA,CACA,EAAA,EAAA,MAAA,KAAA,GAAA,MAAA,IACA,GAAA,IAAA,SAAA,EAAA,GAAA,IAAA,SAAA,EAAA,GAAA,IAAA,SAAA,EAAA,GAAA,UAGA,IAAA,EAAA,GAAA,CACA,GACA,YAAA,UAAA,OAAA,GACA,QAEA,EAAA,YAAA,EACA,GAAA,IACA,aAGA,CACA,KAMA,QAAA,KACA,GAAA,GAAA,EAAA,MACA,IAAA,EAAA,EAAA,CACA,IAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,GAAA,GAAA,EAAA,GAAA,EACA,IAAA,GAAA,EAAA,GAAA,UACA,IAAA,IAAA,QAAA,MAAA,GAAA,EACA,IAAA,EAAA,GAAA,GAAA,EAAA,CACA,GAAA,GAAA,EAAA,EACA,IAAA,EAAA,CACA,GAAA,EAAA,EAAA,GAAA,eAAA,EAAA,IAAA,EAAA,GAAA,KAAA,CACA,EAAA,EAAA,KACA,IAAA,EAAA,CACA,EAAA,QAAA,IACA,GAAA,IAAA,EAAA,EACA,GAAA,QAGA,IAAA,EAAA,GAAA,gBAAA,IAAA,CACA,GAAA,KACA,GAAA,KAAA,EAAA,GAAA,cACA,GAAA,MAAA,EAAA,aAAA,UAAA,GACA,GAAA,OAAA,EAAA,aAAA,WAAA,GACA,IAAA,EAAA,aAAA,SAAA,CAAA,EAAA,WAAA,EAAA,aAAA,SACA,GAAA,EAAA,aAAA,SAAA,CAAA,EAAA,MAAA,EAAA,aAAA,SAEA,GAAA,KACA,IAAA,GAAA,EAAA,qBAAA,QACA,IAAA,GAAA,EAAA,MACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,GAAA,EAAA,GAAA,aAAA,QAAA,eAAA,QAAA,CACA,EAAA,EAAA,GAAA,aAAA,SAAA,EAAA,GAAA,aAAA,UAGA,EAAA,EAAA,EAAA,EAAA,OAEA,CACA,EAAA,EACA,IAAA,EAAA,CAAA,EAAA,UAIA,CACA,EAAA,EAAA,KACA,IAAA,EAAA,CACA,GAAA,GAAA,EAAA,EACA,IAAA,SAAA,GAAA,aAAA,EAAA,CACA,EAAA,QAAA,IACA,GAAA,IAAA,EAEA,EAAA,OAOA,QAAA,GAAA,GACA,GAAA,GAAA,IACA,IAAA,GAAA,EAAA,EACA,IAAA,GAAA,EAAA,UAAA,SAAA,CACA,SAAA,GAAA,aAAA,EAAA,CACA,EAAA,MAEA,CACA,GAAA,GAAA,EAAA,qBAAA,GAAA,EACA,IAAA,EAAA,CACA,EAAA,IAIA,MAAA,GASA,QAAA,KACA,OAAA,GAAA,EAAA,YAAA,EAAA,KAAA,EAAA,QAAA,EAAA,IAAA,EAAA,GAAA,KAMA,QAAA,GAAA,EAAA,EAAA,EAAA,GACA,EAAA,IACA,GAAA,GAAA,IACA,IAAA,QAAA,MAAA,GAAA,EACA,IAAA,GAAA,EAAA,EACA,IAAA,EAAA,CACA,GAAA,EAAA,UAAA,SAAA,CACA,EAAA,EAAA,EACA,GAAA,SAEA,CACA,EAAA,CACA,GAAA,EAEA,EAAA,GAAA,CACA,UAAA,GAAA,OAAA,IAAA,KAAA,KAAA,EAAA,QAAA,SAAA,EAAA,MAAA,IAAA,IAAA,CAAA,EAAA,MAAA,MACA,SAAA,GAAA,QAAA,IAAA,KAAA,KAAA,EAAA,SAAA,SAAA,EAAA,OAAA,IAAA,IAAA,CAAA,EAAA,OAAA,MACA,EAAA,MAAA,EAAA,MAAA,MAAA,EAAA,IAAA,8BACA,IAAA,GAAA,EAAA,IAAA,EAAA,IAAA,UAAA,SACA,EAAA,iBAAA,UAAA,OAAA,UAAA,WAAA,QAAA,KAAA,OAAA,iBAAA,EAAA,eAAA,EAAA,KACA,UAAA,GAAA,WAAA,EAAA,CACA,EAAA,WAAA,IAAA,MAEA,CACA,EAAA,UAAA,EAIA,GAAA,EAAA,IAAA,EAAA,KAAA,EAAA,YAAA,EAAA,CACA,GAAA,GAAA,EAAA,MACA,IAAA,cACA,GAAA,aAAA,KAAA,EACA,GAAA,WAAA,aAAA,EAAA,EACA,GAAA,MAAA,QAAA,QACA,WACA,GAAA,EAAA,YAAA,EAAA,CACA,EAAA,WAAA,YAAA,OAEA,CACA,WAAA,UAAA,OAAA,SAIA,EAAA,EAAA,EAAA,IAMA,QAAA,GAAA,GACA,GAAA,EAAA,IAAA,EAAA,KAAA,EAAA,YAAA,EAAA,CAGA,GAAA,GAAA,EAAA,MACA,GAAA,WAAA,aAAA,EAAA,EACA,GAAA,WAAA,aAAA,EAAA,GAAA,EACA,GAAA,MAAA,QAAA,QACA,WACA,GAAA,EAAA,YAAA,EAAA,CACA,EAAA,WAAA,YAAA,OAEA,CACA,WAAA,UAAA,OAAA,aAIA,CACA,EAAA,WAAA,aAAA,EAAA,GAAA,IAIA,QAAA,GAAA,GACA,GAAA,GAAA,EAAA,MACA,IAAA,EAAA,KAAA,EAAA,GAAA,CACA,EAAA,UAAA,EAAA,cAEA,CACA,GAAA,GAAA,EAAA,qBAAA,GAAA,EACA,IAAA,EAAA,CACA,GAAA,GAAA,EAAA,UACA,IAAA,EAAA,CACA,GAAA,GAAA,EAAA,MACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,KAAA,EAAA,GAAA,UAAA,GAAA,EAAA,GAAA,UAAA,YAAA,EAAA,GAAA,UAAA,GAAA,CACA,EAAA,YAAA,EAAA,GAAA,UAAA,WAMA,MAAA,GAKA,QAAA,GAAA,EAAA,EAAA,GACA,GAAA,GAAA,EAAA,EAAA,EACA,IAAA,EAAA,IAAA,EAAA,GAAA,IAAA,CAAA,MAAA,GACA,GAAA,EAAA,CACA,SAAA,GAAA,IAAA,EAAA,CACA,EAAA,GAAA,EAEA,GAAA,EAAA,IAAA,EAAA,IAAA,CACA,GAAA,GAAA,EACA,KAAA,GAAA,KAAA,GAAA,CACA,GAAA,EAAA,IAAA,OAAA,UAAA,GAAA,CACA,GAAA,EAAA,eAAA,OAAA,CACA,EAAA,MAAA,EAAA,OAEA,IAAA,EAAA,eAAA,aAAA,CACA,GAAA,WAAA,EAAA,GAAA,QAEA,IAAA,EAAA,eAAA,UAAA,CACA,GAAA,IAAA,EAAA,KAAA,EAAA,GAAA,MAIA,GAAA,GAAA,EACA,KAAA,GAAA,KAAA,GAAA,CACA,GAAA,EAAA,IAAA,OAAA,UAAA,GAAA,CACA,GAAA,gBAAA,EAAA,YAAA,EAAA,GAAA,QAGA,EAAA,UAAA,+DAAA,EAAA,IAAA,EAAA,WACA,GAAA,EAAA,QAAA,EAAA,EACA,GAAA,EAAA,EAAA,QAEA,CACA,GAAA,GAAA,EAAA,EACA,GAAA,aAAA,OAAA,EACA,KAAA,GAAA,KAAA,GAAA,CACA,GAAA,EAAA,IAAA,OAAA,UAAA,GAAA,CACA,GAAA,EAAA,eAAA,aAAA,CACA,EAAA,aAAA,QAAA,EAAA,QAEA,IAAA,EAAA,eAAA,UAAA,CACA,EAAA,aAAA,EAAA,EAAA,MAIA,IAAA,GAAA,KAAA,GAAA,CACA,GAAA,EAAA,IAAA,OAAA,UAAA,IAAA,EAAA,eAAA,QAAA,CACA,EAAA,EAAA,EAAA,EAAA,KAGA,EAAA,WAAA,aAAA,EAAA,EACA,GAAA,GAGA,MAAA,GAGA,QAAA,GAAA,EAAA,EAAA,GACA,GAAA,GAAA,EAAA,QACA,GAAA,aAAA,OAAA,EACA,GAAA,aAAA,QAAA,EACA,GAAA,YAAA,GAMA,QAAA,GAAA,GACA,GAAA,GAAA,EAAA,EACA,IAAA,GAAA,EAAA,UAAA,SAAA,CACA,GAAA,EAAA,IAAA,EAAA,IAAA,CACA,EAAA,MAAA,QAAA,QACA,WACA,GAAA,EAAA,YAAA,EAAA,CACA,EAAA,OAEA,CACA,WAAA,UAAA,OAAA,aAIA,CACA,EAAA,WAAA,YAAA,KAKA,QAAA,GAAA,GACA,GAAA,GAAA,EAAA,EACA,IAAA,EAAA,CACA,IAAA,GAAA,KAAA,GAAA,CACA,SAAA,GAAA,IAAA,WAAA,CACA,EAAA,GAAA,MAGA,EAAA,WAAA,YAAA,IAMA,QAAA,GAAA,GACA,GAAA,GAAA,IACA,KACA,EAAA,EAAA,eAAA,GAEA,MAAA,IACA,MAAA,GAGA,QAAA,GAAA,GACA,MAAA,GAAA,cAAA,GAMA,QAAA,GAAA,EAAA,EAAA,GACA,EAAA,YAAA,EAAA,EACA,GAAA,EAAA,SAAA,EAAA,EAAA,GAKA,QAAA,GAAA,GACA,GAAA,GAAA,EAAA,GAAA,EAAA,EAAA,MAAA,IACA,GAAA,GAAA,SAAA,EAAA,GAAA,GACA,GAAA,GAAA,SAAA,EAAA,GAAA,KAAA,CACA,GAAA,GAAA,SAAA,EAAA,GAAA,KAAA,CACA,OAAA,GAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,GAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,IAAA,EAAA,GAAA,KAAA,MAMA,QAAA,GAAA,EAAA,EAAA,EAAA,GACA,GAAA,EAAA,IAAA,EAAA,IAAA,CAAA,OACA,GAAA,GAAA,EAAA,qBAAA,QAAA,EACA,KAAA,EAAA,CAAA,OACA,GAAA,GAAA,SAAA,IAAA,SAAA,EAAA,QACA,IAAA,EAAA,CACA,EAAA,IACA,GAAA,KAEA,IAAA,GAAA,GAAA,EAAA,CAEA,GAAA,GAAA,EAAA,QACA,GAAA,aAAA,OAAA,WACA,GAAA,aAAA,QAAA,EACA,GAAA,EAAA,YAAA,EACA,IAAA,EAAA,IAAA,EAAA,WAAA,GAAA,aAAA,GAAA,EAAA,YAAA,OAAA,EAAA,CACA,EAAA,EAAA,YAAA,EAAA,YAAA,OAAA,GAEA,EAAA,EAGA,GAAA,EAAA,IAAA,EAAA,IAAA,CACA,GAAA,SAAA,GAAA,SAAA,EAAA,CACA,EAAA,QAAA,EAAA,QAGA,CACA,GAAA,SAAA,GAAA,gBAAA,EAAA,CACA,EAAA,YAAA,EAAA,eAAA,EAAA,KAAA,EAAA,QAKA,QAAA,GAAA,EAAA,GACA,IAAA,EAAA,CAAA,OACA,GAAA,GAAA,EAAA,UAAA,QACA,IAAA,GAAA,EAAA,GAAA,CACA,EAAA,GAAA,MAAA,WAAA,MAEA,CACA,EAAA,IAAA,EAAA,cAAA,IAMA,QAAA,GAAA,GACA,GAAA,GAAA,aACA,IAAA,GAAA,EAAA,KAAA,IAAA,IACA,OAAA,UAAA,qBAAA,EAAA,mBAAA,GAAA,EAKA,GAAA,GAAA,WACA,GAAA,EAAA,IAAA,EAAA,IAAA,CACA,OAAA,YAAA,WAAA,WAEA,GAAA,GAAA,EAAA,MACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,EAAA,GAAA,GAAA,YAAA,EAAA,GAAA,GAAA,EAAA,GAAA,IAGA,GAAA,GAAA,EAAA,MACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,IAAA,CACA,EAAA,EAAA,IAGA,IAAA,GAAA,KAAA,GAAA,CACA,EAAA,GAAA,KAEA,EAAA,IACA,KAAA,GAAA,KAAA,GAAA,CACA,EAAA,GAAA,KAEA,EAAA,UAKA,QAIA,eAAA,SAAA,EAAA,EAAA,EAAA,GACA,GAAA,EAAA,IAAA,GAAA,EAAA,CACA,GAAA,KACA,GAAA,GAAA,CACA,GAAA,WAAA,CACA,GAAA,eAAA,CACA,GAAA,WAAA,CACA,GAAA,EAAA,QAAA,CACA,GAAA,EAAA,WAEA,IAAA,EAAA,CACA,GAAA,QAAA,MAAA,GAAA,MAIA,cAAA,SAAA,GACA,GAAA,EAAA,GAAA,CACA,MAAA,GAAA,KAIA,SAAA,SAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,GACA,GAAA,IAAA,QAAA,MAAA,GAAA,EACA,IAAA,EAAA,MAAA,EAAA,IAAA,EAAA,GAAA,MAAA,GAAA,GAAA,GAAA,GAAA,EAAA,CACA,EAAA,EAAA,MACA,GAAA,WACA,GAAA,EACA,IAAA,EACA,IAAA,KACA,IAAA,SAAA,KAAA,EAAA,CACA,IAAA,GAAA,KAAA,GAAA,CACA,EAAA,GAAA,EAAA,IAGA,EAAA,KAAA,CACA,GAAA,MAAA,CACA,GAAA,OAAA,CACA,IAAA,KACA,IAAA,SAAA,KAAA,EAAA,CACA,IAAA,GAAA,KAAA,GAAA,CACA,EAAA,GAAA,EAAA,IAGA,GAAA,SAAA,KAAA,EAAA,CACA,IAAA,GAAA,KAAA,GAAA,CACA,SAAA,GAAA,WAAA,EAAA,CACA,EAAA,WAAA,IAAA,EAAA,IAAA,EAAA,OAEA,CACA,EAAA,UAAA,EAAA,IAAA,EAAA,KAIA,GAAA,EAAA,GAAA,CACA,GAAA,GAAA,EAAA,EAAA,EAAA,EACA,IAAA,EAAA,IAAA,EAAA,CACA,EAAA,EAAA,MAEA,EAAA,QAAA,IACA,GAAA,IAAA,MAEA,IAAA,GAAA,IAAA,CACA,EAAA,KAAA,CACA,GAAA,EAAA,EAAA,EAAA,EACA,YAEA,CACA,EAAA,EAAA,MAEA,GAAA,EAAA,CAAA,EAAA,UAGA,IAAA,EAAA,CAAA,EAAA,KAGA,sBAAA,WACA,EAAA,OAGA,GAAA,EAEA,sBAAA,WACA,OAAA,MAAA,EAAA,GAAA,GAAA,MAAA,EAAA,GAAA,GAAA,QAAA,EAAA,GAAA,KAGA,sBAAA,EAEA,UAAA,SAAA,EAAA,EAAA,GACA,GAAA,EAAA,GAAA,CACA,MAAA,GAAA,EAAA,EAAA,OAEA,CACA,MAAA,aAIA,mBAAA,SAAA,EAAA,EAAA,EAAA,GACA,GAAA,EAAA,IAAA,IAAA,CACA,EAAA,EAAA,EAAA,EAAA,KAIA,UAAA,SAAA,GACA,GAAA,EAAA,GAAA,CACA,EAAA,KAIA,UAAA,SAAA,EAAA,EAAA,EAAA,GACA,GAAA,EAAA,GAAA,CACA,EAAA,EAAA,EAAA,EAAA,KAIA,gBAAA,EAEA,aAAA,EAEA,mBAAA,SAAA,GACA,GAAA,GAAA,EAAA,SAAA,QAAA,EAAA,SAAA,IACA,IAAA,EAAA,CACA,GAAA,KAAA,KAAA,GAAA,CAAA,EAAA,EAAA,MAAA,KAAA,GACA,GAAA,GAAA,KAAA,CACA,MAAA,GAAA,GAEA,GAAA,GAAA,EAAA,MAAA,IACA,KAAA,GAAA,GAAA,EAAA,EAAA,EAAA,OAAA,IAAA,CACA,GAAA,EAAA,GAAA,UAAA,EAAA,EAAA,GAAA,QAAA,OAAA,EAAA,CACA,MAAA,GAAA,EAAA,GAAA,UAAA,EAAA,GAAA,QAAA,KAAA,MAIA,MAAA,IAIA,uBAAA,WACA,GAAA,EAAA,CACA,GAAA,GAAA,EAAA,EACA,IAAA,GAAA,EAAA,CACA,EAAA,WAAA,aAAA,EAAA,EACA,IAAA,EAAA,CACA,EAAA,EAAA,KACA,IAAA,EAAA,IAAA,EAAA,IAAA,CAAA,EAAA,MAAA,QAAA,SAEA,GAAA,EAAA,CAAA,EAAA,IAEA,EAAA,WAMA,GAAA,QAAA,mmHC1wBA,GAAM,GAAG,WAAT,QAAM,MAES,EAAA,eAAd,SAA6B,EAAqB,EAAc,GAE/D,EAAQ,MAAM,MAAQ,EAAQ,IAC9B,GAAQ,MAAM,OAAS,EAAS,IAChC,GAAQ,SAAW,CACnB,GAAQ,UAAY,EAGP,GAAA,gBAAd,SAA8B,EAAqB,GAElD,EAAQ,MAAM,MAAQ,EAAQ,IAC9B,GAAQ,SAAW,EAGN,GAAA,iBAAd,SAA+B,EAAqB,GAEnD,EAAQ,MAAM,OAAS,EAAS,IAChC,GAAQ,UAAY,EAGP,GAAA,YAAd,SAA0B,EAAqB,GAE9C,EAAQ,MAAM,SAAW,UACzB,GAAQ,MAAM,KAAO,EAAI,KAGZ,GAAA,YAAd,SAA0B,EAAqB,GAE9C,EAAQ,MAAM,SAAW,UACzB,GAAQ,MAAM,IAAM,EAAI,KAGX,GAAA,qBAAd,SAAmC,GAElC,MAAO,GAAQ,MAAM,YAAc,UAGtB,GAAA,qBAAd,SAAmC,EAAqB,GAEvD,GAAI,EAAS,CACZ,EAAQ,MAAM,WAAa,cACrB,CACN,EAAQ,MAAM,WAAa,UAIf,GAAA,gBAAd,SAA8B,EAAqB,GAElD,GAAI,YAAmB,mBAAmB,CACzC,GAAI,GAA+B,EAAS,WAAW,KACvD,GAAQ,YAAc,GAIV,GAAA,mBAAd,SAAiC,EAAqB,EAAU,EAAU,GAAA,GAAA,QAAA,GAAwB,CAAxB,EAAA,MAEzE,GAAI,EAAU,CACb,EAAQ,MAAM,SAAW,eACnB,CACN,EAAQ,MAAM,SAAW,WAG1B,EAAQ,MAAM,KAAO,EAAI,IACzB,GAAQ,MAAM,IAAM,EAAI,KAE1B,OAAA,KAEa,GAAA,QAAJ,0mBCrET,GAAM,GAAW,WAAjB,QAAM,MAEE,EAAA,KAAc,MACd,GAAA,MAAe,OACf,GAAA,MAAe,OACf,GAAA,OAAgB,QACxB,OAAA,KAEA,GAAqB,QAAZ",
  "file": "CubePrimitive.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "import AwayEvent\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoader\t\t\t\t\t= require(\"awayjs-core/lib/net/URLLoader\");\nimport URLLoaderDataFormat\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport ParserUtils\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport PerspectiveProjection\t\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\nimport ImageTexture\t\t\t\t\t= require(\"awayjs-core/lib/textures/ImageTexture\");\nimport RequestAnimationFrame\t\t= require(\"awayjs-core/lib/utils/RequestAnimationFrame\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport View\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport Mesh\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport BlendMode\t\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\nimport StaticLightPicker\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/StaticLightPicker\");\nimport PrimitiveCubePrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCubePrefab\");\nimport PrimitiveTorusPrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveTorusPrefab\");\n\nimport TriangleMethodMaterial\t\t= require(\"awayjs-renderergl/lib/materials/TriangleMethodMaterial\");\nimport DefaultRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/render/DefaultRenderer\");\n\nclass CubePrimitive\n{\n\tprivate _view:View;\n\tprivate _cube:PrimitiveCubePrefab;\n\tprivate _torus:PrimitiveTorusPrefab;\n\tprivate _mesh:Mesh;\n\tprivate _mesh2:Mesh;\n\tprivate _raf:RequestAnimationFrame;\n\tprivate _image:HTMLImageElement;\n\tprivate _cameraAxis:Vector3D;\n\tprivate _light:DirectionalLight;\n\tprivate _lightPicker:StaticLightPicker;\n\n\tconstructor()\n\t{\n\t\tthis.initView();\n\t\tthis.initCamera();\n\t\tthis.initLights();\n\t\tthis.initGeometry();\n\t\tthis.loadResources();\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initView():void\n\t{\n\t\tthis._view = new View(new DefaultRenderer());\n\t\tthis._view.backgroundColor = 0x000000;\n\t\tthis._view.camera.x = 130;\n\t\tthis._view.camera.y = 0;\n\t\tthis._view.camera.z = 0;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initGeometry():void\n\t{\n\t\tthis._cube = new PrimitiveCubePrefab(20.0, 20.0, 20.0);\n\t\tthis._torus = new PrimitiveTorusPrefab(150, 80, 32, 16, true);\n\n\t\tthis._mesh = <Mesh> this._torus.getNewObject();\n\t\tthis._mesh2 = <Mesh> this._cube.getNewObject();\n\t\tthis._mesh2.x = 130;\n\t\tthis._mesh2.z = 40;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initLights():void\n\t{\n\t\tthis._light = new DirectionalLight();\n\t\tthis._light.color = 0xffffff;\n\t\tthis._light.direction = new Vector3D(1, 0, 0);\n\t\tthis._light.ambient = 0.4;\n\t\tthis._light.ambientColor = 0x85b2cd;\n\t\tthis._light.diffuse = 2.8;\n\t\tthis._light.specular = 1.8;\n\n\t\tthis._lightPicker = new StaticLightPicker([this._light]);\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initCamera():void\n\t{\n\t\tthis._cameraAxis = new Vector3D(0, 0, 1);\n\t\tthis._view.camera.projection = new PerspectiveProjection(120);\n\t\tthis._view.camera.projection.near = 0.1;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate loadResources()\n\t{\n\t\twindow.onresize = (event:UIEvent) => this.onResize(event);\n\t\tthis.onResize();\n\n\t\tthis._raf = new RequestAnimationFrame(this.render, this);\n\t\tthis._raf.start();\n\n\t\tvar urlRequest:URLRequest = new URLRequest(\"assets/spacy_texture.png\");\n\t\tvar imgLoader:URLLoader = new URLLoader();\n\t\timgLoader.dataFormat = URLLoaderDataFormat.BLOB;\n\n\t\timgLoader.addEventListener(AwayEvent.COMPLETE, (event:AwayEvent) => this.urlCompleteHandler(event));\n\t\timgLoader.load(urlRequest);\n\t}\n\n\t/**\n\t *\n\t * @param event\n\t */\n\tprivate urlCompleteHandler(event:AwayEvent)\n\t{\n\t\tvar imageLoader:URLLoader = <URLLoader> event.target;\n\n\t\tthis._image = ParserUtils.blobToImage(imageLoader.data);\n\n\t\tthis._image.onload = (event:Event) => this.imageCompleteHandler(event);\n\t}\n\n\t/**\n\t *\n\t * @param e\n\t */\n\tprivate imageCompleteHandler(event:Event)\n\t{\n\t\tvar ts:ImageTexture = new ImageTexture(this._image, false);\n\t\tvar matTx:TriangleMethodMaterial = new TriangleMethodMaterial(ts, true, true, false);\n\t\tmatTx.blendMode = BlendMode.ADD;\n\t\tmatTx.bothSides = true;\n\t\tmatTx.lightPicker = this._lightPicker;\n\n\t\tthis._mesh.material = matTx;\n\t\tthis._mesh2.material = matTx;\n\n\t\tthis._view.scene.addChild(this._mesh);\n\t\tthis._view.scene.addChild(this._mesh2);\n\n\t}\n\n\t/**\n\t *\n\t * @param dt\n\t */\n\tpublic render(dt:number = null):void\n\t{\n\t\tthis._view.camera.rotate(this._cameraAxis, 1);\n\t\tthis._mesh.rotationY += 1;\n\t\tthis._mesh2.rotationX += 0.4;\n\t\tthis._mesh2.rotationY += 0.4;\n\t\tthis._view.render();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onResize(event:UIEvent = null)\n\t{\n\t\tthis._view.y = 0;\n\t\tthis._view.x = 0;\n\n\t\tthis._view.width = window.innerWidth;\n\t\tthis._view.height = window.innerHeight;\n\t}\n}\n\nwindow.onload = function()\n{\n\tnew CubePrimitive();\n}\n",
    "import ColorTransform\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Matrix\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Point\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport ColorUtils\t\t\t\t= require(\"awayjs-core/lib/utils/ColorUtils\");\n\n/**\n *\n */\nclass BitmapData\n{\n\tprivate _imageCanvas:HTMLCanvasElement;\n\tprivate _context:CanvasRenderingContext2D;\n\tprivate _imageData:ImageData;\n\tprivate _rect:Rectangle;\n\tprivate _transparent:boolean;\n\tprivate _alpha:number = 0;\n\tprivate _locked:boolean = false;\n\n\n\t/**\n\t *\n\t * @param width\n\t * @param height\n\t * @param transparent\n\t * @param fillColor\n\t */\n\tconstructor(width:number, height:number, transparent:boolean = true, fillColor:number = null)\n\t{\n\n\t\tthis._transparent = transparent;\n\t\tthis._imageCanvas = <HTMLCanvasElement> document.createElement(\"canvas\");\n\t\tthis._imageCanvas.width = width;\n\t\tthis._imageCanvas.height = height;\n\t\tthis._context = this._imageCanvas.getContext(\"2d\");\n\t\tthis._rect = new Rectangle(0, 0, width, height);\n\n\t\tif (fillColor != null) {\n\n\t\t\tif (this._transparent) {\n\t\t\t\tthis._alpha = ColorUtils.float32ColorToARGB(fillColor)[0]/255;\n\t\t\t} else {\n\t\t\t\tthis._alpha = 1;\n\t\t\t}\n\n\t\t\tthis.fillRect(this._rect, fillColor);\n\n\t\t}\n\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._context = null;\n\t\tthis._imageCanvas = null;\n\t\tthis._imageData = null;\n\t\tthis._rect = null;\n\t\tthis._transparent = null;\n\t\tthis._locked = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic lock()\n\t{\n\t\tthis._locked = true;\n\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic unlock()\n\t{\n\t\tthis._locked = false;\n\n\t\tif (this._imageData) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0); // at coords 0,0\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param x\n\t * @param y\n\t * @param color\n\t */\n\tpublic getPixel(x, y):number\n\t{\n\t\tvar r:number;\n\t\tvar g:number;\n\t\tvar b:number;\n\t\tvar a:number;\n\n\t\tif (!this._locked) {\n\t\t\tvar pixelData:ImageData = this._context.getImageData(x, y, 1, 1);\n\n\t\t\tr = pixelData.data[0];\n\t\t\tg = pixelData.data[1];\n\t\t\tb = pixelData.data[2];\n\t\t\ta = pixelData.data[3];\n\n\t\t} else {\n\t\t\tvar index:number = (x + y*this._imageCanvas.width)*4;\n\n\t\t\tif (!this._imageData)\n\t\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\t\tr = this._imageData.data[index + 0];\n\t\t\tg = this._imageData.data[index + 1];\n\t\t\tb = this._imageData.data[index + 2];\n\t\t\ta = this._imageData.data[index + 3];\n\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._imageData = null;\n\t\t}\n\n\t\treturn (a << 24) | (r << 16) | (g << 8) | b;\n\t}\n\n\t/**\n\t *\n\t * @param x\n\t * @param y\n\t * @param color\n\t */\n\tpublic setPixel(x, y, color:number)\n\t{\n\t\tvar argb:number[] = ColorUtils.float32ColorToARGB(color);\n\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tvar index:number = (x + y*this._imageCanvas.width)*4;\n\n\t\t\tthis._imageData.data[index + 0] = argb[1];\n\t\t\tthis._imageData.data[index + 1] = argb[2];\n\t\t\tthis._imageData.data[index + 2] = argb[3];\n\t\t\tthis._imageData.data[index + 3] = 255;\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param rect\n\t * @param inputByteArray\n\t */\n\tpublic setPixels(rect:Rectangle, inputByteArray:ByteArray)\n\t{\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tinputByteArray.position = 0;\n\t\t\tvar i:number /*uint*/, j:number /*uint*/, index:number /*uint*/;\n\t\t\tfor (i = 0; i < rect.width; ++i) {\n\t\t\t\tfor (j = 0; j < rect.height; ++j) {\n\t\t\t\t\tindex = (i + rect.x + (j + rect.y)*this._imageCanvas.width)*4;\n\n\t\t\t\t\tthis._imageData.data[index + 0] = inputByteArray.readUnsignedInt();\n\t\t\t\t\tthis._imageData.data[index + 1] = inputByteArray.readUnsignedInt();\n\t\t\t\t\tthis._imageData.data[index + 2] = inputByteArray.readUnsignedInt();\n\t\t\t\t\tthis._imageData.data[index + 3] = inputByteArray.readUnsignedInt();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param x\n\t * @param y\n\t * @param color\n\t */\n\tpublic setPixel32(x, y, color:number)\n\t{\n\t\tvar argb:number[] = ColorUtils.float32ColorToARGB(color);\n\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tvar index:number = (x + y*this._imageCanvas.width)*4;\n\n\t\t\tthis._imageData.data[index + 0] = argb[1];\n\t\t\tthis._imageData.data[index + 1] = argb[2];\n\t\t\tthis._imageData.data[index + 2] = argb[3];\n\t\t\tthis._imageData.data[index + 3] = argb[0];\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\tpublic setVector(rect:Rectangle, inputVector:Array<number>)\n\t{\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tvar i:number /*uint*/, j:number /*uint*/, index:number /*uint*/, argb:number[] /*uint*/;\n\t\t\tfor (i = 0; i < rect.width; ++i) {\n\t\t\t\tfor (j = 0; j < rect.height; ++j) {\n\t\t\t\t\targb = ColorUtils.float32ColorToARGB(inputVector[i + j*rect.width]);\n\t\t\t\t\tindex = (i + rect.x + (j + rect.y)*this._imageCanvas.width)*4;\n\n\t\t\t\t\tthis._imageData.data[index + 0] = argb[1];\n\t\t\t\t\tthis._imageData.data[index + 1] = argb[2];\n\t\t\t\t\tthis._imageData.data[index + 2] = argb[3];\n\t\t\t\t\tthis._imageData.data[index + 3] = argb[0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\t/**\n\t * Copy an HTMLImageElement or BitmapData object\n\t *\n\t * @param img {BitmapData} / {HTMLImageElement}\n\t * @param sourceRect - source rectange to copy from\n\t * @param destRect - destinatoin rectange to copy to\n\t */\n\tpublic drawImage(img:BitmapData, sourceRect:Rectangle, destRect:Rectangle);\n\tpublic drawImage(img:HTMLImageElement, sourceRect:Rectangle, destRect:Rectangle);\n\tpublic drawImage(img:any, sourceRect:Rectangle, destRect:Rectangle)\n\t{\n\t\tif (this._locked) {\n\t\t\t// If canvas is locked:\n\t\t\t//\n\t\t\t//      1) copy image data back to canvas\n\t\t\t//      2) draw object\n\t\t\t//      3) read _imageData back out\n\n\t\t\tif (this._imageData) {\n\t\t\t\tthis._context.putImageData(this._imageData, 0, 0); // at coords 0,0\n\t\t\t}\n\n\t\t\tthis._drawImage(img, sourceRect, destRect);\n\n\t\t\tif (this._imageData) {\n\t\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\t\t\t}\n\n\t\t} else {\n\t\t\tthis._drawImage(img, sourceRect, destRect)\n\t\t}\n\t}\n\n\tprivate _drawImage(img:BitmapData, sourceRect:Rectangle, destRect:Rectangle);\n\tprivate _drawImage(img:HTMLImageElement, sourceRect:Rectangle, destRect:Rectangle);\n\tprivate _drawImage(img:any, sourceRect:Rectangle, destRect:Rectangle)\n\t{\n\t\tif (img instanceof BitmapData)\n\t\t\tthis._context.drawImage(img.canvas, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height, destRect.x, destRect.y, destRect.width, destRect.height);\n\t\telse if (img instanceof HTMLImageElement)\n\t\t\tthis._context.drawImage(img, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height, destRect.x, destRect.y, destRect.width, destRect.height);\n\t}\n\n\t/**\n\t *\n\t * @param bmpd\n\t * @param sourceRect\n\t * @param destRect\n\t */\n\tpublic copyPixels(bmpd:BitmapData, sourceRect:Rectangle, destRect:Rectangle);\n\tpublic copyPixels(bmpd:HTMLImageElement, sourceRect:Rectangle, destRect:Rectangle);\n\tpublic copyPixels(bmpd:any, sourceRect:Rectangle, destRect:Rectangle)\n\t{\n\n\t\tif (this._locked) {\n\n\t\t\t// If canvas is locked:\n\t\t\t//\n\t\t\t//      1) copy image data back to canvas\n\t\t\t//      2) draw object\n\t\t\t//      3) read _imageData back out\n\n\t\t\tif (this._imageData) {\n\t\t\t\tthis._context.putImageData(this._imageData, 0, 0); // at coords 0,0\n\t\t\t}\n\n\t\t\tthis._copyPixels(bmpd, sourceRect, destRect);\n\n\t\t\tif (this._imageData) {\n\t\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\t\t\t}\n\t\t} else {\n\t\t\tthis._copyPixels(bmpd, sourceRect, destRect);\n\t\t}\n\n\t}\n\n\tprivate _copyPixels(bmpd:BitmapData, sourceRect:Rectangle, destRect:Rectangle);\n\tprivate _copyPixels(bmpd:HTMLImageElement, sourceRect:Rectangle, destRect:Rectangle);\n\tprivate _copyPixels(bmpd:any, sourceRect:Rectangle, destRect:Rectangle)\n\t{\n\n\t\tif (bmpd instanceof BitmapData) {\n\t\t\tthis._context.drawImage(bmpd.canvas, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height, destRect.x, destRect.y, destRect.width, destRect.height);\n\t\t} else if (bmpd instanceof HTMLImageElement) {\n\t\t\tthis._context.drawImage(bmpd, sourceRect.x, sourceRect.y, sourceRect.width, sourceRect.height, destRect.x, destRect.y, destRect.width, destRect.height);\n\t\t}\n\n\t}\n\n\t/**\n\t *\n\t * @param rect\n\t * @param color\n\t */\n\tpublic fillRect(rect:Rectangle, color:number)\n\t{\n\t\tif (this._locked) {\n\n\t\t\t// If canvas is locked:\n\t\t\t//\n\t\t\t//      1) copy image data back to canvas\n\t\t\t//      2) apply fill\n\t\t\t//      3) read _imageData back out\n\n\t\t\tif (this._imageData)\n\t\t\t\tthis._context.putImageData(this._imageData, 0, 0); // at coords 0,0\n\n\t\t\tthis._context.fillStyle = this.hexToRGBACSS(color);\n\t\t\tthis._context.fillRect(rect.x, rect.y, rect.width, rect.height);\n\n\t\t\tif (this._imageData)\n\t\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\t\t} else {\n\t\t\tthis._context.fillStyle = this.hexToRGBACSS(color);\n\t\t\tthis._context.fillRect(rect.x, rect.y, rect.width, rect.height);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param source\n\t * @param matrix\n\t */\n\tpublic draw(source:BitmapData, matrix?:Matrix);\n\tpublic draw(source:HTMLImageElement, matrix?:Matrix);\n\tpublic draw(source:any, matrix?:Matrix)\n\t{\n\t\tif (this._locked) {\n\n\t\t\t// If canvas is locked:\n\t\t\t//\n\t\t\t//      1) copy image data back to canvas\n\t\t\t//      2) draw object\n\t\t\t//      3) read _imageData back out\n\n\t\t\tif (this._imageData)\n\t\t\t\tthis._context.putImageData(this._imageData, 0, 0); // at coords 0,0\n\n\t\t\tthis._draw(source, matrix);\n\n\t\t\tif (this._imageData)\n\t\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\t\t} else {\n\t\t\tthis._draw(source, matrix);\n\t\t}\n\t}\n\n\tprivate _draw(source:BitmapData, matrix:Matrix);\n\tprivate _draw(source:HTMLImageElement, matrix:Matrix);\n\tprivate _draw(source:any, matrix:Matrix)\n\t{\n\t\tif (source instanceof BitmapData) {\n\t\t\tthis._context.save();\n\n\t\t\tif (matrix != null)\n\t\t\t\tthis._context.setTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);\n\n\t\t\tthis._context.drawImage(source.canvas, 0, 0)\n\t\t\tthis._context.restore();\n\n\t\t} else if (source instanceof HTMLImageElement) {\n\t\t\tthis._context.save();\n\n\t\t\tif (matrix != null)\n\t\t\t\tthis._context.setTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);\n\n\t\t\tthis._context.drawImage(source, 0, 0)\n\t\t\tthis._context.restore();\n\t\t}\n\n\t}\n\n\tpublic copyChannel(sourceBitmap:BitmapData, sourceRect:Rectangle, destPoint:Point, sourceChannel:number, destChannel:number)\n\t{\n\t\tvar imageData:ImageData = sourceBitmap.imageData;\n\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tvar sourceData:Array<number> = sourceBitmap.imageData.data;\n\t\t\tvar destData:Array<number> = this._imageData.data;\n\n\t\t\tvar sourceOffset:number = Math.round(Math.log(sourceChannel)/Math.log(2));\n\t\t\tvar destOffset:number = Math.round(Math.log(destChannel)/Math.log(2));\n\n\t\t\tvar i:number /*uint*/, j:number /*uint*/, sourceIndex:number /*uint*/, destIndex:number /*uint*/;\n\t\t\tfor (i = 0; i < sourceRect.width; ++i) {\n\t\t\t\tfor (j = 0; j < sourceRect.height; ++j) {\n\t\t\t\t\tsourceIndex = (i + sourceRect.x + (j + sourceRect.y)*sourceBitmap.width)*4;\n\t\t\t\t\tdestIndex = (i + destPoint.x + (j + destPoint.y)*this.width)*4;\n\n\t\t\t\t\tdestData[destIndex + destOffset] = sourceData[sourceIndex + sourceOffset];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\tpublic colorTransform(rect:Rectangle, colorTransform:ColorTransform)\n\t{\n\t\tif (!this._locked)\n\t\t\tthis._imageData = this._context.getImageData(0, 0, this._rect.width, this._rect.height);\n\n\t\tif (this._imageData) {\n\t\t\tvar data:Array<number> = this._imageData.data;\n\n\t\t\tvar i:number /*uint*/, j:number /*uint*/, index:number /*uint*/;\n\t\t\tfor (i = 0; i < rect.width; ++i) {\n\t\t\t\tfor (j = 0; j < rect.height; ++j) {\n\t\t\t\t\tindex = (i + rect.x + (j + rect.y)*this.width)*4;\n\n\t\t\t\t\tdata[index] = data[index]*colorTransform.redMultiplier + colorTransform.redOffset;\n\t\t\t\t\tdata[index + 1] = data[index + 1]*colorTransform.greenMultiplier + colorTransform.greenOffset;\n\t\t\t\t\tdata[index + 2] = data[index + 2]*colorTransform.blueMultiplier + colorTransform.blueOffset;\n\t\t\t\t\tdata[index + 3] = data[index + 3]*colorTransform.alphaMultiplier + colorTransform.alphaOffset;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!this._locked) {\n\t\t\tthis._context.putImageData(this._imageData, 0, 0);\n\t\t\tthis._imageData = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param {ImageData}\n\t */\n\tpublic set imageData(value:ImageData)\n\t{\n\t\tthis._context.putImageData(value, 0, 0);\n\t}\n\n\t/**\n\t *\n\t * @returns {ImageData}\n\t */\n\tpublic get imageData():ImageData\n\t{\n\t\treturn this._context.getImageData(0, 0, this._rect.width, this._rect.height)\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get width():number\n\t{\n\t\treturn <number> this._imageCanvas.width;\n\t}\n\n\t/**\n\t *\n\t * @param {number}\n\t */\n\tpublic set width(value:number)\n\t{\n\t\tthis._rect.width = value;\n\t\tthis._imageCanvas.width = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get height():number\n\t{\n\t\treturn <number> this._imageCanvas.height;\n\t}\n\n\t/**\n\t *\n\t * @param {number}\n\t */\n\tpublic set height(value:number)\n\t{\n\t\tthis._rect.height = value;\n\t\tthis._imageCanvas.height = value;\n\t}\n\n\t/**\n\t *\n\t * @param {Rectangle}\n\t */\n\tpublic get rect():Rectangle\n\t{\n\t\treturn this._rect;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLCanvasElement}\n\t */\n\tpublic get canvas()\n\t{\n\t\treturn this._imageCanvas;\n\t}\n\n\t/**\n\t *\n\t * @returns {HTMLCanvasElement}\n\t */\n\tpublic get context():CanvasRenderingContext2D\n\t{\n\t\treturn this._context;\n\t}\n\n\t// Private\n\n\t/**\n\t * convert decimal value to Hex\n\t */\n\tprivate hexToRGBACSS(d:number):string\n\t{\n\t\tvar argb:number[] = ColorUtils.float32ColorToARGB(d);\n\n\t\tif (this._transparent == false) {\n\t\t\targb[0] = 1;\n\n\t\t\treturn 'rgba(' + argb[1] + ',' + argb[2] + ',' + argb[3] + ',' + argb[0] + ')';\n\t\t}\n\n\t\treturn 'rgba(' + argb[1] + ',' + argb[2] + ',' + argb[3] + ',' + argb[0]/255 + ')';\n\t}\n}\n\nexport = BitmapData;",
    "import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\n/**\n * AbstractMethodError is thrown when an abstract method is called. The method in question should be overridden\n * by a concrete subclass.\n */\nclass AbstractMethodError extends Error\n{\n\t/**\n\t * Create a new AbstractMethodError.\n\t * @param message An optional message to override the default error message.\n\t * @param id The id of the error.\n\t */\n\tconstructor(message:string = null, id:number = 0)\n\t{\n\t\tsuper(message || \"An abstract method was called! Either an instance of an abstract class was created, or an abstract method was not overridden by the subclass.\", id);\n\t}\n}\n\nexport = AbstractMethodError;",
    "import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\n/**\n * AbstractMethodError is thrown when an abstract method is called. The method in question should be overridden\n * by a concrete subclass.\n */\nclass ArgumentError extends Error\n{\n\t/**\n\t * Create a new ArgumentError.\n\t *\n\t * @param message An optional message to override the default error message.\n\t * @param id The id of the error.\n\t */\n\tconstructor(message:string = null, id:number = 0)\n\t{\n\t\tsuper(message || \"ArgumentError\", id);\n\t}\n}\n\nexport = ArgumentError;",
    "class Error\n{\n\n\tprivate _errorID:number = 0;   //Contains the reference number associated with the specific error message.\n\tprivate _messsage:string = '';  //Contains the message associated with the Error object.\n\tprivate _name:string = '';  // Contains the name of the Error object.\n\n\tconstructor(message:string = '', id:number = 0, _name:string = '')\n\t{\n\n\t\tthis._messsage = message;\n\t\tthis._name = name;\n\t\tthis._errorID = id;\n\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic get message():string\n\t{\n\n\t\treturn this._messsage;\n\n\t}\n\n\t/**\n\t *\n\t * @param value\n\t */\n\tpublic set message(value:string)\n\t{\n\n\t\tthis._messsage = value;\n\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic get name():string\n\t{\n\n\t\treturn this._name;\n\n\t}\n\n\t/**\n\t *\n\t * @param value\n\t */\n\tpublic set name(value:string)\n\t{\n\n\t\tthis._name = value;\n\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get errorID():number\n\t{\n\n\t\treturn this._errorID;\n\n\t}\n\n}\n\nexport = Error;",
    "import IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\n/**\n * @class away.events.AssetEvent\n */\nclass AssetEvent extends Event\n{\n\t/**\n\t *\n\t */\n\tpublic static ASSET_COMPLETE:string = \"assetComplete\";\n\n\t/**\n\t *\n\t */\n\tpublic static ASSET_RENAME:string = 'assetRename';\n\n\t/**\n\t *\n\t */\n\tpublic static ASSET_CONFLICT_RESOLVED:string = 'assetConflictResolved';\n\n\t/**\n\t *\n\t */\n\tpublic static TEXTURE_SIZE_ERROR:string = 'textureSizeError';\n\n\tprivate _asset:IAsset;\n\tprivate _prevName:string;\n\n\t/**\n\t *\n\t */\n\tconstructor(type:string, asset:IAsset = null, prevName:string = null)\n\t{\n\t\tsuper(type);\n\n\t\tthis._asset = asset;\n\t\tthis._prevName = prevName || (this._asset? this._asset.name : null);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get asset():IAsset\n\t{\n\t\treturn this._asset;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get assetPrevName():string\n\t{\n\t\treturn this._prevName;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn <Event> new AssetEvent(this.type, this.asset, this.assetPrevName);\n\t}\n}\n\nexport = AssetEvent;",
    "class Event\n{\n\n\tpublic static COMPLETE:string = 'complete';\n\tpublic static OPEN:string = 'open';\n\n\tpublic static ENTER_FRAME:string = 'enterFrame';\n\tpublic static EXIT_FRAME:string = 'exitFrame';\n\n\n\tpublic static RESIZE:string = \"resize\";\n\tpublic static ERROR:string = \"error\";\n\tpublic static CHANGE:string = \"change\";\n\n\t/**\n\t * Type of event\n\t * @property type\n\t * @type String\n\t */\n\tpublic type:string = undefined;\n\n\t/**\n\t * Reference to target object\n\t * @property target\n\t * @type Object\n\t */\n\tpublic target:any = undefined;\n\n\tconstructor(type:string)\n\t{\n\t\tthis.type = type;\n\t}\n\n\t/**\n\t * Clones the current event.\n\t * @return An exact duplicate of the current event.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new Event(this.type);\n\t}\n}\n\nexport = Event;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\n/**\n * Base class for dispatching events\n*\n* @class away.events.EventDispatcher\n*\n*/\nclass EventDispatcher\n{\n\tprivate listeners:Array<Array<Function>> = new Array<Array<Function>>();\n\tprivate target:any;\n\n\tconstructor(target:any = null)\n\t{\n\t\tthis.target = target || this;\n\t}\n\n\t/**\n\t * Add an event listener\n\t * @method addEventListener\n\t * @param {String} Name of event to add a listener for\n\t * @param {Function} Callback function\n\t */\n\tpublic addEventListener(type:string, listener:Function)\n\t{\n\t\tif (this.listeners[ type ] === undefined)\n\t\t\tthis.listeners[ type ] = new Array<Function>();\n\n\t\tif (this.getEventListenerIndex(type, listener) === -1)\n\t\t\tthis.listeners[ type ].push(listener);\n\t}\n\n\t/**\n\t * Remove an event listener\n\t * @method removeEventListener\n\t * @param {String} Name of event to remove a listener for\n\t * @param {Function} Callback function\n\t */\n\tpublic removeEventListener(type:string, listener:Function)\n\t{\n\t\tvar index:number = this.getEventListenerIndex(type, listener);\n\n\t\tif (index !== -1)\n\t\t\tthis.listeners[ type ].splice(index, 1);\n\t}\n\n\t/**\n\t * Dispatch an event\n\t * @method dispatchEvent\n\t * @param {Event} Event to dispatch\n\t */\n\tpublic dispatchEvent(event:Event)\n\t{\n\t\tvar listenerArray:Array<Function> = this.listeners[ event.type ];\n\n\t\tif (listenerArray !== undefined) {\n\t\t\tvar l:number = listenerArray.length;\n\n\t\t\tevent.target = this.target;\n\n\t\t\tfor (var i:number = 0; i < l; i++)\n\t\t\t\tlistenerArray[i](event);\n\t\t}\n\t}\n\n\t/**\n\t * get Event Listener Index in array. Returns -1 if no listener is added\n\t * @method getEventListenerIndex\n\t * @param {String} Name of event to remove a listener for\n\t * @param {Function} Callback function\n\t */\n\tprivate getEventListenerIndex(type:string, listener:Function):number\n\t{\n\t\tif (this.listeners[ type ] !== undefined) {\n\t\t\tvar a:Array<Function> = this.listeners[ type ];\n\t\t\tvar l:number = a.length;\n\n\t\t\tfor (var i:number = 0; i < l; i++)\n\t\t\t\tif (listener == a[i])\n\t\t\t\t\treturn i;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * check if an object has an event listener assigned to it\n\t * @method hasListener\n\t * @param {String} Name of event to remove a listener for\n\t * @param {Function} Callback function\n\t */\n\tpublic hasEventListener(type:string, listener?:Function):boolean\n\t{\n\t\tif (listener != null) {\n\t\t\treturn ( this.getEventListenerIndex(type, listener) !== -1 );\n\t\t} else {\n\t\t\tif (this.listeners[ type ] !== undefined)\n\t\t\t\treturn ( this.listeners[ type ].length > 0 );\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nexport = EventDispatcher;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\n/**\n * @class away.events.HTTPStatusEvent\n */\nclass HTTPStatusEvent extends Event\n{\n\n\tpublic static HTTP_STATUS:string = \"httpStatus\";\n\n\tpublic status:number;\n\n\tconstructor(type:string, status:number = null)\n\t{\n\t\tsuper(type);\n\n\t\tthis.status = status;\n\n\t}\n}\n\nexport = HTTPStatusEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass IOErrorEvent extends Event\n{\n\n\tpublic static IO_ERROR:string = \"ioError\";\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\n\t}\n}\n\nexport = IOErrorEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass ProgressEvent extends Event\n{\n\tpublic static PROGRESS:string = \"progress\";\n\n\tpublic bytesLoaded:number;\n\n\tpublic bytesTotal:number;\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n}\n\nexport = ProgressEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport IProjection\t\t\t\t= require(\"awayjs-core/lib/projections/IProjection\");\n\nclass ProjectionEvent extends Event\n{\n\tpublic static MATRIX_CHANGED:string = \"matrixChanged\";\n\n\tprivate _projection:IProjection;\n\n\tconstructor(type:string, projection:IProjection)\n\t{\n\t\tsuper(type);\n\t\tthis._projection = projection;\n\t}\n\n\tpublic get projection():IProjection\n\t{\n\t\treturn this._projection;\n\t}\n}\n\nexport = ProjectionEvent;",
    "import Point\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ArgumentError\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\n/**\n * The Matrix class represents a transformation matrix that determines how to\n * map points from one coordinate space to another. You can perform various\n * graphical transformations on a display object by setting the properties of\n * a Matrix object, applying that Matrix object to the <code>matrix</code>\n * property of a Transform object, and then applying that Transform object as\n * the <code>transform</code> property of the display object. These\n * transformation functions include translation(<i>x</i> and <i>y</i>\n * repositioning), rotation, scaling, and skewing.\n *\n * <p>Together these types of transformations are known as <i>affine\n * transformations</i>. Affine transformations preserve the straightness of\n * lines while transforming, so that parallel lines stay parallel.</p>\n *\n * <p>To apply a transformation matrix to a display object, you create a\n * Transform object, set its <code>matrix</code> property to the\n * transformation matrix, and then set the <code>transform</code> property of\n * the display object to the Transform object. Matrix objects are also used as\n * parameters of some methods, such as the following:</p>\n *\n * <ul>\n *   <li>The <code>draw()</code> method of a BitmapData object</li>\n *   <li>The <code>beginBitmapFill()</code> method,\n * <code>beginGradientFill()</code> method, or\n * <code>lineGradientStyle()</code> method of a Graphics object</li>\n * </ul>\n *\n * <p>A transformation matrix object is a 3 x 3 matrix with the following\n * contents:</p>\n *\n * <p>In traditional transformation matrixes, the <code>u</code>,\n * <code>v</code>, and <code>w</code> properties provide extra capabilities.\n * The Matrix class can only operate in two-dimensional space, so it always\n * assumes that the property values <code>u</code> and <code>v</code> are 0.0,\n * and that the property value <code>w</code> is 1.0. The effective values of\n * the matrix are as follows:</p>\n *\n * <p>You can get and set the values of all six of the other properties in a\n * Matrix object: <code>a</code>, <code>b</code>, <code>c</code>,\n * <code>d</code>, <code>tx</code>, and <code>ty</code>.</p>\n *\n * <p>The Matrix class supports the four major types of transformations:\n * translation, scaling, rotation, and skewing. You can set three of these\n * transformations by using specialized methods, as described in the following\n * table: </p>\n *\n * <p>Each transformation function alters the current matrix properties so\n * that you can effectively combine multiple transformations. To do this, you\n * call more than one transformation function before applying the matrix to\n * its display object target(by using the <code>transform</code> property of\n * that display object).</p>\n *\n * <p>Use the <code>new Matrix()</code> constructor to create a Matrix object\n * before you can call the methods of the Matrix object.</p>\n */\nclass Matrix\n{\n\t/**\n\t * The value that affects the positioning of pixels along the <i>x</i> axis\n\t * when scaling or rotating an image.\n\t */\n\tpublic a:number;\n\n\t/**\n\t * The value that affects the positioning of pixels along the <i>y</i> axis\n\t * when rotating or skewing an image.\n\t */\n\tpublic b:number;\n\n\t/**\n\t * The value that affects the positioning of pixels along the <i>x</i> axis\n\t * when rotating or skewing an image.\n\t */\n\tpublic c:number;\n\n\t/**\n\t * The value that affects the positioning of pixels along the <i>y</i> axis\n\t * when scaling or rotating an image.\n\t */\n\tpublic d:number;\n\n\t/**\n\t * The distance by which to translate each point along the <i>x</i> axis.\n\t */\n\tpublic tx:number;\n\n\t/**\n\t * The distance by which to translate each point along the <i>y</i> axis.\n\t */\n\tpublic ty:number;\n\n\t/**\n\t * Creates a new Matrix object with the specified parameters. In matrix\n\t * notation, the properties are organized like this:\n\t *\n\t * <p>If you do not provide any parameters to the <code>new Matrix()</code>\n\t * constructor, it creates an <i>identity matrix</i> with the following\n\t * values:</p>\n\t *\n\t * <p>In matrix notation, the identity matrix looks like this:</p>\n\t *\n\t * @param a  The value that affects the positioning of pixels along the\n\t *           <i>x</i> axis when scaling or rotating an image.\n\t * @param b  The value that affects the positioning of pixels along the\n\t *           <i>y</i> axis when rotating or skewing an image.\n\t * @param c  The value that affects the positioning of pixels along the\n\t *           <i>x</i> axis when rotating or skewing an image.\n\t * @param d  The value that affects the positioning of pixels along the\n\t *           <i>y</i> axis when scaling or rotating an image..\n\t * @param tx The distance by which to translate each point along the <i>x</i>\n\t *           axis.\n\t * @param ty The distance by which to translate each point along the <i>y</i>\n\t *           axis.\n\t */\n\tconstructor(a:number = 1, b:number = 0, c:number = 0, d:number = 1, tx:number = 0, ty:number = 0)\n\t{\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\t\tthis.d = d;\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t}\n\n\t/**\n\t * Returns a new Matrix object that is a clone of this matrix, with an exact\n\t * copy of the contained object.\n\t *\n\t * @return A Matrix object.\n\t */\n\tpublic clone():Matrix\n\t{\n\t\treturn new Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty);\n\t}\n\n\t/**\n\t * Concatenates a matrix with the current matrix, effectively combining the\n\t * geometric effects of the two. In mathematical terms, concatenating two\n\t * matrixes is the same as combining them using matrix multiplication.\n\t *\n\t * <p>For example, if matrix <code>m1</code> scales an object by a factor of\n\t * four, and matrix <code>m2</code> rotates an object by 1.5707963267949\n\t * radians(<code>Math.PI/2</code>), then <code>m1.concat(m2)</code>\n\t * transforms <code>m1</code> into a matrix that scales an object by a factor\n\t * of four and rotates the object by <code>Math.PI/2</code> radians. </p>\n\t *\n\t * <p>This method replaces the source matrix with the concatenated matrix. If\n\t * you want to concatenate two matrixes without altering either of the two\n\t * source matrixes, first copy the source matrix by using the\n\t * <code>clone()</code> method, as shown in the Class Examples section.</p>\n\t *\n\t * @param matrix The matrix to be concatenated to the source matrix.\n\t */\n\tpublic concat(matrix:Matrix):void\n\t{\n\t\tvar a1 = this.a*matrix.a + this.b*matrix.c;\n\t\tthis.b = this.a*matrix.b + this.b*matrix.d;\n\t\tthis.a = a1;\n\n\t\tvar c1 = this.c*matrix.a + this.d*matrix.c;\n\t\tthis.d = this.c*matrix.b + this.d*matrix.d;\n\n\t\tthis.c = c1;\n\n\t\tvar tx1 = this.tx*matrix.a + this.ty*matrix.c + matrix.tx;\n\t\tthis.ty = this.tx*matrix.b + this.ty*matrix.d + matrix.ty;\n\t\tthis.tx = tx1;\n\t}\n\n\t/**\n\t * Copies a Vector3D object into specific column of the calling Matrix3D\n\t * object.\n\t *\n\t * @param column   The column from which to copy the data from.\n\t * @param vector3D The Vector3D object from which to copy the data.\n\t */\n\tpublic copyColumnFrom(column:number, vector3D:Vector3D):void\n\t{\n\t\tif (column > 2) {\n\t\t\tthrow \"Column \" + column + \" out of bounds (2)\";\n\t\t} else if (column == 0) {\n\t\t\tthis.a = vector3D.x;\n\t\t\tthis.c = vector3D.y;\n\t\t} else if (column == 1) {\n\t\t\tthis.b = vector3D.x;\n\t\t\tthis.d = vector3D.y;\n\t\t} else {\n\t\t\tthis.tx = vector3D.x;\n\t\t\tthis.ty = vector3D.y;\n\t\t}\n\t}\n\n\t/**\n\t * Copies specific column of the calling Matrix object into the Vector3D\n\t * object. The w element of the Vector3D object will not be changed.\n\t *\n\t * @param column   The column from which to copy the data from.\n\t * @param vector3D The Vector3D object from which to copy the data.\n\t */\n\tpublic copyColumnTo(column:number, vector3D:Vector3D):void\n\t{\n\t\tif (column > 2) {\n\t\t\tthrow new ArgumentError(\"ArgumentError, Column \" + column + \" out of bounds [0, ..., 2]\");\n\t\t} else if (column == 0) {\n\t\t\tvector3D.x = this.a;\n\t\t\tvector3D.y = this.c;\n\t\t\tvector3D.z = 0;\n\t\t} else if (column == 1) {\n\t\t\tvector3D.x = this.b;\n\t\t\tvector3D.y = this.d;\n\t\t\tvector3D.z = 0;\n\t\t} else {\n\t\t\tvector3D.x = this.tx;\n\t\t\tvector3D.y = this.ty;\n\t\t\tvector3D.z = 1;\n\t\t}\n\t}\n\n\t/**\n\t * Copies all of the matrix data from the source Point object into the\n\t * calling Matrix object.\n\t *\n\t * @param sourceMatrix The Matrix object from which to copy the data.\n\t */\n\tpublic copyFrom(sourceMatrix:Matrix):void\n\t{\n\t\tthis.a = sourceMatrix.a;\n\t\tthis.b = sourceMatrix.b;\n\t\tthis.c = sourceMatrix.c;\n\t\tthis.d = sourceMatrix.d;\n\t\tthis.tx = sourceMatrix.tx;\n\t\tthis.ty = sourceMatrix.ty;\n\t}\n\n\t/**\n\t * Copies a Vector3D object into specific row of the calling Matrix object.\n\t *\n\t * @param row      The row from which to copy the data from.\n\t * @param vector3D The Vector3D object from which to copy the data.\n\t */\n\tpublic copyRowFrom(row:number, vector3D:Vector3D):void\n\t{\n\t\tif (row > 2) {\n\t\t\tthrow new ArgumentError(\"ArgumentError, Row \" + row + \" out of bounds [0, ..., 2]\");\n\t\t} else if (row == 0) {\n\t\t\tthis.a = vector3D.x;\n\t\t\tthis.c = vector3D.y;\n\t\t} else if (row == 1) {\n\t\t\tthis.b = vector3D.x;\n\t\t\tthis.d = vector3D.y;\n\t\t} else {\n\t\t\tthis.tx = vector3D.x;\n\t\t\tthis.ty = vector3D.y;\n\t\t}\n\t}\n\n\t/**\n\t * Copies specific row of the calling Matrix object into the Vector3D object.\n\t * The w element of the Vector3D object will not be changed.\n\t *\n\t * @param row      The row from which to copy the data from.\n\t * @param vector3D The Vector3D object from which to copy the data.\n\t */\n\tpublic copyRowTo(row:number, vector3D:Vector3D):void\n\t{\n\t\tif (row > 2) {\n\t\t\tthrow new ArgumentError(\"ArgumentError, Row \" + row + \" out of bounds [0, ..., 2]\");\n\t\t} else if (row == 0) {\n\t\t\tvector3D.x = this.a;\n\t\t\tvector3D.y = this.b;\n\t\t\tvector3D.z = this.tx;\n\t\t} else if (row == 1) {\n\t\t\tvector3D.x = this.c;\n\t\t\tvector3D.y = this.d;\n\t\t\tvector3D.z = this.ty;\n\t\t} else {\n\t\t\tvector3D.setTo(0, 0, 1);\n\t\t}\n\t}\n\n\t/**\n\t * Includes parameters for scaling, rotation, and translation. When applied\n\t * to a matrix it sets the matrix's values based on those parameters.\n\t *\n\t * <p>Using the <code>createBox()</code> method lets you obtain the same\n\t * matrix as you would if you applied the <code>identity()</code>,\n\t * <code>rotate()</code>, <code>scale()</code>, and <code>translate()</code>\n\t * methods in succession. For example, <code>mat1.createBox(2,2,Math.PI/4,\n\t * 100, 100)</code> has the same effect as the following:</p>\n\t *\n\t * @param scaleX   The factor by which to scale horizontally.\n\t * @param scaleY   The factor by which scale vertically.\n\t * @param rotation The amount to rotate, in radians.\n\t * @param tx       The number of pixels to translate(move) to the right\n\t *                 along the <i>x</i> axis.\n\t * @param ty       The number of pixels to translate(move) down along the\n\t *                 <i>y</i> axis.\n\t */\n\tpublic createBox(scaleX:number, scaleY:number, rotation:number = 0, tx:number = 0, ty:number = 0):void\n\t{\n\t\tthis.a = scaleX;\n\t\tthis.d = scaleY;\n\t\tthis.b = rotation;\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t}\n\n\t/**\n\t * Creates the specific style of matrix expected by the\n\t * <code>beginGradientFill()</code> and <code>lineGradientStyle()</code>\n\t * methods of the Graphics class. Width and height are scaled to a\n\t * <code>scaleX</code>/<code>scaleY</code> pair and the\n\t * <code>tx</code>/<code>ty</code> values are offset by half the width and\n\t * height.\n\t *\n\t * <p>For example, consider a gradient with the following\n\t * characteristics:</p>\n\t *\n\t * <ul>\n\t *   <li><code>GradientType.LINEAR</code></li>\n\t *   <li>Two colors, green and blue, with the ratios array set to <code>[0,\n\t * 255]</code></li>\n\t *   <li><code>SpreadMethod.PAD</code></li>\n\t *   <li><code>InterpolationMethod.LINEAR_RGB</code></li>\n\t * </ul>\n\t *\n\t * <p>The following illustrations show gradients in which the matrix was\n\t * defined using the <code>createGradientBox()</code> method with different\n\t * parameter settings:</p>\n\t *\n\t * @param width    The width of the gradient box.\n\t * @param height   The height of the gradient box.\n\t * @param rotation The amount to rotate, in radians.\n\t * @param tx       The distance, in pixels, to translate to the right along\n\t *                 the <i>x</i> axis. This value is offset by half of the\n\t *                 <code>width</code> parameter.\n\t * @param ty       The distance, in pixels, to translate down along the\n\t *                 <i>y</i> axis. This value is offset by half of the\n\t *                 <code>height</code> parameter.\n\t */\n\tpublic createGradientBox(width:number, height:number, rotation:number = 0, tx:number = 0, ty:number = 0):void\n\t{\n\t\tthis.a = width/1638.4;\n\t\tthis.d = height/1638.4;\n\n\t\tif (rotation != 0.0) {\n\t\t\tvar cos = Math.cos(rotation);\n\t\t\tvar sin = Math.sin(rotation);\n\n\t\t\tthis.b = sin*this.d;\n\t\t\tthis.c = -sin*this.a;\n\t\t\tthis.a *= cos;\n\t\t\tthis.d *= cos;\n\t\t} else {\n\t\t\tthis.b = this.c = 0;\n\t\t}\n\n\t\tthis.tx = tx + width/2;\n\t\tthis.ty = ty + height/2;\n\t}\n\n\t/**\n\t * Given a point in the pretransform coordinate space, returns the\n\t * coordinates of that point after the transformation occurs. Unlike the\n\t * standard transformation applied using the <code>transformPoint()</code>\n\t * method, the <code>deltaTransformPoint()</code> method's transformation\n\t * does not consider the translation parameters <code>tx</code> and\n\t * <code>ty</code>.\n\t *\n\t * @param point The point for which you want to get the result of the matrix\n\t *              transformation.\n\t * @return The point resulting from applying the matrix transformation.\n\t */\n\tpublic deltaTransformPoint(point:Point):Point\n\t{\n\t\treturn new Point(point.x*this.a + point.y*this.c, point.x*this.b + point.y*this.d);\n\t}\n\n\t/**\n\t * Sets each matrix property to a value that causes a null transformation. An\n\t * object transformed by applying an identity matrix will be identical to the\n\t * original.\n\t *\n\t * <p>After calling the <code>identity()</code> method, the resulting matrix\n\t * has the following properties: <code>a</code>=1, <code>b</code>=0,\n\t * <code>c</code>=0, <code>d</code>=1, <code>tx</code>=0,\n\t * <code>ty</code>=0.</p>\n\t *\n\t * <p>In matrix notation, the identity matrix looks like this:</p>\n\t *\n\t */\n\tpublic identity():void\n\t{\n\t\tthis.a = 1;\n\t\tthis.b = 0;\n\t\tthis.c = 0;\n\t\tthis.d = 1;\n\t\tthis.tx = 0;\n\t\tthis.ty = 0;\n\t}\n\n\t/**\n\t * Performs the opposite transformation of the original matrix. You can apply\n\t * an inverted matrix to an object to undo the transformation performed when\n\t * applying the original matrix.\n\t */\n\tpublic invert():void\n\t{\n\t\tvar norm = this.a*this.d - this.b*this.c;\n\n\t\tif (norm == 0) {\n\t\t\tthis.a = this.b = this.c = this.d = 0;\n\t\t\tthis.tx = -this.tx;\n\t\t\tthis.ty = -this.ty;\n\t\t} else {\n\t\t\tnorm = 1.0/norm;\n\t\t\tvar a1 = this.d*norm;\n\t\t\tthis.d = this.a*norm;\n\t\t\tthis.a = a1;\n\t\t\tthis.b *= -norm;\n\t\t\tthis.c *= -norm;\n\n\t\t\tvar tx1 = -this.a*this.tx - this.c*this.ty;\n\t\t\tthis.ty = -this.b*this.tx - this.d*this.ty;\n\t\t\tthis.tx = tx1;\n\t\t}\n\t}\n\n\n\t/**\n\t * Returns a new Matrix object that is a clone of this matrix, with an exact\n\t * copy of the contained object.\n\t *\n\t * @param matrix The matrix for which you want to get the result of the matrix\n\t *               transformation.\n\t * @return A Matrix object.\n\t */\n\tpublic multiply(matrix:Matrix):Matrix\n\t{\n\t\tvar result = new Matrix();\n\n\t\tresult.a = this.a*matrix.a + this.b*matrix.c;\n\t\tresult.b = this.a*matrix.b + this.b*matrix.d;\n\t\tresult.c = this.c*matrix.a + this.d*matrix.c;\n\t\tresult.d = this.c*matrix.b + this.d*matrix.d;\n\n\t\tresult.tx = this.tx*matrix.a + this.ty*matrix.c + matrix.tx;\n\t\tresult.ty = this.tx*matrix.b + this.ty*matrix.d + matrix.ty;\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Applies a rotation transformation to the Matrix object.\n\t *\n\t * <p>The <code>rotate()</code> method alters the <code>a</code>,\n\t * <code>b</code>, <code>c</code>, and <code>d</code> properties of the\n\t * Matrix object. In matrix notation, this is the same as concatenating the\n\t * current matrix with the following:</p>\n\t *\n\t * @param angle The rotation angle in radians.\n\t */\n\tpublic rotate(angle:number):void\n\t{\n\t\tvar cos = Math.cos(angle);\n\t\tvar sin = Math.sin(angle);\n\n\t\tvar a1 = this.a*cos - this.b*sin;\n\t\tthis.b = this.a*sin + this.b*cos;\n\t\tthis.a = a1;\n\n\t\tvar c1 = this.c*cos - this.d*sin;\n\t\tthis.d = this.c*sin + this.d*cos;\n\t\tthis.c = c1;\n\n\t\tvar tx1 = this.tx*cos - this.ty*sin;\n\t\tthis.ty = this.tx*sin + this.ty*cos;\n\t\tthis.tx = tx1;\n\t}\n\n\t/**\n\t * Applies a scaling transformation to the matrix. The <i>x</i> axis is\n\t * multiplied by <code>sx</code>, and the <i>y</i> axis it is multiplied by\n\t * <code>sy</code>.\n\t *\n\t * <p>The <code>scale()</code> method alters the <code>a</code> and\n\t * <code>d</code> properties of the Matrix object. In matrix notation, this\n\t * is the same as concatenating the current matrix with the following\n\t * matrix:</p>\n\t *\n\t * @param sx A multiplier used to scale the object along the <i>x</i> axis.\n\t * @param sy A multiplier used to scale the object along the <i>y</i> axis.\n\t */\n\tpublic scale(sx:number, sy:number):void\n\t{\n\t\tthis.a *= sx;\n\t\tthis.b *= sy;\n\n\t\tthis.c *= sx;\n\t\tthis.d *= sy;\n\n\t\tthis.tx *= sx;\n\t\tthis.ty *= sy;\n\t}\n\n\t/**\n\t * Sets the members of Matrix to the specified values.\n\t *\n\t * @param a  The value that affects the positioning of pixels along the\n\t *           <i>x</i> axis when scaling or rotating an image.\n\t * @param b  The value that affects the positioning of pixels along the\n\t *           <i>y</i> axis when rotating or skewing an image.\n\t * @param c  The value that affects the positioning of pixels along the\n\t *           <i>x</i> axis when rotating or skewing an image.\n\t * @param d  The value that affects the positioning of pixels along the\n\t *           <i>y</i> axis when scaling or rotating an image..\n\t * @param tx The distance by which to translate each point along the <i>x</i>\n\t *           axis.\n\t * @param ty The distance by which to translate each point along the <i>y</i>\n\t *           axis.\n\t */\n\tpublic setTo(a:number, b:number, c:number, d:number, tx:number, ty:number):void\n\t{\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\t\tthis.d = d;\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t}\n\n\t/**\n\t * Returns a text value listing the properties of the Matrix object.\n\t *\n\t * @return A string containing the values of the properties of the Matrix\n\t *         object: <code>a</code>, <code>b</code>, <code>c</code>,\n\t *         <code>d</code>, <code>tx</code>, and <code>ty</code>.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn \"[Matrix] (a=\" + this.a + \", b=\" + this.b + \", c=\" + this.c + \", d=\" + this.d + \", tx=\" + this.tx + \", ty=\" + this.ty + \")\";\n\t}\n\n\t/**\n\t * Returns the result of applying the geometric transformation represented by\n\t * the Matrix object to the specified point.\n\t *\n\t * @param point The point for which you want to get the result of the Matrix\n\t *              transformation.\n\t * @return The point resulting from applying the Matrix transformation.\n\t */\n\tpublic transformPoint(point:Point):Point\n\t{\n\t\treturn new Point(point.x*this.a + point.y*this.c + this.tx, point.x*this.b + point.y*this.d + this.ty);\n\t}\n\n\t/**\n\t * Translates the matrix along the <i>x</i> and <i>y</i> axes, as specified\n\t * by the <code>dx</code> and <code>dy</code> parameters.\n\t *\n\t * @param dx The amount of movement along the <i>x</i> axis to the right, in\n\t *           pixels.\n\t * @param dy The amount of movement down along the <i>y</i> axis, in pixels.\n\t */\n\tpublic translate(dx:number, dy:number):void\n\t{\n\t\tthis.tx += dx;\n\t\tthis.ty += dy;\n\t}\n}\n\nexport = Matrix;",
    "import Orientation3D\t\t\t= require(\"awayjs-core/lib/geom/Orientation3D\");\nimport Quaternion\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport ArgumentError\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\nclass Matrix3D\n{\n\t/**\n\t * A Vector of 16 Numbers, where every four elements is a column of a 4x4 matrix.\n\t *\n\t * <p>An exception is thrown if the rawData property is set to a matrix that is not invertible. The Matrix3D\n\t * object must be invertible. If a non-invertible matrix is needed, create a subclass of the Matrix3D object.</p>\n\t */\n\tpublic rawData:number[];\n\n\t/**\n\t * Creates a Matrix3D object.\n\t */\n\tconstructor(v:number[] = null)\n\t{\n\t\tif (v != null && v.length == 16)\n\t\t\tthis.rawData = v.concat();\n\t\telse\n\t\t\tthis.rawData = [ 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 ];\n\t}\n\n\t/**\n\t * Appends the matrix by multiplying another Matrix3D object by the current Matrix3D object.\n\t */\n\tpublic append(lhs:Matrix3D)\n\t{\n\t\tvar m111:number = this.rawData[0], m121:number = this.rawData[4], m131:number = this.rawData[8], m141:number = this.rawData[12], m112:number = this.rawData[1], m122:number = this.rawData[5], m132:number = this.rawData[9], m142:number = this.rawData[13], m113:number = this.rawData[2], m123:number = this.rawData[6], m133:number = this.rawData[10], m143:number = this.rawData[14], m114:number = this.rawData[3], m124:number = this.rawData[7], m134:number = this.rawData[11], m144:number = this.rawData[15], m211:number = lhs.rawData[0], m221:number = lhs.rawData[4], m231:number = lhs.rawData[8], m241:number = lhs.rawData[12], m212:number = lhs.rawData[1], m222:number = lhs.rawData[5], m232:number = lhs.rawData[9], m242:number = lhs.rawData[13], m213:number = lhs.rawData[2], m223:number = lhs.rawData[6], m233:number = lhs.rawData[10], m243:number = lhs.rawData[14], m214:number = lhs.rawData[3], m224:number = lhs.rawData[7], m234:number = lhs.rawData[11], m244:number = lhs.rawData[15];\n\n\t\tthis.rawData[0] = m111*m211 + m112*m221 + m113*m231 + m114*m241;\n\t\tthis.rawData[1] = m111*m212 + m112*m222 + m113*m232 + m114*m242;\n\t\tthis.rawData[2] = m111*m213 + m112*m223 + m113*m233 + m114*m243;\n\t\tthis.rawData[3] = m111*m214 + m112*m224 + m113*m234 + m114*m244;\n\n\t\tthis.rawData[4] = m121*m211 + m122*m221 + m123*m231 + m124*m241;\n\t\tthis.rawData[5] = m121*m212 + m122*m222 + m123*m232 + m124*m242;\n\t\tthis.rawData[6] = m121*m213 + m122*m223 + m123*m233 + m124*m243;\n\t\tthis.rawData[7] = m121*m214 + m122*m224 + m123*m234 + m124*m244;\n\n\t\tthis.rawData[8] = m131*m211 + m132*m221 + m133*m231 + m134*m241;\n\t\tthis.rawData[9] = m131*m212 + m132*m222 + m133*m232 + m134*m242;\n\t\tthis.rawData[10] = m131*m213 + m132*m223 + m133*m233 + m134*m243;\n\t\tthis.rawData[11] = m131*m214 + m132*m224 + m133*m234 + m134*m244;\n\n\t\tthis.rawData[12] = m141*m211 + m142*m221 + m143*m231 + m144*m241;\n\t\tthis.rawData[13] = m141*m212 + m142*m222 + m143*m232 + m144*m242;\n\t\tthis.rawData[14] = m141*m213 + m142*m223 + m143*m233 + m144*m243;\n\t\tthis.rawData[15] = m141*m214 + m142*m224 + m143*m234 + m144*m244;\n\t}\n\n\t/**\n\t * Appends an incremental rotation to a Matrix3D object.\n\t */\n\tpublic appendRotation(degrees:number, axis:Vector3D):void //, pivot:Vector3D = null )\n\t{\n\t\tvar m:Matrix3D = Matrix3D.getAxisRotation(axis.x, axis.y, axis.z, degrees);\n\n\t\tthis.append(m);\n\t}\n\n\t/**\n\t * Appends an incremental scale change along the x, y, and z axes to a Matrix3D object.\n\t */\n\tpublic appendScale(xScale:number, yScale:number, zScale:number)\n\t{\n\t\tthis.append(new Matrix3D([ xScale, 0.0, 0.0, 0.0, 0.0, yScale, 0.0, 0.0, 0.0, 0.0, zScale, 0.0, 0.0, 0.0, 0.0, 1.0 ]));\n\t}\n\n\t/**\n\t * Appends an incremental translation, a repositioning along the x, y, and z axes, to a Matrix3D object.\n\t */\n\tpublic appendTranslation(x:number, y:number, z:number)\n\t{\n\t\tthis.rawData[12] += x;\n\t\tthis.rawData[13] += y;\n\t\tthis.rawData[14] += z;\n\t}\n\n\t/**\n\t * Returns a new Matrix3D object that is an exact copy of the current Matrix3D object.\n\t */\n\tpublic clone():Matrix3D\n\t{\n\t\treturn new Matrix3D(this.rawData.slice(0));\n\t}\n\n\t/**\n\t * Copies a Vector3D object into specific column of the calling Matrix3D object.\n\t */\n\tpublic copyColumnFrom(column:number, vector3D:Vector3D)\n\t{\n\t\tswitch (column) {\n\t\t\tcase 0:\n\t\t\t\tthis.rawData[ 0 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 1 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 2 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 3 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tthis.rawData[ 4 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 5 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 6 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 7 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tthis.rawData[ 8 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 9 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 10 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 11 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tthis.rawData[ 12 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 13 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 14 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 15 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"ArgumentError, Column \" + column + \" out of bounds [0, ..., 3]\");\n\t\t}\n\t}\n\n\t/**\n\t * Copies specific column of the calling Matrix3D object into the Vector3D object.\n\t */\n\tpublic copyColumnTo(column:number, vector3D:Vector3D)\n\t{\n\t\tswitch (column) {\n\t\t\tcase 0:\n\t\t\t\tvector3D.x = this.rawData[ 0 ];\n\t\t\t\tvector3D.y = this.rawData[ 1 ];\n\t\t\t\tvector3D.z = this.rawData[ 2 ];\n\t\t\t\tvector3D.w = this.rawData[ 3 ];\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvector3D.x = this.rawData[ 4 ];\n\t\t\t\tvector3D.y = this.rawData[ 5 ];\n\t\t\t\tvector3D.z = this.rawData[ 6 ];\n\t\t\t\tvector3D.w = this.rawData[ 7 ];\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tvector3D.x = this.rawData[ 8 ];\n\t\t\t\tvector3D.y = this.rawData[ 9 ];\n\t\t\t\tvector3D.z = this.rawData[ 10 ];\n\t\t\t\tvector3D.w = this.rawData[ 11 ];\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tvector3D.x = this.rawData[ 12 ];\n\t\t\t\tvector3D.y = this.rawData[ 13 ];\n\t\t\t\tvector3D.z = this.rawData[ 14 ];\n\t\t\t\tvector3D.w = this.rawData[ 15 ];\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"ArgumentError, Column \" + column + \" out of bounds [0, ..., 3]\");\n\t\t}\n\t}\n\n\t/**\n\t * Copies all of the matrix data from the source Matrix3D object into the calling Matrix3D object.\n\t */\n\tpublic copyFrom(sourceMatrix3D:Matrix3D)\n\t{\n\t\tvar len:number = sourceMatrix3D.rawData.length;\n\t\tfor (var c:number = 0; c < len; c++)\n\t\t\tthis.rawData[c] = sourceMatrix3D.rawData[c];\n\t}\n\n\tpublic copyRawDataFrom(vector:number[], index:number = 0, transpose:boolean = false):void\n\t{\n\t\tif (transpose)\n\t\t\tthis.transpose();\n\n\t\tvar len:number = vector.length - index;\n\t\tfor (var c:number = 0; c < len; c++)\n\t\t\tthis.rawData[c] = vector[c + index];\n\n\t\tif (transpose)\n\t\t\tthis.transpose();\n\t}\n\n\tpublic copyRawDataTo(vector:number[], index:number = 0, transpose:boolean = false)\n\t{\n\t\tif (transpose)\n\t\t\tthis.transpose();\n\n\t\tvar len:number = this.rawData.length\n\t\tfor (var c:number = 0; c < len; c++)\n\t\t\tvector[c + index ] = this.rawData[c];\n\n\t\tif (transpose)\n\t\t\tthis.transpose();\n\t}\n\n\t/**\n\t * Copies a Vector3D object into specific row of the calling Matrix3D object.\n\t */\n\tpublic copyRowFrom(row:number, vector3D:Vector3D)\n\t{\n\t\tswitch (row) {\n\t\t\tcase 0:\n\t\t\t\tthis.rawData[ 0 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 4 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 8 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 12 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tthis.rawData[ 1 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 5 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 9 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 13 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tthis.rawData[ 2 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 6 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 10 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 14 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tthis.rawData[ 3 ] = vector3D.x;\n\t\t\t\tthis.rawData[ 7 ] = vector3D.y;\n\t\t\t\tthis.rawData[ 11 ] = vector3D.z;\n\t\t\t\tthis.rawData[ 15 ] = vector3D.w;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"ArgumentError, Row \" + row + \" out of bounds [0, ..., 3]\");\n\t\t}\n\t}\n\n\t/**\n\t * Copies specific row of the calling Matrix3D object into the Vector3D object.\n\t */\n\tpublic copyRowTo(row:number, vector3D:Vector3D)\n\t{\n\t\tswitch (row) {\n\t\t\tcase 0:\n\t\t\t\tvector3D.x = this.rawData[ 0 ];\n\t\t\t\tvector3D.y = this.rawData[ 4 ];\n\t\t\t\tvector3D.z = this.rawData[ 8 ];\n\t\t\t\tvector3D.w = this.rawData[ 12 ];\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tvector3D.x = this.rawData[ 1 ];\n\t\t\t\tvector3D.y = this.rawData[ 5 ];\n\t\t\t\tvector3D.z = this.rawData[ 9 ];\n\t\t\t\tvector3D.w = this.rawData[ 13 ];\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tvector3D.x = this.rawData[ 2 ];\n\t\t\t\tvector3D.y = this.rawData[ 6 ];\n\t\t\t\tvector3D.z = this.rawData[ 10 ];\n\t\t\t\tvector3D.w = this.rawData[ 14 ];\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tvector3D.x = this.rawData[ 3 ];\n\t\t\t\tvector3D.y = this.rawData[ 7 ];\n\t\t\t\tvector3D.z = this.rawData[ 11 ];\n\t\t\t\tvector3D.w = this.rawData[ 15 ]\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new ArgumentError(\"ArgumentError, Row \" + row + \" out of bounds [0, ..., 3]\");\n\t\t}\n\t}\n\n\t/**\n\t * Copies this Matrix3D object into a destination Matrix3D object.\n\t */\n\tpublic copyToMatrix3D(dest:Matrix3D)\n\t{\n\t\tdest.rawData = this.rawData.slice(0);\n\t}\n\n\t/**\n\t * Returns the transformation matrix's translation, rotation, and scale settings as a Vector of three Vector3D objects.\n\t */\n\tpublic decompose(orientationStyle:string = \"eulerAngles\"):Vector3D[]\n\t{\n\t\tvar q:Quaternion;\n\n\t\t// Initial Tests - Not OK\n\n\t\tvar vec:Vector3D[] = [];\n\t\tvar m = this.clone();\n\t\tvar mr = m.rawData;\n\n\t\tvar pos:Vector3D = new Vector3D(mr[12], mr[13], mr[14]);\n\t\tmr[12] = 0;\n\t\tmr[13] = 0;\n\t\tmr[14] = 0;\n\n\t\tvar scale:Vector3D = new Vector3D();\n\n\t\tscale.x = Math.sqrt(mr[0]*mr[0] + mr[1]*mr[1] + mr[2]*mr[2]);\n\t\tscale.y = Math.sqrt(mr[4]*mr[4] + mr[5]*mr[5] + mr[6]*mr[6]);\n\t\tscale.z = Math.sqrt(mr[8]*mr[8] + mr[9]*mr[9] + mr[10]*mr[10]);\n\n\t\tif (mr[0]*(mr[5]*mr[10] - mr[6]*mr[9]) - mr[1]*(mr[4]*mr[10] - mr[6]*mr[8]) + mr[2]*(mr[4]*mr[9] - mr[5]*mr[8]) < 0)\n\t\t\tscale.z = -scale.z;\n\n\t\tmr[0] /= scale.x;\n\t\tmr[1] /= scale.x;\n\t\tmr[2] /= scale.x;\n\t\tmr[4] /= scale.y;\n\t\tmr[5] /= scale.y;\n\t\tmr[6] /= scale.y;\n\t\tmr[8] /= scale.z;\n\t\tmr[9] /= scale.z;\n\t\tmr[10] /= scale.z;\n\n\t\tvar rot = new Vector3D();\n\n\t\tswitch (orientationStyle) {\n\t\t\tcase Orientation3D.AXIS_ANGLE:\n\n\t\t\t\trot.w = Math.acos((mr[0] + mr[5] + mr[10] - 1)/2);\n\n\t\t\t\tvar len:number = Math.sqrt((mr[6] - mr[9])*(mr[6] - mr[9]) + (mr[8] - mr[2])*(mr[8] - mr[2]) + (mr[1] - mr[4])*(mr[1] - mr[4]));\n\t\t\t\trot.x = (mr[6] - mr[9])/len;\n\t\t\t\trot.y = (mr[8] - mr[2])/len;\n\t\t\t\trot.z = (mr[1] - mr[4])/len;\n\n\t\t\t\tbreak;\n\t\t\tcase Orientation3D.QUATERNION:\n\n\t\t\t\tvar tr = mr[0] + mr[5] + mr[10];\n\n\t\t\t\tif (tr > 0) {\n\t\t\t\t\trot.w = Math.sqrt(1 + tr)/2;\n\n\t\t\t\t\trot.x = (mr[6] - mr[9])/(4*rot.w);\n\t\t\t\t\trot.y = (mr[8] - mr[2])/(4*rot.w);\n\t\t\t\t\trot.z = (mr[1] - mr[4])/(4*rot.w);\n\t\t\t\t} else if ((mr[0] > mr[5]) && (mr[0] > mr[10])) {\n\t\t\t\t\trot.x = Math.sqrt(1 + mr[0] - mr[5] - mr[10])/2;\n\n\t\t\t\t\trot.w = (mr[6] - mr[9])/(4*rot.x);\n\t\t\t\t\trot.y = (mr[1] + mr[4])/(4*rot.x);\n\t\t\t\t\trot.z = (mr[8] + mr[2])/(4*rot.x);\n\t\t\t\t} else if (mr[5] > mr[10]) {\n\t\t\t\t\trot.y = Math.sqrt(1 + mr[5] - mr[0] - mr[10])/2;\n\n\t\t\t\t\trot.x = (mr[1] + mr[4])/(4*rot.y);\n\t\t\t\t\trot.w = (mr[8] - mr[2])/(4*rot.y);\n\t\t\t\t\trot.z = (mr[6] + mr[9])/(4*rot.y);\n\t\t\t\t} else {\n\t\t\t\t\trot.z = Math.sqrt(1 + mr[10] - mr[0] - mr[5])/2;\n\n\t\t\t\t\trot.x = (mr[8] + mr[2])/(4*rot.z);\n\t\t\t\t\trot.y = (mr[6] + mr[9])/(4*rot.z);\n\t\t\t\t\trot.w = (mr[1] - mr[4])/(4*rot.z);\n\t\t\t\t}\n\n\n\t\t\t\tbreak;\n\t\t\tcase Orientation3D.EULER_ANGLES:\n\n\t\t\t\trot.y = Math.asin(-mr[2]);\n\n\t\t\t\t//var cos:number = Math.cos(rot.y);\n\n\t\t\t\tif (mr[2] != 1 && mr[2] != -1) {\n\t\t\t\t\trot.x = Math.atan2(mr[6], mr[10]);\n\t\t\t\t\trot.z = Math.atan2(mr[1], mr[0]);\n\t\t\t\t} else {\n\t\t\t\t\trot.z = 0;\n\t\t\t\t\trot.x = Math.atan2(mr[4], mr[5]);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\tvec.push(pos);\n\t\tvec.push(rot);\n\t\tvec.push(scale);\n\n\t\treturn vec;\n\t}\n\n\t/**\n\t * Uses the transformation matrix without its translation elements to transform a Vector3D object from one space\n\t * coordinate to another.\n\t */\n\tpublic deltaTransformVector(v:Vector3D):Vector3D\n\t{\n\t\tvar x:number = v.x;\n\t\tvar y:number = v.y;\n\t\tvar z:number = v.z;\n\n\t\treturn new Vector3D((x*this.rawData[0] + y*this.rawData[4] + z*this.rawData[8]), (x*this.rawData[1] + y*this.rawData[5] + z*this.rawData[9]), (x*this.rawData[2] + y*this.rawData[6] + z*this.rawData[10]), (x*this.rawData[3] + y*this.rawData[7] + z*this.rawData[11]));\n\t}\n\n\t/**\n\t * Converts the current matrix to an identity or unit matrix.\n\t */\n\tpublic identity()\n\t{\n\t\tthis.rawData = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1 ];\n\t}\n\n\t/**\n\t * [static] Interpolates the translation, rotation, and scale transformation of one matrix toward those of the target matrix.\n\t */\n\tstatic interpolate(thisMat:Matrix3D, toMat:Matrix3D, percent:number):Matrix3D\n\t{\n\t\tvar m:Matrix3D = new Matrix3D();\n\t\tfor (var i:number = 0; i < 16; ++i)\n\t\t\tm.rawData[i] = thisMat.rawData[i] + (toMat.rawData[i] - thisMat.rawData[i])*percent;\n\n\t\treturn m;\n\t}\n\n\t/**\n\t * Interpolates this matrix towards the translation, rotation, and scale transformations of the target matrix.\n\t */\n\tpublic interpolateTo(toMat:Matrix3D, percent:number)\n\t{\n\t\tfor (var i:number = 0; i < 16; ++i)\n\t\t\tthis.rawData[i] = this.rawData[i] + (toMat.rawData[i] - this.rawData[i])*percent;\n\t}\n\n\t/**\n\t * Inverts the current matrix.\n\t */\n\tpublic invert():boolean\n\t{\n\t\tvar d = this.determinant;\n\t\tvar invertable = Math.abs(d) > 0.00000000001;\n\n\t\tif (invertable) {\n\t\t\td = 1/d;\n\t\t\tvar m11:number = this.rawData[0];\n\t\t\tvar m21:number = this.rawData[4];\n\t\t\tvar m31:number = this.rawData[8];\n\t\t\tvar m41:number = this.rawData[12];\n\t\t\tvar m12:number = this.rawData[1];\n\t\t\tvar m22:number = this.rawData[5];\n\t\t\tvar m32:number = this.rawData[9];\n\t\t\tvar m42:number = this.rawData[13];\n\t\t\tvar m13:number = this.rawData[2];\n\t\t\tvar m23:number = this.rawData[6];\n\t\t\tvar m33:number = this.rawData[10];\n\t\t\tvar m43:number = this.rawData[14];\n\t\t\tvar m14:number = this.rawData[3];\n\t\t\tvar m24:number = this.rawData[7];\n\t\t\tvar m34:number = this.rawData[11];\n\t\t\tvar m44:number = this.rawData[15];\n\n\t\t\tthis.rawData[0] = d*(m22*(m33*m44 - m43*m34) - m32*(m23*m44 - m43*m24) + m42*(m23*m34 - m33*m24));\n\t\t\tthis.rawData[1] = -d*(m12*(m33*m44 - m43*m34) - m32*(m13*m44 - m43*m14) + m42*(m13*m34 - m33*m14));\n\t\t\tthis.rawData[2] = d*(m12*(m23*m44 - m43*m24) - m22*(m13*m44 - m43*m14) + m42*(m13*m24 - m23*m14));\n\t\t\tthis.rawData[3] = -d*(m12*(m23*m34 - m33*m24) - m22*(m13*m34 - m33*m14) + m32*(m13*m24 - m23*m14));\n\t\t\tthis.rawData[4] = -d*(m21*(m33*m44 - m43*m34) - m31*(m23*m44 - m43*m24) + m41*(m23*m34 - m33*m24));\n\t\t\tthis.rawData[5] = d*(m11*(m33*m44 - m43*m34) - m31*(m13*m44 - m43*m14) + m41*(m13*m34 - m33*m14));\n\t\t\tthis.rawData[6] = -d*(m11*(m23*m44 - m43*m24) - m21*(m13*m44 - m43*m14) + m41*(m13*m24 - m23*m14));\n\t\t\tthis.rawData[7] = d*(m11*(m23*m34 - m33*m24) - m21*(m13*m34 - m33*m14) + m31*(m13*m24 - m23*m14));\n\t\t\tthis.rawData[8] = d*(m21*(m32*m44 - m42*m34) - m31*(m22*m44 - m42*m24) + m41*(m22*m34 - m32*m24));\n\t\t\tthis.rawData[9] = -d*(m11*(m32*m44 - m42*m34) - m31*(m12*m44 - m42*m14) + m41*(m12*m34 - m32*m14));\n\t\t\tthis.rawData[10] = d*(m11*(m22*m44 - m42*m24) - m21*(m12*m44 - m42*m14) + m41*(m12*m24 - m22*m14));\n\t\t\tthis.rawData[11] = -d*(m11*(m22*m34 - m32*m24) - m21*(m12*m34 - m32*m14) + m31*(m12*m24 - m22*m14));\n\t\t\tthis.rawData[12] = -d*(m21*(m32*m43 - m42*m33) - m31*(m22*m43 - m42*m23) + m41*(m22*m33 - m32*m23));\n\t\t\tthis.rawData[13] = d*(m11*(m32*m43 - m42*m33) - m31*(m12*m43 - m42*m13) + m41*(m12*m33 - m32*m13));\n\t\t\tthis.rawData[14] = -d*(m11*(m22*m43 - m42*m23) - m21*(m12*m43 - m42*m13) + m41*(m12*m23 - m22*m13));\n\t\t\tthis.rawData[15] = d*(m11*(m22*m33 - m32*m23) - m21*(m12*m33 - m32*m13) + m31*(m12*m23 - m22*m13));\n\t\t}\n\t\treturn invertable;\n\t}\n\n\t/* TODO implement pointAt\n\t public pointAt( pos:Vector3D, at:Vector3D = null, up:Vector3D = null )\n\t {\n\t }\n\t */\n\n\t/**\n\t * Prepends a matrix by multiplying the current Matrix3D object by another Matrix3D object.\n\t */\n\tpublic prepend(rhs:Matrix3D)\n\t{\n\t\tvar m111:number = rhs.rawData[0], m121:number = rhs.rawData[4], m131:number = rhs.rawData[8], m141:number = rhs.rawData[12], m112:number = rhs.rawData[1], m122:number = rhs.rawData[5], m132:number = rhs.rawData[9], m142:number = rhs.rawData[13], m113:number = rhs.rawData[2], m123:number = rhs.rawData[6], m133:number = rhs.rawData[10], m143:number = rhs.rawData[14], m114:number = rhs.rawData[3], m124:number = rhs.rawData[7], m134:number = rhs.rawData[11], m144:number = rhs.rawData[15], m211:number = this.rawData[0], m221:number = this.rawData[4], m231:number = this.rawData[8], m241:number = this.rawData[12], m212:number = this.rawData[1], m222:number = this.rawData[5], m232:number = this.rawData[9], m242:number = this.rawData[13], m213:number = this.rawData[2], m223:number = this.rawData[6], m233:number = this.rawData[10], m243:number = this.rawData[14], m214:number = this.rawData[3], m224:number = this.rawData[7], m234:number = this.rawData[11], m244:number = this.rawData[15];\n\n\t\tthis.rawData[0] = m111*m211 + m112*m221 + m113*m231 + m114*m241;\n\t\tthis.rawData[1] = m111*m212 + m112*m222 + m113*m232 + m114*m242;\n\t\tthis.rawData[2] = m111*m213 + m112*m223 + m113*m233 + m114*m243;\n\t\tthis.rawData[3] = m111*m214 + m112*m224 + m113*m234 + m114*m244;\n\n\t\tthis.rawData[4] = m121*m211 + m122*m221 + m123*m231 + m124*m241;\n\t\tthis.rawData[5] = m121*m212 + m122*m222 + m123*m232 + m124*m242;\n\t\tthis.rawData[6] = m121*m213 + m122*m223 + m123*m233 + m124*m243;\n\t\tthis.rawData[7] = m121*m214 + m122*m224 + m123*m234 + m124*m244;\n\n\t\tthis.rawData[8] = m131*m211 + m132*m221 + m133*m231 + m134*m241;\n\t\tthis.rawData[9] = m131*m212 + m132*m222 + m133*m232 + m134*m242;\n\t\tthis.rawData[10] = m131*m213 + m132*m223 + m133*m233 + m134*m243;\n\t\tthis.rawData[11] = m131*m214 + m132*m224 + m133*m234 + m134*m244;\n\n\t\tthis.rawData[12] = m141*m211 + m142*m221 + m143*m231 + m144*m241;\n\t\tthis.rawData[13] = m141*m212 + m142*m222 + m143*m232 + m144*m242;\n\t\tthis.rawData[14] = m141*m213 + m142*m223 + m143*m233 + m144*m243;\n\t\tthis.rawData[15] = m141*m214 + m142*m224 + m143*m234 + m144*m244;\n\t}\n\n\t/**\n\t * Prepends an incremental rotation to a Matrix3D object.\n\t */\n\tpublic prependRotation(degrees:number, axis:Vector3D) //, pivot:Vector3D = null )\n\t{\n\t\tvar m:Matrix3D = Matrix3D.getAxisRotation(axis.x, axis.y, axis.z, degrees);\n\n\t\t/*\n\t\t if ( pivot != null )\n\t\t {\n\t\t var p:Vector3D = pivot;\n\t\t m.appendTranslation( p.x, p.y, p.z );\n\t\t }\n\t\t */\n\t\tthis.prepend(m);\n\t}\n\n\t/**\n\t * Prepends an incremental scale change along the x, y, and z axes to a Matrix3D object.\n\t */\n\tpublic prependScale(xScale:number, yScale:number, zScale:number)\n\t{\n\n\t\t// Initial Tests - OK\n\n\t\tthis.prepend(new Matrix3D([ xScale, 0, 0, 0, 0, yScale, 0, 0, 0, 0, zScale, 0, 0, 0, 0, 1 ]));\n\t}\n\n\t/**\n\t * Prepends an incremental translation, a repositioning along the x, y, and z axes, to a Matrix3D object.\n\t */\n\tpublic prependTranslation(x:number, y:number, z:number)\n\t{\n\n\t\t// Initial Tests - OK\n\n\t\tvar m = new Matrix3D();\n\t\tm.position = new Vector3D(x, y, z);\n\t\tthis.prepend(m);\n\t}\n\n\t// TODO orientationStyle\n\t/**\n\t * Sets the transformation matrix's translation, rotation, and scale settings.\n\t */\n\tpublic recompose(components:Vector3D[]):boolean\n\t{\n\n\t\t// Initial Tests - OK\n\n\t\tif (components.length < 3) return false\n\n\t\t//components[2].x == 0 || components[2].y == 0 || components[2].z == 0) return false;\n\n\t\tthis.identity();\n\t\tthis.appendScale(components[2].x, components[2].y, components[2].z);\n\n\t\tvar angle:number;\n\t\tangle = -components[1].x;\n\t\tthis.append(new Matrix3D([1, 0, 0, 0, 0, Math.cos(angle), -Math.sin(angle), 0, 0, Math.sin(angle), Math.cos(angle), 0, 0, 0, 0 , 0]));\n\t\tangle = -components[1].y;\n\t\tthis.append(new Matrix3D([Math.cos(angle), 0, Math.sin(angle), 0, 0, 1, 0, 0, -Math.sin(angle), 0, Math.cos(angle), 0, 0, 0, 0, 0]));\n\t\tangle = -components[1].z;\n\t\tthis.append(new Matrix3D([Math.cos(angle), -Math.sin(angle), 0, 0, Math.sin(angle), Math.cos(angle), 0, 0, 0, 0, 1, 0, 0, 0, 0, 0]));\n\n\t\tthis.position = components[0];\n\t\tthis.rawData[15] = 1;\n\n\t\treturn true;\n\t}\n\n\tpublic transformVector(v:Vector3D):Vector3D\n\t{\n\t\tvar x:number = v.x;\n\t\tvar y:number = v.y;\n\t\tvar z:number = v.z;\n\n\t\treturn new Vector3D((x*this.rawData[0] + y*this.rawData[4] + z*this.rawData[8] + this.rawData[12]), (x*this.rawData[1] + y*this.rawData[5] + z*this.rawData[9] + this.rawData[13]), (x*this.rawData[2] + y*this.rawData[6] + z*this.rawData[10] + this.rawData[14]), (x*this.rawData[3] + y*this.rawData[7] + z*this.rawData[11] + this.rawData[15]));\n\t}\n\n\t/**\n\t * Uses the transformation matrix to transform a Vector of Numbers from one coordinate space to another.\n\t */\n\tpublic transformVectors(vin:number[], vout:number[])\n\t{\n\n\t\t// Initial Tests - OK\n\n\t\tvar i:number = 0;\n\t\tvar x:number = 0, y:number = 0, z:number = 0;\n\n\t\twhile (i + 3 <= vin.length) {\n\t\t\tx = vin[i];\n\t\t\ty = vin[i + 1];\n\t\t\tz = vin[i + 2];\n\t\t\tvout[i] = x*this.rawData[0] + y*this.rawData[4] + z*this.rawData[8] + this.rawData[12];\n\t\t\tvout[i + 1] = x*this.rawData[1] + y*this.rawData[5] + z*this.rawData[9] + this.rawData[13];\n\t\t\tvout[i + 2] = x*this.rawData[2] + y*this.rawData[6] + z*this.rawData[10] + this.rawData[14];\n\t\t\ti += 3;\n\t\t}\n\t}\n\n\t/**\n\t * Converts the current Matrix3D object to a matrix where the rows and columns are swapped.\n\t */\n\tpublic transpose()\n\t{\n\n\t\t// Initial Tests - OK\n\n\t\tvar oRawData:number[] = this.rawData.slice(0);\n\n\t\tthis.rawData[1] = oRawData[4];\n\t\tthis.rawData[2] = oRawData[8];\n\t\tthis.rawData[3] = oRawData[12];\n\t\tthis.rawData[4] = oRawData[1];\n\t\tthis.rawData[6] = oRawData[9];\n\t\tthis.rawData[7] = oRawData[13];\n\t\tthis.rawData[8] = oRawData[2];\n\t\tthis.rawData[9] = oRawData[6];\n\t\tthis.rawData[11] = oRawData[14];\n\t\tthis.rawData[12] = oRawData[3];\n\t\tthis.rawData[13] = oRawData[7];\n\t\tthis.rawData[14] = oRawData[11];\n\t}\n\n\tstatic getAxisRotation(x:number, y:number, z:number, degrees:number):Matrix3D\n\t{\n\n\t\t// internal class use by rotations which have been tested\n\n\t\tvar m:Matrix3D = new Matrix3D();\n\n\t\tvar rad = degrees*( Math.PI/180 );\n\t\tvar c:number = Math.cos(rad);\n\t\tvar s:number = Math.sin(rad);\n\t\tvar t:number = 1 - c;\n\t\tvar tmp1:number, tmp2:number;\n\n\t\tm.rawData[0] = c + x*x*t;\n\t\tm.rawData[5] = c + y*y*t;\n\t\tm.rawData[10] = c + z*z*t;\n\n\t\ttmp1 = x*y*t;\n\t\ttmp2 = z*s;\n\t\tm.rawData[1] = tmp1 + tmp2;\n\t\tm.rawData[4] = tmp1 - tmp2;\n\t\ttmp1 = x*z*t;\n\t\ttmp2 = y*s;\n\t\tm.rawData[8] = tmp1 + tmp2;\n\t\tm.rawData[2] = tmp1 - tmp2;\n\t\ttmp1 = y*z*t;\n\t\ttmp2 = x*s;\n\t\tm.rawData[9] = tmp1 - tmp2;\n\t\tm.rawData[6] = tmp1 + tmp2;\n\n\t\treturn m;\n\t}\n\n\t/**\n\t * [read-only] A Number that determines whether a matrix is invertible.\n\t */\n\tpublic get determinant():number\n\t{\n\t\treturn    ((this.rawData[0]*this.rawData[5] - this.rawData[4]*this.rawData[1])*(this.rawData[10]*this.rawData[15] - this.rawData[14]*this.rawData[11]) - (this.rawData[0]*this.rawData[9] - this.rawData[8]*this.rawData[1])*(this.rawData[6]*this.rawData[15] - this.rawData[14]*this.rawData[7]) + (this.rawData[0]*this.rawData[13] - this.rawData[12]*this.rawData[1])*(this.rawData[6]*this.rawData[11] - this.rawData[10]*this.rawData[7]) + (this.rawData[4]*this.rawData[9] - this.rawData[8]*this.rawData[5])*(this.rawData[2]*this.rawData[15] - this.rawData[14]*this.rawData[3]) - (this.rawData[4]*this.rawData[13] - this.rawData[12]*this.rawData[5])*(this.rawData[2]*this.rawData[11] - this.rawData[10]*this.rawData[3]) + (this.rawData[8]*this.rawData[13] - this.rawData[12]*this.rawData[9])*(this.rawData[2]*this.rawData[7] - this.rawData[6]*this.rawData[3]));\n\t}\n\n\t/**\n\t * A Vector3D object that holds the position, the 3D coordinate (x,y,z) of a display object within the\n\t * transformation's frame of reference.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn new Vector3D(this.rawData[12], this.rawData[13], this.rawData[14]);\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis.rawData[12] = value.x;\n\t\tthis.rawData[13] = value.y;\n\t\tthis.rawData[14] = value.z;\n\t}\n\n\tpublic toFixed(decimalPlace:number):string\n\t{\n\t\tvar magnitude:number = Math.pow(10, decimalPlace);\n\t\treturn \"matrix3d(\" + Math.round(this.rawData[0]*magnitude)/magnitude + \",\" + Math.round(this.rawData[1]*magnitude)/magnitude + \",\" + Math.round(this.rawData[2]*magnitude)/magnitude + \",\" + Math.round(this.rawData[3]*magnitude)/magnitude + \",\" + Math.round(this.rawData[4]*magnitude)/magnitude + \",\" + Math.round(this.rawData[5]*magnitude)/magnitude + \",\" + Math.round(this.rawData[6]*magnitude)/magnitude + \",\" + Math.round(this.rawData[7]*magnitude)/magnitude + \",\" + Math.round(this.rawData[8]*magnitude)/magnitude + \",\" + Math.round(this.rawData[9]*magnitude)/magnitude + \",\" + Math.round(this.rawData[10]*magnitude)/magnitude + \",\" + Math.round(this.rawData[11]*magnitude)/magnitude + \",\" + Math.round(this.rawData[12]*magnitude)/magnitude + \",\" + Math.round(this.rawData[13]*magnitude)/magnitude + \",\" + Math.round(this.rawData[14]*magnitude)/magnitude + \",\" + Math.round(this.rawData[15]*magnitude)/magnitude + \")\";\n\t}\n\n\tpublic toString():string\n\t{\n\t\treturn \"matrix3d(\" + Math.round(this.rawData[0]*1000)/1000 + \",\" + Math.round(this.rawData[1]*1000)/1000 + \",\" + Math.round(this.rawData[2]*1000)/1000 + \",\" + Math.round(this.rawData[3]*1000)/1000 + \",\" + Math.round(this.rawData[4]*1000)/1000 + \",\" + Math.round(this.rawData[5]*1000)/1000 + \",\" + Math.round(this.rawData[6]*1000)/1000 + \",\" + Math.round(this.rawData[7]*1000)/1000 + \",\" + Math.round(this.rawData[8]*1000)/1000 + \",\" + Math.round(this.rawData[9]*1000)/1000 + \",\" + Math.round(this.rawData[10]*1000)/1000 + \",\" + Math.round(this.rawData[11]*1000)/1000 + \",\" + Math.round(this.rawData[12]*1000)/1000 + \",\" + Math.round(this.rawData[13]*1000)/1000 + \",\" + Math.round(this.rawData[14]*1000)/1000 + \",\" + Math.round(this.rawData[15]*1000)/1000 + \")\";\n\t}\n}\n\nexport = Matrix3D;",
    "/**\n * A Quaternion object which can be used to represent rotations.\n */\nclass Orientation3D\n{\n\t/**\n\t * The axis angle orientation uses a combination of an axis and an angle to determine the orientation.\n\t * @type {string}\n\t */\n\tpublic static AXIS_ANGLE:string = \"axisAngle\";\n\n\t/**\n\t * The default orientation for decompose() and recompose() methods, defines the orientation with three separate angles of rotation for each axis.\n\t * @type {string}\n\t */\n\tpublic static EULER_ANGLES:string = \"eulerAngles\";\n\n\t/**\n\t * The quaternion orientation uses complex numbers.\n\t * @type {string}\n\t */\n\tpublic static QUATERNION:string = \"quaternion\";\n}\n\nexport = Orientation3D;",
    "/**\n * The Point object represents a location in a two-dimensional coordinate\n * system, where <i>x</i> represents the horizontal axis and <i>y</i>\n * represents the vertical axis.\n *\n * <p>The following code creates a point at(0,0):</p>\n *\n * <p>Methods and properties of the following classes use Point objects:</p>\n *\n * <ul>\n *   <li>BitmapData</li>\n *   <li>DisplayObject</li>\n *   <li>DisplayObjectContainer</li>\n *   <li>DisplacementMapFilter</li>\n *   <li>NativeWindow</li>\n *   <li>Matrix</li>\n *   <li>Rectangle</li>\n * </ul>\n *\n * <p>You can use the <code>new Point()</code> constructor to create a Point\n * object.</p>\n */\nclass Point\n{\n\t/**\n\t * The horizontal coordinate of the point. The default value is 0.\n\t */\n\tpublic x:number;\n\n\t/**\n\t * The vertical coordinate of the point. The default value is 0.\n\t */\n\tpublic y:number;\n\n\t/**\n\t * The length of the line segment from(0,0) to this point.\n\t */\n\tpublic get length():number\n\t{\n\t\treturn Math.sqrt(this.x*this.x + this.y*this.y);\n\t}\n\n\t/**\n\t * Creates a new point. If you pass no parameters to this method, a point is\n\t * created at(0,0).\n\t *\n\t * @param x The horizontal coordinate.\n\t * @param y The vertical coordinate.\n\t */\n\tconstructor(x:number = 0, y:number = 0)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\t/**\n\t * Adds the coordinates of another point to the coordinates of this point to\n\t * create a new point.\n\t *\n\t * @param v The point to be added.\n\t * @return The new point.\n\t */\n\tpublic add(v:Point):Point\n\t{\n\t\treturn new Point(this.x + v.x, this.y + v.y);\n\t}\n\n\t/**\n\t * Creates a copy of this Point object.\n\t *\n\t * @return The new Point object.\n\t */\n\tpublic clone():Point\n\t{\n\t\treturn new Point(this.x, this.y);\n\t}\n\n\tpublic copyFrom(sourcePoint:Point)\n\t{\n\n\t}\n\n\t/**\n\t * Determines whether two points are equal. Two points are equal if they have\n\t * the same <i>x</i> and <i>y</i> values.\n\t *\n\t * @param toCompare The point to be compared.\n\t * @return A value of <code>true</code> if the object is equal to this Point\n\t *         object; <code>false</code> if it is not equal.\n\t */\n\tpublic equals(toCompare:Point):boolean\n\t{\n\t\treturn (this.x == toCompare.x && this.y == toCompare.y);\n\t}\n\n\t/**\n\t * Scales the line segment between(0,0) and the current point to a set\n\t * length.\n\t *\n\t * @param thickness The scaling value. For example, if the current point is\n\t *                 (0,5), and you normalize it to 1, the point returned is\n\t *                  at(0,1).\n\t */\n\tpublic normalize(thickness:number = 1)\n\t{\n\t\tif (this.length != 0) {\n\t\t\tvar invLength = thickness/this.length;\n\t\t\tthis.x *= invLength;\n\t\t\tthis.y *= invLength;\n\t\t\treturn;\n\t\t}\n\t\tthrow \"Cannot divide by zero length.\";\n\t}\n\n\t/**\n\t * Offsets the Point object by the specified amount. The value of\n\t * <code>dx</code> is added to the original value of <i>x</i> to create the\n\t * new <i>x</i> value. The value of <code>dy</code> is added to the original\n\t * value of <i>y</i> to create the new <i>y</i> value.\n\t *\n\t * @param dx The amount by which to offset the horizontal coordinate,\n\t *           <i>x</i>.\n\t * @param dy The amount by which to offset the vertical coordinate, <i>y</i>.\n\t */\n\tpublic offset(dx:number, dy:number)\n\t{\n\t\tthis.x += dx;\n\t\tthis.y += dy;\n\t}\n\n\tpublic setTo(xa:number, ya:number)\n\t{\n\n\t}\n\n\t/**\n\t * Subtracts the coordinates of another point from the coordinates of this\n\t * point to create a new point.\n\t *\n\t * @param v The point to be subtracted.\n\t * @return The new point.\n\t */\n\tpublic subtract(v:Point):Point\n\t{\n\t\treturn new Point(this.x - v.x, this.y - v.y);\n\t}\n\n\t/**\n\t * Returns a string that contains the values of the <i>x</i> and <i>y</i>\n\t * coordinates. The string has the form <code>\"(x=<i>x</i>,\n\t * y=<i>y</i>)\"</code>, so calling the <code>toString()</code> method for a\n\t * point at 23,17 would return <code>\"(x=23, y=17)\"</code>.\n\t *\n\t * @return The string representation of the coordinates.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn \"[Point] (x=\" + this.x + \", y=\" + this.y + \")\";\n\t}\n\n\t/**\n\t * Returns the distance between <code>pt1</code> and <code>pt2</code>.\n\t *\n\t * @param pt1 The first point.\n\t * @param pt2 The second point.\n\t * @return The distance between the first and second points.\n\t */\n\tpublic static distance(pt1:Point, pt2:Point):number\n\t{\n\t\tvar dx:number = pt2.x - pt1.x;\n\t\tvar dy:number = pt2.y - pt1.y;\n\n\t\treturn Math.sqrt(dx*dx + dy*dy);\n\t}\n\n\t/**\n\t * Determines a point between two specified points. The parameter\n\t * <code>f</code> determines where the new interpolated point is located\n\t * relative to the two end points specified by parameters <code>pt1</code>\n\t * and <code>pt2</code>. The closer the value of the parameter <code>f</code>\n\t * is to <code>1.0</code>, the closer the interpolated point is to the first\n\t * point(parameter <code>pt1</code>). The closer the value of the parameter\n\t * <code>f</code> is to 0, the closer the interpolated point is to the second\n\t * point(parameter <code>pt2</code>).\n\t *\n\t * @param pt1 The first point.\n\t * @param pt2 The second point.\n\t * @param f   The level of interpolation between the two points. Indicates\n\t *            where the new point will be, along the line between\n\t *            <code>pt1</code> and <code>pt2</code>. If <code>f</code>=1,\n\t *            <code>pt1</code> is returned; if <code>f</code>=0,\n\t *            <code>pt2</code> is returned.\n\t * @return The new, interpolated point.\n\t */\n\tpublic static interpolate(pt1:Point, pt2:Point, f:number):Point\n\t{\n\t\treturn new Point(pt2.x + (pt1.x - pt2.x)*f, pt2.y + (pt1.y - pt2.y)*f);\n\t}\n\n\t/**\n\t * Converts a pair of polar coordinates to a Cartesian point coordinate.\n\t *\n\t * @param len   The length coordinate of the polar pair.\n\t * @param angle The angle, in radians, of the polar pair.\n\t * @return The Cartesian point.\n\t */\n\tpublic static polar(len:number, angle:number):Point\n\t{\n\t\treturn new Point(len*Math.cos(angle), len*Math.sin(angle));\n\t}\n}\n\nexport = Point;\n",
    "import Point\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\n\n/**\n * A Rectangle object is an area defined by its position, as indicated by its\n * top-left corner point(<i>x</i>, <i>y</i>) and by its width and its height.\n *\n *\n * <p>The <code>x</code>, <code>y</code>, <code>width</code>, and\n * <code>height</code> properties of the Rectangle class are independent of\n * each other; changing the value of one property has no effect on the others.\n * However, the <code>right</code> and <code>bottom</code> properties are\n * integrally related to those four properties. For example, if you change the\n * value of the <code>right</code> property, the value of the\n * <code>width</code> property changes; if you change the <code>bottom</code>\n * property, the value of the <code>height</code> property changes. </p>\n *\n * <p>The following methods and properties use Rectangle objects:</p>\n *\n * <ul>\n *   <li>The <code>applyFilter()</code>, <code>colorTransform()</code>,\n * <code>copyChannel()</code>, <code>copyPixels()</code>, <code>draw()</code>,\n * <code>fillRect()</code>, <code>generateFilterRect()</code>,\n * <code>getColorBoundsRect()</code>, <code>getPixels()</code>,\n * <code>merge()</code>, <code>paletteMap()</code>,\n * <code>pixelDisolve()</code>, <code>setPixels()</code>, and\n * <code>threshold()</code> methods, and the <code>rect</code> property of the\n * BitmapData class</li>\n *   <li>The <code>getBounds()</code> and <code>getRect()</code> methods, and\n * the <code>scrollRect</code> and <code>scale9Grid</code> properties of the\n * DisplayObject class</li>\n *   <li>The <code>getCharBoundaries()</code> method of the TextField\n * class</li>\n *   <li>The <code>pixelBounds</code> property of the Transform class</li>\n *   <li>The <code>bounds</code> parameter for the <code>startDrag()</code>\n * method of the Sprite class</li>\n *   <li>The <code>printArea</code> parameter of the <code>addPage()</code>\n * method of the PrintJob class</li>\n * </ul>\n *\n * <p>You can use the <code>new Rectangle()</code> constructor to create a\n * Rectangle object.</p>\n *\n * <p><b>Note:</b> The Rectangle class does not define a rectangular Shape\n * display object. To draw a rectangular Shape object onscreen, use the\n * <code>drawRect()</code> method of the Graphics class.</p>\n */\nclass Rectangle\n{\n\tprivate _size:Point;\n\tprivate _bottomRight:Point;\n\tprivate _topLeft:Point;\n\n\t/**\n\t * The height of the rectangle, in pixels. Changing the <code>height</code>\n\t * value of a Rectangle object has no effect on the <code>x</code>,\n\t * <code>y</code>, and <code>width</code> properties.\n\t */\n\tpublic height:number;\n\n\t/**\n\t * The width of the rectangle, in pixels. Changing the <code>width</code>\n\t * value of a Rectangle object has no effect on the <code>x</code>,\n\t * <code>y</code>, and <code>height</code> properties.\n\t */\n\tpublic width:number;\n\n\t/**\n\t * The <i>x</i> coordinate of the top-left corner of the rectangle. Changing\n\t * the value of the <code>x</code> property of a Rectangle object has no\n\t * effect on the <code>y</code>, <code>width</code>, and <code>height</code>\n\t * properties.\n\t *\n\t * <p>The value of the <code>x</code> property is equal to the value of the\n\t * <code>left</code> property.</p>\n\t */\n\tpublic x:number;\n\n\t/**\n\t * The <i>y</i> coordinate of the top-left corner of the rectangle. Changing\n\t * the value of the <code>y</code> property of a Rectangle object has no\n\t * effect on the <code>x</code>, <code>width</code>, and <code>height</code>\n\t * properties.\n\t *\n\t * <p>The value of the <code>y</code> property is equal to the value of the\n\t * <code>top</code> property.</p>\n\t */\n\tpublic y:number;\n\n\t/**\n\t * The sum of the <code>y</code> and <code>height</code> properties.\n\t */\n\tpublic get bottom():number\n\t{\n\t\treturn this.y + this.height;\n\t}\n\n\t/**\n\t * The location of the Rectangle object's bottom-right corner, determined by\n\t * the values of the <code>right</code> and <code>bottom</code> properties.\n\t */\n\tpublic get bottomRight():Point\n\t{\n\t\tif (this._bottomRight == null)\n\t\t\tthis._bottomRight = new Point();\n\n\t\tthis._bottomRight.x = this.x + this.width;\n\t\tthis._bottomRight.y = this.y + this.height;\n\n\t\treturn this._bottomRight;\n\t}\n\n\t/**\n\t * The <i>x</i> coordinate of the top-left corner of the rectangle. Changing\n\t * the <code>left</code> property of a Rectangle object has no effect on the\n\t * <code>y</code> and <code>height</code> properties. However it does affect\n\t * the <code>width</code> property, whereas changing the <code>x</code> value\n\t * does <i>not</i> affect the <code>width</code> property.\n\t *\n\t * <p>The value of the <code>left</code> property is equal to the value of\n\t * the <code>x</code> property.</p>\n\t */\n\tpublic get left():number\n\t{\n\t\treturn this.x;\n\t}\n\n\t/**\n\t * The sum of the <code>x</code> and <code>width</code> properties.\n\t */\n\tpublic get right():number\n\t{\n\t\treturn this.x + this.width;\n\t}\n\n\t/**\n\t * The size of the Rectangle object, expressed as a Point object with the\n\t * values of the <code>width</code> and <code>height</code> properties.\n\t */\n\tpublic get size():Point\n\t{\n\t\tif (this._size == null)\n\t\t\tthis._size = new Point();\n\n\t\tthis._size.x = this.width;\n\t\tthis._size.y = this.height;\n\n\t\treturn this._size;\n\t}\n\n\t/**\n\t * The <i>y</i> coordinate of the top-left corner of the rectangle. Changing\n\t * the <code>top</code> property of a Rectangle object has no effect on the\n\t * <code>x</code> and <code>width</code> properties. However it does affect\n\t * the <code>height</code> property, whereas changing the <code>y</code>\n\t * value does <i>not</i> affect the <code>height</code> property.\n\t *\n\t * <p>The value of the <code>top</code> property is equal to the value of the\n\t * <code>y</code> property.</p>\n\t */\n\tpublic get top():number\n\t{\n\t\treturn this.y;\n\t}\n\n\t/**\n\t * The location of the Rectangle object's top-left corner, determined by the\n\t * <i>x</i> and <i>y</i> coordinates of the point.\n\t */\n\tpublic get topLeft():Point\n\t{\n\t\tif (this._topLeft == null)\n\t\t\tthis._topLeft = new Point();\n\n\t\tthis._topLeft.x = this.x;\n\t\tthis._topLeft.y = this.y;\n\n\t\treturn this._topLeft;\n\t}\n\n\t/**\n\t * Creates a new Rectangle object with the top-left corner specified by the\n\t * <code>x</code> and <code>y</code> parameters and with the specified\n\t * <code>width</code> and <code>height</code> parameters. If you call this\n\t * public without parameters, a rectangle with <code>x</code>,\n\t * <code>y</code>, <code>width</code>, and <code>height</code> properties set\n\t * to 0 is created.\n\t *\n\t * @param x      The <i>x</i> coordinate of the top-left corner of the\n\t *               rectangle.\n\t * @param y      The <i>y</i> coordinate of the top-left corner of the\n\t *               rectangle.\n\t * @param width  The width of the rectangle, in pixels.\n\t * @param height The height of the rectangle, in pixels.\n\t */\n\tconstructor(x:number = 0, y:number = 0, width:number = 0, height:number = 0)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t}\n\n\t/**\n\t * Returns a new Rectangle object with the same values for the\n\t * <code>x</code>, <code>y</code>, <code>width</code>, and\n\t * <code>height</code> properties as the original Rectangle object.\n\t *\n\t * @return A new Rectangle object with the same values for the\n\t *         <code>x</code>, <code>y</code>, <code>width</code>, and\n\t *         <code>height</code> properties as the original Rectangle object.\n\t */\n\tpublic clone():Rectangle\n\t{\n\t\treturn new Rectangle(this.x, this.y, this.width, this.height);\n\t}\n\n\t/**\n\t * Determines whether the specified point is contained within the rectangular\n\t * region defined by this Rectangle object.\n\t *\n\t * @param x The <i>x</i> coordinate(horizontal position) of the point.\n\t * @param y The <i>y</i> coordinate(vertical position) of the point.\n\t * @return A value of <code>true</code> if the Rectangle object contains the\n\t *         specified point; otherwise <code>false</code>.\n\t */\n\tpublic contains(x:number, y:number):boolean\n\t{\n\t\treturn (this.x <= x && this.x + this.width >= x && this.y <= y && this.y + this.height >= y);\n\t}\n\n\t/**\n\t * Determines whether the specified point is contained within the rectangular\n\t * region defined by this Rectangle object. This method is similar to the\n\t * <code>Rectangle.contains()</code> method, except that it takes a Point\n\t * object as a parameter.\n\t *\n\t * @param point The point, as represented by its <i>x</i> and <i>y</i>\n\t *              coordinates.\n\t * @return A value of <code>true</code> if the Rectangle object contains the\n\t *         specified point; otherwise <code>false</code>.\n\t */\n\tpublic containsPoint(point:Point):boolean\n\t{\n\t\treturn (this.x <= point.x && this.x + this.width >= point.x && this.y <= point.y && this.y + this.height >= point.y);\n\t}\n\n\t/**\n\t * Determines whether the Rectangle object specified by the <code>rect</code>\n\t * parameter is contained within this Rectangle object. A Rectangle object is\n\t * said to contain another if the second Rectangle object falls entirely\n\t * within the boundaries of the first.\n\t *\n\t * @param rect The Rectangle object being checked.\n\t * @return A value of <code>true</code> if the Rectangle object that you\n\t *         specify is contained by this Rectangle object; otherwise\n\t *         <code>false</code>.\n\t */\n\tpublic containsRect(rect:Rectangle):boolean\n\t{\n\t\treturn (this.x <= rect.x && this.x + this.width >= rect.x + rect.width && this.y <= rect.y && this.y + this.height >= rect.y + rect.height)\n\t}\n\n\t/**\n\t * Copies all of rectangle data from the source Rectangle object into the\n\t * calling Rectangle object.\n\t *\n\t * @param sourceRect The Rectangle object from which to copy the data.\n\t */\n\tpublic copyFrom(sourceRect:Rectangle)\n\t{\n\n\t}\n\n\t/**\n\t * Determines whether the object specified in the <code>toCompare</code>\n\t * parameter is equal to this Rectangle object. This method compares the\n\t * <code>x</code>, <code>y</code>, <code>width</code>, and\n\t * <code>height</code> properties of an object against the same properties of\n\t * this Rectangle object.\n\t *\n\t * @param toCompare The rectangle to compare to this Rectangle object.\n\t * @return A value of <code>true</code> if the object has exactly the same\n\t *         values for the <code>x</code>, <code>y</code>, <code>width</code>,\n\t *         and <code>height</code> properties as this Rectangle object;\n\t *         otherwise <code>false</code>.\n\t */\n\tpublic equals(toCompare:Rectangle):boolean\n\t{\n\t\treturn (this.x == toCompare.x && this.y == toCompare.y && this.width == toCompare.width && this.height == toCompare.height)\n\t}\n\n\t/**\n\t * Increases the size of the Rectangle object by the specified amounts, in\n\t * pixels. The center point of the Rectangle object stays the same, and its\n\t * size increases to the left and right by the <code>dx</code> value, and to\n\t * the top and the bottom by the <code>dy</code> value.\n\t *\n\t * @param dx The value to be added to the left and the right of the Rectangle\n\t *           object. The following equation is used to calculate the new\n\t *           width and position of the rectangle:\n\t * @param dy The value to be added to the top and the bottom of the\n\t *           Rectangle. The following equation is used to calculate the new\n\t *           height and position of the rectangle:\n\t */\n\tpublic inflate(dx:number, dy:number)\n\t{\n\t\tthis.x -= dx/2;\n\t\tthis.y -= dy/2;\n\t\tthis.width += dx/2;\n\t\tthis.height += dy/2;\n\t}\n\n\t/**\n\t * Increases the size of the Rectangle object. This method is similar to the\n\t * <code>Rectangle.inflate()</code> method except it takes a Point object as\n\t * a parameter.\n\t *\n\t * <p>The following two code examples give the same result:</p>\n\t *\n\t * @param point The <code>x</code> property of this Point object is used to\n\t *              increase the horizontal dimension of the Rectangle object.\n\t *              The <code>y</code> property is used to increase the vertical\n\t *              dimension of the Rectangle object.\n\t */\n\tpublic inflatePoint(point:Point)\n\t{\n\t\tthis.x -= point.x/2;\n\t\tthis.y -= point.y/2;\n\t\tthis.width += point.x/2;\n\t\tthis.height += point.y/2;\n\t}\n\n\t/**\n\t * If the Rectangle object specified in the <code>toIntersect</code>\n\t * parameter intersects with this Rectangle object, returns the area of\n\t * intersection as a Rectangle object. If the rectangles do not intersect,\n\t * this method returns an empty Rectangle object with its properties set to\n\t * 0.\n\t *\n\t * @param toIntersect The Rectangle object to compare against to see if it\n\t *                    intersects with this Rectangle object.\n\t * @return A Rectangle object that equals the area of intersection. If the\n\t *         rectangles do not intersect, this method returns an empty\n\t *         Rectangle object; that is, a rectangle with its <code>x</code>,\n\t *         <code>y</code>, <code>width</code>, and <code>height</code>\n\t *         properties set to 0.\n\t */\n\tpublic intersection(toIntersect:Rectangle):Rectangle\n\t{\n\t\tif (this.intersects(toIntersect)) {\n\t\t\tvar i:Rectangle = new Rectangle();\n\n\t\t\tif (this.x > toIntersect.x) {\n\t\t\t\ti.x = this.x;\n\t\t\t\ti.width = toIntersect.x - this.x + toIntersect.width;\n\n\t\t\t\tif (i.width > this.width)\n\t\t\t\t\ti.width = this.width;\n\t\t\t} else {\n\t\t\t\ti.x = toIntersect.x;\n\t\t\t\ti.width = this.x - toIntersect.x + this.width;\n\n\t\t\t\tif (i.width > toIntersect.width)\n\t\t\t\t\ti.width = toIntersect.width;\n\t\t\t}\n\n\t\t\tif (this.y > toIntersect.y) {\n\t\t\t\ti.y = this.y;\n\t\t\t\ti.height = toIntersect.y - this.y + toIntersect.height;\n\n\t\t\t\tif (i.height > this.height)\n\t\t\t\t\ti.height = this.height;\n\t\t\t} else {\n\t\t\t\ti.y = toIntersect.y;\n\t\t\t\ti.height = this.y - toIntersect.y + this.height;\n\n\t\t\t\tif (i.height > toIntersect.height)\n\t\t\t\t\ti.height = toIntersect.height;\n\t\t\t}\n\n\t\t\treturn i;\n\t\t}\n\n\t\treturn new Rectangle();\n\t}\n\n\t/**\n\t * Determines whether the object specified in the <code>toIntersect</code>\n\t * parameter intersects with this Rectangle object. This method checks the\n\t * <code>x</code>, <code>y</code>, <code>width</code>, and\n\t * <code>height</code> properties of the specified Rectangle object to see if\n\t * it intersects with this Rectangle object.\n\t *\n\t * @param toIntersect The Rectangle object to compare against this Rectangle\n\t *                    object.\n\t * @return A value of <code>true</code> if the specified object intersects\n\t *         with this Rectangle object; otherwise <code>false</code>.\n\t */\n\tpublic intersects(toIntersect:Rectangle):boolean\n\t{\n\t\treturn (this.x + this.width > toIntersect.x && this.x < toIntersect.x + toIntersect.width && this.y + this.height > toIntersect.y && this.y < toIntersect.y + toIntersect.height);\n\t}\n\n\t/**\n\t * Determines whether or not this Rectangle object is empty.\n\t *\n\t * @return A value of <code>true</code> if the Rectangle object's width or\n\t *         height is less than or equal to 0; otherwise <code>false</code>.\n\t */\n\tpublic isEmpty():boolean\n\t{\n\t\treturn (this.x == 0 && this.y == 0 && this.width == 0 && this.height == 0);\n\t}\n\n\t/**\n\t * Adjusts the location of the Rectangle object, as determined by its\n\t * top-left corner, by the specified amounts.\n\t *\n\t * @param dx Moves the <i>x</i> value of the Rectangle object by this amount.\n\t * @param dy Moves the <i>y</i> value of the Rectangle object by this amount.\n\t */\n\tpublic offset(dx:number, dy:number)\n\t{\n\t\tthis.x += dx;\n\t\tthis.y += dy;\n\t}\n\n\t/**\n\t * Adjusts the location of the Rectangle object using a Point object as a\n\t * parameter. This method is similar to the <code>Rectangle.offset()</code>\n\t * method, except that it takes a Point object as a parameter.\n\t *\n\t * @param point A Point object to use to offset this Rectangle object.\n\t */\n\tpublic offsetPoint(point:Point)\n\t{\n\t\tthis.x += point.x;\n\t\tthis.y += point.y;\n\t}\n\n\t/**\n\t * Sets all of the Rectangle object's properties to 0. A Rectangle object is\n\t * empty if its width or height is less than or equal to 0.\n\t *\n\t * <p> This method sets the values of the <code>x</code>, <code>y</code>,\n\t * <code>width</code>, and <code>height</code> properties to 0.</p>\n\t *\n\t */\n\tpublic setEmpty()\n\t{\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t}\n\n\t/**\n\t * Sets the members of Rectangle to the specified values\n\t *\n\t * @param xa      The <i>x</i> coordinate of the top-left corner of the\n\t *                rectangle.\n\t * @param ya      The <i>y</i> coordinate of the top-left corner of the\n\t *                rectangle.\n\t * @param widtha  The width of the rectangle, in pixels.\n\t * @param heighta The height of the rectangle, in pixels.\n\t */\n\tpublic setTo(xa:number, ya:number, widtha:number, heighta:number)\n\t{\n\t\tthis.x = xa;\n\t\tthis.y = ya;\n\t\tthis.width = widtha;\n\t\tthis.height = heighta;\n\t}\n\n\t/**\n\t * Builds and returns a string that lists the horizontal and vertical\n\t * positions and the width and height of the Rectangle object.\n\t *\n\t * @return A string listing the value of each of the following properties of\n\t *         the Rectangle object: <code>x</code>, <code>y</code>,\n\t *         <code>width</code>, and <code>height</code>.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn \"[Rectangle] (x=\" + this.x + \", y=\" + this.y + \", width=\" + this.width + \", height=\" + this.height + \")\";\n\t}\n\n\t/**\n\t * Adds two rectangles together to create a new Rectangle object, by filling\n\t * in the horizontal and vertical space between the two rectangles.\n\t *\n\t * <p><b>Note:</b> The <code>union()</code> method ignores rectangles with\n\t * <code>0</code> as the height or width value, such as: <code>var\n\t * rect2:Rectangle = new Rectangle(300,300,50,0);</code></p>\n\t *\n\t * @param toUnion A Rectangle object to add to this Rectangle object.\n\t * @return A new Rectangle object that is the union of the two rectangles.\n\t */\n\tpublic union(toUnion:Rectangle):Rectangle\n\t{\n\t\tvar u:Rectangle = new Rectangle();\n\n\t\tif (this.x < toUnion.x) {\n\t\t\tu.x = this.x;\n\t\t\tu.width = toUnion.x - this.x + toUnion.width;\n\n\t\t\tif (u.width < this.width)\n\t\t\t\tu.width = this.width;\n\t\t} else {\n\t\t\tu.x = toUnion.x;\n\t\t\tu.width = this.x - toUnion.x + this.width;\n\n\t\t\tif (u.width < toUnion.width)\n\t\t\t\tu.width = toUnion.width;\n\t\t}\n\n\t\tif (this.y < toUnion.y) {\n\t\t\tu.y = this.y;\n\t\t\tu.height = toUnion.y - this.y + toUnion.height;\n\n\t\t\tif (u.height < this.height)\n\t\t\t\tu.height = this.height;\n\t\t} else {\n\t\t\tu.y = toUnion.y;\n\t\t\tu.height = this.y - toUnion.y + this.height;\n\n\t\t\tif (u.height < toUnion.height)\n\t\t\t\tu.height = toUnion.height;\n\t\t}\n\n\t\treturn u;\n\t}\n}\n\nexport = Rectangle;",
    "/**\n * The Vector3D class represents a point or a location in the three-dimensional\n * space using the Cartesian coordinates x, y, and z. As in a two-dimensional\n * space, the x property represents the horizontal axis and the y property\n * represents the vertical axis. In three-dimensional space, the z property\n * represents depth. The value of the x property increases as the object moves\n * to the right. The value of the y property increases as the object moves\n * down. The z property increases as the object moves farther from the point\n * of view. Using perspective projection and scaling, the object is seen to be\n * bigger when near and smaller when farther away from the screen. As in a\n * right-handed three-dimensional coordinate system, the positive z-axis points\n * away from the viewer and the value of the z property increases as the object\n * moves away from the viewer's eye. The origin point (0,0,0) of the global\n * space is the upper-left corner of the stage.\n *\n * <p>The Vector3D class can also represent a direction, an arrow pointing from\n * the origin of the coordinates, such as (0,0,0), to an endpoint; or a\n * floating-point component of an RGB (Red, Green, Blue) color model.</p>\n *\n * <p>Quaternion notation introduces a fourth element, the w property, which\n * provides additional orientation information. For example, the w property can\n * define an angle of rotation of a Vector3D object. The combination of the\n * angle of rotation and the coordinates x, y, and z can determine the display\n * object's orientation. Here is a representation of Vector3D elements in\n * matrix notation:</p>\n */\nclass Vector3D\n{\n\t/**\n\t * The x axis defined as a Vector3D object with coordinates (1,0,0).\n\t */\n\tpublic static X_AXIS:Vector3D = new Vector3D(1, 0, 0);\n\n\t/**\n\t * The y axis defined as a Vector3D object with coordinates (0,1,0).\n\t */\n\tpublic static Y_AXIS:Vector3D = new Vector3D(0, 1, 0);\n\n\t/**\n\t * The z axis defined as a Vector3D object with coordinates (0,0,1).\n\t */\n\tpublic static Z_AXIS:Vector3D = new Vector3D(0, 0, 1);\n\n\t/**\n\t * The first element of a Vector3D object, such as the x coordinate of\n\t * a point in the three-dimensional space. The default value is 0.\n\t */\n\tpublic x:number;\n\n\t/*\n\t *The second element of a Vector3D object, such as the y coordinate of\n\t * a point in the three-dimensional space. The default value is 0.\n\t */\n\tpublic y:number;\n\n\t/**\n\t * The third element of a Vector3D object, such as the y coordinate of\n\t * a point in the three-dimensional space. The default value is 0.\n\t */\n\tpublic z:number;\n\n\t/**\n\t * TThe fourth element of a Vector3D object (in addition to the x, y,\n\t * and z properties) can hold data such as the angle of rotation. The\n\t * default value is 0.\n\t *\n\t * <p>Quaternion notation employs an angle as the fourth element in\n\t * its calculation of three-dimensional rotation. The w property can\n\t * be used to define the angle of rotation about the Vector3D object.\n\t * The combination of the rotation angle and the coordinates (x,y,z)\n\t * determines the display object's orientation.</p>\n\t *\n\t * <p>In addition, the w property can be used as a perspective warp\n\t * factor for a projected three-dimensional position or as a projection\n\t * transform value in representing a three-dimensional coordinate\n\t * projected into the two-dimensional space. For example, you can\n\t * create a projection matrix using the <code>Matrix3D.rawData</code>\n\t * property, that, when applied to a Vector3D object, produces a\n\t * transform value in the Vector3D object's fourth element (the w\n\t * property). Dividing the Vector3D object's other elements by the\n\t * transform value then produces a projected Vector3D object. You can\n\t * use the <code>Vector3D.project()</code> method to divide the first\n\t * three elements of a Vector3D object by its fourth element.</p>\n\t */\n\tpublic w:number;\n\n\t/**\n\t * The length, magnitude, of the current Vector3D object from the\n\t * origin (0,0,0) to the object's x, y, and z coordinates. The w\n\t * property is ignored. A unit vector has a length or magnitude of\n\t * one.\n\t */\n\tpublic get length():number\n\t{\n\t\treturn Math.sqrt(this.lengthSquared);\n\t}\n\n\t/**\n\t * The square of the length of the current Vector3D object, calculated\n\t * using the x, y, and z properties. The w property is ignored. Use the\n\t * <code>lengthSquared()</code> method whenever possible instead of the\n\t * slower <code>Math.sqrt()</code> method call of the\n\t * <code>Vector3D.length()</code> method.\n\t */\n\tpublic get lengthSquared():number\n\t{\n\t\treturn this.x*this.x + this.y*this.y + this.z*this.z;\n\t}\n\n\t/**\n\t * Creates an instance of a Vector3D object. If you do not specify a\n\t * parameter for the constructor, a Vector3D object is created with\n\t * the elements (0,0,0,0).\n\t *\n\t * @param x The first element, such as the x coordinate.\n\t * @param y The second element, such as the y coordinate.\n\t * @param z The third element, such as the z coordinate.\n\t * @param w An optional element for additional data such as the angle\n\t *          of rotation.\n\t */\n\tconstructor(x:number = 0, y:number = 0, z:number = 0, w:number = 0)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.w = w;\n\t}\n\n\t/**\n\t * Adds the value of the x, y, and z elements of the current Vector3D\n\t * object to the values of the x, y, and z elements of another Vector3D\n\t * object. The <code>add()</code> method does not change the current\n\t * Vector3D object. Instead, it returns a new Vector3D object with\n\t * the new values.\n\t *\n\t * <p>The result of adding two vectors together is a resultant vector.\n\t * One way to visualize the result is by drawing a vector from the\n\t * origin or tail of the first vector to the end or head of the second\n\t * vector. The resultant vector is the distance between the origin\n\t * point of the first vector and the end point of the second vector.\n\t * </p>\n\t */\n\tpublic add(a:Vector3D):Vector3D\n\t{\n\t\treturn new Vector3D(this.x + a.x, this.y + a.y, this.z + a.z, this.w + a.w)\n\t}\n\n\t/**\n\t * Returns the angle in radians between two vectors. The returned angle\n\t * is the smallest radian the first Vector3D object rotates until it\n\t * aligns with the second Vector3D object.\n\t *\n\t * <p>The <code>angleBetween()</code> method is a static method. You\n\t * can use it directly as a method of the Vector3D class.</p>\n\t *\n\t * <p>To convert a degree to a radian, you can use the following\n\t * formula:</p>\n\t *\n\t * <p><code>radian = Math.PI/180 * degree</code></p>\n\t *\n\t * @param a The first Vector3D object.\n\t * @param b The second Vector3D object.\n\t * @returns The angle between two Vector3D objects.\n\t */\n\tpublic static angleBetween(a:Vector3D, b:Vector3D):number\n\t{\n\t\treturn Math.acos(a.dotProduct(b)/(a.length*b.length));\n\t}\n\n\t/**\n\t * Returns a new Vector3D object that is an exact copy of the current\n\t * Vector3D object.\n\t *\n\t * @returns A new Vector3D object that is a copy of the current\n\t * Vector3D object.\n\t */\n\tpublic clone():Vector3D\n\t{\n\t\treturn new Vector3D(this.x, this.y, this.z, this.w);\n\t}\n\n\t/**\n\t * Copies all of vector data from the source Vector3D object into the\n\t * calling Vector3D object.\n\t *\n\t * @param src The Vector3D object from which to copy the data.\n\t */\n\tpublic copyFrom(src:Vector3D):void\n\t{\n\t\tthis.x = src.x;\n\t\tthis.y = src.y;\n\t\tthis.z = src.z;\n\t\tthis.w = src.w;\n\t}\n\n\t/**\n\t * Returns a new Vector3D object that is perpendicular (at a right\n\t * angle) to the current Vector3D and another Vector3D object. If the\n\t * returned Vector3D object's coordinates are (0,0,0), then the two\n\t * Vector3D objects are parallel to each other.\n\t *\n\t * <p>You can use the normalized cross product of two vertices of a\n\t * polygon surface with the normalized vector of the camera or eye\n\t * viewpoint to get a dot product. The value of the dot product can\n\t * identify whether a surface of a three-dimensional object is hidden\n\t * from the viewpoint.</p>\n\t *\n\t * @param a A second Vector3D object.\n\t * @returns A new Vector3D object that is perpendicular to the current\n\t *          Vector3D object and the Vector3D object specified as the\n\t *          parameter.\n\t */\n\tpublic crossProduct(a:Vector3D):Vector3D\n\t{\n\t\treturn new Vector3D(this.y*a.z - this.z*a.y, this.z*a.x - this.x*a.z, this.x*a.y - this.y*a.x, 1);\n\t}\n\n\t/**\n\t * Decrements the value of the x, y, and z elements of the current\n\t * Vector3D object by the values of the x, y, and z elements of\n\t * specified Vector3D object. Unlike the\n\t * <code>Vector3D.subtract()</code> method, the\n\t * <code>decrementBy()</code> method changes the current Vector3D\n\t * object and does not return a new Vector3D object.\n\t *\n\t * @param a The Vector3D object containing the values to subtract from\n\t *          the current Vector3D object.\n\t */\n\tpublic decrementBy(a:Vector3D)\n\t{\n\t\tthis.x -= a.x;\n\t\tthis.y -= a.y;\n\t\tthis.z -= a.z;\n\t}\n\n\t/**\n\t * Returns the distance between two Vector3D objects. The\n\t * <code>distance()</code> method is a static method. You can use it\n\t * directly as a method of the Vector3D class to get the Euclidean\n\t * distance between two three-dimensional points.\n\t *\n\t * @param pt1 A Vector3D object as the first three-dimensional point.\n\t * @param pt2 A Vector3D object as the second three-dimensional point.\n\t * @returns The distance between two Vector3D objects.\n\t */\n\tstatic distance(pt1:Vector3D, pt2:Vector3D):number\n\t{\n\t\tvar x:number = (pt1.x - pt2.x);\n\t\tvar y:number = (pt1.y - pt2.y);\n\t\tvar z:number = (pt1.z - pt2.z);\n\t\treturn Math.sqrt(x*x + y*y + z*z);\n\t}\n\n\t/**\n\t * If the current Vector3D object and the one specified as the\n\t * parameter are unit vertices, this method returns the cosine of the\n\t * angle between the two vertices. Unit vertices are vertices that\n\t * point to the same direction but their length is one. They remove the\n\t * length of the vector as a factor in the result. You can use the\n\t * <code>normalize()</code> method to convert a vector to a unit\n\t * vector.\n\t *\n\t * <p>The <code>dotProduct()</code> method finds the angle between two\n\t * vertices. It is also used in backface culling or lighting\n\t * calculations. Backface culling is a procedure for determining which\n\t * surfaces are hidden from the viewpoint. You can use the normalized\n\t * vertices from the camera, or eye, viewpoint and the cross product of\n\t * the vertices of a polygon surface to get the dot product. If the dot\n\t * product is less than zero, then the surface is facing the camera or\n\t * the viewer. If the two unit vertices are perpendicular to each\n\t * other, they are orthogonal and the dot product is zero. If the two\n\t * vertices are parallel to each other, the dot product is one.</p>\n\t *\n\t * @param a The second Vector3D object.\n\t * @returns A scalar which is the dot product of the current Vector3D\n\t *          object and the specified Vector3D object.\n\t *\n\t * @see away.geom.Vector3D#crossProduct()\n\t * @see away.geom.Vector3D#normalize()\n\t */\n\tpublic dotProduct(a:Vector3D):number\n\t{\n\t\treturn this.x*a.x + this.y*a.y + this.z*a.z;\n\t}\n\n\t/**\n\t * Determines whether two Vector3D objects are equal by comparing the\n\t * x, y, and z elements of the current Vector3D object with a\n\t * specified Vector3D object. If the values of these elements are the\n\t * same, the two Vector3D objects are equal. If the second optional\n\t * parameter is set to true, all four elements of the Vector3D objects,\n\t * including the w property, are compared.\n\t */\n\n\t/**\n\t *\n\t * @param toCompare The Vector3D object to be compared with the current\n\t *                  Vector3D object.\n\t * @param allFour   An optional parameter that specifies whether the w\n\t *                  property of the Vector3D objects is used in the\n\t *                  comparison.\n\t * @returns A value of true if the specified Vector3D object is equal\n\t *          to the current Vector3D object; false if it is not equal.\n\t */\n\tpublic equals(toCompare:Vector3D, allFour:boolean = false):boolean\n\t{\n\t\treturn (this.x == toCompare.x && this.y == toCompare.y && this.z == toCompare.z && (!allFour || this.w == toCompare.w ));\n\t}\n\n\t/**\n\t * Increments the value of the x, y, and z elements of the current\n\t * Vector3D object by the values of the x, y, and z elements of a\n\t * specified Vector3D object. Unlike the <code>Vector3D.add()</code>\n\t * method, the <code>incrementBy()</code> method changes the current\n\t * Vector3D object and does not return a new Vector3D object.\n\t *\n\t * @param a The Vector3D object to be added to the current Vector3D\n\t *          object.\n\t */\n\tpublic incrementBy(a:Vector3D)\n\t{\n\t\tthis.x += a.x;\n\t\tthis.y += a.y;\n\t\tthis.z += a.z;\n\t}\n\n\t/**\n\t * Compares the elements of the current Vector3D object with the\n\t * elements of a specified Vector3D object to determine whether they\n\t * are nearly equal. The two Vector3D objects are nearly equal if the\n\t * value of all the elements of the two vertices are equal, or the\n\t * result of the comparison is within the tolerance range. The\n\t * difference between two elements must be less than the number\n\t * specified as the tolerance parameter. If the third optional\n\t * parameter is set to <code>true</code>, all four elements of the\n\t * Vector3D objects, including the <code>w</code> property, are\n\t * compared. Otherwise, only the x, y, and z elements are included in\n\t * the comparison.\n\t */\n\n\t/**\n\t *\n\t * @param toCompare The Vector3D object to be compared with the current\n\t *                  Vector3D object.\n\t * @param tolerance A number determining the tolerance factor. If the\n\t *                  difference between the values of the Vector3D\n\t *                  element specified in the toCompare parameter and\n\t *                  the current Vector3D element is less than the\n\t *                  tolerance number, the two values are considered\n\t *                  nearly equal.\n\t * @param allFour   An optional parameter that specifies whether the w\n\t *                  property of the Vector3D objects is used in the\n\t *                  comparison.\n\t * @returns A value of true if the specified Vector3D object is nearly\n\t *          equal to the current Vector3D object; false if it is not\n\t *          equal.\n\t *\n\t * @see away.geom.Vector3D#equals()\n\t */\n\tpublic nearEquals(toCompare:Vector3D, tolerance:number, allFour:boolean = true):boolean\n\t{\n\t\treturn ((Math.abs(this.x - toCompare.x) < tolerance) && (Math.abs(this.y - toCompare.y) < tolerance) && (Math.abs(this.z - toCompare.z) < tolerance) && (!allFour || Math.abs(this.w - toCompare.w) < tolerance));\n\t}\n\n\t/**\n\t * Sets the current Vector3D object to its inverse. The inverse object\n\t * is also considered the opposite of the original object. The value of\n\t * the x, y, and z properties of the current Vector3D object is changed\n\t * to -x, -y, and -z.\n\t */\n\tpublic negate():void\n\t{\n\t\tthis.x = -this.x;\n\t\tthis.y = -this.y;\n\t\tthis.z = -this.z;\n\t}\n\n\t/**\n\t * Converts a Vector3D object to a unit vector by dividing the first\n\t * three elements (x, y, z) by the length of the vector. Unit vertices\n\t * are vertices that have a direction but their length is one. They\n\t * simplify vector calculations by removing length as a factor.\n\t */\n\t/**\n\t * Scales the line segment between(0,0) and the current point to a set\n\t * length.\n\t *\n\t * @param thickness The scaling value. For example, if the current\n\t *                  Vector3D object is (0,3,4), and you normalize it to\n\t *                  1, the point returned is at(0,0.6,0.8).\n\t */\n\tpublic normalize(thickness:number = 1)\n\t{\n\t\tif (this.length != 0) {\n\t\t\tvar invLength = thickness/this.length;\n\t\t\tthis.x *= invLength;\n\t\t\tthis.y *= invLength;\n\t\t\tthis.z *= invLength;\n\t\t\treturn;\n\t\t}\n\t}\n\n\t/**\n\t * Divides the value of the <code>x</code>, <code>y</code>, and\n\t * <code>z</code> properties of the current Vector3D object by the\n\t * value of its <code>w</code> property.\n\t *\n\t * <p>If the current Vector3D object is the result of multiplying a\n\t * Vector3D object by a projection Matrix3D object, the w property can\n\t * hold the transform value. The <code>project()</code> method then can\n\t * complete the projection by dividing the elements by the\n\t * <code>w</code> property. Use the <code>Matrix3D.rawData</code>\n\t * property to create a projection Matrix3D object.</p>\n\t */\n\tpublic project():void\n\t{\n\t\tthis.x /= this.w;\n\t\tthis.y /= this.w;\n\t\tthis.z /= this.w;\n\t}\n\n\t/**\n\t * Scales the current Vector3D object by a scalar, a magnitude. The\n\t * Vector3D object's x, y, and z elements are multiplied by the scalar\n\t * number specified in the parameter. For example, if the vector is\n\t * scaled by ten, the result is a vector that is ten times longer. The\n\t * scalar can also change the direction of the vector. Multiplying the\n\t * vector by a negative number reverses its direction.\n\t *\n\t * @param s A multiplier (scalar) used to scale a Vector3D object.\n\n\t */\n\tpublic scaleBy(s:number):void\n\t{\n\t\tthis.x *= s;\n\t\tthis.y *= s;\n\t\tthis.z *= s;\n\t}\n\n\t/**\n\t * Sets the members of Vector3D to the specified values\n\t *\n\t * @param xa The first element, such as the x coordinate.\n\t * @param ya The second element, such as the y coordinate.\n\t * @param za The third element, such as the z coordinate.\n\t */\n\tpublic setTo(xa:number, ya:number, za:number):void\n\t{\n\t\tthis.x = xa;\n\t\tthis.y = ya;\n\t\tthis.z = za;\n\t}\n\n\t/**\n\t * Subtracts the value of the x, y, and z elements of the current\n\t * Vector3D object from the values of the x, y, and z elements of\n\t * another Vector3D object. The <code>subtract()</code> method does not\n\t * change the current Vector3D object. Instead, this method returns a\n\t * new Vector3D object with the new values.\n\t *\n\t * @param a The Vector3D object to be subtracted from the current\n\t *          Vector3D object.\n\t * @returns A new Vector3D object that is the difference between the\n\t *          current Vector3D and the specified Vector3D object.\n\t *\n\t * @see away.geom.Vector3D#decrementBy()\n\t */\n\tpublic subtract(a:Vector3D):Vector3D\n\t{\n\t\treturn new Vector3D(this.x - a.x, this.y - a.y, this.z - a.z);\n\t}\n\n\t/**\n\t * Returns a string representation of the current Vector3D object. The\n\t * string contains the values of the x, y, and z properties.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn \"[Vector3D] (x:\" + this.x + \" ,y:\" + this.y + \", z\" + this.z + \", w:\" + this.w + \")\";\n\t}\n}\n\nexport = Vector3D;",
    "class AssetType\n{\n\tpublic static ANIMATION_NODE:string = 'animationNode';\n\tpublic static ANIMATION_SET:string = 'animationSet';\n\tpublic static ANIMATION_STATE:string = 'animationState';\n\tpublic static ANIMATOR:string = 'animator';\n\tpublic static BILLBOARD:string = 'billboard';\n\tpublic static CAMERA:string = 'camera';\n\tpublic static CONTAINER:string = 'container';\n\tpublic static EFFECTS_METHOD:string = 'effectsMethod';\n\tpublic static GEOMETRY:string = 'geometry';\n\tpublic static LINE_SEGMENT:string = 'lineSegment';\n\tpublic static LIGHT:string = 'light';\n\tpublic static LIGHT_PICKER:string = 'lightPicker';\n\tpublic static MATERIAL:string = 'material';\n\tpublic static MESH:string = 'mesh';\n\tpublic static TRIANGLE_SUB_MESH:string = 'triangleSubMesh';\n\tpublic static LINE_SUB_MESH:string = 'lineSubMesh';\n\tpublic static PRIMITIVE_PREFAB:string = 'primitivePrefab';\n\tpublic static SHADOW_MAP_METHOD:string = 'shadowMapMethod';\n\tpublic static SKELETON:string = 'skeleton';\n\tpublic static SKELETON_POSE:string = 'skeletonPose';\n\tpublic static SKYBOX:string = 'skybox';\n\tpublic static STATE_TRANSITION:string = 'stateTransition';\n\tpublic static TEXTURE:string = 'texture';\n\tpublic static TEXTURE_PROJECTOR:string = 'textureProjector';\n}\n\nexport = AssetType;",
    "import IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport AssetEvent\t\t\t\t= require(\"awayjs-core/lib/events/AssetEvent\");\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nclass NamedAssetBase extends EventDispatcher\n{\n\tpublic static ID_COUNT:number = 0;\n\n\tprivate _originalName:string;\n\tprivate _namespace:string;\n\tprivate _name:string;\n\tprivate _id:number;\n\tprivate _full_path:Array<string>;\n\n\tpublic static DEFAULT_NAMESPACE:string = 'default';\n\n\tconstructor(name:string = null)\n\t{\n\t\tsuper();\n\n\t\tthis._id = NamedAssetBase.ID_COUNT++;\n\n\t\tif (name == null)\n\t\t\tname = 'null';\n\n\t\tthis._name = name;\n\t\tthis._originalName = name;\n\n\t\tthis.updateFullPath();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * The original name used for this asset in the resource (e.g. file) in which\n\t * it was found. This may not be the same as <code>name</code>, which may\n\t * have changed due to of a name conflict.\n\t */\n\tpublic get originalName():string\n\t{\n\t\treturn this._originalName;\n\t}\n\n\t/**\n\t * A unique id for the asset, used to identify assets in an associative array\n\t */\n\tpublic get id():number\n\t{\n\t\treturn this._id;\n\t}\n\n\tpublic get name():string\n\t{\n\t\treturn this._name;\n\t}\n\n\tpublic set name(val:string)\n\t{\n\t\tvar prev:string;\n\n\t\tprev = this._name;\n\t\tthis._name = val;\n\n\t\tif (this._name == null)\n\t\t\tthis._name = 'null';\n\n\t\tthis.updateFullPath();\n\n\t\t//if (hasEventListener(AssetEvent.ASSET_RENAME))\n\t\tthis.dispatchEvent(new AssetEvent(AssetEvent.ASSET_RENAME, <IAsset> this, prev));\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic get assetNamespace():string\n\t{\n\t\treturn this._namespace;\n\t}\n\n\tpublic get assetFullPath():Array<string>\n\t{\n\t\treturn this._full_path;\n\t}\n\n\tpublic assetPathEquals(name:string, ns:string):boolean\n\t{\n\t\treturn (this._name == name && (!ns || this._namespace == ns));\n\t}\n\n\tpublic resetAssetPath(name:string, ns:string = null, overrideOriginal:boolean = true):void\n\t{\n\n\t\tthis._name = name? name : 'null';\n\t\tthis._namespace = ns? ns : NamedAssetBase.DEFAULT_NAMESPACE;\n\n\t\tif (overrideOriginal)\n\t\t\tthis._originalName = this._name;\n\n\t\tthis.updateFullPath();\n\t}\n\n\tprivate updateFullPath():void\n\t{\n\t\tthis._full_path = [ this._namespace, this._name ];\n\t}\n}\n\nexport = NamedAssetBase;",
    "import URLLoaderDataFormat\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport URLRequestMethod\t\t\t\t= require(\"awayjs-core/lib/net/URLRequestMethod\");\nimport URLVariables\t\t\t\t\t= require(\"awayjs-core/lib/net/URLVariables\");\nimport AwayEvent\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport HTTPStatusEvent\t\t\t\t= require(\"awayjs-core/lib/events/HTTPStatusEvent\");\nimport IOErrorEvent\t\t\t\t\t= require(\"awayjs-core/lib/events/IOErrorEvent\");\nimport AwayProgressEvent\t\t\t= require(\"awayjs-core/lib/events/ProgressEvent\");\n\n/**\n * The URLLoader is used to load a single file, as part of a resource.\n *\n * While URLLoader can be used directly, e.g. to create a third-party asset\n * management system, it's recommended to use any of the classes Loader3D, AssetLoader\n * and AssetLibrary instead in most cases.\n *\n * @see AssetLoader\n * @see away.library.AssetLibrary\n */\nclass URLLoader extends EventDispatcher\n{\n\tprivate _XHR:XMLHttpRequest;\n\tprivate _bytesLoaded:number = 0;\n\tprivate _bytesTotal:number = 0;\n\tprivate _dataFormat:string = URLLoaderDataFormat.TEXT;\n\tprivate _loadError:boolean = false;\n\n\tprivate _request:URLRequest;\n\tprivate _data:any;\n\n\tprivate _loadStartEvent:AwayEvent;\n\tprivate _loadErrorEvent:IOErrorEvent;\n\tprivate _loadCompleteEvent:AwayEvent;\n\tprivate _progressEvent:AwayProgressEvent;\n\n\t/**\n\t * Creates a new URLLoader object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get url():string\n\t{\n\n\t\treturn this._request? this._request.url : '';\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get data():any\n\t{\n\t\treturn this._data;\n\t}\n\n\n\t/**\n\t *\n\t * URLLoaderDataFormat.BINARY\n\t * URLLoaderDataFormat.TEXT\n\t * URLLoaderDataFormat.VARIABLES\n\t *\n\t * @param format\n\t */\n\tpublic set dataFormat(format:string)\n\t{\n\t\tthis._dataFormat = format;\n\t}\n\n\tpublic get dataFormat():string\n\t{\n\t\treturn this._dataFormat;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get bytesLoaded():number\n\t{\n\t\treturn this._bytesLoaded;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get bytesTotal():number\n\t{\n\t\treturn this._bytesTotal;\n\t}\n\n\t/**\n\t * Load a resource from a file.\n\t *\n\t * @param request The URLRequest object containing the URL of the object to be loaded.\n\t */\n\tpublic load(request:URLRequest):void\n\t{\n\t\tthis._request = request;\n\n\t\tthis.initXHR();\n\n\t\tif (request.method === URLRequestMethod.POST)\n\t\t\tthis.postRequest(request);\n\t\telse\n\t\t\tthis.getRequest(request);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic close():void\n\t{\n\t\tthis._XHR.abort();\n\t\tthis.disposeXHR();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose():void\n\t{\n\t\tif (this._XHR)\n\t\t\tthis._XHR.abort();\n\n\t\tthis.disposeXHR();\n\n\t\tthis._data = null;\n\t\tthis._dataFormat = null;\n\t\tthis._bytesLoaded = null;\n\t\tthis._bytesTotal = null;\n\t}\n\n\t/**\n\t *\n\t * @param xhr\n\t * @param responseType\n\t */\n\tprivate setResponseType(xhr:XMLHttpRequest, responseType:string):void\n\t{\n\t\tswitch (responseType) {\n\t\t\tcase URLLoaderDataFormat.ARRAY_BUFFER:\n\t\t\tcase URLLoaderDataFormat.BLOB:\n\t\t\tcase URLLoaderDataFormat.TEXT:\n\t\t\t\txhr.responseType = responseType;\n\t\t\t\tbreak;\n\n\t\t\tcase URLLoaderDataFormat.VARIABLES:\n\t\t\t\txhr.responseType = URLLoaderDataFormat.TEXT;\n\t\t\t\tbreak;\n\n\t\t\tcase URLLoaderDataFormat.BINARY:\n\t\t\t\txhr.responseType = '';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param request {URLRequest}\n\t */\n\tprivate getRequest(request:URLRequest):void\n\t{\n\t\ttry {\n\t\t\tthis._XHR.open(request.method, request.url, request.async);\n\t\t\tthis.setResponseType(this._XHR, this._dataFormat);\n\t\t\tthis._XHR.send(); // No data to send\n\t\t} catch (e /* <XMLHttpRequestException> */) {\n\t\t\tthis.handleXmlHttpRequestException(e);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param request {URLRequest}\n\t */\n\tprivate postRequest(request:URLRequest):void\n\t{\n\t\tthis._loadError = false;\n\n\t\tthis._XHR.open(request.method, request.url, request.async);\n\n\t\tif (request.data != null) {\n\t\t\tif (request.data instanceof URLVariables) {\n\t\t\t\tvar urlVars:URLVariables = <URLVariables> request.data;\n\n\t\t\t\ttry {\n\t\t\t\t\tthis._XHR.responseType = 'text';\n\t\t\t\t\tthis._XHR.send(urlVars.formData);\n\t\t\t\t} catch (e /* <XMLHttpRequestException> */) {\n\t\t\t\t\tthis.handleXmlHttpRequestException(e);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.setResponseType(this._XHR, this._dataFormat);\n\n\t\t\t\tif (request.data)\n\t\t\t\t\tthis._XHR.send(request.data); // TODO: Test\n\t\t\t\telse\n\t\t\t\t\tthis._XHR.send(); // no data to send\n\t\t\t}\n\t\t} else {\n\t\t\tthis._XHR.send(); // No data to send\n\t\t}\n\n\t}\n\n\t/**\n\t *\n\t * @param error {XMLHttpRequestException}\n\t */\n\tprivate handleXmlHttpRequestException(error:any /* <XMLHttpRequestException> */):void\n\t{\n\t\tswitch (error.code) {\n\n\t\t/******************************************************************************************************************************************************************************************************\n\t\t *\n\t\t *  XMLHttpRequestException { message: \"NETWORK_ERR: XMLHttpRequest Exception 101\", name: \"NETWORK_ERR\", code: 101, stack: \"Error: A network error occurred in synchronous req…\",NETWORK_ERR: 101… }\n\t\t *  code: 101 , message: \"NETWORK_ERR: XMLHttpRequest Exception 101\" ,  name: \"NETWORK_ERR\"\n\t\t *\n\t\t ******************************************************************************************************************************************************************************************************/\n\n\t\t\tcase 101:\n\t\t\t\t// Note: onLoadError event throws IO_ERROR event - this case is already Covered\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initXHR()\n\t{\n\t\tif (!this._XHR) {\n\t\t\tthis._XHR = new XMLHttpRequest();\n\n\t\t\tthis._XHR.onloadstart = (event:ProgressEvent) => this.onLoadStart(event);                 // loadstart\t        - When the request starts.\n\t\t\tthis._XHR.onprogress = (event:ProgressEvent) => this.onProgress(event);\t                // progress\t            - While loading and sending data.\n\t\t\tthis._XHR.onabort = (event:UIEvent) => this.onAbort(event);\t                        // abort\t            - When the request has been aborted, either by invoking the abort() method or navigating away from the page.\n\t\t\tthis._XHR.onerror = (event:ErrorEvent) => this.onLoadError(event);                     // error\t            - When the request has failed.\n\t\t\tthis._XHR.onload = (event:Event) => this.onLoadComplete(event);                   // load\t                - When the request has successfully completed.\n\t\t\tthis._XHR.ontimeout = (event:Event) => this.onTimeOut(event);                     // timeout\t            - When the author specified timeout has passed before the request could complete.\n\t\t\tthis._XHR.onloadend = (event:ProgressEvent) => this.onLoadEnd(event);                     // loadend\t            - When the request has completed, regardless of whether or not it was successful.\n\t\t\tthis._XHR.onreadystatechange = (event:Event) => this.onReadyStateChange(event);   // onreadystatechange   - When XHR state changes\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate disposeXHR()\n\t{\n\t\tif (this._XHR !== null) {\n\t\t\tthis._XHR.onloadstart = null;\n\t\t\tthis._XHR.onprogress = null;\n\t\t\tthis._XHR.onabort = null;\n\t\t\tthis._XHR.onerror = null;\n\t\t\tthis._XHR.onload = null;\n\t\t\tthis._XHR.ontimeout = null;\n\t\t\tthis._XHR.onloadend = null;\n\t\t\tthis._XHR = null;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param source\n\t */\n\tpublic decodeURLVariables(source:string):Object\n\t{\n\t\tvar result:Object = new Object();\n\n\t\tsource = source.split(\"+\").join(\" \");\n\n\t\tvar tokens, re = /[?&]?([^=]+)=([^&]*)/g;\n\n\t\twhile (tokens = re.exec(source))\n\t\t\tresult[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\n\t\treturn result;\n\t}\n\n\t// XMLHttpRequest - Event Handlers\n\n\t/**\n\t * When XHR state changes\n\t * @param event\n\t */\n\tprivate onReadyStateChange(event:Event)\n\t{\n\t\tif (this._XHR.readyState == 4) {\n\t\t\tif (this._XHR.status == 404) {\n\t\t\t\tthis._loadError = true;\n\n\t\t\t\tif (!this._loadErrorEvent)\n\t\t\t\t\tthis._loadErrorEvent = new IOErrorEvent(IOErrorEvent.IO_ERROR);\n\n\t\t\t\tthis.dispatchEvent(this._loadErrorEvent);\n\t\t\t}\n\n\t\t\tthis.dispatchEvent(new HTTPStatusEvent(HTTPStatusEvent.HTTP_STATUS, this._XHR.status));\n\t\t}\n\t}\n\n\t/**\n\t * When the request has completed, regardless of whether or not it was successful.\n\t * @param event\n\t */\n\tprivate onLoadEnd(event:ProgressEvent)\n\t{\n\t\tif (this._loadError === true)\n\t\t\treturn;\n\t}\n\n\t/**\n\t * When the author specified timeout has passed before the request could complete.\n\t * @param event\n\t */\n\tprivate onTimeOut(event:Event)\n\t{\n\t\t//TODO: Timeout not currently implemented ( also not part of AS3 API )\n\t}\n\n\t/**\n\t * When the request has been aborted, either by invoking the abort() method or navigating away from the page.\n\t * @param event\n\t */\n\tprivate onAbort(event:UIEvent)\n\t{\n\t\t// TODO: investigate whether this needs to be an IOError\n\t}\n\n\t/**\n\t * While loading and sending data.\n\t * @param event\n\t */\n\tprivate onProgress(event:ProgressEvent)\n\t{\n\t\tif (!this._progressEvent)\n\t\t\tthis._progressEvent = new AwayProgressEvent(AwayProgressEvent.PROGRESS);\n\n\t\tthis._progressEvent.bytesTotal = event.total;\n\t\tthis._progressEvent.bytesLoaded = event.loaded;\n\n\t\tthis.dispatchEvent(this._progressEvent);\n\t}\n\n\t/**\n\t * When the request starts.\n\t * @param event\n\t */\n\tprivate onLoadStart(event:ProgressEvent)\n\t{\n\t\tif (!this._loadStartEvent)\n\t\t\tthis._loadStartEvent = new AwayEvent(AwayEvent.OPEN);\n\n\t\tthis.dispatchEvent(this._loadStartEvent);\n\t}\n\n\t/**\n\t * When the request has successfully completed.\n\t * @param event\n\t */\n\tprivate onLoadComplete(event:Event)\n\t{\n\t\tif (this._loadError === true)\n\t\t\treturn;\n\n\t\tswitch (this._dataFormat) {\n\t\t\tcase URLLoaderDataFormat.TEXT:\n\t\t\t\tthis._data = this._XHR.responseText;\n\t\t\t\tbreak;\n\n\t\t\tcase URLLoaderDataFormat.VARIABLES:\n\t\t\t\tthis._data = this.decodeURLVariables(this._XHR.responseText);\n\t\t\t\tbreak;\n\n\t\t\tcase URLLoaderDataFormat.BLOB:\n\t\t\tcase URLLoaderDataFormat.ARRAY_BUFFER:\n\t\t\tcase URLLoaderDataFormat.BINARY:\n\t\t\t\tthis._data = this._XHR.response;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthis._data = this._XHR.responseText;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (!this._loadCompleteEvent)\n\t\t\tthis._loadCompleteEvent = new AwayEvent(AwayEvent.COMPLETE);\n\n\t\tthis.dispatchEvent(this._loadCompleteEvent);\n\t}\n\n\t/**\n\t * When the request has failed. ( due to network issues ).\n\t * @param event\n\t */\n\tprivate onLoadError(event:Event)\n\t{\n\t\tthis._loadError = true;\n\n\t\tif (!this._loadErrorEvent)\n\t\t\tthis._loadErrorEvent = new IOErrorEvent(IOErrorEvent.IO_ERROR);\n\n\t\tthis.dispatchEvent(this._loadErrorEvent);\n\t}\n}\n\nexport = URLLoader;",
    "class URLLoaderDataFormat\n{\n\t/**\n\t * TEXT\n\t * @type {string}\n\t */\n\tpublic static TEXT:string = \"text\";\n\n\t/**\n\t * Variables / Value Pairs\n\t * @type {string}\n\t */\n\tpublic static VARIABLES:string = \"variables\";\n\n\t/**\n\t *\n\t * @type {string}\n\t */\n\tpublic static BLOB:string = \"blob\";\n\n\t/**\n\t *\n\t * @type {string}\n\t */\n\tpublic static ARRAY_BUFFER:string = \"arraybuffer\";\n\n\t/**\n\t *\n\t * @type {string}\n\t */\n\tpublic static BINARY:string = \"binary\";\n}\n\nexport = URLLoaderDataFormat;",
    "import URLRequestMethod\t\t\t\t= require(\"awayjs-core/lib/net/URLRequestMethod\");\n\nclass URLRequest\n{\n\t/*\n\t * The MIME content type of the content in the the data property.\n\t * @type {string}\n\t */\n\t//public contentType      : string = 'application/x-www-form-urlencoded'; //Note: Not used for now.\n\n\t/**\n\t * Object containing data to be transmited with URL Request ( URL Variables / binary / string )\n\t *\n\t */\n\tpublic data:any;\n\n\t/**\n\t *\n\t * away.net.URLRequestMethod.GET\n\t * away.net.URLRequestMethod.POST\n\t *\n\t * @type {string}\n\t */\n\tpublic method:string = URLRequestMethod.GET;\n\n\t/**\n\t * Use asynchronous XMLHttpRequest\n\t * @type {boolean}\n\t */\n\tpublic async:boolean = true;\n\n\t/**\n\t *\n\t */\n\tprivate _url:string;\n\n\t/**\n\n\t * @param url\n\t */\n\tconstructor(url:string = null)\n\t{\n\t\tthis._url = url;\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic get url():string\n\t{\n\t\treturn this._url;\n\t}\n\n\t/**\n\t *\n\t * @param value\n\t */\n\tpublic set url(value:string)\n\t{\n\t\tthis._url = value;\n\t}\n\n\t/**\n\t * dispose\n\t */\n\tpublic dispose():void\n\t{\n\t\tthis.data = null;\n\t\tthis._url = null;\n\t}\n}\n\nexport = URLRequest;",
    "class URLRequestMethod\n{\n\t/**\n\t *\n\t * @type {string}\n\t */\n\tpublic static POST:string = 'POST';\n\t/**\n\t *\n\t * @type {string}\n\t */\n\tpublic static GET:string = 'GET';\n}\n\nexport = URLRequestMethod;",
    "class URLVariables\n{\n\tprivate _variables:Object = new Object();\n\n\t/**\n\t *\n\t * @param source\n\t */\n\tconstructor(source:string = null)\n\t{\n\t\tif (source !== null)\n\t\t\tthis.decode(source);\n\t}\n\n\t/**\n\t *\n\t * @param source\n\t */\n\tpublic decode(source:string):void\n\t{\n\t\tsource = source.split(\"+\").join(\" \");\n\n\t\tvar tokens, re = /[?&]?([^=]+)=([^&]*)/g;\n\n\t\twhile (tokens = re.exec(source))\n\t\t\tthis._variables[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic toString():string\n\t{\n\t\treturn '';\n\t}\n\n\t/**\n\t *\n\t * @returns {Object}\n\t */\n\tpublic get variables():Object\n\t{\n\t\treturn this._variables;\n\t}\n\n\t/**\n\t *\n\t * @returns {Object}\n\t */\n\tpublic get formData():FormData\n\t{\n\t\tvar fd:FormData = new FormData();\n\n\t\tfor (var s in this._variables)\n\t\t\tfd.append(s, this._variables[s]);\n\n\t\treturn fd;\n\t}\n\n\t/**\n\t *\n\t * @returns {Object}\n\t */\n\tpublic set variables(obj:Object)\n\t{\n\t\tthis._variables = obj;\n\t}\n}\n\nexport = URLVariables;",
    "import ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nclass ParserUtils\n{\n\n\t/**\n\t * Converts an ArrayBuffer to a base64 string\n\t *\n\t * @param image data as a ByteArray\n\t *\n\t * @return HTMLImageElement\n\t *\n\t */\n\tpublic static arrayBufferToImage(data:ArrayBuffer):HTMLImageElement\n\t{\n\t\tvar byteStr:string = '';\n\t\tvar bytes:Uint8Array = new Uint8Array(data);\n\t\tvar len:number = bytes.byteLength;\n\n\t\tfor (var i = 0; i < len; i++)\n\t\t\tbyteStr += String.fromCharCode(bytes[ i ])\n\n\t\tvar base64Image:string = window.btoa(byteStr);\n\t\tvar str:string = 'data:image/png;base64,' + base64Image;\n\t\tvar img:HTMLImageElement = <HTMLImageElement> new Image();\n\t\timg.src = str;\n\n\t\treturn img;\n\t}\n\n\t/**\n\t * Converts an ByteArray to an Image - returns an HTMLImageElement\n\t *\n\t * @param image data as a ByteArray\n\t *\n\t * @return HTMLImageElement\n\t *\n\t */\n\tpublic static byteArrayToImage(data:ByteArray):HTMLImageElement\n\t{\n\t\tvar byteStr:string = '';\n\t\tvar bytes:Uint8Array = new Uint8Array(data.arraybytes);\n\t\tvar len:number = bytes.byteLength;\n\n\t\tfor (var i = 0; i < len; i++)\n\t\t\tbyteStr += String.fromCharCode(bytes[ i ])\n\n\t\tvar base64Image:string = window.btoa(byteStr);\n\t\tvar str:string = 'data:image/png;base64,' + base64Image;\n\t\tvar img:HTMLImageElement = <HTMLImageElement> new Image();\n\t\timg.src = str;\n\n\t\treturn img;\n\t}\n\n\t/**\n\t * Converts an Blob to an Image - returns an HTMLImageElement\n\t *\n\t * @param image data as a Blob\n\t *\n\t * @return HTMLImageElement\n\t *\n\t */\n\tpublic static blobToImage(data:Blob):HTMLImageElement\n\t{\n\t\tvar URLObj:URL = window['URL'] || window['webkitURL'];\n\t\tvar src = URLObj.createObjectURL(data);\n\t\tvar img:HTMLImageElement = <HTMLImageElement> new Image();\n\t\timg.src = src;\n\n\t\treturn img;\n\t}\n\n\t/**\n\t * Returns a object as ByteArray, if possible.\n\t *\n\t * @param data The object to return as ByteArray\n\t *\n\t * @return The ByteArray or null\n\t *\n\t */\n\tpublic static toByteArray(data:any):ByteArray\n\t{\n\t\tvar b:ByteArray = new ByteArray();\n\t\tb.setArrayBuffer(data);\n\t\treturn b;\n\t}\n\n\t/**\n\t * Returns a object as String, if possible.\n\t *\n\t * @param data The object to return as String\n\t * @param length The length of the returned String\n\t *\n\t * @return The String or null\n\t *\n\t */\n\tpublic static toString(data:any, length:number = 0):string\n\t{\n\n\t\tif (typeof data === 'string') {\n\t\t\tvar s:string = <string> data;\n\n\t\t\tif (s['substr'] != null)\n\t\t\t\treturn s.substr(0, s.length);\n\t\t}\n\n\t\tif (data instanceof ByteArray) {\n\t\t\tvar ba:ByteArray = <ByteArray> data;\n\t\t\tba.position = 0;\n\t\t\treturn ba.readUTFBytes(Math.min(ba.getBytesAvailable(), length));\n\t\t}\n\n\t\treturn null;\n\n\t\t/*\n\t\t var ba:ByteArray;\n\n\t\t length ||= uint.MAX_VALUE;\n\n\t\t if (data is String)\n\t\t return String(data).substr(0, length);\n\n\t\t ba = toByteArray(data);\n\t\t if (ba) {\n\t\t ba.position = 0;\n\t\t return ba.readUTFBytes(Math.min(ba.bytesAvailable, length));\n\t\t }\n\n\t\t return null;\n\n\t\t */\n\n\t}\n}\n\nexport = ParserUtils;",
    "/**\n * Provides constant values for camera lens projection options use the the <code>coordinateSystem</code> property\n *\n * @see away.projections.PerspectiveLens#coordinateSystem\n */\nclass CoordinateSystem\n{\n\t/**\n\t * Default option, projects to a left-handed coordinate system\n\t */\n\tpublic static LEFT_HANDED:string = \"leftHanded\";\n\n\t/**\n\t * Projects to a right-handed coordinate system\n\t */\n\tpublic static RIGHT_HANDED:string = \"rightHanded\";\n}\n\nexport = CoordinateSystem;",
    "import Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport CoordinateSystem\t\t\t= require(\"awayjs-core/lib/projections/CoordinateSystem\");\nimport ProjectionBase\t\t\t= require(\"awayjs-core/lib/projections/ProjectionBase\");\n\nclass PerspectiveProjection extends ProjectionBase\n{\n\tprivate _fieldOfView:number = 60;\n\tprivate _focalLength:number = 1000;\n\tprivate _hFieldOfView:number = 60;\n\tprivate _hFocalLength:number = 1000;\n\tprivate _preserveAspectRatio:boolean = true;\n\tprivate _preserveFocalLength:boolean = false;\n\n\tconstructor(fieldOfView:number = 60, coordinateSystem:string = \"leftHanded\")\n\t{\n\t\tsuper(coordinateSystem);\n\t\tthis.fieldOfView = fieldOfView;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get preserveAspectRatio():boolean\n\t{\n\t\treturn this._preserveAspectRatio;\n\t}\n\n\tpublic set preserveAspectRatio(value:boolean)\n\t{\n\t\tif (this._preserveAspectRatio == value)\n\t\t\treturn;\n\n\t\tthis._preserveAspectRatio = value;\n\n\t\tif (this._preserveAspectRatio)\n\t\t\tthis.pInvalidateMatrix();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get preserveFocalLength():boolean\n\t{\n\t\treturn this._preserveFocalLength;\n\t}\n\n\tpublic set preserveFocalLength(value:boolean)\n\t{\n\t\tif (this._preserveFocalLength == value)\n\t\t\treturn;\n\n\t\tthis._preserveFocalLength = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get fieldOfView():number\n\t{\n\t\treturn this._fieldOfView;\n\t}\n\n\tpublic set fieldOfView(value:number)\n\t{\n\t\tif (this._fieldOfView == value)\n\t\t\treturn;\n\n\t\tthis._fieldOfView = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get focalLength():number\n\t{\n\t\treturn this._focalLength;\n\t}\n\n\tpublic set focalLength(value:number)\n\t{\n\t\tif (this._focalLength == value)\n\t\t\treturn;\n\n\t\tthis._focalLength = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get hFieldOfView():number\n\t{\n\t\treturn this._hFieldOfView;\n\t}\n\n\tpublic set hFieldOfView(value:number)\n\t{\n\t\tif (this._hFieldOfView == value)\n\t\t\treturn;\n\n\t\tthis._hFieldOfView = value;\n\n\t\tthis._hFocalLength = 1/Math.tan(this._hFieldOfView*Math.PI/360);\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get hFocalLength():number\n\t{\n\t\treturn this._hFocalLength;\n\t}\n\n\tpublic set hFocalLength(value:number)\n\t{\n\t\tif (this._hFocalLength == value)\n\t\t\treturn;\n\n\t\tthis._hFocalLength = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\n\t//@override\n\tpublic unproject(nX:number, nY:number, sZ:number):Vector3D\n\t{\n\t\tvar v:Vector3D = new Vector3D(nX, -nY, sZ, 1.0);\n\n\t\tv.x *= sZ;\n\t\tv.y *= sZ;\n\n\t\tv = this.unprojectionMatrix.transformVector(v);\n\n\t\t//z is unaffected by transform\n\t\tv.z = sZ;\n\n\t\treturn v;\n\t}\n\n\t//@override\n\tpublic clone():ProjectionBase\n\t{\n\t\tvar clone:PerspectiveProjection = new PerspectiveProjection(this._fieldOfView);\n\t\tclone._pNear = this._pNear;\n\t\tclone._pFar = this._pFar;\n\t\tclone._pAspectRatio = this._pAspectRatio;\n\t\tclone._pCoordinateSystem = this._pCoordinateSystem;\n\t\treturn clone;\n\t}\n\n\t//@override\n\tpublic pUpdateMatrix()\n\t{\n\t\tvar raw:number[] = [];\n\n\t\tif (this._preserveFocalLength) {\n\t\t\tif (this._preserveAspectRatio)\n\t\t\t\tthis._hFocalLength = this._focalLength;\n\n\t\t\tthis._fieldOfView = Math.atan(0.5*this._pScissorRect.height/this._focalLength)*360/Math.PI;\n\t\t\tthis._hFieldOfView = Math.atan(0.5*this._pScissorRect.width/this._hFocalLength)*360/Math.PI;\n\t\t} else {\n\t\t\tthis._focalLength = 0.5*this._pScissorRect.height/Math.tan(this._fieldOfView*Math.PI/360);\n\n\t\t\tif (this._preserveAspectRatio)\n\t\t\t\tthis._hFocalLength = this._focalLength;\n\t\t\telse\n\t\t\t\tthis._hFocalLength = 0.5*this._pScissorRect.width/Math.tan(this._hFieldOfView*Math.PI/360);\n\t\t}\n\n\t\tvar tanMinX = -this._pOriginX/this._hFocalLength;\n\t\tvar tanMaxX = (1 - this._pOriginX)/this._hFocalLength;\n\t\tvar tanMinY = -this._pOriginY/this._focalLength;\n\t\tvar tanMaxY = (1 - this._pOriginY)/this._focalLength;\n\n\t\tvar left:number;\n\t\tvar right:number;\n\t\tvar top:number;\n\t\tvar bottom:number;\n\n\t\t// assume scissored frustum\n\t\tvar center:number = -((tanMinX - tanMaxX)*this._pScissorRect.x + tanMinX*this._pScissorRect.width);\n\t\tvar middle:number = ((tanMinY - tanMaxY)*this._pScissorRect.y + tanMinY*this._pScissorRect.height);\n\n\t\tleft = center - (tanMaxX - tanMinX)*this._pViewPort.width;\n\t\tright = center;\n\t\ttop = middle;\n\t\tbottom = middle + (tanMaxY - tanMinY)*this._pViewPort.height;\n\n\t\traw[0] = 2/(right - left);\n\t\traw[5] = 2/(bottom - top);\n\t\traw[8] = (right + left)/(right - left);\n\t\traw[9] = (bottom + top)/(bottom - top);\n\t\traw[10] = (this._pFar + this._pNear)/(this._pFar - this._pNear);\n\t\traw[11] = 1;\n\t\traw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[12] = raw[13] = raw[15] = 0;\n\t\traw[14] = -2*this._pFar*this._pNear/(this._pFar - this._pNear);\n\n\t\tif (this._pCoordinateSystem == CoordinateSystem.RIGHT_HANDED)\n\t\t\traw[5] = -raw[5];\n\n\t\tthis._pMatrix.copyRawDataFrom(raw);\n\n\t\tthis._pFrustumCorners[0] = this._pFrustumCorners[9] = this._pNear*left;\n\t\tthis._pFrustumCorners[3] = this._pFrustumCorners[6] = this._pNear*right;\n\t\tthis._pFrustumCorners[1] = this._pFrustumCorners[4] = this._pNear*top;\n\t\tthis._pFrustumCorners[7] = this._pFrustumCorners[10] = this._pNear*bottom;\n\n\t\tthis._pFrustumCorners[12] = this._pFrustumCorners[21] = this._pFar*left;\n\t\tthis._pFrustumCorners[15] = this._pFrustumCorners[18] = this._pFar*right;\n\t\tthis._pFrustumCorners[13] = this._pFrustumCorners[16] = this._pFar*top;\n\t\tthis._pFrustumCorners[19] = this._pFrustumCorners[22] = this._pFar*bottom;\n\n\t\tthis._pFrustumCorners[2] = this._pFrustumCorners[5] = this._pFrustumCorners[8] = this._pFrustumCorners[11] = this._pNear;\n\t\tthis._pFrustumCorners[14] = this._pFrustumCorners[17] = this._pFrustumCorners[20] = this._pFrustumCorners[23] = this._pFar;\n\n\t\tthis._pMatrixInvalid = false;\n\n\n\t}\n}\n\nexport = PerspectiveProjection;",
    "import Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ProjectionEvent\t\t\t= require(\"awayjs-core/lib/events/ProjectionEvent\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IProjection\t\t\t\t= require(\"awayjs-core/lib/projections/IProjection\");\n\nclass ProjectionBase extends EventDispatcher implements IProjection\n{\n\tpublic _pMatrix:Matrix3D = new Matrix3D();\n\tpublic _pScissorRect:Rectangle = new Rectangle();\n\tpublic _pViewPort:Rectangle = new Rectangle();\n\tpublic _pNear:number = 20;\n\tpublic _pFar:number = 3000;\n\tpublic _pAspectRatio:number = 1;\n\n\tpublic _pMatrixInvalid:boolean = true;\n\tpublic _pFrustumCorners:number[] = [];\n\tpublic _pCoordinateSystem:string;\n\tpublic _pOriginX:number = 0.5;\n\tpublic _pOriginY:number = 0.5;\n\n\tprivate _unprojection:Matrix3D;\n\tprivate _unprojectionInvalid:boolean = true;\n\n\tconstructor(coordinateSystem:string = \"leftHanded\")\n\t{\n\t\tsuper();\n\n\t\tthis.coordinateSystem = coordinateSystem;\n\t}\n\n\t/**\n\t * The handedness of the coordinate system projection. The default is LEFT_HANDED.\n\t */\n\tpublic get coordinateSystem():string\n\t{\n\t\treturn this._pCoordinateSystem;\n\t}\n\n\tpublic set coordinateSystem(value:string)\n\t{\n\t\tif (this._pCoordinateSystem == value)\n\t\t\treturn;\n\n\t\tthis._pCoordinateSystem = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic get frustumCorners():number[]\n\t{\n\t\treturn this._pFrustumCorners;\n\t}\n\n\tpublic set frustumCorners(frustumCorners:number[])\n\t{\n\t\tthis._pFrustumCorners = frustumCorners;\n\t}\n\n\tpublic get matrix():Matrix3D\n\t{\n\t\tif (this._pMatrixInvalid) {\n\t\t\tthis.pUpdateMatrix();\n\t\t\tthis._pMatrixInvalid = false;\n\t\t}\n\t\treturn this._pMatrix;\n\t}\n\n\tpublic set matrix(value:Matrix3D)\n\t{\n\t\tthis._pMatrix = value;\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic get near():number\n\t{\n\t\treturn this._pNear;\n\t}\n\n\tpublic set near(value:number)\n\t{\n\t\tif (value == this._pNear) {\n\t\t\treturn;\n\t\t}\n\t\tthis._pNear = value;\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic get originX():number\n\t{\n\t\treturn this._pOriginX;\n\t}\n\n\tpublic set originX(value:number)\n\t{\n\t\tif (this._pOriginX == value)\n\t\t\treturn;\n\n\t\tthis._pOriginX = value;\n\t}\n\n\tpublic get originY():number\n\t{\n\t\treturn this._pOriginY;\n\t}\n\n\tpublic set originY(value:number)\n\t{\n\t\tif (this._pOriginY == value)\n\t\t\treturn;\n\n\t\tthis._pOriginY = value;\n\t}\n\n\tpublic get far():number\n\t{\n\t\treturn this._pFar;\n\t}\n\n\tpublic set far(value:number)\n\t{\n\t\tif (value == this._pFar) {\n\t\t\treturn;\n\t\t}\n\t\tthis._pFar = value;\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic project(point3d:Vector3D):Vector3D\n\t{\n\t\tvar v:Vector3D = this.matrix.transformVector(point3d);\n\t\tv.x = v.x/v.w;\n\t\tv.y = -v.y/v.w;\n\n\t\t//z is unaffected by transform\n\t\tv.z = point3d.z;\n\n\t\treturn v;\n\t}\n\n\tpublic get unprojectionMatrix():Matrix3D\n\t{\n\t\tif (this._unprojectionInvalid) {\n\t\t\tif (!this._unprojection)\n\t\t\t\tthis._unprojection = new Matrix3D();\n\n\t\t\tthis._unprojection.copyFrom(this.matrix);\n\t\t\tthis._unprojection.invert();\n\t\t\tthis._unprojectionInvalid = false;\n\t\t}\n\t\treturn this._unprojection;\n\t}\n\n\tpublic unproject(nX:number, nY:number, sZ:number):Vector3D\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic clone():ProjectionBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic get _iAspectRatio():number\n\t{\n\t\treturn this._pAspectRatio;\n\t}\n\n\tpublic set _iAspectRatio(value:number)\n\t{\n\t\tif (this._pAspectRatio == value)\n\t\t\treturn;\n\n\t\tthis._pAspectRatio = value;\n\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic pInvalidateMatrix()\n\t{\n\t\tthis._pMatrixInvalid = true;\n\t\tthis._unprojectionInvalid = true;\n\t\tthis.dispatchEvent(new ProjectionEvent(ProjectionEvent.MATRIX_CHANGED, this));\n\t}\n\n\tpublic pUpdateMatrix()\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _iUpdateScissorRect(x:number, y:number, width:number, height:number)\n\t{\n\t\tthis._pScissorRect.x = x;\n\t\tthis._pScissorRect.y = y;\n\t\tthis._pScissorRect.width = width;\n\t\tthis._pScissorRect.height = height;\n\t\tthis.pInvalidateMatrix();\n\t}\n\n\tpublic _iUpdateViewport(x:number, y:number, width:number, height:number)\n\t{\n\t\tthis._pViewPort.x = x;\n\t\tthis._pViewPort.y = y;\n\t\tthis._pViewPort.width = width;\n\t\tthis._pViewPort.height = height;\n\t\tthis.pInvalidateMatrix();\n\t}\n}\n\nexport = ProjectionBase;",
    "﻿import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\nimport Texture2DBase\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\nimport TextureUtils\t\t\t\t= require(\"awayjs-core/lib/utils/TextureUtils\");\n\n\nclass ImageTexture extends Texture2DBase\n{\n\tprivate _htmlImageElement:HTMLImageElement;\n\n\t/**\n\t *\n\t * @param htmlImageElement\n\t * @param generateMipmaps\n\t */\n\tconstructor(htmlImageElement:HTMLImageElement, generateMipmaps:boolean = false)\n\t{\n\t\tsuper(generateMipmaps);\n\n\t\tthis.htmlImageElement = htmlImageElement;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get htmlImageElement():HTMLImageElement\n\t{\n\t\treturn this._htmlImageElement;\n\t}\n\n\tpublic set htmlImageElement(value:HTMLImageElement)\n\t{\n\t\tif (this._htmlImageElement == value)\n\t\t\treturn;\n\n\t\tif (!TextureUtils.isHTMLImageElementValid(value))\n\t\t\tthrow new Error(\"Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048\");\n\n\t\tthis._htmlImageElement = value;\n\n\t\tthis.invalidateContent();\n\t\tthis._pSetSize(value.width, value.height);\n\t}\n\n\tpublic _iGetTextureData():HTMLImageElement\n\t{\n\t\treturn this._htmlImageElement;\n\t}\n}\n\nexport = ImageTexture;",
    "import BitmapData\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Matrix\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\n\n/**\n * MipmapGenerator is a helper class that uploads BitmapData to a Texture including mipmap levels.\n */\nclass MipmapGenerator\n{\n\tprivate static _mipMaps = [];\n\tprivate static _mipMapUses = [];\n\n\tprivate static _matrix:Matrix = new Matrix();\n\tprivate static _rect:Rectangle = new Rectangle();\n\tprivate static _source:BitmapData;\n\n\t/**\n\t * Uploads a BitmapData with mip maps to a target Texture object.\n\t * @param source The source to upload.\n\t * @param target The target Texture to upload to.\n\t * @param mipmap An optional mip map holder to avoids creating new instances for fe animated materials.\n\t * @param alpha Indicate whether or not the uploaded bitmapData is transparent.\n\t */\n\tpublic static generateMipMaps(source:HTMLImageElement, output?:Array<BitmapData>, alpha?:boolean);\n\tpublic static generateMipMaps(source:BitmapData, output?:Array<BitmapData>, alpha?:boolean);\n\tpublic static generateMipMaps(source:any, output?:Array<BitmapData>, alpha:boolean = false)\n\t{\n\t\tvar w:number = source.width;\n\t\tvar h:number = source.height;\n\t\tvar i:number = 0;\n\n\t\tvar mipmap:BitmapData;\n\n\t\tMipmapGenerator._rect.width = w;\n\t\tMipmapGenerator._rect.height = h;\n\n\t\twhile (w >= 1 && h >= 1) {\n\n\t\t\tmipmap = output[i] = MipmapGenerator._getMipmapHolder(output[i], w, h);\n\n\t\t\tif (alpha)\n\t\t\t\tmipmap.fillRect(MipmapGenerator._rect, 0);\n\n\t\t\tMipmapGenerator._matrix.a = MipmapGenerator._rect.width/source.width;\n\t\t\tMipmapGenerator._matrix.d = MipmapGenerator._rect.height/source.height;\n\n\t\t\tmipmap.draw(source, MipmapGenerator._matrix); //TODO: smoothing?\n\n\t\t\tw >>= 1;\n\t\t\th >>= 1;\n\n\t\t\tMipmapGenerator._rect.width = w > 1? w : 1;\n\t\t\tMipmapGenerator._rect.height = h > 1? h : 1;\n\n\t\t\ti++;\n\t\t}\n\t}\n\n\tprivate static _getMipmapHolder(mipMapHolder:BitmapData, newW:number, newH:number):BitmapData\n\t{\n\t\tif (mipMapHolder) {\n\t\t\tif (mipMapHolder.width == newW && mipMapHolder.height == newH)\n\t\t\t\treturn mipMapHolder;\n\n\t\t\tMipmapGenerator.freeMipMapHolder(mipMapHolder);\n\t\t}\n\n\t\tif (!MipmapGenerator._mipMaps[newW]) {\n\t\t\tMipmapGenerator._mipMaps[newW] = [];\n\t\t\tMipmapGenerator._mipMapUses[newW] = [];\n\t\t}\n\n\t\tif (!MipmapGenerator._mipMaps[newW][newH]) {\n\t\t\tmipMapHolder = MipmapGenerator._mipMaps[newW][newH] = new BitmapData(newW, newH, true);\n\t\t\tMipmapGenerator._mipMapUses[newW][newH] = 1;\n\t\t} else {\n\t\t\tMipmapGenerator._mipMapUses[newW][newH] = MipmapGenerator._mipMapUses[newW][newH] + 1;\n\t\t\tmipMapHolder = MipmapGenerator._mipMaps[newW][newH];\n\t\t}\n\n\t\treturn mipMapHolder;\n\t}\n\n\tpublic static freeMipMapHolder(mipMapHolder:BitmapData)\n\t{\n\t\tvar holderWidth:number = mipMapHolder.width;\n\t\tvar holderHeight:number = mipMapHolder.height;\n\n\t\tif (--MipmapGenerator._mipMapUses[holderWidth][holderHeight] == 0) {\n\t\t\tMipmapGenerator._mipMaps[holderWidth][holderHeight].dispose();\n\t\t\tMipmapGenerator._mipMaps[holderWidth][holderHeight] = null;\n\t\t}\n\t}\n}\n\nexport = MipmapGenerator;",
    "import BitmapData\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport MipmapGenerator\t\t\t= require(\"awayjs-core/lib/textures/MipmapGenerator\");\nimport TextureProxyBase\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nclass Texture2DBase extends TextureProxyBase\n{\n\tprivate _mipmapData:Array<BitmapData>;\n\tprivate _mipmapDataDirty:boolean;\n\tpublic _pWidth:number;\n\tpublic _pHeight:number;\n\t\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._pWidth;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._pHeight;\n\t}\n\n\tpublic get size():number\n\t{\n\t\treturn this._pWidth;\n\t}\n\n\tconstructor(generateMipmaps:boolean = false)\n\t{\n\t\tsuper(generateMipmaps);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tif (this._mipmapData) {\n\t\t\tvar len:number = this._mipmapData.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tMipmapGenerator.freeMipMapHolder(this._mipmapData[i]);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateContent():void\n\t{\n\t\tsuper.invalidateContent();\n\n\t\tthis._mipmapDataDirty = true;\n\t}\n\n\t/**\n\t *\n\t * @param width\n\t * @param height\n\t * @private\n\t */\n\tpublic _pSetSize(width:number, height:number)\n\t{\n\t\tif (this._pWidth != width || this._pHeight != height)\n\t\t\tthis.invalidateSize();\n\n\t\tthis._mipmapDataDirty = true;\n\n\t\tthis._pWidth = width;\n\t\tthis._pHeight = height;\n\t}\n\n\tpublic _iGetMipmapData():Array<BitmapData>\n\t{\n\t\tif (this._mipmapDataDirty) {\n\t\t\tthis._mipmapDataDirty = false;\n\n\t\t\tif (!this._mipmapData)\n\t\t\t\tthis._mipmapData = new Array<BitmapData>();\n\n\t\t\tMipmapGenerator.generateMipMaps(this._iGetTextureData(), this._mipmapData, true);\n\t\t}\n\n\t\treturn this._mipmapData;\n\t}\n\n\tpublic _iGetTextureData():any\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = Texture2DBase;",
    "import AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport ITextureData\t\t\t\t= require(\"awayjs-core/lib/pool/ITextureData\");\n\n/**\n *\n */\nclass TextureProxyBase extends NamedAssetBase implements IAsset\n{\n\tpublic _pSize:number;\n\tpublic _pFormat:string = \"bgra\"\n\tprivate _hasMipmaps:boolean;\n\tprivate _generateMipmaps:boolean;\n\tprivate _textureData:Array<ITextureData> = new Array<ITextureData>();\n\t\n\t/**\n\t *\n\t */\n\tconstructor(generateMipmaps:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._generateMipmaps = this._hasMipmaps = generateMipmaps;\n\t}\n\n\tpublic get size():number\n\t{\n\t\treturn this._pSize;\n\t}\n\n\tpublic get hasMipmaps():boolean\n\t{\n\t\treturn this._hasMipmaps;\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic get format():string\n\t{\n\t\treturn this._pFormat;\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic get generateMipmaps():boolean\n\t{\n\t\treturn this._generateMipmaps;\n\t}\n\n\tpublic set generateMipmaps(value:boolean)\n\t{\n\t\tif (this._generateMipmaps == value)\n\t\t\treturn;\n\n\t\tthis._generateMipmaps = this._hasMipmaps = value;\n\n\t\tthis.invalidateContent();\n\t}\n\n\t/**\n\t *\n\t * @returns {string}\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.TEXTURE;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateContent():void\n\t{\n\t\tvar len:number = this._textureData.length\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._textureData[i].invalidate();\n\t}\n\n\t/**\n\t *\n\t * @private\n\t */\n\tpublic invalidateSize():void\n\t{\n\t\twhile (this._textureData.length)\n\t\t\tthis._textureData[0].dispose();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\twhile (this._textureData.length)\n\t\t\tthis._textureData[0].dispose();\n\t}\n\n\n\tpublic _iAddTextureData(textureData:ITextureData):ITextureData\n\t{\n\t\tthis._textureData.push(textureData);\n\n\t\treturn textureData;\n\t}\n\n\tpublic _iRemoveTextureData(textureData:ITextureData):ITextureData\n\t{\n\t\tthis._textureData.splice(this._textureData.indexOf(textureData), 1);\n\n\t\treturn textureData;\n\t}\n}\n\nexport = TextureProxyBase;",
    "import ByteArrayBase\t\t\t= require(\"awayjs-core/lib/utils/ByteArrayBase\");\n\nclass ByteArray extends ByteArrayBase\n{\n\tpublic maxlength:number = 0;\n\tpublic arraybytes; //ArrayBuffer\n\tpublic unalignedarraybytestemp; //ArrayBuffer\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis._mode = \"Typed array\";\n\t\tthis.maxlength = 4;\n\t\tthis.arraybytes = new ArrayBuffer(this.maxlength);\n\t\tthis.unalignedarraybytestemp = new ArrayBuffer(16);\n\t}\n\n\tpublic ensureWriteableSpace(n:number)\n\t{\n\t\tthis.ensureSpace(n + this.position);\n\t}\n\n\tpublic setArrayBuffer(aBuffer:ArrayBuffer):void\n\t{\n\n\t\tthis.ensureSpace(aBuffer.byteLength);\n\n\t\tthis.length = aBuffer.byteLength;\n\n\t\tvar inInt8AView:Int8Array = new Int8Array(aBuffer);\n\t\tvar localInt8View:Int8Array = new Int8Array(this.arraybytes, 0, this.length);\n\n\t\tlocalInt8View.set(inInt8AView);\n\n\t\tthis.position = 0;\n\n\t}\n\n\tpublic getBytesAvailable():number\n\t{\n\t\treturn ( this.length ) - ( this.position );\n\t}\n\n\tpublic ensureSpace(n:number)\n\t{\n\t\tif (n > this.maxlength) {\n\t\t\tvar newmaxlength:number = (n + 255) & (~255);\n\t\t\tvar newarraybuffer = new ArrayBuffer(newmaxlength);\n\t\t\tvar view = new Uint8Array(this.arraybytes, 0, this.length);\n\t\t\tvar newview = new Uint8Array(newarraybuffer, 0, this.length);\n\t\t\tnewview.set(view);      // memcpy\n\t\t\tthis.arraybytes = newarraybuffer;\n\t\t\tthis.maxlength = newmaxlength;\n\t\t}\n\t}\n\n\tpublic writeByte(b:number)\n\t{\n\t\tthis.ensureWriteableSpace(1);\n\t\tvar view = new Int8Array(this.arraybytes);\n\t\tview[ this.position++ ] = (~~b); // ~~ is cast to int in js...\n\t\tif (this.position > this.length) {\n\t\t\tthis.length = this.position;\n\t\t}\n\t}\n\n\tpublic readByte()\n\t{\n\t\tif (this.position >= this.length) {\n\t\t\tthrow \"ByteArray out of bounds read. Positon=\" + this.position + \", Length=\" + this.length;\n\t\t}\n\t\tvar view = new Int8Array(this.arraybytes);\n\n\t\treturn view[ this.position++ ];\n\t}\n\n\tpublic readBytes(bytes:ByteArray, offset:number = 0, length:number = 0)\n\t{\n\n\t\tif (length == null) {\n\t\t\tlength = bytes.length;\n\t\t}\n\n\t\tbytes.ensureWriteableSpace(offset + length);\n\n\t\tvar byteView:Int8Array = new Int8Array(bytes.arraybytes);\n\t\tvar localByteView:Int8Array = new Int8Array(this.arraybytes);\n\n\t\tbyteView.set(localByteView.subarray(this.position, this.position + length), offset);\n\n\t\tthis.position += length;\n\n\t\tif (length + offset > bytes.length) {\n\t\t\tbytes.length += ( length + offset ) - bytes.length;\n\t\t}\n\n\t}\n\n\tpublic writeUnsignedByte(b:number)\n\t{\n\t\tthis.ensureWriteableSpace(1);\n\t\tvar view = new Uint8Array(this.arraybytes);\n\t\tview[this.position++] = (~~b) & 0xff; // ~~ is cast to int in js...\n\t\tif (this.position > this.length) {\n\t\t\tthis.length = this.position;\n\t\t}\n\t}\n\n\tpublic readUnsignedByte()\n\t{\n\t\tif (this.position >= this.length) {\n\t\t\tthrow \"ByteArray out of bounds read. Positon=\" + this.position + \", Length=\" + this.length;\n\t\t}\n\t\tvar view = new Uint8Array(this.arraybytes);\n\t\treturn view[this.position++];\n\t}\n\n\tpublic writeUnsignedShort(b:number)\n\t{\n\t\tthis.ensureWriteableSpace(2);\n\t\tif (( this.position & 1 ) == 0) {\n\t\t\tvar view = new Uint16Array(this.arraybytes);\n\t\t\tview[ this.position >> 1 ] = (~~b) & 0xffff; // ~~ is cast to int in js...\n\t\t} else {\n\t\t\tvar view = new Uint16Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tview[0] = (~~b) & 0xffff;\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 2);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 2);\n\t\t\tview2.set(view3);\n\t\t}\n\t\tthis.position += 2;\n\t\tif (this.position > this.length) {\n\t\t\tthis.length = this.position;\n\t\t}\n\t}\n\n\tpublic readUTFBytes(len:number):string\n\t{\n\n\t\tvar value:string = \"\";\n\t\tvar max:number = this.position + len;\n\t\tvar data:DataView = new DataView(this.arraybytes);\n\n\t\t// utf8-encode\n\t\twhile (this.position < max) {\n\n\t\t\tvar c:number = data.getUint8(this.position++);\n\n\t\t\tif (c < 0x80) {\n\n\t\t\t\tif (c == 0) break;\n\t\t\t\tvalue += String.fromCharCode(c);\n\n\t\t\t} else if (c < 0xE0) {\n\n\t\t\t\tvalue += String.fromCharCode(((c & 0x3F) << 6) | (data.getUint8(this.position++) & 0x7F));\n\n\t\t\t} else if (c < 0xF0) {\n\n\t\t\t\tvar c2 = data.getUint8(this.position++);\n\t\t\t\tvalue += String.fromCharCode(((c & 0x1F) << 12) | ((c2 & 0x7F) << 6) | (data.getUint8(this.position++) & 0x7F));\n\n\t\t\t} else {\n\n\t\t\t\tvar c2 = data.getUint8(this.position++);\n\t\t\t\tvar c3 = data.getUint8(this.position++);\n\n\t\t\t\tvalue += String.fromCharCode(((c & 0x0F) << 18) | ((c2 & 0x7F) << 12) | ((c3 << 6) & 0x7F) | (data.getUint8(this.position++) & 0x7F));\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn value;\n\n\t}\n\n\tpublic readInt():number\n\t{\n\n\t\tvar data:DataView = new DataView(this.arraybytes);\n\t\tvar int:number = data.getInt32(this.position, true);\n\n\t\tthis.position += 4;\n\n\t\treturn int;\n\n\t}\n\n\tpublic readShort():number\n\t{\n\n\t\tvar data:DataView = new DataView(this.arraybytes);\n\t\tvar short:number = data.getInt16(this.position, true);\n\n\t\tthis.position += 2;\n\t\treturn short;\n\n\t}\n\n\tpublic readDouble():number\n\t{\n\t\tvar data:DataView = new DataView(this.arraybytes);\n\t\tvar double:number = data.getFloat64(this.position, true);\n\n\t\tthis.position += 8;\n\t\treturn double;\n\n\t}\n\n\tpublic readUnsignedShort()\n\t{\n\t\tif (this.position > this.length + 2) {\n\t\t\tthrow \"ByteArray out of bounds read. Position=\" + this.position + \", Length=\" + this.length;\n\t\t}\n\t\tif (( this.position & 1 ) == 0) {\n\t\t\tvar view = new Uint16Array(this.arraybytes);\n\t\t\tvar pa:number = this.position >> 1;\n\t\t\tthis.position += 2;\n\t\t\treturn view[ pa ];\n\t\t} else {\n\t\t\tvar view = new Uint16Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 2);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 2);\n\t\t\tview3.set(view2);\n\t\t\tthis.position += 2;\n\t\t\treturn view[0];\n\t\t}\n\t}\n\n\tpublic writeUnsignedInt(b:number)\n\t{\n\t\tthis.ensureWriteableSpace(4);\n\t\tif (( this.position & 3 ) == 0) {\n\t\t\tvar view = new Uint32Array(this.arraybytes);\n\t\t\tview[ this.position >> 2 ] = (~~b) & 0xffffffff; // ~~ is cast to int in js...\n\t\t} else {\n\t\t\tvar view = new Uint32Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tview[0] = (~~b) & 0xffffffff;\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 4);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 4);\n\t\t\tview2.set(view3);\n\t\t}\n\t\tthis.position += 4;\n\t\tif (this.position > this.length) {\n\t\t\tthis.length = this.position;\n\t\t}\n\t}\n\n\tpublic readUnsignedInt()\n\t{\n\n\t\tif (this.position > this.length + 4) {\n\t\t\tthrow \"ByteArray out of bounds read. Position=\" + this.position + \", Length=\" + this.length;\n\t\t}\n\t\tif (( this.position & 3 ) == 0) {\n\t\t\tvar view = new Uint32Array(this.arraybytes);\n\t\t\tvar pa:number = this.position >> 2;\n\t\t\tthis.position += 4;\n\t\t\treturn view[ pa ];\n\t\t} else {\n\t\t\tvar view = new Uint32Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 4);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 4);\n\t\t\tview3.set(view2);\n\t\t\tthis.position += 4;\n\t\t\treturn view[0];\n\t\t}\n\t}\n\n\tpublic writeFloat(b:number)\n\t{\n\t\tthis.ensureWriteableSpace(4);\n\t\tif (( this.position & 3 ) == 0) {\n\t\t\tvar view = new Float32Array(this.arraybytes);\n\t\t\tview[ this.position >> 2 ] = b;\n\t\t} else {\n\t\t\tvar view = new Float32Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tview[0] = b;\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 4);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 4);\n\t\t\tview2.set(view3);\n\t\t}\n\t\tthis.position += 4;\n\t\tif (this.position > this.length) {\n\t\t\tthis.length = this.position;\n\t\t}\n\t}\n\n\tpublic readFloat()\n\t{\n\t\tif (this.position > this.length + 4) {\n\t\t\tthrow \"ByteArray out of bounds read. Positon=\" + this.position + \", Length=\" + this.length;\n\t\t}\n\t\tif ((this.position & 3) == 0) {\n\t\t\tvar view = new Float32Array(this.arraybytes);\n\t\t\tvar pa = this.position >> 2;\n\t\t\tthis.position += 4;\n\t\t\treturn view[pa];\n\t\t} else {\n\t\t\tvar view = new Float32Array(this.unalignedarraybytestemp, 0, 1);\n\t\t\tvar view2 = new Uint8Array(this.arraybytes, this.position, 4);\n\t\t\tvar view3 = new Uint8Array(this.unalignedarraybytestemp, 0, 4);\n\t\t\tview3.set(view2);\n\t\t\tthis.position += 4;\n\t\t\treturn view[ 0 ];\n\t\t}\n\t}\n}\n\nexport = ByteArray;",
    "import AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nclass ByteArrayBase\n{\n\tpublic position:number = 0;\n\tpublic length:number = 0;\n\tpublic _mode:string = \"\";\n\n\tpublic static Base64Key = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n\tconstructor()\n\t{\n\t}\n\n\tpublic writeByte(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic readByte():number\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic writeUnsignedByte(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic readUnsignedByte():number\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic writeUnsignedShort(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic readUnsignedShort():number\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic writeUnsignedInt(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic readUnsignedInt():number\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic writeFloat(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic toFloatBits(x:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic readFloat(b:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic fromFloatBits(x:number)\n\t{\n\t\tthrow \"Virtual method\";\n\t}\n\n\tpublic getBytesAvailable():number\n\t{\n\t\tthrow new AbstractMethodError('ByteArrayBase, getBytesAvailable() not implemented ');\n\t}\n\n\tpublic toString():string\n\t{\n\t\treturn \"[ByteArray] ( \" + this._mode + \" ) position=\" + this.position + \" length=\" + this.length;\n\t}\n\n\tpublic compareEqual(other, count)\n\t{\n\t\tif (count == undefined || count > this.length - this.position)\n\t\t\tcount = this.length - this.position;\n\t\tif (count > other.length - other.position)\n\t\t\tcount = other.length - other.position;\n\t\tvar co0 = count;\n\t\tvar r = true;\n\t\twhile (r && count >= 4) {\n\t\t\tcount -= 4;\n\t\t\tif (this.readUnsignedInt() != other.readUnsignedInt()) r = false;\n\t\t}\n\t\twhile (r && count >= 1) {\n\t\t\tcount--;\n\t\t\tif (this.readUnsignedByte() != other.readUnsignedByte()) r = false;\n\t\t}\n\t\tvar c0;\n\t\tthis.position -= (c0 - count);\n\t\tother.position -= (c0 - count);\n\t\treturn r;\n\t}\n\n\tpublic writeBase64String(s:string)\n\t{\n\t\tfor (var i:number = 0; i < s.length; i++) {\n\t\t\tvar v = s.charAt(i);\n\t\t}\n\t}\n\n\tpublic dumpToConsole()\n\t{\n\t\tvar oldpos = this.position;\n\t\tthis.position = 0;\n\t\tvar nstep:number = 8;\n\n\t\tfunction asHexString(x, digits)\n\t\t{\n\t\t\tvar lut:Array<string> = [ \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\" ];\n\t\t\tvar sh:string = \"\";\n\t\t\tfor (var d:number = 0; d < digits; d++) {\n\t\t\t\tsh = lut[(x >> (d << 2)) & 0xf] + sh;\n\t\t\t}\n\t\t\treturn sh;\n\t\t}\n\n\t\tfor (var i = 0; i < this.length; i += nstep) {\n\t\t\tvar s:string = asHexString(i, 4) + \":\";\n\t\t\tfor (var j:number = 0; j < nstep && i + j < this.length; j++) {\n\t\t\t\ts += \" \" + asHexString(this.readUnsignedByte(), 2);\n\t\t\t}\n\t\t\tconsole.log(s);\n\t\t}\n\t\tthis.position = oldpos;\n\t}\n\n\tpublic readBase64String(count:number)\n\t{\n\t\tif (count == undefined || count > this.length - this.position)\n\t\t\tcount = this.length - this.position;\n\t\tif (!(count > 0)) return \"\";\n\n\t\treturn ByteArrayBase.internalGetBase64String(count, this.readUnsignedByte, this);\n\t}\n\n\tpublic static internalGetBase64String(count, getUnsignedByteFunc, self)\n\t{ // return base64 string of the next count bytes\n\t\tvar r = \"\";\n\t\tvar b0, b1, b2, enc1, enc2, enc3, enc4;\n\t\tvar base64Key = ByteArrayBase.Base64Key;\n\t\twhile (count >= 3) {\n\t\t\tb0 = getUnsignedByteFunc.apply(self);\n\t\t\tb1 = getUnsignedByteFunc.apply(self);\n\t\t\tb2 = getUnsignedByteFunc.apply(self);\n\t\t\tenc1 = b0 >> 2;\n\t\t\tenc2 = ((b0 & 3) << 4) | (b1 >> 4);\n\t\t\tenc3 = ((b1 & 15) << 2) | (b2 >> 6);\n\t\t\tenc4 = b2 & 63;\n\t\t\tr += base64Key.charAt(enc1) + base64Key.charAt(enc2) + base64Key.charAt(enc3) + base64Key.charAt(enc4);\n\t\t\tcount -= 3;\n\t\t}\n\t\t// pad\n\t\tif (count == 2) {\n\t\t\tb0 = getUnsignedByteFunc.apply(self);\n\t\t\tb1 = getUnsignedByteFunc.apply(self);\n\t\t\tenc1 = b0 >> 2;\n\t\t\tenc2 = ((b0 & 3) << 4) | (b1 >> 4);\n\t\t\tenc3 = ((b1 & 15) << 2);\n\t\t\tr += base64Key.charAt(enc1) + base64Key.charAt(enc2) + base64Key.charAt(enc3) + \"=\";\n\t\t} else if (count == 1) {\n\t\t\tb0 = getUnsignedByteFunc.apply(self);\n\t\t\tenc1 = b0 >> 2;\n\t\t\tenc2 = ((b0 & 3) << 4);\n\t\t\tr += base64Key.charAt(enc1) + base64Key.charAt(enc2) + \"==\";\n\t\t}\n\t\treturn r;\n\t}\n}\n\nexport = ByteArrayBase;",
    "/**\n *\n */\nclass ColorUtils\n{\n\tpublic static float32ColorToARGB(float32Color:number):number[]\n\t{\n\t\tvar a:number = ( float32Color & 0xff000000 ) >>> 24\n\t\tvar r:number = ( float32Color & 0xff0000 ) >>> 16;\n\t\tvar g:number = ( float32Color & 0xff00 ) >>> 8;\n\t\tvar b:number = float32Color & 0xff;\n\t\tvar result:number[] = [ a, r , g , b ];\n\n\t\treturn result;\n\t}\n\n\tprivate static componentToHex(c:number):string\n\t{\n\t\tvar hex = c.toString(16);\n\t\treturn hex.length == 1? \"0\" + hex : hex;\n\t}\n\n\tpublic static RGBToHexString(argb:number[]):string\n\t{\n\t\treturn \"#\" + ColorUtils.componentToHex(argb[1]) + ColorUtils.componentToHex(argb[2]) + ColorUtils.componentToHex(argb[3]);\n\t}\n\n\tpublic static ARGBToHexString(argb:number[]):string\n\t{\n\t\treturn \"#\" + ColorUtils.componentToHex(argb[0]) + ColorUtils.componentToHex(argb[1]) + ColorUtils.componentToHex(argb[2]) + ColorUtils.componentToHex(argb[3]);\n\t}\n}\n\nexport = ColorUtils;",
    "import getTimer\t\t\t\t\t= require(\"awayjs-core/lib/utils/getTimer\");\n\nclass RequestAnimationFrame\n{\n\tprivate _callback:Function;\n\tprivate _callbackContext:Object;\n\tprivate _active:boolean = false;\n\tprivate _rafUpdateFunction:any;\n\tprivate _prevTime:number;\n\tprivate _dt:number;\n\tprivate _currentTime:number;\n\tprivate _argsArray:Array<any> = new Array();\n\tprivate _getTimer:Function;\n\n\tconstructor(callback:Function, callbackContext:Object)\n\t{\n\t\tthis._getTimer = getTimer;\n\n\t\tthis.setCallback(callback, callbackContext);\n\n\t\tthis._rafUpdateFunction = () => {\n\t\t\tif (this._active)\n\t\t\t\tthis._tick();\n\t\t}\n\n\t\tthis._argsArray.push(this._dt);\n\t}\n\n\t// Public\n\n\t/**\n\t *\n\t * @param callback\n\t * @param callbackContext\n\t */\n\tpublic setCallback(callback:Function, callbackContext:Object)\n\t{\n\t\tthis._callback = callback;\n\t\tthis._callbackContext = callbackContext;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic start()\n\t{\n\t\tthis._prevTime = this._getTimer();\n\t\tthis._active = true;\n\n\t\tif (window.requestAnimationFrame) {\n\t\t\twindow.requestAnimationFrame(this._rafUpdateFunction);\n\t\t} else {\n\t\t\tif (window['mozRequestAnimationFrame'])\n\t\t\t\twindow.requestAnimationFrame = window['mozRequestAnimationFrame'];\n\t\t\telse if (window['webkitRequestAnimationFrame'])\n\t\t\t\twindow.requestAnimationFrame = window['webkitRequestAnimationFrame'];\n\t\t\telse if (window['oRequestAnimationFrame'])\n\t\t\t\twindow.requestAnimationFrame = window['oRequestAnimationFrame'];\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic stop()\n\t{\n\t\tthis._active = false;\n\t}\n\n\t// Get / Set\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic get active():boolean\n\t{\n\t\treturn this._active;\n\t}\n\n\t// Private\n\n\t/**\n\t *\n\t * @private\n\t */\n\tprivate _tick():void\n\t{\n\t\tthis._currentTime = this._getTimer();\n\t\tthis._dt = this._currentTime - this._prevTime;\n\t\tthis._argsArray[0] = this._dt;\n\t\tthis._callback.apply(this._callbackContext, this._argsArray);\n\n\t\twindow.requestAnimationFrame(this._rafUpdateFunction);\n\n\t\tthis._prevTime = this._currentTime;\n\t}\n\n\n}\n\nexport = RequestAnimationFrame;",
    "import BitmapData\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\n\nclass TextureUtils\n{\n\tprivate static MAX_SIZE:number = 2048;\n\n\tpublic static isBitmapDataValid(bitmapData:BitmapData):boolean\n\t{\n\t\tif (bitmapData == null) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn TextureUtils.isDimensionValid(bitmapData.width) && TextureUtils.isDimensionValid(bitmapData.height);\n\n\t}\n\n\tpublic static isHTMLImageElementValid(image:HTMLImageElement):boolean\n\t{\n\t\tif (image == null)\n\t\t\treturn true;\n\n\t\treturn TextureUtils.isDimensionValid(image.width) && TextureUtils.isDimensionValid(image.height);\n\n\t}\n\n\tpublic static isDimensionValid(d:number):boolean\n\t{\n\n\t\treturn d >= 1 && d <= TextureUtils.MAX_SIZE && TextureUtils.isPowerOfTwo(d);\n\n\t}\n\n\tpublic static isPowerOfTwo(value:number):boolean\n\t{\n\n\t\treturn value? ( ( value & -value ) == value ) : false;\n\n\t}\n\n\tpublic static getBestPowerOf2(value:number):number\n\t{\n\t\tvar p:number = 1;\n\n\t\twhile (p < value)\n\t\t\tp <<= 1;\n\n\t\tif (p > TextureUtils.MAX_SIZE)\n\t\t\tp = TextureUtils.MAX_SIZE;\n\n\t\treturn p;\n\t}\n}\n\nexport = TextureUtils",
    "/**\n *\n *\n * @returns {number}\n */\nfunction getTimer():number\n{\n\t// number milliseconds of 1970/01/01\n\t// this different to AS3 implementation which gets the number of milliseconds\n\t// since instance of Flash player was initialised\n\treturn Date.now();\n}\n\nexport = getTimer;",
    "/**\n *\n */\nclass AlignmentMode\n{\n\t/**\n\t *\n\t */\n\tpublic static REGISTRATION_POINT:string = \"registrationPoint\";\n\n\t/**\n\t *\n\t */\n\tpublic static PIVOT_POINT:string = \"pivot\";\n}\n\nexport = AlignmentMode;",
    "/**\n * A class that provides constant values for visual blend mode effects. These\n * constants are used in the following:\n * <ul>\n *   <li> The <code>blendMode</code> property of the\n * flash.display.DisplayObject class.</li>\n *   <li> The <code>blendMode</code> parameter of the <code>draw()</code>\n * method of the flash.display.BitmapData class</li>\n * </ul>\n */\nclass BlendMode\n{\n\t/**\n\t * Adds the values of the constituent colors of the display object to the\n\t * colors of its background, applying a ceiling of 0xFF. This setting is\n\t * commonly used for animating a lightening dissolve between two objects.\n\t *\n\t * <p>For example, if the display object has a pixel with an RGB value of\n\t * 0xAAA633, and the background pixel has an RGB value of 0xDD2200, the\n\t * resulting RGB value for the displayed pixel is 0xFFC833(because 0xAA +\n\t * 0xDD > 0xFF, 0xA6 + 0x22 = 0xC8, and 0x33 + 0x00 = 0x33).</p>\n\t */\n\tpublic static ADD:string = \"add\";\n\n\t/**\n\t * Applies the alpha value of each pixel of the display object to the\n\t * background. This requires the <code>blendMode</code> property of the\n\t * parent display object be set to\n\t * <code>away.base.BlendMode.LAYER</code>.\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static ALPHA:string = \"alpha\";\n\n\t/**\n\t * Selects the darker of the constituent colors of the display object and the\n\t * colors of the background(the colors with the smaller values). This\n\t * setting is commonly used for superimposing type.\n\t *\n\t * <p>For example, if the display object has a pixel with an RGB value of\n\t * 0xFFCC33, and the background pixel has an RGB value of 0xDDF800, the\n\t * resulting RGB value for the displayed pixel is 0xDDCC00(because 0xFF >\n\t * 0xDD, 0xCC < 0xF8, and 0x33 > 0x00 = 33).</p>\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static DARKEN:string = \"darken\";\n\n\t/**\n\t * Compares the constituent colors of the display object with the colors of\n\t * its background, and subtracts the darker of the values of the two\n\t * constituent colors from the lighter value. This setting is commonly used\n\t * for more vibrant colors.\n\t *\n\t * <p>For example, if the display object has a pixel with an RGB value of\n\t * 0xFFCC33, and the background pixel has an RGB value of 0xDDF800, the\n\t * resulting RGB value for the displayed pixel is 0x222C33(because 0xFF -\n\t * 0xDD = 0x22, 0xF8 - 0xCC = 0x2C, and 0x33 - 0x00 = 0x33).</p>\n\t */\n\tpublic static DIFFERENCE:string = \"difference\";\n\n\t/**\n\t * Erases the background based on the alpha value of the display object. This\n\t * process requires that the <code>blendMode</code> property of the parent\n\t * display object be set to <code>flash.display.BlendMode.LAYER</code>.\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static ERASE:string = \"erase\";\n\n\t/**\n\t * Adjusts the color of each pixel based on the darkness of the display\n\t * object. If the display object is lighter than 50% gray, the display object\n\t * and background colors are screened, which results in a lighter color. If\n\t * the display object is darker than 50% gray, the colors are multiplied,\n\t * which results in a darker color. This setting is commonly used for shading\n\t * effects.\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static HARDLIGHT:string = \"hardlight\";\n\n\t/**\n\t * Inverts the background.\n\t */\n\tpublic static INVERT:string = \"invert\";\n\n\t/**\n\t * Forces the creation of a transparency group for the display object. This\n\t * means that the display object is precomposed in a temporary buffer before\n\t * it is processed further. The precomposition is done automatically if the\n\t * display object is precached by means of bitmap caching or if the display\n\t * object is a display object container that has at least one child object\n\t * with a <code>blendMode</code> setting other than <code>\"normal\"</code>.\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static LAYER:string = \"layer\";\n\n\t/**\n\t * Selects the lighter of the constituent colors of the display object and\n\t * the colors of the background(the colors with the larger values). This\n\t * setting is commonly used for superimposing type.\n\t *\n\t * <p>For example, if the display object has a pixel with an RGB value of\n\t * 0xFFCC33, and the background pixel has an RGB value of 0xDDF800, the\n\t * resulting RGB value for the displayed pixel is 0xFFF833(because 0xFF >\n\t * 0xDD, 0xCC < 0xF8, and 0x33 > 0x00 = 33).</p>\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static LIGHTEN:string = \"lighten\";\n\n\t/**\n\t * Multiplies the values of the display object constituent colors by the\n\t * constituent colors of the background color, and normalizes by dividing by\n\t * 0xFF, resulting in darker colors. This setting is commonly used for\n\t * shadows and depth effects.\n\t *\n\t * <p>For example, if a constituent color(such as red) of one pixel in the\n\t * display object and the corresponding color of the pixel in the background\n\t * both have the value 0x88, the multiplied result is 0x4840. Dividing by\n\t * 0xFF yields a value of 0x48 for that constituent color, which is a darker\n\t * shade than the color of the display object or the color of the\n\t * background.</p>\n\t */\n\tpublic static MULTIPLY:string = \"multiply\";\n\n\t/**\n\t * The display object appears in front of the background. Pixel values of the\n\t * display object override the pixel values of the background. Where the\n\t * display object is transparent, the background is visible.\n\t */\n\tpublic static NORMAL:string = \"normal\";\n\n\t/**\n\t * Adjusts the color of each pixel based on the darkness of the background.\n\t * If the background is lighter than 50% gray, the display object and\n\t * background colors are screened, which results in a lighter color. If the\n\t * background is darker than 50% gray, the colors are multiplied, which\n\t * results in a darker color. This setting is commonly used for shading\n\t * effects.\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static OVERLAY:string = \"overlay\";\n\n\t/**\n\t * Multiplies the complement(inverse) of the display object color by the\n\t * complement of the background color, resulting in a bleaching effect. This\n\t * setting is commonly used for highlights or to remove black areas of the\n\t * display object.\n\t */\n\tpublic static SCREEN:string = \"screen\";\n\n\t/**\n\t * Uses a shader to define the blend between objects.\n\t *\n\t * <p>Setting the <code>blendShader</code> property to a Shader instance\n\t * automatically sets the display object's <code>blendMode</code> property to\n\t * <code>BlendMode.SHADER</code>. If the <code>blendMode</code> property is\n\t * set to <code>BlendMode.SHADER</code> without first setting the\n\t * <code>blendShader</code> property, the <code>blendMode</code> property is\n\t * set to <code>BlendMode.NORMAL</code> instead. If the\n\t * <code>blendShader</code> property is set(which sets the\n\t * <code>blendMode</code> property to <code>BlendMode.SHADER</code>), then\n\t * later the value of the <code>blendMode</code> property is changed, the\n\t * blend mode can be reset to use the blend shader simply by setting the\n\t * <code>blendMode</code> property to <code>BlendMode.SHADER</code>. The\n\t * <code>blendShader</code> property does not need to be set again except to\n\t * change the shader that's used to define the blend mode.</p>\n\t *\n\t * <p>Not supported under GPU rendering.</p>\n\t */\n\tpublic static SHADER:string = \"shader\";\n\n\t/**\n\t * Subtracts the values of the constituent colors in the display object from\n\t * the values of the background color, applying a floor of 0. This setting is\n\t * commonly used for animating a darkening dissolve between two objects.\n\t *\n\t * <p>For example, if the display object has a pixel with an RGB value of\n\t * 0xAA2233, and the background pixel has an RGB value of 0xDDA600, the\n\t * resulting RGB value for the displayed pixel is 0x338400(because 0xDD -\n\t * 0xAA = 0x33, 0xA6 - 0x22 = 0x84, and 0x00 - 0x33 < 0x00).</p>\n\t */\n\tpublic static SUBTRACT:string = \"subtract\";\n}\n\nexport = BlendMode;",
    "import AxisAlignedBoundingBox\t= require(\"awayjs-core/lib/bounds/AxisAlignedBoundingBox\");\nimport BoundingVolumeBase\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport MathConsts\t\t\t\t= require(\"awayjs-core/lib/geom/MathConsts\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Point\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Scene\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport ControllerBase\t\t\t= require(\"awayjs-display/lib/controllers/ControllerBase\");\nimport AlignmentMode\t\t\t= require(\"awayjs-display/lib/base/AlignmentMode\");\nimport BlendMode\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\nimport LoaderInfo\t\t\t\t= require(\"awayjs-display/lib/base/LoaderInfo\");\nimport OrientationMode\t\t\t= require(\"awayjs-display/lib/base/OrientationMode\");\nimport IBitmapDrawable\t\t\t= require(\"awayjs-display/lib/base/IBitmapDrawable\");\nimport Transform\t\t\t\t= require(\"awayjs-display/lib/base/Transform\");\nimport EntityNode\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport Partition\t\t\t\t= require(\"awayjs-display/lib/partition/Partition\");\nimport IPickingCollider\t\t\t= require(\"awayjs-display/lib/pick/IPickingCollider\");\nimport PickingCollisionVO\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport IRenderable\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport Camera\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DisplayObjectEvent\t\t= require(\"awayjs-display/lib/events/DisplayObjectEvent\");\nimport SceneEvent\t\t\t\t= require(\"awayjs-display/lib/events/SceneEvent\");\nimport PrefabBase\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrefabBase\");\n\n/**\n * The DisplayObject class is the base class for all objects that can be\n * placed on the display list. The display list manages all objects displayed\n * in flash. Use the DisplayObjectContainer class to arrange the\n * display objects in the display list. DisplayObjectContainer objects can\n * have child display objects, while other display objects, such as Shape and\n * TextField objects, are \"leaf\" nodes that have only parents and siblings, no\n * children.\n *\n * <p>The DisplayObject class supports basic functionality like the <i>x</i>\n * and <i>y</i> position of an object, as well as more advanced properties of\n * the object such as its transformation matrix. </p>\n *\n * <p>DisplayObject is an abstract base class; therefore, you cannot call\n * DisplayObject directly. Invoking <code>new DisplayObject()</code> throws an\n * <code>ArgumentError</code> exception. </p>\n *\n * <p>All display objects inherit from the DisplayObject class.</p>\n *\n * <p>The DisplayObject class itself does not include any APIs for rendering\n * content onscreen. For that reason, if you want create a custom subclass of\n * the DisplayObject class, you will want to extend one of its subclasses that\n * do have APIs for rendering content onscreen, such as the Shape, Sprite,\n * Bitmap, SimpleButton, TextField, or MovieClip class.</p>\n *\n * <p>The DisplayObject class contains several broadcast events. Normally, the\n * target of any particular event is a specific DisplayObject instance. For\n * example, the target of an <code>added</code> event is the specific\n * DisplayObject instance that was added to the display list. Having a single\n * target restricts the placement of event listeners to that target and in\n * some cases the target's ancestors on the display list. With broadcast\n * events, however, the target is not a specific DisplayObject instance, but\n * rather all DisplayObject instances, including those that are not on the\n * display list. This means that you can add a listener to any DisplayObject\n * instance to listen for broadcast events. In addition to the broadcast\n * events listed in the DisplayObject class's Events table, the DisplayObject\n * class also inherits two broadcast events from the EventDispatcher class:\n * <code>activate</code> and <code>deactivate</code>.</p>\n *\n * <p>Some properties previously used in the ActionScript 1.0 and 2.0\n * MovieClip, TextField, and Button classes(such as <code>_alpha</code>,\n * <code>_height</code>, <code>_name</code>, <code>_width</code>,\n * <code>_x</code>, <code>_y</code>, and others) have equivalents in the\n * ActionScript 3.0 DisplayObject class that are renamed so that they no\n * longer begin with the underscore(_) character.</p>\n *\n * <p>For more information, see the \"Display Programming\" chapter of the\n * <i>ActionScript 3.0 Developer's Guide</i>.</p>\n * \n * @event added            Dispatched when a display object is added to the\n *                         display list. The following methods trigger this\n *                         event:\n *                         <code>DisplayObjectContainer.addChild()</code>,\n *                         <code>DisplayObjectContainer.addChildAt()</code>.\n * @event addedToStage     Dispatched when a display object is added to the on\n *                         stage display list, either directly or through the\n *                         addition of a sub tree in which the display object\n *                         is contained. The following methods trigger this\n *                         event:\n *                         <code>DisplayObjectContainer.addChild()</code>,\n *                         <code>DisplayObjectContainer.addChildAt()</code>.\n * @event enterFrame       [broadcast event] Dispatched when the playhead is\n *                         entering a new frame. If the playhead is not\n *                         moving, or if there is only one frame, this event\n *                         is dispatched continuously in conjunction with the\n *                         frame rate. This event is a broadcast event, which\n *                         means that it is dispatched by all display objects\n *                         with a listener registered for this event.\n * @event exitFrame        [broadcast event] Dispatched when the playhead is\n *                         exiting the current frame. All frame scripts have\n *                         been run. If the playhead is not moving, or if\n *                         there is only one frame, this event is dispatched\n *                         continuously in conjunction with the frame rate.\n *                         This event is a broadcast event, which means that\n *                         it is dispatched by all display objects with a\n *                         listener registered for this event.\n * @event frameConstructed [broadcast event] Dispatched after the constructors\n *                         of frame display objects have run but before frame\n *                         scripts have run. If the playhead is not moving, or\n *                         if there is only one frame, this event is\n *                         dispatched continuously in conjunction with the\n *                         frame rate. This event is a broadcast event, which\n *                         means that it is dispatched by all display objects\n *                         with a listener registered for this event.\n * @event removed          Dispatched when a display object is about to be\n *                         removed from the display list. Two methods of the\n *                         DisplayObjectContainer class generate this event:\n *                         <code>removeChild()</code> and\n *                         <code>removeChildAt()</code>.\n *\n *                         <p>The following methods of a\n *                         DisplayObjectContainer object also generate this\n *                         event if an object must be removed to make room for\n *                         the new object: <code>addChild()</code>,\n *                         <code>addChildAt()</code>, and\n *                         <code>setChildIndex()</code>. </p>\n * @event removedFromStage Dispatched when a display object is about to be\n *                         removed from the display list, either directly or\n *                         through the removal of a sub tree in which the\n *                         display object is contained. Two methods of the\n *                         DisplayObjectContainer class generate this event:\n *                         <code>removeChild()</code> and\n *                         <code>removeChildAt()</code>.\n *\n *                         <p>The following methods of a\n *                         DisplayObjectContainer object also generate this\n *                         event if an object must be removed to make room for\n *                         the new object: <code>addChild()</code>,\n *                         <code>addChildAt()</code>, and\n *                         <code>setChildIndex()</code>. </p>\n * @event render           [broadcast event] Dispatched when the display list\n *                         is about to be updated and rendered. This event\n *                         provides the last opportunity for objects listening\n *                         for this event to make changes before the display\n *                         list is rendered. You must call the\n *                         <code>invalidate()</code> method of the Stage\n *                         object each time you want a <code>render</code>\n *                         event to be dispatched. <code>Render</code> events\n *                         are dispatched to an object only if there is mutual\n *                         trust between it and the object that called\n *                         <code>Stage.invalidate()</code>. This event is a\n *                         broadcast event, which means that it is dispatched\n *                         by all display objects with a listener registered\n *                         for this event.\n *\n *                         <p><b>Note: </b>This event is not dispatched if the\n *                         display is not rendering. This is the case when the\n *                         content is either minimized or obscured. </p>\n */\nclass DisplayObject extends NamedAssetBase implements IBitmapDrawable\n{\n\tprivate _loaderInfo:LoaderInfo;\n\tprivate _mouseX:number;\n\tprivate _mouseY:number;\n\tprivate _root:DisplayObjectContainer;\n\tprivate _bounds:Rectangle;\n\tprivate _boundsVisible:boolean;\n\tprivate _depth:number;\n\tprivate _height:number;\n\tprivate _width:number;\n\n\tpublic _pScene:Scene;\n\tpublic _pParent:DisplayObjectContainer;\n\tpublic _pSceneTransform:Matrix3D = new Matrix3D();\n\tpublic _pSceneTransformDirty:boolean = true;\n\tpublic _pIsEntity:boolean;\n\n\tprivate _explicitPartition:Partition;\n\tpublic _pImplicitPartition:Partition;\n\tprivate _partitionNode:EntityNode;\n\n\tprivate _sceneTransformChanged:DisplayObjectEvent;\n\tprivate _scenechanged:DisplayObjectEvent;\n\tprivate _transform:Transform;\n\tprivate _matrix3D:Matrix3D = new Matrix3D();\n\tprivate _matrix3DDirty:boolean = true;\n\n\tprivate _inverseSceneTransform:Matrix3D = new Matrix3D();\n\tprivate _inverseSceneTransformDirty:boolean = true;\n\tprivate _scenePosition:Vector3D = new Vector3D();\n\tprivate _scenePositionDirty:boolean = true;\n\tprivate _explicitVisibility:boolean = true;\n\tpublic _pImplicitVisibility:boolean = true;\n\tprivate _explicitMouseEnabled:boolean = true;\n\tpublic _pImplicitMouseEnabled:boolean = true;\n\tprivate _listenToSceneTransformChanged:boolean;\n\tprivate _listenToSceneChanged:boolean;\n\n\tprivate _positionDirty:boolean = true;\n\tprivate _rotationDirty:boolean = true;\n\tprivate _scaleDirty:boolean = true;\n\n\tprivate _positionChanged:DisplayObjectEvent;\n\tprivate _rotationChanged:DisplayObjectEvent;\n\tprivate _scaleChanged:DisplayObjectEvent;\n\n\tprivate _rotationX:number = 0;\n\tprivate _rotationY:number = 0;\n\tprivate _rotationZ:number = 0;\n\tprivate _eulers:Vector3D = new Vector3D();\n\tprivate _flipY:Matrix3D = new Matrix3D();\n\n\tprivate _listenToPositionChanged:boolean;\n\tprivate _listenToRotationChanged:boolean;\n\tprivate _listenToScaleChanged:boolean;\n\tprivate _zOffset:number = 0;\n\n\tpublic _pScaleX:number = 1;\n\tpublic _pScaleY:number = 1;\n\tpublic _pScaleZ:number = 1;\n\tprivate _x:number = 0;\n\tprivate _y:number = 0;\n\tprivate _z:number = 0;\n\tprivate _pivot:Vector3D = new Vector3D();\n\tprivate _orientationMatrix:Matrix3D = new Matrix3D();\n\tprivate _pivotZero:boolean = true;\n\tprivate _pivotDirty:boolean = true;\n\tprivate _pos:Vector3D = new Vector3D();\n\tprivate _rot:Vector3D = new Vector3D();\n\tprivate _sca:Vector3D = new Vector3D();\n\tprivate _transformComponents:Array<Vector3D>;\n\n\tpublic _pIgnoreTransform:boolean = false;\n\n\tprivate _shaderPickingDetails:boolean;\n\n\tpublic _pPickingCollisionVO:PickingCollisionVO;\n\n\tpublic _pBounds:BoundingVolumeBase;\n\tpublic _pBoundsInvalid:boolean = true;\n\tprivate _worldBounds:BoundingVolumeBase;\n\tprivate _worldBoundsInvalid:boolean = true;\n\n\tpublic _pPickingCollider:IPickingCollider;\n\n\tpublic _pRenderables:Array<IRenderable> = new Array<IRenderable>();\n\n\tpublic _iSourcePrefab:PrefabBase;\n\n\t/**\n\t *\n\t */\n\tpublic alignmentMode:string = AlignmentMode.REGISTRATION_POINT;\n\n\t/**\n\t * Indicates the alpha transparency value of the object specified. Valid\n\t * values are 0(fully transparent) to 1(fully opaque). The default value is\n\t * 1. Display objects with <code>alpha</code> set to 0 <i>are</i> active,\n\t * even though they are invisible.\n\t */\n\tpublic alpha:number;\n\n\t/**\n\t * A value from the BlendMode class that specifies which blend mode to use. A\n\t * bitmap can be drawn internally in two ways. If you have a blend mode\n\t * enabled or an external clipping mask, the bitmap is drawn by adding a\n\t * bitmap-filled square shape to the vector render. If you attempt to set\n\t * this property to an invalid value, Flash runtimes set the value to\n\t * <code>BlendMode.NORMAL</code>.\n\t *\n\t * <p>The <code>blendMode</code> property affects each pixel of the display\n\t * object. Each pixel is composed of three constituent colors(red, green,\n\t * and blue), and each constituent color has a value between 0x00 and 0xFF.\n\t * Flash Player or Adobe AIR compares each constituent color of one pixel in\n\t * the movie clip with the corresponding color of the pixel in the\n\t * background. For example, if <code>blendMode</code> is set to\n\t * <code>BlendMode.LIGHTEN</code>, Flash Player or Adobe AIR compares the red\n\t * value of the display object with the red value of the background, and uses\n\t * the lighter of the two as the value for the red component of the displayed\n\t * color.</p>\n\t *\n\t * <p>The following table describes the <code>blendMode</code> settings. The\n\t * BlendMode class defines string values you can use. The illustrations in\n\t * the table show <code>blendMode</code> values applied to a circular display\n\t * object(2) superimposed on another display object(1).</p>\n\t */\n\tpublic blendMode:BlendMode;\n\n\t/**\n\t *\n\t */\n\tpublic get bounds():BoundingVolumeBase\n\t{\n\t\tif (this._pBoundsInvalid)\n\t\t\tthis.pUpdateBounds();\n\n\t\treturn this._pBounds;\n\t}\n\n\tpublic set bounds(value:BoundingVolumeBase)\n\t{\n\t\tif (this._pBounds == value)\n\t\t\treturn;\n\n\t\tthis._pBounds = value;\n\n\t\tthis._worldBounds = value.clone();\n\n\t\tthis.pInvalidateBounds();\n\n\t\tif (this._boundsVisible)\n\t\t\tthis._partitionNode._iUpdateEntityBounds();\n\t}\n\n\t/**\n\t * If set to <code>true</code>, NME will use the software renderer to cache\n\t * an internal bitmap representation of the display object. For native targets,\n\t * this is often much slower than the default hardware renderer. When you\n\t * are using the Flash target, this caching may increase performance for display\n\t * objects that contain complex vector content.\n\t *\n\t * <p>All vector data for a display object that has a cached bitmap is drawn\n\t * to the bitmap instead of the main display. If\n\t * <code>cacheAsBitmapMatrix</code> is null or unsupported, the bitmap is\n\t * then copied to the main display as unstretched, unrotated pixels snapped\n\t * to the nearest pixel boundaries. Pixels are mapped 1 to 1 with the parent\n\t * object. If the bounds of the bitmap change, the bitmap is recreated\n\t * instead of being stretched.</p>\n\t *\n\t * <p>If <code>cacheAsBitmapMatrix</code> is non-null and supported, the\n\t * object is drawn to the off-screen bitmap using that matrix and the\n\t * stretched and/or rotated results of that rendering are used to draw the\n\t * object to the main display.</p>\n\t *\n\t * <p>No internal bitmap is created unless the <code>cacheAsBitmap</code>\n\t * property is set to <code>true</code>.</p>\n\t *\n\t * <p>After you set the <code>cacheAsBitmap</code> property to\n\t * <code>true</code>, the rendering does not change, however the display\n\t * object performs pixel snapping automatically. The animation speed can be\n\t * significantly faster depending on the complexity of the vector content.\n\t * </p>\n\t *\n\t * <p>The <code>cacheAsBitmap</code> property is automatically set to\n\t * <code>true</code> whenever you apply a filter to a display object(when\n\t * its <code>filter</code> array is not empty), and if a display object has a\n\t * filter applied to it, <code>cacheAsBitmap</code> is reported as\n\t * <code>true</code> for that display object, even if you set the property to\n\t * <code>false</code>. If you clear all filters for a display object, the\n\t * <code>cacheAsBitmap</code> setting changes to what it was last set to.</p>\n\t *\n\t * <p>A display object does not use a bitmap even if the\n\t * <code>cacheAsBitmap</code> property is set to <code>true</code> and\n\t * instead renders from vector data in the following cases:</p>\n\t *\n\t * <ul>\n\t *   <li>The bitmap is too large. In AIR 1.5 and Flash Player 10, the maximum\n\t * size for a bitmap image is 8,191 pixels in width or height, and the total\n\t * number of pixels cannot exceed 16,777,215 pixels.(So, if a bitmap image\n\t * is 8,191 pixels wide, it can only be 2,048 pixels high.) In Flash Player 9\n\t * and earlier, the limitation is is 2880 pixels in height and 2,880 pixels\n\t * in width.</li>\n\t *   <li>The bitmap fails to allocate(out of memory error). </li>\n\t * </ul>\n\t *\n\t * <p>The <code>cacheAsBitmap</code> property is best used with movie clips\n\t * that have mostly static content and that do not scale and rotate\n\t * frequently. With such movie clips, <code>cacheAsBitmap</code> can lead to\n\t * performance increases when the movie clip is translated(when its <i>x</i>\n\t * and <i>y</i> position is changed).</p>\n\t */\n\tpublic cacheAsBitmap:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic castsShadows:boolean = true;\n\n\t/**\n\t * Indicates the depth of the display object, in pixels. The depth is\n\t * calculated based on the bounds of the content of the display object. When\n\t * you set the <code>depth</code> property, the <code>scaleZ</code> property\n\t * is adjusted accordingly, as shown in the following code:\n\t *\n\t * <p>Except for TextField and Video objects, a display object with no\n\t * content (such as an empty sprite) has a depth of 0, even if you try to\n\t * set <code>depth</code> to a different value.</p>\n\t */\n\tpublic get depth():number\n\t{\n\t\tif (this._pBoundsInvalid)\n\t\t\tthis.pUpdateBounds();\n\n\t\treturn this._depth;\n\t}\n\n\tpublic set depth(val:number)\n\t{\n\t\tif (this._depth == val)\n\t\t\treturn;\n\n\t\tthis._depth == val;\n\n\t\tthis._pScaleZ = val/this.bounds.aabb.depth;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t * Defines the rotation of the 3d object as a <code>Vector3D</code> object containing euler angles for rotation around x, y and z axis.\n\t */\n\tpublic get eulers():Vector3D\n\t{\n\t\tthis._eulers.x = this._rotationX*MathConsts.RADIANS_TO_DEGREES;\n\t\tthis._eulers.y = this._rotationY*MathConsts.RADIANS_TO_DEGREES;\n\t\tthis._eulers.z = this._rotationZ*MathConsts.RADIANS_TO_DEGREES;\n\n\t\treturn this._eulers;\n\t}\n\n\tpublic set eulers(value:Vector3D)\n\t{\n\t\tthis._rotationX = value.x*MathConsts.DEGREES_TO_RADIANS;\n\t\tthis._rotationY = value.y*MathConsts.DEGREES_TO_RADIANS;\n\t\tthis._rotationZ = value.z*MathConsts.DEGREES_TO_RADIANS;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * An object that can contain any extra data.\n\t */\n\tpublic extra:Object;\n\n\t/**\n\t * An indexed array that contains each filter object currently associated\n\t * with the display object. The flash.filters package contains several\n\t * classes that define specific filters you can use.\n\t *\n\t * <p>Filters can be applied in Flash Professional at design time, or at run\n\t * time by using ActionScript code. To apply a filter by using ActionScript,\n\t * you must make a temporary copy of the entire <code>filters</code> array,\n\t * modify the temporary array, then assign the value of the temporary array\n\t * back to the <code>filters</code> array. You cannot directly add a new\n\t * filter object to the <code>filters</code> array.</p>\n\t *\n\t * <p>To add a filter by using ActionScript, perform the following steps\n\t * (assume that the target display object is named\n\t * <code>myDisplayObject</code>):</p>\n\t *\n\t * <ol>\n\t *   <li>Create a new filter object by using the constructor method of your\n\t * chosen filter class.</li>\n\t *   <li>Assign the value of the <code>myDisplayObject.filters</code> array\n\t * to a temporary array, such as one named <code>myFilters</code>.</li>\n\t *   <li>Add the new filter object to the <code>myFilters</code> temporary\n\t * array.</li>\n\t *   <li>Assign the value of the temporary array to the\n\t * <code>myDisplayObject.filters</code> array.</li>\n\t * </ol>\n\t *\n\t * <p>If the <code>filters</code> array is undefined, you do not need to use\n\t * a temporary array. Instead, you can directly assign an array literal that\n\t * contains one or more filter objects that you create. The first example in\n\t * the Examples section adds a drop shadow filter by using code that handles\n\t * both defined and undefined <code>filters</code> arrays.</p>\n\t *\n\t * <p>To modify an existing filter object, you must use the technique of\n\t * modifying a copy of the <code>filters</code> array:</p>\n\t *\n\t * <ol>\n\t *   <li>Assign the value of the <code>filters</code> array to a temporary\n\t * array, such as one named <code>myFilters</code>.</li>\n\t *   <li>Modify the property by using the temporary array,\n\t * <code>myFilters</code>. For example, to set the quality property of the\n\t * first filter in the array, you could use the following code:\n\t * <code>myFilters[0].quality = 1;</code></li>\n\t *   <li>Assign the value of the temporary array to the <code>filters</code>\n\t * array.</li>\n\t * </ol>\n\t *\n\t * <p>At load time, if a display object has an associated filter, it is\n\t * marked to cache itself as a transparent bitmap. From this point forward,\n\t * as long as the display object has a valid filter list, the player caches\n\t * the display object as a bitmap. This source bitmap is used as a source\n\t * image for the filter effects. Each display object usually has two bitmaps:\n\t * one with the original unfiltered source display object and another for the\n\t * final image after filtering. The final image is used when rendering. As\n\t * long as the display object does not change, the final image does not need\n\t * updating.</p>\n\t *\n\t * <p>The flash.filters package includes classes for filters. For example, to\n\t * create a DropShadow filter, you would write:</p>\n\t *\n\t * @throws ArgumentError When <code>filters</code> includes a ShaderFilter\n\t *                       and the shader output type is not compatible with\n\t *                       this operation(the shader must specify a\n\t *                       <code>pixel4</code> output).\n\t * @throws ArgumentError When <code>filters</code> includes a ShaderFilter\n\t *                       and the shader doesn't specify any image input or\n\t *                       the first input is not an <code>image4</code> input.\n\t * @throws ArgumentError When <code>filters</code> includes a ShaderFilter\n\t *                       and the shader specifies an image input that isn't\n\t *                       provided.\n\t * @throws ArgumentError When <code>filters</code> includes a ShaderFilter, a\n\t *                       ByteArray or Vector.<Number> instance as a shader\n\t *                       input, and the <code>width</code> and\n\t *                       <code>height</code> properties aren't specified for\n\t *                       the ShaderInput object, or the specified values\n\t *                       don't match the amount of data in the input data.\n\t *                       See the <code>ShaderInput.input</code> property for\n\t *                       more information.\n\t */\n//\t\tpublic filters:Array<Dynamic>;\n\n\t/**\n\t * Indicates the height of the display object, in pixels. The height is\n\t * calculated based on the bounds of the content of the display object. When\n\t * you set the <code>height</code> property, the <code>scaleY</code> property\n\t * is adjusted accordingly, as shown in the following code:\n\t *\n\t * <p>Except for TextField and Video objects, a display object with no\n\t * content (such as an empty sprite) has a height of 0, even if you try to\n\t * set <code>height</code> to a different value.</p>\n\t */\n\tpublic get height():number\n\t{\n\t\tif (this._pBoundsInvalid)\n\t\t\tthis.pUpdateBounds();\n\n\t\treturn this._height;\n\t}\n\n\tpublic set height(val:number)\n\t{\n\t\tif (this._height == val)\n\t\t\treturn;\n\n\t\tthis._height == val;\n\n\t\tthis._pScaleY = val/this.bounds.aabb.height;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t * Indicates the instance container index of the DisplayObject. The object can be\n\t * identified in the child list of its parent display object container by\n\t * calling the <code>getChildByIndex()</code> method of the display object\n\t * container.\n\t *\n\t * <p>If the DisplayObject has no parent container, index defaults to 0.</p>\n\t */\n\tpublic get index():number\n\t{\n\t\tif (this._pParent)\n\t\t\treturn this._pParent.getChildIndex(this);\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get inverseSceneTransform():Matrix3D\n\t{\n\t\tif (this._inverseSceneTransformDirty) {\n\t\t\tthis._inverseSceneTransform.copyFrom(this.sceneTransform);\n\t\t\tthis._inverseSceneTransform.invert();\n\t\t\tthis._inverseSceneTransformDirty = false;\n\t\t}\n\t\treturn this._inverseSceneTransform;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get ignoreTransform():boolean\n\t{\n\t\treturn this._pIgnoreTransform;\n\t}\n\n\tpublic set ignoreTransform(value:boolean)\n\t{\n\t\tif (this._pIgnoreTransform == value)\n\t\t\treturn;\n\n\t\tthis._pIgnoreTransform = value;\n\n\t\tif (value) {\n\t\t\tthis._pSceneTransform.identity();\n\t\t\tthis._scenePosition.setTo(0, 0, 0);\n\t\t}\n\n\t\tthis.pInvalidateSceneTransform();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get isEntity()\n\t{\n\t\treturn this._pIsEntity;\n\t}\n\t/**\n\t * Returns a LoaderInfo object containing information about loading the file\n\t * to which this display object belongs. The <code>loaderInfo</code> property\n\t * is defined only for the root display object of a SWF file or for a loaded\n\t * Bitmap(not for a Bitmap that is drawn with ActionScript). To find the\n\t * <code>loaderInfo</code> object associated with the SWF file that contains\n\t * a display object named <code>myDisplayObject</code>, use\n\t * <code>myDisplayObject.root.loaderInfo</code>.\n\t *\n\t * <p>A large SWF file can monitor its download by calling\n\t * <code>this.root.loaderInfo.addEventListener(Event.COMPLETE,\n\t * func)</code>.</p>\n\t */\n\tpublic get loaderInfo():LoaderInfo\n\t{\n\t\treturn this._loaderInfo;\n\t}\n\n\t/**\n\t * The calling display object is masked by the specified <code>mask</code>\n\t * object. To ensure that masking works when the Stage is scaled, the\n\t * <code>mask</code> display object must be in an active part of the display\n\t * list. The <code>mask</code> object itself is not drawn. Set\n\t * <code>mask</code> to <code>null</code> to remove the mask.\n\t *\n\t * <p>To be able to scale a mask object, it must be on the display list. To\n\t * be able to drag a mask Sprite object(by calling its\n\t * <code>startDrag()</code> method), it must be on the display list. To call\n\t * the <code>startDrag()</code> method for a mask sprite based on a\n\t * <code>mouseDown</code> event being dispatched by the sprite, set the\n\t * sprite's <code>buttonMode</code> property to <code>true</code>.</p>\n\t *\n\t * <p>When display objects are cached by setting the\n\t * <code>cacheAsBitmap</code> property to <code>true</code> an the\n\t * <code>cacheAsBitmapMatrix</code> property to a Matrix object, both the\n\t * mask and the display object being masked must be part of the same cached\n\t * bitmap. Thus, if the display object is cached, then the mask must be a\n\t * child of the display object. If an ancestor of the display object on the\n\t * display list is cached, then the mask must be a child of that ancestor or\n\t * one of its descendents. If more than one ancestor of the masked object is\n\t * cached, then the mask must be a descendent of the cached container closest\n\t * to the masked object in the display list.</p>\n\t *\n\t * <p><b>Note:</b> A single <code>mask</code> object cannot be used to mask\n\t * more than one calling display object. When the <code>mask</code> is\n\t * assigned to a second display object, it is removed as the mask of the\n\t * first object, and that object's <code>mask</code> property becomes\n\t * <code>null</code>.</p>\n\t */\n\tpublic mask:DisplayObject;\n\n\t/**\n\t * Specifies whether this object receives mouse, or other user input,\n\t * messages. The default value is <code>true</code>, which means that by\n\t * default any InteractiveObject instance that is on the display list\n\t * receives mouse events or other user input events. If\n\t * <code>mouseEnabled</code> is set to <code>false</code>, the instance does\n\t * not receive any mouse events(or other user input events like keyboard\n\t * events). Any children of this instance on the display list are not\n\t * affected. To change the <code>mouseEnabled</code> behavior for all\n\t * children of an object on the display list, use\n\t * <code>flash.display.DisplayObjectContainer.mouseChildren</code>.\n\t *\n\t * <p> No event is dispatched by setting this property. You must use the\n\t * <code>addEventListener()</code> method to create interactive\n\t * functionality.</p>\n\t */\n\tpublic get mouseEnabled():boolean\n\t{\n\t\treturn this._explicitMouseEnabled;\n\t}\n\n\tpublic set mouseEnabled(value:boolean)\n\t{\n\t\tif (this._explicitMouseEnabled == value)\n\t\t\treturn;\n\n\t\tthis._explicitMouseEnabled = value;\n\n\t\tthis._pUpdateImplicitMouseEnabled(this._pParent? this._pParent.mouseChildren : true);\n\t}\n\n\n\t/**\n\t * Indicates the x coordinate of the mouse or user input device position, in\n\t * pixels.\n\t *\n\t * <p><b>Note</b>: For a DisplayObject that has been rotated, the returned x\n\t * coordinate will reflect the non-rotated object.</p>\n\t */\n\tpublic get mouseX():number\n\t{\n\t\treturn this._mouseX;\n\t}\n\n\t/**\n\t * Indicates the y coordinate of the mouse or user input device position, in\n\t * pixels.\n\t *\n\t * <p><b>Note</b>: For a DisplayObject that has been rotated, the returned y\n\t * coordinate will reflect the non-rotated object.</p>\n\t */\n\tpublic get mouseY():number\n\t{\n\t\treturn this._mouseY;\n\t}\n\n\t/**\n\t * Indicates the instance name of the DisplayObject. The object can be\n\t * identified in the child list of its parent display object container by\n\t * calling the <code>getChildByName()</code> method of the display object\n\t * container.\n\t *\n\t * @throws IllegalOperationError If you are attempting to set this property\n\t *                               on an object that was placed on the timeline\n\t *                               in the Flash authoring tool.\n\t */\n\tpublic name:string;\n\n\t/**\n\t *\n\t */\n\tpublic orientationMode:string = OrientationMode.DEFAULT;\n\n\t/**\n\t * Indicates the DisplayObjectContainer object that contains this display\n\t * object. Use the <code>parent</code> property to specify a relative path to\n\t * display objects that are above the current display object in the display\n\t * list hierarchy.\n\t *\n\t * <p>You can use <code>parent</code> to move up multiple levels in the\n\t * display list as in the following:</p>\n\t *\n\t * @throws SecurityError The parent display object belongs to a security\n\t *                       sandbox to which you do not have access. You can\n\t *                       avoid this situation by having the parent movie call\n\t *                       the <code>Security.allowDomain()</code> method.\n\t */\n\tpublic get parent():DisplayObjectContainer\n\t{\n\t\treturn this._pParent;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get partition():Partition\n\t{\n\t\treturn this._explicitPartition;\n\t}\n\n\tpublic set partition(value:Partition)\n\t{\n\t\tif (this._explicitPartition == value)\n\t\t\treturn;\n\n\t\tif (this._pScene && this._explicitPartition)\n\t\t\tthis._pScene.iUnregisterPartition(this._explicitPartition);\n\n\t\tthis._explicitPartition = value;\n\n\t\tif (this._pScene && value)\n\t\t\tthis._pScene.iRegisterPartition(value);\n\n\t\tthis._pUpdateImplicitPartition(this._pParent? this._pParent._iAssignedPartition : null);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get partitionNode():EntityNode\n\t{\n\t\tif (!this._partitionNode)\n\t\t\tthis._partitionNode = this.pCreateEntityPartitionNode();\n\n\t\treturn this._partitionNode;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get pickingCollider():IPickingCollider\n\t{\n\t\treturn this._pPickingCollider;\n\t}\n\n\tpublic set pickingCollider(value:IPickingCollider)\n\t{\n\t\tthis._pPickingCollider = value;\n\t}\n\n\t/**\n\t * Defines the local point around which the object rotates.\n\t */\n\tpublic get pivot():Vector3D\n\t{\n\t\treturn this._pivot;\n\t}\n\n\n\tpublic set pivot(pivot:Vector3D)\n\t{\n\t\tthis._pivot = pivot.clone();\n\n\t\tthis.invalidatePivot();\n\t}\n\n\t/**\n\t * For a display object in a loaded SWF file, the <code>root</code> property\n\t * is the top-most display object in the portion of the display list's tree\n\t * structure represented by that SWF file. For a Bitmap object representing a\n\t * loaded image file, the <code>root</code> property is the Bitmap object\n\t * itself. For the instance of the main class of the first SWF file loaded,\n\t * the <code>root</code> property is the display object itself. The\n\t * <code>root</code> property of the Stage object is the Stage object itself.\n\t * The <code>root</code> property is set to <code>null</code> for any display\n\t * object that has not been added to the display list, unless it has been\n\t * added to a display object container that is off the display list but that\n\t * is a child of the top-most display object in a loaded SWF file.\n\t *\n\t * <p>For example, if you create a new Sprite object by calling the\n\t * <code>Sprite()</code> constructor method, its <code>root</code> property\n\t * is <code>null</code> until you add it to the display list(or to a display\n\t * object container that is off the display list but that is a child of the\n\t * top-most display object in a SWF file).</p>\n\t *\n\t * <p>For a loaded SWF file, even though the Loader object used to load the\n\t * file may not be on the display list, the top-most display object in the\n\t * SWF file has its <code>root</code> property set to itself. The Loader\n\t * object does not have its <code>root</code> property set until it is added\n\t * as a child of a display object for which the <code>root</code> property is\n\t * set.</p>\n\t */\n\tpublic get root():DisplayObjectContainer\n\t{\n\t\treturn this._root;\n\t}\n\n\t/**\n\t * Indicates the rotation of the DisplayObject instance, in degrees, from its\n\t * original orientation. Values from 0 to 180 represent clockwise rotation;\n\t * values from 0 to -180 represent counterclockwise rotation. Values outside\n\t * this range are added to or subtracted from 360 to obtain a value within\n\t * the range. For example, the statement <code>my_video.rotation = 450</code>\n\t * is the same as <code> my_video.rotation = 90</code>.\n\t */\n\tpublic rotation:number; //TODO\n\n\t/**\n\t * Indicates the x-axis rotation of the DisplayObject instance, in degrees,\n\t * from its original orientation relative to the 3D parent container. Values\n\t * from 0 to 180 represent clockwise rotation; values from 0 to -180\n\t * represent counterclockwise rotation. Values outside this range are added\n\t * to or subtracted from 360 to obtain a value within the range.\n\t */\n\tpublic get rotationX():number\n\t{\n\t\treturn this._rotationX*MathConsts.RADIANS_TO_DEGREES;\n\t}\n\n\tpublic set rotationX(val:number)\n\t{\n\t\tif (this.rotationX == val)\n\t\t\treturn;\n\n\t\tthis._rotationX = val*MathConsts.DEGREES_TO_RADIANS;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * Indicates the y-axis rotation of the DisplayObject instance, in degrees,\n\t * from its original orientation relative to the 3D parent container. Values\n\t * from 0 to 180 represent clockwise rotation; values from 0 to -180\n\t * represent counterclockwise rotation. Values outside this range are added\n\t * to or subtracted from 360 to obtain a value within the range.\n\t */\n\tpublic get rotationY():number\n\t{\n\t\treturn this._rotationY*MathConsts.RADIANS_TO_DEGREES;\n\t}\n\n\tpublic set rotationY(val:number)\n\t{\n\t\tif (this.rotationY == val)\n\t\t\treturn;\n\n\t\tthis._rotationY = val*MathConsts.DEGREES_TO_RADIANS;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * Indicates the z-axis rotation of the DisplayObject instance, in degrees,\n\t * from its original orientation relative to the 3D parent container. Values\n\t * from 0 to 180 represent clockwise rotation; values from 0 to -180\n\t * represent counterclockwise rotation. Values outside this range are added\n\t * to or subtracted from 360 to obtain a value within the range.\n\t */\n\tpublic get rotationZ():number\n\t{\n\t\treturn this._rotationZ*MathConsts.RADIANS_TO_DEGREES;\n\t}\n\n\tpublic set rotationZ(val:number)\n\t{\n\t\tif (this.rotationZ == val)\n\t\t\treturn;\n\n\t\tthis._rotationZ = val*MathConsts.DEGREES_TO_RADIANS;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * The current scaling grid that is in effect. If set to <code>null</code>,\n\t * the entire display object is scaled normally when any scale transformation\n\t * is applied.\n\t *\n\t * <p>When you define the <code>scale9Grid</code> property, the display\n\t * object is divided into a grid with nine regions based on the\n\t * <code>scale9Grid</code> rectangle, which defines the center region of the\n\t * grid. The eight other regions of the grid are the following areas: </p>\n\t *\n\t * <ul>\n\t *   <li>The upper-left corner outside of the rectangle</li>\n\t *   <li>The area above the rectangle </li>\n\t *   <li>The upper-right corner outside of the rectangle</li>\n\t *   <li>The area to the left of the rectangle</li>\n\t *   <li>The area to the right of the rectangle</li>\n\t *   <li>The lower-left corner outside of the rectangle</li>\n\t *   <li>The area below the rectangle</li>\n\t *   <li>The lower-right corner outside of the rectangle</li>\n\t * </ul>\n\t *\n\t * <p>You can think of the eight regions outside of the center(defined by\n\t * the rectangle) as being like a picture frame that has special rules\n\t * applied to it when scaled.</p>\n\t *\n\t * <p>When the <code>scale9Grid</code> property is set and a display object\n\t * is scaled, all text and gradients are scaled normally; however, for other\n\t * types of objects the following rules apply:</p>\n\t *\n\t * <ul>\n\t *   <li>Content in the center region is scaled normally. </li>\n\t *   <li>Content in the corners is not scaled. </li>\n\t *   <li>Content in the top and bottom regions is scaled horizontally only.\n\t * Content in the left and right regions is scaled vertically only.</li>\n\t *   <li>All fills(including bitmaps, video, and gradients) are stretched to\n\t * fit their shapes.</li>\n\t * </ul>\n\t *\n\t * <p>If a display object is rotated, all subsequent scaling is normal(and\n\t * the <code>scale9Grid</code> property is ignored).</p>\n\t *\n\t * <p>For example, consider the following display object and a rectangle that\n\t * is applied as the display object's <code>scale9Grid</code>:</p>\n\t *\n\t * <p>A common use for setting <code>scale9Grid</code> is to set up a display\n\t * object to be used as a component, in which edge regions retain the same\n\t * width when the component is scaled.</p>\n\t *\n\t * @throws ArgumentError If you pass an invalid argument to the method.\n\t */\n\tpublic scale9Grid:Rectangle;\n\n\t/**\n\t * Indicates the horizontal scale(percentage) of the object as applied from\n\t * the registration point. The default registration point is(0,0). 1.0\n\t * equals 100% scale.\n\t *\n\t * <p>Scaling the local coordinate system changes the <code>x</code> and\n\t * <code>y</code> property values, which are defined in whole pixels. </p>\n\t */\n\tpublic get scaleX():number\n\t{\n\t\treturn this._pScaleX;\n\t}\n\n\tpublic set scaleX(val:number)\n\t{\n\t\tif (this._pScaleX == val)\n\t\t\treturn;\n\n\t\tthis._pScaleX = val;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t * Indicates the vertical scale(percentage) of an object as applied from the\n\t * registration point of the object. The default registration point is(0,0).\n\t * 1.0 is 100% scale.\n\t *\n\t * <p>Scaling the local coordinate system changes the <code>x</code> and\n\t * <code>y</code> property values, which are defined in whole pixels. </p>\n\t */\n\tpublic get scaleY():number\n\t{\n\t\treturn this._pScaleY;\n\t}\n\n\tpublic set scaleY(val:number)\n\t{\n\t\tif (this._pScaleY == val)\n\t\t\treturn;\n\n\t\tthis._pScaleY = val;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t * Indicates the depth scale(percentage) of an object as applied from the\n\t * registration point of the object. The default registration point is(0,0).\n\t * 1.0 is 100% scale.\n\t *\n\t * <p>Scaling the local coordinate system changes the <code>x</code>,\n\t * <code>y</code> and <code>z</code> property values, which are defined in\n\t * whole pixels. </p>\n\t */\n\tpublic get scaleZ():number\n\t{\n\t\treturn this._pScaleZ;\n\t}\n\n\tpublic set scaleZ(val:number)\n\t{\n\t\tif (this._pScaleZ == val)\n\t\t\treturn;\n\n\t\tthis._pScaleZ = val;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scene():Scene\n\t{\n\t\treturn this._pScene;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scenePosition():Vector3D\n\t{\n\t\tif (this._scenePositionDirty) {\n\t\t\tif (!this._pivotZero && this.alignmentMode == AlignmentMode.PIVOT_POINT) {\n\t\t\t\tvar pivotScale:Vector3D = new Vector3D(this._pivot.x/this._pScaleX, this._pivot.y/this._pScaleY, this._pivot.z/this._pScaleZ)\n\t\t\t\t\tthis._scenePosition = this.sceneTransform.transformVector(pivotScale);\n\t\t\t\t//this._scenePosition.decrementBy(new Vector3D(this._pivot.x*this._pScaleX, this._pivot.y*this._pScaleY, this._pivot.z*this._pScaleZ));\n\t\t\t} else {\n\t\t\t\tthis.sceneTransform.copyColumnTo(3, this._scenePosition);\n\t\t\t}\n\n\t\t\tthis._scenePositionDirty = false;\n\t\t}\n\t\treturn this._scenePosition;\n\t}\n\n\tpublic get sceneTransform():Matrix3D\n\t{\n\t\tif (this._pSceneTransformDirty)\n\t\t\tthis.pUpdateSceneTransform();\n\n\t\treturn this._pSceneTransform;\n\t}\n\n\t/**\n\t * The scroll rectangle bounds of the display object. The display object is\n\t * cropped to the size defined by the rectangle, and it scrolls within the\n\t * rectangle when you change the <code>x</code> and <code>y</code> properties\n\t * of the <code>scrollRect</code> object.\n\t *\n\t * <p>The properties of the <code>scrollRect</code> Rectangle object use the\n\t * display object's coordinate space and are scaled just like the overall\n\t * display object. The corner bounds of the cropped window on the scrolling\n\t * display object are the origin of the display object(0,0) and the point\n\t * defined by the width and height of the rectangle. They are not centered\n\t * around the origin, but use the origin to define the upper-left corner of\n\t * the area. A scrolled display object always scrolls in whole pixel\n\t * increments. </p>\n\t *\n\t * <p>You can scroll an object left and right by setting the <code>x</code>\n\t * property of the <code>scrollRect</code> Rectangle object. You can scroll\n\t * an object up and down by setting the <code>y</code> property of the\n\t * <code>scrollRect</code> Rectangle object. If the display object is rotated\n\t * 90° and you scroll it left and right, the display object actually scrolls\n\t * up and down.</p>\n\t */\n\tpublic scrollRect:Rectangle;\n\n\t/**\n\t *\n\t */\n\tpublic get shaderPickingDetails():boolean\n\t{\n\t\treturn this._shaderPickingDetails;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get boundsVisible():boolean\n\t{\n\t\treturn this._boundsVisible;\n\t}\n\n\tpublic set boundsVisible(value:boolean)\n\t{\n\t\tif (value == this._boundsVisible)\n\t\t\treturn;\n\n\t\tthis._boundsVisible = value;\n\n\t\tthis._partitionNode.boundsVisible = value;\n\t}\n\n\t/**\n\t * An object with properties pertaining to a display object's matrix, color\n\t * transform, and pixel bounds. The specific properties  -  matrix,\n\t * colorTransform, and three read-only properties\n\t * (<code>concatenatedMatrix</code>, <code>concatenatedColorTransform</code>,\n\t * and <code>pixelBounds</code>)  -  are described in the entry for the\n\t * Transform class.\n\t *\n\t * <p>Each of the transform object's properties is itself an object. This\n\t * concept is important because the only way to set new values for the matrix\n\t * or colorTransform objects is to create a new object and copy that object\n\t * into the transform.matrix or transform.colorTransform property.</p>\n\t *\n\t * <p>For example, to increase the <code>tx</code> value of a display\n\t * object's matrix, you must make a copy of the entire matrix object, then\n\t * copy the new object into the matrix property of the transform object:</p>\n\t * <pre xml:space=\"preserve\"><code> public myMatrix:Matrix =\n\t * myDisplayObject.transform.matrix; myMatrix.tx += 10;\n\t * myDisplayObject.transform.matrix = myMatrix; </code></pre>\n\t *\n\t * <p>You cannot directly set the <code>tx</code> property. The following\n\t * code has no effect on <code>myDisplayObject</code>: </p>\n\t * <pre xml:space=\"preserve\"><code> myDisplayObject.transform.matrix.tx +=\n\t * 10; </code></pre>\n\t *\n\t * <p>You can also copy an entire transform object and assign it to another\n\t * display object's transform property. For example, the following code\n\t * copies the entire transform object from <code>myOldDisplayObj</code> to\n\t * <code>myNewDisplayObj</code>:</p>\n\t * <code>myNewDisplayObj.transform = myOldDisplayObj.transform;</code>\n\t *\n\t * <p>The resulting display object, <code>myNewDisplayObj</code>, now has the\n\t * same values for its matrix, color transform, and pixel bounds as the old\n\t * display object, <code>myOldDisplayObj</code>.</p>\n\t *\n\t * <p>Note that AIR for TV devices use hardware acceleration, if it is\n\t * available, for color transforms.</p>\n\t */\n\tpublic get transform():Transform\n\t{\n\t\treturn this._transform;\n\t}\n\n\t/**\n\t * Whether or not the display object is visible. Display objects that are not\n\t * visible are disabled. For example, if <code>visible=false</code> for an\n\t * InteractiveObject instance, it cannot be clicked.\n\t */\n\tpublic get visible():boolean\n\t{\n\t\treturn this._explicitVisibility;\n\t}\n\n\tpublic set visible(value:boolean)\n\t{\n\t\tif (this._explicitVisibility == value)\n\t\t\treturn;\n\n\t\tthis._explicitVisibility = value;\n\n\t\tthis._pUpdateImplicitVisibility(this._pParent? this._pParent._iIsVisible() : true);\n\t}\n\n\t/**\n\t * Indicates the width of the display object, in pixels. The width is\n\t * calculated based on the bounds of the content of the display object. When\n\t * you set the <code>width</code> property, the <code>scaleX</code> property\n\t * is adjusted accordingly, as shown in the following code:\n\t *\n\t * <p>Except for TextField and Video objects, a display object with no\n\t * content(such as an empty sprite) has a width of 0, even if you try to set\n\t * <code>width</code> to a different value.</p>\n\t */\n\tpublic get width():number\n\t{\n\t\tif (this._pBoundsInvalid)\n\t\t\tthis.pUpdateBounds();\n\n\t\treturn this._width;\n\t}\n\n\tpublic set width(val:number)\n\t{\n\t\tif (this._width == val)\n\t\t\treturn;\n\n\t\tthis._width == val;\n\n\t\tthis._pScaleX = val/this.bounds.aabb.width;\n\n\t\tthis.invalidateScale();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get worldBounds():BoundingVolumeBase\n\t{\n\t\t// Since this getter is invoked every iteration of the render loop, and\n\t\t// the prefab construct could affect the bounds of the entity, the prefab is\n\t\t// validated here to give it a chance to rebuild.\n\t\tif (this._iSourcePrefab)\n\t\t\tthis._iSourcePrefab._iValidate();\n\n\t\tif (this._worldBoundsInvalid) {\n\t\t\tthis._worldBoundsInvalid = false;\n\t\t\tthis._worldBounds.transformFrom(this.bounds, this.sceneTransform);\n\t\t}\n\n\t\treturn this._worldBounds;\n\t}\n\n\t/**\n\t * Indicates the <i>x</i> coordinate of the DisplayObject instance relative\n\t * to the local coordinates of the parent DisplayObjectContainer. If the\n\t * object is inside a DisplayObjectContainer that has transformations, it is\n\t * in the local coordinate system of the enclosing DisplayObjectContainer.\n\t * Thus, for a DisplayObjectContainer rotated 90° counterclockwise, the\n\t * DisplayObjectContainer's children inherit a coordinate system that is\n\t * rotated 90° counterclockwise. The object's coordinates refer to the\n\t * registration point position.\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._x;\n\t}\n\n\tpublic set x(val:number)\n\t{\n\t\tif (this._x == val)\n\t\t\treturn;\n\n\t\tthis._x = val;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t * Indicates the <i>y</i> coordinate of the DisplayObject instance relative\n\t * to the local coordinates of the parent DisplayObjectContainer. If the\n\t * object is inside a DisplayObjectContainer that has transformations, it is\n\t * in the local coordinate system of the enclosing DisplayObjectContainer.\n\t * Thus, for a DisplayObjectContainer rotated 90° counterclockwise, the\n\t * DisplayObjectContainer's children inherit a coordinate system that is\n\t * rotated 90° counterclockwise. The object's coordinates refer to the\n\t * registration point position.\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._y;\n\t}\n\n\tpublic set y(val:number)\n\t{\n\t\tif (this._y == val)\n\t\t\treturn;\n\n\t\tthis._y = val;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t * Indicates the z coordinate position along the z-axis of the DisplayObject\n\t * instance relative to the 3D parent container. The z property is used for\n\t * 3D coordinates, not screen or pixel coordinates.\n\t *\n\t * <p>When you set a <code>z</code> property for a display object to\n\t * something other than the default value of <code>0</code>, a corresponding\n\t * Matrix3D object is automatically created. for adjusting a display object's\n\t * position and orientation in three dimensions. When working with the\n\t * z-axis, the existing behavior of x and y properties changes from screen or\n\t * pixel coordinates to positions relative to the 3D parent container.</p>\n\t *\n\t * <p>For example, a child of the <code>_root</code> at position x = 100, y =\n\t * 100, z = 200 is not drawn at pixel location(100,100). The child is drawn\n\t * wherever the 3D projection calculation puts it. The calculation is:</p>\n\t *\n\t * <p><code>(x~~cameraFocalLength/cameraRelativeZPosition,\n\t * y~~cameraFocalLength/cameraRelativeZPosition)</code></p>\n\t */\n\tpublic get z():number\n\t{\n\t\treturn this._z;\n\t}\n\n\tpublic set z(val:number)\n\t{\n\t\tif (this._z == val)\n\t\t\treturn;\n\n\t\tthis._z = val;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get zOffset():number\n\t{\n\t\treturn this._zOffset;\n\t}\n\n\tpublic set zOffset(value:number)\n\t{\n\t\tthis._zOffset = value;\n\t}\n\n\t/**\n\t * Creates a new <code>DisplayObject</code> instance.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\t// Cached vector of transformation components used when\n\t\t// recomposing the transform matrix in updateTransform()\n\n\t\tthis._transformComponents = new Array<Vector3D>(3);//_transformComponents = new Vector.<Vector3D>(3, true);\n\n\t\tthis._transformComponents[0] = this._pos;\n\t\tthis._transformComponents[1] = this._rot;\n\t\tthis._transformComponents[2] = this._sca;\n\n\t\t//creation of associated transform object\n\t\tthis._transform = new Transform(this);\n\n\t\tthis._matrix3D.identity();\n\n\t\tthis._flipY.appendScale(1, -1, 1);\n\n\t\tthis._pBounds = this.pCreateDefaultBoundingVolume();\n\n\t\tthis._worldBounds = this.pCreateDefaultBoundingVolume();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic addEventListener(type:string, listener:Function)\n\t{\n\t\tsuper.addEventListener(type, listener);\n\n\t\tswitch (type) {\n\t\t\tcase DisplayObjectEvent.POSITION_CHANGED:\n\t\t\t\tthis._listenToPositionChanged = true;\n\t\t\t\tbreak;\n\t\t\tcase DisplayObjectEvent.ROTATION_CHANGED:\n\t\t\t\tthis._listenToRotationChanged = true;\n\t\t\t\tbreak;\n\t\t\tcase DisplayObjectEvent.SCALE_CHANGED:\n\t\t\t\tthis._listenToScaleChanged = true;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clone():DisplayObject\n\t{\n\t\tvar clone:DisplayObject = new DisplayObject();\n\t\tclone.pivot = this.pivot;\n\t\tclone._iMatrix3D = this._iMatrix3D;\n\t\tclone.name = name;\n\n\t\t// todo: implement for all subtypes\n\t\treturn clone;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tif (this.parent)\n\t\t\tthis.parent.removeChild(this);\n\n\t\twhile (this._pRenderables.length)\n\t\t\tthis._pRenderables[0].dispose();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic disposeAsset()\n\t{\n\t\tthis.dispose();\n\t}\n\n\t/**\n\t * Returns a rectangle that defines the area of the display object relative\n\t * to the coordinate system of the <code>targetCoordinateSpace</code> object.\n\t * Consider the following code, which shows how the rectangle returned can\n\t * vary depending on the <code>targetCoordinateSpace</code> parameter that\n\t * you pass to the method:\n\t *\n\t * <p><b>Note:</b> Use the <code>localToGlobal()</code> and\n\t * <code>globalToLocal()</code> methods to convert the display object's local\n\t * coordinates to display coordinates, or display coordinates to local\n\t * coordinates, respectively.</p>\n\t *\n\t * <p>The <code>getBounds()</code> method is similar to the\n\t * <code>getRect()</code> method; however, the Rectangle returned by the\n\t * <code>getBounds()</code> method includes any strokes on shapes, whereas\n\t * the Rectangle returned by the <code>getRect()</code> method does not. For\n\t * an example, see the description of the <code>getRect()</code> method.</p>\n\t *\n\t * @param targetCoordinateSpace The display object that defines the\n\t *                              coordinate system to use.\n\t * @return The rectangle that defines the area of the display object relative\n\t *         to the <code>targetCoordinateSpace</code> object's coordinate\n\t *         system.\n\t */\n\tpublic getBounds(targetCoordinateSpace:DisplayObject):Rectangle\n\t{\n\t\treturn this._bounds; //TODO\n\t}\n\n\t/**\n\t * Returns a rectangle that defines the boundary of the display object, based\n\t * on the coordinate system defined by the <code>targetCoordinateSpace</code>\n\t * parameter, excluding any strokes on shapes. The values that the\n\t * <code>getRect()</code> method returns are the same or smaller than those\n\t * returned by the <code>getBounds()</code> method.\n\t *\n\t * <p><b>Note:</b> Use <code>localToGlobal()</code> and\n\t * <code>globalToLocal()</code> methods to convert the display object's local\n\t * coordinates to Stage coordinates, or Stage coordinates to local\n\t * coordinates, respectively.</p>\n\t *\n\t * @param targetCoordinateSpace The display object that defines the\n\t *                              coordinate system to use.\n\t * @return The rectangle that defines the area of the display object relative\n\t *         to the <code>targetCoordinateSpace</code> object's coordinate\n\t *         system.\n\t */\n\tpublic getRect(targetCoordinateSpace:DisplayObject):Rectangle\n\t{\n\t\treturn this._bounds; //TODO\n\t}\n\n\t/**\n\t * Converts the <code>point</code> object from the Stage(global) coordinates\n\t * to the display object's(local) coordinates.\n\t *\n\t * <p>To use this method, first create an instance of the Point class. The\n\t * <i>x</i> and <i>y</i> values that you assign represent global coordinates\n\t * because they relate to the origin(0,0) of the main display area. Then\n\t * pass the Point instance as the parameter to the\n\t * <code>globalToLocal()</code> method. The method returns a new Point object\n\t * with <i>x</i> and <i>y</i> values that relate to the origin of the display\n\t * object instead of the origin of the Stage.</p>\n\t *\n\t * @param point An object created with the Point class. The Point object\n\t *              specifies the <i>x</i> and <i>y</i> coordinates as\n\t *              properties.\n\t * @return A Point object with coordinates relative to the display object.\n\t */\n\tpublic globalToLocal(point:Point):Point\n\t{\n\t\treturn point; //TODO\n\t}\n\n\t/**\n\t * Converts a two-dimensional point from the Stage(global) coordinates to a\n\t * three-dimensional display object's(local) coordinates.\n\t *\n\t * <p>To use this method, first create an instance of the Point class. The x\n\t * and y values that you assign to the Point object represent global\n\t * coordinates because they are relative to the origin(0,0) of the main\n\t * display area. Then pass the Point object to the\n\t * <code>globalToLocal3D()</code> method as the <code>point</code> parameter.\n\t * The method returns three-dimensional coordinates as a Vector3D object\n\t * containing <code>x</code>, <code>y</code>, and <code>z</code> values that\n\t * are relative to the origin of the three-dimensional display object.</p>\n\t *\n\t * @param point A two dimensional Point object representing global x and y\n\t *              coordinates.\n\t * @return A Vector3D object with coordinates relative to the\n\t *         three-dimensional display object.\n\t */\n\tpublic globalToLocal3D(point:Point):Vector3D\n\t{\n\t\treturn new Vector3D(); //TODO\n\t}\n\n\t/**\n\t * Evaluates the bounding box of the display object to see if it overlaps or\n\t * intersects with the bounding box of the <code>obj</code> display object.\n\t *\n\t * @param obj The display object to test against.\n\t * @return <code>true</code> if the bounding boxes of the display objects\n\t *         intersect; <code>false</code> if not.\n\t */\n\tpublic hitTestObject(obj:DisplayObject):boolean\n\t{\n\t\treturn false; //TODO\n\t}\n\n\t/**\n\t * Evaluates the display object to see if it overlaps or intersects with the\n\t * point specified by the <code>x</code> and <code>y</code> parameters. The\n\t * <code>x</code> and <code>y</code> parameters specify a point in the\n\t * coordinate space of the Stage, not the display object container that\n\t * contains the display object(unless that display object container is the\n\t * Stage).\n\t *\n\t * @param x         The <i>x</i> coordinate to test against this object.\n\t * @param y         The <i>y</i> coordinate to test against this object.\n\t * @param shapeFlag Whether to check against the actual pixels of the object\n\t *                 (<code>true</code>) or the bounding box\n\t *                 (<code>false</code>).\n\t * @return <code>true</code> if the display object overlaps or intersects\n\t *         with the specified point; <code>false</code> otherwise.\n\t */\n\tpublic hitTestPoint(x:number, y:number, shapeFlag:boolean = false):boolean\n\t{\n\t\treturn false; //TODO\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic isIntersectingRay(rayPosition:Vector3D, rayDirection:Vector3D):boolean\n\t{\n\t\tvar localRayPosition:Vector3D = this.inverseSceneTransform.transformVector(rayPosition);\n\t\tvar localRayDirection:Vector3D = this.inverseSceneTransform.deltaTransformVector(rayDirection);\n\t\tvar pickingCollisionVO:PickingCollisionVO = this._iPickingCollisionVO;\n\n\t\tif (!pickingCollisionVO.localNormal)\n\t\t\tpickingCollisionVO.localNormal = new Vector3D();\n\n\t\tvar rayEntryDistance:number = this.bounds.rayIntersection(localRayPosition, localRayDirection, pickingCollisionVO.localNormal);\n\n\t\tif (rayEntryDistance < 0)\n\t\t\treturn false;\n\n\t\tpickingCollisionVO.rayEntryDistance = rayEntryDistance;\n\t\tpickingCollisionVO.localRayPosition = localRayPosition;\n\t\tpickingCollisionVO.localRayDirection = localRayDirection;\n\t\tpickingCollisionVO.rayPosition = rayPosition;\n\t\tpickingCollisionVO.rayDirection = rayDirection;\n\t\tpickingCollisionVO.rayOriginIsInsideBounds = rayEntryDistance == 0;\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Converts a three-dimensional point of the three-dimensional display\n\t * object's(local) coordinates to a two-dimensional point in the Stage\n\t * (global) coordinates.\n\t *\n\t * <p>For example, you can only use two-dimensional coordinates(x,y) to draw\n\t * with the <code>display.Graphics</code> methods. To draw a\n\t * three-dimensional object, you need to map the three-dimensional\n\t * coordinates of a display object to two-dimensional coordinates. First,\n\t * create an instance of the Vector3D class that holds the x-, y-, and z-\n\t * coordinates of the three-dimensional display object. Then pass the\n\t * Vector3D object to the <code>local3DToGlobal()</code> method as the\n\t * <code>point3d</code> parameter. The method returns a two-dimensional Point\n\t * object that can be used with the Graphics API to draw the\n\t * three-dimensional object.</p>\n\t *\n\t * @param point3d A Vector3D object containing either a three-dimensional\n\t *                point or the coordinates of the three-dimensional display\n\t *                object.\n\t * @return A two-dimensional point representing a three-dimensional point in\n\t *         two-dimensional space.\n\t */\n\tpublic local3DToGlobal(point3d:Vector3D):Point\n\t{\n\t\treturn new Point(); //TODO\n\t}\n\n\t/**\n\t * Rotates the 3d object around to face a point defined relative to the local coordinates of the parent <code>ObjectContainer3D</code>.\n\t *\n\t * @param    target        The vector defining the point to be looked at\n\t * @param    upAxis        An optional vector used to define the desired up orientation of the 3d object after rotation has occurred\n\t */\n\tpublic lookAt(target:Vector3D, upAxis:Vector3D = null)\n\t{\n\n\t\tvar yAxis:Vector3D;\n\t\tvar zAxis:Vector3D;\n\t\tvar xAxis:Vector3D;\n\t\tvar raw:Array<number>;\n\n\t\tif (upAxis == null)\n\t\t\tupAxis = Vector3D.Y_AXIS;\n\t\telse\n\t\t\tupAxis.normalize();\n\n\t\tzAxis = target.subtract(this._iMatrix3D.position);\n\t\tzAxis.normalize();\n\n\t\txAxis = upAxis.crossProduct(zAxis);\n\t\txAxis.normalize();\n\n\t\tif (xAxis.length < 0.05) {\n\t\t\txAxis.x = upAxis.y;\n\t\t\txAxis.y = upAxis.x;\n\t\t\txAxis.z = 0;\n\t\t\txAxis.normalize();\n\t\t}\n\n\t\tyAxis = zAxis.crossProduct(xAxis);\n\n\t\traw = Matrix3DUtils.RAW_DATA_CONTAINER;\n\n\t\traw[0] = xAxis.x;\n\t\traw[1] = xAxis.y;\n\t\traw[2] = xAxis.z;\n\t\traw[3] = 0;\n\n\t\traw[4] = yAxis.x;\n\t\traw[5] = yAxis.y;\n\t\traw[6] = yAxis.z;\n\t\traw[7] = 0;\n\n\t\traw[8] = zAxis.x;\n\t\traw[9] = zAxis.y;\n\t\traw[10] = zAxis.z;\n\t\traw[11] = 0;\n\n\t\tvar m:Matrix3D = new Matrix3D();\n\t\tm.copyRawDataFrom(raw);\n\n\t\tvar vec:Vector3D = m.decompose()[1];\n\n\t\tthis._rotationX = vec.x;\n\t\tthis._rotationY = vec.y;\n\t\tthis._rotationZ = vec.z;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * Converts the <code>point</code> object from the display object's(local)\n\t * coordinates to the Stage(global) coordinates.\n\t *\n\t * <p>This method allows you to convert any given <i>x</i> and <i>y</i>\n\t * coordinates from values that are relative to the origin(0,0) of a\n\t * specific display object(local coordinates) to values that are relative to\n\t * the origin of the Stage(global coordinates).</p>\n\t *\n\t * <p>To use this method, first create an instance of the Point class. The\n\t * <i>x</i> and <i>y</i> values that you assign represent local coordinates\n\t * because they relate to the origin of the display object.</p>\n\t *\n\t * <p>You then pass the Point instance that you created as the parameter to\n\t * the <code>localToGlobal()</code> method. The method returns a new Point\n\t * object with <i>x</i> and <i>y</i> values that relate to the origin of the\n\t * Stage instead of the origin of the display object.</p>\n\t *\n\t * @param point The name or identifier of a point created with the Point\n\t *              class, specifying the <i>x</i> and <i>y</i> coordinates as\n\t *              properties.\n\t * @return A Point object with coordinates relative to the Stage.\n\t */\n\tpublic localToGlobal(point:Point):Point\n\t{\n\t\treturn new Point(); //TODO\n\t}\n\n\t/**\n\t * Moves the 3d object directly to a point in space\n\t *\n\t * @param    dx        The amount of movement along the local x axis.\n\t * @param    dy        The amount of movement along the local y axis.\n\t * @param    dz        The amount of movement along the local z axis.\n\t */\n\n\tpublic moveTo(dx:number, dy:number, dz:number)\n\t{\n\t\tif (this._x == dx && this._y == dy && this._z == dz)\n\t\t\treturn;\n\n\t\tthis._x = dx;\n\t\tthis._y = dy;\n\t\tthis._z = dz;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t * Moves the local point around which the object rotates.\n\t *\n\t * @param    dx        The amount of movement along the local x axis.\n\t * @param    dy        The amount of movement along the local y axis.\n\t * @param    dz        The amount of movement along the local z axis.\n\t */\n\tpublic movePivot(dx:number, dy:number, dz:number)\n\t{\n\t\tif (this._pivot == null)\n\t\t\tthis._pivot = new Vector3D();\n\n\t\tthis._pivot.x += dx;\n\t\tthis._pivot.y += dy;\n\t\tthis._pivot.z += dz;\n\n\t\tthis.invalidatePivot();\n\t}\n\n\t/**\n\t * Rotates the 3d object around it's local x-axis\n\t *\n\t * @param    angle        The amount of rotation in degrees\n\t */\n\tpublic pitch(angle:number)\n\t{\n\t\tthis.rotate(Vector3D.X_AXIS, angle);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getRenderSceneTransform(camera:Camera):Matrix3D\n\t{\n\t\tif (this.orientationMode == OrientationMode.CAMERA_PLANE) {\n\t\t\tvar comps:Array<Vector3D> = camera.sceneTransform.decompose();\n\t\t\tvar scale:Vector3D = comps[2];\n\t\t\tcomps[0] = this.scenePosition;\n\t\t\tscale.x = this._pScaleX;\n\t\t\tscale.y = this._pScaleY;\n\t\t\tscale.z = this._pScaleZ;\n\t\t\tthis._orientationMatrix.recompose(comps);\n\n\t\t\t//add in case of pivot\n\t\t\tif (!this._pivotZero && this.alignmentMode == AlignmentMode.PIVOT_POINT)\n\t\t\t\tthis._orientationMatrix.prependTranslation(-this._pivot.x/this._pScaleX, -this._pivot.y/this._pScaleY, -this._pivot.z/this._pScaleZ);\n\n\t\t\treturn this._orientationMatrix;\n\t\t}\n\n\t\treturn this.sceneTransform;\n\t}\n\n\t/**\n\t * Rotates the 3d object around it's local z-axis\n\t *\n\t * @param    angle        The amount of rotation in degrees\n\t */\n\tpublic roll(angle:number)\n\t{\n\t\tthis.rotate(Vector3D.Z_AXIS, angle);\n\t}\n\n\t/**\n\t * Rotates the 3d object around an axis by a defined angle\n\t *\n\t * @param    axis        The vector defining the axis of rotation\n\t * @param    angle        The amount of rotation in degrees\n\t */\n\tpublic rotate(axis:Vector3D, angle:number)\n\t{\n\t\tvar m:Matrix3D = new Matrix3D();\n\t\tm.prependRotation(angle, axis);\n\n\t\tvar vec:Vector3D = m.decompose()[1];\n\n\t\tthis._rotationX += vec.x;\n\t\tthis._rotationY += vec.y;\n\t\tthis._rotationZ += vec.z;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t * Rotates the 3d object directly to a euler angle\n\t *\n\t * @param    ax        The angle in degrees of the rotation around the x axis.\n\t * @param    ay        The angle in degrees of the rotation around the y axis.\n\t * @param    az        The angle in degrees of the rotation around the z axis.\n\t */\n\tpublic rotateTo(ax:number, ay:number, az:number)\n\t{\n\t\tthis._rotationX = ax*MathConsts.DEGREES_TO_RADIANS;\n\t\tthis._rotationY = ay*MathConsts.DEGREES_TO_RADIANS;\n\t\tthis._rotationZ = az*MathConsts.DEGREES_TO_RADIANS;\n\n\t\tthis.invalidateRotation();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic removeEventListener(type:string, listener:Function)\n\t{\n\t\tsuper.removeEventListener(type, listener);\n\n\t\tif (this.hasEventListener(type, listener))\n\t\t\treturn;\n\n\t\tswitch (type) {\n\t\t\tcase DisplayObjectEvent.POSITION_CHANGED:\n\t\t\t\tthis._listenToPositionChanged = false;\n\t\t\t\tbreak;\n\n\t\t\tcase DisplayObjectEvent.ROTATION_CHANGED:\n\t\t\t\tthis._listenToRotationChanged = false;\n\t\t\t\tbreak;\n\n\t\t\tcase DisplayObjectEvent.SCALE_CHANGED:\n\t\t\t\tthis._listenToScaleChanged = false;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Moves the 3d object along a vector by a defined length\n\t *\n\t * @param    axis        The vector defining the axis of movement\n\t * @param    distance    The length of the movement\n\t */\n\tpublic translate(axis:Vector3D, distance:number)\n\t{\n\t\tvar x:number = axis.x, y:number = axis.y, z:number = axis.z;\n\t\tvar len:number = distance/Math.sqrt(x*x + y*y + z*z);\n\n\t\tthis._x += x*len;\n\t\tthis._y += y*len;\n\t\tthis._z += z*len;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t * Moves the 3d object along a vector by a defined length\n\t *\n\t * @param    axis        The vector defining the axis of movement\n\t * @param    distance    The length of the movement\n\t */\n\tpublic translateLocal(axis:Vector3D, distance:number)\n\t{\n\t\tvar x:number = axis.x, y:number = axis.y, z:number = axis.z;\n\t\tvar len:number = distance/Math.sqrt(x*x + y*y + z*z);\n\n\t\tthis._iMatrix3D.prependTranslation(x*len, y*len, z*len);\n\n\t\tthis._matrix3D.copyColumnTo(3, this._pos);\n\n\t\tthis._x = this._pos.x;\n\t\tthis._y = this._pos.y;\n\t\tthis._z = this._pos.z;\n\n\t\tthis.invalidatePosition();\n\t}\n\n\t/**\n\t * Rotates the 3d object around it's local y-axis\n\t *\n\t * @param    angle        The amount of rotation in degrees\n\t */\n\tpublic yaw(angle:number)\n\t{\n\t\tthis.rotate(Vector3D.Y_AXIS, angle);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic _iController:ControllerBase;\n\n\t/**\n\t * @internal\n\t */\n\tpublic get _iAssignedPartition():Partition\n\t{\n\t\treturn this._pImplicitPartition;\n\t}\n\n\t/**\n\t * The transformation of the 3d object, relative to the local coordinates of the parent <code>ObjectContainer3D</code>.\n\t *\n\t * @internal\n\t */\n\tpublic get _iMatrix3D():Matrix3D\n\t{\n\t\tif (this._matrix3DDirty)\n\t\t\tthis._pUpdateMatrix3D();\n\n\t\treturn this._matrix3D;\n\t}\n\n\tpublic set _iMatrix3D(val:Matrix3D)\n\t{\n\n\t\t// TODO: From AS3 - Do we still need this in JS ?\n\t\t//ridiculous matrix error\n\t\t/*\n\t\tif (!val.rawData[0]) {\n\n\t\t\tvar raw:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\t\tval.copyRawDataTo(raw);\n\t\t\traw[0] = this._smallestNumber;\n\t\t\tval.copyRawDataFrom(raw);\n\t\t}\n\t\t//*/\n\t\tvar elements:Array<Vector3D> = val.decompose();\n\t\tvar vec:Vector3D;\n\n\t\tvec = elements[0];\n\n\t\tif (this._x != vec.x || this._y != vec.y || this._z != vec.z) {\n\t\t\tthis._x = vec.x;\n\t\t\tthis._y = vec.y;\n\t\t\tthis._z = vec.z;\n\n\t\t\tthis.invalidatePosition();\n\t\t}\n\n\t\tvec = elements[1];\n\n\t\tif (this._rotationX != vec.x || this._rotationY != vec.y || this._rotationZ != vec.z) {\n\t\t\tthis._rotationX = vec.x;\n\t\t\tthis._rotationY = vec.y;\n\t\t\tthis._rotationZ = vec.z;\n\n\t\t\tthis.invalidateRotation();\n\t\t}\n\n\t\tvec = elements[2];\n\n\t\tif (this._pScaleX != vec.x || this._pScaleY != vec.y || this._pScaleZ != vec.z) {\n\t\t\tthis._pScaleX = vec.x;\n\t\t\tthis._pScaleY = vec.y;\n\t\t\tthis._pScaleZ = vec.z;\n\n\t\t\tthis.invalidateScale();\n\t\t}\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic get _iPickingCollisionVO():PickingCollisionVO\n\t{\n\t\tif (!this._pPickingCollisionVO)\n\t\t\tthis._pPickingCollisionVO = new PickingCollisionVO(this);\n\n\t\treturn this._pPickingCollisionVO;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic iSetParent(value:DisplayObjectContainer)\n\t{\n\t\tthis._pParent = value;\n\n\t\tif (value) {\n\t\t\tthis._pUpdateImplicitMouseEnabled(value.mouseChildren);\n\t\t\tthis._pUpdateImplicitVisibility(value._iIsVisible());\n\t\t\tthis._pUpdateImplicitPartition(value._iAssignedPartition);\n\t\t\tthis._iSetScene(value._pScene);\n\t\t} else {\n\t\t\tthis._pUpdateImplicitMouseEnabled(true);\n\t\t\tthis._pUpdateImplicitVisibility(true);\n\t\t\tthis._pUpdateImplicitPartition(null);\n\n\t\t\tthis._iSetScene(null);\n\t\t}\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateDefaultBoundingVolume():BoundingVolumeBase\n\t{\n\t\t// point lights should be using sphere bounds\n\t\t// directional lights should be using null bounds\n\t\treturn new AxisAlignedBoundingBox();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateBounds()\n\t{\n\t\tthis._pBoundsInvalid = true;\n\t\tthis._worldBoundsInvalid = true;\n\n\n\t\tif (this.isEntity)\n\t\t\tthis.invalidatePartition();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateSceneTransform()\n\t{\n\t\tthis._pSceneTransformDirty = !this._pIgnoreTransform;\n\t\tthis._inverseSceneTransformDirty = !this._pIgnoreTransform;\n\t\tthis._scenePositionDirty = !this._pIgnoreTransform;\n\n\t\tthis._worldBoundsInvalid = !this._pIgnoreTransform;\n\n\t\tif (this.isEntity)\n\t\t\tthis.invalidatePartition();\n\n\t\tif (this._listenToSceneTransformChanged)\n\t\t\tthis.notifySceneTransformChange();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pUpdateBounds()\n\t{\n\t\tthis._width = this._pBounds.aabb.width*this._pScaleX;\n\t\tthis._height = this._pBounds.aabb.height*this._pScaleY;\n\t\tthis._depth = this._pBounds.aabb.depth*this._pScaleZ;\n\n\t\tthis._pBoundsInvalid = false;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitMouseEnabled(value:boolean)\n\t{\n\t\tthis._pImplicitMouseEnabled = this._explicitMouseEnabled && value;\n\n\t\t// If there is a parent and this child does not have a picking collider, use its parent's picking collider.\n\t\tif (this._pImplicitMouseEnabled && this._pParent && !this._pPickingCollider)\n\t\t\tthis._pPickingCollider =  this._pParent._pPickingCollider;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitPartition(value:Partition)\n\t{\n\t\t// assign parent implicit partition if no explicit one is given\n\t\tthis._pImplicitPartition = this._explicitPartition || value;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitVisibility(value:boolean)\n\t{\n\t\tthis._pImplicitVisibility = this._explicitVisibility && value;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateMatrix3D()\n\t{\n\n\t\tthis._pos.x = this._x;\n\t\tthis._pos.y = this._y;\n\t\tthis._pos.z = this._z;\n\n\t\tthis._rot.x = this._rotationX;\n\t\tthis._rot.y = this._rotationY;\n\t\tthis._rot.z = this._rotationZ;\n\n\t\tthis._sca.x = this._pScaleX;\n\t\tthis._sca.y = this._pScaleY;\n\t\tthis._sca.z = this._pScaleZ;\n\n\t\tthis._matrix3D.recompose(this._transformComponents);\n\n\t\tif (!this._pivotZero) {\n\t\t\tthis._matrix3D.prependTranslation(-this._pivot.x/this._pScaleX, -this._pivot.y/this._pScaleY, -this._pivot.z/this._pScaleZ);\n\t\t\tif (this.alignmentMode != AlignmentMode.PIVOT_POINT)\n\t\t\t\tthis._matrix3D.appendTranslation(this._pivot.x, this._pivot.y, this._pivot.z);\n\t\t}\n\n\t\tthis._matrix3DDirty = false;\n\t\tthis._positionDirty = false;\n\t\tthis._rotationDirty = false;\n\t\tthis._scaleDirty = false;\n\t\tthis._pivotDirty = false;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pUpdateSceneTransform()\n\t{\n\t\tif (this._pParent && !this._pParent._iIsRoot) {\n\t\t\tthis._pSceneTransform.copyFrom(this._pParent.sceneTransform);\n\t\t\tthis._pSceneTransform.prepend(this._iMatrix3D);\n\t\t} else {\n\t\t\tthis._pSceneTransform.copyFrom(this._iMatrix3D);\n\t\t}\n\n\t\tthis._pSceneTransformDirty = false;\n\t}\n\n\tpublic _iAddRenderable(renderable:IRenderable):IRenderable\n\t{\n\t\tthis._pRenderables.push(renderable);\n\n\t\treturn renderable;\n\t}\n\n\n\tpublic _iRemoveRenderable(renderable:IRenderable):IRenderable\n\t{\n\t\tvar index:number = this._pRenderables.indexOf(renderable);\n\n\t\tthis._pRenderables.splice(index, 1);\n\n\t\treturn renderable;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param shortestCollisionDistance\n\t * @param findClosest\n\t * @returns {boolean}\n\t *\n\t * @internal\n\t */\n\tpublic _iTestCollision(shortestCollisionDistance:number, findClosest:boolean):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic _iInternalUpdate()\n\t{\n\t\tif (this._iController)\n\t\t\tthis._iController.update();\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic _iIsVisible():boolean\n\t{\n\t\treturn this._pImplicitVisibility;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic _iIsMouseEnabled():boolean\n\t{\n\t\treturn this._pImplicitMouseEnabled;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic _iSetScene(value:Scene)\n\t{\n\t\t// test to see if we're switching roots while we're already using a scene partition\n\t\t/*\n\t\tif (value == null)\n\t\t\tthis._oldScene = this._pScene;\n\n\t\tif (this._explicitPartition && this._oldScene && this._oldScene != this._pScene)\n\t\t\tthis.partition = null;\n\n\t\tif (value)\n\t\t\tthis._oldScene = null;\n\n\t\t// end of stupid partition test code\n\t\t//*/\n\n\t\tif (this._pScene == value)\n\t\t\treturn;\n\n\t\tthis._pUpdateScene(value);\n\n\t\tif (!this._pSceneTransformDirty && !this._pIgnoreTransform)\n\t\t\tthis.pInvalidateSceneTransform();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateScene(value:Scene)\n\t{\n\t\tif (this._pScene) {\n\t\t\tthis._pScene.dispatchEvent(new SceneEvent(SceneEvent.REMOVED_FROM_SCENE, this));\n\n\t\t\t//unregister entity from current scene\n\t\t\tthis._pScene.iUnregisterEntity(this);\n\t\t}\n\n\t\tthis._pScene = value;\n\n\t\tif (value) {\n\t\t\tvalue.dispatchEvent(new SceneEvent(SceneEvent.ADDED_TO_SCENE, this));\n\n\t\t\t//register entity with new scene\n\t\t\tvalue.iRegisterEntity(this);\n\t\t}\n\n\t\tthis.notifySceneChange();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyPositionChanged()\n\t{\n\t\tif (!this._positionChanged)\n\t\t\tthis._positionChanged = new DisplayObjectEvent(DisplayObjectEvent.POSITION_CHANGED, this);\n\n\t\tthis.dispatchEvent(this._positionChanged);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyRotationChanged()\n\t{\n\t\tif (!this._rotationChanged)\n\t\t\tthis._rotationChanged = new DisplayObjectEvent(DisplayObjectEvent.ROTATION_CHANGED, this);\n\n\t\tthis.dispatchEvent(this._rotationChanged);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyScaleChanged()\n\t{\n\t\tif (!this._scaleChanged)\n\t\t\tthis._scaleChanged = new DisplayObjectEvent(DisplayObjectEvent.SCALE_CHANGED, this);\n\n\t\tthis.dispatchEvent(this._scaleChanged);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate notifySceneChange()\n\t{\n\t\tif (this._listenToSceneChanged) {\n\t\t\tif (!this._scenechanged)\n\t\t\t\tthis._scenechanged = new DisplayObjectEvent(DisplayObjectEvent.SCENE_CHANGED, this);\n\n\t\t\tthis.dispatchEvent(this._scenechanged);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate notifySceneTransformChange()\n\t{\n\t\tif (!this._sceneTransformChanged)\n\t\t\tthis._sceneTransformChanged = new DisplayObjectEvent(DisplayObjectEvent.SCENETRANSFORM_CHANGED, this);\n\n\t\tthis.dispatchEvent(this._sceneTransformChanged);\n\t}\n\n\t/**\n\t * Invalidates the 3D transformation matrix, causing it to be updated upon the next request\n\t *\n\t * @private\n\t */\n\tprivate invalidateMatrix3D():void\n\t{\n\t\tif (this._matrix3DDirty)\n\t\t\treturn;\n\n\t\tthis._matrix3DDirty = true;\n\n\t\tif (!this._pSceneTransformDirty && !this._pIgnoreTransform)\n\t\t\tthis.pInvalidateSceneTransform();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidatePartition()\n\t{\n\t\tif (this._iAssignedPartition)\n\t\t\tthis._iAssignedPartition.iMarkForUpdate(this);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidatePivot()\n\t{\n\t\tthis._pivotZero = (this._pivot.x == 0) && (this._pivot.y == 0) && (this._pivot.z == 0);\n\n\t\tif (this._pivotDirty)\n\t\t\treturn;\n\n\t\tthis._pivotDirty = true;\n\n\t\tthis.invalidateMatrix3D();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidatePosition()\n\t{\n\t\tif (this._positionDirty)\n\t\t\treturn;\n\n\t\tthis._positionDirty = true;\n\n\t\tthis.invalidateMatrix3D();\n\n\t\tif (this._listenToPositionChanged)\n\t\t\tthis.notifyPositionChanged();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidateRotation()\n\t{\n\t\tif (this._rotationDirty)\n\t\t\treturn;\n\n\t\tthis._rotationDirty = true;\n\n\t\tthis.invalidateMatrix3D();\n\n\t\tif (this._listenToRotationChanged)\n\t\t\tthis.notifyRotationChanged();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidateScale()\n\t{\n\t\tif (this._scaleDirty)\n\t\t\treturn;\n\n\t\tthis._scaleDirty = true;\n\n\t\tthis.invalidateMatrix3D();\n\n\t\tif (this._listenToScaleChanged)\n\t\t\tthis.notifyScaleChanged();\n\t}\n}\n\nexport = DisplayObject;",
    "import Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\n\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport GeometryEvent\t\t\t= require(\"awayjs-display/lib/events/GeometryEvent\");\n\n/**\n *\n * Geometry is a collection of SubGeometries, each of which contain the actual geometrical data such as vertices,\n * normals, uvs, etc. It also contains a reference to an animation class, which defines how the geometry moves.\n * A Geometry object is assigned to a Mesh, a scene graph occurence of the geometry, which in turn assigns\n * the SubGeometries to its respective TriangleSubMesh objects.\n *\n *\n *\n * @see away.core.base.SubGeometry\n * @see away.entities.Mesh\n *\n * @class Geometry\n */\nclass Geometry extends NamedAssetBase implements IAsset\n{\n\tprivate _subGeometries:Array<SubGeometryBase>;\n\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.GEOMETRY;\n\t}\n\n\t/**\n\t * A collection of TriangleSubGeometry objects, each of which contain geometrical data such as vertices, normals, etc.\n\t */\n\tpublic get subGeometries():Array<SubGeometryBase>\n\t{\n\t\treturn this._subGeometries;\n\t}\n\n\tpublic getSubGeometries():Array<SubGeometryBase>\n\t{\n\t\treturn this._subGeometries;\n\t}\n\n\t/**\n\t * Creates a new Geometry object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._subGeometries = new Array<SubGeometryBase>();\n\t}\n\n\tpublic applyTransformation(transform:Matrix3D)\n\t{\n\t\tvar len:number = this._subGeometries.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._subGeometries[i].applyTransformation(transform);\n\t}\n\n\t/**\n\t * Adds a new TriangleSubGeometry object to the list.\n\t * @param subGeometry The TriangleSubGeometry object to be added.\n\t */\n\tpublic addSubGeometry(subGeometry:SubGeometryBase)\n\t{\n\t\tthis._subGeometries.push(subGeometry);\n\n\t\tsubGeometry.parentGeometry = this;\n\n\t\tif (this.hasEventListener(GeometryEvent.SUB_GEOMETRY_ADDED))\n\t\t\tthis.dispatchEvent(new GeometryEvent(GeometryEvent.SUB_GEOMETRY_ADDED, subGeometry));\n\n\t\tthis.iInvalidateBounds(subGeometry);\n\t}\n\n\t/**\n\t * Removes a new TriangleSubGeometry object from the list.\n\t * @param subGeometry The TriangleSubGeometry object to be removed.\n\t */\n\tpublic removeSubGeometry(subGeometry:SubGeometryBase)\n\t{\n\t\tthis._subGeometries.splice(this._subGeometries.indexOf(subGeometry), 1);\n\n\t\tsubGeometry.parentGeometry = null;\n\n\t\tif (this.hasEventListener(GeometryEvent.SUB_GEOMETRY_REMOVED))\n\t\t\tthis.dispatchEvent(new GeometryEvent(GeometryEvent.SUB_GEOMETRY_REMOVED, subGeometry));\n\n\t\tthis.iInvalidateBounds(subGeometry);\n\t}\n\n\t/**\n\t * Clones the geometry.\n\t * @return An exact duplicate of the current Geometry object.\n\t */\n\tpublic clone():Geometry\n\t{\n\t\tvar clone:Geometry = new Geometry();\n\t\tvar len:number = this._subGeometries.length;\n\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tclone.addSubGeometry(this._subGeometries[i].clone());\n\n\t\treturn clone;\n\t}\n\n\t/**\n\t * Scales the geometry.\n\t * @param scale The amount by which to scale.\n\t */\n\tpublic scale(scale:number)\n\t{\n\t\tvar numSubGeoms:number = this._subGeometries.length;\n\t\tfor (var i:number = 0; i < numSubGeoms; ++i)\n\t\t\tthis._subGeometries[i].scale(scale);\n\t}\n\n\t/**\n\t * Clears all resources used by the Geometry object, including SubGeometries.\n\t */\n\tpublic dispose()\n\t{\n\t\tvar numSubGeoms:number = this._subGeometries.length;\n\n\t\tfor (var i:number = 0; i < numSubGeoms; ++i) {\n\t\t\tvar subGeom:SubGeometryBase = this._subGeometries[0];\n\t\t\tthis.removeSubGeometry(subGeom);\n\t\t\tsubGeom.dispose();\n\t\t}\n\t}\n\n\t/**\n\t * Scales the uv coordinates (tiling)\n\t * @param scaleU The amount by which to scale on the u axis. Default is 1;\n\t * @param scaleV The amount by which to scale on the v axis. Default is 1;\n\t */\n\tpublic scaleUV(scaleU:number = 1, scaleV:number = 1)\n\t{\n\t\tvar numSubGeoms:number = this._subGeometries.length;\n\n\t\tfor (var i:number = 0; i < numSubGeoms; ++i)\n\t\t\tthis._subGeometries[i].scaleUV(scaleU, scaleV);\n\t}\n\n\tpublic iInvalidateBounds(subGeom:SubGeometryBase)\n\t{\n\t\tif (this.hasEventListener(GeometryEvent.BOUNDS_INVALID))\n\t\t\tthis.dispatchEvent(new GeometryEvent(GeometryEvent.BOUNDS_INVALID, subGeom));\n\t}\n}\n\nexport = Geometry;",
    "import AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Camera\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport LightEvent\t\t\t\t= require(\"awayjs-display/lib/events/LightEvent\");\nimport ShadowMapperBase\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\nclass LightBase extends DisplayObjectContainer\n{\n\tprivate _color:number = 0xffffff;\n\tprivate _colorR:number = 1;\n\tprivate _colorG:number = 1;\n\tprivate _colorB:number = 1;\n\n\tprivate _ambientColor:number = 0xffffff;\n\tprivate _ambient:number = 0;\n\tpublic _iAmbientR:number = 0;\n\tpublic _iAmbientG:number = 0;\n\tpublic _iAmbientB:number = 0;\n\n\tprivate _specular:number = 1;\n\tpublic _iSpecularR:number = 1;\n\tpublic _iSpecularG:number = 1;\n\tpublic _iSpecularB:number = 1;\n\n\tprivate _diffuse:number = 1;\n\tpublic _iDiffuseR:number = 1;\n\tpublic _iDiffuseG:number = 1;\n\tpublic _iDiffuseB:number = 1;\n\n\tprivate _castsShadows:boolean = false;\n\n\tprivate _shadowMapper:ShadowMapperBase;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic get castsShadows():boolean\n\t{\n\t\treturn this._castsShadows;\n\t}\n\n\tpublic set castsShadows(value:boolean)\n\t{\n\t\tif (this._castsShadows == value)\n\t\t\treturn;\n\n\t\tthis._castsShadows = value;\n\n\t\tif (value) {\n\t\t\tif (this._shadowMapper == null)\n\t\t\t\tthis._shadowMapper = this.pCreateShadowMapper();\n\n\t\t\tthis._shadowMapper.light = this;\n\t\t} else {\n\t\t\tthis._shadowMapper.dispose();\n\t\t\tthis._shadowMapper = null;\n\t\t}\n\t\t//*/\n\t\tthis.dispatchEvent(new LightEvent(LightEvent.CASTS_SHADOW_CHANGE));\n\t}\n\n\tpublic pCreateShadowMapper():ShadowMapperBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic get specular():number\n\t{\n\t\treturn this._specular;\n\t}\n\n\tpublic set specular(value:number)\n\t{\n\t\tif (value < 0)\n\t\t\tvalue = 0;\n\n\t\tthis._specular = value;\n\t\tthis.updateSpecular();\n\t}\n\n\tpublic get diffuse():number\n\t{\n\t\treturn this._diffuse;\n\t}\n\n\tpublic set diffuse(value:number)\n\t{\n\t\tif (value < 0)\n\t\t\tvalue = 0;\n\n\t\tthis._diffuse = value;\n\t\tthis.updateDiffuse();\n\t}\n\n\tpublic get color():number\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic set color(value:number)\n\t{\n\t\tthis._color = value;\n\t\tthis._colorR = ((this._color >> 16) & 0xff)/0xff;\n\t\tthis._colorG = ((this._color >> 8) & 0xff)/0xff;\n\t\tthis._colorB = (this._color & 0xff)/0xff;\n\n\t\tthis.updateDiffuse();\n\t\tthis.updateSpecular();\n\t}\n\n\tpublic get ambient():number\n\t{\n\t\treturn this._ambient;\n\t}\n\n\tpublic set ambient(value:number)\n\t{\n\t\tif (value < 0)\n\t\t\tvalue = 0;\n\t\telse if (value > 1)\n\t\t\tvalue = 1;\n\n\t\tthis._ambient = value;\n\t\tthis.updateAmbient();\n\t}\n\n\tpublic get ambientColor():number\n\t{\n\t\treturn this._ambientColor;\n\t}\n\n\tpublic set ambientColor(value:number)\n\t{\n\t\tthis._ambientColor = value;\n\t\tthis.updateAmbient();\n\t}\n\n\tprivate updateAmbient()\n\t{\n\t\tthis._iAmbientR = ((this._ambientColor >> 16) & 0xff)/0xff*this._ambient;\n\t\tthis._iAmbientG = ((this._ambientColor >> 8) & 0xff)/0xff*this._ambient;\n\t\tthis._iAmbientB = (this._ambientColor & 0xff)/0xff*this._ambient;\n\t}\n\n\tpublic iGetObjectProjectionMatrix(entity:IEntity, camera:Camera, target:Matrix3D = null):Matrix3D\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t//@override\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.LIGHT;\n\t}\n\n\tprivate updateSpecular()\n\t{\n\t\tthis._iSpecularR = this._colorR*this._specular;\n\t\tthis._iSpecularG = this._colorG*this._specular;\n\t\tthis._iSpecularB = this._colorB*this._specular;\n\t}\n\n\tprivate updateDiffuse()\n\t{\n\t\tthis._iDiffuseR = this._colorR*this._diffuse;\n\t\tthis._iDiffuseG = this._colorG*this._diffuse;\n\t\tthis._iDiffuseB = this._colorB*this._diffuse;\n\t}\n\n\tpublic get shadowMapper():ShadowMapperBase\n\t{\n\t\treturn this._shadowMapper;\n\t}\n\n\tpublic set shadowMapper(value:ShadowMapperBase)\n\t{\n\t\tthis._shadowMapper = value;\n\t\tthis._shadowMapper.light = this;\n\t}\n}\n\nexport = LightBase;",
    "import DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Geometry\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport LineSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport SubGeometryEvent\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\n/**\n * @class LineSubGeometry\n */\nclass LineSubGeometry extends SubGeometryBase\n{\n\tpublic static VERTEX_DATA:string = \"vertices\";\n\tpublic static START_POSITION_DATA:string = \"startPositions\";\n\tpublic static END_POSITION_DATA:string = \"endPositions\";\n\tpublic static THICKNESS_DATA:string = \"thickness\";\n\tpublic static COLOR_DATA:string = \"colors\";\n\n\t//TODO - move these to StageGL\n\tpublic static POSITION_FORMAT:string = \"float3\";\n\tpublic static COLOR_FORMAT:string = \"float4\";\n\tpublic static THICKNESS_FORMAT:string = \"float1\";\n\n\tprivate _positionsDirty:boolean = true;\n\tprivate _boundingPositionDirty = true;\n\tprivate _thicknessDirty:boolean = true;\n\tprivate _colorsDirty:boolean = true;\n\n\tprivate _startPositions:Array<number>;\n\tprivate _endPositions:Array<number>;\n\tprivate _boundingPositions:Array<number>\n\tprivate _thickness:Array<number>;\n\tprivate _startColors:Array<number>;\n\tprivate _endColors:Array<number>;\n\n\tprivate _numSegments:number;\n\n\tprivate _positionsUpdated:SubGeometryEvent;\n\tprivate _thicknessUpdated:SubGeometryEvent;\n\tprivate _colorUpdated:SubGeometryEvent;\n\n\tpublic _pUpdateStrideOffset()\n\t{\n\t\tthis._pOffset[LineSubGeometry.VERTEX_DATA] = 0;\n\n\t\tvar stride:number = 0;\n\t\tthis._pOffset[LineSubGeometry.START_POSITION_DATA] = stride;\n\t\tstride += 3;\n\n\t\tthis._pOffset[LineSubGeometry.END_POSITION_DATA] = stride;\n\t\tstride += 3;\n\n\t\tthis._pOffset[LineSubGeometry.THICKNESS_DATA] = stride;\n\t\tstride += 1;\n\n\t\tthis._pOffset[LineSubGeometry.COLOR_DATA] = stride;\n\t\tstride += 4;\n\n\t\tthis._pStride[LineSubGeometry.VERTEX_DATA] = stride;\n\t\tthis._pStride[LineSubGeometry.START_POSITION_DATA] = stride;\n\t\tthis._pStride[LineSubGeometry.END_POSITION_DATA] = stride;\n\t\tthis._pStride[LineSubGeometry.THICKNESS_DATA] = stride;\n\t\tthis._pStride[LineSubGeometry.COLOR_DATA] = stride;\n\n\t\tvar len:number = this._pNumVertices*stride;\n\n\t\tif (this._pVertices == null)\n\t\t\tthis._pVertices = new Array<number>(len);\n\t\telse if (this._pVertices.length != len)\n\t\t\tthis._pVertices.length = len;\n\n\t\tthis._pStrideOffsetDirty = false;\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic get vertices():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._startPositions, this._endPositions);\n\n\t\tif (this._thicknessDirty)\n\t\t\tthis.updateThickness(this._thickness);\n\n\t\tif (this._colorsDirty)\n\t\t\tthis.updateColors(this._startColors, this._endColors);\n\n\t\treturn this._pVertices;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get startPositions():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._startPositions, this._endPositions);\n\n\t\treturn this._startPositions;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get endPositions():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._startPositions, this._endPositions);\n\n\t\treturn this._endPositions;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get thickness():Array<number>\n\t{\n\t\tif (this._thicknessDirty)\n\t\t\tthis.updateThickness(this._thickness);\n\n\t\treturn this._thickness;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get startColors():Array<number>\n\t{\n\t\tif (this._colorsDirty)\n\t\t\tthis.updateColors(this._startColors, this._endColors);\n\n\t\treturn this._startColors;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get endColors():Array<number>\n\t{\n\t\tif (this._colorsDirty)\n\t\t\tthis.updateColors(this._startColors, this._endColors);\n\n\t\treturn this._endColors;\n\t}\n\n\t/**\n\t * The total amount of segments in the TriangleSubGeometry.\n\t */\n\tpublic get numSegments():number\n\t{\n\t\treturn this._numSegments;\n\t}\n\n\t/**\n\t *\n\t */\n\tconstructor()\n\t{\n\t\tsuper(true);\n\n\t\tthis._pSubMeshClass = LineSubMesh;\n\t}\n\n\tpublic getBoundingPositions():Array<number>\n\t{\n\t\tif (this._boundingPositionDirty)\n\t\t\tthis._boundingPositions = this.startPositions.concat(this.endPositions);\n\n\t\treturn this._boundingPositions;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updatePositions(startValues:Array<number>, endValues:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar values:Array<number>\n\t\tvar index:number;\n\t\tvar stride:number;\n\t\tvar positions:Array<number>;\n\t\tvar indices:Array<number>;\n\n\t\tthis._startPositions = startValues;\n\n\t\tif (this._startPositions == null)\n\t\t\tthis._startPositions = new Array<number>();\n\n\t\tthis._endPositions = endValues;\n\n\t\tif (this._endPositions == null)\n\t\t\tthis._endPositions = new Array<number>();\n\n\t\tthis._boundingPositionDirty = true;\n\n\t\tthis._numSegments = this._startPositions.length/3;\n\n\t\tthis._pNumVertices = this._numSegments*4;\n\n\t\tvar lenV:number = this._pNumVertices*this.getStride(LineSubGeometry.VERTEX_DATA);\n\n\t\tif (this._pVertices == null)\n\t\t\tthis._pVertices = new Array<number>(lenV);\n\t\telse if (this._pVertices.length != lenV)\n\t\t\tthis._pVertices.length = lenV;\n\n\t\ti = 0;\n\t\tj = 0;\n\t\tindex = this.getOffset(LineSubGeometry.START_POSITION_DATA);\n\t\tstride = this.getStride(LineSubGeometry.START_POSITION_DATA);\n\t\tpositions = this._pVertices;\n\t\tindices = new Array();\n\n\t\twhile (i < startValues.length) {\n\t\t\tvalues = (index/stride & 1)? endValues : startValues;\n\t\t\tpositions[index] = values[i];\n\t\t\tpositions[index + 1] = values[i + 1];\n\t\t\tpositions[index + 2] = values[i + 2];\n\n\t\t\tvalues = (index/stride & 1)? startValues : endValues;\n\t\t\tpositions[index + 3] = values[i];\n\t\t\tpositions[index + 4] = values[i + 1];\n\t\t\tpositions[index + 5] = values[i + 2];\n\n\t\t\tif (++j == 4) {\n\t\t\t\tvar o:number = index/stride - 3;\n\t\t\t\tindices.push(o, o + 1, o + 2, o + 3, o + 2, o + 1);\n\t\t\t\tj = 0;\n\t\t\t\ti += 3;\n\t\t\t}\n\n\t\t\tindex += stride;\n\t\t}\n\n\t\tthis.updateIndices(indices);\n\n\t\tthis.pInvalidateBounds();\n\n\t\tthis.notifyPositionsUpdate();\n\n\t\tthis._positionsDirty = false;\n\t}\n\n\t/**\n\t * Updates the thickness.\n\t */\n\tpublic updateThickness(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar thickness:Array<number>;\n\n\t\tthis._thickness = values;\n\n\t\tif (values != null) {\n\t\t\ti = 0;\n\t\t\tj = 0;\n\t\t\toffset = this.getOffset(LineSubGeometry.THICKNESS_DATA);\n\t\t\tstride = this.getStride(LineSubGeometry.THICKNESS_DATA);\n\t\t\tthickness = this._pVertices;\n\n\t\t\tindex = offset\n\t\t\twhile (i < values.length) {\n\t\t\t\tthickness[index] = (Math.floor(0.5*(index - offset)/stride + 0.5) & 1)? -values[i] : values[i];\n\n\t\t\t\tif (++j == 4) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyThicknessUpdate();\n\n\t\tthis._thicknessDirty = false;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updateColors(startValues:Array<number>, endValues:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar values:Array<number>\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar colors:Array<number>;\n\n\t\tthis._startColors = startValues;\n\n\t\tthis._endColors = endValues;\n\n\t\t//default to white\n\t\tif (this._startColors == null) {\n\t\t\tthis._startColors = new Array(this._numSegments*4);\n\n\t\t\ti = 0;\n\t\t\twhile (i < this._startColors.length)\n\t\t\t\tthis._startColors[i++] = 1;\n\t\t}\n\n\t\tif (this._endColors == null) {\n\t\t\tthis._endColors = new Array(this._numSegments*4);\n\n\t\t\ti = 0;\n\t\t\twhile (i < this._endColors.length)\n\t\t\t\tthis._endColors[i++] = 1;\n\t\t}\n\n\t\ti = 0;\n\t\tj = 0;\n\t\toffset = this.getOffset(LineSubGeometry.COLOR_DATA);\n\t\tstride = this.getStride(LineSubGeometry.COLOR_DATA);\n\t\tcolors = this._pVertices;\n\n\t\tindex = offset;\n\n\t\twhile (i < this._startColors.length) {\n\t\t\tvalues = ((index - offset)/stride & 1)? this._endColors : this._startColors;\n\t\t\tcolors[index] = values[i];\n\t\t\tcolors[index + 1] = values[i + 1];\n\t\t\tcolors[index + 2] = values[i + 2];\n\t\t\tcolors[index + 3] = values[i + 3];\n\n\t\t\tif (++j == 4) {\n\t\t\t\tj = 0;\n\t\t\t\ti += 4;\n\t\t\t}\n\n\t\t\tindex += stride;\n\t\t}\n\n\t\tthis.notifyColorsUpdate();\n\n\t\tthis._colorsDirty = false;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis._startPositions = null;\n\t\tthis._endPositions = null;\n\t\tthis._thickness = null;\n\t\tthis._startColors = null;\n\t\tthis._endColors = null;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateBounds()\n\t{\n\t\tif (this.parentGeometry)\n\t\t\tthis.parentGeometry.iInvalidateBounds(this);\n\t}\n\n\t/**\n\t * The Geometry object that 'owns' this TriangleSubGeometry object.\n\t *\n\t * @private\n\t */\n\tpublic parentGeometry:Geometry;\n\n\t/**\n\t * Clones the current object\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():LineSubGeometry\n\t{\n\t\tvar clone:LineSubGeometry = new LineSubGeometry();\n\t\tclone.updateIndices(this._pIndices.concat());\n\t\tclone.updatePositions(this._startPositions.concat(), this._endPositions.concat());\n\t\tclone.updateThickness(this._thickness.concat());\n\t\tclone.updatePositions(this._startPositions.concat(), this._endPositions.concat());\n\n\t\treturn clone;\n\t}\n\n\tpublic _pNotifyVerticesUpdate()\n\t{\n\t\tthis._pStrideOffsetDirty = true;\n\n\t\tthis.notifyPositionsUpdate();\n\t\tthis.notifyThicknessUpdate();\n\t\tthis.notifyColorsUpdate();\n\t}\n\n\tprivate notifyPositionsUpdate()\n\t{\n\t\tif (this._positionsDirty)\n\t\t\treturn;\n\n\t\tthis._positionsDirty = true;\n\n\t\tif (!this._positionsUpdated)\n\t\t\tthis._positionsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.POSITION_DATA);\n\n\t\tthis.dispatchEvent(this._positionsUpdated);\n\t}\n\n\tprivate notifyThicknessUpdate()\n\t{\n\t\tif (this._thicknessDirty)\n\t\t\treturn;\n\n\t\tthis._thicknessDirty = true;\n\n\t\tif (!this._thicknessUpdated)\n\t\t\tthis._thicknessUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, LineSubGeometry.THICKNESS_DATA);\n\n\t\tthis.dispatchEvent(this._thicknessUpdated);\n\t}\n\n\tprivate notifyColorsUpdate()\n\t{\n\t\tif (this._colorsDirty)\n\t\t\treturn;\n\n\t\tthis._colorsDirty = true;\n\n\t\tif (!this._colorUpdated)\n\t\t\tthis._colorUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, LineSubGeometry.COLOR_DATA);\n\n\t\tthis.dispatchEvent(this._colorUpdated);\n\t}\n}\n\nexport = LineSubGeometry;",
    "import AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\n\nimport ISubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport LineSubGeometry\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubMeshBase\t\t\t\t= require(\"awayjs-display/lib/base/SubMeshBase\");\nimport IRenderer\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Mesh\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n * LineSubMesh wraps a LineSubGeometry as a scene graph instantiation. A LineSubMesh is owned by a Mesh object.\n *\n *\n * @see away.base.LineSubGeometry\n * @see away.entities.Mesh\n *\n * @class away.base.LineSubMesh\n */\nclass LineSubMesh extends SubMeshBase implements ISubMesh\n{\n\tprivate _subGeometry:LineSubGeometry;\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.LINE_SUB_MESH;\n\t}\n\n\t/**\n\t * The LineSubGeometry object which provides the geometry data for this LineSubMesh.\n\t */\n\tpublic get subGeometry():LineSubGeometry\n\t{\n\t\treturn this._subGeometry;\n\t}\n\n\t/**\n\t * Creates a new LineSubMesh object\n\t * @param subGeometry The LineSubGeometry object which provides the geometry data for this LineSubMesh.\n\t * @param parentMesh The Mesh object to which this LineSubMesh belongs.\n\t * @param material An optional material used to render this LineSubMesh.\n\t */\n\tconstructor(subGeometry:LineSubGeometry, parentMesh:Mesh, material:MaterialBase = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pParentMesh = parentMesh;\n\t\tthis._subGeometry = subGeometry;\n\t\tthis.material = material;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.material = null;\n\n\t\tsuper.dispose();\n\t}\n\n\tpublic _iCollectRenderable(renderer:IRenderer)\n\t{\n\t\trenderer.applyLineSubMesh(this);\n\t}\n}\n\nexport = LineSubMesh;",
    "class OrientationMode\n{\n\t/**\n\t *\n\t */\n\tpublic static DEFAULT:string = \"default\";\n\n\t/**\n\t *\n\t */\n\tpublic static CAMERA_PLANE:string = \"cameraPlane\";\n\n\t/**\n\t *\n\t */\n\tpublic static CAMERA_POSITION:string = \"cameraPosition\";\n}\n\nexport = OrientationMode;",
    "import NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Geometry\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport ISubMeshClass\t\t\t= require(\"awayjs-display/lib/base/ISubMeshClass\");\nimport SubGeometryEvent\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\n/**\n * @class away.base.TriangleSubGeometry\n */\nclass SubGeometryBase extends NamedAssetBase\n{\n\tpublic static VERTEX_DATA:string = \"vertices\";\n\n\tpublic _pStrideOffsetDirty:boolean = true;\n\n\tpublic _pIndices:Array<number> /*uint*/;\n\tpublic _pVertices:Array<number>;\n\n\tprivate _numIndices:number;\n\tprivate _numTriangles:number;\n\tpublic _pNumVertices:number;\n\n\tpublic _pConcatenateArrays:boolean = true;\n\n\tprivate _indicesUpdated:SubGeometryEvent;\n\n\tpublic _pStride:Object = new Object();\n\tpublic _pOffset:Object = new Object();\n\n\tpublic _pUpdateStrideOffset()\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _pSubMeshClass:ISubMeshClass;\n\n\tpublic get subMeshClass():ISubMeshClass\n\t{\n\t\treturn this._pSubMeshClass;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get concatenateArrays():boolean\n\t{\n\t\treturn this._pConcatenateArrays;\n\t}\n\n\tpublic set concatenateArrays(value:boolean)\n\t{\n\t\tif (this._pConcatenateArrays == value)\n\t\t\treturn;\n\n\t\tthis._pConcatenateArrays = value;\n\n\t\tthis._pStrideOffsetDirty = true;\n\n\t\tif (value)\n\t\t\tthis._pNotifyVerticesUpdate();\n\t}\n\n\t/**\n\t * The raw index data that define the faces.\n\t */\n\tpublic get indices():Array<number>\n\t{\n\t\treturn this._pIndices;\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic get vertices():Array<number>\n\t{\n\t\tthis.updateVertices();\n\n\t\treturn this._pVertices;\n\t}\n\n\t/**\n\t * The total amount of triangles in the TriangleSubGeometry.\n\t */\n\tpublic get numTriangles():number\n\t{\n\t\treturn this._numTriangles;\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._pNumVertices;\n\t}\n\n\t/**\n\t *\n\t */\n\tconstructor(concatenatedArrays:boolean)\n\t{\n\t\tsuper();\n\n\t\tthis._pConcatenateArrays = concatenatedArrays;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getStride(dataType:string)\n\t{\n\t\tif (this._pStrideOffsetDirty)\n\t\t\tthis._pUpdateStrideOffset();\n\n\t\treturn this._pStride[dataType];\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getOffset(dataType:string)\n\t{\n\t\tif (this._pStrideOffsetDirty)\n\t\t\tthis._pUpdateStrideOffset();\n\n\t\treturn this._pOffset[dataType];\n\t}\n\n\tpublic updateVertices()\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pIndices = null;\n\t\tthis._pVertices = null;\n\t}\n\n\t/**\n\t * Updates the face indices of the TriangleSubGeometry.\n\t *\n\t * @param indices The face indices to upload.\n\t */\n\tpublic updateIndices(indices:Array<number>)\n\t{\n\t\tthis._pIndices = indices;\n\t\tthis._numIndices = indices.length;\n\n\t\tthis._numTriangles = this._numIndices/3;\n\n\t\tthis.notifyIndicesUpdate();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateBounds()\n\t{\n\t\tif (this.parentGeometry)\n\t\t\tthis.parentGeometry.iInvalidateBounds(this);\n\t}\n\n\t/**\n\t * The Geometry object that 'owns' this TriangleSubGeometry object.\n\t *\n\t * @private\n\t */\n\tpublic parentGeometry:Geometry;\n\n\t/**\n\t * Clones the current object\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():SubGeometryBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic applyTransformation(transform:Matrix3D)\n\t{\n\n\t}\n\n\t/**\n\t * Scales the geometry.\n\t * @param scale The amount by which to scale.\n\t */\n\tpublic scale(scale:number)\n\t{\n\n\t}\n\n\tpublic scaleUV(scaleU:number = 1, scaleV:number = 1)\n\t{\n\n\t}\n\n\tpublic getBoundingPositions():Array<number>\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tprivate notifyIndicesUpdate()\n\t{\n\t\tif (!this._indicesUpdated)\n\t\t\tthis._indicesUpdated = new SubGeometryEvent(SubGeometryEvent.INDICES_UPDATED);\n\n\t\tthis.dispatchEvent(this._indicesUpdated);\n\t}\n\n\tpublic _pNotifyVerticesUpdate()\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = SubGeometryBase;",
    "import AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport UVTransform\t\t\t\t= require(\"awayjs-core/lib/geom/UVTransform\");\nimport NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\n\nimport IAnimator\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport IRenderable\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IRenderer\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Camera\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n * SubMeshBase wraps a TriangleSubGeometry as a scene graph instantiation. A SubMeshBase is owned by a Mesh object.\n *\n *\n * @see away.base.TriangleSubGeometry\n * @see away.entities.Mesh\n *\n * @class away.base.SubMeshBase\n */\nclass SubMeshBase extends NamedAssetBase\n{\n\tpublic _pParentMesh:Mesh;\n\tpublic _uvTransform:UVTransform;\n\n\tpublic _iIndex:number = 0;\n\n\tpublic _material:MaterialBase;\n\tprivate _renderables:Array<IRenderable> = new Array<IRenderable>();\n\n\t//TODO test shader picking\n//\t\tpublic get shaderPickingDetails():boolean\n//\t\t{\n//\n//\t\t\treturn this.sourceEntity.shaderPickingDetails;\n//\t\t}\n\n\t/**\n\t * The animator object that provides the state for the TriangleSubMesh's animation.\n\t */\n\tpublic get animator():IAnimator\n\t{\n\t\treturn this._pParentMesh.animator;\n\t}\n\n\t/**\n\t * The material used to render the current TriangleSubMesh. If set to null, its parent Mesh's material will be used instead.\n\t */\n\tpublic get material():MaterialBase\n\t{\n\t\treturn this._material || this._pParentMesh.material;\n\t}\n\n\tpublic set material(value:MaterialBase)\n\t{\n\t\tif (this.material)\n\t\t\tthis.material.iRemoveOwner(this);\n\n\t\tthis._material = value;\n\n\t\tif (this.material)\n\t\t\tthis.material.iAddOwner(this);\n\t}\n\n\t/**\n\t * The scene transform object that transforms from model to world space.\n\t */\n\tpublic get sceneTransform():Matrix3D\n\t{\n\t\treturn this._pParentMesh.sceneTransform;\n\t}\n\n\t/**\n\t * The entity that that initially provided the IRenderable to the render pipeline (ie: the owning Mesh object).\n\t */\n\tpublic get parentMesh():Mesh\n\t{\n\t\treturn this._pParentMesh;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get uvTransform():UVTransform\n\t{\n\t\treturn this._uvTransform || this._pParentMesh.uvTransform;\n\t}\n\n\tpublic set uvTransform(value:UVTransform)\n\t{\n\t\tthis._uvTransform = value;\n\t}\n\n\t/**\n\t * Creates a new SubMeshBase object\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.material = null;\n\n\t\tvar len:number = this._renderables.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._renderables[i].dispose();\n\t}\n\n\t/**\n\t *\n\t * @param camera\n\t * @returns {away.geom.Matrix3D}\n\t */\n\tpublic getRenderSceneTransform(camera:Camera):Matrix3D\n\t{\n\t\treturn this._pParentMesh.getRenderSceneTransform(camera);\n\t}\n\n\tpublic _iAddRenderable(renderable:IRenderable):IRenderable\n\t{\n\t\tthis._renderables.push(renderable);\n\n\t\treturn renderable;\n\t}\n\n\n\tpublic _iRemoveRenderable(renderable:IRenderable):IRenderable\n\t{\n\t\tvar index:number = this._renderables.indexOf(renderable);\n\n\t\tthis._renderables.splice(index, 1);\n\n\t\treturn renderable;\n\t}\n\n\tpublic _iInvalidateRenderableGeometry()\n\t{\n\t\tvar len:number = this._renderables.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._renderables[i].invalidateGeometry();\n\t}\n\n\tpublic _iCollectRenderable(renderer:IRenderer)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _iGetExplicitMaterial():MaterialBase\n\t{\n\t\treturn this._material;\n\t}\n}\n\nexport = SubMeshBase;",
    "import ColorTransform\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Matrix\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport PerspectiveProjection\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\n\n/**\n * The Transform class provides access to color adjustment properties and two-\n * or three-dimensional transformation objects that can be applied to a\n * display object. During the transformation, the color or the orientation and\n * position of a display object is adjusted(offset) from the current values\n * or coordinates to new values or coordinates. The Transform class also\n * collects data about color and two-dimensional matrix transformations that\n * are applied to a display object and all of its parent objects. You can\n * access these combined transformations through the\n * <code>concatenatedColorTransform</code> and <code>concatenatedMatrix</code>\n * properties.\n *\n * <p>To apply color transformations: create a ColorTransform object, set the\n * color adjustments using the object's methods and properties, and then\n * assign the <code>colorTransformation</code> property of the\n * <code>transform</code> property of the display object to the new\n * ColorTransformation object.</p>\n *\n * <p>To apply two-dimensional transformations: create a Matrix object, set\n * the matrix's two-dimensional transformation, and then assign the\n * <code>transform.matrix</code> property of the display object to the new\n * Matrix object.</p>\n *\n * <p>To apply three-dimensional transformations: start with a\n * three-dimensional display object. A three-dimensional display object has a\n * <code>z</code> property value other than zero. You do not need to create\n * the Matrix3D object. For all three-dimensional objects, a Matrix3D object\n * is created automatically when you assign a <code>z</code> value to a\n * display object. You can access the display object's Matrix3D object through\n * the display object's <code>transform</code> property. Using the methods of\n * the Matrix3D class, you can add to or modify the existing transformation\n * settings. Also, you can create a custom Matrix3D object, set the custom\n * Matrix3D object's transformation elements, and then assign the new Matrix3D\n * object to the display object using the <code>transform.matrix</code>\n * property.</p>\n *\n * <p>To modify a perspective projection of the stage or root object: use the\n * <code>transform.matrix</code> property of the root display object to gain\n * access to the PerspectiveProjection object. Or, apply different perspective\n * projection properties to a display object by setting the perspective\n * projection properties of the display object's parent. The child display\n * object inherits the new properties. Specifically, create a\n * PerspectiveProjection object and set its properties, then assign the\n * PerspectiveProjection object to the <code>perspectiveProjection</code>\n * property of the parent display object's <code>transform</code> property.\n * The specified projection transformation then applies to all the display\n * object's three-dimensional children.</p>\n *\n * <p>Since both PerspectiveProjection and Matrix3D objects perform\n * perspective transformations, do not assign both to a display object at the\n * same time. Use the PerspectiveProjection object for focal length and\n * projection center changes. For more control over the perspective\n * transformation, create a perspective projection Matrix3D object.</p>\n */\nclass Transform\n{\n\tprivate _displayObject:DisplayObject;\n\tprivate _concatenatedColorTransform:ColorTransform;\n\tprivate _concatenatedMatrix:Matrix;\n\tprivate _pixelBounds:Rectangle;\n\tpublic _position:Vector3D = new Vector3D();\n\n\t/**\n\t *\n\t */\n\tpublic get backVector():Vector3D\n\t{\n\t\tvar director:Vector3D = Matrix3DUtils.getForward(this._displayObject._iMatrix3D);\n\t\tdirector.negate();\n\n\t\treturn director;\n\t}\n\n\t/**\n\t * A ColorTransform object containing values that universally adjust the\n\t * colors in the display object.\n\t * \n\t * @throws TypeError The colorTransform is null when being set\n\t */\n\tpublic colorTransform:ColorTransform;\n\n\t/**\n\t * A ColorTransform object representing the combined color transformations\n\t * applied to the display object and all of its parent objects, back to the\n\t * root level. If different color transformations have been applied at\n\t * different levels, all of those transformations are concatenated into one\n\t * ColorTransform object for this property.\n\t */\n\tpublic get concatenatedColorTransform():ColorTransform\n\t{\n\t\treturn this._concatenatedColorTransform; //TODO\n\t}\n\n\t/**\n\t * A Matrix object representing the combined transformation matrixes of the\n\t * display object and all of its parent objects, back to the root level. If\n\t * different transformation matrixes have been applied at different levels,\n\t * all of those matrixes are concatenated into one matrix for this property.\n\t * Also, for resizeable SWF content running in the browser, this property\n\t * factors in the difference between stage coordinates and window coordinates\n\t * due to window resizing. Thus, the property converts local coordinates to\n\t * window coordinates, which may not be the same coordinate space as that of\n\t * the Stage.\n\t */\n\tpublic get concatenatedMatrix():Matrix\n\t{\n\t\treturn this._concatenatedMatrix; //TODO\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get downVector():Vector3D\n\t{\n\t\tvar director:Vector3D = Matrix3DUtils.getUp(this._displayObject._iMatrix3D);\n\t\tdirector.negate();\n\n\t\treturn director;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get forwardVector():Vector3D\n\t{\n\t\treturn Matrix3DUtils.getForward(this._displayObject._iMatrix3D);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get leftVector():Vector3D\n\t{\n\t\tvar director:Vector3D = Matrix3DUtils.getRight(this._displayObject._iMatrix3D);\n\t\tdirector.negate();\n\n\t\treturn director;\n\t}\n\n\t/**\n\t * A Matrix object containing values that alter the scaling, rotation, and\n\t * translation of the display object.\n\t *\n\t * <p>If the <code>matrix</code> property is set to a value(not\n\t * <code>null</code>), the <code>matrix3D</code> property is\n\t * <code>null</code>. And if the <code>matrix3D</code> property is set to a\n\t * value(not <code>null</code>), the <code>matrix</code> property is\n\t * <code>null</code>.</p>\n\t * \n\t * @throws TypeError The matrix is null when being set\n\t */\n\tpublic matrix:Matrix;\n\n\t/**\n\t * Provides access to the Matrix3D object of a three-dimensional display\n\t * object. The Matrix3D object represents a transformation matrix that\n\t * determines the display object's position and orientation. A Matrix3D\n\t * object can also perform perspective projection.\n\t *\n\t * <p>If the <code>matrix</code> property is set to a value(not\n\t * <code>null</code>), the <code>matrix3D</code> property is\n\t * <code>null</code>. And if the <code>matrix3D</code> property is set to a\n\t * value(not <code>null</code>), the <code>matrix</code> property is\n\t * <code>null</code>.</p>\n\t */\n\tpublic get matrix3D():Matrix3D\n\t{\n\t\treturn this._displayObject._iMatrix3D;\n\t}\n\n\tpublic set matrix3D(val:Matrix3D)\n\t{\n\t\tthis._displayObject._iMatrix3D = val;\n\t}\n\n\t/**\n\t * Provides access to the PerspectiveProjection object of a three-dimensional\n\t * display object. The PerspectiveProjection object can be used to modify the\n\t * perspective transformation of the stage or to assign a perspective\n\t * transformation to all the three-dimensional children of a display object.\n\t *\n\t * <p>Based on the field of view and aspect ratio(dimensions) of the stage,\n\t * a default PerspectiveProjection object is assigned to the root object.</p>\n\t */\n\tpublic perspectiveProjection:PerspectiveProjection;\n\n\t/**\n\t * A Rectangle object that defines the bounding rectangle of the display\n\t * object on the stage.\n\t */\n\tpublic get pixelBounds():Rectangle\n\t{\n\t\treturn this._pixelBounds;\n\t}\n\n\t/**\n\t * Defines the position of the 3d object, relative to the local coordinates of the parent <code>ObjectContainer3D</code>.\n\t */\n\tpublic get position():Vector3D\n\t{\n\t\treturn this._displayObject._iMatrix3D.position\n\t}\n\n\tpublic set position(value:Vector3D)\n\t{\n\t\tthis._displayObject.x = value.x;\n\t\tthis._displayObject.y = value.y;\n\t\tthis._displayObject.z = value.z;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get rightVector():Vector3D\n\t{\n\t\treturn Matrix3DUtils.getRight(this._displayObject._iMatrix3D);\n\t}\n\n\t/**\n\t * Defines the rotation of the 3d object, relative to the local coordinates of the parent <code>ObjectContainer3D</code>.\n\t */\n\tpublic get rotation():Vector3D\n\t{\n\t\treturn new Vector3D(this._displayObject.rotationX, this._displayObject.rotationY, this._displayObject.rotationZ);\n\t}\n\n\tpublic set rotation(value:Vector3D)\n\t{\n\t\tthis._displayObject.rotationX = value.x;\n\t\tthis._displayObject.rotationY = value.y;\n\t\tthis._displayObject.rotationZ = value.z;\n\t}\n\n\t/**\n\t * Defines the scale of the 3d object, relative to the local coordinates of the parent <code>ObjectContainer3D</code>.\n\t */\n\tpublic get scale():Vector3D\n\t{\n\t\treturn new Vector3D(this._displayObject.scaleX, this._displayObject.scaleY, this._displayObject.scaleZ);\n\t}\n\n\tpublic set scale(value:Vector3D)\n\t{\n\t\tthis._displayObject.scaleX = value.x;\n\t\tthis._displayObject.scaleY = value.y;\n\t\tthis._displayObject.scaleZ = value.z;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get upVector():Vector3D\n\t{\n\t\treturn Matrix3DUtils.getUp(this._displayObject._iMatrix3D);\n\t}\n\n\tconstructor(displayObject:DisplayObject)\n\t{\n\t\tthis._displayObject = displayObject;\n\t}\n\n\t/**\n\t * Returns a Matrix3D object, which can transform the space of a specified\n\t * display object in relation to the current display object's space. You can\n\t * use the <code>getRelativeMatrix3D()</code> method to move one\n\t * three-dimensional display object relative to another three-dimensional\n\t * display object.\n\t * \n\t * @param relativeTo The display object relative to which the transformation\n\t *                   occurs. To get a Matrix3D object relative to the stage,\n\t *                   set the parameter to the <code>root</code> or\n\t *                   <code>stage</code> object. To get the world-relative\n\t *                   matrix of the display object, set the parameter to a\n\t *                   display object that has a perspective transformation\n\t *                   applied to it.\n\t * @return A Matrix3D object that can be used to transform the space from the\n\t *         <code>relativeTo</code> display object to the current display\n\t *         object space.\n\t */\n\tpublic getRelativeMatrix3D(relativeTo:DisplayObject):Matrix3D\n\t{\n\t\treturn new Matrix3D(); //TODO\n\t}\n\n\n\t/**\n\t * Moves the 3d object forwards along it's local z axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\tpublic moveForward(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.Z_AXIS, distance);\n\t}\n\n\t/**\n\t * Moves the 3d object backwards along it's local z axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\tpublic moveBackward(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.Z_AXIS, -distance);\n\t}\n\n\t/**\n\t * Moves the 3d object backwards along it's local x axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\n\tpublic moveLeft(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.X_AXIS, -distance);\n\t}\n\n\t/**\n\t * Moves the 3d object forwards along it's local x axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\tpublic moveRight(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.X_AXIS, distance);\n\t}\n\n\t/**\n\t * Moves the 3d object forwards along it's local y axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\tpublic moveUp(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.Y_AXIS, distance);\n\t}\n\n\t/**\n\t * Moves the 3d object backwards along it's local y axis\n\t *\n\t * @param    distance    The length of the movement\n\t */\n\tpublic moveDown(distance:number)\n\t{\n\t\tthis._displayObject.translateLocal(Vector3D.Y_AXIS, -distance);\n\t}\n}\n\nexport = Transform;\n",
    "import Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubMesh\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport SubGeometryEvent\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\n/**\n * @class away.base.TriangleSubGeometry\n */\nclass TriangleSubGeometry extends SubGeometryBase\n{\n\tpublic static POSITION_DATA:string = \"positions\";\n\tpublic static NORMAL_DATA:string = \"vertexNormals\";\n\tpublic static TANGENT_DATA:string = \"vertexTangents\";\n\tpublic static UV_DATA:string = \"uvs\";\n\tpublic static SECONDARY_UV_DATA:string = \"secondaryUVs\";\n\tpublic static JOINT_INDEX_DATA:string = \"jointIndices\";\n\tpublic static JOINT_WEIGHT_DATA:string = \"jointWeights\";\n\n\t//TODO - move these to StageGL\n\tpublic static POSITION_FORMAT:string = \"float3\";\n\tpublic static NORMAL_FORMAT:string = \"float3\";\n\tpublic static TANGENT_FORMAT:string = \"float3\";\n\tpublic static UV_FORMAT:string = \"float2\";\n\tpublic static SECONDARY_UV_FORMAT:string = \"float2\";\n\n\tprivate _positionsDirty:boolean = true;\n\tprivate _faceNormalsDirty:boolean = true;\n\tprivate _faceTangentsDirty:boolean = true;\n\tprivate _vertexNormalsDirty:boolean = true;\n\tprivate _vertexTangentsDirty:boolean = true;\n\tprivate _uvsDirty:boolean = true;\n\tprivate _secondaryUVsDirty:boolean = true;\n\tprivate _jointIndicesDirty:boolean = true;\n\tprivate _jointWeightsDirty:boolean = true;\n\n\tprivate _positions:Array<number>;\n\tprivate _vertexNormals:Array<number>;\n\tprivate _vertexTangents:Array<number>;\n\tprivate _uvs:Array<number>;\n\tprivate _secondaryUVs:Array<number>;\n\tprivate _jointIndices:Array<number>;\n\tprivate _jointWeights:Array<number>;\n\n\tprivate _useCondensedIndices:boolean;\n\tprivate _condensedJointIndices:Array<number>;\n\tprivate _condensedIndexLookUp:Array<number>;\n\tprivate _numCondensedJoints:number;\n\n\tprivate _jointsPerVertex:number;\n\n\tprivate _concatenateArrays:boolean = true;\n\tprivate _autoDeriveNormals:boolean = true;\n\tprivate _autoDeriveTangents:boolean = true;\n\tprivate _autoDeriveUVs:boolean = false;\n\tprivate _useFaceWeights:boolean = false;\n\n\tprivate _faceNormals:Array<number>;\n\tprivate _faceTangents:Array<number>;\n\tprivate _faceWeights:Array<number>;\n\n\tprivate _scaleU:number = 1;\n\tprivate _scaleV:number = 1;\n\n\tprivate _positionsUpdated:SubGeometryEvent;\n\tprivate _normalsUpdated:SubGeometryEvent;\n\tprivate _tangentsUpdated:SubGeometryEvent;\n\tprivate _uvsUpdated:SubGeometryEvent;\n\tprivate _secondaryUVsUpdated:SubGeometryEvent;\n\tprivate _jointIndicesUpdated:SubGeometryEvent;\n\tprivate _jointWeightsUpdated:SubGeometryEvent;\n\n\t/**\n\t *\n\t */\n\tpublic get scaleU():number\n\t{\n\t\treturn this._scaleU;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get scaleV():number\n\t{\n\t\treturn this._scaleV;\n\t}\n\n\t/**\n\t * Offers the option of enabling GPU accelerated animation on skeletons larger than 32 joints\n\t * by condensing the number of joint index values required per mesh. Only applicable to\n\t * skeleton animations that utilise more than one mesh object. Defaults to false.\n\t */\n\tpublic get useCondensedIndices():boolean\n\t{\n\t\treturn this._useCondensedIndices;\n\t}\n\n\tpublic set useCondensedIndices(value:boolean)\n\t{\n\t\tif (this._useCondensedIndices == value)\n\t\t\treturn;\n\n\t\tthis._useCondensedIndices = value;\n\n\t\tthis.notifyJointIndicesUpdate();\n\t}\n\n\tpublic _pUpdateStrideOffset()\n\t{\n\t\tif (this._concatenateArrays) {\n\t\t\tthis._pOffset[TriangleSubGeometry.VERTEX_DATA] = 0;\n\n\t\t\t//always have positions\n\t\t\tthis._pOffset[TriangleSubGeometry.POSITION_DATA] = 0;\n\t\t\tvar stride:number = 3;\n\n\t\t\tif (this._vertexNormals != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.NORMAL_DATA] = stride;\n\t\t\t\tstride += 3;\n\t\t\t}\n\n\t\t\tif (this._vertexTangents != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.TANGENT_DATA] = stride;\n\t\t\t\tstride += 3;\n\t\t\t}\n\n\t\t\tif (this._uvs != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.UV_DATA] = stride;\n\t\t\t\tstride += 2;\n\t\t\t}\n\n\t\t\tif (this._secondaryUVs != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.SECONDARY_UV_DATA] = stride;\n\t\t\t\tstride += 2;\n\t\t\t}\n\n\t\t\tif (this._jointIndices != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.JOINT_INDEX_DATA] = stride;\n\t\t\t\tstride += this._jointsPerVertex;\n\t\t\t}\n\n\t\t\tif (this._jointWeights != null) {\n\t\t\t\tthis._pOffset[TriangleSubGeometry.JOINT_WEIGHT_DATA] = stride;\n\t\t\t\tstride += this._jointsPerVertex;\n\t\t\t}\n\n\t\t\tthis._pStride[TriangleSubGeometry.VERTEX_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.POSITION_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.NORMAL_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.TANGENT_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.UV_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.SECONDARY_UV_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.JOINT_INDEX_DATA] = stride;\n\t\t\tthis._pStride[TriangleSubGeometry.JOINT_WEIGHT_DATA] = stride;\n\n\t\t\tvar len:number = this._pNumVertices*stride;\n\n\t\t\tif (this._pVertices == null)\n\t\t\t\tthis._pVertices = new Array<number>(len);\n\t\t\telse if (this._pVertices.length != len)\n\t\t\t\tthis._pVertices.length = len;\n\n\t\t} else {\n\t\t\tthis._pOffset[TriangleSubGeometry.POSITION_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.NORMAL_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.TANGENT_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.UV_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.SECONDARY_UV_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.JOINT_INDEX_DATA] = 0;\n\t\t\tthis._pOffset[TriangleSubGeometry.JOINT_WEIGHT_DATA] = 0;\n\n\t\t\tthis._pStride[TriangleSubGeometry.POSITION_DATA] = 3;\n\t\t\tthis._pStride[TriangleSubGeometry.NORMAL_DATA] = 3;\n\t\t\tthis._pStride[TriangleSubGeometry.TANGENT_DATA] = 3;\n\t\t\tthis._pStride[TriangleSubGeometry.UV_DATA] = 2;\n\t\t\tthis._pStride[TriangleSubGeometry.SECONDARY_UV_DATA] = 2;\n\t\t\tthis._pStride[TriangleSubGeometry.JOINT_INDEX_DATA] = this._jointsPerVertex;\n\t\t\tthis._pStride[TriangleSubGeometry.JOINT_WEIGHT_DATA] = this._jointsPerVertex;\n\t\t}\n\n\t\tthis._pStrideOffsetDirty = false;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get jointsPerVertex():number\n\t{\n\t\treturn this._jointsPerVertex;\n\t}\n\n\tpublic set jointsPerVertex(value:number)\n\t{\n\t\tif (this._jointsPerVertex == value)\n\t\t\treturn;\n\n\t\tthis._jointsPerVertex = value;\n\n\t\tthis._pStrideOffsetDirty = true;\n\n\t\tif (this._pConcatenateArrays)\n\t\t\tthis._pNotifyVerticesUpdate();\n\t}\n\n\t/**\n\t * Defines whether a UV buffer should be automatically generated to contain dummy UV coordinates.\n\t * Set to true if a geometry lacks UV data but uses a material that requires it, or leave as false\n\t * in cases where UV data is explicitly defined or the material does not require UV data.\n\t */\n\tpublic get autoDeriveUVs():boolean\n\t{\n\t\treturn this._autoDeriveUVs;\n\t}\n\n\tpublic set autoDeriveUVs(value:boolean)\n\t{\n\t\tif (this._autoDeriveUVs == value)\n\t\t\treturn;\n\n\t\tthis._autoDeriveUVs = value;\n\n\t\tif (value)\n\t\t\tthis.notifyUVsUpdate();\n\t}\n\n\t/**\n\t * True if the vertex normals should be derived from the geometry, false if the vertex normals are set\n\t * explicitly.\n\t */\n\tpublic get autoDeriveNormals():boolean\n\t{\n\t\treturn this._autoDeriveNormals;\n\t}\n\n\tpublic set autoDeriveNormals(value:boolean)\n\t{\n\t\tif (this._autoDeriveNormals == value)\n\t\t\treturn;\n\n\t\tthis._autoDeriveNormals = value;\n\n\t\tif (value)\n\t\t\tthis.notifyNormalsUpdate();\n\t}\n\n\t/**\n\t * True if the vertex tangents should be derived from the geometry, false if the vertex normals are set\n\t * explicitly.\n\t */\n\tpublic get autoDeriveTangents():boolean\n\t{\n\t\treturn this._autoDeriveTangents;\n\t}\n\n\tpublic set autoDeriveTangents(value:boolean)\n\t{\n\t\tif (this._autoDeriveTangents == value)\n\t\t\treturn;\n\n\t\tthis._autoDeriveTangents = value;\n\n\t\tif (value)\n\t\t\tthis.notifyTangentsUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get vertices():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._positions);\n\n\t\tif (this._vertexNormalsDirty)\n\t\t\tthis.updateVertexNormals(this._vertexNormals);\n\n\t\tif (this._vertexTangentsDirty)\n\t\t\tthis.updateVertexTangents(this._vertexTangents);\n\n\t\tif (this._uvsDirty)\n\t\t\tthis.updateUVs(this._uvs);\n\n\t\tif (this._secondaryUVsDirty)\n\t\t\tthis.updateSecondaryUVs(this._secondaryUVs);\n\n\t\tif (this._jointIndicesDirty)\n\t\t\tthis.updateJointIndices(this._jointIndices);\n\n\t\tif (this._jointWeightsDirty)\n\t\t\tthis.updateJointWeights(this._jointWeights);\n\n\t\treturn this._pVertices;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get positions():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._positions);\n\n\t\treturn this._positions;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get vertexNormals():Array<number>\n\t{\n\t\tif (this._vertexNormalsDirty)\n\t\t\tthis.updateVertexNormals(this._vertexNormals);\n\n\t\treturn this._vertexNormals;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get vertexTangents():Array<number>\n\t{\n\t\tif (this._vertexTangentsDirty)\n\t\t\tthis.updateVertexTangents(this._vertexTangents);\n\n\t\treturn this._vertexTangents;\n\t}\n\n\t/**\n\t * The raw data of the face normals, in the same order as the faces are listed in the index list.\n\t */\n\tpublic get faceNormals():Array<number>\n\t{\n\t\tif (this._faceNormalsDirty)\n\t\t\tthis.updateFaceNormals();\n\n\t\treturn this._faceNormals;\n\t}\n\n\t/**\n\t * The raw data of the face tangets, in the same order as the faces are listed in the index list.\n\t */\n\tpublic get faceTangents():Array<number>\n\t{\n\t\tif (this._faceTangentsDirty)\n\t\t\tthis.updateFaceTangents();\n\n\t\treturn this._faceTangents;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get uvs():Array<number>\n\t{\n\t\tif (this._uvsDirty)\n\t\t\tthis.updateUVs(this._uvs);\n\n\t\treturn this._uvs;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get secondaryUVs():Array<number>\n\t{\n\t\tif (this._secondaryUVsDirty)\n\t\t\tthis.updateSecondaryUVs(this._secondaryUVs);\n\n\t\treturn this._secondaryUVs;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get jointIndices():Array<number>\n\t{\n\t\tif (this._jointIndicesDirty)\n\t\t\tthis.updateJointIndices(this._jointIndices);\n\n\t\tif (this._useCondensedIndices)\n\t\t\treturn this._condensedJointIndices;\n\n\t\treturn this._jointIndices;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get jointWeights():Array<number>\n\t{\n\t\tif (this._jointWeightsDirty)\n\t\t\tthis.updateJointWeights(this._jointWeights);\n\n\t\treturn this._jointWeights;\n\t}\n\n\t/**\n\t * Indicates whether or not to take the size of faces into account when auto-deriving vertex normals and tangents.\n\t */\n\tpublic get useFaceWeights():boolean\n\t{\n\t\treturn this._useFaceWeights;\n\t}\n\n\tpublic set useFaceWeights(value:boolean)\n\t{\n\t\tif (this._useFaceWeights == value)\n\t\t\treturn;\n\n\t\tthis._useFaceWeights = value;\n\n\t\tif (this._autoDeriveNormals)\n\t\t\tthis.notifyNormalsUpdate();\n\n\t\tif (this._autoDeriveTangents)\n\t\t\tthis.notifyTangentsUpdate();\n\n\t\tthis._faceNormalsDirty = true;\n\t}\n\n\tpublic get numCondensedJoints():number\n\t{\n\t\tif (this._jointIndicesDirty)\n\t\t\tthis.updateJointIndices(this._jointIndices);\n\n\t\treturn this._numCondensedJoints;\n\t}\n\n\tpublic get condensedIndexLookUp():Array<number>\n\t{\n\t\tif (this._jointIndicesDirty)\n\t\t\tthis.updateJointIndices(this._jointIndices);\n\n\t\treturn this._condensedIndexLookUp;\n\t}\n\n\t/**\n\t *\n\t */\n\tconstructor(concatenatedArrays:boolean)\n\t{\n\t\tsuper(concatenatedArrays);\n\n\t\tthis._pSubMeshClass = TriangleSubMesh;\n\t}\n\n\tpublic getBoundingPositions():Array<number>\n\t{\n\t\tif (this._positionsDirty)\n\t\t\tthis.updatePositions(this._positions);\n\n\t\treturn this._positions;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updatePositions(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar stride:number;\n\t\tvar positions:Array<number>;\n\n\t\tthis._positions = values;\n\n\t\tif (this._positions == null)\n\t\t\tthis._positions = new Array<number>();\n\n\t\tthis._pNumVertices = this._positions.length/3;\n\n\t\tif (this._concatenateArrays) {\n\t\t\tvar len:number = this._pNumVertices*this.getStride(TriangleSubGeometry.VERTEX_DATA);\n\n\t\t\tif (this._pVertices == null)\n\t\t\t\tthis._pVertices = new Array<number>(len);\n\t\t\telse if (this._pVertices.length != len)\n\t\t\t\tthis._pVertices.length = len;\n\n\t\t\ti = 0;\n\t\t\tindex = this.getOffset(TriangleSubGeometry.POSITION_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.POSITION_DATA);\n\t\t\tpositions = this._pVertices;\n\n\t\t\twhile (i < values.length) {\n\t\t\t\tpositions[index] = values[i++];\n\t\t\t\tpositions[index + 1] = values[i++];\n\t\t\t\tpositions[index + 2] = values[i++];\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tif (this._autoDeriveNormals)\n\t\t\tthis.notifyNormalsUpdate();\n\n\t\tif (this._autoDeriveTangents)\n\t\t\tthis.notifyTangentsUpdate();\n\n\t\tif (this._autoDeriveUVs)\n\t\t\tthis.notifyUVsUpdate()\n\n\t\tthis.pInvalidateBounds();\n\n\t\tthis.notifyPositionsUpdate();\n\n\t\tthis._positionsDirty = false;\n\t}\n\n\t/**\n\t * Updates the vertex normals based on the geometry.\n\t */\n\tpublic updateVertexNormals(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar normals:Array<number>;\n\n\t\tif (!this._autoDeriveNormals) {\n\t\t\tif ((this._vertexNormals == null || values == null) && (this._vertexNormals != null || values != null)) {\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\t\t\tthis._vertexNormals = values;\n\n\t\t\tif (values != null && this._concatenateArrays) {\n\t\t\t\ti = 0;\n\t\t\t\tindex = this.getOffset(TriangleSubGeometry.NORMAL_DATA);\n\t\t\t\tstride = this.getStride(TriangleSubGeometry.NORMAL_DATA);\n\t\t\t\tnormals = this._pVertices;\n\n\t\t\t\twhile (i < values.length) {\n\t\t\t\t\tnormals[index] = values[i++];\n\t\t\t\t\tnormals[index + 1] = values[i++];\n\t\t\t\t\tnormals[index + 2] = values[i++];\n\t\t\t\t\tindex += stride;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._vertexNormals == null) {\n\t\t\t\tthis._vertexNormals = new Array<number>(this._positions.length);\n\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\t\t\tif (this._faceNormalsDirty)\n\t\t\t\tthis.updateFaceNormals();\n\n\t\t\toffset = this.getOffset(TriangleSubGeometry.NORMAL_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.NORMAL_DATA);\n\n\t\t\t//autoderived normals\n\t\t\tnormals = this._concatenateArrays? this._pVertices : this._vertexNormals;\n\n\t\t\tvar f1:number = 0;\n\t\t\tvar f2:number = 1;\n\t\t\tvar f3:number = 2;\n\n\t\t\tindex = offset;\n\n\t\t\t//clear normal values\n\t\t\tvar lenV:number = normals.length;\n\t\t\twhile (index < lenV) {\n\t\t\t\tnormals[index] = 0;\n\t\t\t\tnormals[index + 1] = 0;\n\t\t\t\tnormals[index + 2] = 0;\n\t\t\t\tindex += stride;\n\t\t\t}\n\n\t\t\tvar k:number = 0;\n\t\t\tvar lenI:number = this._pIndices.length;\n\t\t\tvar weight:number;\n\n\t\t\ti = 0;\n\n\t\t\t//collect face normals\n\t\t\twhile (i < lenI) {\n\t\t\t\tweight = this._useFaceWeights? this._faceWeights[k++] : 1;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\tnormals[index] += this._faceNormals[f1]*weight;\n\t\t\t\tnormals[index + 1] += this._faceNormals[f2]*weight;\n\t\t\t\tnormals[index + 2] += this._faceNormals[f3]*weight;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\tnormals[index] += this._faceNormals[f1]*weight;\n\t\t\t\tnormals[index + 1] += this._faceNormals[f2]*weight;\n\t\t\t\tnormals[index + 2] += this._faceNormals[f3]*weight;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\tnormals[index] += this._faceNormals[f1]*weight;\n\t\t\t\tnormals[index + 1] += this._faceNormals[f2]*weight;\n\t\t\t\tnormals[index + 2] += this._faceNormals[f3]*weight;\n\t\t\t\tf1 += 3;\n\t\t\t\tf2 += 3;\n\t\t\t\tf3 += 3;\n\t\t\t}\n\n\t\t\ti = 0;\n\t\t\tindex = offset;\n\n\t\t\t//average normals collections\n\t\t\twhile (index < lenV) {\n\t\t\t\tvar vx:number = normals[index];\n\t\t\t\tvar vy:number = normals[index + 1];\n\t\t\t\tvar vz:number = normals[index + 2];\n\t\t\t\tvar d:number = 1.0/Math.sqrt(vx*vx + vy*vy + vz*vz);\n\n\t\t\t\tif (this._concatenateArrays) {\n\t\t\t\t\tthis._vertexNormals[i++] = normals[index] = vx*d;\n\t\t\t\t\tthis._vertexNormals[i++] = normals[index + 1] = vy*d;\n\t\t\t\t\tthis._vertexNormals[i++] = normals[index + 2] = vz*d;\n\t\t\t\t} else {\n\t\t\t\t\tnormals[index] = vx*d;\n\t\t\t\t\tnormals[index + 1] = vy*d;\n\t\t\t\t\tnormals[index + 2] = vz*d;\n\t\t\t\t}\n\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyNormalsUpdate();\n\n\t\tthis._vertexNormalsDirty = false;\n\t}\n\n\t/**\n\t * Updates the vertex tangents based on the geometry.\n\t */\n\tpublic updateVertexTangents(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar tangents:Array<number>;\n\n\t\tif (!this._autoDeriveTangents) {\n\t\t\tif ((this._vertexTangents == null || values == null) && (this._vertexTangents != null || values != null)) {\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\n\t\t\tthis._vertexTangents = values;\n\n\t\t\tif (values != null && this._concatenateArrays) {\n\t\t\t\ti = 0;\n\t\t\t\tindex = this.getOffset(TriangleSubGeometry.TANGENT_DATA);\n\t\t\t\tstride = this.getStride(TriangleSubGeometry.TANGENT_DATA);\n\t\t\t\ttangents = this._pVertices;\n\n\t\t\t\twhile (i < values.length) {\n\t\t\t\t\ttangents[index] = values[i++];\n\t\t\t\t\ttangents[index + 1] = values[i++];\n\t\t\t\t\ttangents[index + 2] = values[i++];\n\t\t\t\t\tindex += stride;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._vertexTangents == null) {\n\t\t\t\tthis._vertexTangents = new Array<number>(this._positions.length);\n\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\t\t\tif (this._faceTangentsDirty)\n\t\t\t\tthis.updateFaceTangents();\n\n\t\t\toffset = this.getOffset(TriangleSubGeometry.TANGENT_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.TANGENT_DATA);\n\n\t\t\t//autoderived tangents\n\t\t\ttangents = this._concatenateArrays? this._pVertices : this._vertexTangents;\n\n\t\t\tindex = offset;\n\n\t\t\t//clear tangent values\n\t\t\tvar lenV:number = tangents.length;\n\t\t\twhile (index < lenV) {\n\t\t\t\ttangents[index] = 0;\n\t\t\t\ttangents[index + 1] = 0;\n\t\t\t\ttangents[index + 2] = 0;\n\n\t\t\t\tindex += stride;\n\t\t\t}\n\n\t\t\tvar k:number = 0;\n\t\t\tvar weight:number;\n\t\t\tvar f1:number = 0;\n\t\t\tvar f2:number = 1;\n\t\t\tvar f3:number = 2;\n\n\t\t\ti = 0;\n\n\t\t\t//collect face tangents\n\t\t\tvar lenI:number = this._pIndices.length;\n\t\t\twhile (i < lenI) {\n\t\t\t\tweight = this._useFaceWeights? this._faceWeights[k++] : 1;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\ttangents[index++] += this._faceTangents[f1]*weight;\n\t\t\t\ttangents[index++] += this._faceTangents[f2]*weight;\n\t\t\t\ttangents[index] += this._faceTangents[f3]*weight;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\ttangents[index++] += this._faceTangents[f1]*weight;\n\t\t\t\ttangents[index++] += this._faceTangents[f2]*weight;\n\t\t\t\ttangents[index] += this._faceTangents[f3]*weight;\n\t\t\t\tindex = offset + this._pIndices[i++]*stride;\n\t\t\t\ttangents[index++] += this._faceTangents[f1]*weight;\n\t\t\t\ttangents[index++] += this._faceTangents[f2]*weight;\n\t\t\t\ttangents[index] += this._faceTangents[f3]*weight;\n\t\t\t\tf1 += 3;\n\t\t\t\tf2 += 3;\n\t\t\t\tf3 += 3;\n\t\t\t}\n\n\t\t\ti = 0;\n\t\t\tindex = offset;\n\n\t\t\t//average tangents collections\n\t\t\twhile (index < lenV) {\n\t\t\t\tvar vx:number = tangents[index];\n\t\t\t\tvar vy:number = tangents[index + 1];\n\t\t\t\tvar vz:number = tangents[index + 2];\n\t\t\t\tvar d:number = 1.0/Math.sqrt(vx*vx + vy*vy + vz*vz);\n\n\t\t\t\tif (this._concatenateArrays) {\n\t\t\t\t\tthis._vertexTangents[i++] = tangents[index] = vx*d;\n\t\t\t\t\tthis._vertexTangents[i++] = tangents[index + 1] = vy*d;\n\t\t\t\t\tthis._vertexTangents[i++] = tangents[index + 2] = vz*d;\n\t\t\t\t} else {\n\t\t\t\t\ttangents[index] = vx*d;\n\t\t\t\t\ttangents[index + 1] = vy*d;\n\t\t\t\t\ttangents[index + 2] = vz*d;\n\t\t\t\t}\n\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyTangentsUpdate();\n\n\t\tthis._vertexTangentsDirty = false;\n\t}\n\n\t/**\n\t * Updates the uvs based on the geometry.\n\t */\n\tpublic updateUVs(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar uvs:Array<number>;\n\n\t\tif (!this._autoDeriveUVs) {\n\t\t\tif ((this._uvs == null || values == null) && (this._uvs != null || values != null)) {\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\t\t\tthis._uvs = values;\n\n\t\t\tif (values != null && this._concatenateArrays) {\n\t\t\t\ti = 0;\n\t\t\t\tindex = this.getOffset(TriangleSubGeometry.UV_DATA);\n\t\t\t\tstride = this.getStride(TriangleSubGeometry.UV_DATA);\n\t\t\t\tuvs = this._pVertices;\n\n\t\t\t\twhile (i < values.length) {\n\t\t\t\t\tuvs[index] = values[i++];\n\t\t\t\t\tuvs[index + 1] = values[i++];\n\t\t\t\t\tindex += stride;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\tif (this._uvs == null) {\n\t\t\t\tthis._uvs = new Array<number>(this._positions.length*2/3);\n\n\t\t\t\tif (this._concatenateArrays)\n\t\t\t\t\tthis._pNotifyVerticesUpdate();\n\t\t\t\telse\n\t\t\t\t\tthis._pStrideOffsetDirty = true;\n\t\t\t}\n\n\t\t\toffset = this.getOffset(TriangleSubGeometry.UV_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.UV_DATA);\n\n\t\t\t//autoderived uvs\n\t\t\tuvs = this._concatenateArrays? this._pVertices : this._uvs;\n\n\t\t\ti = 0;\n\t\t\tindex = offset;\n\t\t\tvar uvIdx:number = 0;\n\n\t\t\t//clear uv values\n\t\t\tvar lenV:number = uvs.length;\n\t\t\twhile (index < lenV) {\n\t\t\t\tif (this._concatenateArrays) {\n\t\t\t\t\tthis._uvs[i++] = uvs[index] = uvIdx*.5;\n\t\t\t\t\tthis._uvs[i++] = uvs[index + 1] = 1.0 - (uvIdx & 1);\n\t\t\t\t} else {\n\t\t\t\t\tuvs[index] = uvIdx*.5;\n\t\t\t\t\tuvs[index + 1] = 1.0 - (uvIdx & 1);\n\t\t\t\t}\n\n\t\t\t\tif (++uvIdx == 3)\n\t\t\t\t\tuvIdx = 0;\n\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tif (this._autoDeriveTangents)\n\t\t\tthis.notifyTangentsUpdate();\n\n\t\tthis.notifyUVsUpdate();\n\n\t\tthis._uvsDirty = false;\n\t}\n\n\t/**\n\t * Updates the secondary uvs based on the geometry.\n\t */\n\tpublic updateSecondaryUVs(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar uvs:Array<number>;\n\n\t\tif (this._concatenateArrays && (this._secondaryUVs == null || values == null) && (this._secondaryUVs != null || values != null))\n\t\t\tthis._pNotifyVerticesUpdate();\n\n\t\tthis._secondaryUVs = values;\n\n\t\tif (values != null && this._concatenateArrays) {\n\t\t\toffset = this.getOffset(TriangleSubGeometry.SECONDARY_UV_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.SECONDARY_UV_DATA);\n\n\t\t\ti = 0;\n\t\t\tindex = offset;\n\t\t\tuvs = this._pVertices;\n\n\t\t\twhile (i < values.length) {\n\t\t\t\tuvs[index] = values[i++];\n\t\t\t\tuvs[index + 1] = values[i++];\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifySecondaryUVsUpdate();\n\n\t\tthis._secondaryUVsDirty = false;\n\t}\n\n\t/**\n\t * Updates the joint indices\n\t */\n\tpublic updateJointIndices(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar jointIndices:Array<number>;\n\n\t\tif (this._concatenateArrays && (this._jointIndices == null || values == null) && (this._jointIndices != null || values != null))\n\t\t\tthis._pNotifyVerticesUpdate();\n\n\t\tthis._jointIndices = values;\n\n\t\tif (values != null) {\n\t\t\toffset = this.getOffset(TriangleSubGeometry.JOINT_INDEX_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.JOINT_INDEX_DATA);\n\t\t\tif (this._useCondensedIndices) {\n\t\t\t\ti = 0;\n\t\t\t\tj = 0;\n\t\t\t\tindex = offset;\n\t\t\t\tjointIndices = this._concatenateArrays? this._pVertices : this._condensedJointIndices;\n\t\t\t\tvar oldIndex:number;\n\t\t\t\tvar newIndex:number = 0;\n\t\t\t\tvar dic:Object = new Object();\n\n\t\t\t\tif (!this._concatenateArrays)\n\t\t\t\t\tthis._condensedJointIndices = new Array<number>(values.length);\n\n\t\t\t\tthis._condensedIndexLookUp = new Array<number>();\n\n\t\t\t\twhile (i < values.length) {\n\t\t\t\t\tfor (j = 0; j < this._jointsPerVertex; j++) {\n\t\t\t\t\t\toldIndex = values[i++];\n\n\t\t\t\t\t\t// if we encounter a new index, assign it a new condensed index\n\t\t\t\t\t\tif (dic[oldIndex] == undefined) {\n\t\t\t\t\t\t\tdic[oldIndex] = newIndex*3; //3 required for the three vectors that store the matrix\n\t\t\t\t\t\t\tthis._condensedIndexLookUp[newIndex++] = oldIndex;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tjointIndices[index + j] = dic[oldIndex];\n\t\t\t\t\t}\n\t\t\t\t\tindex += stride;\n\t\t\t\t}\n\t\t\t\tthis._numCondensedJoints = newIndex;\n\t\t\t} else if (this._concatenateArrays) {\n\n\t\t\t\ti = 0;\n\t\t\t\tindex = offset;\n\t\t\t\tjointIndices = this._pVertices;\n\n\t\t\t\twhile (i < values.length) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile (j < this._jointsPerVertex)\n\t\t\t\t\t\tjointIndices[index + j++] = values[i++];\n\t\t\t\t\tindex += stride;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyJointIndicesUpdate();\n\n\t\tthis._jointIndicesDirty = false;\n\t}\n\n\t/**\n\t * Updates the joint weights.\n\t */\n\tpublic updateJointWeights(values:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar jointWeights:Array<number>;\n\n\t\tif (this._concatenateArrays && (this._jointWeights == null || values == null) && (this._jointWeights != null || values != null))\n\t\t\tthis._pNotifyVerticesUpdate();\n\n\t\tthis._jointWeights = values;\n\n\t\tif (values != null && this._concatenateArrays) {\n\t\t\toffset = this.getOffset(TriangleSubGeometry.JOINT_WEIGHT_DATA);\n\t\t\tstride = this.getStride(TriangleSubGeometry.JOINT_WEIGHT_DATA);\n\n\t\t\ti = 0;\n\t\t\tindex = offset;\n\t\t\tjointWeights = this._pVertices;\n\n\t\t\twhile (i < values.length) {\n\t\t\t\tj = 0;\n\t\t\t\twhile (j < this._jointsPerVertex)\n\t\t\t\t\tjointWeights[index + j++] = values[i++];\n\t\t\t\tindex += stride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyJointWeightsUpdate();\n\n\t\tthis._jointWeightsDirty = false;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis._positions = null;\n\t\tthis._vertexNormals = null;\n\t\tthis._vertexTangents = null;\n\t\tthis._uvs = null;\n\t\tthis._secondaryUVs = null;\n\t\tthis._jointIndices = null;\n\t\tthis._jointWeights = null;\n\n\t\tthis._faceNormals = null;\n\t\tthis._faceWeights = null;\n\t\tthis._faceTangents = null;\n\t}\n\n\t/**\n\t * Updates the face indices of the TriangleSubGeometry.\n\t *\n\t * @param indices The face indices to upload.\n\t */\n\tpublic updateIndices(indices:Array<number>)\n\t{\n\t\tsuper.updateIndices(indices);\n\n\t\tthis._faceNormalsDirty = true;\n\n\t\tif (this._autoDeriveNormals)\n\t\t\tthis._vertexNormalsDirty = true;\n\n\t\tif (this._autoDeriveTangents)\n\t\t\tthis._vertexTangentsDirty = true;\n\n\t\tif (this._autoDeriveUVs)\n\t\t\tthis._uvsDirty = true;\n\t}\n\n\t/**\n\t * Clones the current object\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():TriangleSubGeometry\n\t{\n\t\tvar clone:TriangleSubGeometry = new TriangleSubGeometry(this._concatenateArrays);\n\t\tclone.updateIndices(this._pIndices.concat());\n\t\tclone.updatePositions(this._positions.concat());\n\n\t\tif (this._vertexNormals && !this._autoDeriveNormals)\n\t\t\tclone.updateVertexNormals(this._vertexNormals.concat());\n\t\telse\n\t\t\tclone.updateVertexNormals(null);\n\n\t\tif (this._uvs && !this._autoDeriveUVs)\n\t\t\tclone.updateUVs(this._uvs.concat());\n\t\telse\n\t\t\tclone.updateUVs(null);\n\n\t\tif (this._vertexTangents && !this._autoDeriveTangents)\n\t\t\tclone.updateVertexTangents(this._vertexTangents.concat());\n\t\telse\n\t\t\tclone.updateVertexTangents(null);\n\n\t\tif (this._secondaryUVs)\n\t\t\tclone.updateSecondaryUVs(this._secondaryUVs.concat());\n\n\t\tif (this._jointIndices) {\n\t\t\tclone.jointsPerVertex = this._jointsPerVertex;\n\t\t\tclone.updateJointIndices(this._jointIndices.concat());\n\t\t}\n\n\t\tif (this._jointWeights)\n\t\t\tclone.updateJointWeights(this._jointWeights.concat());\n\n\t\treturn clone;\n\t}\n\n\tpublic scaleUV(scaleU:number = 1, scaleV:number = 1)\n\t{\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar uvs:Array<number>;\n\n\t\tuvs = this._uvs;\n\n\t\tvar ratioU:number = scaleU/this._scaleU;\n\t\tvar ratioV:number = scaleV/this._scaleV;\n\n\t\tthis._scaleU = scaleU;\n\t\tthis._scaleV = scaleV;\n\n\t\tvar len:number = uvs.length;\n\n\t\toffset = 0;\n\t\tstride = 2;\n\n\t\tindex = offset;\n\n\t\twhile (index < len) {\n\t\t\tuvs[index] *= ratioU;\n\t\t\tuvs[index + 1] *= ratioV;\n\t\t\tindex += stride;\n\t\t}\n\n\t\tthis.notifyUVsUpdate();\n\t}\n\n\t/**\n\t * Scales the geometry.\n\t * @param scale The amount by which to scale.\n\t */\n\tpublic scale(scale:number)\n\t{\n\t\tvar i:number;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\t\tvar positions:Array<number>;\n\n\t\tpositions = this._positions;\n\n\t\tvar len:number = positions.length;\n\n\t\toffset = 0;\n\t\tstride = 3;\n\n\t\ti = 0;\n\t\tindex = offset;\n\t\twhile (i < len) {\n\t\t\tpositions[index] *= scale;\n\t\t\tpositions[index + 1] *= scale;\n\t\t\tpositions[index + 2] *= scale;\n\n\t\t\ti += 3;\n\t\t\tindex += stride;\n\t\t}\n\n\t\tthis.notifyPositionsUpdate();\n\t}\n\n\tpublic applyTransformation(transform:Matrix3D)\n\t{\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\n\t\tif (this._concatenateArrays) {\n\t\t\tpositions = this._pVertices;\n\t\t\tnormals = this._pVertices;\n\t\t\ttangents = this._pVertices;\n\t\t} else {\n\t\t\tpositions = this._positions;\n\t\t\tnormals = this._vertexNormals;\n\t\t\ttangents = this._vertexTangents;\n\t\t}\n\n\t\tvar len:number = this._positions.length/3;\n\t\tvar i:number;\n\t\tvar i1:number;\n\t\tvar i2:number;\n\t\tvar vector:Vector3D = new Vector3D();\n\n\t\tvar bakeNormals:boolean = this._vertexNormals != null;\n\t\tvar bakeTangents:boolean = this._vertexTangents != null;\n\t\tvar invTranspose:Matrix3D;\n\n\t\tif (bakeNormals || bakeTangents) {\n\t\t\tinvTranspose = transform.clone();\n\t\t\tinvTranspose.invert();\n\t\t\tinvTranspose.transpose();\n\t\t}\n\n\t\tvar vi0:number = this.getOffset(TriangleSubGeometry.POSITION_DATA);\n\t\tvar ni0:number = this.getOffset(TriangleSubGeometry.NORMAL_DATA);\n\t\tvar ti0:number = this.getOffset(TriangleSubGeometry.TANGENT_DATA);\n\n\t\tvar vStride:number = this.getStride(TriangleSubGeometry.POSITION_DATA);\n\t\tvar nStride:number = this.getStride(TriangleSubGeometry.NORMAL_DATA);\n\t\tvar tStride:number = this.getStride(TriangleSubGeometry.TANGENT_DATA);\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\ti1 = vi0 + 1;\n\t\t\ti2 = vi0 + 2;\n\n\t\t\t// bake position\n\t\t\tvector.x = positions[vi0];\n\t\t\tvector.y = positions[i1];\n\t\t\tvector.z = positions[i2];\n\t\t\tvector = transform.transformVector(vector);\n\t\t\tpositions[vi0] = vector.x;\n\t\t\tpositions[i1] = vector.y;\n\t\t\tpositions[i2] = vector.z;\n\t\t\tvi0 += vStride;\n\n\t\t\t// bake normal\n\t\t\tif (bakeNormals) {\n\t\t\t\ti1 = ni0 + 1;\n\t\t\t\ti2 = ni0 + 2;\n\t\t\t\tvector.x = normals[ni0];\n\t\t\t\tvector.y = normals[i1];\n\t\t\t\tvector.z = normals[i2];\n\t\t\t\tvector = invTranspose.deltaTransformVector(vector);\n\t\t\t\tvector.normalize();\n\t\t\t\tnormals[ni0] = vector.x;\n\t\t\t\tnormals[i1] = vector.y;\n\t\t\t\tnormals[i2] = vector.z;\n\t\t\t\tni0 += nStride;\n\t\t\t}\n\n\t\t\t// bake tangent\n\t\t\tif (bakeTangents) {\n\t\t\t\ti1 = ti0 + 1;\n\t\t\t\ti2 = ti0 + 2;\n\t\t\t\tvector.x = tangents[ti0];\n\t\t\t\tvector.y = tangents[i1];\n\t\t\t\tvector.z = tangents[i2];\n\t\t\t\tvector = invTranspose.deltaTransformVector(vector);\n\t\t\t\tvector.normalize();\n\t\t\t\ttangents[ti0] = vector.x;\n\t\t\t\ttangents[i1] = vector.y;\n\t\t\t\ttangents[i2] = vector.z;\n\t\t\t\tti0 += tStride;\n\t\t\t}\n\t\t}\n\n\t\tthis.notifyPositionsUpdate();\n\t\tthis.notifyNormalsUpdate();\n\t\tthis.notifyTangentsUpdate();\n\t}\n\n\t/**\n\t * Updates the tangents for each face.\n\t */\n\tprivate updateFaceTangents()\n\t{\n\t\tvar i:number = 0;\n\t\tvar index1:number;\n\t\tvar index2:number;\n\t\tvar index3:number;\n\t\tvar vi:number;\n\t\tvar v0:number;\n\t\tvar dv1:number;\n\t\tvar dv2:number;\n\t\tvar denom:number;\n\t\tvar x0:number, y0:number, z0:number;\n\t\tvar dx1:number, dy1:number, dz1:number;\n\t\tvar dx2:number, dy2:number, dz2:number;\n\t\tvar cx:number, cy:number, cz:number;\n\n\t\tvar positions:Array<number> = this._positions\n\t\tvar uvs:Array<number> = this._uvs;\n\n\t\tvar len:number = this._pIndices.length;\n\n\t\tif (this._faceTangents == null)\n\t\t\tthis._faceTangents = new Array<number>(len);\n\n\t\twhile (i < len) {\n\t\t\tindex1 = this._pIndices[i];\n\t\t\tindex2 = this._pIndices[i + 1];\n\t\t\tindex3 = this._pIndices[i + 2];\n\n\t\t\tv0 = uvs[index1*2 + 1];\n\t\t\tdv1 = uvs[index2*2 + 1] - v0;\n\t\t\tdv2 = uvs[index3*2 + 1] - v0;\n\n\t\t\tvi = index1*3;\n\t\t\tx0 = positions[vi];\n\t\t\ty0 = positions[vi + 1];\n\t\t\tz0 = positions[vi + 2];\n\t\t\tvi = index2*3;\n\t\t\tdx1 = positions[vi] - x0;\n\t\t\tdy1 = positions[vi + 1] - y0;\n\t\t\tdz1 = positions[vi + 2] - z0;\n\t\t\tvi = index3*3;\n\t\t\tdx2 = positions[vi] - x0;\n\t\t\tdy2 = positions[vi + 1] - y0;\n\t\t\tdz2 = positions[vi + 2] - z0;\n\n\t\t\tcx = dv2*dx1 - dv1*dx2;\n\t\t\tcy = dv2*dy1 - dv1*dy2;\n\t\t\tcz = dv2*dz1 - dv1*dz2;\n\t\t\tdenom = 1/Math.sqrt(cx*cx + cy*cy + cz*cz);\n\n\t\t\tthis._faceTangents[i++] = denom*cx;\n\t\t\tthis._faceTangents[i++] = denom*cy;\n\t\t\tthis._faceTangents[i++] = denom*cz;\n\t\t}\n\n\t\tthis._faceTangentsDirty = false;\n\t}\n\n\t/**\n\t * Updates the normals for each face.\n\t */\n\tprivate updateFaceNormals()\n\t{\n\t\tvar i:number = 0;\n\t\tvar j:number = 0;\n\t\tvar k:number = 0;\n\t\tvar index:number;\n\t\tvar offset:number;\n\t\tvar stride:number;\n\n\t\tvar x1:number, x2:number, x3:number;\n\t\tvar y1:number, y2:number, y3:number;\n\t\tvar z1:number, z2:number, z3:number;\n\t\tvar dx1:number, dy1:number, dz1:number;\n\t\tvar dx2:number, dy2:number, dz2:number;\n\t\tvar cx:number, cy:number, cz:number;\n\t\tvar d:number;\n\n\t\tvar positions:Array<number> = this._positions;\n\n\t\tvar len:number = this._pIndices.length;\n\n\t\tif (this._faceNormals == null)\n\t\t\tthis._faceNormals = new Array<number>(len);\n\n\t\tif (this._useFaceWeights && this._faceWeights == null)\n\t\t\tthis._faceWeights = new Array<number>(len/3);\n\n\t\twhile (i < len) {\n\t\t\tindex = this._pIndices[i++]*3;\n\t\t\tx1 = positions[index];\n\t\t\ty1 = positions[index + 1];\n\t\t\tz1 = positions[index + 2];\n\t\t\tindex = this._pIndices[i++]*3;\n\t\t\tx2 = positions[index];\n\t\t\ty2 = positions[index + 1];\n\t\t\tz2 = positions[index + 2];\n\t\t\tindex = this._pIndices[i++]*3;\n\t\t\tx3 = positions[index];\n\t\t\ty3 = positions[index + 1];\n\t\t\tz3 = positions[index + 2];\n\t\t\tdx1 = x3 - x1;\n\t\t\tdy1 = y3 - y1;\n\t\t\tdz1 = z3 - z1;\n\t\t\tdx2 = x2 - x1;\n\t\t\tdy2 = y2 - y1;\n\t\t\tdz2 = z2 - z1;\n\t\t\tcx = dz1*dy2 - dy1*dz2;\n\t\t\tcy = dx1*dz2 - dz1*dx2;\n\t\t\tcz = dy1*dx2 - dx1*dy2;\n\t\t\td = Math.sqrt(cx*cx + cy*cy + cz*cz);\n\t\t\t// length of cross product = 2*triangle area\n\n\t\t\tif (this._useFaceWeights) {\n\t\t\t\tvar w:number = d*10000;\n\n\t\t\t\tif (w < 1)\n\t\t\t\t\tw = 1;\n\n\t\t\t\tthis._faceWeights[k++] = w;\n\t\t\t}\n\n\t\t\td = 1/d;\n\n\t\t\tthis._faceNormals[j++] = cx*d;\n\t\t\tthis._faceNormals[j++] = cy*d;\n\t\t\tthis._faceNormals[j++] = cz*d;\n\t\t}\n\n\t\tthis._faceNormalsDirty = false;\n\t}\n\n\tpublic _pNotifyVerticesUpdate()\n\t{\n\t\tthis._pStrideOffsetDirty = true;\n\n\t\tthis.notifyPositionsUpdate();\n\t\tthis.notifyNormalsUpdate();\n\t\tthis.notifyTangentsUpdate();\n\t\tthis.notifyUVsUpdate();\n\t\tthis.notifySecondaryUVsUpdate();\n\t\tthis.notifyJointIndicesUpdate();\n\t\tthis.notifyJointWeightsUpdate();\n\t}\n\n\tprivate notifyPositionsUpdate()\n\t{\n\t\tif (this._positionsDirty)\n\t\t\treturn;\n\n\t\tthis._positionsDirty = true;\n\n\t\tif (!this._positionsUpdated)\n\t\t\tthis._positionsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.POSITION_DATA);\n\n\t\tthis.dispatchEvent(this._positionsUpdated);\n\t}\n\n\tprivate notifyNormalsUpdate()\n\t{\n\t\tif (this._vertexNormalsDirty)\n\t\t\treturn;\n\n\t\tthis._vertexNormalsDirty = true;\n\n\t\tif (!this._normalsUpdated)\n\t\t\tthis._normalsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.NORMAL_DATA);\n\n\t\tthis.dispatchEvent(this._normalsUpdated);\n\t}\n\n\tprivate notifyTangentsUpdate()\n\t{\n\t\tif (this._vertexTangentsDirty)\n\t\t\treturn;\n\n\t\tthis._vertexTangentsDirty = true;\n\n\t\tif (!this._tangentsUpdated)\n\t\t\tthis._tangentsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.TANGENT_DATA);\n\n\t\tthis.dispatchEvent(this._tangentsUpdated);\n\t}\n\n\tprivate notifyUVsUpdate()\n\t{\n\t\tif (this._uvsDirty)\n\t\t\treturn;\n\n\t\tthis._uvsDirty = true;\n\n\t\tif (!this._uvsUpdated)\n\t\t\tthis._uvsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.UV_DATA);\n\n\t\tthis.dispatchEvent(this._uvsUpdated);\n\t}\n\n\tprivate notifySecondaryUVsUpdate()\n\t{\n\t\tif (this._secondaryUVsDirty)\n\t\t\treturn;\n\n\t\tthis._secondaryUVsDirty = true;\n\n\t\tif (!this._secondaryUVsUpdated)\n\t\t\tthis._secondaryUVsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.SECONDARY_UV_DATA);\n\n\t\tthis.dispatchEvent(this._secondaryUVsUpdated);\n\t}\n\n\tprivate notifyJointIndicesUpdate()\n\t{\n\t\tif (this._jointIndicesDirty)\n\t\t\treturn;\n\n\t\tthis._jointIndicesDirty = true;\n\n\t\tif (!this._jointIndicesUpdated)\n\t\t\tthis._jointIndicesUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.JOINT_INDEX_DATA);\n\n\t\tthis.dispatchEvent(this._jointIndicesUpdated);\n\t}\n\n\tprivate notifyJointWeightsUpdate()\n\t{\n\t\tif (this._jointWeightsDirty)\n\t\t\treturn;\n\n\t\tthis._jointWeightsDirty = true;\n\n\t\tif (!this._jointWeightsUpdated)\n\t\t\tthis._jointWeightsUpdated = new SubGeometryEvent(SubGeometryEvent.VERTICES_UPDATED, TriangleSubGeometry.JOINT_WEIGHT_DATA);\n\n\t\tthis.dispatchEvent(this._jointWeightsUpdated);\n\t}\n}\n\nexport = TriangleSubGeometry;",
    "import AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport ISubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport SubMeshBase\t\t\t\t= require(\"awayjs-display/lib/base/SubMeshBase\");\nimport TriangleSubGeometry\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nimport IRenderer\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Mesh\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n * TriangleSubMesh wraps a TriangleSubGeometry as a scene graph instantiation. A TriangleSubMesh is owned by a Mesh object.\n *\n *\n * @see away.base.TriangleSubGeometry\n * @see away.entities.Mesh\n *\n * @class away.base.TriangleSubMesh\n */\nclass TriangleSubMesh extends SubMeshBase implements ISubMesh\n{\n\tprivate _subGeometry:TriangleSubGeometry;\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.TRIANGLE_SUB_MESH;\n\t}\n\n\t/**\n\t * The TriangleSubGeometry object which provides the geometry data for this TriangleSubMesh.\n\t */\n\tpublic get subGeometry():TriangleSubGeometry\n\t{\n\t\treturn this._subGeometry;\n\t}\n\n\t/**\n\t * Creates a new TriangleSubMesh object\n\t * @param subGeometry The TriangleSubGeometry object which provides the geometry data for this TriangleSubMesh.\n\t * @param parentMesh The Mesh object to which this TriangleSubMesh belongs.\n\t * @param material An optional material used to render this TriangleSubMesh.\n\t */\n\tconstructor(subGeometry:TriangleSubGeometry, parentMesh:Mesh, material:MaterialBase = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pParentMesh = parentMesh;\n\t\tthis._subGeometry = subGeometry;\n\t\tthis.material = material;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\t}\n\n\tpublic _iCollectRenderable(renderer:IRenderer)\n\t{\n\t\trenderer.applyTriangleSubMesh(this);\n\t}\n}\n\nexport = TriangleSubMesh;",
    "import Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Error\t\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\nimport RangeError\t\t\t\t\t= require(\"awayjs-core/lib/errors/RangeError\");\n\nimport DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Partition\t\t\t\t\t= require(\"awayjs-display/lib/partition/Partition\");\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\n\n/**\n * The DisplayObjectContainer class is the base class for all objects that can\n * serve as display object containers on the display list. The display list\n * manages all objects displayed in the Flash runtimes. Use the\n * DisplayObjectContainer class to arrange the display objects in the display\n * list. Each DisplayObjectContainer object has its own child list for\n * organizing the z-order of the objects. The z-order is the front-to-back\n * order that determines which object is drawn in front, which is behind, and\n * so on.\n *\n * <p>DisplayObject is an abstract base class; therefore, you cannot call\n * DisplayObject directly. Invoking <code>new DisplayObject()</code> throws an\n * <code>ArgumentError</code> exception.</p>\n * The DisplayObjectContainer class is an abstract base class for all objects\n * that can contain child objects. It cannot be instantiated directly; calling\n * the <code>new DisplayObjectContainer()</code> constructor throws an\n * <code>ArgumentError</code> exception.\n *\n * <p>For more information, see the \"Display Programming\" chapter of the\n * <i>ActionScript 3.0 Developer's Guide</i>.</p>\n */\nclass DisplayObjectContainer extends DisplayObject implements IAsset\n{\n\tprivate _mouseChildren:boolean = true;\n\tprivate _children:Array<DisplayObject> = new Array<DisplayObject>();\n\tpublic _iIsRoot:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.CONTAINER;\n\t}\n\n\t/**\n\t * Determines whether or not the children of the object are mouse, or user\n\t * input device, enabled. If an object is enabled, a user can interact with\n\t * it by using a mouse or user input device. The default is\n\t * <code>true</code>.\n\t *\n\t * <p>This property is useful when you create a button with an instance of\n\t * the Sprite class(instead of using the SimpleButton class). When you use a\n\t * Sprite instance to create a button, you can choose to decorate the button\n\t * by using the <code>addChild()</code> method to add additional Sprite\n\t * instances. This process can cause unexpected behavior with mouse events\n\t * because the Sprite instances you add as children can become the target\n\t * object of a mouse event when you expect the parent instance to be the\n\t * target object. To ensure that the parent instance serves as the target\n\t * objects for mouse events, you can set the <code>mouseChildren</code>\n\t * property of the parent instance to <code>false</code>.</p>\n\t *\n\t * <p> No event is dispatched by setting this property. You must use the\n\t * <code>addEventListener()</code> method to create interactive\n\t * functionality.</p>\n\t */\n\tpublic get mouseChildren():boolean\n\t{\n\t\treturn this._mouseChildren;\n\t}\n\n\tpublic set mouseChildren(value:boolean)\n\t{\n\t\tif (this._mouseChildren == value)\n\t\t\treturn;\n\n\t\tthis._mouseChildren = value;\n\n\t\tthis._pUpdateImplicitMouseEnabled(this._pParent? this._pParent.mouseChildren : true);\n\t}\n\n\t/**\n\t * Returns the number of children of this object.\n\t */\n\tpublic get numChildren():number /*int*/\n\t{\n\t\treturn this._children.length;\n\t}\n\n\t/**\n\t * Determines whether the children of the object are tab enabled. Enables or\n\t * disables tabbing for the children of the object. The default is\n\t * <code>true</code>.\n\t *\n\t * <p><b>Note:</b> Do not use the <code>tabChildren</code> property with\n\t * Flex. Instead, use the\n\t * <code>mx.core.UIComponent.hasFocusableChildren</code> property.</p>\n\t *\n\t * @throws IllegalOperationError Calling this property of the Stage object\n\t *                               throws an exception. The Stage object does\n\t *                               not implement this property.\n\t */\n\tpublic tabChildren:boolean;\n\n\t/**\n\t * Calling the <code>new DisplayObjectContainer()</code> constructor throws\n\t * an <code>ArgumentError</code> exception. You <i>can</i>, however, call\n\t * constructors for the following subclasses of DisplayObjectContainer:\n\t * <ul>\n\t *   <li><code>new Loader()</code></li>\n\t *   <li><code>new Sprite()</code></li>\n\t *   <li><code>new MovieClip()</code></li>\n\t * </ul>\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Adds a child DisplayObject instance to this DisplayObjectContainer\n\t * instance. The child is added to the front(top) of all other children in\n\t * this DisplayObjectContainer instance.(To add a child to a specific index\n\t * position, use the <code>addChildAt()</code> method.)\n\t *\n\t * <p>If you add a child object that already has a different display object\n\t * container as a parent, the object is removed from the child list of the\n\t * other display object container. </p>\n\t *\n\t * <p><b>Note:</b> The command <code>stage.addChild()</code> can cause\n\t * problems with a published SWF file, including security problems and\n\t * conflicts with other loaded SWF files. There is only one Stage within a\n\t * Flash runtime instance, no matter how many SWF files you load into the\n\t * runtime. So, generally, objects should not be added to the Stage,\n\t * directly, at all. The only object the Stage should contain is the root\n\t * object. Create a DisplayObjectContainer to contain all of the items on the\n\t * display list. Then, if necessary, add that DisplayObjectContainer instance\n\t * to the Stage.</p>\n\t *\n\t * @param child The DisplayObject instance to add as a child of this\n\t *              DisplayObjectContainer instance.\n\t * @return The DisplayObject instance that you pass in the <code>child</code>\n\t *         parameter.\n\t * @throws ArgumentError Throws if the child is the same as the parent. Also\n\t *                       throws if the caller is a child(or grandchild etc.)\n\t *                       of the child being added.\n\t * @event added Dispatched when a display object is added to the display\n\t *              list.\n\t */\n\tpublic addChild(child:DisplayObject):DisplayObject\n\t{\n\t\tif (child == null)\n\t\t\tthrow new Error(\"Parameter child cannot be null.\");\n\n\t\t//if child already has a parent, remove it.\n\t\tif (child._pParent)\n\t\t\tchild._pParent.removeChildInternal(child);\n\n\t\tchild.iSetParent(this);\n\n\t\tthis._children.push(child);\n\n\t\treturn child;\n\t}\n\n\n\t/**\n\t * Adds a child DisplayObject instance to this DisplayObjectContainer\n\t * instance. The child is added at the index position specified. An index of\n\t * 0 represents the back(bottom) of the display list for this\n\t * DisplayObjectContainer object.\n\t *\n\t * <p>For example, the following example shows three display objects, labeled\n\t * a, b, and c, at index positions 0, 2, and 1, respectively:</p>\n\t *\n\t * <p>If you add a child object that already has a different display object\n\t * container as a parent, the object is removed from the child list of the\n\t * other display object container. </p>\n\t *\n\t * @param child The DisplayObject instance to add as a child of this\n\t *              DisplayObjectContainer instance.\n\t * @param index The index position to which the child is added. If you\n\t *              specify a currently occupied index position, the child object\n\t *              that exists at that position and all higher positions are\n\t *              moved up one position in the child list.\n\t * @return The DisplayObject instance that you pass in the <code>child</code>\n\t *         parameter.\n\t * @throws ArgumentError Throws if the child is the same as the parent. Also\n\t *                       throws if the caller is a child(or grandchild etc.)\n\t *                       of the child being added.\n\t * @throws RangeError    Throws if the index position does not exist in the\n\t *                       child list.\n\t * @event added Dispatched when a display object is added to the display\n\t *              list.\n\t */\n\tpublic addChildAt(child:DisplayObject, index:number /*int*/):DisplayObject\n\t{\n\t\treturn child;\n\t}\n\n\tpublic addChildren(...childarray:Array<DisplayObject>)\n\t{\n\t\tvar len:number = childarray.length;\n\t\tfor (var i:number = 0; i <  len; i++)\n\t\t\tthis.addChild(childarray[i]);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clone():DisplayObject\n\t{\n\t\tvar clone:DisplayObjectContainer = new DisplayObjectContainer();\n\t\tclone.pivot = this.pivot;\n\t\tclone._iMatrix3D = this._iMatrix3D;\n\t\tclone.partition = this.partition;\n\t\tclone.name = name;\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tclone.addChild(this._children[i].clone());\n\n\t\t// todo: implement for all subtypes\n\t\treturn clone;\n\t}\n\n\t/**\n\t * Determines whether the specified display object is a child of the\n\t * DisplayObjectContainer instance or the instance itself. The search\n\t * includes the entire display list including this DisplayObjectContainer\n\t * instance. Grandchildren, great-grandchildren, and so on each return\n\t * <code>true</code>.\n\t *\n\t * @param child The child object to test.\n\t * @return <code>true</code> if the <code>child</code> object is a child of\n\t *         the DisplayObjectContainer or the container itself; otherwise\n\t *         <code>false</code>.\n\t */\n\tpublic contains(child:DisplayObject):boolean\n\t{\n\t\treturn this._children.indexOf(child) >= 0;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic disposeWithChildren()\n\t{\n\t\tthis.dispose();\n\n\t\twhile (this.numChildren > 0)\n\t\t\tthis.getChildAt(0).dispose();\n\t}\n\n\t/**\n\t * Returns the child display object instance that exists at the specified\n\t * index.\n\t *\n\t * @param index The index position of the child object.\n\t * @return The child display object at the specified index position.\n\t * @throws RangeError    Throws if the index does not exist in the child\n\t *                       list.\n\t */\n\tpublic getChildAt(index:number /*int*/):DisplayObject\n\t{\n\t\tvar child:DisplayObject = this._children[index];\n\n\t\tif (child == null)\n\t\t\tthrow new RangeError(\"Index does not exist in the child list of the caller\");\n\n\t\treturn child;\n\t}\n\n\t/**\n\t * Returns the child display object that exists with the specified name. If\n\t * more that one child display object has the specified name, the method\n\t * returns the first object in the child list.\n\t *\n\t * <p>The <code>getChildAt()</code> method is faster than the\n\t * <code>getChildByName()</code> method. The <code>getChildAt()</code> method\n\t * accesses a child from a cached array, whereas the\n\t * <code>getChildByName()</code> method has to traverse a linked list to\n\t * access a child.</p>\n\t *\n\t * @param name The name of the child to return.\n\t * @return The child display object with the specified name.\n\t */\n\tpublic getChildByName(name:string):DisplayObject\n\t{\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tif (this._children[i].name == name)\n\t\t\t\treturn this._children[i];\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the index position of a <code>child</code> DisplayObject instance.\n\t *\n\t * @param child The DisplayObject instance to identify.\n\t * @return The index position of the child display object to identify.\n\t * @throws ArgumentError Throws if the child parameter is not a child of this\n\t *                       object.\n\t */\n\tpublic getChildIndex(child:DisplayObject):number /*int*/\n\t{\n\t\tvar childIndex:number = this._children.indexOf(child);\n\n\t\tif (childIndex == -1)\n\t\t\tthrow new ArgumentError(\"Child parameter is not a child of the caller\");\n\n\t\treturn childIndex;\n\t}\n\n\t/**\n\t * Returns an array of objects that lie under the specified point and are\n\t * children(or grandchildren, and so on) of this DisplayObjectContainer\n\t * instance. Any child objects that are inaccessible for security reasons are\n\t * omitted from the returned array. To determine whether this security\n\t * restriction affects the returned array, call the\n\t * <code>areInaccessibleObjectsUnderPoint()</code> method.\n\t *\n\t * <p>The <code>point</code> parameter is in the coordinate space of the\n\t * Stage, which may differ from the coordinate space of the display object\n\t * container(unless the display object container is the Stage). You can use\n\t * the <code>globalToLocal()</code> and the <code>localToGlobal()</code>\n\t * methods to convert points between these coordinate spaces.</p>\n\t *\n\t * @param point The point under which to look.\n\t * @return An array of objects that lie under the specified point and are\n\t *         children(or grandchildren, and so on) of this\n\t *         DisplayObjectContainer instance.\n\t */\n\tpublic getObjectsUnderPoint(point:Point):Array<DisplayObject>\n\t{\n\t\treturn new Array<DisplayObject>();\n\t}\n\n\t/**\n\t * Removes the specified <code>child</code> DisplayObject instance from the\n\t * child list of the DisplayObjectContainer instance. The <code>parent</code>\n\t * property of the removed child is set to <code>null</code> , and the object\n\t * is garbage collected if no other references to the child exist. The index\n\t * positions of any display objects above the child in the\n\t * DisplayObjectContainer are decreased by 1.\n\t *\n\t * <p>The garbage collector reallocates unused memory space. When a variable\n\t * or object is no longer actively referenced or stored somewhere, the\n\t * garbage collector sweeps through and wipes out the memory space it used to\n\t * occupy if no other references to it exist.</p>\n\t *\n\t * @param child The DisplayObject instance to remove.\n\t * @return The DisplayObject instance that you pass in the <code>child</code>\n\t *         parameter.\n\t * @throws ArgumentError Throws if the child parameter is not a child of this\n\t *                       object.\n\t */\n\tpublic removeChild(child:DisplayObject):DisplayObject\n\t{\n\t\tif (child == null)\n\t\t\tthrow new Error(\"Parameter child cannot be null\");\n\n\t\tthis.removeChildInternal(child);\n\n\t\tchild.iSetParent(null);\n\n\t\treturn child;\n\t}\n\n\t/**\n\t * Removes a child DisplayObject from the specified <code>index</code>\n\t * position in the child list of the DisplayObjectContainer. The\n\t * <code>parent</code> property of the removed child is set to\n\t * <code>null</code>, and the object is garbage collected if no other\n\t * references to the child exist. The index positions of any display objects\n\t * above the child in the DisplayObjectContainer are decreased by 1.\n\t *\n\t * <p>The garbage collector reallocates unused memory space. When a variable\n\t * or object is no longer actively referenced or stored somewhere, the\n\t * garbage collector sweeps through and wipes out the memory space it used to\n\t * occupy if no other references to it exist.</p>\n\t *\n\t * @param index The child index of the DisplayObject to remove.\n\t * @return The DisplayObject instance that was removed.\n\t * @throws RangeError    Throws if the index does not exist in the child\n\t *                       list.\n\t * @throws SecurityError This child display object belongs to a sandbox to\n\t *                       which the calling object does not have access. You\n\t *                       can avoid this situation by having the child movie\n\t *                       call the <code>Security.allowDomain()</code> method.\n\t */\n\tpublic removeChildAt(index:number /*int*/):DisplayObject\n\t{\n\t\treturn this.removeChild(this._children[index]);\n\t}\n\n\t/**\n\t * Removes all <code>child</code> DisplayObject instances from the child list\n\t * of the DisplayObjectContainer instance. The <code>parent</code> property\n\t * of the removed children is set to <code>null</code>, and the objects are\n\t * garbage collected if no other references to the children exist.\n\t *\n\t * The garbage collector reallocates unused memory space. When a variable or\n\t * object is no longer actively referenced or stored somewhere, the garbage\n\t * collector sweeps through and wipes out the memory space it used to occupy\n\t * if no other references to it exist.\n\t *\n\t * @param beginIndex The beginning position. A value smaller than 0 throws a RangeError.\n\t * @param endIndex The ending position. A value smaller than 0 throws a RangeError.\n\t * @throws RangeError    Throws if the beginIndex or endIndex positions do\n\t *                       not exist in the child list.\n\t */\n\tpublic removeChildren(beginIndex:number /*int*/ = 0, endIndex:number /*int*/ = 2147483647)\n\t{\n\t\tif (beginIndex < 0)\n\t\t\tthrow new RangeError(\"beginIndex is out of range of the child list\");\n\n\t\tif (endIndex > this._children.length)\n\t\t\tthrow new RangeError(\"endIndex is out of range of the child list\");\n\n\t\tfor(var i:number /*uint*/ = beginIndex; i < endIndex; i++)\n\t\t\tthis.removeChild(this._children[i]);\n\t}\n\n\t/**\n\t * Changes the position of an existing child in the display object container.\n\t * This affects the layering of child objects. For example, the following\n\t * example shows three display objects, labeled a, b, and c, at index\n\t * positions 0, 1, and 2, respectively:\n\t *\n\t * <p>When you use the <code>setChildIndex()</code> method and specify an\n\t * index position that is already occupied, the only positions that change\n\t * are those in between the display object's former and new position. All\n\t * others will stay the same. If a child is moved to an index LOWER than its\n\t * current index, all children in between will INCREASE by 1 for their index\n\t * reference. If a child is moved to an index HIGHER than its current index,\n\t * all children in between will DECREASE by 1 for their index reference. For\n\t * example, if the display object container in the previous example is named\n\t * <code>container</code>, you can swap the position of the display objects\n\t * labeled a and b by calling the following code:</p>\n\t *\n\t * <p>This code results in the following arrangement of objects:</p>\n\t *\n\t * @param child The child DisplayObject instance for which you want to change\n\t *              the index number.\n\t * @param index The resulting index number for the <code>child</code> display\n\t *              object.\n\t * @throws ArgumentError Throws if the child parameter is not a child of this\n\t *                       object.\n\t * @throws RangeError    Throws if the index does not exist in the child\n\t *                       list.\n\t */\n\tpublic setChildIndex(child:DisplayObject, index:number /*int*/)\n\t{\n\t\t//TODO\n\t}\n\n\t/**\n\t * Swaps the z-order (front-to-back order) of the two specified child\n\t * objects. All other child objects in the display object container remain in\n\t * the same index positions.\n\t *\n\t * @param child1 The first child object.\n\t * @param child2 The second child object.\n\t * @throws ArgumentError Throws if either child parameter is not a child of\n\t *                       this object.\n\t */\n\tpublic swapChildren(child1:DisplayObject, child2:DisplayObject)\n\t{\n\t\t//TODO\n\t}\n\n\t/**\n\t * Swaps the z-order(front-to-back order) of the child objects at the two\n\t * specified index positions in the child list. All other child objects in\n\t * the display object container remain in the same index positions.\n\t *\n\t * @param index1 The index position of the first child object.\n\t * @param index2 The index position of the second child object.\n\t * @throws RangeError If either index does not exist in the child list.\n\t */\n\tpublic swapChildrenAt(index1:number /*int*/, index2:number /*int*/)\n\t{\n\t\t//TODO\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateSceneTransform()\n\t{\n\t\tsuper.pInvalidateSceneTransform();\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._children[i].pInvalidateSceneTransform();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateScene(value:Scene)\n\t{\n\t\tsuper._pUpdateScene(value);\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._children[i]._pUpdateScene(value);\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitMouseEnabled(value:boolean)\n\t{\n\t\tsuper._pUpdateImplicitMouseEnabled(value);\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._children[i]._pUpdateImplicitMouseEnabled(this._mouseChildren);\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitVisibility(value:boolean)\n\t{\n\t\tsuper._pUpdateImplicitVisibility(value);\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._children[i]._pUpdateImplicitVisibility(this._pImplicitVisibility);\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic _pUpdateImplicitPartition(value:Partition)\n\t{\n\t\tsuper._pUpdateImplicitPartition(value);\n\n\t\tvar len:number = this._children.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._children[i]._pUpdateImplicitPartition(this._pImplicitPartition);\n\t}\n\n\t/**\n\t * @private\n\t *\n\t * @param child\n\t */\n\tprivate removeChildInternal(child:DisplayObject):DisplayObject\n\t{\n\t\tthis._children.splice(this.getChildIndex(child), 1);\n\n\t\treturn child;\n\t}\n}\n\nexport = DisplayObjectContainer;",
    "import EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\n\nimport DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport DisplayObjectContainer\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport SceneEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/SceneEvent\");\nimport NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport Partition\t\t\t\t\t= require(\"awayjs-display/lib/partition/Partition\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\n\nclass Scene extends EventDispatcher\n{\n\tprivate _expandedPartitions:Array<Partition> = new Array<Partition>();\n\tprivate _partitions:Array<Partition> = new Array<Partition>();\n\n\tpublic _iSceneGraphRoot:DisplayObjectContainer;\n\tpublic _iCollectionMark = 0;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._iSceneGraphRoot = new DisplayObjectContainer();\n\n\t\tthis._iSceneGraphRoot._iSetScene(this);\n\t\tthis._iSceneGraphRoot._iIsRoot = true;\n\t\tthis._iSceneGraphRoot.partition = new Partition(new NodeBase());\n\t}\n\n\tpublic traversePartitions(traverser:ICollector)\n\t{\n\t\tvar i:number = 0;\n\t\tvar len:number = this._partitions.length;\n\n\t\ttraverser.scene = this;\n\n\t\twhile (i < len) {\n\t\t\tthis._iCollectionMark++;\n\t\t\tthis._partitions[i++].traverse(traverser);\n\t\t}\n\t}\n\n\tpublic get partition():Partition\n\t{\n\t\treturn this._iSceneGraphRoot.partition;\n\t}\n\n\tpublic set partition(value:Partition)\n\t{\n\t\tthis._iSceneGraphRoot.partition = value;\n\n\t\tthis.dispatchEvent(new SceneEvent(SceneEvent.PARTITION_CHANGED, this._iSceneGraphRoot));\n\t}\n\n\tpublic contains(child:DisplayObject):boolean\n\t{\n\t\treturn this._iSceneGraphRoot.contains(child);\n\t}\n\n\tpublic addChild(child:DisplayObject):DisplayObject\n\t{\n\t\treturn this._iSceneGraphRoot.addChild(child);\n\t}\n\n\tpublic removeChild(child:DisplayObject)\n\t{\n\t\tthis._iSceneGraphRoot.removeChild(child);\n\t}\n\n\tpublic removeChildAt(index:number)\n\t{\n\t\tthis._iSceneGraphRoot.removeChildAt(index);\n\t}\n\n\n\tpublic getChildAt(index:number):DisplayObject\n\t{\n\t\treturn this._iSceneGraphRoot.getChildAt(index);\n\t}\n\n\tpublic get numChildren():number\n\t{\n\t\treturn this._iSceneGraphRoot.numChildren;\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic iRegisterEntity(displayObject:DisplayObject)\n\t{\n\t\tif (displayObject.partition)\n\t\t\tthis.iRegisterPartition(displayObject.partition);\n\n\t\tif (displayObject.isEntity)\n\t\t\tdisplayObject._iAssignedPartition.iMarkForUpdate(displayObject);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic iRegisterPartition(partition:Partition)\n\t{\n\t\tthis._expandedPartitions.push(partition);\n\n\t\t//ensure duplicates are not found in partitions array\n\t\tif (this._partitions.indexOf(partition) == -1)\n\t\t\tthis._partitions.push(partition);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic iUnregisterEntity(displayObject:DisplayObject)\n\t{\n\t\tif (displayObject.partition)\n\t\t\tthis.iUnregisterPartition(displayObject.partition);\n\n\t\tif (displayObject.isEntity)\n\t\t\tdisplayObject._iAssignedPartition.iRemoveEntity(displayObject);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic iUnregisterPartition(partition:Partition)\n\t{\n\t\tthis._expandedPartitions.splice(this._expandedPartitions.indexOf(partition), 1);\n\n\t\t//if no more partition references found, remove from partitions array\n\t\tif (this._expandedPartitions.indexOf(partition) == -1)\n\t\t\tthis._partitions.splice(this._partitions.indexOf(partition), 1);\n\t}\n}\n\nexport = Scene;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport getTimer\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/getTimer\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport IPicker\t\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPicker\");\nimport PickingCollisionVO\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport RaycastPicker\t\t\t\t= require(\"awayjs-display/lib/pick/RaycastPicker\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport CSSRendererBase\t\t\t\t= require(\"awayjs-display/lib/render/CSSRendererBase\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport CameraEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/CameraEvent\");\nimport SceneEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/SceneEvent\");\nimport RendererEvent\t\t\t\t= require(\"awayjs-display/lib/events/RendererEvent\");\nimport MouseManager\t\t\t\t\t= require(\"awayjs-display/lib/managers/MouseManager\");\n\nclass View\n{\n\n\t/*\n\t *************************************************************************************************************************\n\t * Development Notes\n\t *************************************************************************************************************************\n\t *\n\t * ShareContext     - this is not being used at the moment integration with other frameworks is not yet implemented or tested\n\t *                    and ( _localPos / _globalPos ) position of viewport are the same for the moment\n\t *\n\t * Background\n\t *                  - this is currently not being included in our tests and is currently disabled\n\t *\n\t **************************************************************************************************************************\n\t */\n\n\t// Protected\n\tpublic _pScene:Scene;\n\tpublic _pCamera:Camera;\n\tpublic _pEntityCollector:ICollector;\n\tpublic _pRenderer:IRenderer;\n\n\t// Private\n\tprivate _aspectRatio:number;\n\tprivate _width:number = 0;\n\tprivate _height:number = 0;\n\n\tprivate _time:number = 0;\n\tprivate _deltaTime:number = 0;\n\tprivate _backgroundColor:number = 0x000000;\n\tprivate _backgroundAlpha:number = 1;\n\n\tprivate _viewportDirty:boolean = true;\n\tprivate _scissorDirty:boolean = true;\n\n\tprivate _onScenePartitionChangedDelegate:(event:SceneEvent) => void;\n\tprivate _onProjectionChangedDelegate:(event:CameraEvent) => void;\n\tprivate _onViewportUpdatedDelegate:(event:RendererEvent) => void;\n\tprivate _onScissorUpdatedDelegate:(event:RendererEvent) => void;\n\tprivate _mouseManager:MouseManager;\n\tprivate _mousePicker:IPicker = new RaycastPicker();\n\n\tprivate _htmlElement:HTMLDivElement;\n\tprivate _shareContext:boolean;\n\tpublic _pMouseX:number;\n\tpublic _pMouseY:number;\n\n\t/*\n\t ***********************************************************************\n\t * Disabled / Not yet implemented\n\t ***********************************************************************\n\t *\n\t * private _background:away.textures.Texture2DBase;\n\t *\n\t * public _pTouch3DManager:away.managers.Touch3DManager;\n\t *\n\t */\n\tconstructor(renderer:IRenderer, scene:Scene = null, camera:Camera = null)\n\t{\n\t\tthis._onScenePartitionChangedDelegate = (event:SceneEvent) => this.onScenePartitionChanged(event);\n\t\tthis._onProjectionChangedDelegate = (event:CameraEvent) => this.onProjectionChanged(event);\n\t\tthis._onViewportUpdatedDelegate = (event:RendererEvent) => this.onViewportUpdated(event);\n\t\tthis._onScissorUpdatedDelegate = (event:RendererEvent) => this.onScissorUpdated(event);\n\n\t\tthis.scene = scene || new Scene();\n\t\tthis.camera = camera || new Camera();\n\t\tthis.renderer = renderer;\n\n\t\t//make sure document border is zero\n\t\tdocument.body.style.margin = \"0px\";\n\n\t\tthis._htmlElement = document.createElement(\"div\");\n\t\tthis._htmlElement.style.position = \"absolute\";\n\n\t\tdocument.body.appendChild(this._htmlElement);\n\n\t\tthis._mouseManager = MouseManager.getInstance();\n\t\tthis._mouseManager.registerView(this);\n\n//\t\t\tif (this._shareContext)\n//\t\t\t\tthis._mouse3DManager.addViewLayer(this);\n\t}\n\n\t/**\n\t *\n\t * @param e\n\t */\n\tprivate onScenePartitionChanged(event:SceneEvent)\n\t{\n\t\tif (this._pCamera)\n\t\t\tthis._pCamera.partition = this.scene.partition;\n\t}\n\n\tpublic layeredView:boolean; //TODO: something to enable this correctly\n\n\tpublic get mouseX():number\n\t{\n\t\treturn this._pMouseX;\n\t}\n\n\tpublic get mouseY():number\n\t{\n\t\treturn this._pMouseY;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get htmlElement():HTMLDivElement\n\t{\n\t\treturn this._htmlElement;\n\t}\n\t/**\n\t *\n\t */\n\tpublic get renderer():IRenderer\n\t{\n\t\treturn this._pRenderer;\n\t}\n\n\tpublic set renderer(value:IRenderer)\n\t{\n\t\tif (this._pRenderer == value)\n\t\t\treturn;\n\n\t\tif (this._pRenderer) {\n\t\t\tthis._pRenderer.dispose();\n\t\t\tthis._pRenderer.removeEventListener(RendererEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\t\t\tthis._pRenderer.removeEventListener(RendererEvent.SCISSOR_UPDATED, this._onScissorUpdatedDelegate);\n\t\t}\n\n\t\tthis._pRenderer = value;\n\n\t\tthis._pRenderer.addEventListener(RendererEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\t\tthis._pRenderer.addEventListener(RendererEvent.SCISSOR_UPDATED, this._onScissorUpdatedDelegate);\n\n\t\t//reset entity collector\n\t\tthis._pEntityCollector = this._pRenderer._iCreateEntityCollector();\n\n\t\tif (this._pCamera)\n\t\t\tthis._pEntityCollector.camera = this._pCamera;\n\n\t\t//reset back buffer\n\t\tthis._pRenderer._iBackgroundR = ((this._backgroundColor >> 16) & 0xff)/0xff;\n\t\tthis._pRenderer._iBackgroundG = ((this._backgroundColor >> 8) & 0xff)/0xff;\n\t\tthis._pRenderer._iBackgroundB = (this._backgroundColor & 0xff)/0xff;\n\t\tthis._pRenderer._iBackgroundAlpha = this._backgroundAlpha;\n\t\tthis._pRenderer.width = this._width;\n\t\tthis._pRenderer.height = this._height;\n\t\tthis._pRenderer.shareContext = this._shareContext;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get shareContext():boolean\n\t{\n\t\treturn this._shareContext;\n\t}\n\n\tpublic set shareContext(value:boolean)\n\t{\n\t\tif (this._shareContext == value)\n\t\t\treturn;\n\n\t\tthis._shareContext = value;\n\n\t\tif (this._pRenderer)\n\t\t\tthis._pRenderer.shareContext = this._shareContext;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get backgroundColor():number\n\t{\n\t\treturn this._backgroundColor;\n\t}\n\n\tpublic set backgroundColor(value:number)\n\t{\n\t\tif (this._backgroundColor == value)\n\t\t\treturn;\n\n\t\tthis._backgroundColor = value;\n\n\t\tthis._pRenderer._iBackgroundR = ((value >> 16) & 0xff)/0xff;\n\t\tthis._pRenderer._iBackgroundG = ((value >> 8) & 0xff)/0xff;\n\t\tthis._pRenderer._iBackgroundB = (value & 0xff)/0xff;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get backgroundAlpha():number\n\t{\n\t\treturn this._backgroundAlpha;\n\t}\n\n\t/**\n\t *\n\t * @param value\n\t */\n\tpublic set backgroundAlpha(value:number)\n\t{\n\t\tif (value > 1)\n\t\t\tvalue = 1;\n\t\telse if (value < 0)\n\t\t\tvalue = 0;\n\n\t\tif (this._backgroundAlpha == value)\n\t\t\treturn;\n\n\t\tthis._pRenderer._iBackgroundAlpha = this._backgroundAlpha = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {Camera3D}\n\t */\n\tpublic get camera():Camera\n\t{\n\t\treturn this._pCamera;\n\t}\n\n\t/**\n\t * Set camera that's used to render the scene for this viewport\n\t */\n\tpublic set camera(value:Camera)\n\t{\n\t\tif (this._pCamera == value)\n\t\t\treturn;\n\n\t\tif (this._pCamera)\n\t\t\tthis._pCamera.removeEventListener(CameraEvent.PROJECTION_CHANGED, this._onProjectionChangedDelegate);\n\n\t\tthis._pCamera = value;\n\n\t\tif (this._pEntityCollector)\n\t\t\tthis._pEntityCollector.camera = this._pCamera;\n\n\t\tif (this._pScene)\n\t\t\tthis._pCamera.partition = this._pScene.partition;\n\n\t\tthis._pCamera.addEventListener(CameraEvent.PROJECTION_CHANGED, this._onProjectionChangedDelegate);\n\t\tthis._scissorDirty = true;\n\t\tthis._viewportDirty = true;\n\t}\n\n\t/**\n\t *\n\t * @returns {away.containers.Scene3D}\n\t */\n\tpublic get scene():Scene\n\t{\n\t\treturn this._pScene;\n\t}\n\n\t/**\n\t * Set the scene that's used to render for this viewport\n\t */\n\tpublic set scene(value:Scene)\n\t{\n\t\tif (this._pScene == value)\n\t\t\treturn;\n\n\t\tif (this._pScene)\n\t\t\tthis._pScene.removeEventListener(SceneEvent.PARTITION_CHANGED, this._onScenePartitionChangedDelegate);\n\n\t\tthis._pScene = value;\n\n\t\tthis._pScene.addEventListener(SceneEvent.PARTITION_CHANGED, this._onScenePartitionChangedDelegate);\n\n\t\tif (this._pCamera)\n\t\t\tthis._pCamera.partition = this._pScene.partition;\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get deltaTime():number\n\t{\n\t\treturn this._deltaTime;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (this._width == value)\n\t\t\treturn;\n\n\t\tthis._width = value;\n\t\tthis._aspectRatio = this._width/this._height;\n\t\tthis._pCamera.projection._iAspectRatio = this._aspectRatio;\n\t\tthis._pRenderer.width = value;\n\t\tthis._htmlElement.style.width = value + \"px\";\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (this._height == value)\n\t\t\treturn;\n\n\t\tthis._height = value;\n\t\tthis._aspectRatio = this._width/this._height;\n\t\tthis._pCamera.projection._iAspectRatio = this._aspectRatio;\n\t\tthis._pRenderer.height = value;\n\t\tthis._htmlElement.style.height = value + \"px\";\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get mousePicker():IPicker\n\t{\n\t\treturn this._mousePicker;\n\t}\n\n\tpublic set mousePicker(value:IPicker)\n\t{\n\t\tif (this._mousePicker == value)\n\t\t\treturn;\n\n\t\tif (value == null)\n\t\t\tthis._mousePicker = new RaycastPicker();\n\t\telse\n\t\t\tthis._mousePicker = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._pRenderer.x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tif (this._pRenderer.x == value)\n\t\t\treturn;\n\n\t\tthis._pRenderer.x == value;\n\t\tthis._htmlElement.style.left = value + \"px\";\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._pRenderer.y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tif (this._pRenderer.y == value)\n\t\t\treturn;\n\n\t\tthis._pRenderer.y == value;\n\t\tthis._htmlElement.style.top = value + \"px\";\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get visible():boolean\n\t{\n\t\treturn (this._htmlElement.style.visibility == \"visible\");\n\t}\n\n\tpublic set visible(value:boolean)\n\t{\n\t\tthis._htmlElement.style.visibility = value? \"visible\" : \"hidden\";\n\t\t//TODO transfer visible property to associated context (if one exists)\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get renderedFacesCount():number\n\t{\n\t\treturn 0; //TODO\n\t\t//return this._pEntityCollector._pNumTriangles;//numTriangles;\n\t}\n\n\t/**\n\t * Renders the view.\n\t */\n\tpublic render()\n\t{\n\t\tthis.pUpdateTime();\n\n\t\t//update view and size data\n\t\tthis._pCamera.projection._iAspectRatio = this._aspectRatio;\n\n\t\tif (this._scissorDirty) {\n\t\t\tthis._scissorDirty = false;\n\t\t\tthis._pCamera.projection._iUpdateScissorRect(this._pRenderer.scissorRect.x, this._pRenderer.scissorRect.y, this._pRenderer.scissorRect.width, this._pRenderer.scissorRect.height);\n\t\t}\n\n\t\tif (this._viewportDirty) {\n\t\t\tthis._viewportDirty = false;\n\t\t\tthis._pCamera.projection._iUpdateViewport(this._pRenderer.viewPort.x, this._pRenderer.viewPort.y, this._pRenderer.viewPort.width, this._pRenderer.viewPort.height);\n\t\t}\n\n\t\t// update picking\n\t\tif (!this._shareContext) {\n\t\t\tif (this.forceMouseMove && this._htmlElement == this._mouseManager._iActiveDiv && !this._mouseManager._iUpdateDirty)\n\t\t\t\tthis._mouseManager._iCollidingObject = this.mousePicker.getViewCollision(this._pMouseX, this._pMouseY, this);\n\n\t\t\tthis._mouseManager.fireMouseEvents(this.forceMouseMove);\n\t\t\t//_touch3DManager.fireTouchEvents();\n\t\t}\n\t\t//_touch3DManager.updateCollider();\n\n\t\t//clear entity collector ready for collection\n\t\tthis._pEntityCollector.clear();\n\n\t\t// collect stuff to render\n\t\tthis._pScene.traversePartitions(this._pEntityCollector);\n\n\t\t//render the contents of the entity collector\n\t\tthis._pRenderer.render(this._pEntityCollector);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic pUpdateTime():void\n\t{\n\t\tvar time:number = getTimer();\n\n\t\tif (this._time == 0)\n\t\t\tthis._time = time;\n\n\t\tthis._deltaTime = time - this._time;\n\t\tthis._time = time;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRenderer.dispose();\n\n\t\t// TODO: imeplement mouseManager / touch3DManager\n\t\tthis._mouseManager.unregisterView(this);\n\n\t\t//this._touch3DManager.disableTouchListeners(this);\n\t\t//this._touch3DManager.dispose();\n\n\t\tthis._mouseManager = null;\n\t\t//this._touch3DManager = null;\n\n\t\tthis._pRenderer = null;\n\t\tthis._pEntityCollector = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get iEntityCollector():ICollector\n\t{\n\t\treturn this._pEntityCollector;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate onProjectionChanged(event:CameraEvent)\n\t{\n\t\tthis._scissorDirty = true;\n\t\tthis._viewportDirty = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate onViewportUpdated(event:RendererEvent)\n\t{\n\t\tthis._viewportDirty = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate onScissorUpdated(event:RendererEvent)\n\t{\n\t\tthis._scissorDirty = true;\n\t}\n\n\tpublic project(point3d:Vector3D):Vector3D\n\t{\n\t\tvar v:Vector3D = this._pCamera.project(point3d);\n\t\tv.x = v.x*this._pRenderer.viewPort.width/2 + this._width*this._pCamera.projection.originX;\n\t\tv.y = v.y*this._pRenderer.viewPort.height/2 + this._height*this._pCamera.projection.originY;\n\n\t\treturn v;\n\t}\n\n\tpublic unproject(sX:number, sY:number, sZ:number):Vector3D\n\t{\n\t\treturn this._pCamera.unproject(2*(sX - this._width*this._pCamera.projection.originX)/this._pRenderer.viewPort.width, 2*(sY - this._height*this._pCamera.projection.originY)/this._pRenderer.viewPort.height, sZ);\n\n\t}\n\n\tpublic getRay(sX:number, sY:number, sZ:number):Vector3D\n\t{\n\t\treturn this._pCamera.getRay((sX*2 - this._width)/this._width, (sY*2 - this._height)/this._height, sZ);\n\t}\n\n\t/* TODO: implement Touch3DManager\n\t public get touchPicker():IPicker\n\t {\n\t return this._touch3DManager.touchPicker;\n\t }\n\t */\n\t/* TODO: implement Touch3DManager\n\t public set touchPicker( value:IPicker)\n\t {\n\t this._touch3DManager.touchPicker = value;\n\t }\n\t */\n\n\tpublic forceMouseMove:boolean;\n\n\t/*TODO: implement Background\n\t public get background():away.textures.Texture2DBase\n\t {\n\t return this._background;\n\t }\n\t */\n\t/*TODO: implement Background\n\t public set background( value:away.textures.Texture2DBase )\n\t {\n\t this._background = value;\n\t this._renderer.background = _background;\n\t }\n\t */\n\n\t// TODO: required dependency stageGL\n\tpublic updateCollider()\n\t{\n\t\tif (!this._shareContext) {\n\t\t\tif (this._htmlElement == this._mouseManager._iActiveDiv)\n\t\t\t\tthis._mouseManager._iCollidingObject = this.mousePicker.getViewCollision(this._pMouseX, this._pMouseY, this);\n\t\t} else {\n\t\t\tvar collidingObject:PickingCollisionVO = this.mousePicker.getViewCollision(this._pMouseX, this._pMouseY, this);\n\n\t\t\tif (this.layeredView || this._mouseManager._iCollidingObject == null || collidingObject.rayEntryDistance < this._mouseManager._iCollidingObject.rayEntryDistance)\n\t\t\t\tthis._mouseManager._iCollidingObject = collidingObject;\n\t\t}\n\t}\n}\n\nexport = View;",
    "import BoundingVolumeBase\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport NullBounds\t\t\t\t= require(\"awayjs-core/lib/bounds/NullBounds\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport ProjectionEvent\t\t\t= require(\"awayjs-core/lib/events/ProjectionEvent\");\nimport IProjection\t\t\t\t= require(\"awayjs-core/lib/projections/IProjection\");\nimport PerspectiveProjection\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\n\nimport DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport IEntity\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport CameraEvent\t\t\t\t= require(\"awayjs-display/lib/events/CameraEvent\");\nimport CameraNode\t\t\t\t= require(\"awayjs-display/lib/partition/CameraNode\");\nimport EntityNode\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport IRenderer\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\n\n\nclass Camera extends DisplayObjectContainer implements IEntity\n{\n\tprivate _viewProjection:Matrix3D = new Matrix3D();\n\tprivate _viewProjectionDirty:Boolean = true;\n\tprivate _projection:IProjection;\n\tprivate _frustumPlanes:Array<Plane3D>;\n\tprivate _frustumPlanesDirty:Boolean = true;\n\tprivate _onProjectionMatrixChangedDelegate:(event:ProjectionEvent) => void;\n\n\tconstructor(projection:IProjection = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pIsEntity = true;\n\n\t\tthis._onProjectionMatrixChangedDelegate = (event:ProjectionEvent) => this.onProjectionMatrixChanged(event);\n\n\t\tthis._projection = projection || new PerspectiveProjection();\n\t\tthis._projection.addEventListener(ProjectionEvent.MATRIX_CHANGED, this._onProjectionMatrixChangedDelegate);\n\n\t\tthis._frustumPlanes = [];\n\n\t\tfor (var i:number = 0; i < 6; ++i)\n\t\t\tthis._frustumPlanes[i] = new Plane3D();\n\n\t\tthis.z = -1000;\n\n\t}\n\n\tpublic pCreateDefaultBoundingVolume():BoundingVolumeBase\n\t{\n\t\treturn new NullBounds();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\treturn new CameraNode(this);\n\t}\n\n\t//@override\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.CAMERA;\n\t}\n\n\tprivate onProjectionMatrixChanged(event:ProjectionEvent)\n\t{\n\t\tthis._viewProjectionDirty = true;\n\t\tthis._frustumPlanesDirty = true;\n\t\tthis.dispatchEvent(event);\n\t}\n\n\tpublic get frustumPlanes():Array<Plane3D>\n\t{\n\t\tif (this._frustumPlanesDirty)\n\t\t\tthis.updateFrustum();\n\n\t\treturn this._frustumPlanes;\n\t}\n\n\tprivate updateFrustum()\n\t{\n\t\tvar a:number, b:number, c:number;\n\t\t//var d : Number;\n\t\tvar c11:number, c12:number, c13:number, c14:number;\n\t\tvar c21:number, c22:number, c23:number, c24:number;\n\t\tvar c31:number, c32:number, c33:number, c34:number;\n\t\tvar c41:number, c42:number, c43:number, c44:number;\n\t\tvar p:Plane3D;\n\t\tvar raw:number[] = new Array<number>(16);\n\t\t;//new Array(16 );away.utils.Matrix3DUtils.RAW_DATA_CONTAINER;//[];\n\t\tvar invLen:number;\n\t\tthis.viewProjection.copyRawDataTo(raw);\n\n\t\tc11 = raw[0];\n\t\tc12 = raw[4];\n\t\tc13 = raw[8];\n\t\tc14 = raw[12];\n\t\tc21 = raw[1];\n\t\tc22 = raw[5];\n\t\tc23 = raw[9];\n\t\tc24 = raw[13];\n\t\tc31 = raw[2];\n\t\tc32 = raw[6];\n\t\tc33 = raw[10];\n\t\tc34 = raw[14];\n\t\tc41 = raw[3];\n\t\tc42 = raw[7];\n\t\tc43 = raw[11];\n\t\tc44 = raw[15];\n\n\t\t// left plane\n\t\tp = this._frustumPlanes[0];\n\t\ta = c41 + c11;\n\t\tb = c42 + c12;\n\t\tc = c43 + c13;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = -(c44 + c14)*invLen;\n\n\t\t// right plane\n\t\tp = this._frustumPlanes[1];\n\t\ta = c41 - c11;\n\t\tb = c42 - c12;\n\t\tc = c43 - c13;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = (c14 - c44)*invLen;\n\n\t\t// bottom\n\t\tp = this._frustumPlanes[2];\n\t\ta = c41 + c21;\n\t\tb = c42 + c22;\n\t\tc = c43 + c23;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = -(c44 + c24)*invLen;\n\n\t\t// top\n\t\tp = this._frustumPlanes[3];\n\t\ta = c41 - c21;\n\t\tb = c42 - c22;\n\t\tc = c43 - c23;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = (c24 - c44)*invLen;\n\n\t\t// near\n\t\tp = this._frustumPlanes[4];\n\t\ta = c31;\n\t\tb = c32;\n\t\tc = c33;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = -c34*invLen;\n\n\t\t// far\n\t\tp = this._frustumPlanes[5];\n\t\ta = c41 - c31;\n\t\tb = c42 - c32;\n\t\tc = c43 - c33;\n\t\tinvLen = 1/Math.sqrt(a*a + b*b + c*c);\n\t\tp.a = a*invLen;\n\t\tp.b = b*invLen;\n\t\tp.c = c*invLen;\n\t\tp.d = (c34 - c44)*invLen;\n\n\t\tthis._frustumPlanesDirty = false;\n\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pInvalidateSceneTransform()\n\t{\n\t\tsuper.pInvalidateSceneTransform();\n\n\t\tthis._viewProjectionDirty = true;\n\t\tthis._frustumPlanesDirty = true;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pUpdateBounds()\n\t{\n\t\tthis._pBoundsInvalid = false;\n\t\tthis._pBounds.nullify();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get projection():IProjection\n\t{\n\t\treturn this._projection;\n\t}\n\n\tpublic set projection(value:IProjection)\n\t{\n\t\tif (this._projection == value)\n\t\t\treturn;\n\n\t\tif (!value)\n\t\t\tthrow new Error(\"Projection cannot be null!\");\n\n\t\tthis._projection.removeEventListener(ProjectionEvent.MATRIX_CHANGED, this._onProjectionMatrixChangedDelegate);\n\t\tthis._projection = value;\n\t\tthis._projection.addEventListener(ProjectionEvent.MATRIX_CHANGED, this._onProjectionMatrixChangedDelegate);\n\t\tthis.dispatchEvent(new CameraEvent(CameraEvent.PROJECTION_CHANGED, this));\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get viewProjection():Matrix3D\n\t{\n\t\tif (this._viewProjectionDirty) {\n\t\t\tthis._viewProjection.copyFrom(this.inverseSceneTransform);\n\t\t\tthis._viewProjection.append(this._projection.matrix);\n\t\t\tthis._viewProjectionDirty = false;\n\t\t}\n\n\t\treturn this._viewProjection;\n\t}\n\n\t/**\n\t * Calculates the ray in scene space from the camera to the given normalized coordinates in screen space.\n\t *\n\t * @param nX The normalised x coordinate in screen space, -1 corresponds to the left edge of the viewport, 1 to the right.\n\t * @param nY The normalised y coordinate in screen space, -1 corresponds to the top edge of the viewport, 1 to the bottom.\n\t * @param sZ The z coordinate in screen space, representing the distance into the screen.\n\t * @return The ray from the camera to the scene space position of the given screen coordinates.\n\t */\n\tpublic getRay(nX:number, nY:number, sZ:number):Vector3D\n\t{\n\t\treturn this.sceneTransform.deltaTransformVector(this._projection.unproject(nX, nY, sZ));\n\t}\n\n\t/**\n\t * Calculates the normalised position in screen space of the given scene position.\n\t *\n\t * @param point3d the position vector of the scene coordinates to be projected.\n\t * @return The normalised screen position of the given scene coordinates.\n\t */\n\tpublic project(point3d:Vector3D):Vector3D\n\t{\n\t\treturn this._projection.project(this.inverseSceneTransform.transformVector(point3d));\n\t}\n\n\t/**\n\t * Calculates the scene position of the given normalized coordinates in screen space.\n\t *\n\t * @param nX The normalised x coordinate in screen space, minus the originX offset of the projection property.\n\t * @param nY The normalised y coordinate in screen space, minus the originY offset of the projection property.\n\t * @param sZ The z coordinate in screen space, representing the distance into the screen.\n\t * @return The scene position of the given screen coordinates.\n\t */\n\tpublic unproject(nX:number, nY:number, sZ:number):Vector3D\n\t{\n\t\treturn this.sceneTransform.transformVector(this._projection.unproject(nX, nY, sZ));\n\t}\n\n\tpublic _iCollectRenderables(renderer:IRenderer)\n\t{\n\t\t// Since this getter is invoked every iteration of the render loop, and\n\t\t// the prefab construct could affect the sub-meshes, the prefab is\n\t\t// validated here to give it a chance to rebuild.\n\t\tif (this._iSourcePrefab)\n\t\t\tthis._iSourcePrefab._iValidate();\n\n\t\tthis._iCollectRenderable(renderer);\n\t}\n\n\tpublic _iCollectRenderable(renderer:IRenderer)\n\t{\n\t\t//nothing to do here\n\t}\n}\n\nexport = Camera;",
    "import BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport NullBounds\t\t\t\t\t= require(\"awayjs-core/lib/bounds/NullBounds\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport DirectionalLightNode\t\t\t= require(\"awayjs-display/lib/partition/DirectionalLightNode\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport DirectionalShadowMapper\t\t= require(\"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper\");\n\nclass DirectionalLight extends LightBase implements IEntity\n{\n\tprivate _direction:Vector3D;\n\tprivate _tmpLookAt:Vector3D;\n\tprivate _sceneDirection:Vector3D;\n\tprivate _projAABBPoints:Array<number>;\n\n\tconstructor(xDir:number = 0, yDir:number = -1, zDir:number = 1)\n\t{\n\t\tsuper();\n\n\t\tthis._pIsEntity = true;\n\n\t\tthis.direction = new Vector3D(xDir, yDir, zDir);\n\n\t\tthis._sceneDirection = new Vector3D();\n\t}\n\n\tpublic get sceneDirection():Vector3D\n\t{\n\t\tif (this._pSceneTransformDirty)\n\t\t\tthis.pUpdateSceneTransform();\n\n\t\treturn this._sceneDirection;\n\t}\n\n\tpublic get direction():Vector3D\n\t{\n\t\treturn this._direction;\n\t}\n\n\tpublic set direction(value:Vector3D)\n\t{\n\t\tthis._direction = value;\n\n\t\tif (!this._tmpLookAt)\n\t\t\tthis._tmpLookAt = new Vector3D();\n\n\t\tthis._tmpLookAt.x = this.x + this._direction.x;\n\t\tthis._tmpLookAt.y = this.y + this._direction.y;\n\t\tthis._tmpLookAt.z = this.z + this._direction.z;\n\n\t\tthis.lookAt(this._tmpLookAt);\n\t}\n\n\t/**\n\t *\n\t * @returns {away.bounds.NullBounds}\n\t */\n\tpublic pCreateDefaultBoundingVolume():BoundingVolumeBase\n\t{\n\t\t//directional lights are to be considered global, hence always in view\n\t\treturn new NullBounds();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic pUpdateBounds()\n\t{\n\t}\n\n\t//@override\n\tpublic pUpdateSceneTransform()\n\t{\n\t\tsuper.pUpdateSceneTransform();\n\t\tthis.sceneTransform.copyColumnTo(2, this._sceneDirection);\n\t\tthis._sceneDirection.normalize();\n\t}\n\n\t//@override\n\tpublic pCreateShadowMapper():DirectionalShadowMapper\n\t{\n\t\treturn new DirectionalShadowMapper();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\treturn new DirectionalLightNode(this);\n\t}\n\n\t//override\n\tpublic iGetObjectProjectionMatrix(entity:IEntity, camera:Camera, target:Matrix3D = null):Matrix3D\n\t{\n\t\tvar raw:Array<number> = new Array<number>();\n\t\tvar bounds:BoundingVolumeBase = entity.bounds;\n\t\tvar m:Matrix3D = new Matrix3D();\n\n\t\tm.copyFrom(entity.getRenderSceneTransform(camera));\n\t\tm.append(this.inverseSceneTransform);\n\n\t\tif (!this._projAABBPoints)\n\t\t\tthis._projAABBPoints = [];\n\n\t\tm.transformVectors(bounds.aabbPoints, this._projAABBPoints);\n\n\t\tvar xMin:number = Infinity, xMax:number = -Infinity;\n\t\tvar yMin:number = Infinity, yMax:number = -Infinity;\n\t\tvar zMin:number = Infinity, zMax:number = -Infinity;\n\t\tvar d:number;\n\t\tfor (var i:number = 0; i < 24;) {\n\t\t\td = this._projAABBPoints[i++];\n\n\t\t\tif (d < xMin)\n\t\t\t\txMin = d;\n\n\t\t\tif (d > xMax)\n\t\t\t\txMax = d;\n\n\t\t\td = this._projAABBPoints[i++];\n\n\t\t\tif (d < yMin)\n\t\t\t\tyMin = d;\n\n\t\t\tif (d > yMax)\n\t\t\t\tyMax = d;\n\n\t\t\td = this._projAABBPoints[i++];\n\n\t\t\tif (d < zMin)\n\t\t\t\tzMin = d;\n\n\t\t\tif (d > zMax)\n\t\t\t\tzMax = d;\n\t\t}\n\n\t\tvar invXRange:number = 1/(xMax - xMin);\n\t\tvar invYRange:number = 1/(yMax - yMin);\n\t\tvar invZRange:number = 1/(zMax - zMin);\n\t\traw[0] = 2*invXRange;\n\t\traw[5] = 2*invYRange;\n\t\traw[10] = invZRange;\n\t\traw[12] = -(xMax + xMin)*invXRange;\n\t\traw[13] = -(yMax + yMin)*invYRange;\n\t\traw[14] = -zMin*invZRange;\n\t\traw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = 0;\n\t\traw[15] = 1;\n\n\t\tif (!target)\n\t\t\ttarget = new Matrix3D();\n\n\t\ttarget.copyRawDataFrom(raw);\n\t\ttarget.prepend(m);\n\n\t\treturn target;\n\t}\n\n\tpublic _iCollectRenderables(renderer:IRenderer)\n\t{\n\t\t//nothing to do here\n\t}\n}\n\nexport = DirectionalLight;",
    "import BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport NullBounds\t\t\t\t\t= require(\"awayjs-core/lib/bounds/NullBounds\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Error\t\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport LightProbeNode\t\t\t\t= require(\"awayjs-display/lib/partition/LightProbeNode\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport CubeTextureBase\t\t\t\t= require(\"awayjs-core/lib/textures/CubeTextureBase\");\n\nclass LightProbe extends LightBase implements IEntity\n{\n\tprivate _diffuseMap:CubeTextureBase;\n\tprivate _specularMap:CubeTextureBase;\n\n\tconstructor(diffuseMap:CubeTextureBase, specularMap:CubeTextureBase = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pIsEntity = true;\n\n\t\tthis._diffuseMap = diffuseMap;\n\t\tthis._specularMap = specularMap;\n\t}\n\n\tpublic get diffuseMap():CubeTextureBase\n\t{\n\t\treturn this._diffuseMap;\n\t}\n\n\tpublic set diffuseMap(value:CubeTextureBase)\n\t{\n\t\tthis._diffuseMap = value;\n\t}\n\n\tpublic get specularMap():CubeTextureBase\n\t{\n\t\treturn this._specularMap;\n\t}\n\n\tpublic set specularMap(value:CubeTextureBase)\n\t{\n\t\tthis._specularMap = value;\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\treturn new LightProbeNode(this);\n\t}\n\n\t//@override\n\tpublic pUpdateBounds()\n\t{\n\t\tthis._pBoundsInvalid = false;\n\t}\n\n\t//@override\n\tpublic pCreateDefaultBoundingVolume():BoundingVolumeBase\n\t{\n\t\treturn new NullBounds();\n\t}\n\n\t//@override\n\tpublic iGetObjectProjectionMatrix(entity:IEntity, camera:Camera, target:Matrix3D = null):Matrix3D\n\t{\n\t\tthrow new Error(\"Object projection matrices are not supported for LightProbe objects!\");\n\t}\n\n\tpublic _iCollectRenderables(renderer:IRenderer)\n\t{\n\t\t//nothing to do here\n\t}\n}\n\nexport = LightProbe;",
    "﻿import UVTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/UVTransform\");\nimport AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\n\nimport IAnimator\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Geometry\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport ISubMesh\t\t\t\t\t\t= require(\"awayjs-display/lib/base/ISubMesh\");\nimport ISubMeshClass\t\t\t\t= require(\"awayjs-display/lib/base/ISubMeshClass\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport DisplayObjectContainer\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport GeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/GeometryEvent\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n * Mesh is an instance of a Geometry, augmenting it with a presence in the scene graph, a material, and an animation\n * state. It consists out of SubMeshes, which in turn correspond to SubGeometries. SubMeshes allow different parts\n * of the geometry to be assigned different materials.\n */\nclass Mesh extends DisplayObjectContainer implements IEntity\n{\n\tprivate _uvTransform:UVTransform;\n\n\tprivate _subMeshes:Array<ISubMesh>;\n\tprivate _geometry:Geometry;\n\tprivate _material:MaterialBase;\n\tprivate _animator:IAnimator;\n\tprivate _castsShadows:boolean = true;\n\tprivate _shareAnimationGeometry:boolean = true;\n\n\tprivate _onGeometryBoundsInvalidDelegate:(event:GeometryEvent) => void;\n\tprivate _onSubGeometryAddedDelegate:(event:GeometryEvent) => void;\n\tprivate _onSubGeometryRemovedDelegate:(event:GeometryEvent) => void;\n\n\t/**\n\t * Defines the animator of the mesh. Act on the mesh's geometry.  Default value is <code>null</code>.\n\t */\n\tpublic get animator():IAnimator\n\t{\n\t\treturn this._animator;\n\t}\n\n\tpublic set animator(value:IAnimator)\n\t{\n\t\tif (this._animator)\n\t\t\tthis._animator.removeOwner(this);\n\n\t\tthis._animator = value;\n\n\t\tvar len:number = this._subMeshes.length;\n\t\tvar subMesh:ISubMesh;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tsubMesh = this._subMeshes[i];\n\n\t\t\t// cause material to be unregistered and registered again to work with the new animation type (if possible)\n\t\t\tif (subMesh.material) {\n\t\t\t\tsubMesh.material.iRemoveOwner(subMesh);\n\t\t\t\tsubMesh.material.iAddOwner(subMesh);\n\t\t\t}\n\n\t\t\t//invalidate any existing renderables in case they need to pull new geometry\n\t\t\tsubMesh._iInvalidateRenderableGeometry();\n\t\t}\n\n\t\tif (this._animator)\n\t\t\tthis._animator.addOwner(this);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.MESH;\n\t}\n\n\t/**\n\t * Indicates whether or not the Mesh can cast shadows. Default value is <code>true</code>.\n\t */\n\tpublic get castsShadows():boolean\n\t{\n\t\treturn this._castsShadows;\n\t}\n\n\tpublic set castsShadows(value:boolean)\n\t{\n\t\tthis._castsShadows = value;\n\t}\n\n\t/**\n\t * The geometry used by the mesh that provides it with its shape.\n\t */\n\tpublic get geometry():Geometry\n\t{\n\t\tif (this._iSourcePrefab)\n\t\t\tthis._iSourcePrefab._iValidate();\n\n\t\treturn this._geometry;\n\t}\n\n\tpublic set geometry(value:Geometry)\n\t{\n\t\tvar i:number;\n\n\t\tif (this._geometry) {\n\t\t\tthis._geometry.removeEventListener(GeometryEvent.BOUNDS_INVALID, this._onGeometryBoundsInvalidDelegate);\n\t\t\tthis._geometry.removeEventListener(GeometryEvent.SUB_GEOMETRY_ADDED, this._onSubGeometryAddedDelegate);\n\t\t\tthis._geometry.removeEventListener(GeometryEvent.SUB_GEOMETRY_REMOVED, this._onSubGeometryRemovedDelegate);\n\n\t\t\tfor (i = 0; i < this._subMeshes.length; ++i)\n\t\t\t\tthis._subMeshes[i].dispose();\n\n\t\t\tthis._subMeshes.length = 0;\n\t\t}\n\n\t\tthis._geometry = value;\n\n\t\tif (this._geometry) {\n\n\t\t\tthis._geometry.addEventListener(GeometryEvent.BOUNDS_INVALID, this._onGeometryBoundsInvalidDelegate);\n\t\t\tthis._geometry.addEventListener(GeometryEvent.SUB_GEOMETRY_ADDED, this._onSubGeometryAddedDelegate);\n\t\t\tthis._geometry.addEventListener(GeometryEvent.SUB_GEOMETRY_REMOVED, this._onSubGeometryRemovedDelegate);\n\n\t\t\tvar subGeoms:Array<SubGeometryBase> = this._geometry.subGeometries;\n\n\t\t\tfor (i = 0; i < subGeoms.length; ++i)\n\t\t\t\tthis.addSubMesh(subGeoms[i]);\n\t\t}\n\t}\n\n\t/**\n\t * The material with which to render the Mesh.\n\t */\n\tpublic get material():MaterialBase\n\t{\n\t\treturn this._material;\n\t}\n\n\tpublic set material(value:MaterialBase)\n\t{\n\t\tif (value == this._material)\n\t\t\treturn;\n\n\t\tvar i:number;\n\t\tvar len:number = this._subMeshes.length;\n\t\tvar subMesh:ISubMesh;\n\n\t\tfor (i = 0; i < len; i++)\n\t\t\tif (this._material && (subMesh = this._subMeshes[i]).material == this._material)\n\t\t\t\tthis._material.iRemoveOwner(subMesh);\n\n\t\tthis._material = value;\n\n\t\tfor (i = 0; i < len; i++)\n\t\t\tif (this._material && (subMesh = this._subMeshes[i]).material == this._material)\n\t\t\t\tthis._material.iAddOwner(subMesh);\n\t}\n\n\t/**\n\t * Indicates whether or not the mesh share the same animation geometry.\n\t */\n\tpublic get shareAnimationGeometry():boolean\n\t{\n\t\treturn this._shareAnimationGeometry;\n\t}\n\n\tpublic set shareAnimationGeometry(value:boolean)\n\t{\n\t\tthis._shareAnimationGeometry = value;\n\t}\n\n\t/**\n\t * The SubMeshes out of which the Mesh consists. Every SubMesh can be assigned a material to override the Mesh's\n\t * material.\n\t */\n\tpublic get subMeshes():Array<ISubMesh>\n\t{\n\t\t// Since this getter is invoked every iteration of the render loop, and\n\t\t// the prefab construct could affect the sub-meshes, the prefab is\n\t\t// validated here to give it a chance to rebuild.\n\t\tif (this._iSourcePrefab)\n\t\t\tthis._iSourcePrefab._iValidate();\n\n\t\treturn this._subMeshes;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get uvTransform():UVTransform\n\t{\n\t\treturn this._uvTransform;\n\t}\n\n\tpublic set uvTransform(value:UVTransform)\n\t{\n\t\tthis._uvTransform = value;\n\t}\n\n\t/**\n\t * Create a new Mesh object.\n\t *\n\t * @param geometry                    The geometry used by the mesh that provides it with its shape.\n\t * @param material    [optional]        The material with which to render the Mesh.\n\t */\n\tconstructor(geometry:Geometry, material:MaterialBase = null)\n\t{\n\t\tsuper();\n\n\t\tthis._pIsEntity = true;\n\n\t\tthis._subMeshes = new Array<ISubMesh>();\n\n\t\tthis._onGeometryBoundsInvalidDelegate = (event:GeometryEvent) => this.onGeometryBoundsInvalid(event);\n\t\tthis._onSubGeometryAddedDelegate = (event:GeometryEvent) => this.onSubGeometryAdded(event);\n\t\tthis._onSubGeometryRemovedDelegate = (event:GeometryEvent) => this.onSubGeometryRemoved(event);\n\n\t\t//this should never happen, but if people insist on trying to create their meshes before they have geometry to fill it, it becomes necessary\n\t\tthis.geometry = geometry || new Geometry();\n\n\t\tthis.material = material;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic bakeTransformations()\n\t{\n\t\tthis.geometry.applyTransformation(this._iMatrix3D);\n\t\tthis._iMatrix3D.identity();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis.material = null;\n\t\tthis.geometry = null;\n\t}\n\n\t/**\n\t * Disposes mesh including the animator and children. This is a merely a convenience method.\n\t * @return\n\t */\n\tpublic disposeWithAnimatorAndChildren()\n\t{\n\t\tthis.disposeWithChildren();\n\n\t\t if (this._animator)\n\t\t\tthis._animator.dispose();\n\t}\n\n\t/**\n\t * Clones this Mesh instance along with all it's children, while re-using the same\n\t * material, geometry and animation set. The returned result will be a copy of this mesh,\n\t * containing copies of all of it's children.\n\t *\n\t * Properties that are re-used (i.e. not cloned) by the new copy include name,\n\t * geometry, and material. Properties that are cloned or created anew for the copy\n\t * include subMeshes, children of the mesh, and the animator.\n\t *\n\t * If you want to copy just the mesh, reusing it's geometry and material while not\n\t * cloning it's children, the simplest way is to create a new mesh manually:\n\t *\n\t * <code>\n\t * var clone : Mesh = new Mesh(original.geometry, original.material);\n\t * </code>\n\t */\n\tpublic clone():DisplayObject\n\t{\n\t\tvar clone:Mesh = new Mesh(this._geometry, this._material);\n\n\t\tclone._iMatrix3D = this._iMatrix3D;\n\t\tclone.pivot = this.pivot;\n\t\tclone.partition = this.partition;\n\t\tclone.bounds = this.bounds.clone();\n\n\n\t\tclone.name = this.name;\n\t\tclone.castsShadows = this.castsShadows;\n\t\tclone.shareAnimationGeometry = this.shareAnimationGeometry;\n\t\tclone.mouseEnabled = this.mouseEnabled;\n\t\tclone.mouseChildren = this.mouseChildren;\n\t\t//this is of course no proper cloning\n\t\t//maybe use this instead?: http://blog.another-d-mention.ro/programming/how-to-clone-duplicate-an-object-in-actionscript-3/\n\t\tclone.extra = this.extra;\n\n\t\tvar len:number = this._subMeshes.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tclone._subMeshes[i].material = this._subMeshes[i]._iGetExplicitMaterial();\n\n\n\t\tlen = this.numChildren;\n\t\tvar obj:any;\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tobj = this.getChildAt(i).clone();\n\t\t\tclone.addChild(<DisplayObjectContainer> obj);\n\t\t}\n\n\t\tif (this._animator)\n\t\t\tclone.animator = this._animator.clone();\n\n\t\treturn clone;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param subGeometry\n\t * @returns {SubMeshBase}\n\t */\n\tpublic getSubMeshFromSubGeometry(subGeometry:SubGeometryBase):ISubMesh\n\t{\n\t\treturn this._subMeshes[this._geometry.subGeometries.indexOf(subGeometry)];\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\treturn new EntityNode(this);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @protected\n\t */\n\tpublic pUpdateBounds()\n\t{\n\t\tvar i:number, j:number, p:number;\n\t\tvar subGeoms:Array<SubGeometryBase> = this._geometry.subGeometries;\n\t\tvar subGeom:SubGeometryBase;\n\t\tvar boundingPositions:Array<number>;\n\t\tvar numSubGeoms:number = subGeoms.length;\n\t\tvar minX:number, minY:number, minZ:number;\n\t\tvar maxX:number, maxY:number, maxZ:number;\n\n\t\tif (numSubGeoms > 0) {\n\t\t\ti = 0;\n\t\t\tsubGeom = subGeoms[0];\n\t\t\tboundingPositions = subGeom.getBoundingPositions();\n\t\t\tminX = maxX = boundingPositions[i];\n\t\t\tminY = maxY = boundingPositions[i + 1];\n\t\t\tminZ = maxZ = boundingPositions[i + 2];\n\n\t\t\tj = numSubGeoms;\n\t\t\twhile (j--) {\n\t\t\t\tsubGeom = subGeoms[j];\n\t\t\t\tboundingPositions = subGeom.getBoundingPositions();\n\t\t\t\ti = boundingPositions.length;\n\t\t\t\twhile (i--) {\n\t\t\t\t\tp = boundingPositions[i];\n\t\t\t\t\tif (p < minX)\n\t\t\t\t\t\tminX = p;\n\t\t\t\t\telse if (p > maxX)\n\t\t\t\t\t\tmaxX = p;\n\n\t\t\t\t\tp = boundingPositions[i + 1];\n\n\t\t\t\t\tif (p < minY)\n\t\t\t\t\t\tminY = p;\n\t\t\t\t\telse if (p > maxY)\n\t\t\t\t\t\tmaxY = p;\n\n\t\t\t\t\tp = boundingPositions[i + 2];\n\n\t\t\t\t\tif (p < minZ)\n\t\t\t\t\t\tminZ = p;\n\t\t\t\t\telse if (p > maxZ)\n\t\t\t\t\t\tmaxZ = p;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._pBounds.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);\n\t\t} else {\n\t\t\tthis._pBounds.fromExtremes(0, 0, 0, 0, 0, 0);\n\t\t}\n\n\t\tsuper.pUpdateBounds();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate onGeometryBoundsInvalid(event:GeometryEvent)\n\t{\n\t\tthis.pInvalidateBounds();\n\t}\n\n\t/**\n\t * Called when a SubGeometry was added to the Geometry.\n\t *\n\t * @private\n\t */\n\tprivate onSubGeometryAdded(event:GeometryEvent)\n\t{\n\t\tthis.addSubMesh(event.subGeometry);\n\t}\n\n\t/**\n\t * Called when a SubGeometry was removed from the Geometry.\n\t *\n\t * @private\n\t */\n\tprivate onSubGeometryRemoved(event:GeometryEvent)\n\t{\n\t\tvar subMesh:ISubMesh;\n\t\tvar subGeom:SubGeometryBase = event.subGeometry;\n\t\tvar len:number = this._subMeshes.length;\n\t\tvar i:number;\n\n\t\t// Important! This has to be done here, and not delayed until the\n\t\t// next render loop, since this may be caused by the geometry being\n\t\t// rebuilt IN THE RENDER LOOP. Invalidating and waiting will delay\n\t\t// it until the NEXT RENDER FRAME which is probably not desirable.\n\t\tfor (i = 0; i < len; ++i) {\n\n\t\t\tsubMesh = this._subMeshes[i];\n\n\t\t\tif (subMesh.subGeometry == subGeom) {\n\t\t\t\tsubMesh.dispose();\n\n\t\t\t\tthis._subMeshes.splice(i, 1);\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t--len;\n\t\tfor (; i < len; ++i)\n\t\t\tthis._subMeshes[i]._iIndex = i;\n\t}\n\n\t/**\n\t * Adds a SubMeshBase wrapping a SubGeometry.\n\t *\n\t * @param subGeometry\n\t */\n\tprivate addSubMesh(subGeometry:SubGeometryBase)\n\t{\n\t\tvar SubMeshClass:ISubMeshClass = subGeometry.subMeshClass;\n\n\t\tvar subMesh:ISubMesh = new SubMeshClass(subGeometry, this, null);\n\t\tvar len:number = this._subMeshes.length;\n\n\t\tsubMesh._iIndex = len;\n\n\t\tthis._subMeshes[len] = subMesh;\n\n\t\tthis.pInvalidateBounds();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param shortestCollisionDistance\n\t * @param findClosest\n\t * @returns {boolean}\n\t *\n\t * @internal\n\t */\n\tpublic _iTestCollision(shortestCollisionDistance:number, findClosest:boolean):boolean\n\t{\n\t\treturn this._pPickingCollider.testMeshCollision(this, this._pPickingCollisionVO, shortestCollisionDistance, findClosest);\n\t}\n\n\t/**\n\t *\n\t * @param renderer\n\t *\n\t * @internal\n\t */\n\tpublic _iCollectRenderables(renderer:IRenderer)\n\t{\n\t\t// Since this getter is invoked every iteration of the render loop, and\n\t\t// the prefab construct could affect the sub-meshes, the prefab is\n\t\t// validated here to give it a chance to rebuild.\n\t\tif (this._iSourcePrefab)\n\t\t\tthis._iSourcePrefab._iValidate();\n\n\t\tvar len:number /*uint*/ = this._subMeshes.length;\n\t\tfor (var i:number /*uint*/ = 0; i < len; i++)\n\t\t\tthis._subMeshes[i]._iCollectRenderable(renderer);\n\t}\n\n\tpublic _iInvalidateRenderableGeometries()\n\t{\n\t\tvar len:number = this._subMeshes.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._subMeshes[i]._iInvalidateRenderableGeometry();\n\t}\n}\n\nexport = Mesh;",
    "import BoundingSphere\t\t\t\t= require(\"awayjs-core/lib/bounds/BoundingSphere\");\nimport BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport Box\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Box\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport PointLightNode\t\t\t\t= require(\"awayjs-display/lib/partition/PointLightNode\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport CubeMapShadowMapper\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper\");\n\nclass PointLight extends LightBase implements IEntity\n{\n\tpublic _pRadius:number = 90000;\n\tpublic _pFallOff:number = 100000;\n\tpublic _pFallOffFactor:number;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pIsEntity = true;\n\n\t\tthis._pFallOffFactor = 1/(this._pFallOff*this._pFallOff - this._pRadius*this._pRadius);\n\t}\n\n\tpublic pCreateShadowMapper():CubeMapShadowMapper\n\t{\n\t\treturn new CubeMapShadowMapper();\n\t}\n\n\tpublic get radius():number\n\t{\n\t\treturn this._pRadius;\n\t}\n\n\tpublic set radius(value:number)\n\t{\n\t\tthis._pRadius = value;\n\n\t\tif (this._pRadius < 0) {\n\t\t\tthis._pRadius = 0;\n\t\t} else if (this._pRadius > this._pFallOff) {\n\t\t\tthis._pFallOff = this._pRadius;\n\t\t\tthis.pInvalidateBounds();\n\t\t}\n\t\tthis._pFallOffFactor = 1/( this._pFallOff*this._pFallOff - this._pRadius*this._pRadius );\n\t}\n\n\tpublic iFallOffFactor():number\n\t{\n\t\treturn this._pFallOffFactor;\n\t}\n\n\tpublic get fallOff():number\n\t{\n\t\treturn this._pFallOff;\n\t}\n\n\tpublic set fallOff(value:number)\n\t{\n\t\tthis._pFallOff = value;\n\n\t\tif (this._pFallOff < 0)\n\t\t\tthis._pFallOff = 0;\n\n\t\tif (this._pFallOff < this._pRadius)\n\t\t\tthis._pRadius = this._pFallOff;\n\n\t\tthis._pFallOffFactor = 1/( this._pFallOff*this._pFallOff - this._pRadius*this._pRadius);\n\t\tthis.pInvalidateBounds();\n\t}\n\n\t/**\n\t * @protected\n\t */\n\tpublic pCreateEntityPartitionNode():EntityNode\n\t{\n\t\treturn new PointLightNode(this);\n\t}\n\n\tpublic pUpdateBounds()\n\t{\n\t\tthis._pBounds.fromSphere(new Vector3D(), this._pFallOff);\n\t\tthis._pBoundsInvalid = false;\n\t}\n\n\tpublic pCreateDefaultBoundingVolume():BoundingVolumeBase\n\t{\n\t\t//point lights are culled based on their falloff radius\n\t\treturn new BoundingSphere();\n\t}\n\n\tpublic iGetObjectProjectionMatrix(entity:IEntity, camera:Camera, target:Matrix3D = null):Matrix3D\n\t{\n\t\tvar raw:number[] = new Array<number>(16);\n\t\tvar bounds:BoundingVolumeBase = entity.bounds;\n\t\tvar m:Matrix3D = new Matrix3D();\n\n\t\t// todo: do not use lookAt on Light\n\t\tm.copyFrom(entity.getRenderSceneTransform(camera));\n\t\tm.append(this._pParent.inverseSceneTransform);\n\t\tthis.lookAt(m.position);\n\n\t\tm.copyFrom(entity.getRenderSceneTransform(camera));\n\t\tm.append(this.inverseSceneTransform);\n\n\t\tvar box:Box = bounds.aabb;\n\t\tvar v1:Vector3D = m.deltaTransformVector(new Vector3D(box.left, box.bottom, box.front));\n\t\tvar v2:Vector3D = m.deltaTransformVector(new Vector3D(box.right, box.top, box.back));\n\t\tvar d1:number = v1.x*v1.x + v1.y*v1.y + v1.z*v1.z;\n\t\tvar d2:number = v2.x*v2.x + v2.y*v2.y + v2.z*v2.z;\n\t\tvar d:number = Math.sqrt(d1 > d2? d1 : d2);\n\t\tvar zMin:number;\n\t\tvar zMax:number;\n\n\t\tvar z:number = m.rawData[14];\n\t\tzMin = z - d;\n\t\tzMax = z + d;\n\n\t\traw[5] = raw[0] = zMin/d;\n\t\traw[10] = zMax/(zMax - zMin);\n\t\traw[11] = 1;\n\t\traw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[12] = raw[13] = raw[15] = 0;\n\t\traw[14] = -zMin*raw[10];\n\n\t\tif (!target)\n\t\t\ttarget = new Matrix3D();\n\n\t\ttarget.copyRawDataFrom(raw);\n\t\ttarget.prepend(m);\n\n\t\treturn target;\n\t}\n\n\tpublic _iCollectRenderables(renderer:IRenderer)\n\t{\n\t\t//nothing to do here\n\t}\n}\n\nexport = PointLight;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport Camera\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\n/**\n * @class away.events.CameraEvent\n */\nclass CameraEvent extends Event\n{\n\tpublic static PROJECTION_CHANGED:string = \"projectionChanged\";\n\n\tprivate _camera:Camera;\n\n\tconstructor(type:string, camera:Camera)\n\t{\n\t\tsuper(type);\n\n\t\tthis._camera = camera;\n\t}\n\n\tpublic get camera():Camera\n\t{\n\t\treturn this._camera;\n\t}\n}\n\nexport = CameraEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\n\nclass DisplayObjectEvent extends Event\n{\n\tpublic static VISIBLITY_UPDATED:string = \"visiblityUpdated\";\n\tpublic static SCENETRANSFORM_CHANGED:string = \"scenetransformChanged\";\n\tpublic static SCENE_CHANGED:string = \"sceneChanged\";\n\tpublic static POSITION_CHANGED:string = \"positionChanged\";\n\tpublic static ROTATION_CHANGED:string = \"rotationChanged\";\n\tpublic static SCALE_CHANGED:string = \"scaleChanged\";\n\n\tpublic object:DisplayObject;\n\n\tconstructor(type:string, object:DisplayObject)\n\t{\n\t\tsuper(type);\n\t\tthis.object = object;\n\t}\n}\n\nexport = DisplayObjectEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\n/**\n* Dispatched to notify changes in a geometry object's state.\n*\n* @class away.events.GeometryEvent\n* @see away3d.core.base.Geometry\n*/\nclass GeometryEvent extends Event\n{\n\t/**\n\t * Dispatched when a TriangleSubGeometry was added to the dispatching Geometry.\n\t */\n\tpublic static SUB_GEOMETRY_ADDED:string = \"SubGeometryAdded\";\n\n\t/**\n\t * Dispatched when a TriangleSubGeometry was removed from the dispatching Geometry.\n\t */\n\tpublic static SUB_GEOMETRY_REMOVED:string = \"SubGeometryRemoved\";\n\n\tpublic static BOUNDS_INVALID:string = \"BoundsInvalid\";\n\n\tprivate _subGeometry:SubGeometryBase;\n\n\t/**\n\t * Create a new GeometryEvent\n\t * @param type The event type.\n\t * @param subGeometry An optional TriangleSubGeometry object that is the subject of this event.\n\t */\n\tconstructor(type:string, subGeometry:SubGeometryBase = null)\n\t{\n\t\tsuper(type);\n\n\t\tthis._subGeometry = subGeometry;\n\t}\n\n\t/**\n\t * The TriangleSubGeometry object that is the subject of this event, if appropriate.\n\t */\n\tpublic get subGeometry():SubGeometryBase\n\t{\n\t\treturn this._subGeometry;\n\t}\n\n\t/**\n\t * Clones the event.\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new GeometryEvent(this.type, this._subGeometry);\n\t}\n}\n\nexport = GeometryEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass LightEvent extends Event\n{\n\n\tpublic static CASTS_SHADOW_CHANGE:string = \"castsShadowChange\";\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n\n\t//@override\n\tpublic clone():Event\n\t{\n\t\treturn new LightEvent(this.type);\n\t}\n}\n\nexport = LightEvent;",
    "import Point\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport IMaterialOwner\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport View\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport MaterialBase\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\n/**\n * A MouseEvent is dispatched when a mouse event occurs over a mouseEnabled object in View.\n * TODO: we don't have screenZ data, tho this should be easy to implement\n */\nclass MouseEvent extends Event\n{\n\t// Private.\n\tpublic _iAllowedToPropagate:boolean = true;\n\tpublic _iParentEvent:MouseEvent;\n\n\t/**\n\t * Defines the value of the type property of a mouseOver3d event object.\n\t */\n\tpublic static MOUSE_OVER:string = \"mouseOver3d\";\n\n\t/**\n\t * Defines the value of the type property of a mouseOut3d event object.\n\t */\n\tpublic static MOUSE_OUT:string = \"mouseOut3d\";\n\n\t/**\n\t * Defines the value of the type property of a mouseUp3d event object.\n\t */\n\tpublic static MOUSE_UP:string = \"mouseUp3d\";\n\n\t/**\n\t * Defines the value of the type property of a mouseDown3d event object.\n\t */\n\tpublic static MOUSE_DOWN:string = \"mouseDown3d\";\n\n\t/**\n\t * Defines the value of the type property of a mouseMove3d event object.\n\t */\n\tpublic static MOUSE_MOVE:string = \"mouseMove3d\";\n\n\t/**\n\t * Defines the value of the type property of a rollOver3d event object.\n\t */\n//\t\tpublic static ROLL_OVER : string = \"rollOver3d\";\n\n\t/**\n\t * Defines the value of the type property of a rollOut3d event object.\n\t */\n//\t\tpublic static ROLL_OUT : string = \"rollOut3d\";\n\n\t/**\n\t * Defines the value of the type property of a click3d event object.\n\t */\n\tpublic static CLICK:string = \"click3d\";\n\n\t/**\n\t * Defines the value of the type property of a doubleClick3d event object.\n\t */\n\tpublic static DOUBLE_CLICK:string = \"doubleClick3d\";\n\n\t/**\n\t * Defines the value of the type property of a mouseWheel3d event object.\n\t */\n\tpublic static MOUSE_WHEEL:string = \"mouseWheel3d\";\n\n\t/**\n\t * The horizontal coordinate at which the event occurred in view coordinates.\n\t */\n\tpublic screenX:number;\n\n\t/**\n\t * The vertical coordinate at which the event occurred in view coordinates.\n\t */\n\tpublic screenY:number;\n\n\t/**\n\t * The view object inside which the event took place.\n\t */\n\tpublic view:View;\n\n\t/**\n\t * The 3d object inside which the event took place.\n\t */\n\tpublic object:DisplayObject;\n\n\t/**\n\t * The material owner inside which the event took place.\n\t */\n\tpublic materialOwner:IMaterialOwner;\n\n\t/**\n\t * The material of the 3d element inside which the event took place.\n\t */\n\tpublic material:MaterialBase;\n\n\t/**\n\t * The uv coordinate inside the draw primitive where the event took place.\n\t */\n\tpublic uv:Point;\n\n\t/**\n\t * The index of the face where the event took place.\n\t */\n\tpublic index:number;\n\n\t/**\n\t * The index of the subGeometry where the event took place.\n\t */\n\tpublic subGeometryIndex:number;\n\n\t/**\n\t * The position in object space where the event took place\n\t */\n\tpublic localPosition:Vector3D;\n\n\t/**\n\t * The normal in object space where the event took place\n\t */\n\tpublic localNormal:Vector3D;\n\n\t/**\n\t * Indicates whether the Control key is active (true) or inactive (false).\n\t */\n\tpublic ctrlKey:boolean;\n\n\t/**\n\t * Indicates whether the Alt key is active (true) or inactive (false).\n\t */\n\tpublic altKey:boolean;\n\n\t/**\n\t * Indicates whether the Shift key is active (true) or inactive (false).\n\t */\n\tpublic shiftKey:boolean;\n\n\t/**\n\t * Indicates how many lines should be scrolled for each unit the user rotates the mouse wheel.\n\t */\n\tpublic delta:number;\n\n\t/**\n\t * Create a new MouseEvent object.\n\t * @param type The type of the MouseEvent.\n\t */\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get bubbles():boolean\n\t{\n\t\tvar doesBubble:boolean = this._iAllowedToPropagate;\n\t\tthis._iAllowedToPropagate = true;\n\n\t\t// Don't bubble if propagation has been stopped.\n\t\treturn doesBubble;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic stopPropagation()\n\t{\n\t\tthis._iAllowedToPropagate = false;\n\n\t\tif (this._iParentEvent)\n\t\t\tthis._iParentEvent.stopPropagation();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic stopImmediatePropagation()\n\t{\n\t\tthis._iAllowedToPropagate = false;\n\n\t\tif (this._iParentEvent)\n\t\t\tthis._iParentEvent.stopImmediatePropagation();\n\t}\n\n\t/**\n\t * Creates a copy of the MouseEvent object and sets the value of each property to match that of the original.\n\t */\n\tpublic clone():Event\n\t{\n\t\tvar result:MouseEvent = new MouseEvent(this.type);\n\n\t\t/* TODO: Debug / test - look into isDefaultPrevented\n\t\t if (isDefaultPrevented())\n\t\t result.preventDefault();\n\t\t */\n\n\t\tresult.screenX = this.screenX;\n\t\tresult.screenY = this.screenY;\n\n\t\tresult.view = this.view;\n\t\tresult.object = this.object;\n\t\tresult.materialOwner = this.materialOwner;\n\t\tresult.material = this.material;\n\t\tresult.uv = this.uv;\n\t\tresult.localPosition = this.localPosition;\n\t\tresult.localNormal = this.localNormal;\n\t\tresult.index = this.index;\n\t\tresult.subGeometryIndex = this.subGeometryIndex;\n\t\tresult.delta = this.delta;\n\n\t\tresult.ctrlKey = this.ctrlKey;\n\t\tresult.shiftKey = this.shiftKey;\n\n\t\tresult._iParentEvent = this;\n\t\tresult._iAllowedToPropagate = this._iAllowedToPropagate;\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * The position in scene space where the event took place\n\t */\n\tpublic get scenePosition():Vector3D\n\t{\n\t\treturn this.object.sceneTransform.transformVector(this.localPosition);\n\t}\n\n\t/**\n\t * The normal in scene space where the event took place\n\t */\n\tpublic get sceneNormal():Vector3D\n\t{\n\t\tvar sceneNormal:Vector3D = this.object.sceneTransform.deltaTransformVector(this.localNormal);\n\t\tsceneNormal.normalize();\n\n\t\treturn sceneNormal;\n\t}\n}\n\nexport = MouseEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass RendererEvent extends Event\n{\n\tpublic static VIEWPORT_UPDATED:string = \"viewportUpdated\";\n\tpublic static SCISSOR_UPDATED:string = \"scissorUpdated\";\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n}\n\nexport = RendererEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\n\nclass SceneEvent extends Event\n{\n\t/**\n\t *\n\t */\n\tpublic static ADDED_TO_SCENE:string = \"addedToScene\";\n\n\t/**\n\t *\n\t */\n\tpublic static REMOVED_FROM_SCENE:string = \"removedFromScene\";\n\n\t/**\n\t *\n\t */\n\tpublic static PARTITION_CHANGED:string = \"partitionChanged\";\n\n\t/**\n\t *\n\t */\n\tpublic displayObject:DisplayObject;\n\n\tconstructor(type:string, displayObject:DisplayObject)\n\t{\n\t\tsuper(type);\n\n\t\tthis.displayObject = displayObject;\n\t}\n}\n\nexport = SceneEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\n/**\n * Dispatched to notify changes in a sub geometry object's state.\n *\n * @class away.events.SubGeometryEvent\n * @see away.core.base.Geometry\n */\nclass SubGeometryEvent extends Event\n{\n\t/**\n\t * Dispatched when a TriangleSubGeometry's index data has been updated.\n\t */\n\tpublic static INDICES_UPDATED:string = \"indicesUpdated\";\n\n\t/**\n\t * Dispatched when a TriangleSubGeometry's vertex data has been updated.\n\t */\n\tpublic static VERTICES_UPDATED:string = \"verticesUpdated\";\n\n\tprivate _dataType:string;\n\n\t/**\n\t * Create a new GeometryEvent\n\t * @param type The event type.\n\t * @param dataType An optional data type of the vertex data being updated.\n\t */\n\tconstructor(type:string, dataType:string = \"\")\n\t{\n\t\tsuper(type);\n\n\t\tthis._dataType = dataType;\n\t}\n\n\t/**\n\t * The data type of the vertex data.\n\t */\n\tpublic get dataType():string\n\t{\n\t\treturn this._dataType;\n\t}\n\n\t/**\n\t * Clones the event.\n\t *\n\t * @return An exact duplicate of the current object.\n\t */\n\tpublic clone():Event\n\t{\n\t\treturn new SubGeometryEvent(this.type, this._dataType);\n\t}\n}\n\nexport = SubGeometryEvent;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport View\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport PickingCollisionVO\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport AwayMouseEvent\t\t\t\t= require(\"awayjs-display/lib/events/MouseEvent\");\n\n/**\n * MouseManager enforces a singleton pattern and is not intended to be instanced.\n * it provides a manager class for detecting mouse hits on scene objects and sending out mouse events.\n */\nclass MouseManager\n{\n\tprivate static _instance:MouseManager;\n\n\tprivate _viewLookup:Array<View> = new Array<View>();\n\n\tpublic _iActiveDiv:HTMLDivElement;\n\tpublic _iUpdateDirty:boolean;\n\tpublic _iCollidingObject:PickingCollisionVO;\n\t\n\tprivate _nullVector:Vector3D = new Vector3D();\n\tprivate _previousCollidingObject:PickingCollisionVO;\n\tprivate _queuedEvents:Array<AwayMouseEvent> = new Array<AwayMouseEvent>();\n\n\tprivate _mouseMoveEvent:MouseEvent;\n\n\tprivate _mouseUp:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_UP);\n\tprivate _mouseClick:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.CLICK);\n\tprivate _mouseOut:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_OUT);\n\tprivate _mouseDown:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_DOWN);\n\tprivate _mouseMove:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_MOVE);\n\tprivate _mouseOver:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_OVER);\n\tprivate _mouseWheel:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.MOUSE_WHEEL);\n\tprivate _mouseDoubleClick:AwayMouseEvent = new AwayMouseEvent(AwayMouseEvent.DOUBLE_CLICK);\n\n\tprivate onClickDelegate:(event:MouseEvent) => void;\n\tprivate onDoubleClickDelegate:(event:MouseEvent) => void;\n\tprivate onMouseDownDelegate:(event:MouseEvent) => void;\n\tprivate onMouseMoveDelegate:(event:MouseEvent) => void;\n\tprivate onMouseUpDelegate:(event:MouseEvent) => void;\n\tprivate onMouseWheelDelegate:(event:MouseEvent) => void;\n\tprivate onMouseOverDelegate:(event:MouseEvent) => void;\n\tprivate onMouseOutDelegate:(event:MouseEvent) => void;\n\n\t/**\n\t * Creates a new <code>MouseManager</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tthis.onClickDelegate = (event:MouseEvent) => this.onClick(event);\n\t\tthis.onDoubleClickDelegate = (event:MouseEvent) => this.onDoubleClick(event);\n\t\tthis.onMouseDownDelegate = (event:MouseEvent) => this.onMouseDown(event);\n\t\tthis.onMouseMoveDelegate = (event:MouseEvent) => this.onMouseMove(event);\n\t\tthis.onMouseUpDelegate = (event:MouseEvent) => this.onMouseUp(event);\n\t\tthis.onMouseWheelDelegate = (event:MouseEvent) => this.onMouseWheel(event);\n\t\tthis.onMouseOverDelegate = (event:MouseEvent) => this.onMouseOver(event);\n\t\tthis.onMouseOutDelegate = (event:MouseEvent) => this.onMouseOut(event);\n\t}\n\n\tpublic static getInstance():MouseManager\n\t{\n\t\tif (this._instance)\n\t\t\treturn this._instance;\n\n\t\treturn (this._instance = new MouseManager());\n\t}\n\n\tpublic fireMouseEvents(forceMouseMove:boolean)\n\t{\n\t\t // If colliding object has changed, queue over/out events.\n\t\tif (this._iCollidingObject != this._previousCollidingObject) {\n\t\t\tif (this._previousCollidingObject)\n\t\t\t\tthis.queueDispatch(this._mouseOut, this._mouseMoveEvent, this._previousCollidingObject);\n\n\t\t\tif (this._iCollidingObject)\n\t\t\t\tthis.queueDispatch(this._mouseOver, this._mouseMoveEvent);\n\t\t}\n\n\t\t // Fire mouse move events here if forceMouseMove is on.\n\t\tif (forceMouseMove && this._iCollidingObject)\n\t\t\tthis.queueDispatch( this._mouseMove, this._mouseMoveEvent);\n\n\t\tvar event:AwayMouseEvent;\n\t\tvar dispatcher:DisplayObject;\n\n\t\t // Dispatch all queued events.\n\t\tvar len:number = this._queuedEvents.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\t// Only dispatch from first implicitly enabled object ( one that is not a child of a mouseChildren = false hierarchy ).\n\t\t\tevent = this._queuedEvents[i];\n\t\t\tdispatcher = event.object;\n\n\t\t\twhile (dispatcher && !dispatcher._iIsMouseEnabled())\n\t\t\t\tdispatcher = dispatcher.parent;\n\n\t\t\tif (dispatcher)\n\t\t\t\tdispatcher.dispatchEvent(event);\n\t\t}\n\n\t\tthis._queuedEvents.length = 0;\n\n\t\tthis._previousCollidingObject = this._iCollidingObject;\n\n\t\tthis._iUpdateDirty = false;\n\t}\n\n//\t\tpublic addViewLayer(view:View)\n//\t\t{\n//\t\t\tvar stg:Stage = view.stage;\n//\n//\t\t\t// Add instance to mouse3dmanager to fire mouse events for multiple views\n//\t\t\tif (!view.stageGL.mouse3DManager)\n//\t\t\t\tview.stageGL.mouse3DManager = this;\n//\n//\t\t\tif (!hasKey(view))\n//\t\t\t\t_view3Ds[view] = 0;\n//\n//\t\t\t_childDepth = 0;\n//\t\t\ttraverseDisplayObjects(stg);\n//\t\t\t_viewCount = _childDepth;\n//\t\t}\n\n\tpublic registerView(view:View)\n\t{\n\t\tview.htmlElement.addEventListener(\"click\", this.onClickDelegate);\n\t\tview.htmlElement.addEventListener(\"dblclick\", this.onDoubleClickDelegate);\n\t\tview.htmlElement.addEventListener(\"mousedown\", this.onMouseDownDelegate);\n\t\tview.htmlElement.addEventListener(\"mousemove\", this.onMouseMoveDelegate);\n\t\tview.htmlElement.addEventListener(\"mouseup\", this.onMouseUpDelegate);\n\t\tview.htmlElement.addEventListener(\"mousewheel\", this.onMouseWheelDelegate);\n\t\tview.htmlElement.addEventListener(\"mouseover\", this.onMouseOverDelegate);\n\t\tview.htmlElement.addEventListener(\"mouseout\", this.onMouseOutDelegate);\n\n\t\tthis._viewLookup.push(view);\n\t}\n\n\tpublic unregisterView(view:View)\n\t{\n\t\tview.htmlElement.removeEventListener(\"click\", this.onClickDelegate);\n\t\tview.htmlElement.removeEventListener(\"dblclick\", this.onDoubleClickDelegate);\n\t\tview.htmlElement.removeEventListener(\"mousedown\", this.onMouseDownDelegate);\n\t\tview.htmlElement.removeEventListener(\"mousemove\", this.onMouseMoveDelegate);\n\t\tview.htmlElement.removeEventListener(\"mouseup\", this.onMouseUpDelegate);\n\t\tview.htmlElement.removeEventListener(\"mousewheel\", this.onMouseWheelDelegate);\n\t\tview.htmlElement.removeEventListener(\"mouseover\", this.onMouseOverDelegate);\n\t\tview.htmlElement.removeEventListener(\"mouseout\", this.onMouseOutDelegate);\n\n\t\tthis._viewLookup.slice(this._viewLookup.indexOf(view), 1);\n\t}\n\n\t// ---------------------------------------------------------------------\n\t// Private.\n\t// ---------------------------------------------------------------------\n\n\tprivate queueDispatch(event:AwayMouseEvent, sourceEvent:MouseEvent, collider:PickingCollisionVO = null)\n\t{\n\t\t// 2D properties.\n\t\tif (sourceEvent) {\n\t\t\tevent.ctrlKey = sourceEvent.ctrlKey;\n\t\t\tevent.altKey = sourceEvent.altKey;\n\t\t\tevent.shiftKey = sourceEvent.shiftKey;\n\t\t\tevent.screenX = sourceEvent.clientX;\n\t\t\tevent.screenY = sourceEvent.clientY;\n\t\t}\n\n\t\tif (collider == null)\n\t\t\tcollider = this._iCollidingObject;\n\n\t\t// 3D properties.\n\t\tif (collider) {\n\t\t\t// Object.\n\t\t\tevent.object = collider.displayObject;\n\t\t\tevent.materialOwner = collider.materialOwner;\n\t\t\t// UV.\n\t\t\tevent.uv = collider.uv;\n\t\t\t// Position.\n\t\t\tevent.localPosition = collider.localPosition? collider.localPosition.clone() : null;\n\t\t\t// Normal.\n\t\t\tevent.localNormal = collider.localNormal? collider.localNormal.clone() : null;\n\t\t\t// Face index.\n\t\t\tevent.index = collider.index;\n\t\t} else {\n\t\t\t// Set all to null.\n\t\t\tevent.uv = null;\n\t\t\tevent.object = null;\n\t\t\tevent.localPosition = this._nullVector;\n\t\t\tevent.localNormal = this._nullVector;\n\t\t\tevent.index = 0;\n\t\t\tevent.subGeometryIndex = 0;\n\t\t}\n\n\t\t// Store event to be dispatched later.\n\t\tthis._queuedEvents.push(event);\n\t}\n\n\t// ---------------------------------------------------------------------\n\t// Listeners.\n\t// ---------------------------------------------------------------------\n\n\tprivate onMouseMove(event:MouseEvent)\n\t{\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseMove, this._mouseMoveEvent = event);\n\t}\n\n\tprivate onMouseOut(event:MouseEvent)\n\t{\n\t\tthis._iActiveDiv = null;\n\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseOut, event);\n\t}\n\n\tprivate onMouseOver(event:MouseEvent)\n\t{\n\t\tthis._iActiveDiv = <HTMLDivElement> event.target;\n\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch( this._mouseOver, event);\n\t}\n\n\tprivate onClick(event:MouseEvent)\n\t{\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseClick, event);\n\t}\n\n\tprivate onDoubleClick(event:MouseEvent)\n\t{\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseDoubleClick, event);\n\t}\n\n\tprivate onMouseDown(event:MouseEvent)\n\t{\n\t\tthis._iActiveDiv = <HTMLDivElement> event.target;\n\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseDown, event);\n\t}\n\n\tprivate onMouseUp(event:MouseEvent)\n\t{\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseUp , event);\n\t}\n\n\tprivate onMouseWheel(event:MouseEvent)\n\t{\n\t\tthis.updateColliders(event);\n\n\t\tif (this._iCollidingObject)\n\t\t\tthis.queueDispatch(this._mouseWheel, event);\n\t}\n\n\n\tprivate updateColliders(event:MouseEvent)\n\t{\n\t\tif (this._iUpdateDirty)\n\t\t\treturn;\n\n\t\tvar view:View;\n\t\tvar bounds:ClientRect;\n\t\tvar mouseX:number = event.clientX;\n\t\tvar mouseY:number = event.clientY;\n\t\tvar len:number = this._viewLookup.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tview = this._viewLookup[i];\n\t\t\tbounds = view.htmlElement.getBoundingClientRect();\n\t\t\tif (mouseX < bounds.left || mouseX > bounds.right || mouseY < bounds.top || mouseY > bounds.bottom) {\n\t\t\t\tview._pMouseX = null;\n\t\t\t\tview._pMouseY = null;\n\t\t\t} else {\n\t\t\t\tview._pMouseX = mouseX + bounds.left;\n\t\t\t\tview._pMouseY = mouseY + bounds.top;\n\t\t\t\tview.updateCollider();\n\n\t\t\t\tif (view.layeredView && this._iCollidingObject)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis._iUpdateDirty = true;\n\t}\n}\n\nexport = MouseManager;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport NamedAssetBase\t\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\n\n/**\n * LightPickerBase provides an abstract base clase for light picker classes. These classes are responsible for\n * feeding materials with relevant lights. Usually, StaticLightPicker can be used, but LightPickerBase can be\n * extended to provide more application-specific dynamic selection of lights.\n *\n * @see StaticLightPicker\n */\nclass LightPickerBase extends NamedAssetBase implements IAsset\n{\n\tpublic _pNumPointLights:number = 0;\n\tpublic _pNumDirectionalLights:number = 0;\n\tpublic _pNumCastingPointLights:number = 0;\n\tpublic _pNumCastingDirectionalLights:number = 0;\n\tpublic _pNumLightProbes:number = 0;\n\n\tpublic _pAllPickedLights:Array<LightBase>;\n\tpublic _pPointLights:Array<PointLight>;\n\tpublic _pCastingPointLights:Array<PointLight>;\n\tpublic _pDirectionalLights:Array<DirectionalLight>;\n\tpublic _pCastingDirectionalLights:Array<DirectionalLight>;\n\tpublic _pLightProbes:Array<LightProbe>;\n\tpublic _pLightProbeWeights:Array<number>;\n\n\t/**\n\t * Creates a new LightPickerBase object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Disposes resources used by the light picker.\n\t */\n\tpublic dispose()\n\t{\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.LIGHT_PICKER;\n\t}\n\n\t/**\n\t * The maximum amount of directional lights that will be provided.\n\t */\n\tpublic get numDirectionalLights():number\n\t{\n\t\treturn this._pNumDirectionalLights;\n\t}\n\n\t/**\n\t * The maximum amount of point lights that will be provided.\n\t */\n\tpublic get numPointLights():number\n\t{\n\t\treturn this._pNumPointLights;\n\t}\n\n\t/**\n\t * The maximum amount of directional lights that cast shadows.\n\t */\n\tpublic get numCastingDirectionalLights():number\n\t{\n\t\treturn this._pNumCastingDirectionalLights;\n\t}\n\n\t/**\n\t * The amount of point lights that cast shadows.\n\t */\n\tpublic get numCastingPointLights():number\n\t{\n\t\treturn this._pNumCastingPointLights;\n\t}\n\n\t/**\n\t * The maximum amount of light probes that will be provided.\n\t */\n\tpublic get numLightProbes():number\n\t{\n\t\treturn this._pNumLightProbes;\n\t}\n\n\t/**\n\t * The collected point lights to be used for shading.\n\t */\n\tpublic get pointLights():Array<PointLight>\n\t{\n\t\treturn this._pPointLights;\n\t}\n\n\t/**\n\t * The collected directional lights to be used for shading.\n\t */\n\tpublic get directionalLights():Array<DirectionalLight>\n\t{\n\t\treturn this._pDirectionalLights;\n\t}\n\n\t/**\n\t * The collected point lights that cast shadows to be used for shading.\n\t */\n\tpublic get castingPointLights():Array<PointLight>\n\t{\n\t\treturn this._pCastingPointLights;\n\t}\n\n\t/**\n\t * The collected directional lights that cast shadows to be used for shading.\n\t */\n\tpublic get castingDirectionalLights():Array<DirectionalLight>\n\t{\n\t\treturn this._pCastingDirectionalLights;\n\t}\n\n\t/**\n\t * The collected light probes to be used for shading.\n\t */\n\tpublic get lightProbes():Array<LightProbe>\n\t{\n\t\treturn this._pLightProbes;\n\t}\n\n\t/**\n\t * The weights for each light probe, defining their influence on the object.\n\t */\n\tpublic get lightProbeWeights():Array<number>\n\t{\n\t\treturn this._pLightProbeWeights;\n\t}\n\n\t/**\n\t * A collection of all the collected lights.\n\t */\n\tpublic get allPickedLights():Array<LightBase>\n\t{\n\t\treturn this._pAllPickedLights;\n\t}\n\n\t/**\n\t * Updates set of lights for a given renderable and EntityCollector. Always call super.collectLights() after custom overridden code.\n\t */\n\tpublic collectLights(renderable:IRenderable)\n\t{\n\t\tthis.updateProbeWeights(renderable);\n\t}\n\n\t/**\n\t * Updates the weights for the light probes, based on the renderable's position relative to them.\n\t * @param renderable The renderble for which to calculate the light probes' influence.\n\t */\n\tprivate updateProbeWeights(renderable:IRenderable)\n\t{\n\t\t// todo: this will cause the same calculations to occur per TriangleSubMesh. See if this can be improved.\n\t\tvar objectPos:Vector3D = renderable.sourceEntity.scenePosition;\n\t\tvar lightPos:Vector3D;\n\n\t\tvar rx:number = objectPos.x, ry:number = objectPos.y, rz:number = objectPos.z;\n\t\tvar dx:number, dy:number, dz:number;\n\t\tvar w:number, total:number = 0;\n\t\tvar i:number;\n\n\t\t// calculates weights for probes\n\t\tfor (i = 0; i < this._pNumLightProbes; ++i) {\n\n\t\t\tlightPos = this._pLightProbes[i].scenePosition;\n\t\t\tdx = rx - lightPos.x;\n\t\t\tdy = ry - lightPos.y;\n\t\t\tdz = rz - lightPos.z;\n\t\t\t// weight is inversely proportional to square of distance\n\t\t\tw = dx*dx + dy*dy + dz*dz;\n\n\t\t\t// just... huge if at the same spot\n\t\t\tw = w > .00001? 1/w : 50000000;\n\t\t\tthis._pLightProbeWeights[i] = w;\n\t\t\ttotal += w;\n\t\t}\n\n\t\t// normalize\n\t\ttotal = 1/total;\n\n\t\tfor (i = 0; i < this._pNumLightProbes; ++i)\n\t\t\tthis._pLightProbeWeights[i] *= total;\n\t}\n}\n\nexport = LightPickerBase;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport LightEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/LightEvent\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\n\n/**\n * StaticLightPicker is a light picker that provides a static set of lights. The lights can be reassigned, but\n * if the configuration changes (number of directional lights, point lights, etc), a material recompilation may\n * occur.\n */\nclass StaticLightPicker extends LightPickerBase\n{\n\tprivate _lights:Array<any>;\n\tprivate _onCastShadowChangeDelegate:Function;\n\n\t/**\n\t * Creates a new StaticLightPicker object.\n\t * @param lights The lights to be used for shading.\n\t */\n\tconstructor(lights)\n\t{\n\t\tsuper();\n\n\t\tthis._onCastShadowChangeDelegate = (event:LightEvent) => this.onCastShadowChange(event);\n\n\t\tthis.lights = lights;\n\t}\n\n\t/**\n\t * The lights used for shading.\n\t */\n\tpublic get lights()\n\t{\n\t\treturn this._lights;\n\t}\n\n\tpublic set lights(value:Array<any>)\n\t{\n\t\tvar numPointLights:number = 0;\n\t\tvar numDirectionalLights:number = 0;\n\t\tvar numCastingPointLights:number = 0;\n\t\tvar numCastingDirectionalLights:number = 0;\n\t\tvar numLightProbes:number = 0;\n\t\tvar light:LightBase;\n\n\t\tif (this._lights)\n\t\t\tthis.clearListeners();\n\n\t\tthis._lights = value;\n\t\tthis._pAllPickedLights = value;\n\t\tthis._pPointLights = new Array<PointLight>();\n\t\tthis._pCastingPointLights = new Array<PointLight>();\n\t\tthis._pDirectionalLights = new Array<DirectionalLight>();\n\t\tthis._pCastingDirectionalLights = new Array<DirectionalLight>();\n\t\tthis._pLightProbes = new Array<LightProbe>();\n\n\t\tvar len:number = value.length;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tlight = value[i];\n\t\t\tlight.addEventListener(LightEvent.CASTS_SHADOW_CHANGE, this._onCastShadowChangeDelegate);\n\n\t\t\tif (light instanceof PointLight) {\n\t\t\t\tif (light.castsShadows)\n\t\t\t\t\tthis._pCastingPointLights[numCastingPointLights++] = <PointLight> light;\n\t\t\t\telse\n\t\t\t\t\tthis._pPointLights[numPointLights++] = <PointLight> light;\n\n\t\t\t} else if (light instanceof DirectionalLight) {\n\t\t\t\tif (light.castsShadows)\n\t\t\t\t\tthis._pCastingDirectionalLights[numCastingDirectionalLights++] = <DirectionalLight> light;\n\t\t\t\telse\n\t\t\t\t\tthis._pDirectionalLights[numDirectionalLights++] = <DirectionalLight> light;\n\n\t\t\t} else if (light instanceof LightProbe) {\n\t\t\t\tthis._pLightProbes[numLightProbes++] = <LightProbe> light;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pNumDirectionalLights == numDirectionalLights && this._pNumPointLights == numPointLights && this._pNumLightProbes == numLightProbes && this._pNumCastingPointLights == numCastingPointLights && this._pNumCastingDirectionalLights == numCastingDirectionalLights)\n\t\t\treturn;\n\n\t\tthis._pNumDirectionalLights = numDirectionalLights;\n\t\tthis._pNumCastingDirectionalLights = numCastingDirectionalLights;\n\t\tthis._pNumPointLights = numPointLights;\n\t\tthis._pNumCastingPointLights = numCastingPointLights;\n\t\tthis._pNumLightProbes = numLightProbes;\n\n\t\t// MUST HAVE MULTIPLE OF 4 ELEMENTS!\n\t\tthis._pLightProbeWeights = new Array<number>(Math.ceil(numLightProbes/4)*4);\n\n\t\t// notify material lights have changed\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\n\t}\n\n\t/**\n\t * Remove configuration change listeners on the lights.\n\t */\n\tprivate clearListeners()\n\t{\n\t\tvar len:number = this._lights.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._lights[i].removeEventListener(LightEvent.CASTS_SHADOW_CHANGE, this._onCastShadowChangeDelegate);\n\t}\n\n\t/**\n\t * Notifies the material of a configuration change.\n\t */\n\tprivate onCastShadowChange(event:LightEvent)\n\t{\n\t\t// TODO: Assign to special caster collections, just append it to the lights in SinglePass\n\t\t// But keep seperated in multipass\n\n\t\tvar light:LightBase = <LightBase> event.target;\n\n\t\tif (light instanceof PointLight)\n\t\t\tthis.updatePointCasting(<PointLight> light);\n\t\telse if (light instanceof DirectionalLight)\n\t\t\tthis.updateDirectionalCasting(<DirectionalLight> light);\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\t/**\n\t * Called when a directional light's shadow casting configuration changes.\n\t */\n\tprivate updateDirectionalCasting(light:DirectionalLight)\n\t{\n\t\tvar dl:DirectionalLight = <DirectionalLight> light;\n\n\t\tif (light.castsShadows) {\n\t\t\t--this._pNumDirectionalLights;\n\t\t\t++this._pNumCastingDirectionalLights;\n\n\n\t\t\tthis._pDirectionalLights.splice(this._pDirectionalLights.indexOf(dl), 1);\n\t\t\tthis._pCastingDirectionalLights.push(light);\n\n\t\t} else {\n\t\t\t++this._pNumDirectionalLights;\n\t\t\t--this._pNumCastingDirectionalLights;\n\n\t\t\tthis._pCastingDirectionalLights.splice(this._pCastingDirectionalLights.indexOf(dl), 1);\n\t\t\tthis._pDirectionalLights.push(light);\n\t\t}\n\t}\n\n\t/**\n\t * Called when a point light's shadow casting configuration changes.\n\t */\n\tprivate updatePointCasting(light:PointLight)\n\t{\n\t\tvar pl:PointLight = <PointLight> light;\n\n\t\tif (light.castsShadows) {\n\t\t\t--this._pNumPointLights;\n\t\t\t++this._pNumCastingPointLights;\n\t\t\tthis._pPointLights.splice(this._pPointLights.indexOf(pl), 1);\n\t\t\tthis._pCastingPointLights.push(light);\n\t\t} else {\n\t\t\t++this._pNumPointLights;\n\t\t\t--this._pNumCastingPointLights;\n\n\t\t\tthis._pCastingPointLights.splice(this._pCastingPointLights.indexOf(pl), 1);\n\t\t\tthis._pPointLights.push(light);\n\t\t}\n\t}\n}\n\nexport = StaticLightPicker;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport PartialImplementationError\t= require(\"awayjs-core/lib/errors/PartialImplementationError\");\nimport PerspectiveProjection\t\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport RenderTexture\t\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nclass CubeMapShadowMapper extends ShadowMapperBase\n{\n\tprivate _depthCameras:Array<Camera>;\n\tprivate _projections:Array<PerspectiveProjection>;\n\tprivate _needsRender:Array<boolean>;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pDepthMapSize = 512;\n\t\tthis._needsRender = new Array();\n\t\tthis.initCameras();\n\t}\n\n\tprivate initCameras()\n\t{\n\t\tthis._depthCameras = new Array();\n\t\tthis._projections = new Array();\n\n\t\t// posX, negX, posY, negY, posZ, negZ\n\t\tthis.addCamera(0, 90, 0);\n\t\tthis.addCamera(0, -90, 0);\n\t\tthis.addCamera(-90, 0, 0);\n\t\tthis.addCamera(90, 0, 0);\n\t\tthis.addCamera(0, 0, 0);\n\t\tthis.addCamera(0, 180, 0);\n\t}\n\n\tprivate addCamera(rotationX:number, rotationY:number, rotationZ:number)\n\t{\n\t\tvar cam:Camera = new Camera();\n\t\tcam.rotationX = rotationX;\n\t\tcam.rotationY = rotationY;\n\t\tcam.rotationZ = rotationZ;\n\t\tcam.projection.near = .01;\n\n\t\tvar projection:PerspectiveProjection = <PerspectiveProjection> cam.projection;\n\t\tprojection.fieldOfView = 90;\n\t\tthis._projections.push(projection);\n\t\tcam.projection._iAspectRatio = 1;\n\t\tthis._depthCameras.push(cam);\n\t}\n\n\t//@override\n\tpublic pCreateDepthTexture():TextureProxyBase\n\t{\n\t\tthrow new PartialImplementationError();\n\t\t/*\n\t\t return new RenderCubeTexture( this._depthMapSize );\n\t\t */\n\t}\n\n\t//@override\n\tpublic pUpdateDepthProjection(viewCamera:Camera)\n\t{\n\t\tvar light:PointLight = <PointLight>(this._pLight);\n\t\tvar maxDistance:number = light._pFallOff;\n\t\tvar pos:Vector3D = this._pLight.scenePosition;\n\n\t\t// todo: faces outside frustum which are pointing away from camera need not be rendered!\n\t\tfor (var i:number = 0; i < 6; ++i) {\n\t\t\tthis._projections[i].far = maxDistance;\n\t\t\tthis._depthCameras[i].transform.position = pos;\n\t\t\tthis._needsRender[i] = true;\n\t\t}\n\t}\n\n\t//@override\n\tpublic pDrawDepthMap(target:RenderTexture, scene:Scene, renderer:IRenderer)\n\t{\n\t\tfor (var i:number = 0; i < 6; ++i) {\n\t\t\tif (this._needsRender[i]) {\n\t\t\t\tthis._pCasterCollector.camera = this._depthCameras[i];\n\t\t\t\tthis._pCasterCollector.clear();\n\t\t\t\tscene.traversePartitions(this._pCasterCollector);\n\t\t\t\trenderer._iRender(this._pCasterCollector, target, null, i)\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport = CubeMapShadowMapper;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport FreeMatrixProjection\t\t\t= require(\"awayjs-core/lib/projections/FreeMatrixProjection\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\nimport RenderTexture\t\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nclass DirectionalShadowMapper extends ShadowMapperBase\n{\n\tpublic _pOverallDepthCamera:Camera;\n\tpublic _pLocalFrustum:Array<number>;\n\n\tpublic _pLightOffset:number = 10000;\n\tpublic _pMatrix:Matrix3D;\n\tpublic _pOverallDepthProjection:FreeMatrixProjection;\n\tpublic _pSnap:number = 64;\n\n\tpublic _pCullPlanes:Array<Plane3D>;\n\tpublic _pMinZ:number;\n\tpublic _pMaxZ:number;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pCullPlanes = [];\n\t\tthis._pOverallDepthProjection = new FreeMatrixProjection();\n\t\tthis._pOverallDepthCamera = new Camera(this._pOverallDepthProjection);\n\t\tthis._pLocalFrustum = [];\n\t\tthis._pMatrix = new Matrix3D();\n\t}\n\n\tpublic get snap():number\n\t{\n\t\treturn this._pSnap;\n\t}\n\n\tpublic set snap(value:number)\n\t{\n\t\tthis._pSnap = value;\n\t}\n\n\tpublic get lightOffset():number\n\t{\n\t\treturn this._pLightOffset;\n\t}\n\n\tpublic set lightOffset(value:number)\n\t{\n\t\tthis._pLightOffset = value;\n\t}\n\n\t//@arcane\n\tpublic get iDepthProjection():Matrix3D\n\t{\n\t\treturn this._pOverallDepthCamera.viewProjection;\n\t}\n\n\t//@arcane\n\tpublic get depth():number\n\t{\n\t\treturn this._pMaxZ - this._pMinZ;\n\t}\n\n\t//@override\n\tpublic pDrawDepthMap(target:TextureProxyBase, scene:Scene, renderer:IRenderer)\n\t{\n\t\tthis._pCasterCollector.camera = this._pOverallDepthCamera;\n\t\tthis._pCasterCollector.cullPlanes = this._pCullPlanes;\n\t\tthis._pCasterCollector.clear();\n\t\tscene.traversePartitions(this._pCasterCollector);\n\t\trenderer._iRender(this._pCasterCollector, target);\n\t}\n\n\t//@protected\n\tpublic pUpdateCullPlanes(viewCamera:Camera)\n\t{\n\t\tvar lightFrustumPlanes:Array<Plane3D> = this._pOverallDepthCamera.frustumPlanes;\n\t\tvar viewFrustumPlanes:Array<Plane3D> = viewCamera.frustumPlanes;\n\t\tthis._pCullPlanes.length = 4;\n\n\t\tthis._pCullPlanes[0] = lightFrustumPlanes[0];\n\t\tthis._pCullPlanes[1] = lightFrustumPlanes[1];\n\t\tthis._pCullPlanes[2] = lightFrustumPlanes[2];\n\t\tthis._pCullPlanes[3] = lightFrustumPlanes[3];\n\n\t\tvar light:DirectionalLight = <DirectionalLight> this._pLight;\n\t\tvar dir:Vector3D = light.sceneDirection;\n\t\tvar dirX:number = dir.x;\n\t\tvar dirY:number = dir.y;\n\t\tvar dirZ:number = dir.z;\n\t\tvar j:number = 4;\n\t\tfor (var i:number = 0; i < 6; ++i) {\n\t\t\tvar plane:Plane3D = viewFrustumPlanes[i];\n\t\t\tif (plane.a*dirX + plane.b*dirY + plane.c*dirZ < 0)\n\t\t\t\tthis._pCullPlanes[j++] = plane;\n\t\t}\n\t}\n\n\t//@override\n\tpublic pUpdateDepthProjection(viewCamera:Camera)\n\t{\n\t\tthis.pUpdateProjectionFromFrustumCorners(viewCamera, viewCamera.projection.frustumCorners, this._pMatrix);\n\t\tthis._pOverallDepthProjection.matrix = this._pMatrix;\n\t\tthis.pUpdateCullPlanes(viewCamera);\n\t}\n\n\tpublic pUpdateProjectionFromFrustumCorners(viewCamera:Camera, corners:Array<number>, matrix:Matrix3D)\n\t{\n\t\tvar raw:Array<number> = new Array<number>();\n\t\tvar dir:Vector3D;\n\t\tvar x:number, y:number, z:number;\n\t\tvar minX:number, minY:number;\n\t\tvar maxX:number, maxY:number;\n\t\tvar i:number;\n\n\t\tvar light:DirectionalLight = <DirectionalLight> this._pLight;\n\t\tdir = light.sceneDirection;\n\t\tthis._pOverallDepthCamera.transform.matrix3D = this._pLight.sceneTransform;\n\t\tx = Math.floor((viewCamera.x - dir.x*this._pLightOffset)/this._pSnap)*this._pSnap;\n\t\ty = Math.floor((viewCamera.y - dir.y*this._pLightOffset)/this._pSnap)*this._pSnap;\n\t\tz = Math.floor((viewCamera.z - dir.z*this._pLightOffset)/this._pSnap)*this._pSnap;\n\t\tthis._pOverallDepthCamera.x = x;\n\t\tthis._pOverallDepthCamera.y = y;\n\t\tthis._pOverallDepthCamera.z = z;\n\n\t\tthis._pMatrix.copyFrom(this._pOverallDepthCamera.inverseSceneTransform);\n\t\tthis._pMatrix.prepend(viewCamera.sceneTransform);\n\t\tthis._pMatrix.transformVectors(corners, this._pLocalFrustum);\n\n\t\tminX = maxX = this._pLocalFrustum[0];\n\t\tminY = maxY = this._pLocalFrustum[1];\n\t\tthis._pMaxZ = this._pLocalFrustum[2];\n\n\t\ti = 3;\n\t\twhile (i < 24) {\n\t\t\tx = this._pLocalFrustum[i];\n\t\t\ty = this._pLocalFrustum[i + 1];\n\t\t\tz = this._pLocalFrustum[i + 2];\n\t\t\tif (x < minX)\n\t\t\t\tminX = x;\n\t\t\tif (x > maxX)\n\t\t\t\tmaxX = x;\n\t\t\tif (y < minY)\n\t\t\t\tminY = y;\n\t\t\tif (y > maxY)\n\t\t\t\tmaxY = y;\n\t\t\tif (z > this._pMaxZ)\n\t\t\t\tthis._pMaxZ = z;\n\t\t\ti += 3;\n\t\t}\n\n\t\tthis._pMinZ = 1;\n\n\t\tvar w:number = maxX - minX;\n\t\tvar h:number = maxY - minY;\n\t\tvar d:number = 1/(this._pMaxZ - this._pMinZ);\n\n\t\tif (minX < 0)\n\t\t\tminX -= this._pSnap; // because int() rounds up for < 0\n\n\t\tif (minY < 0)\n\t\t\tminY -= this._pSnap;\n\n\t\tminX = Math.floor(minX/this._pSnap)*this._pSnap;\n\t\tminY = Math.floor(minY/this._pSnap)*this._pSnap;\n\n\t\tvar snap2:number = 2*this._pSnap;\n\t\tw = Math.floor(w/snap2 + 2)*snap2;\n\t\th = Math.floor(h/snap2 + 2)*snap2;\n\n\t\tmaxX = minX + w;\n\t\tmaxY = minY + h;\n\n\t\tw = 1/w;\n\t\th = 1/h;\n\n\t\traw[0] = 2*w;\n\t\traw[5] = 2*h;\n\t\traw[10] = d;\n\t\traw[12] = -(maxX + minX)*w;\n\t\traw[13] = -(maxY + minY)*h;\n\t\traw[14] = -this._pMinZ*d;\n\t\traw[15] = 1;\n\t\traw[1] = raw[2] = raw[3] = raw[4] = raw[6] = raw[7] = raw[8] = raw[9] = raw[11] = 0;\n\n\t\tmatrix.copyRawDataFrom(raw);\n\t}\n}\n\nexport = DirectionalShadowMapper;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport RenderTexture\t\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nclass ShadowMapperBase\n{\n\n\tpublic _pCasterCollector:ShadowCasterCollector;\n\n\tprivate _depthMap:TextureProxyBase;\n\tpublic _pDepthMapSize:number = 2048;\n\tpublic _pLight:LightBase;\n\tprivate _explicitDepthMap:boolean;\n\tprivate _autoUpdateShadows:boolean = true;\n\tpublic _iShadowsInvalid:boolean;\n\n\tconstructor()\n\t{\n\t\tthis._pCasterCollector = this.pCreateCasterCollector();\n\t}\n\n\tpublic pCreateCasterCollector()\n\t{\n\t\treturn new ShadowCasterCollector();\n\t}\n\n\tpublic get autoUpdateShadows():boolean\n\t{\n\t\treturn this._autoUpdateShadows;\n\t}\n\n\tpublic set autoUpdateShadows(value:boolean)\n\t{\n\t\tthis._autoUpdateShadows = value;\n\t}\n\n\tpublic updateShadows()\n\t{\n\t\tthis._iShadowsInvalid = true;\n\t}\n\n\tpublic iSetDepthMap(depthMap:TextureProxyBase)\n\t{\n\t\tif (this._depthMap == depthMap)\n\t\t\treturn;\n\n\t\tif (this._depthMap && !this._explicitDepthMap)\n\t\t\tthis._depthMap.dispose();\n\n\t\tthis._depthMap = depthMap;\n\n\t\tif (this._depthMap) {\n\t\t\tthis._explicitDepthMap = true;\n\t\t\tthis._pDepthMapSize = this._depthMap.size;\n\t\t} else {\n\t\t\tthis._explicitDepthMap = false;\n\t\t}\n\t}\n\n\tpublic get light():LightBase\n\t{\n\t\treturn this._pLight;\n\t}\n\n\tpublic set light(value:LightBase)\n\t{\n\t\tthis._pLight = value;\n\t}\n\n\tpublic get depthMap():TextureProxyBase\n\t{\n\t\tif (!this._depthMap)\n\t\t\tthis._depthMap = this.pCreateDepthTexture();\n\n\t\treturn this._depthMap;\n\t}\n\n\tpublic get depthMapSize():number\n\t{\n\t\treturn this._pDepthMapSize;\n\t}\n\n\tpublic set depthMapSize(value:number)\n\t{\n\t\tif (value == this._pDepthMapSize)\n\t\t\treturn;\n\n\t\tthis._pSetDepthMapSize(value);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pCasterCollector = null;\n\n\t\tif (this._depthMap && !this._explicitDepthMap)\n\t\t\tthis._depthMap.dispose();\n\n\t\tthis._depthMap = null;\n\t}\n\n\tpublic pCreateDepthTexture():TextureProxyBase\n\t{\n\t\treturn new RenderTexture(this._pDepthMapSize, this._pDepthMapSize);\n\t}\n\n\tpublic iRenderDepthMap(entityCollector:EntityCollector, renderer:IRenderer)\n\t{\n\t\tthis._iShadowsInvalid = false;\n\n\t\tthis.pUpdateDepthProjection(entityCollector.camera);\n\n\t\tif (!this._depthMap)\n\t\t\tthis._depthMap = this.pCreateDepthTexture();\n\n\t\tthis.pDrawDepthMap(this._depthMap, entityCollector.scene, renderer);\n\t}\n\n\tpublic pUpdateDepthProjection(viewCamera:Camera)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic pDrawDepthMap(target:TextureProxyBase, scene:Scene, renderer:IRenderer)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _pSetDepthMapSize(value)\n\t{\n\t\tthis._pDepthMapSize = value;\n\n\t\tif (this._explicitDepthMap) {\n\t\t\tthrow Error(\"Cannot set depth map size for the current renderer.\");\n\t\t} else if (this._depthMap) {\n\t\t\tthis._depthMap.dispose();\n\t\t\tthis._depthMap = null;\n\t\t}\n\t}\n}\n\nexport = ShadowMapperBase;",
    "import EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.CameraNode\n */\nclass CameraNode extends EntityNode\n{\n\tconstructor(camera:IEntity)\n\t{\n\t\tsuper(camera);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\t// todo: dead end for now, if it has a debug mesh, then sure accept that\n\t}\n}\n\nexport = CameraNode;",
    "import EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.DirectionalLightNode\n */\nclass DirectionalLightNode extends EntityNode\n{\n\tprivate _directionalLight:IEntity;\n\n\t/**\n\t *\n\t * @param directionalLight\n\t */\n\tconstructor(directionalLight:IEntity)\n\t{\n\t\tsuper(directionalLight);\n\n\t\tthis._directionalLight = directionalLight;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\tif (traverser.enterNode(this))\n\t\t\ttraverser.applyDirectionalLight(this._directionalLight);\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic isCastingShadow():boolean\n\t{\n\t\treturn false;\n\t}\n}\n\nexport = DirectionalLightNode;",
    "import Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport PartialImplementationError\t= require(\"awayjs-core/lib/errors/PartialImplementationError\");\n\nimport NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.EntityNode\n */\nclass EntityNode extends NodeBase\n{\n\n\tprivate _entity:IEntity;\n\tpublic _iUpdateQueueNext:EntityNode;\n\n\tconstructor(entity:IEntity)\n\t{\n\t\tsuper();\n\t\tthis._entity = entity;\n\t\tthis._iNumEntities = 1;\n\t}\n\n\tpublic get entity():IEntity\n\t{\n\t\treturn this._entity;\n\t}\n\n\tpublic removeFromParent():void\n\t{\n\t\tif (this._iParent)\n\t\t\tthis._iParent.iRemoveNode(this);\n\n\t\tthis._iParent = null;\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic isCastingShadow():boolean\n\t{\n\t\treturn this.entity.castsShadows;\n\t}\n\n\t/**\n\t *\n\t * @param planes\n\t * @param numPlanes\n\t * @returns {boolean}\n\t */\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\tif (!this._entity._iIsVisible())\n\t\t\treturn false;\n\n\t\treturn this._entity.worldBounds.isInFrustum(planes, numPlanes);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\tif (traverser.enterNode(this))\n\t\t\ttraverser.applyEntity(this._entity);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic isIntersectingRay(rayPosition:Vector3D, rayDirection:Vector3D):boolean\n\t{\n\t\tif (!this._entity._iIsVisible())\n\t\t\treturn false;\n\n\t\treturn this._entity.isIntersectingRay(rayPosition, rayDirection);\n\t}\n\n\t/**\n\t *\n\t * @protected\n\t */\n\tpublic _pCreateBoundsPrimitive():IEntity\n\t{\n\t\tthrow new PartialImplementationError();\n\t\t//return this._entity.bounds.boundingEntity;\n\t}\n}\n\nexport = EntityNode;",
    "import EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.LightProbeNode\n */\nclass LightProbeNode extends EntityNode\n{\n\tprivate _lightProbe:IEntity;\n\n\t/**\n\t *\n\t * @param lightProbe\n\t */\n\tconstructor(lightProbe:IEntity)\n\t{\n\t\tsuper(lightProbe);\n\n\t\tthis._lightProbe = lightProbe;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\tif (traverser.enterNode(this))\n\t\t\ttraverser.applyLightProbe(this._lightProbe);\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic isCastingShadow():boolean\n\t{\n\t\treturn false;\n\t}\n}\n\nexport = LightProbeNode;",
    "import Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.NodeBase\n */\nclass NodeBase\n{\n\tprivate _boundsChildrenVisible:boolean;\n\tprivate _explicitBoundsVisible:boolean;\n\tprivate _implicitBoundsVisible:boolean;\n\tpublic _iParent:NodeBase;\n\tpublic _pChildNodes:Array<NodeBase>;\n\tpublic _pNumChildNodes:number = 0;\n\tpublic _pBoundsPrimitive:IEntity;\n\n\tpublic _iNumEntities:number = 0;\n\tpublic _iCollectionMark:number;// = 0;\n\n\t/**\n\t *\n\t */\n\tpublic get boundsVisible():boolean\n\t{\n\t\treturn this._explicitBoundsVisible;\n\t}\n\n\tpublic set boundsVisible(value:boolean)\n\t{\n\t\tif (this._explicitBoundsVisible == value)\n\t\t\treturn;\n\n\t\tthis._explicitBoundsVisible = value;\n\n\t\tthis._iUpdateImplicitBoundsVisible(this._iParent? this._iParent.boundsChildrenVisible : false);\n\n\t}\n\n\tpublic get boundsChildrenVisible():boolean\n\t{\n\t\treturn this._boundsChildrenVisible;\n\t}\n\n\tpublic set boundsChildrenVisible(value:boolean)\n\t{\n\t\tif (this._boundsChildrenVisible == value)\n\t\t\treturn;\n\n\t\tthis._boundsChildrenVisible = value;\n\n\t\tfor (var i:number = 0; i < this._pNumChildNodes; ++i)\n\t\t\tthis._pChildNodes[i]._iUpdateImplicitBoundsVisible(this._boundsChildrenVisible);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get parent():NodeBase\n\t{\n\t\treturn this._iParent;\n\t}\n\n\t/**\n\t *\n\t * @protected\n\t */\n\tpublic get _pNumEntities():number\n\t{\n\t\treturn this._iNumEntities;\n\t}\n\n\t/**\n\t *\n\t */\n\tconstructor()\n\t{\n\t\tthis._pChildNodes = new Array<NodeBase>();\n\t}\n\n\t/**\n\t *\n\t * @param planes\n\t * @param numPlanes\n\t * @returns {boolean}\n\t * @internal\n\t */\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t *\n\t * @param rayPosition\n\t * @param rayDirection\n\t * @returns {boolean}\n\t */\n\tpublic isIntersectingRay(rayPosition:Vector3D, rayDirection:Vector3D):boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic isCastingShadow():boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t * @returns {away.partition.NodeBase}\n\t */\n\tpublic findPartitionForEntity(entity:IEntity):NodeBase\n\t{\n\t\treturn this;\n\t}\n\n\t/**\n\t *\n\t * @param traverser\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\tif (this._pNumEntities == 0 && !this._implicitBoundsVisible)\n\t\t\treturn;\n\n\t\tif (traverser.enterNode(this)) {\n\t\t\tvar i:number = 0;\n\n\t\t\twhile (i < this._pNumChildNodes)\n\t\t\t\tthis._pChildNodes[i++].acceptTraverser(traverser);\n\n\t\t\tif (this._implicitBoundsVisible)\n\t\t\t\tthis._pBoundsPrimitive.partitionNode.acceptTraverser(traverser);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @protected\n\t */\n\tpublic _pCreateBoundsPrimitive():IEntity\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @internal\n\t */\n\tpublic iAddNode(node:NodeBase)\n\t{\n\t\tnode._iParent = this;\n\t\tthis._iNumEntities += node._pNumEntities;\n\t\tthis._pChildNodes[ this._pNumChildNodes++ ] = node;\n\n\t\tnode._iUpdateImplicitBoundsVisible(this.boundsChildrenVisible);\n\n\t\tvar numEntities:number = node._pNumEntities;\n\t\tnode = this;\n\n\t\tdo {\n\t\t\tnode._iNumEntities += numEntities;\n\t\t} while ((node = node._iParent) != null);\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @internal\n\t */\n\tpublic iRemoveNode(node:NodeBase)\n\t{\n\t\tvar index:number = this._pChildNodes.indexOf(node);\n\t\tthis._pChildNodes[index] = this._pChildNodes[--this._pNumChildNodes];\n\t\tthis._pChildNodes.pop();\n\n\t\tnode._iUpdateImplicitBoundsVisible(false);\n\n\t\tvar numEntities:number = node._pNumEntities;\n\t\tnode = this;\n\n\t\tdo {\n\t\t\tnode._pNumEntities -= numEntities;\n\t\t} while ((node = node._iParent) != null);\n\t}\n\n\tprivate _iUpdateImplicitBoundsVisible(value:boolean)\n\t{\n\t\tif (this._implicitBoundsVisible == this._explicitBoundsVisible || value)\n\t\t\treturn;\n\n\t\tthis._implicitBoundsVisible = this._explicitBoundsVisible || value;\n\n\t\tthis._iUpdateEntityBounds();\n\n\t\tfor (var i:number = 0; i < this._pNumChildNodes; ++i)\n\t\t\tthis._pChildNodes[i]._iUpdateImplicitBoundsVisible(this._boundsChildrenVisible);\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tpublic _iIsBoundsVisible():boolean\n\t{\n\t\treturn this._implicitBoundsVisible;\n\t}\n\n//\t\tpublic _pUpdateNumEntities(value:number)\n//\t\t{\n//\t\t\tvar diff:number = value - this._pNumEntities;\n//\t\t\tvar node:NodeBase = this;\n//\n//\t\t\tdo {\n//\t\t\t\tnode._pNumEntities += diff;\n//\t\t\t} while ((node = node._iParent) != null);\n//\t\t}\n\n\tpublic _iUpdateEntityBounds()\n\t{\n\t\tif (this._pBoundsPrimitive) {\n\t\t\tthis._pBoundsPrimitive.dispose();\n\t\t\tthis._pBoundsPrimitive = null;\n\t\t}\n\n\t\tif (this._implicitBoundsVisible)\n\t\t\tthis._pBoundsPrimitive = this._pCreateBoundsPrimitive();\n\t}\n}\n\nexport = NodeBase;",
    "/**\n * @class away.partition.NullNode\n */\nclass NullNode\n{\n\tconstructor()\n\t{\n\t}\n}\n\nexport = NullNode;",
    "import DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport NullNode\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NullNode\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\n\n/**\n * @class away.partition.Partition\n */\nclass Partition\n{\n\n\tpublic _rootNode:NodeBase;\n\tprivate _updatesMade:Boolean = false;\n\tprivate _updateQueue:EntityNode;\n\n\tconstructor(rootNode:NodeBase)\n\t{\n\t\tthis._rootNode = rootNode || <NodeBase> new NullNode();\n\t}\n\n\tpublic get rootNode():NodeBase\n\t{\n\t\treturn this._rootNode;\n\t}\n\n\tpublic traverse(traverser:ICollector)\n\t{\n\t\tif (this._updatesMade)\n\t\t\tthis.updateEntities();\n\n\t\tthis._rootNode.acceptTraverser(traverser);\n\t}\n\n\tpublic iMarkForUpdate(entity:DisplayObject)\n\t{\n\t\tvar node:EntityNode = entity.partitionNode;\n\t\tvar t:EntityNode = this._updateQueue;\n\n\t\twhile (t) {\n\t\t\tif (node == t)\n\t\t\t\treturn;\n\n\t\t\tt = t._iUpdateQueueNext;\n\t\t}\n\n\t\tnode._iUpdateQueueNext = this._updateQueue;\n\n\t\tthis._updateQueue = node;\n\t\tthis._updatesMade = true;\n\t}\n\n\tpublic iRemoveEntity(entity:DisplayObject)\n\t{\n\t\tvar node:EntityNode = entity.partitionNode;\n\t\tvar t:EntityNode;\n\n\t\tnode.removeFromParent();\n\n\t\tif (node == this._updateQueue) {\n\t\t\tthis._updateQueue = node._iUpdateQueueNext;\n\t\t} else {\n\t\t\tt = this._updateQueue;\n\t\t\twhile (t && t._iUpdateQueueNext != node)\n\t\t\t\tt = t._iUpdateQueueNext;\n\n\t\t\tif (t)\n\t\t\t\tt._iUpdateQueueNext = node._iUpdateQueueNext;\n\t\t}\n\n\t\tnode._iUpdateQueueNext = null;\n\n\t\tif (!this._updateQueue)\n\t\t\tthis._updatesMade = false;\n\t}\n\n\tprivate updateEntities()\n\t{\n\t\tvar node:EntityNode = this._updateQueue;\n\t\tvar targetNode:NodeBase;\n\t\tvar t:EntityNode;\n\t\tthis._updateQueue = null;\n\t\tthis._updatesMade = false;\n\n\t\tdo {\n\t\t\ttargetNode = this._rootNode.findPartitionForEntity(node.entity);\n\n\t\t\tif (node.parent != targetNode) {\n\t\t\t\tif (node)\n\t\t\t\t\tnode.removeFromParent();\n\n\t\t\t\ttargetNode.iAddNode(node);\n\t\t\t}\n\n\t\t\tt = node._iUpdateQueueNext;\n\t\t\tnode._iUpdateQueueNext = null;\n\n\t\t\t//required for controllers with autoUpdate set to true\n\t\t\tnode.entity._iInternalUpdate();\n\n\t\t} while ((node = t) != null);\n\t}\n}\n\nexport = Partition;",
    "import NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport EntityNode\t\t\t\t\t= require(\"awayjs-display/lib/partition/EntityNode\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.partition.PointLightNode\n */\nclass PointLightNode extends EntityNode\n{\n\tprivate _pointLight:IEntity;\n\n\t/**\n\t *\n\t * @param pointLight\n\t */\n\tconstructor(pointLight:IEntity)\n\t{\n\t\tsuper(pointLight);\n\n\t\tthis._pointLight = pointLight;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic acceptTraverser(traverser:ICollector)\n\t{\n\t\tif (traverser.enterNode(<NodeBase> this))\n\t\t\ttraverser.applyPointLight(this._pointLight);\n\t}\n\n\t/**\n\t *\n\t * @returns {boolean}\n\t */\n\tpublic isCastingShadow():boolean\n\t{\n\t\treturn false;\n\t}\n}\n\nexport = PointLightNode;",
    "import Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObject\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\n\n/**\n * Value object for a picking collision returned by a picking collider. Created as unique objects on display objects\n *\n * @see away.base.DisplayObject#pickingCollisionVO\n * @see away.core.pick.IPickingCollider\n *\n * @class away.pick.PickingCollisionVO\n */\nclass PickingCollisionVO\n{\n\t/**\n\t * The display object to which this collision object belongs.\n\t */\n\tpublic displayObject:DisplayObject;\n\n\t/**\n\t * The local position of the collision on the entity's surface.\n\t */\n\tpublic localPosition:Vector3D;\n\n\t/**\n\t * The local normal vector at the position of the collision.\n\t */\n\tpublic localNormal:Vector3D;\n\n\t/**\n\t * The uv coordinate at the position of the collision.\n\t */\n\tpublic uv:Point;\n\n\t/**\n\t * The index of the face where the event took pl ace.\n\t */\n\tpublic index:number;\n\n\t/**\n\t * The index of the subGeometry where the event took place.\n\t */\n//\t\tpublic subGeometryIndex:number;\n\n\t/**\n\t * The starting position of the colliding ray in local coordinates.\n\t */\n\tpublic localRayPosition:Vector3D;\n\n\t/**\n\t * The direction of the colliding ray in local coordinates.\n\t */\n\tpublic localRayDirection:Vector3D;\n\n\t/**\n\t * The starting position of the colliding ray in scene coordinates.\n\t */\n\tpublic rayPosition:Vector3D;\n\n\t/**\n\t * The direction of the colliding ray in scene coordinates.\n\t */\n\tpublic rayDirection:Vector3D;\n\n\t/**\n\t * Determines if the ray position is contained within the entity bounds.\n\t *\n\t * @see away3d.entities.Entity#bounds\n\t */\n\tpublic rayOriginIsInsideBounds:boolean;\n\n\t/**\n\t * The distance along the ray from the starting position to the calculated intersection entry point with the entity.\n\t */\n\tpublic rayEntryDistance:number;\n\n\t/**\n\t * The material ownwer associated with a collision.\n\t */\n\tpublic materialOwner:IMaterialOwner;\n\n\t/**\n\t * Creates a new <code>PickingCollisionVO</code> object.\n\t *\n\t * @param entity The entity to which this collision object belongs.\n\t */\n\tconstructor(displayObject:DisplayObject)\n\t{\n\t\tthis.displayObject = displayObject;\n\t}\n\n}\n\nexport = PickingCollisionVO;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport View\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport IPicker\t\t\t\t\t\t= require(\"awayjs-display/lib/pick/IPicker\");\nimport PickingCollisionVO\t\t\t= require(\"awayjs-display/lib/pick/PickingCollisionVO\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport RaycastCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/RaycastCollector\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * Picks a 3d object from a view or scene by 3D raycast calculations.\n * Performs an initial coarse boundary calculation to return a subset of entities whose bounding volumes intersect with the specified ray,\n * then triggers an optional picking collider on individual entity objects to further determine the precise values of the picking ray collision.\n *\n * @class away.pick.RaycastPicker\n */\nclass RaycastPicker implements IPicker\n{\n\tprivate _findClosestCollision:boolean;\n\tprivate _raycastCollector:RaycastCollector;\n\tprivate _ignoredEntities = [];\n\tprivate _onlyMouseEnabled:boolean = true;\n\n\tprivate _entities:Array<IEntity>;\n\tprivate _numEntities:number = 0;\n\tprivate _hasCollisions:boolean;\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get onlyMouseEnabled():boolean\n\t{\n\t\treturn this._onlyMouseEnabled;\n\t}\n\n\tpublic set onlyMouseEnabled(value:boolean)\n\t{\n\t\tthis._onlyMouseEnabled = value;\n\t}\n\n\t/**\n\t * Creates a new <code>RaycastPicker</code> object.\n\t *\n\t * @param findClosestCollision Determines whether the picker searches for the closest bounds collision along the ray,\n\t * or simply returns the first collision encountered. Defaults to false.\n\t */\n\tconstructor(findClosestCollision:boolean = false)\n\t{\n\t\tthis._raycastCollector = new RaycastCollector();\n\n\t\tthis._findClosestCollision = findClosestCollision;\n\t\tthis._entities = new Array<IEntity>();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getViewCollision(x:number, y:number, view:View):PickingCollisionVO\n\t{\n\t\t//update ray\n\t\tvar rayPosition:Vector3D = view.unproject(x, y, 0);\n\t\tvar rayDirection:Vector3D = view.unproject(x, y, 1).subtract(rayPosition);\n\n\t\treturn this.getSceneCollision(rayPosition, rayDirection, view.scene);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic getSceneCollision(rayPosition:Vector3D, rayDirection:Vector3D, scene:Scene):PickingCollisionVO\n\t{\n\t\t//clear collector\n\t\tthis._raycastCollector.clear();\n\n\t\t//setup ray vectors\n\t\tthis._raycastCollector.rayPosition = rayPosition;\n\t\tthis._raycastCollector.rayDirection = rayDirection;\n\n\t\t// collect entities to test\n\t\tscene.traversePartitions(this._raycastCollector);\n\n\t\tthis._numEntities = 0;\n\t\tvar node:EntityListItem = this._raycastCollector.entityHead;\n\t\tvar entity:IEntity;\n\n\t\twhile (node) {\n\t\t\tif (!this.isIgnored(entity = node.entity))\n\t\t\t\tthis._entities[this._numEntities++] = entity;\n\n\t\t\tnode = node.next;\n\t\t}\n\n\t\t//early out if no collisions detected\n\t\tif (!this._numEntities)\n\t\t\treturn null;\n\n\t\treturn this.getPickingCollisionVO(this._raycastCollector);\n\t}\n\n//\t\tpublic getEntityCollision(position:Vector3D, direction:Vector3D, entities:Array<IEntity>):PickingCollisionVO\n//\t\t{\n//\t\t\tthis._numEntities = 0;\n//\n//\t\t\tvar entity:IEntity;\n//\t\t\tvar l:number = entities.length;\n//\n//\t\t\tfor (var c:number = 0; c < l; c++) {\n//\t\t\t\tentity = entities[c];\n//\n//\t\t\t\tif (entity.isIntersectingRay(position, direction))\n//\t\t\t\t\tthis._entities[this._numEntities++] = entity;\n//\t\t\t}\n//\n//\t\t\treturn this.getPickingCollisionVO(this._raycastCollector);\n//\t\t}\n\n\tpublic setIgnoreList(entities)\n\t{\n\t\tthis._ignoredEntities = entities;\n\t}\n\n\tprivate isIgnored(entity:IEntity):boolean\n\t{\n\t\tif (this._onlyMouseEnabled && !entity._iIsMouseEnabled())\n\t\t\treturn true;\n\n\t\tvar len:number = this._ignoredEntities.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tif (this._ignoredEntities[i] == entity)\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\tprivate sortOnNearT(entity1:IEntity, entity2:IEntity):number\n\t{\n\t\treturn entity1._iPickingCollisionVO.rayEntryDistance > entity2._iPickingCollisionVO.rayEntryDistance? 1 : -1;\n\t}\n\n\tprivate getPickingCollisionVO(collector:ICollector):PickingCollisionVO\n\t{\n\t\t// trim before sorting\n\t\tthis._entities.length = this._numEntities;\n\n\t\t// Sort entities from closest to furthest.\n\t\tthis._entities = this._entities.sort(this.sortOnNearT); // TODO - test sort filter in JS\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Evaluate triangle collisions when needed.\n\t\t// Replaces collision data provided by bounds collider with more precise data.\n\t\t// ---------------------------------------------------------------------\n\n\t\tvar shortestCollisionDistance:number = Number.MAX_VALUE;\n\t\tvar bestCollisionVO:PickingCollisionVO;\n\t\tvar pickingCollisionVO:PickingCollisionVO;\n\t\tvar entity:IEntity;\n\t\tvar i:number;\n\n\t\tfor (i = 0; i < this._numEntities; ++i) {\n\t\t\tentity = this._entities[i];\n\t\t\tpickingCollisionVO = entity._iPickingCollisionVO;\n\t\t\tif (entity.pickingCollider) {\n\t\t\t\t// If a collision exists, update the collision data and stop all checks.\n\t\t\t\tif ((bestCollisionVO == null || pickingCollisionVO.rayEntryDistance < bestCollisionVO.rayEntryDistance) && entity._iTestCollision(shortestCollisionDistance, this._findClosestCollision)) {\n\t\t\t\t\tshortestCollisionDistance = pickingCollisionVO.rayEntryDistance;\n\t\t\t\t\tbestCollisionVO = pickingCollisionVO;\n\t\t\t\t\tif (!this._findClosestCollision) {\n\t\t\t\t\t\tthis.updateLocalPosition(pickingCollisionVO);\n\t\t\t\t\t\treturn pickingCollisionVO;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (bestCollisionVO == null || pickingCollisionVO.rayEntryDistance < bestCollisionVO.rayEntryDistance) { // A bounds collision with no triangle collider stops all checks.\n\t\t\t\t// Note: a bounds collision with a ray origin inside its bounds is ONLY ever used\n\t\t\t\t// to enable the detection of a corresponsding triangle collision.\n\t\t\t\t// Therefore, bounds collisions with a ray origin inside its bounds can be ignored\n\t\t\t\t// if it has been established that there is NO triangle collider to test\n\t\t\t\tif (!pickingCollisionVO.rayOriginIsInsideBounds) {\n\t\t\t\t\tthis.updateLocalPosition(pickingCollisionVO);\n\t\t\t\t\treturn pickingCollisionVO;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn bestCollisionVO;\n\t}\n\n\tprivate updateLocalPosition(pickingCollisionVO:PickingCollisionVO)\n\t{\n\t\tvar collisionPos:Vector3D = ( pickingCollisionVO.localPosition == null )? new Vector3D() : pickingCollisionVO.localPosition;\n\n\t\tvar rayDir:Vector3D = pickingCollisionVO.localRayDirection;\n\t\tvar rayPos:Vector3D = pickingCollisionVO.localRayPosition;\n\t\tvar t:number = pickingCollisionVO.rayEntryDistance;\n\t\tcollisionPos.x = rayPos.x + t*rayDir.x;\n\t\tcollisionPos.y = rayPos.y + t*rayDir.y;\n\t\tcollisionPos.z = rayPos.z + t*rayDir.z;\n\t}\n\n\tpublic dispose()\n\t{\n\t\t//TODO\n\t}\n}\n\nexport = RaycastPicker;",
    "import IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.pool.EntityListItem\n */\nclass EntityListItem\n{\n\t/**\n\t *\n\t */\n\tpublic entity:IEntity;\n\n\t/**\n\t *\n\t */\n\tpublic next:EntityListItem;\n}\n\nexport = EntityListItem;",
    "import EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\n\n/**\n * @class away.pool.EntityListItemPool\n */\nclass EntityListItemPool\n{\n\tprivate _pool:Array<EntityListItem>;\n\tprivate _index:number = 0;\n\tprivate _poolSize:number = 0;\n\n\t/**\n\t *\n\t */\n\tconstructor()\n\t{\n\t\tthis._pool = new Array<EntityListItem>();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getItem():EntityListItem\n\t{\n\t\tvar item:EntityListItem;\n\t\tif (this._index == this._poolSize) {\n\t\t\titem = new EntityListItem();\n\t\t\tthis._pool[this._index++] = item;\n\t\t\t++this._poolSize;\n\t\t} else {\n\t\t\titem = this._pool[this._index++];\n\t\t}\n\t\treturn item;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic freeAll()\n\t{\n\t\tthis._index = 0;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pool.length = 0;\n\t}\n}\n\nexport = EntityListItemPool;",
    "import NamedAssetBase\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\n\n/**\n * PrefabBase is an abstract base class for prefabs, which are prebuilt display objects that allow easy cloning and updating\n */\nclass PrefabBase extends NamedAssetBase\n{\n\tpublic _pObjects:Array<DisplayObject> = new Array<DisplayObject>();\n\n//\t\tpublic _pBatchObjects:Array<BatchObject> = new Array<BatchObject>();\n\n\t/**\n\t * Creates a new PrefabBase object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Returns a display object generated from this prefab\n\t */\n\tpublic getNewObject():DisplayObject\n\t{\n\t\tvar object:DisplayObject = this._pCreateObject();\n\n\t\tthis._pObjects.push(object);\n\n\t\treturn object;\n\t}\n\n//\t\tpublic getNewBatchObject():BatchObject\n//\t\t{\n//\t\t\tvar object:BatchObject = this._pCreateBatchObject();\n//\n//\t\t\tthis._pBatchObjects.push(object);\n//\n//\t\t\treturn object;\n//\t\t}\n\n\tpublic _pCreateObject():DisplayObject\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic _iValidate()\n\t{\n\t\t// To be overridden when necessary\n\t}\n}\n\nexport = PrefabBase;",
    "﻿import IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\n\nimport LineSubGeometry\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport PrimitivePrefabBase\t\t= require(\"awayjs-display/lib/prefabs/PrimitivePrefabBase\");\n\n/**\n * A Cube primitive prefab.\n */\nclass PrimitiveCubePrefab extends PrimitivePrefabBase implements IAsset\n{\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _depth:number;\n\tprivate _tile6:boolean;\n\n\tprivate _segmentsW:number;\n\tprivate _segmentsH:number;\n\tprivate _segmentsD:number;\n\n\t/**\n\t * Creates a new Cube object.\n\t * @param width The size of the cube along its X-axis.\n\t * @param height The size of the cube along its Y-axis.\n\t * @param depth The size of the cube along its Z-axis.\n\t * @param segmentsW The number of segments that make up the cube along the X-axis.\n\t * @param segmentsH The number of segments that make up the cube along the Y-axis.\n\t * @param segmentsD The number of segments that make up the cube along the Z-axis.\n\t * @param tile6 The type of uv mapping to use. When true, a texture will be subdivided in a 2x3 grid, each used for a single face. When false, the entire image is mapped on each face.\n\t */\n\tconstructor(width:number = 100, height:number = 100, depth:number = 100, segmentsW:number = 1, segmentsH:number = 1, segmentsD:number = 1, tile6:boolean = true)\n\t{\n\t\tsuper();\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._depth = depth;\n\t\tthis._segmentsW = segmentsW;\n\t\tthis._segmentsH = segmentsH;\n\t\tthis._segmentsD = segmentsD;\n\t\tthis._tile6 = tile6;\n\t}\n\n\t/**\n\t * The size of the cube along its X-axis.\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tthis._width = value;\n\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * The size of the cube along its Y-axis.\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tthis._height = value;\n\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * The size of the cube along its Z-axis.\n\t */\n\tpublic get depth():number\n\t{\n\t\treturn this._depth;\n\t}\n\n\tpublic set depth(value:number)\n\t{\n\t\tthis._depth = value;\n\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * The type of uv mapping to use. When false, the entire image is mapped on each face.\n\t * When true, a texture will be subdivided in a 3x2 grid, each used for a single face.\n\t * Reading the tiles from left to right, top to bottom they represent the faces of the\n\t * cube in the following order: bottom, top, back, left, front, right. This creates\n\t * several shared edges (between the top, front, left and right faces) which simplifies\n\t * texture painting.\n\t */\n\tpublic get tile6():boolean\n\t{\n\t\treturn this._tile6;\n\t}\n\n\tpublic set tile6(value:boolean)\n\t{\n\t\tthis._tile6 = value;\n\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * The number of segments that make up the cube along the X-axis. Defaults to 1.\n\t */\n\tpublic get segmentsW():number\n\t{\n\t\treturn this._segmentsW;\n\t}\n\n\tpublic set segmentsW(value:number)\n\t{\n\t\tthis._segmentsW = value;\n\n\t\tthis._pInvalidateGeometry();\n\t\tthis._pInvalidateUVs();\n\t}\n\n\t/**\n\t * The number of segments that make up the cube along the Y-axis. Defaults to 1.\n\t */\n\tpublic get segmentsH():number\n\t{\n\t\treturn this._segmentsH;\n\t}\n\n\tpublic set segmentsH(value:number)\n\t{\n\t\tthis._segmentsH = value;\n\n\t\tthis._pInvalidateGeometry();\n\t\tthis._pInvalidateUVs();\n\t}\n\n\t/**\n\t * The number of segments that make up the cube along the Z-axis. Defaults to 1.\n\t */\n\tpublic get segmentsD():number\n\t{\n\t\treturn this._segmentsD;\n\t}\n\n\tpublic set segmentsD(value:number)\n\t{\n\t\tthis._segmentsD = value;\n\n\t\tthis._pInvalidateGeometry();\n\t\tthis._pInvalidateUVs();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pBuildGeometry(target:SubGeometryBase, geometryType:string)\n\t{\n\t\tvar indices:Array<number> /*uint*/;\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\n\t\tvar tl:number, tr:number, bl:number, br:number;\n\t\tvar i:number, j:number, inc:number = 0;\n\n\t\tvar vidx:number, fidx:number; // indices\n\t\tvar hw:number, hh:number, hd:number; // halves\n\t\tvar dw:number, dh:number, dd:number; // deltas\n\n\t\tvar outer_pos:number;\n\t\tvar numIndices:number;\n\t\tvar numVertices:number;\n\n\t\t// half cube dimensions\n\t\thw = this._width/2;\n\t\thh = this._height/2;\n\t\thd = this._depth/2;\n\n\t\tif (geometryType == \"triangleSubGeometry\") {\n\n\t\t\tvar triangleGeometry:TriangleSubGeometry = <TriangleSubGeometry> target;\n\n\t\t\tnumVertices = ((this._segmentsW + 1)*(this._segmentsH + 1) + (this._segmentsW + 1)*(this._segmentsD + 1) + (this._segmentsH + 1)*(this._segmentsD + 1))*2;\n\n\t\t\tnumIndices = ((this._segmentsW*this._segmentsH + this._segmentsW*this._segmentsD + this._segmentsH*this._segmentsD)*12);\n\n\t\t\tif (numVertices == triangleGeometry.numVertices && triangleGeometry.indices != null) {\n\t\t\t\tindices = triangleGeometry.indices;\n\t\t\t\tpositions = triangleGeometry.positions;\n\t\t\t\tnormals = triangleGeometry.vertexNormals;\n\t\t\t\ttangents = triangleGeometry.vertexTangents;\n\t\t\t} else {\n\t\t\t\tindices = new Array<number>(numIndices);\n\t\t\t\tpositions = new Array<number>(numVertices*3);\n\t\t\t\tnormals = new Array<number>(numVertices*3);\n\t\t\t\ttangents = new Array<number>(numVertices*3);\n\n\t\t\t\tthis._pInvalidateUVs();\n\t\t\t}\n\n\t\t\tvidx = 0;\n\t\t\tfidx = 0;\n\n\t\t\t// Segment dimensions\n\t\t\tdw = this._width/this._segmentsW;\n\t\t\tdh = this._height/this._segmentsH;\n\t\t\tdd = this._depth/this._segmentsD;\n\n\t\t\tfor (i = 0; i <= this._segmentsW; i++) {\n\t\t\t\touter_pos = -hw + i*dw;\n\n\t\t\t\tfor (j = 0; j <= this._segmentsH; j++) {\n\t\t\t\t\t// front\n\t\t\t\t\tpositions[vidx] = outer_pos;\n\t\t\t\t\tpositions[vidx + 1] = -hh + j*dh;\n\t\t\t\t\tpositions[vidx + 2] = -hd;\n\t\t\t\t\tnormals[vidx] = 0;\n\t\t\t\t\tnormals[vidx + 1] = 0;\n\t\t\t\t\tnormals[vidx + 2] = -1;\n\t\t\t\t\ttangents[vidx] = 1;\n\t\t\t\t\ttangents[vidx + 1] = 0;\n\t\t\t\t\ttangents[vidx + 2] = 0;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\t// back\n\t\t\t\t\tpositions[vidx] = outer_pos;\n\t\t\t\t\tpositions[vidx + 1] = -hh + j*dh;\n\t\t\t\t\tpositions[vidx + 2] = hd;\n\t\t\t\t\tnormals[vidx] = 0;\n\t\t\t\t\tnormals[vidx + 1] = 0;\n\t\t\t\t\tnormals[vidx + 2] = 1;\n\t\t\t\t\ttangents[vidx] = -1;\n\t\t\t\t\ttangents[vidx + 1] = 0;\n\t\t\t\t\ttangents[vidx + 2] = 0;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\tif (i && j) {\n\t\t\t\t\t\ttl = 2*((i - 1)*(this._segmentsH + 1) + (j - 1));\n\t\t\t\t\t\ttr = 2*(i*(this._segmentsH + 1) + (j - 1));\n\t\t\t\t\t\tbl = tl + 2;\n\t\t\t\t\t\tbr = tr + 2;\n\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = bl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tr;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = br + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinc += 2*(this._segmentsW + 1)*(this._segmentsH + 1);\n\n\t\t\tfor (i = 0; i <= this._segmentsW; i++) {\n\t\t\t\touter_pos = -hw + i*dw;\n\n\t\t\t\tfor (j = 0; j <= this._segmentsD; j++) {\n\t\t\t\t\t// top\n\t\t\t\t\tpositions[vidx] = outer_pos;\n\t\t\t\t\tpositions[vidx + 1] = hh;\n\t\t\t\t\tpositions[vidx + 2] = -hd + j*dd;\n\t\t\t\t\tnormals[vidx] = 0;\n\t\t\t\t\tnormals[vidx + 1] = 1;\n\t\t\t\t\tnormals[vidx + 2] = 0;\n\t\t\t\t\ttangents[vidx] = 1;\n\t\t\t\t\ttangents[vidx + 1] = 0;\n\t\t\t\t\ttangents[vidx + 2] = 0;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\t// bottom\n\t\t\t\t\tpositions[vidx] = outer_pos;\n\t\t\t\t\tpositions[vidx + 1] = -hh;\n\t\t\t\t\tpositions[vidx + 2] = -hd + j*dd;\n\t\t\t\t\tnormals[vidx] = 0;\n\t\t\t\t\tnormals[vidx + 1] = -1;\n\t\t\t\t\tnormals[vidx + 2] = 0;\n\t\t\t\t\ttangents[vidx] = 1;\n\t\t\t\t\ttangents[vidx + 1] = 0;\n\t\t\t\t\ttangents[vidx + 2] = 0;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\tif (i && j) {\n\t\t\t\t\t\ttl = inc + 2*((i - 1)*(this._segmentsD + 1) + (j - 1));\n\t\t\t\t\t\ttr = inc + 2*(i*(this._segmentsD + 1) + (j - 1));\n\t\t\t\t\t\tbl = tl + 2;\n\t\t\t\t\t\tbr = tr + 2;\n\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = bl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tr;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = br + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tinc += 2*(this._segmentsW + 1)*(this._segmentsD + 1);\n\n\t\t\tfor (i = 0; i <= this._segmentsD; i++) {\n\t\t\t\touter_pos = hd - i*dd;\n\n\t\t\t\tfor (j = 0; j <= this._segmentsH; j++) {\n\t\t\t\t\t// left\n\t\t\t\t\tpositions[vidx] = -hw;\n\t\t\t\t\tpositions[vidx+1] = -hh + j*dh;\n\t\t\t\t\tpositions[vidx+2] = outer_pos;\n\t\t\t\t\tnormals[vidx] = -1;\n\t\t\t\t\tnormals[vidx+1] = 0;\n\t\t\t\t\tnormals[vidx+2] = 0;\n\t\t\t\t\ttangents[vidx] = 0;\n\t\t\t\t\ttangents[vidx+1] = 0;\n\t\t\t\t\ttangents[vidx+2] = -1;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\t// right\n\t\t\t\t\tpositions[vidx] = hw;\n\t\t\t\t\tpositions[vidx+1] = -hh + j*dh;\n\t\t\t\t\tpositions[vidx+2] = outer_pos;\n\t\t\t\t\tnormals[vidx] = 1;\n\t\t\t\t\tnormals[vidx+1] = 0;\n\t\t\t\t\tnormals[vidx+2] = 0;\n\t\t\t\t\ttangents[vidx] = 0;\n\t\t\t\t\ttangents[vidx+1] = 0;\n\t\t\t\t\ttangents[vidx+2] = 1;\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\tif (i && j) {\n\t\t\t\t\t\ttl = inc + 2*((i - 1)*(this._segmentsH + 1) + (j - 1));\n\t\t\t\t\t\ttr = inc + 2*(i*(this._segmentsH + 1) + (j - 1));\n\t\t\t\t\t\tbl = tl + 2;\n\t\t\t\t\t\tbr = tr + 2;\n\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = bl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tl;\n\t\t\t\t\t\tindices[fidx++] = br;\n\t\t\t\t\t\tindices[fidx++] = tr;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = br + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tr + 1;\n\t\t\t\t\t\tindices[fidx++] = bl + 1;\n\t\t\t\t\t\tindices[fidx++] = tl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttriangleGeometry.updateIndices(indices);\n\n\t\t\ttriangleGeometry.updatePositions(positions);\n\t\t\ttriangleGeometry.updateVertexNormals(normals);\n\t\t\ttriangleGeometry.updateVertexTangents(tangents);\n\n\t\t} else if (geometryType == \"lineSubGeometry\") {\n\t\t\tvar lineGeometry:LineSubGeometry = <LineSubGeometry> target;\n\n\t\t\tvar numSegments:number = this._segmentsH*4 +  this._segmentsW*4 + this._segmentsD*4;\n\t\t\tvar startPositions:Array<number>;\n\t\t\tvar endPositions:Array<number>;\n\t\t\tvar thickness:Array<number>;\n\n\t\t\tif (lineGeometry.indices != null && numSegments == lineGeometry.numSegments) {\n\t\t\t\tstartPositions = lineGeometry.startPositions;\n\t\t\t\tendPositions = lineGeometry.endPositions;\n\t\t\t\tthickness = lineGeometry.thickness;\n\t\t\t} else {\n\t\t\t\tstartPositions = new Array<number>(numSegments*3);\n\t\t\t\tendPositions = new Array<number>(numSegments*3);\n\t\t\t\tthickness = new Array<number>(numSegments);\n\t\t\t}\n\n\t\t\tvidx = 0;\n\n\t\t\tfidx = 0;\n\n\t\t\t//front/back face\n\t\t\tfor (i = 0; i < this._segmentsH; ++i) {\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = i*this._height/this._segmentsH - hh;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = i*this._height/this._segmentsH - hh\n\t\t\t\tendPositions[vidx + 2] = -hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = hh - i*this._height/this._segmentsH;\n\t\t\t\tstartPositions[vidx + 2] = hd;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = hh - i*this._height/this._segmentsH;\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\t\t\tfor (i = 0; i < this._segmentsW; ++i) {\n\t\t\t\tstartPositions[vidx] = i*this._width/this._segmentsW - hw;\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = i*this._width/this._segmentsW - hw;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = -hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = hw - i*this._width/this._segmentsW;\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = hd;\n\n\t\t\t\tendPositions[vidx] = hw - i*this._width/this._segmentsW;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\t\t\t//left/right face\n\t\t\tfor (i = 0; i < this._segmentsH; ++i) {\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = i*this._height/this._segmentsH - hh;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = -hw;\n\t\t\t\tendPositions[vidx + 1] = i*this._height/this._segmentsH - hh\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = hw;\n\t\t\t\tstartPositions[vidx + 1] = hh - i*this._height/this._segmentsH;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = hh - i*this._height/this._segmentsH;\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\t\t\tfor (i = 0; i < this._segmentsD; ++i) {\n\t\t\t\tstartPositions[vidx] = hw\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = i*this._depth/this._segmentsD - hd;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = i*this._depth/this._segmentsD - hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = hd - i*this._depth/this._segmentsD;\n\n\t\t\t\tendPositions[vidx] = -hw;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = hd - i*this._depth/this._segmentsD;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\n\t\t\t//top/bottom face\n\t\t\tfor (i = 0; i < this._segmentsD; ++i) {\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = hd - i*this._depth/this._segmentsD;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = -hh;\n\t\t\t\tendPositions[vidx + 2] = hd - i*this._depth/this._segmentsD;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = -hw;\n\t\t\t\tstartPositions[vidx + 1] = hh;\n\t\t\t\tstartPositions[vidx + 2] = i*this._depth/this._segmentsD - hd;\n\n\t\t\t\tendPositions[vidx] = hw;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = i*this._depth/this._segmentsD - hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\t\t\tfor (i = 0; i < this._segmentsW; ++i) {\n\t\t\t\tstartPositions[vidx] = hw - i*this._width/this._segmentsW;\n\t\t\t\tstartPositions[vidx + 1] = -hh;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = hw - i*this._width/this._segmentsW;\n\t\t\t\tendPositions[vidx + 1] = -hh;\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\n\t\t\t\tstartPositions[vidx] = i*this._width/this._segmentsW - hw;\n\t\t\t\tstartPositions[vidx + 1] = hh;\n\t\t\t\tstartPositions[vidx + 2] = -hd;\n\n\t\t\t\tendPositions[vidx] = i*this._width/this._segmentsW - hw;\n\t\t\t\tendPositions[vidx + 1] = hh;\n\t\t\t\tendPositions[vidx + 2] = hd;\n\n\t\t\t\tthickness[fidx++] = 1;\n\n\t\t\t\tvidx += 3;\n\t\t\t}\n\n\t\t\t// build real data from raw data\n\t\t\tlineGeometry.updatePositions(startPositions, endPositions);\n\t\t\tlineGeometry.updateThickness(thickness);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pBuildUVs(target:SubGeometryBase, geometryType:string)\n\t{\n\t\tvar i:number, j:number, index:number;\n\t\tvar uvs:Array<number>;\n\n\t\tvar u_tile_dim:number, v_tile_dim:number;\n\t\tvar u_tile_step:number, v_tile_step:number;\n\t\tvar tl0u:number, tl0v:number;\n\t\tvar tl1u:number, tl1v:number;\n\t\tvar du:number, dv:number;\n\t\tvar numVertices:number;\n\n\t\tif (geometryType == \"triangleSubGeometry\") {\n\n\t\t\tnumVertices = ((this._segmentsW + 1)*(this._segmentsH + 1) + (this._segmentsW + 1)*(this._segmentsD + 1) + (this._segmentsH + 1)*(this._segmentsD + 1))*2;\n\n\t\t\tvar triangleGeometry:TriangleSubGeometry = <TriangleSubGeometry> target;\n\n\t\t\tif (numVertices == triangleGeometry.numVertices && triangleGeometry.uvs != null) {\n\t\t\t\tuvs = triangleGeometry.uvs;\n\t\t\t} else {\n\t\t\t\tuvs = new Array<number>(numVertices*2);\n\t\t\t}\n\n\t\t\tif (this._tile6) {\n\t\t\t\tu_tile_dim = u_tile_step = 1/3;\n\t\t\t\tv_tile_dim = v_tile_step = 1/2;\n\t\t\t} else {\n\t\t\t\tu_tile_dim = v_tile_dim = 1;\n\t\t\t\tu_tile_step = v_tile_step = 0;\n\t\t\t}\n\n\t\t\t// Create planes two and two, the same way that they were\n\t\t\t// constructed in the buildGeometry() function. First calculate\n\t\t\t// the top-left UV coordinate for both planes, and then loop\n\t\t\t// over the points, calculating the UVs from these numbers.\n\n\t\t\t// When tile6 is true, the layout is as follows:\n\t\t\t//       .-----.-----.-----. (1,1)\n\t\t\t//       | Bot |  T  | Bak |\n\t\t\t//       |-----+-----+-----|\n\t\t\t//       |  L  |  F  |  R  |\n\t\t\t// (0,0)'-----'-----'-----'\n\n\t\t\tindex = 0;\n\n\t\t\t// FRONT / BACK\n\t\t\ttl0u = 1*u_tile_step;\n\t\t\ttl0v = 1*v_tile_step;\n\t\t\ttl1u = 2*u_tile_step;\n\t\t\ttl1v = 0*v_tile_step;\n\t\t\tdu = u_tile_dim/this._segmentsW;\n\t\t\tdv = v_tile_dim/this._segmentsH;\n\t\t\tfor (i = 0; i <= this._segmentsW; i++) {\n\t\t\t\tfor (j = 0; j <= this._segmentsH; j++) {\n\t\t\t\t\tuvs[index++] = ( tl0u + i*du )*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl0v + (v_tile_dim - j*dv))*triangleGeometry.scaleV;\n\n\t\t\t\t\tuvs[index++] = ( tl1u + (u_tile_dim - i*du))*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl1v + (v_tile_dim - j*dv))*triangleGeometry.scaleV;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// TOP / BOTTOM\n\t\t\ttl0u = 1*u_tile_step;\n\t\t\ttl0v = 0*v_tile_step;\n\t\t\ttl1u = 0*u_tile_step;\n\t\t\ttl1v = 0*v_tile_step;\n\t\t\tdu = u_tile_dim/this._segmentsW;\n\t\t\tdv = v_tile_dim/this._segmentsD;\n\t\t\tfor (i = 0; i <= this._segmentsW; i++) {\n\t\t\t\tfor (j = 0; j <= this._segmentsD; j++) {\n\t\t\t\t\tuvs[index++] = ( tl0u + i*du)*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl0v + (v_tile_dim - j*dv))*triangleGeometry.scaleV;\n\n\t\t\t\t\tuvs[index++] = ( tl1u + i*du)*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl1v + j*dv)*triangleGeometry.scaleV;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// LEFT / RIGHT\n\t\t\ttl0u = 0*u_tile_step;\n\t\t\ttl0v = 1*v_tile_step;\n\t\t\ttl1u = 2*u_tile_step;\n\t\t\ttl1v = 1*v_tile_step;\n\t\t\tdu = u_tile_dim/this._segmentsD;\n\t\t\tdv = v_tile_dim/this._segmentsH;\n\t\t\tfor (i = 0; i <= this._segmentsD; i++) {\n\t\t\t\tfor (j = 0; j <= this._segmentsH; j++) {\n\t\t\t\t\tuvs[index++] = ( tl0u + i*du)*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl0v + (v_tile_dim - j*dv))*triangleGeometry.scaleV;\n\n\t\t\t\t\tuvs[index++] = ( tl1u + (u_tile_dim - i*du))*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( tl1v + (v_tile_dim - j*dv))*triangleGeometry.scaleV;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttriangleGeometry.updateUVs(uvs);\n\n\t\t} else if (geometryType == \"lineSubGeometry\") {\n\t\t\t//nothing to do here\n\t\t}\n\t}\n}\n\nexport = PrimitiveCubePrefab;",
    "import AssetType\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Geometry\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport LineSubGeometry\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport Mesh\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport MaterialBase\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport PrefabBase\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrefabBase\");\n\n/**\n * PrimitivePrefabBase is an abstract base class for polytope prefabs, which are simple pre-built geometric shapes\n */\nclass PrimitivePrefabBase extends PrefabBase\n{\n\tpublic _geomDirty:boolean = true;\n\tpublic _uvDirty:boolean = true;\n\n\tprivate _material:MaterialBase;\n\tprivate _geometry:Geometry;\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _geometryType:string;\n\tprivate _geometryTypeDirty:boolean = true;\n\n\n\t/**\n\t *\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.PRIMITIVE_PREFAB;\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic get geometryType():string\n\t{\n\t\treturn this._geometryType;\n\t}\n\t\n\tpublic set geometryType(value:string)\n\t{\n\t\tif (this._geometryType == value)\n\t\t\treturn;\n\n\t\tthis._geometryType = value;\n\t\t\n\t\tthis.invalidateGeometryType();\n\t}\n\n\tpublic get geometry():Geometry\n\t{\n\t\tthis._iValidate();\n\n\t\treturn this._geometry;\n\t}\n\n\t/**\n\t * The material with which to render the primitive.\n\t */\n\tpublic get material():MaterialBase\n\t{\n\t\treturn this._material;\n\t}\n\n\tpublic set material(value:MaterialBase)\n\t{\n\t\tif (value == this._material)\n\t\t\treturn;\n\n\t\tthis._material = value;\n\n\t\tvar len:number = this._pObjects.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t(<Mesh> this._pObjects[i]).material = this._material;\n\t}\n\n\t/**\n\t * Creates a new PrimitivePrefabBase object.\n\t *\n\t * @param material The material with which to render the object\n\t */\n\tconstructor(material:MaterialBase = null, geometryType:string = \"triangleSubGeometry\")\n\t{\n\t\tsuper();\n\n\t\tthis._geometry = new Geometry();\n\t\tthis._material = material;\n\t\tthis._geometryType = geometryType;\n\t}\n\n\t/**\n\t * Builds the primitive's geometry when invalid. This method should not be called directly. The calling should\n\t * be triggered by the invalidateGeometry method (and in turn by updateGeometry).\n\t */\n\tpublic _pBuildGeometry(target:SubGeometryBase, geometryType:string)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Builds the primitive's uv coordinates when invalid. This method should not be called directly. The calling\n\t * should be triggered by the invalidateUVs method (and in turn by updateUVs).\n\t */\n\tpublic _pBuildUVs(target:SubGeometryBase, geometryType:string)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Invalidates the primitive's geometry type, causing it to be updated when requested.\n\t */\n\tpublic invalidateGeometryType()\n\t{\n\t\tthis._geometryTypeDirty = true;\n\t\tthis._geomDirty = true;\n\t\tthis._uvDirty = true;\n\t}\n\t\n\t/**\n\t * Invalidates the primitive's geometry, causing it to be updated when requested.\n\t */\n\tpublic _pInvalidateGeometry()\n\t{\n\t\tthis._geomDirty = true;\n\t}\n\n\t/**\n\t * Invalidates the primitive's uv coordinates, causing them to be updated when requested.\n\t */\n\tpublic _pInvalidateUVs()\n\t{\n\t\tthis._uvDirty = true;\n\t}\n\n\t/**\n\t * Updates the subgeometry when invalid.\n\t */\n\tprivate updateGeometryType()\n\t{\n\t\t//remove any existing sub geometry\n\t\tif (this._subGeometry)\n\t\t\tthis._geometry.removeSubGeometry(this._subGeometry);\n\n\t\tif (this._geometryType == \"triangleSubGeometry\") {\n\t\t\tvar triangleGeometry:TriangleSubGeometry = new TriangleSubGeometry(true);\n\t\t\ttriangleGeometry.autoDeriveNormals = false;\n\t\t\ttriangleGeometry.autoDeriveTangents = false;\n\t\t\ttriangleGeometry.autoDeriveUVs = false;\n\t\t\tthis._geometry.addSubGeometry(triangleGeometry);\n\t\t\tthis._subGeometry = triangleGeometry;\n\t\t} else if (this._geometryType == \"lineSubGeometry\") {\n\t\t\tthis._geometry.addSubGeometry(this._subGeometry = new LineSubGeometry());\n\t\t}\n\n\t\tthis._geometryTypeDirty = false;\n\t}\n\n\t\n\t/**\n\t * Updates the geometry when invalid.\n\t */\n\tprivate updateGeometry()\n\t{\n\t\tthis._pBuildGeometry(this._subGeometry, this._geometryType);\n\n\t\tthis._geomDirty = false;\n\t}\n\n\t/**\n\t * Updates the uv coordinates when invalid.\n\t */\n\tprivate updateUVs()\n\t{\n\t\tthis._pBuildUVs(this._subGeometry, this._geometryType);\n\n\t\tthis._uvDirty = false;\n\t}\n\n\tpublic _iValidate()\n\t{\n\t\tif (this._geometryTypeDirty)\n\t\t\tthis.updateGeometryType();\n\t\t\n\t\tif (this._geomDirty)\n\t\t\tthis.updateGeometry();\n\n\t\tif (this._uvDirty)\n\t\t\tthis.updateUVs();\n\t}\n\n\n\tpublic _pCreateObject():DisplayObject\n\t{\n\t\tvar mesh:Mesh = new Mesh(this._geometry, this._material);\n\t\tmesh._iSourcePrefab = this;\n\n\t\treturn mesh;\n\t}\n\n\n//\t\tpublic _pCreateBatchObject():BatchObject\n//\t\t{\n//\t\t\tvar batch:BatchObject = new BatchObject(this._geometry, this._material);\n//\t\t\tbatch._iSourcePrefab = this;\n//\n//\t\t\treturn batch;\n//\t\t}\n}\n\nexport = PrimitivePrefabBase;",
    "import IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\n\nimport SubGeometryBase\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport PrimitivePrefabBase\t\t= require(\"awayjs-display/lib/prefabs/PrimitivePrefabBase\");\n\n/**\n * A UV Cylinder primitive mesh.\n */\nclass PrimitiveTorusPrefab extends PrimitivePrefabBase implements IAsset\n{\n\tprivate _radius:number;\n\tprivate _tubeRadius:number;\n\tprivate _segmentsR:number;\n\tprivate _segmentsT:number;\n\tprivate _yUp:boolean;\n\tprivate _numVertices:number = 0;\n\n\t/**\n\t * The radius of the torus.\n\t */\n\tpublic get radius():number\n\t{\n\t\treturn this._radius;\n\t}\n\n\tpublic set radius(value:number)\n\t{\n\t\tthis._radius = value;\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * The radius of the inner tube of the torus.\n\t */\n\tpublic get tubeRadius():number\n\t{\n\t\treturn this._tubeRadius;\n\t}\n\n\tpublic set tubeRadius(value:number)\n\t{\n\t\tthis._tubeRadius = value;\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * Defines the number of horizontal segments that make up the torus. Defaults to 16.\n\t */\n\tpublic get segmentsR():number\n\t{\n\t\treturn this._segmentsR;\n\t}\n\n\tpublic set segmentsR(value:number)\n\t{\n\t\tthis._segmentsR = value;\n\t\tthis._pInvalidateGeometry();\n\t\tthis._pInvalidateUVs();\n\t}\n\n\t/**\n\t * Defines the number of vertical segments that make up the torus. Defaults to 8.\n\t */\n\tpublic get segmentsT():number\n\t{\n\t\treturn this._segmentsT;\n\t}\n\n\tpublic set segmentsT(value:number)\n\t{\n\t\tthis._segmentsT = value;\n\t\tthis._pInvalidateGeometry();\n\t\tthis._pInvalidateUVs();\n\t}\n\n\t/**\n\t * Defines whether the torus poles should lay on the Y-axis (true) or on the Z-axis (false).\n\t */\n\tpublic get yUp():boolean\n\t{\n\t\treturn this._yUp;\n\t}\n\n\tpublic set yUp(value:boolean)\n\t{\n\t\tthis._yUp = value;\n\t\tthis._pInvalidateGeometry();\n\t}\n\n\t/**\n\t * Creates a new <code>Torus</code> object.\n\t * @param radius The radius of the torus.\n\t * @param tuebRadius The radius of the inner tube of the torus.\n\t * @param segmentsR Defines the number of horizontal segments that make up the torus.\n\t * @param segmentsT Defines the number of vertical segments that make up the torus.\n\t * @param yUp Defines whether the torus poles should lay on the Y-axis (true) or on the Z-axis (false).\n\t */\n\tconstructor(radius:number = 50, tubeRadius:number = 50, segmentsR:number = 16, segmentsT:number = 8, yUp:boolean = true)\n\t{\n\t\tsuper();\n\n\t\tthis._radius = radius;\n\t\tthis._tubeRadius = tubeRadius;\n\t\tthis._segmentsR = segmentsR;\n\t\tthis._segmentsT = segmentsT;\n\t\tthis._yUp = yUp;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pBuildGeometry(target:SubGeometryBase, geometryType:string)\n\t{\n\t\tvar indices:Array<number> /*uint*/;\n\t\tvar positions:Array<number>;\n\t\tvar normals:Array<number>;\n\t\tvar tangents:Array<number>;\n\n\t\tvar i:number, j:number;\n\t\tvar x:number, y:number, z:number, nx:number, ny:number, nz:number, revolutionAngleR:number, revolutionAngleT:number;\n\t\tvar vidx:number;\n\t\tvar fidx:number;\n\t\tvar numIndices:number = 0;\n\n\t\tif (geometryType == \"triangleSubGeometry\") {\n\n\t\t\tvar triangleGeometry:TriangleSubGeometry = <TriangleSubGeometry> target;\n\n\t\t\t// evaluate target number of vertices, triangles and indices\n\t\t\tthis._numVertices = (this._segmentsT + 1)*(this._segmentsR + 1); // segmentsT + 1 because of closure, segmentsR + 1 because of closure\n\t\t\tnumIndices = this._segmentsT*this._segmentsR*6; // each level has segmentR quads, each of 2 triangles\n\n\t\t\t// need to initialize raw arrays or can be reused?\n\t\t\tif (this._numVertices == triangleGeometry.numVertices) {\n\t\t\t\tindices = triangleGeometry.indices;\n\t\t\t\tpositions = triangleGeometry.positions;\n\t\t\t\tnormals = triangleGeometry.vertexNormals;\n\t\t\t\ttangents = triangleGeometry.vertexTangents;\n\t\t\t} else {\n\t\t\t\tindices = new Array<number>(numIndices)\n\t\t\t\tpositions = new Array<number>(this._numVertices*3);\n\t\t\t\tnormals = new Array<number>(this._numVertices*3);\n\t\t\t\ttangents = new Array<number>(this._numVertices*3);\n\n\t\t\t\tthis._pInvalidateUVs();\n\t\t\t}\n\n\n\t\t\tvidx = 0;\n\t\t\tfidx = 0;\n\n\t\t\t// evaluate revolution steps\n\t\t\tvar revolutionAngleDeltaR:number = 2*Math.PI/this._segmentsR;\n\t\t\tvar revolutionAngleDeltaT:number = 2*Math.PI/this._segmentsT;\n\n\t\t\tvar comp1:number, comp2:number;\n\t\t\tvar t1:number, t2:number, n1:number, n2:number;\n\t\t\tvar startIndex:number = 0;\n\t\t\tvar nextVertexIndex:number = 0;\n\n\t\t\t// surface\n\t\t\tvar a:number, b:number, c:number, d:number, length:number;\n\n\t\t\tfor (j = 0; j <= this._segmentsT; ++j) {\n\n\t\t\t\tstartIndex = nextVertexIndex*3;\n\n\t\t\t\tfor (i = 0; i <= this._segmentsR; ++i) {\n\n\t\t\t\t\t// revolution vertex\n\t\t\t\t\trevolutionAngleR = i*revolutionAngleDeltaR;\n\t\t\t\t\trevolutionAngleT = j*revolutionAngleDeltaT;\n\n\t\t\t\t\tlength = Math.cos(revolutionAngleT);\n\t\t\t\t\tnx = length*Math.cos(revolutionAngleR);\n\t\t\t\t\tny = length*Math.sin(revolutionAngleR);\n\t\t\t\t\tnz = Math.sin(revolutionAngleT);\n\n\t\t\t\t\tx = this._radius*Math.cos(revolutionAngleR) + this._tubeRadius*nx;\n\t\t\t\t\ty = this._radius*Math.sin(revolutionAngleR) + this._tubeRadius*ny;\n\t\t\t\t\tz = (j == this._segmentsT)? 0 : this._tubeRadius*nz;\n\n\t\t\t\t\tif (this._yUp) {\n\n\t\t\t\t\t\tn1 = -nz;\n\t\t\t\t\t\tn2 = ny;\n\t\t\t\t\t\tt1 = 0;\n\t\t\t\t\t\tt2 = (length? nx/length : x/this._radius);\n\t\t\t\t\t\tcomp1 = -z;\n\t\t\t\t\t\tcomp2 = y;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tn1 = ny;\n\t\t\t\t\t\tn2 = nz;\n\t\t\t\t\t\tt1 = (length? nx/length : x/this._radius);\n\t\t\t\t\t\tt2 = 0;\n\t\t\t\t\t\tcomp1 = y;\n\t\t\t\t\t\tcomp2 = z;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i == this._segmentsR) {\n\t\t\t\t\t\tpositions[vidx] = x;\n\t\t\t\t\t\tpositions[vidx + 1] = positions[startIndex + 1];\n\t\t\t\t\t\tpositions[vidx + 2] = positions[startIndex + 2];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpositions[vidx] = x;\n\t\t\t\t\t\tpositions[vidx + 1] = comp1;\n\t\t\t\t\t\tpositions[vidx + 2] = comp2;\n\t\t\t\t\t}\n\n\t\t\t\t\tnormals[vidx] = nx;\n\t\t\t\t\tnormals[vidx + 1] = n1;\n\t\t\t\t\tnormals[vidx + 2] = n2;\n\t\t\t\t\ttangents[vidx] = -(length? ny/length : y/this._radius);\n\t\t\t\t\ttangents[vidx + 1] = t1;\n\t\t\t\t\ttangents[vidx + 2] = t2;\n\n\t\t\t\t\tvidx += 3;\n\n\t\t\t\t\t// close triangle\n\t\t\t\t\tif (i > 0 && j > 0) {\n\t\t\t\t\t\ta = nextVertexIndex; // current\n\t\t\t\t\t\tb = nextVertexIndex - 1; // previous\n\t\t\t\t\t\tc = b - this._segmentsR - 1; // previous of last level\n\t\t\t\t\t\td = a - this._segmentsR - 1; // current of last level\n\n\t\t\t\t\t\tindices[fidx++] = a;\n\t\t\t\t\t\tindices[fidx++] = b;\n\t\t\t\t\t\tindices[fidx++] = c;\n\n\t\t\t\t\t\tindices[fidx++] = a;\n\t\t\t\t\t\tindices[fidx++] = c;\n\t\t\t\t\t\tindices[fidx++] = d;\n\t\t\t\t\t}\n\n\t\t\t\t\tnextVertexIndex++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// build real data from raw data\n\t\t\ttriangleGeometry.updateIndices(indices);\n\n\t\t\ttriangleGeometry.updatePositions(positions);\n\t\t\ttriangleGeometry.updateVertexNormals(normals);\n\t\t\ttriangleGeometry.updateVertexTangents(tangents);\n\n\t\t} else if (geometryType == \"lineSubGeometry\") {\n\t\t\t//TODO\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pBuildUVs(target:SubGeometryBase, geometryType:string)\n\t{\n\n\t\tvar i:number, j:number;\n\t\tvar uvs:Array<number>;\n\n\n\t\tif (geometryType == \"triangleSubGeometry\") {\n\n\t\t\tvar triangleGeometry:TriangleSubGeometry = <TriangleSubGeometry> target;\n\n\t\t\t// need to initialize raw array or can be reused?\n\t\t\tif (triangleGeometry.uvs && this._numVertices == triangleGeometry.numVertices) {\n\t\t\t\tuvs = triangleGeometry.uvs;\n\t\t\t} else {\n\t\t\t\tuvs = new Array<number>(this._numVertices*2);\n\t\t\t}\n\n\t\t\t// current uv component index\n\t\t\tvar index:number = 0;\n\n\t\t\t// surface\n\t\t\tfor (j = 0; j <= this._segmentsT; ++j) {\n\t\t\t\tfor (i = 0; i <= this._segmentsR; ++i) {\n\t\t\t\t\t// revolution vertex\n\t\t\t\t\tuvs[index++] = ( i/this._segmentsR )*triangleGeometry.scaleU;\n\t\t\t\t\tuvs[index++] = ( j/this._segmentsT )*triangleGeometry.scaleV;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// build real data from raw data\n\t\t\ttriangleGeometry.updateUVs(uvs);\n\n\t\t} else if (geometryType == \"lineSubGeometry\") {\n\t\t\t//nothing to do here\n\t\t}\n\t}\n}\n\nexport = PrimitiveTorusPrefab;",
    "import Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\n\nimport Scene\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/Scene\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport EntityListItemPool\t\t\t= require(\"awayjs-display/lib/pool/EntityListItemPool\");\nimport NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * @class away.traverse.CollectorBase\n */\nclass CollectorBase implements ICollector\n{\n\tpublic scene:Scene;\n\n\tpublic _pEntityHead:EntityListItem;\n\tpublic _pEntityListItemPool:EntityListItemPool;\n\tpublic _pCamera:Camera;\n\tprivate _customCullPlanes:Array<Plane3D>;\n\tprivate _cullPlanes:Array<Plane3D>;\n\tprivate _numCullPlanes:number = 0;\n\tpublic _pNumEntities:number = 0;\n\tpublic _pNumInteractiveEntities:number = 0;\n\n\tconstructor()\n\t{\n\t\tthis._pEntityListItemPool = new EntityListItemPool();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get camera():Camera\n\t{\n\t\treturn this._pCamera;\n\t}\n\n\tpublic set camera(value:Camera)\n\t{\n\t\tthis._pCamera = value;\n\t\tthis._cullPlanes = this._pCamera.frustumPlanes;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get cullPlanes():Array<Plane3D>\n\t{\n\t\treturn this._customCullPlanes;\n\t}\n\n\tpublic set cullPlanes(value:Array<Plane3D>)\n\t{\n\t\tthis._customCullPlanes = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get entityHead():EntityListItem\n\t{\n\t\treturn this._pEntityHead;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numEntities():number\n\t{\n\t\treturn this._pNumEntities;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numInteractiveEntities():number\n\t{\n\t\treturn this._pNumInteractiveEntities;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clear()\n\t{\n\t\tthis._pNumEntities = this._pNumInteractiveEntities = 0;\n\t\tthis._cullPlanes = this._customCullPlanes? this._customCullPlanes : ( this._pCamera? this._pCamera.frustumPlanes : null );\n\t\tthis._numCullPlanes = this._cullPlanes? this._cullPlanes.length : 0;\n\t\tthis._pEntityHead = null;\n\t\tthis._pEntityListItemPool.freeAll();\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @returns {boolean}\n\t */\n\tpublic enterNode(node:NodeBase):boolean\n\t{\n\t\tvar enter:boolean = this.scene._iCollectionMark != node._iCollectionMark && node.isInFrustum(this._cullPlanes, this._numCullPlanes);\n\n\t\tnode._iCollectionMark = this.scene._iCollectionMark;\n\n\t\treturn enter;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyDirectionalLight(entity:IEntity)\n\t{\n\t\t//don't do anything here\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyEntity(entity:IEntity)\n\t{\n\t\tthis._pNumEntities++;\n\n\t\tif (entity._iIsMouseEnabled())\n\t\t\tthis._pNumInteractiveEntities++;\n\n\t\tvar item:EntityListItem = this._pEntityListItemPool.getItem();\n\t\titem.entity = entity;\n\n\t\titem.next = this._pEntityHead;\n\t\tthis._pEntityHead = item;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyLightProbe(entity:IEntity)\n\t{\n\t\t//don't do anything here\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyPointLight(entity:IEntity)\n\t{\n\t\t//don't do anything here\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applySkybox(entity:IEntity)\n\t{\n\t\t//don't do anything here\n\t}\n}\n\nexport = CollectorBase;",
    "import Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\n\n/**\n * The RaycastCollector class is a traverser for scene partitions that collects all scene graph entities that are\n * considered intersecting with the defined ray.\n *\n * @see away.partition.Partition\n * @see away.entities.IEntity\n *\n * @class away.traverse.RaycastCollector\n */\nclass RaycastCollector extends CollectorBase\n{\n\tprivate _rayPosition:Vector3D = new Vector3D();\n\tprivate _rayDirection:Vector3D = new Vector3D();\n\n\tpublic _iCollectionMark:number = 0;\n\n\t/**\n\t * Provides the starting position of the ray.\n\t */\n\tpublic get rayPosition():Vector3D\n\t{\n\t\treturn this._rayPosition;\n\t}\n\n\tpublic set rayPosition(value:Vector3D)\n\t{\n\t\tthis._rayPosition = value;\n\t}\n\n\t/**\n\t * Provides the direction vector of the ray.\n\t */\n\tpublic get rayDirection():Vector3D\n\t{\n\t\treturn this._rayDirection;\n\t}\n\n\tpublic set rayDirection(value:Vector3D)\n\t{\n\t\tthis._rayDirection = value;\n\t}\n\n\t/**\n\t * Creates a new RaycastCollector object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Returns true if the current node is at least partly in the frustum. If so, the partition node knows to pass on the traverser to its children.\n\t *\n\t * @param node The Partition3DNode object to frustum-test.\n\t */\n\tpublic enterNode(node:NodeBase):boolean\n\t{\n\t\treturn node.isIntersectingRay(this._rayPosition, this._rayDirection);\n\t}\n}\n\nexport = RaycastCollector;",
    "import NodeBase\t\t\t\t\t\t= require(\"awayjs-display/lib/partition/NodeBase\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\n\n/**\n * @class away.traverse.ShadowCasterCollector\n */\nclass ShadowCasterCollector extends CollectorBase\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic enterNode(node:NodeBase):boolean\n\t{\n\t\tvar enter:boolean = this.scene._iCollectionMark != node._iCollectionMark && node.isCastingShadow();\n\n\t\tif (!enter) {\n\t\t\tnode._iCollectionMark = this.scene._iCollectionMark;\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn super.enterNode(node);\n\t}\n}\n\nexport = ShadowCasterCollector;",
    "import BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport PlaneClassification\t\t\t= require(\"awayjs-core/lib/geom/PlaneClassification\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n/**\n * AxisAlignedBoundingBox represents a bounding box volume that has its planes aligned to the local coordinate axes of the bounded object.\n * This is useful for most meshes.\n */\nclass AxisAlignedBoundingBox extends BoundingVolumeBase\n{\n\tprivate _centerX:number = 0;\n\tprivate _centerY:number = 0;\n\tprivate _centerZ:number = 0;\n\tprivate _halfExtentsX:number = 0;\n\tprivate _halfExtentsY:number = 0;\n\tprivate _halfExtentsZ:number = 0;\n\n\t/**\n\t * Creates a new <code>AxisAlignedBoundingBox</code> object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic nullify()\n\t{\n\t\tsuper.nullify();\n\n\t\tthis._centerX = this._centerY = this._centerZ = 0;\n\t\tthis._halfExtentsX = this._halfExtentsY = this._halfExtentsZ = 0;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\tfor (var i:number = 0; i < numPlanes; ++i) {\n\n\t\t\tvar plane:Plane3D = planes[i];\n\t\t\tvar a:number = plane.a;\n\t\t\tvar b:number = plane.b;\n\t\t\tvar c:number = plane.c;\n\t\t\tvar flippedExtentX:number = a < 0? -this._halfExtentsX : this._halfExtentsX;\n\t\t\tvar flippedExtentY:number = b < 0? -this._halfExtentsY : this._halfExtentsY;\n\t\t\tvar flippedExtentZ:number = c < 0? -this._halfExtentsZ : this._halfExtentsZ;\n\t\t\tvar projDist:number = a*(this._centerX + flippedExtentX) + b*(this._centerY + flippedExtentY) + c*(this._centerZ + flippedExtentZ) - plane.d;\n\n\t\t\tif (projDist < 0)\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic rayIntersection(position:Vector3D, direction:Vector3D, targetNormal:Vector3D):number\n\t{\n\n\t\tif (this.containsPoint(position))\n\t\t\treturn 0;\n\n\t\tvar px:number = position.x - this._centerX\n\t\tvar py:number = position.y - this._centerY\n\t\tvar pz:number = position.z - this._centerZ;\n\n\t\tvar vx:number = direction.x\n\t\tvar vy:number = direction.y\n\t\tvar vz:number = direction.z;\n\n\t\tvar ix:number;\n\t\tvar iy:number;\n\t\tvar iz:number;\n\t\tvar rayEntryDistance:number;\n\n\t\t// ray-plane tests\n\t\tvar intersects:boolean;\n\t\tif (vx < 0) {\n\t\t\trayEntryDistance = ( this._halfExtentsX - px )/vx;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tiy = py + rayEntryDistance*vy;\n\t\t\t\tiz = pz + rayEntryDistance*vz;\n\t\t\t\tif (iy > -this._halfExtentsY && iy < this._halfExtentsY && iz > -this._halfExtentsZ && iz < this._halfExtentsZ) {\n\t\t\t\t\ttargetNormal.x = 1;\n\t\t\t\t\ttargetNormal.y = 0;\n\t\t\t\t\ttargetNormal.z = 0;\n\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!intersects && vx > 0) {\n\t\t\trayEntryDistance = ( -this._halfExtentsX - px )/vx;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tiy = py + rayEntryDistance*vy;\n\t\t\t\tiz = pz + rayEntryDistance*vz;\n\t\t\t\tif (iy > -this._halfExtentsY && iy < this._halfExtentsY && iz > -this._halfExtentsZ && iz < this._halfExtentsZ) {\n\t\t\t\t\ttargetNormal.x = -1;\n\t\t\t\t\ttargetNormal.y = 0;\n\t\t\t\t\ttargetNormal.z = 0;\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!intersects && vy < 0) {\n\t\t\trayEntryDistance = ( this._halfExtentsY - py )/vy;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tix = px + rayEntryDistance*vx;\n\t\t\t\tiz = pz + rayEntryDistance*vz;\n\t\t\t\tif (ix > -this._halfExtentsX && ix < this._halfExtentsX && iz > -this._halfExtentsZ && iz < this._halfExtentsZ) {\n\t\t\t\t\ttargetNormal.x = 0;\n\t\t\t\t\ttargetNormal.y = 1;\n\t\t\t\t\ttargetNormal.z = 0;\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!intersects && vy > 0) {\n\t\t\trayEntryDistance = ( -this._halfExtentsY - py )/vy;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tix = px + rayEntryDistance*vx;\n\t\t\t\tiz = pz + rayEntryDistance*vz;\n\t\t\t\tif (ix > -this._halfExtentsX && ix < this._halfExtentsX && iz > -this._halfExtentsZ && iz < this._halfExtentsZ) {\n\t\t\t\t\ttargetNormal.x = 0;\n\t\t\t\t\ttargetNormal.y = -1;\n\t\t\t\t\ttargetNormal.z = 0;\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!intersects && vz < 0) {\n\t\t\trayEntryDistance = ( this._halfExtentsZ - pz )/vz;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tix = px + rayEntryDistance*vx;\n\t\t\t\tiy = py + rayEntryDistance*vy;\n\t\t\t\tif (iy > -this._halfExtentsY && iy < this._halfExtentsY && ix > -this._halfExtentsX && ix < this._halfExtentsX) {\n\t\t\t\t\ttargetNormal.x = 0;\n\t\t\t\t\ttargetNormal.y = 0;\n\t\t\t\t\ttargetNormal.z = 1;\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!intersects && vz > 0) {\n\t\t\trayEntryDistance = ( -this._halfExtentsZ - pz )/vz;\n\t\t\tif (rayEntryDistance > 0) {\n\t\t\t\tix = px + rayEntryDistance*vx;\n\t\t\t\tiy = py + rayEntryDistance*vy;\n\t\t\t\tif (iy > -this._halfExtentsY && iy < this._halfExtentsY && ix > -this._halfExtentsX && ix < this._halfExtentsX) {\n\t\t\t\t\ttargetNormal.x = 0;\n\t\t\t\t\ttargetNormal.y = 0;\n\t\t\t\t\ttargetNormal.z = -1;\n\t\t\t\t\tintersects = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn intersects? rayEntryDistance : -1;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic containsPoint(position:Vector3D):boolean\n\t{\n\t\tvar px:number = position.x - this._centerX, py:number = position.y - this._centerY, pz:number = position.z - this._centerZ;\n\t\treturn px <= this._halfExtentsX && px >= -this._halfExtentsX && py <= this._halfExtentsY && py >= -this._halfExtentsY && pz <= this._halfExtentsZ && pz >= -this._halfExtentsZ;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic fromExtremes(minX:number, minY:number, minZ:number, maxX:number, maxY:number, maxZ:number)\n\t{\n\n\t\tthis._centerX = (maxX + minX)*.5;\n\t\tthis._centerY = (maxY + minY)*.5;\n\t\tthis._centerZ = (maxZ + minZ)*.5;\n\t\tthis._halfExtentsX = (maxX - minX)*.5;\n\t\tthis._halfExtentsY = (maxY - minY)*.5;\n\t\tthis._halfExtentsZ = (maxZ - minZ)*.5;\n\n\t\tsuper.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic clone():BoundingVolumeBase\n\t{\n\t\tvar clone:AxisAlignedBoundingBox = new AxisAlignedBoundingBox();\n\t\tclone.fromExtremes(this._aabb.x, this._aabb.y + this._aabb.height, this._aabb.z, this._aabb.x + this._aabb.width, this._aabb.y, this._aabb.z + this._aabb.depth);\n\t\treturn clone;\n\t}\n\n\tpublic get halfExtentsX():number\n\t{\n\t\treturn this._halfExtentsX;\n\t}\n\n\tpublic get halfExtentsY():number\n\t{\n\t\treturn this._halfExtentsY;\n\t}\n\n\tpublic get halfExtentsZ():number\n\t{\n\t\treturn this._halfExtentsZ;\n\t}\n\n\t/**\n\t * Finds the closest point on the bounding volume to another given point. This can be used for maximum error calculations for content within a given bound.\n\t * @param point The point for which to find the closest point on the bounding volume\n\t * @param target An optional Vector3D to store the result to prevent creating a new object.\n\t * @return\n\t */\n\tpublic closestPointToPoint(point:Vector3D, target:Vector3D = null):Vector3D\n\t{\n\t\tvar p:number;\n\n\t\tif (target == null)\n\t\t\ttarget = new Vector3D();\n\n\t\tp = point.x;\n\t\tif (p < this._aabb.x)\n\t\t\tp = this._aabb.x;\n\t\tif (p > this._aabb.x + this._aabb.width)\n\t\t\tp = this._aabb.x + this._aabb.width;\n\t\ttarget.x = p;\n\n\t\tp = point.y;\n\t\tif (p < this._aabb.y + this._aabb.height)\n\t\t\tp = this._aabb.y + this._aabb.height;\n\t\tif (p > this._aabb.y)\n\t\t\tp = this._aabb.y;\n\t\ttarget.y = p;\n\n\t\tp = point.z;\n\t\tif (p < this._aabb.z)\n\t\t\tp = this._aabb.z;\n\t\tif (p > this._aabb.z + this._aabb.depth)\n\t\t\tp = this._aabb.z + this._aabb.depth;\n\t\ttarget.z = p;\n\n\t\treturn target;\n\t}\n\n\tpublic classifyToPlane(plane:Plane3D):number\n\t{\n\t\tvar a:number = plane.a;\n\t\tvar b:number = plane.b;\n\t\tvar c:number = plane.c;\n\t\tvar centerDistance:number = a*this._centerX + b*this._centerY + c*this._centerZ - plane.d;\n\n\t\tif (a < 0)\n\t\t\ta = -a;\n\n\t\tif (b < 0)\n\t\t\tb = -b;\n\n\t\tif (c < 0)\n\t\t\tc = -c;\n\n\t\tvar boundOffset:number = a*this._halfExtentsX + b*this._halfExtentsY + c*this._halfExtentsZ;\n\n\t\treturn centerDistance > boundOffset? PlaneClassification.FRONT : centerDistance < -boundOffset? PlaneClassification.BACK : PlaneClassification.INTERSECT;\n\t}\n\n\tpublic transformFrom(bounds:BoundingVolumeBase, matrix:Matrix3D)\n\t{\n\t\tvar aabb:AxisAlignedBoundingBox = <AxisAlignedBoundingBox> bounds;\n\t\tvar cx:number = aabb._centerX;\n\t\tvar cy:number = aabb._centerY;\n\t\tvar cz:number = aabb._centerZ;\n\t\tvar raw:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\n\t\tmatrix.copyRawDataTo(raw);\n\n\t\tvar m11:number = raw[0], m12:number = raw[4], m13:number = raw[8], m14:number = raw[12];\n\t\tvar m21:number = raw[1], m22:number = raw[5], m23:number = raw[9], m24:number = raw[13];\n\t\tvar m31:number = raw[2], m32:number = raw[6], m33:number = raw[10], m34:number = raw[14];\n\n\t\tthis._centerX = cx*m11 + cy*m12 + cz*m13 + m14;\n\t\tthis._centerY = cx*m21 + cy*m22 + cz*m23 + m24;\n\t\tthis._centerZ = cx*m31 + cy*m32 + cz*m33 + m34;\n\n\t\tif (m11 < 0)\n\t\t\tm11 = -m11;\n\t\tif (m12 < 0)\n\t\t\tm12 = -m12;\n\t\tif (m13 < 0)\n\t\t\tm13 = -m13;\n\t\tif (m21 < 0)\n\t\t\tm21 = -m21;\n\t\tif (m22 < 0)\n\t\t\tm22 = -m22;\n\t\tif (m23 < 0)\n\t\t\tm23 = -m23;\n\t\tif (m31 < 0)\n\t\t\tm31 = -m31;\n\t\tif (m32 < 0)\n\t\t\tm32 = -m32;\n\t\tif (m33 < 0)\n\t\t\tm33 = -m33;\n\t\tvar hx:number = aabb._halfExtentsX;\n\t\tvar hy:number = aabb._halfExtentsY;\n\t\tvar hz:number = aabb._halfExtentsZ;\n\t\tthis._halfExtentsX = hx*m11 + hy*m12 + hz*m13;\n\t\tthis._halfExtentsY = hx*m21 + hy*m22 + hz*m23;\n\t\tthis._halfExtentsZ = hx*m31 + hy*m32 + hz*m33;\n\n\t\tthis._aabb.width = this._aabb.height = this._aabb.depth = this._halfExtentsX*2;\n\t\tthis._aabb.x = this._centerX - this._halfExtentsX;\n\t\tthis._aabb.y = this._centerY + this._halfExtentsY;\n\t\tthis._aabb.z = this._centerZ - this._halfExtentsZ;\n\t}\n}\n\nexport = AxisAlignedBoundingBox;",
    "import BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport PlaneClassification\t\t\t= require(\"awayjs-core/lib/geom/PlaneClassification\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nclass BoundingSphere extends BoundingVolumeBase\n{\n\n\tprivate _radius:number = 0;\n\tprivate _centerX:number = 0;\n\tprivate _centerY:number = 0;\n\tprivate _centerZ:number = 0;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic get radius():number\n\t{\n\t\treturn this._radius;\n\t}\n\n\tpublic nullify()\n\t{\n\t\tsuper.nullify();\n\t\tthis._centerX = this._centerY = this._centerZ = 0;\n\t\tthis._radius = 0;\n\t}\n\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\tfor (var i:number = 0; i < numPlanes; ++i) {\n\t\t\tvar plane:Plane3D = planes[i];\n\t\t\tvar flippedExtentX:number = plane.a < 0? -this._radius : this._radius;\n\t\t\tvar flippedExtentY:number = plane.b < 0? -this._radius : this._radius;\n\t\t\tvar flippedExtentZ:number = plane.c < 0? -this._radius : this._radius;\n\t\t\tvar projDist:number = plane.a*( this._centerX + flippedExtentX ) + plane.b*( this._centerY + flippedExtentY) + plane.c*( this._centerZ + flippedExtentZ ) - plane.d;\n\t\t\tif (projDist < 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic fromSphere(center:Vector3D, radius:number)\n\t{\n\t\tthis._centerX = center.x;\n\t\tthis._centerY = center.y;\n\t\tthis._centerZ = center.z;\n\t\tthis._radius = radius;\n\t\tthis._aabb.width = this._aabb.height = this._aabb.depth = radius*2;\n\t\tthis._aabb.x = this._centerX - radius;\n\t\tthis._aabb.y = this._centerY + radius;\n\t\tthis._aabb.z = this._centerZ - radius;\n\t\tthis._pAabbPointsDirty = true;\n\t}\n\n\tpublic fromExtremes(minX:number, minY:number, minZ:number, maxX:number, maxY:number, maxZ:number)\n\t{\n\t\tthis._centerX = (maxX + minX)*.5;\n\t\tthis._centerY = (maxY + minY)*.5;\n\t\tthis._centerZ = (maxZ + minZ)*.5;\n\n\t\tvar d:number = maxX - minX;\n\t\tvar y:number = maxY - minY;\n\t\tvar z:number = maxZ - minZ;\n\n\t\tif (y > d)\n\t\t\td = y;\n\n\t\tif (z > d)\n\t\t\td = z;\n\n\t\tthis._radius = d*Math.sqrt(.5);\n\t\tsuper.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);\n\t}\n\n\tpublic clone():BoundingVolumeBase\n\t{\n\t\tvar clone:BoundingSphere = new BoundingSphere();\n\t\tclone.fromSphere(new Vector3D(this._centerX, this._centerY, this._centerZ), this._radius);\n\t\treturn clone;\n\t}\n\n\tpublic rayIntersection(position:Vector3D, direction:Vector3D, targetNormal:Vector3D):number\n\t{\n\t\tif (this.containsPoint(position)) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar px:number = position.x - this._centerX, py:number = position.y - this._centerY, pz:number = position.z - this._centerZ;\n\t\tvar vx:number = direction.x, vy:number = direction.y, vz:number = direction.z;\n\t\tvar rayEntryDistance:number;\n\n\t\tvar a:number = vx*vx + vy*vy + vz*vz;\n\t\tvar b:number = 2*( px*vx + py*vy + pz*vz );\n\t\tvar c:number = px*px + py*py + pz*pz - this._radius*this._radius;\n\t\tvar det:number = b*b - 4*a*c;\n\n\t\tif (det >= 0) { // ray goes through sphere\n\t\t\tvar sqrtDet:number = Math.sqrt(det);\n\t\t\trayEntryDistance = ( -b - sqrtDet )/( 2*a );\n\t\t\tif (rayEntryDistance >= 0) {\n\t\t\t\ttargetNormal.x = px + rayEntryDistance*vx;\n\t\t\t\ttargetNormal.y = py + rayEntryDistance*vy;\n\t\t\t\ttargetNormal.z = pz + rayEntryDistance*vz;\n\t\t\t\ttargetNormal.normalize();\n\n\t\t\t\treturn rayEntryDistance;\n\t\t\t}\n\t\t}\n\n\t\t// ray misses sphere\n\t\treturn -1;\n\t}\n\n\tpublic containsPoint(position:Vector3D):boolean\n\t{\n\t\tvar px:number = position.x - this._centerX;\n\t\tvar py:number = position.y - this._centerY;\n\t\tvar pz:number = position.z - this._centerZ;\n\t\tvar distance:number = Math.sqrt(px*px + py*py + pz*pz);\n\t\treturn distance <= this._radius;\n\t}\n\n\t//@override\n\tpublic classifyToPlane(plane:Plane3D):number\n\t{\n\t\tvar a:number = plane.a;\n\t\tvar b:number = plane.b;\n\t\tvar c:number = plane.c;\n\t\tvar dd:number = a*this._centerX + b*this._centerY + c*this._centerZ - plane.d;\n\n\t\tif (a < 0)\n\t\t\ta = -a;\n\n\t\tif (b < 0)\n\t\t\tb = -b;\n\n\t\tif (c < 0)\n\t\t\tc = -c;\n\n\t\tvar rr:Number = (a + b + c)*this._radius;\n\n\t\treturn dd > rr? PlaneClassification.FRONT : dd < -rr? PlaneClassification.BACK : PlaneClassification.INTERSECT;\n\t}\n\n\tpublic transformFrom(bounds:BoundingVolumeBase, matrix:Matrix3D)\n\t{\n\t\tvar sphere:BoundingSphere = <BoundingSphere> bounds;\n\t\tvar cx:number = sphere._centerX;\n\t\tvar cy:number = sphere._centerY;\n\t\tvar cz:number = sphere._centerZ;\n\t\tvar raw:Array<number> = new Array<number>(16);\n\n\t\tmatrix.copyRawDataTo(raw);\n\n\t\tvar m11:number = raw[0], m12:number = raw[4], m13:number = raw[8], m14:number = raw[12];\n\t\tvar m21:number = raw[1], m22:number = raw[5], m23:number = raw[9], m24:number = raw[13];\n\t\tvar m31:number = raw[2], m32:number = raw[6], m33:number = raw[10], m34:number = raw[14];\n\n\t\tthis._centerX = cx*m11 + cy*m12 + cz*m13 + m14;\n\t\tthis._centerY = cx*m21 + cy*m22 + cz*m23 + m24;\n\t\tthis._centerZ = cx*m31 + cy*m32 + cz*m33 + m34;\n\n\t\tif (m11 < 0)\n\t\t\tm11 = -m11;\n\t\tif (m12 < 0)\n\t\t\tm12 = -m12;\n\t\tif (m13 < 0)\n\t\t\tm13 = -m13;\n\t\tif (m21 < 0)\n\t\t\tm21 = -m21;\n\t\tif (m22 < 0)\n\t\t\tm22 = -m22;\n\t\tif (m23 < 0)\n\t\t\tm23 = -m23;\n\t\tif (m31 < 0)\n\t\t\tm31 = -m31;\n\t\tif (m32 < 0)\n\t\t\tm32 = -m32;\n\t\tif (m33 < 0)\n\t\t\tm33 = -m33;\n\n\t\tvar r:number = sphere._radius;\n\t\tvar rx:number = m11 + m12 + m13;\n\t\tvar ry:number = m21 + m22 + m23;\n\t\tvar rz:number = m31 + m32 + m33;\n\t\tthis._radius = r*Math.sqrt(rx*rx + ry*ry + rz*rz);\n\n\t\tthis._aabb.width = this._aabb.height = this._aabb.depth = this._radius*2;\n\t\tthis._aabb.x = this._centerX - this._radius;\n\t\tthis._aabb.y = this._centerY + this._radius;\n\t\tthis._aabb.z = this._centerZ - this._radius;\n\t}\n}\n\nexport = BoundingSphere;",
    "import Box\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Box\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nclass BoundingVolumeBase\n{\n\tpublic _aabb:Box;\n\tpublic _pAabbPoints:Array<number> = new Array<number>();\n\tpublic _pAabbPointsDirty:boolean = true;\n\n\tconstructor()\n\t{\n\t\tthis._aabb = new Box();\n\t}\n\n\tpublic get aabb():Box\n\t{\n\t\treturn this._aabb;\n\t}\n\n\tpublic get aabbPoints():Array<number>\n\t{\n\t\tif (this._pAabbPointsDirty)\n\t\t\tthis.pUpdateAABBPoints();\n\n\t\treturn this._pAabbPoints;\n\t}\n\n\tpublic nullify()\n\t{\n\t\tthis._aabb.x = this._aabb.y = this._aabb.z = 0;\n\t\tthis._aabb.width = this._aabb.height = this._aabb.depth = 0;\n\t\tthis._pAabbPointsDirty = true;\n\t}\n\n\tpublic fromVertices(vertices:Array<number>)\n\t{\n\t\tvar i:number;\n\t\tvar len:number = vertices.length;\n\t\tvar minX:number, minY:number, minZ:number;\n\t\tvar maxX:number, maxY:number, maxZ:number;\n\n\t\tif (len == 0) {\n\t\t\tthis.nullify();\n\t\t\treturn;\n\t\t}\n\n\t\tvar v:number;\n\n\t\tminX = maxX = vertices[i++];\n\t\tminY = maxY = vertices[i++];\n\t\tminZ = maxZ = vertices[i++];\n\n\t\twhile (i < len) {\n\t\t\tv = vertices[i++];\n\t\t\tif (v < minX)\n\t\t\t\tminX = v; else if (v > maxX)\n\t\t\t\tmaxX = v;\n\t\t\tv = vertices[i++];\n\t\t\tif (v < minY)\n\t\t\t\tminY = v; else if (v > maxY)\n\t\t\t\tmaxY = v;\n\t\t\tv = vertices[i++];\n\t\t\tif (v < minZ)\n\t\t\t\tminZ = v; else if (v > maxZ)\n\t\t\t\tmaxZ = v;\n\t\t}\n\n\t\tthis.fromExtremes(minX, minY, minZ, maxX, maxY, maxZ);\n\t}\n\n\tpublic fromSphere(center:Vector3D, radius:number)\n\t{\n\t\tthis.fromExtremes(center.x - radius, center.y - radius, center.z - radius, center.x + radius, center.y + radius, center.z + radius);\n\t}\n\n\tpublic fromExtremes(minX:number, minY:number, minZ:number, maxX:number, maxY:number, maxZ:number)\n\t{\n\t\tthis._aabb.x = minX;\n\t\tthis._aabb.y = maxY;\n\t\tthis._aabb.z = minZ;\n\t\tthis._aabb.width = maxX - minX;\n\t\tthis._aabb.height = maxY - minY;\n\t\tthis._aabb.depth = maxZ - minZ;\n\t\tthis._pAabbPointsDirty = true;\n\t}\n\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic overlaps(bounds:BoundingVolumeBase):boolean\n\t{\n\t\treturn this._aabb.intersects(bounds.aabb);\n\t}\n\n\tpublic clone():BoundingVolumeBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic rayIntersection(position:Vector3D, direction:Vector3D, targetNormal:Vector3D):number\n\t{\n\t\treturn -1;\n\t}\n\n\tpublic containsPoint(position:Vector3D):boolean\n\t{\n\t\treturn false;\n\t}\n\n\tpublic pUpdateAABBPoints()\n\t{\n\t\tvar minX:number = this._aabb.x;\n\t\tvar minY:number = this._aabb.y - this._aabb.height;\n\t\tvar minZ:number = this._aabb.z;\n\t\tvar maxX:number = this._aabb.x + this._aabb.width;\n\t\tvar maxY:number = this._aabb.y;\n\t\tvar maxZ:number = this._aabb.z + this._aabb.depth;\n\n\t\tthis._pAabbPoints[0] = minX;\n\t\tthis._pAabbPoints[1] = minY;\n\t\tthis._pAabbPoints[2] = minZ;\n\t\tthis._pAabbPoints[3] = maxX;\n\t\tthis._pAabbPoints[4] = minY;\n\t\tthis._pAabbPoints[5] = minZ;\n\t\tthis._pAabbPoints[6] = minX;\n\t\tthis._pAabbPoints[7] = maxY;\n\t\tthis._pAabbPoints[8] = minZ;\n\t\tthis._pAabbPoints[9] = maxX;\n\t\tthis._pAabbPoints[10] = maxY;\n\t\tthis._pAabbPoints[11] = minZ;\n\t\tthis._pAabbPoints[12] = minX;\n\t\tthis._pAabbPoints[13] = minY;\n\t\tthis._pAabbPoints[14] = maxZ;\n\t\tthis._pAabbPoints[15] = maxX;\n\t\tthis._pAabbPoints[16] = minY;\n\t\tthis._pAabbPoints[17] = maxZ;\n\t\tthis._pAabbPoints[18] = minX;\n\t\tthis._pAabbPoints[19] = maxY;\n\t\tthis._pAabbPoints[20] = maxZ;\n\t\tthis._pAabbPoints[21] = maxX;\n\t\tthis._pAabbPoints[22] = maxY;\n\t\tthis._pAabbPoints[23] = maxZ;\n\t\tthis._pAabbPointsDirty = false;\n\t}\n\n\tpublic classifyToPlane(plane:Plane3D):number\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic transformFrom(bounds:BoundingVolumeBase, matrix:Matrix3D)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = BoundingVolumeBase;",
    "import BoundingVolumeBase\t\t\t= require(\"awayjs-core/lib/bounds/BoundingVolumeBase\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport PlaneClassification\t\t\t= require(\"awayjs-core/lib/geom/PlaneClassification\");\nimport Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nclass NullBounds extends BoundingVolumeBase\n{\n\tprivate _alwaysIn:boolean;\n\n\tconstructor(alwaysIn:boolean = true)\n\t{\n\t\tsuper();\n\n\t\tthis._alwaysIn = alwaysIn;\n\n\t\tthis._aabb.width = this._aabb.height = this._aabb.depth = Number.POSITIVE_INFINITY;\n\t\tthis._aabb.x = this._aabb.y = this._aabb.z = this._alwaysIn? Number.NEGATIVE_INFINITY/2 : Number.POSITIVE_INFINITY;\n\t}\n\n\t//@override\n\tpublic clone():BoundingVolumeBase\n\t{\n\t\treturn new NullBounds(this._alwaysIn);\n\t}\n\n\t//@override\n\tpublic isInFrustum(planes:Array<Plane3D>, numPlanes:number):boolean\n\t{\n\t\treturn this._alwaysIn;\n\t}\n\n//\t\t//@override\n//\t\tpublic fromGeometry(geometry:away.base.Geometry)\n//\t\t{\n//\t\t}\n\n\t//@override\n\tpublic fromSphere(center:Vector3D, radius:number)\n\t{\n\t}\n\n\t//@override\n\tpublic fromExtremes(minX:number, minY:number, minZ:number, maxX:number, maxY:number, maxZ:number)\n\t{\n\t}\n\n\tpublic classifyToPlane(plane:Plane3D):number\n\t{\n\t\treturn PlaneClassification.INTERSECT;\n\t}\n\n\t//@override\n\tpublic transformFrom(bounds:BoundingVolumeBase, matrix:Matrix3D)\n\t{\n\t\tthis._alwaysIn = (<NullBounds> bounds)._alwaysIn;\n\t}\n}\n\nexport = NullBounds;",
    "import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\n/**\n * AbstractMethodError is thrown when an abstract method is called. The method in question should be overridden\n * by a concrete subclass.\n */\nclass PartialImplementationError extends Error\n{\n\t/**\n\t * Create a new AbstractMethodError.\n\t * @param message An optional message to override the default error message.\n\t * @param id The id of the error.\n\t */\n\tconstructor(dependency:string = '', id:number = 0)\n\t{\n\t\tsuper(\"PartialImplementationError - this function is in development. Required Dependency: \" + dependency, id);\n\t}\n}\n\nexport = PartialImplementationError;",
    "import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\n\n/**\n * RangeError is thrown when an index is accessed out of range of the number of\n * available indices on an Array.\n */\nclass RangeError extends Error\n{\n\t/**\n\t * Create a new RangeError.\n\t *\n\t * @param message An optional message to override the default error message.\n\t * @param id The id of the error.\n\t */\n\tconstructor(message:string = null, id:number = 0)\n\t{\n\t\tsuper(message || \"RangeError\", id);\n\t}\n}\n\nexport = RangeError;",
    "import Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n/**\n * A Box object is an area defined by its position, as indicated by its\n * top-left-front corner point(<i>x</i>, <i>y</i>, <i>z</i>) and by its width,\n * height and depth.\n *\n *\n * <p>The <code>x</code>, <code>y</code>, <code>z</code>, <code>width</code>,\n * <code>height</code> <code>depth</code> properties of the Box class are\n * independent of each other; changing the value of one property has no effect\n * on the others. However, the <code>right</code>, <code>bottom</code> and\n * <code>back</code> properties are integrally related to those six\n * properties. For example, if you change the value of the <code>right</code>\n * property, the value of the <code>width</code> property changes; if you\n * change the <code>bottom</code> property, the value of the\n * <code>height</code> property changes. </p>\n *\n * <p>The following methods and properties use Box objects:</p>\n *\n * <ul>\n *   <li>The <code>bounds</code> property of the DisplayObject class</li>\n * </ul>\n *\n * <p>You can use the <code>new Box()</code> constructor to create a\n * Box object.</p>\n *\n * <p><b>Note:</b> The Box class does not define a cubic Shape\n * display object.\n */\nclass Box\n{\n\tprivate _size:Vector3D;\n\tprivate _bottomRightBack:Vector3D;\n\tprivate _topLeftFront:Vector3D;\n\n\t/**\n\t * The height of the box, in pixels. Changing the <code>height</code> value\n\t * of a Box object has no effect on the <code>x</code>, <code>y</code>,\n\t * <code>z</code>, <code>depth</code> and <code>width</code> properties.\n\t */\n\tpublic height:number;\n\n\t/**\n\t * The width of the box, in pixels. Changing the <code>width</code> value\n\t * of a Box object has no effect on the <code>x</code>, <code>y</code>,\n\t * <code>z</code>, <code>depth</code> and <code>height</code> properties.\n\t */\n\tpublic width:number;\n\n\t/**\n\t * The deoth of the box, in pixels. Changing the <code>depth</code> value\n\t * of a Box object has no effect on the <code>x</code>, <code>y</code>,\n\t * <code>z</code>, <code>width</code> and <code>height</code> properties.\n\t */\n\tpublic depth:number;\n\n\t/**\n\t * The <i>x</i> coordinate of the top-left-front corner of the box.\n\t * Changing the value of the <code>x</code> property of a Box object has no\n\t * effect on the <code>y</code>, <code>z</code>, <code>width</code>,\n\t * <code>height</code> and <code>depth</code> properties.\n\t *\n\t * <p>The value of the <code>x</code> property is equal to the value of the\n\t * <code>left</code> property.</p>\n\t */\n\tpublic x:number;\n\n\t/**\n\t * The <i>y</i> coordinate of the top-left-front corner of the box.\n\t * Changing the value of the <code>y</code> property of a Box object has no\n\t * effect on the <code>x</code>, <code>z</code>, <code>width</code>,\n\t * <code>height</code> and <code>depth</code> properties.\n\t *\n\t * <p>The value of the <code>y</code> property is equal to the value of the\n\t * <code>top</code> property.</p>\n\t */\n\tpublic y:number;\n\n\t/**\n\t * The <i>y</i> coordinate of the top-left-front corner of the box.\n\t * Changing the value of the <code>z</code> property of a Box object has no\n\t * effect on the <code>x</code>, <code>y</code>, <code>width</code>,\n\t * <code>height</code> and <code>depth</code> properties.\n\t *\n\t * <p>The value of the <code>z</code> property is equal to the value of the\n\t * <code>front</code> property.</p>\n\t */\n\tpublic z:number\n\n\t/**\n\t * The sum of the <code>z</code> and <code>height</code> properties.\n\t */\n\tpublic get back():number\n\t{\n\t\treturn this.z + this.depth;\n\t}\n\n\tpublic set back(val:number)\n\t{\n\t\tthis.depth = val - this.z;\n\t}\n\n\t/**\n\t * The sum of the <code>y</code> and <code>height</code> properties.\n\t */\n\tpublic get bottom():number\n\t{\n\t\treturn this.y + this.height;\n\t}\n\n\tpublic set bottom(val:number)\n\t{\n\t\tthis.height = val - this.y;\n\t}\n\n\t/**\n\t * The location of the Box object's bottom-right corner, determined by the\n\t * values of the <code>right</code> and <code>bottom</code> properties.\n\t */\n\tpublic get bottomRightBack():Vector3D\n\t{\n\t\tif (this._bottomRightBack == null)\n\t\t\tthis._bottomRightBack = new Vector3D();\n\n\t\tthis._bottomRightBack.x = this.x + this.width;\n\t\tthis._bottomRightBack.y = this.y + this.height;\n\t\tthis._bottomRightBack.z = this.z + this.depth;\n\n\t\treturn this._bottomRightBack;\n\t}\n\n\t/**\n\t * The <i>z</i> coordinate of the top-left-front corner of the box. Changing\n\t * the <code>front</code> property of a Box object has no effect on the\n\t * <code>x</code>, <code>y</code>, <code>width</code> and <code>height</code>\n\t * properties. However it does affect the <code>depth</code> property,\n\t * whereas changing the <code>z</code> value does <i>not</i> affect the\n\t * <code>depth</code> property.\n\t *\n\t * <p>The value of the <code>left</code> property is equal to the value of\n\t * the <code>x</code> property.</p>\n\t */\n\tpublic get front():number\n\t{\n\t\treturn this.z;\n\t}\n\n\tpublic set front(val:number)\n\t{\n\t\tthis.depth += this.z - val;\n\t\tthis.z = val;\n\t}\n\n\t/**\n\t * The <i>x</i> coordinate of the top-left corner of the box. Changing the\n\t * <code>left</code> property of a Box object has no effect on the\n\t * <code>y</code> and <code>height</code> properties. However it does affect\n\t * the <code>width</code> property, whereas changing the <code>x</code> value\n\t * does <i>not</i> affect the <code>width</code> property.\n\t *\n\t * <p>The value of the <code>left</code> property is equal to the value of\n\t * the <code>x</code> property.</p>\n\t */\n\tpublic get left():number\n\t{\n\t\treturn this.x;\n\t}\n\n\tpublic set left(val:number)\n\t{\n\t\tthis.width += this.x - val;\n\t\tthis.x = val;\n\t}\n\n\t/**\n\t * The sum of the <code>x</code> and <code>width</code> properties.\n\t */\n\tpublic get right():number\n\t{\n\t\treturn this.x + this.width;\n\t}\n\n\tpublic set right(val:number)\n\t{\n\t\tthis.width = val - this.x;\n\t}\n\n\t/**\n\t * The size of the Box object, expressed as a Vector3D object with the\n\t * values of the <code>width</code>, <code>height</code> and\n\t * <code>depth</code> properties.\n\t */\n\tpublic get size():Vector3D\n\t{\n\t\tif (this._size == null)\n\t\t\tthis._size = new Vector3D();\n\n\t\tthis._size.x = this.width;\n\t\tthis._size.y = this.height;\n\t\tthis._size.z = this.depth;\n\n\t\treturn this._size;\n\t}\n\n\t/**\n\t * The <i>y</i> coordinate of the top-left-front corner of the box. Changing\n\t * the <code>top</code> property of a Box object has no effect on the\n\t * <code>x</code> and <code>width</code> properties. However it does affect\n\t * the <code>height</code> property, whereas changing the <code>y</code>\n\t * value does <i>not</i> affect the <code>height</code> property.\n\t *\n\t * <p>The value of the <code>top</code> property is equal to the value of the\n\t * <code>y</code> property.</p>\n\t */\n\tpublic get top():number\n\t{\n\t\treturn this.y;\n\t}\n\n\tpublic set top(val:number)\n\t{\n\t\tthis.height += (this.y - val);\n\t\tthis.y = val;\n\t}\n\n\t/**\n\t * The location of the Box object's top-left-front corner, determined by the\n\t * <i>x</i>, <i>y</i> and <i>z</i> coordinates of the point.\n\t */\n\tpublic get topLeftFront():Vector3D\n\t{\n\t\tif (this._topLeftFront == null)\n\t\t\tthis._topLeftFront = new Vector3D();\n\n\t\tthis._topLeftFront.x = this.x;\n\t\tthis._topLeftFront.y = this.y;\n\t\tthis._topLeftFront.z = this.z;\n\n\t\treturn this._topLeftFront;\n\t}\n\n\t/**\n\t * Creates a new Box object with the top-left-front corner specified by the\n\t * <code>x</code>, <code>y</code> and <code>z</code> parameters and with the\n\t * specified <code>width</code>, <code>height</code> and <code>depth</code>\n\t * parameters. If you call this public without parameters, a box with\n\t * <code>x</code>, <code>y</code>, <code>z</code>, <code>width</code>,\n\t * <code>height</code> and <code>depth</code> properties set to 0 is created.\n\t *\n\t * @param x      The <i>x</i> coordinate of the top-left-front corner of the\n\t *               box.\n\t * @param y      The <i>y</i> coordinate of the top-left-front corner of the\n\t *               box.\n\t * @param z      The <i>z</i> coordinate of the top-left-front corner of the\n\t *               box.\n\t * @param width  The width of the box, in pixels.\n\t * @param height The height of the box, in pixels.\n\t * @param depth The depth of the box, in pixels.\n\t */\n\tconstructor(x:number = 0, y:number = 0, z:number = 0, width:number = 0, height:number = 0, depth:number = 0)\n\t{\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.z = z;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.depth = depth;\n\t}\n\n\t/**\n\t * Returns a new Box object with the same values for the <code>x</code>,\n\t * <code>y</code>, <code>z</code>, <code>width</code>, <code>height</code>\n\t * and <code>depth</code> properties as the original Box object.\n\t *\n\t * @return A new Box object with the same values for the <code>x</code>,\n\t *         <code>y</code>, <code>z</code>, <code>width</code>,\n\t *         <code>height</code> and <code>depth</code> properties as the\n\t *         original Box object.\n\t */\n\tpublic clone():Box\n\t{\n\t\treturn new Box(this.x, this.y, this.z, this.width, this.height, this.depth);\n\t}\n\n\t/**\n\t * Determines whether the specified position is contained within the cubic\n\t * region defined by this Box object.\n\t *\n\t * @param x The <i>x</i> coordinate(horizontal component) of the position.\n\t * @param y The <i>y</i> coordinate(vertical component) of the position.\n\t * @param z The <i>z</i> coordinate(longitudinal component) of the position.\n\t * @return A value of <code>true</code> if the Box object contains the\n\t *         specified position; otherwise <code>false</code>.\n\t */\n\tpublic contains(x:number, y:number, z:number):boolean\n\t{\n\t\treturn (this.x <= x && this.x + this.width >= x && this.y <= y && this.y + this.height >= y && this.z <= z && this.z + this.depth >= z);\n\t}\n\n\t/**\n\t * Determines whether the specified position is contained within the cubic\n\t * region defined by this Box object. This method is similar to the\n\t * <code>Box.contains()</code> method, except that it takes a Vector3D\n\t * object as a parameter.\n\t *\n\t * @param position The position, as represented by its <i>x</i>, <i>y</i> and\n\t *                 <i>z</i> coordinates.\n\t * @return A value of <code>true</code> if the Box object contains the\n\t *         specified position; otherwise <code>false</code>.\n\t */\n\tpublic containsPoint(position:Vector3D):boolean\n\t{\n\t\treturn (this.x <= position.x && this.x + this.width >= position.x && this.y <= position.y && this.y + this.height >= position.y && this.z <= position.z && this.z + this.depth >= position.z);\n\t}\n\n\t/**\n\t * Determines whether the Box object specified by the <code>box</code>\n\t * parameter is contained within this Box object. A Box object is said to\n\t * contain another if the second Box object falls entirely within the\n\t * boundaries of the first.\n\t *\n\t * @param box The Box object being checked.\n\t * @return A value of <code>true</code> if the Box object that you specify\n\t *         is contained by this Box object; otherwise <code>false</code>.\n\t */\n\tpublic containsRect(box:Box):boolean\n\t{\n\t\treturn (this.x <= box.x && this.x + this.width >= box.x + box.width && this.y <= box.y && this.y + this.height >= box.y + box.height && this.z <= box.z && this.z + this.depth >= box.z + box.depth)\n\t}\n\n\t/**\n\t * Copies all of box data from the source Box object into the calling\n\t * Box object.\n\t *\n\t * @param sourceBox The Box object from which to copy the data.\n\t */\n\tpublic copyFrom(sourceBox:Box)\n\t{\n\t\t//TODO\n\t}\n\n\t/**\n\t * Determines whether the object specified in the <code>toCompare</code>\n\t * parameter is equal to this Box object. This method compares the\n\t * <code>x</code>, <code>y</code>, <code>z</code>, <code>width</code>,\n\t * <code>height</code> and <code>depth</code> properties of an object against\n\t * the same properties of this Box object.\n\t *\n\t * @param toCompare The box to compare to this Box object.\n\t * @return A value of <code>true</code> if the object has exactly the same\n\t *         values for the <code>x</code>, <code>y</code>, <code>z</code>,\n\t *         <code>width</code>, <code>height</code> and <code>depth</code>\n\t *         properties as this Box object; otherwise <code>false</code>.\n\t */\n\tpublic equals(toCompare:Box):boolean\n\t{\n\t\treturn (this.x == toCompare.x && this.y == toCompare.y && this.z == toCompare.z && this.width == toCompare.width && this.height == toCompare.height && this.depth == toCompare.depth)\n\t}\n\n\t/**\n\t * Increases the size of the Box object by the specified amounts, in\n\t * pixels. The center point of the Box object stays the same, and its\n\t * size increases to the left and right by the <code>dx</code> value, to\n\t * the top and the bottom by the <code>dy</code> value, and to\n\t * the front and the back by the <code>dz</code> value.\n\t *\n\t * @param dx The value to be added to the left and the right of the Box\n\t *           object. The following equation is used to calculate the new\n\t *           width and position of the box:\n\t * @param dy The value to be added to the top and the bottom of the Box\n\t *           object. The following equation is used to calculate the new\n\t *           height and position of the box:\n\t * @param dz The value to be added to the front and the back of the Box\n\t *           object. The following equation is used to calculate the new\n\t *           depth and position of the box:\n\t */\n\tpublic inflate(dx:number, dy:number, dz:number)\n\t{\n\t\tthis.x -= dx/2;\n\t\tthis.y -= dy/2;\n\t\tthis.z -= dz/2;\n\t\tthis.width += dx/2;\n\t\tthis.height += dy/2;\n\t\tthis.depth += dz/2;\n\t}\n\n\t/**\n\t * Increases the size of the Box object. This method is similar to the\n\t * <code>Box.inflate()</code> method except it takes a Vector3D object as\n\t * a parameter.\n\t *\n\t * <p>The following two code examples give the same result:</p>\n\t *\n\t * @param delta The <code>x</code> property of this Vector3D object is used to\n\t *              increase the horizontal dimension of the Box object.\n\t *              The <code>y</code> property is used to increase the vertical\n\t *              dimension of the Box object.\n\t *              The <code>z</code> property is used to increase the\n\t *              longitudinal dimension of the Box object.\n\t */\n\tpublic inflatePoint(delta:Vector3D)\n\t{\n\t\tthis.x -= delta.x/2;\n\t\tthis.y -= delta.y/2;\n\t\tthis.z -= delta.z/2;\n\t\tthis.width += delta.x/2;\n\t\tthis.height += delta.y/2;\n\t\tthis.depth += delta.z/2;\n\t}\n\n\t/**\n\t * If the Box object specified in the <code>toIntersect</code> parameter\n\t * intersects with this Box object, returns the area of intersection\n\t * as a Box object. If the boxes do not intersect, this method returns an\n\t * empty Box object with its properties set to 0.\n\t *\n\t * @param toIntersect The Box object to compare against to see if it\n\t *                    intersects with this Box object.\n\t * @return A Box object that equals the area of intersection. If the\n\t *         boxes do not intersect, this method returns an empty Box\n\t *         object; that is, a box with its <code>x</code>, <code>y</code>,\n\t *         <code>z</code>, <code>width</code>,  <code>height</code>, and\n\t *         <code>depth</code> properties set to 0.\n\t */\n\tpublic intersection(toIntersect:Box):Box\n\t{\n\t\tif (this.intersects(toIntersect)) {\n\t\t\tvar i:Box = new Box();\n\n\t\t\tif (this.x > toIntersect.x) {\n\t\t\t\ti.x = this.x;\n\t\t\t\ti.width = toIntersect.x - this.x + toIntersect.width;\n\n\t\t\t\tif (i.width > this.width)\n\t\t\t\t\ti.width = this.width;\n\t\t\t} else {\n\t\t\t\ti.x = toIntersect.x;\n\t\t\t\ti.width = this.x - toIntersect.x + this.width;\n\n\t\t\t\tif (i.width > toIntersect.width)\n\t\t\t\t\ti.width = toIntersect.width;\n\t\t\t}\n\n\t\t\tif (this.y > toIntersect.y) {\n\t\t\t\ti.y = this.y;\n\t\t\t\ti.height = toIntersect.y - this.y + toIntersect.height;\n\n\t\t\t\tif (i.height > this.height)\n\t\t\t\t\ti.height = this.height;\n\t\t\t} else {\n\t\t\t\ti.y = toIntersect.y;\n\t\t\t\ti.height = this.y - toIntersect.y + this.height;\n\n\t\t\t\tif (i.height > toIntersect.height)\n\t\t\t\t\ti.height = toIntersect.height;\n\t\t\t}\n\n\n\t\t\tif (this.z > toIntersect.z) {\n\t\t\t\ti.z = this.z;\n\t\t\t\ti.depth = toIntersect.z - this.z + toIntersect.depth;\n\n\t\t\t\tif (i.depth > this.depth)\n\t\t\t\t\ti.depth = this.depth;\n\t\t\t} else {\n\t\t\t\ti.z = toIntersect.z;\n\t\t\t\ti.depth = this.z - toIntersect.z + this.depth;\n\n\t\t\t\tif (i.depth > toIntersect.depth)\n\t\t\t\t\ti.depth = toIntersect.depth;\n\t\t\t}\n\n\t\t\treturn i;\n\t\t}\n\n\t\treturn new Box();\n\t}\n\n\t/**\n\t * Determines whether the object specified in the <code>toIntersect</code>\n\t * parameter intersects with this Box object. This method checks the\n\t * <code>x</code>, <code>y</code>, <code>z</code>, <code>width</code>,\n\t * <code>height</code>, and <code>depth</code> properties of the specified\n\t * Box object to see if it intersects with this Box object.\n\t *\n\t * @param toIntersect The Box object to compare against this Box object.\n\t * @return A value of <code>true</code> if the specified object intersects\n\t *         with this Box object; otherwise <code>false</code>.\n\t */\n\tpublic intersects(toIntersect:Box):boolean\n\t{\n\t\treturn (this.x + this.width > toIntersect.x && this.x < toIntersect.x + toIntersect.width && this.y + this.height > toIntersect.y && this.y < toIntersect.y + toIntersect.height && this.z + this.depth > toIntersect.z && this.z < toIntersect.z + toIntersect.depth);\n\t}\n\n\t/**\n\t * Determines whether or not this Box object is empty.\n\t *\n\t * @return A value of <code>true</code> if the Box object's width, height or\n\t *         depth is less than or equal to 0; otherwise <code>false</code>.\n\t */\n\tpublic isEmpty():boolean\n\t{\n\t\treturn (this.x == 0 && this.y == 0 && this.z == 0 && this.width == 0 && this.height == 0 && this.depth == 0);\n\t}\n\n\t/**\n\t * Adjusts the location of the Box object, as determined by its\n\t * top-left-front corner, by the specified amounts.\n\t *\n\t * @param dx Moves the <i>x</i> value of the Box object by this amount.\n\t * @param dy Moves the <i>y</i> value of the Box object by this amount.\n\t * @param dz Moves the <i>z</i> value of the Box object by this amount.\n\t */\n\tpublic offset(dx:number, dy:number, dz:number)\n\t{\n\t\tthis.x += dx;\n\t\tthis.y += dy;\n\t\tthis.z += dz;\n\t}\n\n\t/**\n\t * Adjusts the location of the Box object using a Vector3D object as a\n\t * parameter. This method is similar to the <code>Box.offset()</code>\n\t * method, except that it takes a Vector3D object as a parameter.\n\t *\n\t * @param position A Vector3D object to use to offset this Box object.\n\t */\n\tpublic offsetPosition(position:Vector3D)\n\t{\n\t\tthis.x += position.x;\n\t\tthis.y += position.y;\n\t\tthis.z += position.z;\n\t}\n\n\t/**\n\t * Sets all of the Box object's properties to 0. A Box object is empty if its\n\t * width, height or depth is less than or equal to 0.\n\t *\n\t * <p> This method sets the values of the <code>x</code>, <code>y</code>,\n\t * <code>z</code>, <code>width</code>, <code>height</code>, and\n\t * <code>depth</code> properties to 0.</p>\n\t *\n\t */\n\tpublic setEmpty()\n\t{\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.z = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.depth = 0;\n\t}\n\n\t/**\n\t * Sets the members of Box to the specified values\n\t *\n\t * @param xa      The <i>x</i> coordinate of the top-left-front corner of the\n\t *                box.\n\t * @param ya      The <i>y</i> coordinate of the top-left-front corner of the\n\t *                box.\n\t * @param yz      The <i>z</i> coordinate of the top-left-front corner of the\n\t *                box.\n\t * @param widtha  The width of the box, in pixels.\n\t * @param heighta The height of the box, in pixels.\n\t * @param deptha  The depth of the box, in pixels.\n\t */\n\tpublic setTo(xa:number, ya:number, za:number, widtha:number, heighta:number, deptha:number)\n\t{\n\t\tthis.x = xa;\n\t\tthis.y = ya;\n\t\tthis.z = za;\n\t\tthis.width = widtha;\n\t\tthis.height = heighta;\n\t\tthis.depth = deptha;\n\t}\n\n\t/**\n\t * Builds and returns a string that lists the horizontal, vertical and\n\t * longitudinal positions and the width, height and depth of the Box object.\n\t *\n\t * @return A string listing the value of each of the following properties of\n\t *         the Box object: <code>x</code>, <code>y</code>, <code>z</code>,\n\t *         <code>width</code>, <code>height</code>, and <code>depth</code>.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn \"[Box] (x=\" + this.x + \", y=\" + this.y + \", z=\" + this.z + \", width=\" + this.width + \", height=\" + this.height + \", depth=\" + this.depth + \")\";\n\t}\n\n\t/**\n\t * Adds two boxes together to create a new Box object, by filling\n\t * in the horizontal, vertical and longitudinal space between the two boxes.\n\t *\n\t * <p><b>Note:</b> The <code>union()</code> method ignores boxes with\n\t * <code>0</code> as the height, width or depth value, such as: <code>var\n\t * box2:Box = new Box(300,300,300,50,50,0);</code></p>\n\t *\n\t * @param toUnion A Box object to add to this Box object.\n\t * @return A new Box object that is the union of the two boxes.\n\t */\n\tpublic union(toUnion:Box):Box\n\t{\n\t\tvar u:Box = new Box();\n\n\t\tif (this.x < toUnion.x) {\n\t\t\tu.x = this.x;\n\t\t\tu.width = toUnion.x - this.x + toUnion.width;\n\n\t\t\tif (u.width < this.width)\n\t\t\t\tu.width = this.width;\n\t\t} else {\n\t\t\tu.x = toUnion.x;\n\t\t\tu.width = this.x - toUnion.x + this.width;\n\n\t\t\tif (u.width < toUnion.width)\n\t\t\t\tu.width = toUnion.width;\n\t\t}\n\n\t\tif (this.y < toUnion.y) {\n\t\t\tu.y = this.y;\n\t\t\tu.height = toUnion.y - this.y + toUnion.height;\n\n\t\t\tif (u.height < this.height)\n\t\t\t\tu.height = this.height;\n\t\t} else {\n\t\t\tu.y = toUnion.y;\n\t\t\tu.height = this.y - toUnion.y + this.height;\n\n\t\t\tif (u.height < toUnion.height)\n\t\t\t\tu.height = toUnion.height;\n\t\t}\n\n\t\tif (this.z < toUnion.z) {\n\t\t\tu.z = this.z;\n\t\t\tu.depth = toUnion.z - this.z + toUnion.depth;\n\n\t\t\tif (u.depth < this.depth)\n\t\t\t\tu.depth = this.depth;\n\t\t} else {\n\t\t\tu.z = toUnion.z;\n\t\t\tu.depth = this.z - toUnion.z + this.depth;\n\n\t\t\tif (u.depth < toUnion.depth)\n\t\t\t\tu.depth = toUnion.depth;\n\t\t}\n\n\t\treturn u;\n\t}\n}\n\nexport = Box;",
    "/**\n* MathConsts provides some commonly used mathematical constants\n*/\nclass MathConsts\n{\n\t/**\n\t * The amount to multiply with when converting radians to degrees.\n\t */\n\tpublic static RADIANS_TO_DEGREES:number = 180/Math.PI;\n\n\t/**\n\t * The amount to multiply with when converting degrees to radians.\n\t */\n\tpublic static DEGREES_TO_RADIANS:number = Math.PI/180;\n}\n\nexport = MathConsts;",
    "import Quaternion\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Plane3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\n\n/**\n * away.geom.Matrix3DUtils provides additional Matrix3D functions.\n */\nclass Matrix3DUtils\n{\n\t/**\n\t * A reference to a Vector to be used as a temporary raw data container, to prevent object creation.\n\t */\n\tpublic static RAW_DATA_CONTAINER:number[] = new Array<number>(16);\n\t//public static RAW_DATA_CONTAINER:number[] = new Array<number>(16);\n\n\tpublic static CALCULATION_MATRIX:Matrix3D = new Matrix3D();\n\n\t/**\n\t * Fills the 3d matrix object with values representing the transformation made by the given quaternion.\n\t *\n\t * @param    quarternion    The quarterion object to convert.\n\t */\n\tpublic static quaternion2matrix(quarternion:Quaternion, m:Matrix3D = null):Matrix3D\n\t{\n\t\tvar x:number = quarternion.x;\n\t\tvar y:number = quarternion.y;\n\t\tvar z:number = quarternion.z;\n\t\tvar w:number = quarternion.w;\n\n\t\tvar xx:number = x*x;\n\t\tvar xy:number = x*y;\n\t\tvar xz:number = x*z;\n\t\tvar xw:number = x*w;\n\n\t\tvar yy:number = y*y;\n\t\tvar yz:number = y*z;\n\t\tvar yw:number = y*w;\n\n\t\tvar zz:number = z*z;\n\t\tvar zw:number = z*w;\n\n\t\tvar raw:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\traw[0] = 1 - 2*(yy + zz);\n\t\traw[1] = 2*(xy + zw);\n\t\traw[2] = 2*(xz - yw);\n\t\traw[4] = 2*(xy - zw);\n\t\traw[5] = 1 - 2*(xx + zz);\n\t\traw[6] = 2*(yz + xw);\n\t\traw[8] = 2*(xz + yw);\n\t\traw[9] = 2*(yz - xw);\n\t\traw[10] = 1 - 2*(xx + yy);\n\t\traw[3] = raw[7] = raw[11] = raw[12] = raw[13] = raw[14] = 0;\n\t\traw[15] = 1;\n\n\t\tif (m) {\n\t\t\tm.copyRawDataFrom(raw);\n\t\t\treturn m;\n\t\t} else\n\t\t\treturn new Matrix3D(raw);\n\t}\n\n\t/**\n\t * Returns a normalised <code>Vector3D</code> object representing the forward vector of the given matrix.\n\t * @param    m        The Matrix3D object to use to get the forward vector\n\t * @param    v        [optional] A vector holder to prevent make new Vector3D instance if already exists. Default is null.\n\t * @return            The forward vector\n\t */\n\tpublic static getForward(m:Matrix3D, v:Vector3D = null):Vector3D\n\t{\n\t\t//v ||= new Vector3D(0.0, 0.0, 0.0);\n\t\tif (v === null) {\n\n\t\t\tv = new Vector3D(0.0, 0.0, 0.0);\n\n\t\t}\n\n\t\tm.copyColumnTo(2, v);\n\t\tv.normalize();\n\n\t\treturn v;\n\t}\n\n\t/**\n\t * Returns a normalised <code>Vector3D</code> object representing the up vector of the given matrix.\n\t * @param    m        The Matrix3D object to use to get the up vector\n\t * @param    v        [optional] A vector holder to prevent make new Vector3D instance if already exists. Default is null.\n\t * @return            The up vector\n\t */\n\tpublic static getUp(m:Matrix3D, v:Vector3D = null):Vector3D\n\t{\n\t\t//v ||= new Vector3D(0.0, 0.0, 0.0);\n\n\t\tif (v === null) {\n\n\t\t\tv = new Vector3D(0.0, 0.0, 0.0);\n\n\t\t}\n\n\t\tm.copyColumnTo(1, v);\n\t\tv.normalize();\n\n\t\treturn v;\n\t}\n\n\t/**\n\t * Returns a normalised <code>Vector3D</code> object representing the right vector of the given matrix.\n\t * @param    m        The Matrix3D object to use to get the right vector\n\t * @param    v        [optional] A vector holder to prevent make new Vector3D instance if already exists. Default is null.\n\t * @return            The right vector\n\t */\n\tpublic static getRight(m:Matrix3D, v:Vector3D = null):Vector3D\n\t{\n\t\t//v ||= new Vector3D(0.0, 0.0, 0.0);\n\t\tif (v === null) {\n\n\t\t\tv = new Vector3D(0.0, 0.0, 0.0);\n\n\t\t}\n\n\t\tm.copyColumnTo(0, v);\n\t\tv.normalize();\n\n\t\treturn v;\n\t}\n\n\t/**\n\t * Returns a boolean value representing whether there is any significant difference between the two given 3d matrices.\n\t */\n\tpublic static compare(m1:Matrix3D, m2:Matrix3D):boolean\n\t{\n\t\tvar r1:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tvar r2:number[] = m2.rawData;\n\t\tm1.copyRawDataTo(r1);\n\n\t\tfor (var i:number = 0; i < 16; ++i) {\n\t\t\tif (r1[i] != r2[i])\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic static lookAt(matrix:Matrix3D, pos:Vector3D, dir:Vector3D, up:Vector3D)\n\t{\n\t\tvar dirN:Vector3D;\n\t\tvar upN:Vector3D;\n\t\tvar lftN:Vector3D;\n\t\tvar raw:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\n\t\tlftN = dir.crossProduct(up);\n\t\tlftN.normalize();\n\n\t\tupN = lftN.crossProduct(dir);\n\t\tupN.normalize();\n\t\tdirN = dir.clone();\n\t\tdirN.normalize();\n\n\t\traw[0] = lftN.x;\n\t\traw[1] = upN.x;\n\t\traw[2] = -dirN.x;\n\t\traw[3] = 0.0;\n\n\t\traw[4] = lftN.y;\n\t\traw[5] = upN.y;\n\t\traw[6] = -dirN.y;\n\t\traw[7] = 0.0;\n\n\t\traw[8] = lftN.z;\n\t\traw[9] = upN.z;\n\t\traw[10] = -dirN.z;\n\t\traw[11] = 0.0;\n\n\t\traw[12] = -lftN.dotProduct(pos);\n\t\traw[13] = -upN.dotProduct(pos);\n\t\traw[14] = dirN.dotProduct(pos);\n\t\traw[15] = 1.0;\n\n\t\tmatrix.copyRawDataFrom(raw);\n\t}\n\n\tpublic static reflection(plane:Plane3D, target:Matrix3D = null):Matrix3D\n\t{\n\t\tif (target === null)\n\t\t\ttarget = new Matrix3D();\n\n\t\tvar a:number = plane.a, b:number = plane.b, c:number = plane.c, d:number = plane.d;\n\t\tvar rawData:number[] = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tvar ab2:number = -2*a*b;\n\t\tvar ac2:number = -2*a*c;\n\t\tvar bc2:number = -2*b*c;\n\t\t// reflection matrix\n\t\trawData[0] = 1 - 2*a*a;\n\t\trawData[4] = ab2;\n\t\trawData[8] = ac2;\n\t\trawData[12] = -2*a*d;\n\t\trawData[1] = ab2;\n\t\trawData[5] = 1 - 2*b*b;\n\t\trawData[9] = bc2;\n\t\trawData[13] = -2*b*d;\n\t\trawData[2] = ac2;\n\t\trawData[6] = bc2;\n\t\trawData[10] = 1 - 2*c*c;\n\t\trawData[14] = -2*c*d;\n\t\trawData[3] = 0;\n\t\trawData[7] = 0;\n\t\trawData[11] = 0;\n\t\trawData[15] = 1;\n\t\ttarget.copyRawDataFrom(rawData);\n\n\t\treturn target;\n\t}\n\n\n\tpublic static transformVector(matrix:Matrix3D, vector:Vector3D, result:Vector3D = null):Vector3D\n\t{\n\t\tif (!result)\n\t\t\tresult = new Vector3D();\n\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tmatrix.copyRawDataTo(raw);\n\t\tvar a:number = raw[0];\n\t\tvar e:number = raw[1];\n\t\tvar i:number = raw[2];\n\t\tvar m:number = raw[3];\n\t\tvar b:number = raw[4];\n\t\tvar f:number = raw[5];\n\t\tvar j:number = raw[6];\n\t\tvar n:number = raw[7];\n\t\tvar c:number = raw[8];\n\t\tvar g:number = raw[9];\n\t\tvar k:number = raw[10];\n\t\tvar o:number = raw[11];\n\t\tvar d:number = raw[12];\n\t\tvar h:number = raw[13];\n\t\tvar l:number = raw[14];\n\t\tvar p:number = raw[15];\n\n\t\tvar x:number = vector.x;\n\t\tvar y:number = vector.y;\n\t\tvar z:number = vector.z;\n\t\tresult.x = a * x + b * y + c * z + d;\n\t\tresult.y = e * x + f * y + g * z + h;\n\t\tresult.z = i * x + j * y + k * z + l;\n\t\tresult.w = m * x + n * y + o * z + p;\n\t\treturn result;\n\t}\n\n\tpublic static deltaTransformVector(matrix:Matrix3D, vector:Vector3D, result:Vector3D = null):Vector3D\n\t{\n\t\tif (!result)\n\t\t\tresult = new Vector3D();\n\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tmatrix.copyRawDataTo(raw);\n\t\tvar a:number = raw[0];\n\t\tvar e:number = raw[1];\n\t\tvar i:number = raw[2];\n\t\tvar m:number = raw[3];\n\t\tvar b:number = raw[4];\n\t\tvar f:number = raw[5];\n\t\tvar j:number = raw[6];\n\t\tvar n:number = raw[7];\n\t\tvar c:number = raw[8];\n\t\tvar g:number = raw[9];\n\t\tvar k:number = raw[10];\n\t\tvar o:number = raw[11];\n\t\tvar x:number = vector.x;\n\t\tvar y:number = vector.y;\n\t\tvar z:number = vector.z;\n\t\tresult.x = a * x + b * y + c * z;\n\t\tresult.y = e * x + f * y + g * z;\n\t\tresult.z = i * x + j * y + k * z;\n\t\tresult.w = m * x + n * y + o * z;\n\t\treturn result;\n\t}\n\n\tpublic static getTranslation(transform:Matrix3D, result:Vector3D = null):Vector3D\n\t{\n\t\tif(!result)\n\t\t\tresult = new Vector3D();\n\n\t\ttransform.copyColumnTo(3, result);\n\t\treturn result;\n\t}\n\n\tpublic static deltaTransformVectors(matrix:Matrix3D, vin:Array<number>, vout:Array<number>)\n\t{\n\t\tvar raw:Array<number> = Matrix3DUtils.RAW_DATA_CONTAINER;\n\t\tmatrix.copyRawDataTo(raw);\n\t\tvar a:number = raw[0];\n\t\tvar e:number = raw[1];\n\t\tvar i:number = raw[2];\n\t\tvar m:number = raw[3];\n\t\tvar b:number = raw[4];\n\t\tvar f:number = raw[5];\n\t\tvar j:number = raw[6];\n\t\tvar n:number = raw[7];\n\t\tvar c:number = raw[8];\n\t\tvar g:number = raw[9];\n\t\tvar k:number = raw[10];\n\t\tvar o:number = raw[11];\n\t\tvar outIndex:number = 0;\n\t\tvar length:number = vin.length;\n\t\tfor(var index:number = 0; index<length; index+=3) {\n\t\t\tvar x:number = vin[index];\n\t\t\tvar y:number = vin[index+1];\n\t\t\tvar z:number = vin[index+2];\n\t\t\tvout[outIndex++] = a * x + b * y + c * z;\n\t\t\tvout[outIndex++] = e * x + f * y + g * z;\n\t\t\tvout[outIndex++] = i * x + j * y + k * z;\n\t\t}\n\t}\n}\n\nexport = Matrix3DUtils;",
    "import PlaneClassification\t= require(\"awayjs-core/lib/geom/PlaneClassification\");\nimport Vector3D\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nclass Plane3D\n{\n\t/**\n\t * The A coefficient of this plane. (Also the x dimension of the plane normal)\n\t */\n\tpublic a:number;\n\n\t/**\n\t * The B coefficient of this plane. (Also the y dimension of the plane normal)\n\t */\n\tpublic b:number;\n\n\t/**\n\t * The C coefficient of this plane. (Also the z dimension of the plane normal)\n\t */\n\tpublic c:number;\n\n\t/**\n\t * The D coefficient of this plane. (Also the inverse dot product between normal and point)\n\t */\n\tpublic d:number;\n\n\tpublic _iAlignment:number;\n\n\t// indicates the alignment of the plane\n\tpublic static ALIGN_ANY:number = 0;\n\tpublic static ALIGN_XY_AXIS:number = 1;\n\tpublic static ALIGN_YZ_AXIS:number = 2;\n\tpublic static ALIGN_XZ_AXIS:number = 3;\n\n\t/**\n\t * Create a Plane3D with ABCD coefficients\n\t */\n\tconstructor(a:number = 0, b:number = 0, c:number = 0, d:number = 0)\n\t{\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\t\tthis.d = d;\n\n\t\tif (a == 0 && b == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XY_AXIS;\n\n\t\t} else if (b == 0 && c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_YZ_AXIS;\n\n\t\t} else if (a == 0 && c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XZ_AXIS;\n\n\t\t} else {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_ANY;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Fills this Plane3D with the coefficients from 3 points in 3d space.\n\t * @param p0 Vector3D\n\t * @param p1 Vector3D\n\t * @param p2 Vector3D\n\t */\n\tpublic fromPoints(p0:Vector3D, p1:Vector3D, p2:Vector3D)\n\t{\n\t\tvar d1x:number = p1.x - p0.x;\n\t\tvar d1y:number = p1.y - p0.y;\n\t\tvar d1z:number = p1.z - p0.z;\n\n\t\tvar d2x:number = p2.x - p0.x;\n\t\tvar d2y:number = p2.y - p0.y;\n\t\tvar d2z:number = p2.z - p0.z;\n\n\t\tthis.a = d1y*d2z - d1z*d2y;\n\t\tthis.b = d1z*d2x - d1x*d2z;\n\t\tthis.c = d1x*d2y - d1y*d2x;\n\t\tthis.d = this.a*p0.x + this.b*p0.y + this.c*p0.z;\n\n\t\t// not using epsilon, since a plane is infinite and a small incorrection can grow very large\n\t\tif (this.a == 0 && this.b == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XY_AXIS;\n\n\t\t} else if (this.b == 0 && this.c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_YZ_AXIS;\n\n\t\t} else if (this.a == 0 && this.c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XZ_AXIS;\n\n\t\t} else {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_ANY;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Fills this Plane3D with the coefficients from the plane's normal and a point in 3d space.\n\t * @param normal Vector3D\n\t * @param point  Vector3D\n\t */\n\tpublic fromNormalAndPoint(normal:Vector3D, point:Vector3D)\n\t{\n\t\tthis.a = normal.x;\n\t\tthis.b = normal.y;\n\t\tthis.c = normal.z;\n\t\tthis.d = this.a*point.x + this.b*point.y + this.c*point.z;\n\t\tif (this.a == 0 && this.b == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XY_AXIS;\n\n\t\t} else if (this.b == 0 && this.c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_YZ_AXIS;\n\n\t\t} else if (this.a == 0 && this.c == 0) {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_XZ_AXIS;\n\n\t\t} else {\n\n\t\t\tthis._iAlignment = Plane3D.ALIGN_ANY;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Normalize this Plane3D\n\t * @return Plane3D This Plane3D.\n\t */\n\tpublic normalize():Plane3D\n\t{\n\t\tvar len:number = 1/Math.sqrt(this.a*this.a + this.b*this.b + this.c*this.c);\n\t\tthis.a *= len;\n\t\tthis.b *= len;\n\t\tthis.c *= len;\n\t\tthis.d *= len;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns the signed distance between this Plane3D and the point p.\n\t * @param p Vector3D\n\t * @returns Number\n\t */\n\tpublic distance(p:Vector3D):number\n\t{\n\n\t\tif (this._iAlignment == Plane3D.ALIGN_YZ_AXIS) {\n\n\t\t\treturn this.a*p.x - this.d;\n\n\t\t} else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS) {\n\t\t\treturn this.b*p.y - this.d;\n\t\t}\n\n\t\telse if (this._iAlignment == Plane3D.ALIGN_XY_AXIS) {\n\n\t\t\treturn this.c*p.z - this.d;\n\n\t\t} else {\n\n\t\t\treturn this.a*p.x + this.b*p.y + this.c*p.z - this.d;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Classify a point against this Plane3D. (in front, back or intersecting)\n\t * @param p Vector3D\n\t * @return int Plane3.FRONT or Plane3D.BACK or Plane3D.INTERSECT\n\t */\n\tpublic classifyPoint(p:Vector3D, epsilon:number = 0.01):number\n\t{\n\t\t// check NaN\n\t\tif (this.d != this.d)\n\t\t\treturn PlaneClassification.FRONT;\n\n\t\tvar len:number;\n\t\tif (this._iAlignment == Plane3D.ALIGN_YZ_AXIS)\n\t\t\tlen = this.a*p.x - this.d; else if (this._iAlignment == Plane3D.ALIGN_XZ_AXIS)\n\t\t\tlen = this.b*p.y - this.d; else if (this._iAlignment == Plane3D.ALIGN_XY_AXIS)\n\t\t\tlen = this.c*p.z - this.d; else\n\t\t\tlen = this.a*p.x + this.b*p.y + this.c*p.z - this.d;\n\n\t\tif (len < -epsilon)\n\t\t\treturn PlaneClassification.BACK; else if (len > epsilon)\n\t\t\treturn PlaneClassification.FRONT; else\n\t\t\treturn PlaneClassification.INTERSECT;\n\t}\n\n\tpublic toString():string\n\t{\n\t\treturn \"Plane3D [a:\" + this.a + \", b:\" + this.b + \", c:\" + this.c + \", d:\" + this.d + \"]\";\n\t}\n}\n\nexport = Plane3D;",
    "class PlaneClassification\n{\n\t// \"back\" is synonymous with \"in\", but used for planes (back of plane is \"inside\" a solid volume walled by a plane)\n\tpublic static BACK:number = 0;\n\tpublic static FRONT:number = 1;\n\n\tpublic static IN:number = 0;\n\tpublic static OUT:number = 1;\n\tpublic static INTERSECT:number = 2;\n\n}\n\nexport = PlaneClassification;",
    "import PerspectiveProjection\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\nimport ProjectionBase\t\t\t= require(\"awayjs-core/lib/projections/ProjectionBase\");\n\nclass FreeMatrixProjection extends ProjectionBase\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pMatrix.copyFrom(new PerspectiveProjection().matrix);\n\t}\n\n\t//@override\n\tpublic set near(value:number)\n\t{\n\t\tthis._pNear = value;\n\t}\n\n\t//@override\n\tpublic set far(value:number)\n\t{\n\t\tthis._pFar = value;\n\t}\n\n\t//@override\n\tpublic set iAspectRatio(value:number)\n\t{\n\t\tthis._pAspectRatio = value;\n\t}\n\n\t//@override\n\tpublic clone():ProjectionBase\n\t{\n\t\tvar clone:FreeMatrixProjection = new FreeMatrixProjection();\n\t\tclone._pMatrix.copyFrom(this._pMatrix);\n\t\tclone._pNear = this._pNear;\n\t\tclone._pFar = this._pFar;\n\t\tclone._pAspectRatio = this._pAspectRatio;\n\t\tclone.pInvalidateMatrix();\n\t\treturn clone;\n\t}\n\n\t//@override\n\tpublic pUpdateMatrix()\n\t{\n\t\tthis._pMatrixInvalid = false;\n\t}\n}\n\nexport = FreeMatrixProjection;",
    "﻿import Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\nimport Texture2DBase\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\nimport TextureUtils\t\t\t\t= require(\"awayjs-core/lib/utils/TextureUtils\");\n\n\nclass RenderTexture extends Texture2DBase\n{\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._pWidth;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (value == this._pWidth)\n\t\t\treturn;\n\n\t\tif (!TextureUtils.isDimensionValid(value))\n\t\t\tthrow new Error(\"Invalid size: Width and height must be power of 2 and cannot exceed 2048\");\n\n\t\tthis.invalidateContent();\n\n\t\tthis._pSetSize(value, this._pHeight);\n\t}\n\n\t/**\n\t *\n\t * @returns {number}\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._pHeight;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (value == this._pHeight)\n\t\t\treturn;\n\n\t\tif (!TextureUtils.isDimensionValid(value))\n\t\t\tthrow new Error(\"Invalid size: Width and height must be power of 2 and cannot exceed 2048\");\n\n\t\tthis.invalidateContent();\n\t\tthis._pSetSize(this._pWidth, value);\n\t}\n\n\tconstructor(width:number, height:number)\n\t{\n\t\tsuper(false);\n\n\t\tthis._pSetSize(width, height);\n\t}\n}\n\nexport = RenderTexture;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass ShadingMethodEvent extends Event\n{\n\tpublic static SHADER_INVALIDATED:string = \"ShaderInvalidated\";\n\n\tconstructor(type:string)\n\t{\n\n\t\tsuper(type);\n\n\t}\n}\n\nexport = ShadingMethodEvent;",
    "import Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport TextureUtils\t\t\t\t\t= require(\"awayjs-core/lib/utils/TextureUtils\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nclass RTTBufferManager extends EventDispatcher\n{\n\tprivate static _instances:Array<RTTBufferManagerVO>;\n\n\tprivate _renderToTextureVertexBuffer:IVertexBuffer;\n\tprivate _renderToScreenVertexBuffer:IVertexBuffer;\n\n\tprivate _indexBuffer:IIndexBuffer;\n\tprivate _stage:Stage;\n\tprivate _viewWidth:number = -1;\n\tprivate _viewHeight:number = -1;\n\tprivate _textureWidth:number = -1;\n\tprivate _textureHeight:number = -1;\n\tprivate _renderToTextureRect:Rectangle;\n\tprivate _buffersInvalid:boolean = true;\n\n\tprivate _textureRatioX:number;\n\tprivate _textureRatioY:number;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tsuper();\n\n\t\tthis._renderToTextureRect = new Rectangle();\n\n\t\tthis._stage = stage;\n\n\t}\n\n\tpublic static getInstance(stage:Stage):RTTBufferManager\n\t{\n\t\tif (!stage)\n\t\t\tthrow new Error(\"stage key cannot be null!\");\n\n\t\tif (RTTBufferManager._instances == null)\n\t\t\tRTTBufferManager._instances = new Array<RTTBufferManagerVO>();\n\n\t\tvar rttBufferManager:RTTBufferManager = RTTBufferManager.getRTTBufferManagerFromStage(stage);\n\n\t\tif (rttBufferManager == null) {\n\t\t\trttBufferManager = new RTTBufferManager(stage);\n\n\t\t\tvar vo:RTTBufferManagerVO = new RTTBufferManagerVO();\n\n\t\t\tvo.stage3d = stage;\n\t\t\tvo.rttbfm = rttBufferManager;\n\n\t\t\tRTTBufferManager._instances.push(vo);\n\t\t}\n\n\t\treturn rttBufferManager;\n\n\t}\n\n\tprivate static getRTTBufferManagerFromStage(stage:Stage):RTTBufferManager\n\t{\n\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage)\n\t\t\t\treturn r.rttbfm;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate static deleteRTTBufferManager(stage:Stage):void\n\t{\n\t\tvar l:number = RTTBufferManager._instances.length;\n\t\tvar r:RTTBufferManagerVO;\n\n\t\tfor (var c:number = 0; c < l; c++) {\n\t\t\tr = RTTBufferManager._instances[ c ];\n\n\t\t\tif (r.stage3d === stage) {\n\t\t\t\tRTTBufferManager._instances.splice(c, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic get textureRatioX():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioX;\n\t}\n\n\tpublic get textureRatioY():number\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._textureRatioY;\n\t}\n\n\tpublic get viewWidth():number\n\t{\n\t\treturn this._viewWidth;\n\t}\n\n\tpublic set viewWidth(value:number)\n\t{\n\t\tif (value == this._viewWidth)\n\t\t\treturn;\n\n\t\tthis._viewWidth = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureWidth = TextureUtils.getBestPowerOf2(this._viewWidth);\n\n\t\tif (this._textureWidth > this._viewWidth) {\n\t\t\tthis._renderToTextureRect.x = Math.floor((this._textureWidth - this._viewWidth)*.5);\n\t\t\tthis._renderToTextureRect.width = this._viewWidth;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.x = 0;\n\t\t\tthis._renderToTextureRect.width = this._textureWidth;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get viewHeight():number\n\t{\n\t\treturn this._viewHeight;\n\t}\n\n\tpublic set viewHeight(value:number)\n\t{\n\t\tif (value == this._viewHeight)\n\t\t\treturn;\n\n\t\tthis._viewHeight = value;\n\n\t\tthis._buffersInvalid = true;\n\n\t\tthis._textureHeight = TextureUtils.getBestPowerOf2(this._viewHeight);\n\n\t\tif (this._textureHeight > this._viewHeight) {\n\t\t\tthis._renderToTextureRect.y = Math.floor((this._textureHeight - this._viewHeight)*.5);\n\t\t\tthis._renderToTextureRect.height = this._viewHeight;\n\t\t} else {\n\t\t\tthis._renderToTextureRect.y = 0;\n\t\t\tthis._renderToTextureRect.height = this._textureHeight;\n\t\t}\n\n\t\tthis.dispatchEvent(new Event(Event.RESIZE));\n\t}\n\n\tpublic get renderToTextureVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureVertexBuffer;\n\t}\n\n\tpublic get renderToScreenVertexBuffer():IVertexBuffer\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToScreenVertexBuffer;\n\n\t}\n\n\tpublic get indexBuffer():IIndexBuffer\n\t{\n\t\treturn this._indexBuffer;\n\t}\n\n\tpublic get renderToTextureRect():Rectangle\n\t{\n\t\tif (this._buffersInvalid)\n\t\t\tthis.updateRTTBuffers();\n\n\t\treturn this._renderToTextureRect;\n\t}\n\n\tpublic get textureWidth():number\n\t{\n\t\treturn this._textureWidth;\n\t}\n\n\tpublic get textureHeight():number\n\t{\n\t\treturn this._textureHeight;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tRTTBufferManager.deleteRTTBufferManager(this._stage);\n\n\t\tif (this._indexBuffer) {\n\t\t\tthis._indexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer.dispose();\n\t\t\tthis._renderToTextureVertexBuffer.dispose();\n\t\t\tthis._renderToScreenVertexBuffer = null;\n\t\t\tthis._renderToTextureVertexBuffer = null;\n\t\t\tthis._indexBuffer = null;\n\t\t}\n\t}\n\n\t// todo: place all this in a separate model, since it's used all over the place\n\t// maybe it even has a place in the core (together with screenRect etc)?\n\t// needs to be stored per view of course\n\tprivate updateRTTBuffers()\n\t{\n\t\tvar context:IContextStageGL = this._stage.context;\n\t\tvar textureVerts:number[];\n\t\tvar screenVerts:number[];\n\n\t\tvar x:number;\n\t\tvar y:number;\n\n\t\tif (this._renderToTextureVertexBuffer == null)\n\t\t\tthis._renderToTextureVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (this._renderToScreenVertexBuffer == null)\n\t\t\tthis._renderToScreenVertexBuffer = context.createVertexBuffer(4, 5);\n\n\t\tif (!this._indexBuffer) {\n\t\t\tthis._indexBuffer = context.createIndexBuffer(6);\n\n\t\t\tthis._indexBuffer.uploadFromArray([2, 1, 0, 3, 2, 0], 0, 6);\n\t\t}\n\n\t\tthis._textureRatioX = x = Math.min(this._viewWidth/this._textureWidth, 1);\n\t\tthis._textureRatioY = y = Math.min(this._viewHeight/this._textureHeight, 1);\n\n\t\tvar u1:number = (1 - x)*.5;\n\t\tvar u2:number = (x + 1)*.5;\n\t\tvar v1:number = (y + 1)*.5;\n\t\tvar v2:number = (1 - y)*.5;\n\n\t\t// last element contains indices for data per vertex that can be passed to the vertex shader if necessary (ie: frustum corners for deferred rendering)\n\t\ttextureVerts = [    -x, -y, u1, v1, 0, x, -y, u2, v1, 1, x, y, u2, v2, 2, -x, y, u1, v2, 3 ];\n\n\t\tscreenVerts = [     -1, -1, u1, v1, 0, 1, -1, u2, v1, 1, 1, 1, u2, v2, 2, -1, 1, u1, v2, 3 ];\n\n\t\tthis._renderToTextureVertexBuffer.uploadFromArray(textureVerts, 0, 4);\n\t\tthis._renderToScreenVertexBuffer.uploadFromArray(screenVerts, 0, 4);\n\n\t\tthis._buffersInvalid = false;\n\t}\n}\n\nexport = RTTBufferManager;\n\nclass RTTBufferManagerVO\n{\n\tpublic stage3d:Stage;\n\n\tpublic rttbfm:RTTBufferManager;\n}",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport LineBasicPass\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/LineBasicPass\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n/**\n * LineMaterial is a material exclusively used to render wireframe objects\n *\n * @see away.entities.Lines\n */\nclass LineBasicMaterial extends StageGLMaterialBase\n{\n\tpublic static pONE_VECTOR:Array<number> = Array<number>(1, 1, 1, 1);\n\tpublic static pFRONT_VECTOR:Array<number> = Array<number>(0, 0, -1, 0);\n\n\tprivate _constants:Array<number> = new Array<number>(0, 0, 0, 0);\n\tprivate _calcMatrix:Matrix3D;\n\tprivate _thickness:number;\n\n\tprivate _screenPass:LineBasicPass;\n\n\t/**\n\t * Creates a new LineMaterial object.\n\t *\n\t * @param thickness The thickness of the wireframe lines.\n\t */\n\tconstructor(thickness:number = 1.25)\n\t{\n\t\tsuper();\n\n\t\tthis._thickness = thickness;\n\n\t\tthis.bothSides = true;\n\n\t\tthis._pAddScreenPass(this._screenPass = new LineBasicPass());\n\n\t\tthis._calcMatrix = new Matrix3D();\n\n\t\tthis._constants[1] = 1/255;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\treturn \"m44 vt0, va0, vc8\t\t\t\\n\" + // transform Q0 to eye space\n\t\t\t\"m44 vt1, va1, vc8\t\t\t\\n\" + // transform Q1 to eye space\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\n\t\t\t// test if behind camera near plane\n\t\t\t// if 0 - Q0.z < Camera.near then the point needs to be clipped\n\t\t\t//\"neg vt5.x, vt0.z\t\t\t\t\\n\" + // 0 - Q0.z\n\t\t\t\"slt vt5.x, vt0.z, vc7.z\t\t\t\\n\" + // behind = ( 0 - Q0.z < -Camera.near ) ? 1 : 0\n\t\t\t\"sub vt5.y, vc5.x, vt5.x\t\t\t\\n\" + // !behind = 1 - behind\n\n\t\t\t// p = point on the plane (0,0,-near)\n\t\t\t// n = plane normal (0,0,-1)\n\t\t\t// D = Q1 - Q0\n\t\t\t// t = ( dot( n, ( p - Q0 ) ) / ( dot( n, d )\n\n\t\t\t// solve for t where line crosses Camera.near\n\t\t\t\"add vt4.x, vt0.z, vc7.z\t\t\t\\n\" + // Q0.z + ( -Camera.near )\n\t\t\t\"sub vt4.y, vt0.z, vt1.z\t\t\t\\n\" + // Q0.z - Q1.z\n\n\t\t\t// fix divide by zero for horizontal lines\n\t\t\t\"seq vt4.z, vt4.y vc6.x\t\t\t\\n\" + // offset = (Q0.z - Q1.z)==0 ? 1 : 0\n\t\t\t\"add vt4.y, vt4.y, vt4.z\t\t\t\\n\" + // ( Q0.z - Q1.z ) + offset\n\n\t\t\t\"div vt4.z, vt4.x, vt4.y\t\t\t\\n\" + // t = ( Q0.z - near ) / ( Q0.z - Q1.z )\n\n\t\t\t\"mul vt4.xyz, vt4.zzz, vt2.xyz\t\\n\" + // t(L)\n\t\t\t\"add vt3.xyz, vt0.xyz, vt4.xyz\t\\n\" + // Qclipped = Q0 + t(L)\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // Qclipped.w = 1\n\n\t\t\t// If necessary, replace Q0 with new Qclipped\n\t\t\t\"mul vt0, vt0, vt5.yyyy\t\t\t\\n\" + // !behind * Q0\n\t\t\t\"mul vt3, vt3, vt5.xxxx\t\t\t\\n\" + // behind * Qclipped\n\t\t\t\"add vt0, vt0, vt3\t\t\t\t\\n\" + // newQ0 = Q0 + Qclipped\n\n\t\t\t// calculate side vector for line\n\t\t\t\"sub vt2, vt1, vt0 \t\t\t\\n\" + // L = Q1 - Q0\n\t\t\t\"nrm vt2.xyz, vt2.xyz\t\t\t\\n\" + // normalize( L )\n\t\t\t\"nrm vt5.xyz, vt0.xyz\t\t\t\\n\" + // D = normalize( Q1 )\n\t\t\t\"mov vt5.w, vc5.x\t\t\t\t\\n\" + // D.w = 1\n\t\t\t\"crs vt3.xyz, vt2, vt5\t\t\t\\n\" + // S = L x D\n\t\t\t\"nrm vt3.xyz, vt3.xyz\t\t\t\\n\" + // normalize( S )\n\n\t\t\t// face the side vector properly for the given point\n\t\t\t\"mul vt3.xyz, vt3.xyz, va2.xxx\t\\n\" + // S *= weight\n\t\t\t\"mov vt3.w, vc5.x\t\t\t\\n\" + // S.w = 1\n\n\t\t\t// calculate the amount required to move at the point's distance to correspond to the line's pixel width\n\t\t\t// scale the side vector by that amount\n\t\t\t\"dp3 vt4.x, vt0, vc6\t\t\t\\n\" + // distance = dot( view )\n\t\t\t\"mul vt4.x, vt4.x, vc7.x\t\t\t\\n\" + // distance *= vpsod\n\t\t\t\"mul vt3.xyz, vt3.xyz, vt4.xxx\t\\n\" + // S.xyz *= pixelScaleFactor\n\n\t\t\t// add scaled side vector to Q0 and transform to clip space\n\t\t\t\"add vt0.xyz, vt0.xyz, vt3.xyz\t\\n\" + // Q0 + S\n\n\t\t\t\"m44 op, vt0, vc0\t\t\t\\n\" + // transform Q0 to clip space\n\n\t\t\t// interpolate color\n\t\t\t\"mov v0, va3\t\t\t\t\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivatePass(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\tsuper._iActivatePass(pass, renderer, camera);\n\n\t\tvar context:IContextStageGL = renderer.context;\n\t\tvar stage:Stage = renderer.stage;\n\n\t\tthis._constants[0] = this._thickness/((stage.scissorRect)? Math.min(stage.scissorRect.width, stage.scissorRect.height) : Math.min(stage.width, stage.height));\n\n\t\t// value to convert distance from camera to model length per pixel width\n\t\tthis._constants[2] = camera.projection.near;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 5, LineBasicMaterial.pONE_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 6, LineBasicMaterial.pFRONT_VECTOR, 1);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 7, this._constants, 1);\n\n\t\t// projection matrix\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 0, camera.projection.matrix, true);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRenderPass(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRenderPass(pass, renderable, stage, camera, viewProjection);\n\n\t\tvar context:IContextStageGL = <IContextStageGL> stage.context;\n\t\tthis._calcMatrix.copyFrom(renderable.sourceEntity.sceneTransform);\n\t\tthis._calcMatrix.append(camera.inverseSceneTransform);\n\n\t\tcontext.setProgramConstantsFromMatrix(ContextGLProgramType.VERTEX, 8, this._calcMatrix, true);\n\n\t\tcontext.activateBuffer(0, renderable.getVertexData(LineSubGeometry.START_POSITION_DATA), renderable.getVertexOffset(LineSubGeometry.START_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tcontext.activateBuffer(1, renderable.getVertexData(LineSubGeometry.END_POSITION_DATA), renderable.getVertexOffset(LineSubGeometry.END_POSITION_DATA), LineSubGeometry.POSITION_FORMAT);\n\t\tcontext.activateBuffer(2, renderable.getVertexData(LineSubGeometry.THICKNESS_DATA), renderable.getVertexOffset(LineSubGeometry.THICKNESS_DATA), LineSubGeometry.THICKNESS_FORMAT);\n\t\tcontext.activateBuffer(3, renderable.getVertexData(LineSubGeometry.COLOR_DATA), renderable.getVertexOffset(LineSubGeometry.COLOR_DATA), LineSubGeometry.COLOR_FORMAT);\n\n\t\tcontext.drawTriangles(context.getIndexBuffer(renderable.getIndexData()), 0, renderable.numTriangles);\n\t}\n}\n\nexport = LineBasicMaterial;",
    "import MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\n\nclass StageGLMaterialBase extends MaterialBase\n{\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = StageGLMaterialBase;",
    "import Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport BlendMode\t\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\n\nimport TriangleMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/TriangleMaterialBase\");\nimport TriangleBasicPass\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/TriangleBasicPass\");\n\n/**\n * TriangleMaterial forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass TriangleBasicMaterial extends TriangleMaterialBase\n{\n\tprivate _screenPass:TriangleBasicPass;\n\n\tprivate _alphaBlending:boolean = false;\n\tprivate _alpha:number = 1;\n\n\tprivate _depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\t/**\n\t * Creates a new TriangleMaterial object.\n\t *\n\t * @param texture The texture used for the material's albedo color.\n\t * @param smooth Indicates whether the texture should be filtered when sampled. Defaults to true.\n\t * @param repeat Indicates whether the texture should be tiled when sampled. Defaults to false.\n\t * @param mipmap Indicates whether or not any used textures should use mipmapping. Defaults to false.\n\t */\n\tconstructor(texture?:Texture2DBase, smooth?:boolean, repeat?:boolean, mipmap?:boolean);\n\tconstructor(color?:number, alpha?:number);\n\tconstructor(textureColor:any = null, smoothAlpha:any = null, repeat:boolean = false, mipmap:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._screenPass = new TriangleBasicPass();\n\n\t\tif (textureColor instanceof Texture2DBase) {\n\t\t\tthis.texture = <Texture2DBase> textureColor;\n\n\t\t\tthis.smooth = (smoothAlpha == null)? true : false;\n\t\t\tthis.repeat = repeat;\n\t\t\tthis.mipmap = mipmap;\n\t\t} else {\n\t\t\tthis.color = textureColor? Number(textureColor) : 0xCCCCCC;\n\t\t\tthis.alpha = (smoothAlpha == null)? 1 : Number(smoothAlpha);\n\t\t}\n\t}\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\n\tpublic get depthCompareMode():string\n\t{\n\t\treturn this._depthCompareMode;\n\t}\n\n\tpublic set depthCompareMode(value:string)\n\t{\n\t\tif (this._depthCompareMode == value)\n\t\t\treturn;\n\n\t\tthis._depthCompareMode = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The alpha of the surface.\n\t */\n\tpublic get alpha():number\n\t{\n\t\treturn this._alpha;\n\t}\n\n\tpublic set alpha(value:number)\n\t{\n\t\tif (value > 1)\n\t\t\tvalue = 1;\n\t\telse if (value < 0)\n\t\t\tvalue = 0;\n\n\t\tif (this._alpha == value)\n\t\t\treturn;\n\n\t\tthis._alpha = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Indicates whether or not the material has transparency. If binary transparency is sufficient, for\n\t * example when using textures of foliage, consider using alphaThreshold instead.\n\t */\n\tpublic get alphaBlending():boolean\n\t{\n\t\treturn this._alphaBlending;\n\t}\n\n\tpublic set alphaBlending(value:boolean)\n\t{\n\t\tif (this._alphaBlending == value)\n\t\t\treturn;\n\n\t\tthis._alphaBlending = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iUpdateMaterial()\n\t{\n\t\tvar passesInvalid:boolean;\n\n\t\tif (this._pScreenPassesInvalid) {\n\t\t\tthis.pUpdateScreenPasses();\n\t\t\tpassesInvalid = true;\n\t\t}\n\n\t\tif (passesInvalid) {\n\t\t\tthis._pClearScreenPasses();\n\n\t\t\tthis._pAddScreenPass(this._screenPass);\n\t\t}\n\t}\n\n\t/**\n\t * Updates screen passes when they were found to be invalid.\n\t */\n\tpublic pUpdateScreenPasses()\n\t{\n\t\tthis.initPasses();\n\n\t\tthis.setBlendAndCompareModes();\n\n\t\tthis._pScreenPassesInvalid = false;\n\t}\n\n\t/**\n\t * Initializes all the passes and their dependent passes.\n\t */\n\tprivate initPasses()\n\t{\n\t\t//\n\t}\n\n\t/**\n\t * Sets up the various blending modes for all screen passes, based on whether or not there are previous passes.\n\t */\n\tprivate setBlendAndCompareModes()\n\t{\n\t\tthis._pRequiresBlending = (this._pBlendMode != BlendMode.NORMAL || this._alphaBlending || this._alpha < 1);\n\t\tthis._screenPass.depthCompareMode = this._depthCompareMode;\n\t\tthis._screenPass.preserveAlpha = this._pRequiresBlending;\n\t\tthis._screenPass.setBlendMode((this._pBlendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._pBlendMode);\n\t\tthis._screenPass.forceSeparateMVP = false;\n\t}\n}\n\nexport = TriangleBasicMaterial;",
    "﻿import Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\n\n/**\n * CompiledPass forms an abstract base class for the default compiled pass materials provided by Away3D,\n * using material methods to define their appearance.\n */\nclass TriangleMaterialBase extends StageGLMaterialBase\n{\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\t//get the projection coordinates\n\t\tvar position:ShaderRegisterElement = (shaderObject.globalPosDependencies > 0)? sharedRegisters.globalPositionVertex : sharedRegisters.localPosition;\n\n\t\t//reserving vertex constants for projection matrix\n\t\tvar viewMatrixReg:ShaderRegisterElement = registerCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tregisterCache.getFreeVertexConstant();\n\t\tshaderObject.viewMatrixIndex = viewMatrixReg.index*4;\n\n\t\tif (shaderObject.projectionDependencies > 0) {\n\t\t\tsharedRegisters.projectionFragment = registerCache.getFreeVarying();\n\t\t\tvar temp:ShaderRegisterElement = registerCache.getFreeVertexVectorTemp();\n\t\t\tcode += \"m44 \" + temp + \", \" + position + \", \" + viewMatrixReg + \"\\n\" +\n\t\t\t\t\"mov \" + sharedRegisters.projectionFragment + \", \" + temp + \"\\n\" +\n\t\t\t\t\"mov op, \" + temp + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"m44 op, \" + position + \", \" + viewMatrixReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iRenderPass(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper._iRenderPass(pass, renderable, stage, camera, viewProjection);\n\n\t\tvar shaderObject:ShaderObjectBase = pass.shaderObject;\n\n\t\tif (shaderObject.sceneMatrixIndex >= 0) {\n\t\t\trenderable.sourceEntity.getRenderSceneTransform(camera).copyRawDataTo(shaderObject.vertexConstantData, shaderObject.sceneMatrixIndex, true);\n\t\t\tviewProjection.copyRawDataTo(shaderObject.vertexConstantData, shaderObject.viewMatrixIndex, true);\n\t\t} else {\n\t\t\tvar matrix3D:Matrix3D = Matrix3DUtils.CALCULATION_MATRIX;\n\n\t\t\tmatrix3D.copyFrom(renderable.sourceEntity.getRenderSceneTransform(camera));\n\t\t\tmatrix3D.append(viewProjection);\n\n\t\t\tmatrix3D.copyRawDataTo(shaderObject.vertexConstantData, shaderObject.viewMatrixIndex, true);\n\t\t}\n\n\t\tvar context:IContextStageGL = <IContextStageGL> stage.context;\n\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.VERTEX, 0, shaderObject.vertexConstantData, shaderObject.numUsedVertexConstants);\n\t\tcontext.setProgramConstantsFromArray(ContextGLProgramType.FRAGMENT, 0, shaderObject.fragmentConstantData, shaderObject.numUsedFragmentConstants);\n\n\t\tcontext.activateBuffer(0, renderable.getVertexData(TriangleSubGeometry.POSITION_DATA), renderable.getVertexOffset(TriangleSubGeometry.POSITION_DATA), TriangleSubGeometry.POSITION_FORMAT);\n\t\tcontext.drawTriangles(context.getIndexBuffer(renderable.getIndexData()), 0, renderable.numTriangles);\n\t}\n}\n\nexport = TriangleMaterialBase;",
    "class TriangleMaterialMode\n{\n\t/**\n\t *\n\t */\n\tpublic static SINGLE_PASS:string = \"singlePass\";\n\n\t/**\n\t *\n\t */\n\tpublic static MULTI_PASS:string = \"multiPass\";\n}\n\nexport = TriangleMaterialMode;",
    "﻿import ColorTransform\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport BlendMode\t\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport StaticLightPicker\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/StaticLightPicker\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\n\nimport TriangleMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/TriangleMaterialBase\");\nimport TriangleMaterialMode\t\t\t= require(\"awayjs-renderergl/lib/materials/TriangleMaterialMode\");\nimport AmbientBasicMethod\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/AmbientBasicMethod\");\nimport DiffuseBasicMethod\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/DiffuseBasicMethod\");\nimport EffectMethodBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/EffectMethodBase\");\nimport NormalBasicMethod\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/NormalBasicMethod\");\nimport ShadowMapMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadowMapMethodBase\");\nimport SpecularBasicMethod\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/SpecularBasicMethod\");\nimport MaterialPassMode\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassMode\");\nimport TriangleMethodPass\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/TriangleMethodPass\");\n\n/**\n * TriangleMethodMaterial forms an abstract base class for the default shaded materials provided by Stage,\n * using material methods to define their appearance.\n */\nclass TriangleMethodMaterial extends TriangleMaterialBase\n{\n\tprivate _alphaBlending:boolean = false;\n\tprivate _alpha:number = 1;\n\tprivate _colorTransform:ColorTransform;\n\tprivate _materialMode:string;\n\tprivate _casterLightPass:TriangleMethodPass;\n\tprivate _nonCasterLightPasses:Array<TriangleMethodPass>;\n\tprivate _screenPass:TriangleMethodPass;\n\n\tprivate _ambientMethod:AmbientBasicMethod = new AmbientBasicMethod();\n\tprivate _shadowMethod:ShadowMapMethodBase;\n\tprivate _diffuseMethod:DiffuseBasicMethod = new DiffuseBasicMethod();\n\tprivate _normalMethod:NormalBasicMethod = new NormalBasicMethod();\n\tprivate _specularMethod:SpecularBasicMethod = new SpecularBasicMethod();\n\n\n\tprivate _depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\t/**\n\t * Creates a new TriangleMethodMaterial object.\n\t *\n\t * @param texture The texture used for the material's albedo color.\n\t * @param smooth Indicates whether the texture should be filtered when sampled. Defaults to true.\n\t * @param repeat Indicates whether the texture should be tiled when sampled. Defaults to false.\n\t * @param mipmap Indicates whether or not any used textures should use mipmapping. Defaults to false.\n\t */\n\tconstructor(texture?:Texture2DBase, smooth?:boolean, repeat?:boolean, mipmap?:boolean);\n\tconstructor(color?:number, alpha?:number);\n\tconstructor(textureColor:any = null, smoothAlpha:any = null, repeat:boolean = false, mipmap:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._materialMode = TriangleMaterialMode.SINGLE_PASS;\n\n\t\tif (textureColor instanceof Texture2DBase) {\n\t\t\tthis.texture = <Texture2DBase> textureColor;\n\n\t\t\tthis.smooth = (smoothAlpha == null)? true : false;\n\t\t\tthis.repeat = repeat;\n\t\t\tthis.mipmap = mipmap;\n\t\t} else {\n\t\t\tthis.color = (textureColor == null)? 0xFFFFFF : Number(textureColor);\n\t\t\tthis.alpha = (smoothAlpha == null)? 1 : Number(smoothAlpha);\n\t\t}\n\t}\n\n\n\tpublic get materialMode():string\n\t{\n\t\treturn this._materialMode;\n\t}\n\n\tpublic set materialMode(value:string)\n\t{\n\t\tif (this._materialMode == value)\n\t\t\treturn;\n\n\t\tthis._materialMode = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\n\tpublic get depthCompareMode():string\n\t{\n\t\treturn this._depthCompareMode;\n\t}\n\n\tpublic set depthCompareMode(value:string)\n\t{\n\t\tif (this._depthCompareMode == value)\n\t\t\treturn;\n\n\t\tthis._depthCompareMode = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The alpha of the surface.\n\t */\n\tpublic get alpha():number\n\t{\n\t\treturn this._alpha;\n\t}\n\n\tpublic set alpha(value:number)\n\t{\n\t\tif (value > 1)\n\t\t\tvalue = 1;\n\t\telse if (value < 0)\n\t\t\tvalue = 0;\n\n\t\tif (this._alpha == value)\n\t\t\treturn;\n\n\t\tthis._alpha = value;\n\n\t\tif (this._colorTransform == null)\n\t\t\tthis._colorTransform = new ColorTransform();\n\n\t\tthis._colorTransform.alphaMultiplier = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The ColorTransform object to transform the colour of the material with. Defaults to null.\n\t */\n\tpublic get colorTransform():ColorTransform\n\t{\n\t\treturn this._screenPass.colorTransform;\n\t}\n\n\tpublic set colorTransform(value:ColorTransform)\n\t{\n\t\tthis._screenPass.colorTransform = value;\n\t}\n\n\t/**\n\t * The texture object to use for the ambient colour.\n\t */\n\tpublic get diffuseTexture():Texture2DBase\n\t{\n\t\treturn this._diffuseMethod.texture;\n\t}\n\n\tpublic set diffuseTexture(value:Texture2DBase)\n\t{\n\t\tthis._diffuseMethod.texture = value;\n\t}\n\n\t/**\n\t * The method that provides the ambient lighting contribution. Defaults to AmbientBasicMethod.\n\t */\n\tpublic get ambientMethod():AmbientBasicMethod\n\t{\n\t\treturn this._ambientMethod;\n\t}\n\n\tpublic set ambientMethod(value:AmbientBasicMethod)\n\t{\n\t\tif (this._ambientMethod == value)\n\t\t\treturn;\n\n\t\tif (value && this._ambientMethod)\n\t\t\tvalue.copyFrom(this._ambientMethod);\n\n\t\tthis._ambientMethod = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The method used to render shadows cast on this surface, or null if no shadows are to be rendered. Defaults to null.\n\t */\n\tpublic get shadowMethod():ShadowMapMethodBase\n\t{\n\t\treturn this._shadowMethod;\n\t}\n\n\tpublic set shadowMethod(value:ShadowMapMethodBase)\n\t{\n\t\tif (this._shadowMethod == value)\n\t\t\treturn;\n\n\t\tif (value && this._shadowMethod)\n\t\t\tvalue.copyFrom(this._shadowMethod);\n\n\t\tthis._shadowMethod = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The method that provides the diffuse lighting contribution. Defaults to DiffuseBasicMethod.\n\t */\n\tpublic get diffuseMethod():DiffuseBasicMethod\n\t{\n\t\treturn this._diffuseMethod;\n\t}\n\n\tpublic set diffuseMethod(value:DiffuseBasicMethod)\n\t{\n\t\tif (this._diffuseMethod == value)\n\t\t\treturn;\n\n\t\tif (value && this._diffuseMethod)\n\t\t\tvalue.copyFrom(this._diffuseMethod);\n\n\t\tthis._diffuseMethod = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The method that provides the specular lighting contribution. Defaults to SpecularBasicMethod.\n\t */\n\tpublic get specularMethod():SpecularBasicMethod\n\t{\n\t\treturn this._specularMethod;\n\t}\n\n\tpublic set specularMethod(value:SpecularBasicMethod)\n\t{\n\t\tif (this._specularMethod == value)\n\t\t\treturn;\n\n\t\tif (value && this._specularMethod)\n\t\t\tvalue.copyFrom(this._specularMethod);\n\n\t\tthis._specularMethod = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The method used to generate the per-pixel normals. Defaults to NormalBasicMethod.\n\t */\n\tpublic get normalMethod():NormalBasicMethod\n\t{\n\t\treturn this._normalMethod;\n\t}\n\n\tpublic set normalMethod(value:NormalBasicMethod)\n\t{\n\t\tif (this._normalMethod == value)\n\t\t\treturn;\n\n\t\tif (value && this._normalMethod)\n\t\t\tvalue.copyFrom(this._normalMethod);\n\n\t\tthis._normalMethod = value;\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * Appends an \"effect\" shading method to the shader. Effect methods are those that do not influence the lighting\n\t * but modulate the shaded colour, used for fog, outlines, etc. The method will be applied to the result of the\n\t * methods added prior.\n\t */\n\tpublic addEffectMethod(method:EffectMethodBase)\n\t{\n\t\tif (this._screenPass == null)\n\t\t\tthis._screenPass = new TriangleMethodPass();\n\n\t\tthis._screenPass.addEffectMethod(method);\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * The number of \"effect\" methods added to the material.\n\t */\n\tpublic get numEffectMethods():number\n\t{\n\t\treturn this._screenPass? this._screenPass.numEffectMethods : 0;\n\t}\n\n\t/**\n\t * Queries whether a given effect method was added to the material.\n\t *\n\t * @param method The method to be queried.\n\t * @return true if the method was added to the material, false otherwise.\n\t */\n\tpublic hasEffectMethod(method:EffectMethodBase):boolean\n\t{\n\t\treturn this._screenPass? this._screenPass.hasEffectMethod(method) : false;\n\t}\n\n\t/**\n\t * Returns the method added at the given index.\n\t * @param index The index of the method to retrieve.\n\t * @return The method at the given index.\n\t */\n\tpublic getEffectMethodAt(index:number):EffectMethodBase\n\t{\n\t\tif (this._screenPass == null)\n\t\t\treturn null;\n\n\t\treturn this._screenPass.getEffectMethodAt(index);\n\t}\n\n\t/**\n\t * Adds an effect method at the specified index amongst the methods already added to the material. Effect\n\t * methods are those that do not influence the lighting but modulate the shaded colour, used for fog, outlines,\n\t * etc. The method will be applied to the result of the methods with a lower index.\n\t */\n\tpublic addEffectMethodAt(method:EffectMethodBase, index:number)\n\t{\n\t\tif (this._screenPass == null)\n\t\t\tthis._screenPass = new TriangleMethodPass();\n\n\t\tthis._screenPass.addEffectMethodAt(method, index);\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Removes an effect method from the material.\n\t * @param method The method to be removed.\n\t */\n\tpublic removeEffectMethod(method:EffectMethodBase)\n\t{\n\t\tif (this._screenPass == null)\n\t\t\treturn;\n\n\t\tthis._screenPass.removeEffectMethod(method);\n\n\t\t// reconsider\n\t\tif (this._screenPass.numEffectMethods == 0)\n\t\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The normal map to modulate the direction of the surface for each texel. The default normal method expects\n\t * tangent-space normal maps, but others could expect object-space maps.\n\t */\n\tpublic get normalMap():Texture2DBase\n\t{\n\t\treturn this._normalMethod.normalMap;\n\t}\n\n\tpublic set normalMap(value:Texture2DBase)\n\t{\n\t\tthis._normalMethod.normalMap = value;\n\t}\n\n\t/**\n\t * A specular map that defines the strength of specular reflections for each texel in the red channel,\n\t * and the gloss factor in the green channel. You can use SpecularBitmapTexture if you want to easily set\n\t * specular and gloss maps from grayscale images, but correctly authored images are preferred.\n\t */\n\tpublic get specularMap():Texture2DBase\n\t{\n\t\treturn this._specularMethod.texture;\n\t}\n\n\tpublic set specularMap(value:Texture2DBase)\n\t{\n\t\tthis._specularMethod.texture = value;\n\t}\n\n\t/**\n\t * The glossiness of the material (sharpness of the specular highlight).\n\t */\n\tpublic get gloss():number\n\t{\n\t\treturn this._specularMethod.gloss;\n\t}\n\n\tpublic set gloss(value:number)\n\t{\n\t\tthis._specularMethod.gloss = value;\n\t}\n\n\t/**\n\t * The strength of the ambient reflection.\n\t */\n\tpublic get ambient():number\n\t{\n\t\treturn this._ambientMethod.ambient;\n\t}\n\n\tpublic set ambient(value:number)\n\t{\n\t\tthis._ambientMethod.ambient = value;\n\t}\n\n\t/**\n\t * The overall strength of the specular reflection.\n\t */\n\tpublic get specular():number\n\t{\n\t\treturn this._specularMethod.specular;\n\t}\n\n\tpublic set specular(value:number)\n\t{\n\t\tthis._specularMethod.specular = value;\n\t}\n\n\t/**\n\t * The colour of the ambient reflection.\n\t */\n\tpublic get ambientColor():number\n\t{\n\t\treturn this._diffuseMethod.ambientColor;\n\t}\n\n\tpublic set ambientColor(value:number)\n\t{\n\t\tthis._diffuseMethod.ambientColor = value;\n\t}\n\n\t/**\n\t * The colour of the diffuse reflection.\n\t */\n\tpublic get diffuseColor():number\n\t{\n\t\treturn this._diffuseMethod.diffuseColor;\n\t}\n\n\tpublic set diffuseColor(value:number)\n\t{\n\t\tthis._diffuseMethod.diffuseColor = value;\n\t}\n\n\t/**\n\t * The colour of the specular reflection.\n\t */\n\tpublic get specularColor():number\n\t{\n\t\treturn this._specularMethod.specularColor;\n\t}\n\n\tpublic set specularColor(value:number)\n\t{\n\t\tthis._specularMethod.specularColor = value;\n\t}\n\n\t/**\n\t * Indicates whether or not the material has transparency. If binary transparency is sufficient, for\n\t * example when using textures of foliage, consider using alphaThreshold instead.\n\t */\n\n\tpublic get alphaBlending():boolean\n\t{\n\t\treturn this._alphaBlending;\n\t}\n\n\tpublic set alphaBlending(value:boolean)\n\t{\n\t\tif (this._alphaBlending == value)\n\t\t\treturn;\n\n\t\tthis._alphaBlending = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iUpdateMaterial()\n\t{\n\t\tif (this._pScreenPassesInvalid) {\n\t\t\t//Updates screen passes when they were found to be invalid.\n\t\t\tthis._pScreenPassesInvalid = false;\n\n\t\t\tthis.initPasses();\n\n\t\t\tthis.setBlendAndCompareModes();\n\n\t\t\tthis._pClearScreenPasses();\n\n\t\t\tif (this._materialMode == TriangleMaterialMode.MULTI_PASS) {\n\t\t\t\tif (this._casterLightPass)\n\t\t\t\t\tthis._pAddScreenPass(this._casterLightPass);\n\n\t\t\t\tif (this._nonCasterLightPasses)\n\t\t\t\t\tfor (var i:number = 0; i < this._nonCasterLightPasses.length; ++i)\n\t\t\t\t\t\tthis._pAddScreenPass(this._nonCasterLightPasses[i]);\n\t\t\t}\n\n\t\t\tif (this._screenPass)\n\t\t\t\tthis._pAddScreenPass(this._screenPass);\n\t\t}\n\t}\n\n\t/**\n\t * Initializes all the passes and their dependent passes.\n\t */\n\tprivate initPasses()\n\t{\n\t\t// let the effects pass handle everything if there are no lights, when there are effect methods applied\n\t\t// after shading, or when the material mode is single pass.\n\t\tif (this.numLights == 0 || this.numEffectMethods > 0 || this._materialMode == TriangleMaterialMode.SINGLE_PASS)\n\t\t\tthis.initEffectPass();\n\t\telse if (this._screenPass)\n\t\t\tthis.removeEffectPass();\n\n\t\t// only use a caster light pass if shadows need to be rendered\n\t\tif (this._shadowMethod && this._materialMode == TriangleMaterialMode.MULTI_PASS)\n\t\t\tthis.initCasterLightPass();\n\t\telse if (this._casterLightPass)\n\t\t\tthis.removeCasterLightPass();\n\n\t\t// only use non caster light passes if there are lights that don't cast\n\t\tif (this.numNonCasters > 0 && this._materialMode == TriangleMaterialMode.MULTI_PASS)\n\t\t\tthis.initNonCasterLightPasses();\n\t\telse if (this._nonCasterLightPasses)\n\t\t\tthis.removeNonCasterLightPasses();\n\t}\n\n\t/**\n\t * Sets up the various blending modes for all screen passes, based on whether or not there are previous passes.\n\t */\n\tprivate setBlendAndCompareModes()\n\t{\n\t\tvar forceSeparateMVP:boolean = Boolean(this._casterLightPass || this._screenPass);\n\n\t\t// caster light pass is always first if it exists, hence it uses normal blending\n\t\tif (this._casterLightPass) {\n\t\t\tthis._casterLightPass.forceSeparateMVP = forceSeparateMVP;\n\t\t\tthis._casterLightPass.setBlendMode(BlendMode.NORMAL);\n\t\t\tthis._casterLightPass.depthCompareMode = this._depthCompareMode;\n\t\t}\n\n\t\tif (this._nonCasterLightPasses) {\n\t\t\tvar firstAdditiveIndex:number = 0;\n\n\t\t\t// if there's no caster light pass, the first non caster light pass will be the first\n\t\t\t// and should use normal blending\n\t\t\tif (!this._casterLightPass) {\n\t\t\t\tthis._nonCasterLightPasses[0].forceSeparateMVP = forceSeparateMVP;\n\t\t\t\tthis._nonCasterLightPasses[0].setBlendMode(BlendMode.NORMAL);\n\t\t\t\tthis._nonCasterLightPasses[0].depthCompareMode = this._depthCompareMode;\n\t\t\t\tfirstAdditiveIndex = 1;\n\t\t\t}\n\n\t\t\t// all lighting passes following the first light pass should use additive blending\n\t\t\tfor (var i:number = firstAdditiveIndex; i < this._nonCasterLightPasses.length; ++i) {\n\t\t\t\tthis._nonCasterLightPasses[i].forceSeparateMVP = forceSeparateMVP;\n\t\t\t\tthis._nonCasterLightPasses[i].setBlendMode(BlendMode.ADD);\n\t\t\t\tthis._nonCasterLightPasses[i].depthCompareMode = ContextGLCompareMode.LESS_EQUAL;\n\t\t\t}\n\t\t}\n\n\t\tif (this._casterLightPass || this._nonCasterLightPasses) {\n\t\t\t//cannot be blended by blendmode property if multipass enabled\n\t\t\tthis._pRequiresBlending = false;\n\n\t\t\t// there are light passes, so this should be blended in\n\t\t\tif (this._screenPass) {\n\t\t\t\tthis._screenPass.passMode = MaterialPassMode.EFFECTS;\n\t\t\t\tthis._screenPass.depthCompareMode = ContextGLCompareMode.LESS_EQUAL;\n\t\t\t\tthis._screenPass.setBlendMode(BlendMode.LAYER);\n\t\t\t\tthis._screenPass.forceSeparateMVP = forceSeparateMVP;\n\t\t\t}\n\n\t\t} else if (this._screenPass) {\n\t\t\tthis._pRequiresBlending = (this._pBlendMode != BlendMode.NORMAL || this._alphaBlending || (this._colorTransform && this._colorTransform.alphaMultiplier < 1));\n\t\t\t// effects pass is the only pass, so it should just blend normally\n\t\t\tthis._screenPass.passMode = MaterialPassMode.SUPER_SHADER;\n\t\t\tthis._screenPass.depthCompareMode = this._depthCompareMode;\n\t\t\tthis._screenPass.preserveAlpha = this._pRequiresBlending;\n\t\t\tthis._screenPass.colorTransform = this._colorTransform;\n\t\t\tthis._screenPass.setBlendMode((this._pBlendMode == BlendMode.NORMAL && this._pRequiresBlending)? BlendMode.LAYER : this._pBlendMode);\n\t\t\tthis._screenPass.forceSeparateMVP = false;\n\t\t}\n\t}\n\n\tprivate initCasterLightPass()\n\t{\n\n\t\tif (this._casterLightPass == null)\n\t\t\tthis._casterLightPass = new TriangleMethodPass(MaterialPassMode.LIGHTING);\n\n\t\tthis._casterLightPass.lightPicker = new StaticLightPicker([this._shadowMethod.castingLight]);\n\t\tthis._casterLightPass.shadowMethod = this._shadowMethod;\n\t\tthis._casterLightPass.diffuseMethod = this._diffuseMethod;\n\t\tthis._casterLightPass.ambientMethod = this._ambientMethod;\n\t\tthis._casterLightPass.normalMethod = this._normalMethod;\n\t\tthis._casterLightPass.specularMethod = this._specularMethod;\n\t}\n\n\tprivate removeCasterLightPass()\n\t{\n\t\tthis._casterLightPass.dispose();\n\t\tthis._pRemoveScreenPass(this._casterLightPass);\n\t\tthis._casterLightPass = null;\n\t}\n\n\tprivate initNonCasterLightPasses()\n\t{\n\t\tthis.removeNonCasterLightPasses();\n\t\tvar pass:TriangleMethodPass;\n\t\tvar numDirLights:number = this._pLightPicker.numDirectionalLights;\n\t\tvar numPointLights:number = this._pLightPicker.numPointLights;\n\t\tvar numLightProbes:number = this._pLightPicker.numLightProbes;\n\t\tvar dirLightOffset:number = 0;\n\t\tvar pointLightOffset:number = 0;\n\t\tvar probeOffset:number = 0;\n\n\t\tif (!this._casterLightPass) {\n\t\t\tnumDirLights += this._pLightPicker.numCastingDirectionalLights;\n\t\t\tnumPointLights += this._pLightPicker.numCastingPointLights;\n\t\t}\n\n\t\tthis._nonCasterLightPasses = new Array<TriangleMethodPass>();\n\n\t\twhile (dirLightOffset < numDirLights || pointLightOffset < numPointLights || probeOffset < numLightProbes) {\n\t\t\tpass = new TriangleMethodPass(MaterialPassMode.LIGHTING);\n\t\t\tpass.includeCasters = this._shadowMethod == null;\n\t\t\tpass.directionalLightsOffset = dirLightOffset;\n\t\t\tpass.pointLightsOffset = pointLightOffset;\n\t\t\tpass.lightProbesOffset = probeOffset;\n\t\t\tpass.lightPicker = this._pLightPicker;\n\t\t\tpass.diffuseMethod = this._diffuseMethod;\n\t\t\tpass.ambientMethod = this._ambientMethod;\n\t\t\tpass.normalMethod = this._normalMethod;\n\t\t\tpass.specularMethod = this._specularMethod;\n\t\t\tthis._nonCasterLightPasses.push(pass);\n\n\t\t\tdirLightOffset += pass.iNumDirectionalLights;\n\t\t\tpointLightOffset += pass.iNumPointLights;\n\t\t\tprobeOffset += pass.iNumLightProbes;\n\t\t}\n\t}\n\n\tprivate removeNonCasterLightPasses()\n\t{\n\t\tif (!this._nonCasterLightPasses)\n\t\t\treturn;\n\n\t\tfor (var i:number = 0; i < this._nonCasterLightPasses.length; ++i)\n\t\t\tthis._pRemoveScreenPass(this._nonCasterLightPasses[i]);\n\n\t\tthis._nonCasterLightPasses = null;\n\t}\n\n\tprivate removeEffectPass()\n\t{\n\t\tif (this._screenPass.ambientMethod != this._ambientMethod)\n\t\t\tthis._screenPass.ambientMethod.dispose();\n\n\t\tif (this._screenPass.diffuseMethod != this._diffuseMethod)\n\t\t\tthis._screenPass.diffuseMethod.dispose();\n\n\t\tif (this._screenPass.specularMethod != this._specularMethod)\n\t\t\tthis._screenPass.specularMethod.dispose();\n\n\t\tif (this._screenPass.normalMethod != this._normalMethod)\n\t\t\tthis._screenPass.normalMethod.dispose();\n\n\t\tthis._pRemoveScreenPass(this._screenPass);\n\t\tthis._screenPass = null;\n\t}\n\n\tprivate initEffectPass()\n\t{\n\t\tif (this._screenPass == null)\n\t\t\tthis._screenPass = new TriangleMethodPass();\n\n\t\tif (this._materialMode == TriangleMaterialMode.SINGLE_PASS) {\n\t\t\tthis._screenPass.ambientMethod = this._ambientMethod;\n\t\t\tthis._screenPass.diffuseMethod = this._diffuseMethod;\n\t\t\tthis._screenPass.specularMethod = this._specularMethod;\n\t\t\tthis._screenPass.normalMethod = this._normalMethod;\n\t\t\tthis._screenPass.shadowMethod = this._shadowMethod;\n\t\t} else if (this._materialMode == TriangleMaterialMode.MULTI_PASS) {\n\t\t\tif (this.numLights == 0) {\n\t\t\t\tthis._screenPass.ambientMethod = this._ambientMethod;\n\t\t\t} else {\n\t\t\t\tthis._screenPass.ambientMethod = null;\n\t\t\t}\n\n\t\t\tthis._screenPass.preserveAlpha = false;\n\t\t\tthis._screenPass.normalMethod = this._normalMethod;\n\t\t}\n\t}\n\n\t/**\n\t * The maximum total number of lights provided by the light picker.\n\t */\n\tprivate get numLights():number\n\t{\n\t\treturn this._pLightPicker? this._pLightPicker.numLightProbes + this._pLightPicker.numDirectionalLights + this._pLightPicker.numPointLights + this._pLightPicker.numCastingDirectionalLights + this._pLightPicker.numCastingPointLights : 0;\n\t}\n\n\t/**\n\t * The amount of lights that don't cast shadows.\n\t */\n\tprivate get numNonCasters():number\n\t{\n\t\treturn this._pLightPicker? this._pLightPicker.numLightProbes + this._pLightPicker.numDirectionalLights + this._pLightPicker.numPointLights : 0;\n\t}\n}\n\nexport = TriangleMethodMaterial;",
    "import ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\n\n/**\n * MethodVO contains data for a given shader object for the use within a single material.\n * This allows shader methods to be shared across materials while their non-public state differs.\n */\nclass MethodVO\n{\n\tpublic useMethod:boolean = true;\n\n\tpublic method:ShadingMethodBase;\n\n\t// public register indices\n\tpublic texturesIndex:number;\n\tpublic secondaryTexturesIndex:number; // sometimes needed for composites\n\tpublic vertexConstantsIndex:number;\n\tpublic secondaryVertexConstantsIndex:number; // sometimes needed for composites\n\tpublic fragmentConstantsIndex:number;\n\tpublic secondaryFragmentConstantsIndex:number; // sometimes needed for composites\n\n\t// internal stuff for the material to know before assembling code\n\tpublic needsProjection:boolean;\n\tpublic needsView:boolean;\n\tpublic needsNormals:boolean;\n\tpublic needsTangents:boolean;\n\tpublic needsUV:boolean;\n\tpublic needsSecondaryUV:boolean;\n\tpublic needsGlobalVertexPos:boolean;\n\tpublic needsGlobalFragmentPos:boolean;\n\n\tpublic usesTexture:boolean;\n\n\t/**\n\t * Creates a new MethodVO object.\n\t */\n\tconstructor(method:ShadingMethodBase)\n\t{\n\t\tthis.method = method;\n\t}\n\n\t/**\n\t * Resets the values of the value object to their \"unused\" state.\n\t */\n\tpublic reset()\n\t{\n\t\tthis.method.iReset();\n\n\t\tthis.texturesIndex = -1;\n\t\tthis.vertexConstantsIndex = -1;\n\t\tthis.fragmentConstantsIndex = -1;\n\n\t\tthis.needsProjection = false;\n\t\tthis.needsView = false;\n\t\tthis.needsNormals = false;\n\t\tthis.needsTangents = false;\n\t\tthis.needsUV = false;\n\t\tthis.needsSecondaryUV = false;\n\t\tthis.needsGlobalVertexPos = false;\n\t\tthis.needsGlobalFragmentPos = false;\n\t}\n}\n\nexport = MethodVO;\n",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\n\n/**\n * RegisterPool is used by the shader compilation process to keep track of which registers of a certain type are\n * currently used and should not be allowed to be written to. Either entire registers can be requested and locked,\n * or single components (x, y, z, w) of a single register.\n * It is used by ShaderRegisterCache to track usages of individual register types.\n *\n * @see away.materials.ShaderRegisterCache\n */\nclass RegisterPool\n{\n\tprivate static _regPool:Object = new Object();\n\tprivate static _regCompsPool:Object = new Object();\n\n\tprivate _vectorRegisters:Array<ShaderRegisterElement>;\n\tprivate _registerComponents;\n\n\tprivate _regName:string;\n\tprivate _usedSingleCount:Array<Array<number>>;\n\tprivate _usedVectorCount:Array<number> /*uint*/;\n\tprivate _regCount:number;\n\n\tprivate _persistent:boolean;\n\n\t/**\n\t * Creates a new RegisterPool object.\n\t * @param regName The base name of the register type (\"ft\" for fragment temporaries, \"vc\" for vertex constants, etc)\n\t * @param regCount The amount of available registers of this type.\n\t * @param persistent Whether or not registers, once reserved, can be freed again. For example, temporaries are not persistent, but constants are.\n\t */\n\tconstructor(regName:string, regCount:number, persistent:boolean = true)\n\t{\n\t\tthis._regName = regName;\n\t\tthis._regCount = regCount;\n\t\tthis._persistent = persistent;\n\t\tthis.initRegisters(regName, regCount);\n\t}\n\n\t/**\n\t * Retrieve an entire vector register that's still available.\n\t */\n\tpublic requestFreeVectorReg():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (!this.isRegisterUsed(i)) {\n\t\t\t\tif (this._persistent)\n\t\t\t\t\tthis._usedVectorCount[i]++;\n\n\t\t\t\treturn this._vectorRegisters[i];\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Retrieve a single vector component that's still available.\n\t */\n\tpublic requestFreeRegComponent():ShaderRegisterElement\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i) {\n\t\t\tif (this._usedVectorCount[i] > 0)\n\t\t\t\tcontinue;\n\n\t\t\tfor (var j:number = 0; j < 4; ++j) {\n\t\t\t\tif (this._usedSingleCount[j][i] == 0) {\n\t\t\t\t\tif (this._persistent)\n\t\t\t\t\t\tthis._usedSingleCount[j][i]++;\n\n\t\t\t\t\treturn this._registerComponents[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error(\"Register overflow!\");\n\t}\n\n\t/**\n\t * Marks a register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addUsage(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tif (register._component > -1)\n\t\t\tthis._usedSingleCount[register._component][register.index] += usageCount;\n\t\telse\n\t\t\tthis._usedVectorCount[register.index] += usageCount;\n\t}\n\n\t/**\n\t * Removes a usage from a register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeUsage(register:ShaderRegisterElement)\n\t{\n\t\tif (register._component > -1) {\n\t\t\tif (--this._usedSingleCount[register._component][register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t} else {\n\t\t\tif (--this._usedVectorCount[register.index] < 0)\n\t\t\t\tthrow new Error(\"More usages removed than exist!\");\n\t\t}\n\t}\n\n\t/**\n\t * Disposes any resources used by the current RegisterPool object.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._vectorRegisters = null;\n\t\tthis._registerComponents = null;\n\t\tthis._usedSingleCount = null;\n\t\tthis._usedVectorCount = null;\n\t}\n\n\t/**\n\t * Indicates whether or not any registers are in use.\n\t */\n\tpublic hasRegisteredRegs():boolean\n\t{\n\t\tfor (var i:number = 0; i < this._regCount; ++i)\n\t\t\tif (this.isRegisterUsed(i))\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Initializes all registers.\n\t */\n\tprivate initRegisters(regName:string, regCount:number)\n\t{\n\t\tvar hash:string = RegisterPool._initPool(regName, regCount);\n\n\t\tthis._vectorRegisters = RegisterPool._regPool[hash];\n\t\tthis._registerComponents = RegisterPool._regCompsPool[hash];\n\n\t\tthis._usedVectorCount = this._initArray(Array<number>(regCount), 0);\n\n\t\tthis._usedSingleCount = new Array<Array<number>>(4);\n\t\tthis._usedSingleCount[0] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[1] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[2] = this._initArray(new Array<number>(regCount), 0);\n\t\tthis._usedSingleCount[3] = this._initArray(new Array<number>(regCount), 0);\n\t}\n\n\tprivate static _initPool(regName:string, regCount:number):string\n\t{\n\t\tvar hash:string = regName + regCount;\n\n\t\tif (RegisterPool._regPool[hash] != undefined)\n\t\t\treturn hash;\n\n\t\tvar vectorRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>(regCount);\n\t\tRegisterPool._regPool[hash] = vectorRegisters;\n\n\t\tvar registerComponents = [\n\t\t\t[],\n\t\t\t[],\n\t\t\t[],\n\t\t\t[]\n\t\t];\n\t\tRegisterPool._regCompsPool[hash] = registerComponents;\n\n\t\tfor (var i:number = 0; i < regCount; ++i) {\n\n\t\t\tvectorRegisters[i] = new ShaderRegisterElement(regName, i);\n\n\t\t\tfor (var j:number = 0; j < 4; ++j)\n\t\t\t\tregisterComponents[j][i] = new ShaderRegisterElement(regName, i, j);\n\t\t}\n\n\t\treturn hash;\n\t}\n\n\n\t/**\n\t * Check if the temp register is either used for single or vector use\n\t */\n\tprivate isRegisterUsed(index:number):boolean\n\t{\n\t\tif (this._usedVectorCount[index] > 0)\n\t\t\treturn true;\n\n\t\tfor (var i:number = 0; i < 4; ++i)\n\t\t\tif (this._usedSingleCount[i][index] > 0)\n\t\t\t\treturn true;\n\n\t\treturn false;\n\t}\n\n\n\tprivate _initArray(a:Array<any>, val:any):Array<any>\n\t{\n\t\tvar l:number = a.length;\n\n\t\tfor (var c:number = 0; c < l; c++)\n\t\t\ta[c] = val;\n\n\t\treturn a;\n\t}\n}\n\nexport = RegisterPool;\n",
    "import AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport IMaterialPassStageGL\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/IMaterialPassStageGL\");\nimport MaterialPassMode\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassMode\");\n\n/**\n * ShaderCompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass ShaderCompilerBase\n{\n\tpublic _pShaderObject:ShaderObjectBase;\n\tpublic _pSharedRegisters:ShaderRegisterData;\n\tpublic _pRegisterCache:ShaderRegisterCache;\n\tpublic _pMaterialPass:IMaterialPassStageGL;\n\tpublic _pMaterial:StageGLMaterialBase;\n\n\tpublic _pVertexCode:string = ''; // Changed to emtpy string- AwayTS\n\tpublic _pFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\tpublic _pPostAnimationFragmentCode:string = '';// Changed to emtpy string - AwayTS\n\n\t//The attributes that need to be animated by animators.\n\tpublic _pAnimatableAttributes:Array<string>;\n\n\t//The target registers for animated properties, written to by the animators.\n\tpublic _pAnimationTargetRegisters:Array<string>;\n\n\t//The target register to place the animated UV coordinate.\n\tprivate _uvTarget:string;\n\n\t//The souce register providing the UV coordinate to animate.\n\tprivate _uvSource:string;\n\n\tpublic _pProfile:string;\n\n\t/**\n\t * Creates a new ShaderCompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(material:StageGLMaterialBase, materialPass:IMaterialPassStageGL, shaderObject:ShaderObjectBase)\n\t{\n\t\tthis._pMaterial = material;\n\t\tthis._pMaterialPass = materialPass;\n\n\t\tthis._pShaderObject = shaderObject;\n\t\tthis._pProfile = shaderObject.profile;\n\n\t\tthis._pSharedRegisters = new ShaderRegisterData();\n\n\t\tthis._pRegisterCache = new ShaderRegisterCache(this._pProfile);\n\t\tthis._pRegisterCache.vertexAttributesOffset = 1;\n\t\tthis._pRegisterCache.reset();\n\t}\n\n\t/**\n\t * Compiles the code after all setup on the compiler has finished.\n\t */\n\tpublic compile()\n\t{\n\t\tthis._pShaderObject.reset();\n\n\t\tthis.pCalculateDependencies();\n\n\t\tthis.pInitRegisterIndices();\n\n\t\tthis.pCompileDependencies();\n\n\t\t//compile custom vertex & fragment codes\n\t\tthis._pVertexCode += this._pMaterialPass._iGetVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pPostAnimationFragmentCode += this._pMaterialPass._iGetFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//assign the final output color to the output register\n\t\tthis._pPostAnimationFragmentCode += \"mov \" + this._pRegisterCache.fragmentOutputRegister + \", \" + this._pSharedRegisters.shadedTarget + \"\\n\";\n\t\tthis._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);\n\n\t\t//initialise the required shader constants\n\t\tthis._pShaderObject.initConstantData(this._pRegisterCache, this._pAnimatableAttributes, this._pAnimationTargetRegisters, this._uvSource, this._uvTarget);\n\t\tthis._pMaterialPass._iInitConstantData(this._pShaderObject);\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tthis._pSharedRegisters.shadedTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget, 1);\n\n\t\t//compile the world-space position if required\n\t\tif (this._pShaderObject.globalPosDependencies > 0)\n\t\t\tthis.compileGlobalPositionCode();\n\n\t\t//Calculate the (possibly animated) UV coordinates.\n\t\tif (this._pShaderObject.uvDependencies > 0)\n\t\t\tthis.compileUVCode();\n\n\t\tif (this._pShaderObject.secondaryUVDependencies > 0)\n\t\t\tthis.compileSecondaryUVCode();\n\n\t\tif (this._pShaderObject.normalDependencies > 0)\n\t\t\tthis.compileNormalCode();\n\n\t\tif (this._pShaderObject.viewDirDependencies > 0)\n\t\t\tthis.compileViewDirCode();\n\n\t\t//collect code from material\n\t\tthis._pVertexCode += this._pMaterial._iGetVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pMaterial._iGetFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t//collect code from pass\n\t\tthis._pVertexCode += this._pMaterialPass._iGetPreLightingVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._pMaterialPass._iGetPreLightingFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\n\n\t}\n\n\tprivate compileGlobalPositionCode()\n\t{\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex = this._pRegisterCache.getFreeVertexVectorTemp(), this._pShaderObject.globalPosDependencies);\n\n\t\tvar sceneMatrixReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\tthis._pShaderObject.sceneMatrixIndex = sceneMatrixReg.index*4;\n\n\t\tthis._pVertexCode += \"m44 \" + this._pSharedRegisters.globalPositionVertex + \", \" + this._pSharedRegisters.localPosition + \", \" + sceneMatrixReg + \"\\n\";\n\n\t\tif (this._pShaderObject.usesGlobalPosFragment) {\n\t\t\tthis._pSharedRegisters.globalPositionVarying = this._pRegisterCache.getFreeVarying();\n\t\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.globalPositionVarying + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t}\n\t}\n\n\t/**\n\t * Calculate the (possibly animated) UV coordinates.\n\t */\n\tprivate compileUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShaderObject.uvBufferIndex = uvAttributeReg.index;\n\n\t\tvar varying:ShaderRegisterElement = this._pRegisterCache.getFreeVarying();\n\n\t\tthis._pSharedRegisters.uvVarying = varying;\n\n\t\tif (this._pShaderObject.usesUVTransform) {\n\t\t\t// a, b, 0, tx\n\t\t\t// c, d, 0, ty\n\t\t\tvar uvTransform1:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tvar uvTransform2:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tthis._pShaderObject.uvTransformIndex = uvTransform1.index*4;\n\n\t\t\tthis._pVertexCode += \"dp4 \" + varying + \".x, \" + uvAttributeReg + \", \" + uvTransform1 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"dp4 \" + varying + \".y, \" + uvAttributeReg + \", \" + uvTransform2 + \"\\n\" +\n\t\t\t\t\t\t\t\t \"mov \" + varying + \".zw, \" + uvAttributeReg + \".zw \\n\";\n\t\t} else {\n\t\t\tthis._pShaderObject.uvTransformIndex = -1;\n\t\t\tthis._uvTarget = varying.toString();\n\t\t\tthis._uvSource = uvAttributeReg.toString();\n\t\t}\n\t}\n\n\t/**\n\t * Provide the secondary UV coordinates.\n\t */\n\tprivate compileSecondaryUVCode()\n\t{\n\t\tvar uvAttributeReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexAttribute();\n\t\tthis._pShaderObject.secondaryUVBufferIndex = uvAttributeReg.index;\n\t\tthis._pSharedRegisters.secondaryUVVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pVertexCode += \"mov \" + this._pSharedRegisters.secondaryUVVarying + \", \" + uvAttributeReg + \"\\n\";\n\t}\n\n\t/**\n\t * Calculate the view direction.\n\t */\n\tpublic compileViewDirCode()\n\t{\n\t\tvar cameraPositionReg:ShaderRegisterElement = this._pRegisterCache.getFreeVertexConstant();\n\t\tthis._pSharedRegisters.viewDirVarying = this._pRegisterCache.getFreeVarying();\n\t\tthis._pSharedRegisters.viewDirFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment, this._pShaderObject.viewDirDependencies);\n\n\t\tthis._pShaderObject.cameraPositionIndex = cameraPositionReg.index*4;\n\n\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\"m33 \" + this._pSharedRegisters.viewDirVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.viewDirVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t} else {\n\t\t\tthis._pVertexCode += \"sub \" + this._pSharedRegisters.viewDirVarying + \", \" + cameraPositionReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex);\n\t\t}\n\n\t\t//TODO is this required in all cases? (re: distancemappass)\n\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.viewDirFragment + \".xyz, \" + this._pSharedRegisters.viewDirVarying + \"\\n\" +\n\t\t\t\"mov \" + this._pSharedRegisters.viewDirFragment + \".w,   \" + this._pSharedRegisters.viewDirVarying + \".w\\n\";\n\t}\n\n\t/**\n\t * Calculate the normal.\n\t */\n\tpublic compileNormalCode()\n\t{\n\t\tthis._pSharedRegisters.normalFragment = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment, this._pShaderObject.normalDependencies);\n\n\t\t//simple normal aquisition if no tangent space is being used\n\t\tif (this._pShaderObject.outputsNormals && !this._pShaderObject.outputsTangentNormals) {\n\t\t\tthis._pVertexCode += this._pMaterialPass._iGetNormalVertexCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\t\tthis._pFragmentCode += this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar normalMatrix:Array<ShaderRegisterElement>;\n\n\t\tif (!this._pShaderObject.outputsNormals || !this._pShaderObject.usesTangentSpace) {\n\t\t\tnormalMatrix = new Array<ShaderRegisterElement>(3);\n\t\t\tnormalMatrix[0] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[1] = this._pRegisterCache.getFreeVertexConstant();\n\t\t\tnormalMatrix[2] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pRegisterCache.getFreeVertexConstant();\n\n\t\t\tthis._pShaderObject.sceneNormalMatrixIndex = normalMatrix[0].index*4;\n\n\t\t\tthis._pSharedRegisters.normalVarying = this._pRegisterCache.getFreeVarying();\n\t\t}\n\n\t\tif (this._pShaderObject.outputsNormals) {\n\t\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\t\t// normalize normal + tangent vector and generate (approximated) bitangent used in m33 operation for view\n\t\t\t\tthis._pVertexCode += \"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + this._pSharedRegisters.animatedNormal + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"crs \" + this._pSharedRegisters.bitangent + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\";\n\n\t\t\t\tthis._pFragmentCode += this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t} else {\n\t\t\t\t//Compiles the vertex shader code for tangent-space normal maps.\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pSharedRegisters.bitangentVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedNormal + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"m33 \" + temp + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"nrm \" + this._pSharedRegisters.animatedTangent + \".xyz, \" + temp + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".x  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".x, \" + this._pSharedRegisters.animatedTangent + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".z, \" + this._pSharedRegisters.animatedNormal + \".z  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.normalInput + \".w  \\n\" +\n\t\t\t\t\t\"crs \" + temp + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".y, \" + temp + \".x    \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.bitangentVarying + \".y, \" + temp + \".y  \\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".y, \" + temp + \".z    \\n\";\n\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);\n\n\t\t\t\t//Compiles the fragment shader code for tangent-space normal maps.\n\t\t\t\tvar t:ShaderRegisterElement;\n\t\t\t\tvar b:ShaderRegisterElement;\n\t\t\t\tvar n:ShaderRegisterElement;\n\n\t\t\t\tt = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(t, 1);\n\t\t\t\tb = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(b, 1);\n\t\t\t\tn = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addFragmentTempUsages(n, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + t + \".xyz, \" + this._pSharedRegisters.tangentVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + t + \".w, \" + this._pSharedRegisters.tangentVarying + \".w\t\\n\" +\n\t\t\t\t\t\"nrm \" + b + \".xyz, \" + this._pSharedRegisters.bitangentVarying + \"\\n\" +\n\t\t\t\t\t\"nrm \" + n + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\";\n\n\t\t\t\t//compile custom fragment code for normal calcs\n\t\t\t\tthis._pFragmentCode += this._pMaterialPass._iGetNormalFragmentCode(this._pShaderObject, this._pRegisterCache, this._pSharedRegisters) +\n\t\t\t\t\t\"m33 \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalFragment + \", \" + t + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(b);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(t);\n\t\t\t\tthis._pRegisterCache.removeFragmentTempUsage(n);\n\t\t\t}\n\t\t} else {\n\t\t\t// no output, world space is enough\n\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.normalVarying + \".xyz, \" + this._pSharedRegisters.animatedNormal + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalVarying + \".w, \" + this._pSharedRegisters.animatedNormal + \".w\\n\";\n\n\t\t\tthis._pFragmentCode += \"nrm \" + this._pSharedRegisters.normalFragment + \".xyz, \" + this._pSharedRegisters.normalVarying + \"\\n\" +\n\t\t\t\t\"mov \" + this._pSharedRegisters.normalFragment + \".w, \" + this._pSharedRegisters.normalVarying + \".w\\n\";\n\n\t\t\tif (this._pShaderObject.tangentDependencies > 0) {\n\t\t\t\tthis._pSharedRegisters.tangentVarying = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + this._pSharedRegisters.tangentVarying + \".xyz, \" + this._pSharedRegisters.animatedTangent + \", \" + normalMatrix[0] + \"\\n\" +\n\t\t\t\t\t\"mov \" + this._pSharedRegisters.tangentVarying + \".w, \" + this._pSharedRegisters.animatedTangent + \".w\\n\";\n\t\t\t}\n\t\t}\n\n\t\tif (!this._pShaderObject.usesTangentSpace)\n\t\t\tthis._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal);\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis._pShaderObject.pInitRegisterIndices();\n\n\t\tthis._pAnimatableAttributes = new Array<string>(\"va0\");\n\t\tthis._pAnimationTargetRegisters = new Array<string>(\"vt0\");\n\t\tthis._pVertexCode = \"\";\n\t\tthis._pFragmentCode = \"\";\n\t\tthis._pPostAnimationFragmentCode = \"\";\n\n\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition = this._pRegisterCache.getFreeVertexVectorTemp(), 1);\n\n\t\t//create commonly shared constant registers\n\t\tthis._pSharedRegisters.commons = this._pRegisterCache.getFreeFragmentConstant();\n\t\tthis._pShaderObject.commonsDataIndex = this._pSharedRegisters.commons.index*4;\n\n\t\t//Creates the registers to contain the tangent data.\n\t\t// need to be created FIRST and in this order (for when using tangent space)\n\t\tif (this._pShaderObject.tangentDependencies > 0 || this._pShaderObject.outputsNormals) {\n\t\t\tthis._pSharedRegisters.tangentInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShaderObject.tangentBufferIndex = this._pSharedRegisters.tangentInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedTangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent, 1);\n\n\t\t\tif (this._pShaderObject.usesTangentSpace) {\n\t\t\t\tthis._pSharedRegisters.bitangent = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent, 1);\n\t\t\t}\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString());\n\t\t}\n\n\t\tif (this._pShaderObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.normalInput = this._pRegisterCache.getFreeVertexAttribute();\n\t\t\tthis._pShaderObject.normalBufferIndex = this._pSharedRegisters.normalInput.index;\n\n\t\t\tthis._pSharedRegisters.animatedNormal = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\tthis._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal, 1);\n\n\t\t\tthis._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());\n\t\t\tthis._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString());\n\t\t}\n\t}\n\n\t/**\n\t * Figure out which named registers are required, and how often.\n\t */\n\tpublic pCalculateDependencies()\n\t{\n\t\tthis._pShaderObject.useAlphaPremultiplied = this._pMaterial.alphaPremultiplied;\n\t\tthis._pShaderObject.useBothSides = this._pMaterial.bothSides;\n\t\tthis._pShaderObject.useMipmapping = this._pMaterial.mipmap;\n\t\tthis._pShaderObject.useSmoothTextures = this._pMaterial.smooth;\n\t\tthis._pShaderObject.repeatTextures = this._pMaterial.repeat;\n\t\tthis._pShaderObject.usesUVTransform = this._pMaterial.animateUVs;\n\t\tthis._pShaderObject.alphaThreshold = this._pMaterial.alphaThreshold;\n\t\tthis._pShaderObject.texture = this._pMaterial.texture;\n\t\tthis._pShaderObject.color = this._pMaterial.color;\n\t\t//TODO: fragment animtion should be compatible with lighting pass\n\t\tthis._pShaderObject.usesFragmentAnimation = Boolean(this._pMaterialPass.passMode == MaterialPassMode.SUPER_SHADER);\n\n\t\tthis._pMaterialPass._iIncludeDependencies(this._pShaderObject);\n\t}\n\n\t/**\n\t * Disposes all resources used by the compiler.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pRegisterCache.dispose();\n\t\tthis._pRegisterCache = null;\n\t\tthis._pSharedRegisters = null;\n\t}\n\n\t/**\n\t * The generated vertex code.\n\t */\n\tpublic get vertexCode():string\n\t{\n\t\treturn this._pVertexCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get fragmentCode():string\n\t{\n\t\treturn this._pFragmentCode;\n\t}\n\n\t/**\n\t * The generated fragment code.\n\t */\n\tpublic get postAnimationFragmentCode():string\n\t{\n\t\treturn this._pPostAnimationFragmentCode;\n\t}\n\n\t/**\n\t * The register name containing the final shaded colour.\n\t */\n\tpublic get shadedTarget():string\n\t{\n\t\treturn this._pSharedRegisters.shadedTarget.toString();\n\t}\n}\n\nexport = ShaderCompilerBase;",
    "import LightSources\t\t\t\t\t= require(\"awayjs-display/lib/materials/LightSources\");\n\nimport ContextGLProfile\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProfile\");\n\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderCompilerBase\");\nimport ShaderLightingObject\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingObject\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport ILightingPassStageGL\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/ILightingPassStageGL\");\n\n/**\n * ShaderCompilerBase is an abstract base class for shader compilers that use modular shader methods to assemble a\n * material. Concrete subclasses are used by the default materials.\n *\n * @see away.materials.ShadingMethodBase\n */\nclass ShaderLightingCompiler extends ShaderCompilerBase\n{\n\tprivate _materialLightingPass:ILightingPassStageGL;\n\tprivate _shaderLightingObject:ShaderLightingObject;\n\tpublic _pointLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _pointLightVertexConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightFragmentConstants:Array<ShaderRegisterElement>;\n\tpublic _dirLightVertexConstants:Array<ShaderRegisterElement>;\n\n\tpublic _pNumProbeRegisters:number;\n\n\t/**\n\t * Creates a new ShaderCompilerBase object.\n\t * @param profile The compatibility profile of the renderer.\n\t */\n\tconstructor(material:StageGLMaterialBase, materialPass:ILightingPassStageGL, shaderObject:ShaderLightingObject)\n\t{\n\t\tsuper(material, materialPass, shaderObject);\n\n\t\tthis._materialLightingPass = materialPass;\n\t\tthis._shaderLightingObject = shaderObject;\n\t}\n\n\t/**\n\t * Compile the code for the methods.\n\t */\n\tpublic pCompileDependencies()\n\t{\n\t\tsuper.pCompileDependencies();\n\n\t\t//compile the lighting code\n\t\tif (this._shaderLightingObject.usesShadows)\n\t\t\tthis.pCompileShadowCode();\n\n\t\tif (this._shaderLightingObject.usesLights) {\n\t\t\tthis.initLightRegisters();\n\t\t\tthis.compileLightCode();\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesProbes)\n\t\t\tthis.compileLightProbeCode();\n\n\t\tthis._pVertexCode += this._materialLightingPass._iGetPostLightingVertexCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t\tthis._pFragmentCode += this._materialLightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject, this._pRegisterCache, this._pSharedRegisters);\n\t}\n\n\t/**\n\t * Provides the code to provide shadow mapping.\n\t */\n\tpublic pCompileShadowCode()\n\t{\n\t\tif (this._shaderLightingObject.normalDependencies > 0) {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pSharedRegisters.normalFragment;\n\t\t} else {\n\t\t\tthis._pSharedRegisters.shadowTarget = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget, 1);\n\t\t}\n\t}\n\n\t/**\n\t * Initializes constant registers to contain light data.\n\t */\n\tprivate initLightRegisters()\n\t{\n\t\t// init these first so we're sure they're in sequence\n\t\tvar i:number, len:number;\n\n\t\tif (this._dirLightVertexConstants) {\n\t\t\tlen = this._dirLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._dirLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._dirLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tif (this._pointLightVertexConstants) {\n\t\t\tlen = this._pointLightVertexConstants.length;\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tthis._pointLightVertexConstants[i] = this._pRegisterCache.getFreeVertexConstant();\n\n\t\t\t\tif (this._shaderLightingObject.lightVertexConstantIndex == -1)\n\t\t\t\t\tthis._shaderLightingObject.lightVertexConstantIndex = this._pointLightVertexConstants[i].index*4;\n\t\t\t}\n\t\t}\n\n\t\tlen = this._dirLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._dirLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._dirLightFragmentConstants[i].index*4;\n\t\t}\n\n\t\tlen = this._pointLightFragmentConstants.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._pointLightFragmentConstants[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = this._pointLightFragmentConstants[i].index*4;\n\t\t}\n\t}\n\n\t/**\n\t * Compiles the shading code for directional and point lights.\n\t */\n\tprivate compileLightCode()\n\t{\n\t\tvar diffuseColorReg:ShaderRegisterElement;\n\t\tvar specularColorReg:ShaderRegisterElement;\n\t\tvar lightPosReg:ShaderRegisterElement;\n\t\tvar lightDirReg:ShaderRegisterElement;\n\t\tvar vertexRegIndex:number = 0;\n\t\tvar fragmentRegIndex:number = 0;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesLightsForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesLightsForDiffuse;\n\n\t\t//compile the shading code for directional lights.\n\t\tfor (var i:number = 0; i < this._materialLightingPass.iNumDirectionalLights; ++i) {\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightDirReg = this._dirLightVertexConstants[vertexRegIndex++];\n\n\t\t\t\tvar lightVarying:ShaderRegisterElement = this._pRegisterCache.getFreeVarying();\n\n\t\t\t\tthis._pVertexCode += \"m33 \" + lightVarying + \".xyz, \" + lightDirReg + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\t\tthis._pRegisterCache.addVertexTempUsages(lightDirReg, 1);\n\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\n\t\t\t} else {\n\t\t\t\tlightDirReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\t}\n\n\t\t\tdiffuseColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._dirLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace)\n\t\t\t\tthis._pRegisterCache.removeVertexTempUsage(lightDirReg);\n\t\t}\n\n\t\tvertexRegIndex = 0;\n\t\tfragmentRegIndex = 0;\n\n\t\t//compile the shading code for point lights\n\t\tfor (var i:number = 0; i < this._materialLightingPass.iNumPointLights; ++i) {\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment)\n\t\t\t\tlightPosReg = this._pointLightVertexConstants[vertexRegIndex++];\n\t\t\telse\n\t\t\t\tlightPosReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tdiffuseColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\t\t\tspecularColorReg = this._pointLightFragmentConstants[fragmentRegIndex++];\n\n\t\t\tlightDirReg = this._pRegisterCache.getFreeFragmentVectorTemp();\n\t\t\tthis._pRegisterCache.addFragmentTempUsages(lightDirReg, 1);\n\n\t\t\tvar lightVarying:ShaderRegisterElement;\n\n\t\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tvar temp:ShaderRegisterElement = this._pRegisterCache.getFreeVertexVectorTemp();\n\t\t\t\tthis._pVertexCode += \"sub \" + temp + \", \" + lightPosReg + \", \" + this._pSharedRegisters.localPosition + \"\\n\" +\n\t\t\t\t\t\"m33 \" + lightVarying + \".xyz, \" + temp + \", \" + this._pSharedRegisters.animatedTangent + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightVarying + \".w, \" + this._pSharedRegisters.localPosition + \".w\\n\";\n\t\t\t} else if (!this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\t\tlightVarying = this._pRegisterCache.getFreeVarying();\n\t\t\t\tthis._pVertexCode += \"sub \" + lightVarying + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVertex + \"\\n\";\n\t\t\t} else {\n\t\t\t\tlightVarying = lightDirReg;\n\t\t\t\tthis._pFragmentCode += \"sub \" + lightDirReg + \", \" + lightPosReg + \", \" + this._pSharedRegisters.globalPositionVarying + \"\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.usesLightFallOff) {\n\t\t\t\t// calculate attenuation\n\t\t\t\tthis._pFragmentCode += // attenuate\n\t\t\t\t\t\"dp3 \" + lightDirReg + \".w, \" + lightVarying + \", \" + lightVarying + \"\\n\" + // w = d - radius\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + diffuseColorReg + \".w\\n\" + // w = (d - radius)/(max-min)\n\t\t\t\t\t\"mul \" + lightDirReg + \".w, \" + lightDirReg + \".w, \" + specularColorReg + \".w\\n\" + // w = clamp(w, 0, 1)\n\t\t\t\t\t\"sat \" + lightDirReg + \".w, \" + lightDirReg + \".w\\n\" + // w = 1-w\n\t\t\t\t\t\"sub \" + lightDirReg + \".w, \" + this._pSharedRegisters.commons + \".w, \" + lightDirReg + \".w\\n\" + // normalize\n\t\t\t\t\t\"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\";\n\t\t\t} else {\n\t\t\t\tthis._pFragmentCode += \"nrm \" + lightDirReg + \".xyz, \" + lightVarying + \"\\n\" +\n\t\t\t\t\t\"mov \" + lightDirReg + \".w, \" + lightVarying + \".w\\n\";\n\t\t\t}\n\n\t\t\tif (this._shaderLightingObject.lightFragmentConstantIndex == -1)\n\t\t\t\tthis._shaderLightingObject.lightFragmentConstantIndex = lightPosReg.index*4;\n\n\t\t\tif (addDiff)\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject, lightDirReg, diffuseColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tif (addSpec)\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject, lightDirReg, specularColorReg, this._pRegisterCache, this._pSharedRegisters);\n\n\t\t\tthis._pRegisterCache.removeFragmentTempUsage(lightDirReg);\n\t\t}\n\t}\n\n\t/**\n\t * Compiles shading code for light probes.\n\t */\n\tprivate compileLightProbeCode()\n\t{\n\t\tvar weightReg:string;\n\t\tvar weightComponents = [ \".x\", \".y\", \".z\", \".w\" ];\n\t\tvar weightRegisters:Array<ShaderRegisterElement> = new Array<ShaderRegisterElement>();\n\t\tvar i:number;\n\t\tvar texReg:ShaderRegisterElement;\n\t\tvar addSpec:boolean = this._shaderLightingObject.usesProbesForSpecular;\n\t\tvar addDiff:boolean = this._shaderLightingObject.usesProbesForDiffuse;\n\n\t\tif (addDiff)\n\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices = new Array<number>();\n\n\t\tif (addSpec)\n\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices = new Array<number>();\n\n\t\tfor (i = 0; i < this._pNumProbeRegisters; ++i) {\n\t\t\tweightRegisters[i] = this._pRegisterCache.getFreeFragmentConstant();\n\n\t\t\tif (i == 0)\n\t\t\t\tthis._shaderLightingObject.probeWeightsIndex = weightRegisters[i].index*4;\n\t\t}\n\n\t\tfor (i = 0; i < this._materialLightingPass.iNumLightProbes; ++i) {\n\t\t\tweightReg = weightRegisters[Math.floor(i/4)].toString() + weightComponents[i%4];\n\n\t\t\tif (addDiff) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeDiffuseIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\n\t\t\tif (addSpec) {\n\t\t\t\ttexReg = this._pRegisterCache.getFreeTextureReg();\n\t\t\t\tthis._shaderLightingObject.lightProbeSpecularIndices[i] = texReg.index;\n\t\t\t\tthis._pFragmentCode += this._materialLightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject, texReg, weightReg, this._pRegisterCache, this._pSharedRegisters);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Reset all the indices to \"unused\".\n\t */\n\tpublic pInitRegisterIndices()\n\t{\n\t\tsuper.pInitRegisterIndices();\n\n\t\tthis._shaderLightingObject.lightVertexConstantIndex = -1;\n\t\tthis._shaderLightingObject.lightFragmentConstantIndex = -1;\n\t\tthis._shaderLightingObject.probeWeightsIndex = -1;\n\n\t\tthis._pNumProbeRegisters = Math.ceil(this._materialLightingPass.iNumLightProbes/4);\n\n\t\t//init light data\n\t\tif (this._shaderLightingObject.usesTangentSpace || !this._shaderLightingObject.usesGlobalPosFragment) {\n\t\t\tthis._pointLightVertexConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumPointLights);\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumPointLights*2);\n\t\t} else {\n\t\t\tthis._pointLightFragmentConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumPointLights*3);\n\t\t}\n\n\t\tif (this._shaderLightingObject.usesTangentSpace) {\n\t\t\tthis._dirLightVertexConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumDirectionalLights);\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumDirectionalLights*2);\n\t\t} else {\n\t\t\tthis._dirLightFragmentConstants = new Array<ShaderRegisterElement>(this._materialLightingPass.iNumDirectionalLights*3);\n\t\t}\n\t}\n\n\n\t/**\n\t * Figure out which named registers are required, and how often.\n\t */\n\tpublic pCalculateDependencies()\n\t{\n\t\tvar numAllLights:number = this._materialLightingPass.iNumPointLights + this._materialLightingPass.iNumDirectionalLights;\n\t\tvar numLightProbes:number = this._materialLightingPass.iNumLightProbes;\n\t\tvar diffuseLightSources:number = this._pMaterial.diffuseLightSources;\n\t\tvar specularLightSources:number = this._materialLightingPass._iUsesSpecular()? this._pMaterial.specularLightSources : 0x00;\n\t\tvar combinedLightSources:number = diffuseLightSources | specularLightSources;\n\n\t\tthis._shaderLightingObject.usesLightFallOff = this._pMaterial.enableLightFallOff && this._shaderLightingObject.profile != ContextGLProfile.BASELINE_CONSTRAINED;\n\t\tthis._shaderLightingObject.numLights = numAllLights + numLightProbes;\n\t\tthis._shaderLightingObject.numPointLights = this._materialLightingPass.iNumPointLights;\n\t\tthis._shaderLightingObject.numDirectionalLights = this._materialLightingPass.iNumDirectionalLights;\n\t\tthis._shaderLightingObject.numLightProbes = numLightProbes;\n\t\tthis._shaderLightingObject.pointLightsOffset = this._materialLightingPass.pointLightsOffset;\n\t\tthis._shaderLightingObject.directionalLightsOffset = this._materialLightingPass.directionalLightsOffset;\n\t\tthis._shaderLightingObject.lightProbesOffset = this._materialLightingPass.lightProbesOffset;\n\t\tthis._shaderLightingObject.lightPicker = this._materialLightingPass.lightPicker;\n\t\tthis._shaderLightingObject.usesLights = numAllLights > 0 && (combinedLightSources & LightSources.LIGHTS) != 0;\n\t\tthis._shaderLightingObject.usesProbes = numLightProbes > 0 && (combinedLightSources & LightSources.PROBES) != 0;\n\t\tthis._shaderLightingObject.usesLightsForSpecular = numAllLights > 0 && (specularLightSources & LightSources.LIGHTS) != 0;\n\t\tthis._shaderLightingObject.usesProbesForSpecular = numLightProbes > 0 && (specularLightSources & LightSources.PROBES) != 0;\n\t\tthis._shaderLightingObject.usesLightsForDiffuse = numAllLights > 0 && (diffuseLightSources & LightSources.LIGHTS) != 0;\n\t\tthis._shaderLightingObject.usesProbesForDiffuse = numLightProbes > 0 && (diffuseLightSources & LightSources.PROBES) != 0;\n\t\tthis._shaderLightingObject.usesShadows = this._materialLightingPass._iUsesShadows();\n\n\t\tsuper.pCalculateDependencies();\n\t}\n}\n\nexport = ShaderLightingCompiler;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderCompilerBase\");\nimport ShaderLightingCompiler\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingCompiler\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ILightingPassStageGL\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/ILightingPassStageGL\");\n\n/**\n * ShaderObjectBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderLightingObject extends ShaderObjectBase\n{\n\t/**\n\t * The first index for the fragment constants containing the light data.\n\t */\n\tpublic lightFragmentConstantIndex:number;\n\n\t/**\n\t * The starting index if the vertex constant to which light data needs to be uploaded.\n\t */\n\tpublic lightVertexConstantIndex:number;\n\n\t/**\n\t * Indices for the light probe diffuse textures.\n\t */\n\tpublic lightProbeDiffuseIndices:Array<number> /*uint*/;\n\n\t/**\n\t * Indices for the light probe specular textures.\n\t */\n\tpublic lightProbeSpecularIndices:Array<number> /*uint*/;\n\n\t/**\n\t * The index of the fragment constant containing the weights for the light probes.\n\t */\n\tpublic probeWeightsIndex:number;\n\n\tpublic numLights:number;\n\tpublic usesLightFallOff:boolean;\n\n\tpublic usesShadows:boolean;\n\n\tpublic numPointLights:number;\n\tpublic numDirectionalLights:number;\n\tpublic numLightProbes:number;\n\tpublic pointLightsOffset:number;\n\tpublic directionalLightsOffset:number;\n\tpublic lightProbesOffset:number;\n\tpublic lightPicker:LightPickerBase;\n\n\t/**\n\t * Indicates whether the shader uses any lights.\n\t */\n\tpublic usesLights:boolean;\n\n\t/**\n\t * Indicates whether the shader uses any light probes.\n\t */\n\tpublic usesProbes:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any specular components.\n\t */\n\tpublic usesLightsForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any specular components.\n\t */\n\tpublic usesProbesForSpecular:boolean;\n\n\t/**\n\t * Indicates whether the lights uses any diffuse components.\n\t */\n\tpublic usesLightsForDiffuse:boolean;\n\n\t/**\n\t * Indicates whether the probes uses any diffuse components.\n\t */\n\tpublic usesProbesForDiffuse:boolean;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(profile)\n\t{\n\t\tsuper(profile);\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param materialPassVO\n\t * @returns {away.materials.ShaderLightingCompiler}\n\t */\n\tpublic createCompiler(material:StageGLMaterialBase, materialPass:ILightingPassStageGL):ShaderCompilerBase\n\t{\n\t\treturn new ShaderLightingCompiler(material, materialPass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tsuper.reset();\n\n\t\tthis.numLights = 0;\n\t\tthis.usesLightFallOff = true;\n\t}\n\n\t/**\n\t * Adds any external world space dependencies, used to force world space calculations.\n\t */\n\tpublic addWorldSpaceDependencies(fragmentLights:boolean)\n\t{\n\t\tsuper.addWorldSpaceDependencies(fragmentLights);\n\n\t\tif (this.numPointLights > 0 && this.usesLights) {\n\t\t\t++this.globalPosDependencies;\n\n\t\t\tif (fragmentLights)\n\t\t\t\tthis.usesGlobalPosFragment = true;\n\t\t}\n\t}\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic setRenderState(renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper.setRenderState(renderable, stage, camera, viewProjection);\n\n\t\tif (this.usesLights)\n\t\t\tthis.updateLights();\n\n\t\tif (this.usesProbes)\n\t\t\tthis.updateProbes(stage);\n\t}\n\n\t/**\n\t * Updates constant data render state used by the lights. This method is optional for subclasses to implement.\n\t */\n\tprivate updateLights()\n\t{\n\t\tvar dirLight:DirectionalLight;\n\t\tvar pointLight:PointLight;\n\t\tvar i:number = 0;\n\t\tvar k:number = 0;\n\t\tvar len:number;\n\t\tvar dirPos:Vector3D;\n\t\tvar total:number = 0;\n\t\tvar numLightTypes:number = this.usesShadows? 2 : 1;\n\t\tvar l:number;\n\t\tvar offset:number;\n\n\t\tthis.ambientR = this.ambientG = this.ambientB = 0;\n\n\t\tl = this.lightVertexConstantIndex;\n\t\tk = this.lightFragmentConstantIndex;\n\n\t\tvar cast:number = 0;\n\t\tvar dirLights:Array<DirectionalLight> = this.lightPicker.directionalLights;\n\t\toffset = this.directionalLightsOffset;\n\t\tlen = this.lightPicker.directionalLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tdirLights = this.lightPicker.castingDirectionalLights;\n\n\t\t\tlen = dirLights.length;\n\n\t\t\tif (len > this.numDirectionalLights)\n\t\t\t\tlen = this.numDirectionalLights;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tdirLight = dirLights[offset + i];\n\t\t\t\tdirPos = dirLight.sceneDirection;\n\n\t\t\t\tthis.ambientR += dirLight._iAmbientR;\n\t\t\t\tthis.ambientG += dirLight._iAmbientG;\n\t\t\t\tthis.ambientB += dirLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tvar x:number = -dirPos.x;\n\t\t\t\t\tvar y:number = -dirPos.y;\n\t\t\t\t\tvar z:number = -dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = -dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iDiffuseB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = dirLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\n\t\t\t\tif (++total == this.numDirectionalLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numDirectionalLights > total) {\n\t\t\ti = k + (this.numDirectionalLights - total)*12;\n\n\t\t\twhile (k < i)\n\t\t\t\tthis.fragmentConstantData[k++] = 0;\n\t\t}\n\n\t\ttotal = 0;\n\n\t\tvar pointLights:Array<PointLight> = this.lightPicker.pointLights;\n\t\toffset = this.pointLightsOffset;\n\t\tlen = this.lightPicker.pointLights.length;\n\n\t\tif (offset > len) {\n\t\t\tcast = 1;\n\t\t\toffset -= len;\n\t\t} else {\n\t\t\tcast = 0;\n\t\t}\n\n\t\tfor (; cast < numLightTypes; ++cast) {\n\t\t\tif (cast)\n\t\t\t\tpointLights = this.lightPicker.castingPointLights;\n\n\t\t\tlen = pointLights.length;\n\n\t\t\tfor (i = 0; i < len; ++i) {\n\t\t\t\tpointLight = pointLights[offset + i];\n\t\t\t\tdirPos = pointLight.scenePosition;\n\n\t\t\t\tthis.ambientR += pointLight._iAmbientR;\n\t\t\t\tthis.ambientG += pointLight._iAmbientG;\n\t\t\t\tthis.ambientB += pointLight._iAmbientB;\n\n\t\t\t\tif (this.usesTangentSpace) {\n\t\t\t\t\tx = dirPos.x;\n\t\t\t\t\ty = dirPos.y;\n\t\t\t\t\tz = dirPos.z;\n\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\t\t\tthis.vertexConstantData[l++] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else if (!this.usesGlobalPosFragment) {\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.x;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.y;\n\t\t\t\t\tthis.vertexConstantData[l++] = dirPos.z;\n\t\t\t\t\tthis.vertexConstantData[l++] = 1;\n\t\t\t\t} else {\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.x;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.y;\n\t\t\t\t\tthis.fragmentConstantData[k++] = dirPos.z;\n\t\t\t\t\tthis.fragmentConstantData[k++] = 1;\n\t\t\t\t}\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iDiffuseB;\n\n\t\t\t\tvar radius:number = pointLight._pRadius;\n\t\t\t\tthis.fragmentConstantData[k++] = radius*radius;\n\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularR;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularG;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._iSpecularB;\n\t\t\t\tthis.fragmentConstantData[k++] = pointLight._pFallOffFactor;\n\n\t\t\t\tif (++total == this.numPointLights) {\n\t\t\t\t\t// break loop\n\t\t\t\t\ti = len;\n\t\t\t\t\tcast = numLightTypes;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// more directional supported than currently picked, need to clamp all to 0\n\t\tif (this.numPointLights > total) {\n\t\t\ti = k + (total - this.numPointLights)*12;\n\n\t\t\tfor (; k < i; ++k)\n\t\t\t\tthis.fragmentConstantData[k] = 0;\n\t\t}\n\t}\n\n\t/**\n\t * Updates constant data render state used by the light probes. This method is optional for subclasses to implement.\n\t */\n\tprivate updateProbes(stage:Stage)\n\t{\n\t\tvar probe:LightProbe;\n\t\tvar lightProbes:Array<LightProbe> = this.lightPicker.lightProbes;\n\t\tvar weights:Array<number> = this.lightPicker.lightProbeWeights;\n\t\tvar len:number = lightProbes.length - this.lightProbesOffset;\n\t\tvar addDiff:boolean = this.usesProbesForDiffuse;\n\t\tvar addSpec:boolean = this.usesProbesForSpecular;\n\n\t\tif (!(addDiff || addSpec))\n\t\t\treturn;\n\n\t\tif (len > this.numLightProbes)\n\t\t\tlen = this.numLightProbes;\n\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tprobe = lightProbes[ this.lightProbesOffset + i];\n\n\t\t\tif (addDiff)\n\t\t\t\t(<IContextStageGL> stage.context).activateCubeTexture(this.lightProbeDiffuseIndices[i], probe.diffuseMap);\n\n\t\t\tif (addSpec)\n\t\t\t\t(<IContextStageGL> stage.context).activateCubeTexture(this.lightProbeSpecularIndices[i], probe.specularMap);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis.fragmentConstantData[this.probeWeightsIndex + i] = weights[this.lightProbesOffset + i];\n\t}\n}\n\nexport = ShaderLightingObject;",
    "import Matrix\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport ContextGLTriangleFace\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport AnimationRegisterCache\t\t= require(\"awayjs-renderergl/lib/animators/data/AnimationRegisterCache\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderCompilerBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport IMaterialPassStageGL\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/IMaterialPassStageGL\");\n\n/**\n * ShaderObjectBase keeps track of the number of dependencies for \"named registers\" used across a pass.\n * Named registers are that are not necessarily limited to a single method. They are created by the compiler and\n * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed\n * each time a method has been compiled into the shader.\n *\n * @see RegisterPool.addUsage\n */\nclass ShaderObjectBase\n{\n\n\tprivate _defaultCulling:string = ContextGLTriangleFace.BACK;\n\n\tpublic _pInverseSceneMatrix:Array<number> = new Array<number>();\n\n\tpublic animationRegisterCache:AnimationRegisterCache;\n\n\tpublic profile:string;\n\n\t/**\n\t * The amount of used vertex constants in the vertex code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedVertexConstants:number;\n\n\t/**\n\t * The amount of used fragment constants in the fragment code. Used by the animation code generation to know from which index on registers are available.\n\t */\n\tpublic numUsedFragmentConstants:number;\n\n\t/**\n\t * The amount of used vertex streams in the vertex code. Used by the animation code generation to know from which index on streams are available.\n\t */\n\tpublic numUsedStreams:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedTextures:number;\n\n\t/**\n\t *\n\t */\n\tpublic numUsedVaryings:number;\n\n\tpublic animatableAttributes:Array<string>;\n\tpublic animationTargetRegisters:Array<string>;\n\tpublic uvSource:string;\n\tpublic uvTarget:string;\n\n\tpublic useAlphaPremultiplied:boolean;\n\tpublic useBothSides:boolean;\n\tpublic useMipmapping:boolean;\n\tpublic useSmoothTextures:boolean;\n\tpublic repeatTextures:boolean;\n\tpublic usesUVTransform:boolean;\n\tpublic alphaThreshold:number;\n\tpublic texture:Texture2DBase;\n\tpublic color:number;\n\n\n\t//set ambient values to default\n\tpublic ambientR:number = 0xFF;\n\tpublic ambientG:number = 0xFF;\n\tpublic ambientB:number = 0xFF;\n\n\t/**\n\t * Indicates whether the pass requires any fragment animation code.\n\t */\n\tpublic usesFragmentAnimation:boolean;\n\n\t/**\n\t * The amount of dependencies on the projected position.\n\t */\n\tpublic projectionDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the normal vector.\n\t */\n\tpublic normalDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the view direction.\n\t */\n\tpublic viewDirDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the primary UV coordinates.\n\t */\n\tpublic uvDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the secondary UV coordinates.\n\t */\n\tpublic secondaryUVDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the local position. This can be 0 while hasGlobalPosDependencies is true when\n\t * the global position is used as a temporary value (fe to calculate the view direction)\n\t */\n\tpublic localPosDependencies:number;\n\n\t/**\n\t * The amount of dependencies on the global position. This can be 0 while hasGlobalPosDependencies is true when\n\t * the global position is used as a temporary value (fe to calculate the view direction)\n\t */\n\tpublic globalPosDependencies:number;\n\n\t/**\n\t * The amount of tangent vector dependencies (fragment shader).\n\t */\n\tpublic tangentDependencies:number;\n\n\t/**\n\t *\n\t */\n\tpublic outputsNormals:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are expected in tangent space. This is only the case if no world-space\n\t * dependencies exist.\n\t */\n\tpublic usesTangentSpace:boolean;\n\n\t/**\n\t * Indicates whether or not normal calculations are output in tangent space.\n\t */\n\tpublic outputsTangentNormals:boolean;\n\n\t/**\n\t * Indicates whether there are any dependencies on the world-space position vector.\n\t */\n\tpublic usesGlobalPosFragment:boolean = false;\n\n\tpublic vertexConstantData:Array<number> = new Array<number>();\n\tpublic fragmentConstantData:Array<number> = new Array<number>();\n\n\t/**\n\t * The index for the common data register.\n\t */\n\tpublic commonsDataIndex:number;\n\n\t/**\n\t * The index for the UV vertex attribute stream.\n\t */\n\tpublic uvBufferIndex:number;\n\n\t/**\n\t * The index for the secondary UV vertex attribute stream.\n\t */\n\tpublic secondaryUVBufferIndex:number;\n\n\t/**\n\t * The index for the vertex normal attribute stream.\n\t */\n\tpublic normalBufferIndex:number;\n\n\t/**\n\t * The index for the vertex tangent attribute stream.\n\t */\n\tpublic tangentBufferIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the view matrix.\n\t */\n\tpublic viewMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the scene matrix.\n\t */\n\tpublic sceneMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the uniform scene matrix (the inverse transpose).\n\t */\n\tpublic sceneNormalMatrixIndex:number;\n\n\t/**\n\t * The index of the vertex constant containing the camera position.\n\t */\n\tpublic cameraPositionIndex:number;\n\n\t/**\n\t * The index for the UV transformation matrix vertex constant.\n\t */\n\tpublic uvTransformIndex:number;\n\n\t/**\n\t * Creates a new MethodCompilerVO object.\n\t */\n\tconstructor(profile)\n\t{\n\t\tthis.profile = profile;\n\t}\n\n\t/**\n\t * Factory method to create a concrete compiler object for this object\n\t *\n\t * @param materialPassVO\n\t * @returns {away.materials.ShaderCompilerBase}\n\t */\n\tpublic createCompiler(material:StageGLMaterialBase, materialPass:IMaterialPassStageGL):ShaderCompilerBase\n\t{\n\t\treturn new ShaderCompilerBase(material, materialPass, this);\n\t}\n\n\t/**\n\t * Clears dependency counts for all registers. Called when recompiling a pass.\n\t */\n\tpublic reset()\n\t{\n\t\tthis.projectionDependencies = 0;\n\t\tthis.normalDependencies = 0;\n\t\tthis.viewDirDependencies = 0;\n\t\tthis.uvDependencies = 0;\n\t\tthis.secondaryUVDependencies = 0;\n\t\tthis.globalPosDependencies = 0;\n\t\tthis.tangentDependencies = 0;\n\t\tthis.usesGlobalPosFragment = false;\n\t\tthis.usesFragmentAnimation = false;\n\t\tthis.usesTangentSpace = false;\n\t\tthis.outputsNormals = false;\n\t\tthis.outputsTangentNormals = false;\n\t}\n\n\t/**\n\t * Adds any external world space dependencies, used to force world space calculations.\n\t */\n\tpublic addWorldSpaceDependencies(fragmentLights:boolean)\n\t{\n\t\tif (this.viewDirDependencies > 0)\n\t\t\t++this.globalPosDependencies;\n\t}\n\n\tpublic pInitRegisterIndices()\n\t{\n\t\tthis.commonsDataIndex = -1;\n\t\tthis.cameraPositionIndex = -1;\n\t\tthis.uvBufferIndex = -1;\n\t\tthis.uvTransformIndex = -1;\n\t\tthis.secondaryUVBufferIndex = -1;\n\t\tthis.normalBufferIndex = -1;\n\t\tthis.tangentBufferIndex = -1;\n\t\tthis.sceneMatrixIndex = -1;\n\t\tthis.sceneNormalMatrixIndex = -1;\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this shader object.\n\t */\n\tpublic initConstantData(registerCache:ShaderRegisterCache, animatableAttributes:Array<string>, animationTargetRegisters:Array<string>, uvSource:string, uvTarget:string)\n\t{\n\t\t//Updates the amount of used register indices.\n\t\tthis.numUsedVertexConstants = registerCache.numUsedVertexConstants;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\t\tthis.numUsedStreams = registerCache.numUsedStreams;\n\t\tthis.numUsedTextures = registerCache.numUsedTextures;\n\t\tthis.numUsedVaryings = registerCache.numUsedVaryings;\n\t\tthis.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;\n\n\t\tthis.animatableAttributes = animatableAttributes;\n\t\tthis.animationTargetRegisters = animationTargetRegisters;\n\t\tthis.uvSource = uvSource;\n\t\tthis.uvTarget = uvTarget;\n\n\t\tthis.vertexConstantData.length = this.numUsedVertexConstants*4;\n\t\tthis.fragmentConstantData.length = this.numUsedFragmentConstants*4;\n\n\t\t//Initializes commonly required constant values.\n\t\tthis.fragmentConstantData[this.commonsDataIndex] = .5;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 1] = 0;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 2] = 1/255;\n\t\tthis.fragmentConstantData[this.commonsDataIndex + 3] = 1;\n\n\t\t//Initializes the default UV transformation matrix.\n\t\tif (this.uvTransformIndex >= 0) {\n\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 2] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 6] = 0;\n\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t}\n\n\t\tif (this.cameraPositionIndex >= 0)\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 3] = 1;\n\t}\n\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(stage:Stage, camera:Camera)\n\t{\n\t\tstage.context.setCulling(this.useBothSides? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);\n\n\t\tif (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = pos.x;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iDeactivate(stage:Stage)\n\t{\n\n\t}\n\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic setRenderState(renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tvar context:IContextStageGL = stage.context;\n\n\t\tif (renderable.materialOwner.animator)\n\t\t\t(<AnimatorBase> renderable.materialOwner.animator).setRenderState(this, renderable, stage, camera, this.numUsedVertexConstants, this.numUsedStreams);\n\n\t\tif (this.uvBufferIndex >= 0)\n\t\t\tcontext.activateBuffer(this.uvBufferIndex, renderable.getVertexData(TriangleSubGeometry.UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.UV_DATA), TriangleSubGeometry.UV_FORMAT);\n\n\t\tif (this.secondaryUVBufferIndex >= 0)\n\t\t\tcontext.activateBuffer(this.secondaryUVBufferIndex, renderable.getVertexData(TriangleSubGeometry.SECONDARY_UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.SECONDARY_UV_DATA), TriangleSubGeometry.SECONDARY_UV_FORMAT);\n\n\t\tif (this.normalBufferIndex >= 0)\n\t\t\tcontext.activateBuffer(this.normalBufferIndex, renderable.getVertexData(TriangleSubGeometry.NORMAL_DATA), renderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);\n\n\t\tif (this.tangentBufferIndex >= 0)\n\t\t\tcontext.activateBuffer(this.tangentBufferIndex, renderable.getVertexData(TriangleSubGeometry.TANGENT_DATA), renderable.getVertexOffset(TriangleSubGeometry.TANGENT_DATA), TriangleSubGeometry.TANGENT_FORMAT);\n\n\n\t\tif (this.usesUVTransform) {\n\t\t\tvar uvTransform:Matrix = renderable.materialOwner.uvTransform.matrix;\n\n\t\t\tif (uvTransform) {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = uvTransform.a;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;\n\t\t\t} else {\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 1] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 3] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 4] = 0;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 5] = 1;\n\t\t\t\tthis.vertexConstantData[this.uvTransformIndex + 7] = 0;\n\t\t\t}\n\t\t}\n\n\t\tif (this.sceneNormalMatrixIndex >= 0)\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);\n\n\t\tif (this.usesTangentSpace && this.cameraPositionIndex >= 0) {\n\n\t\t\trenderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);\n\t\t\tvar pos:Vector3D = camera.scenePosition;\n\t\t\tvar x:number = pos.x;\n\t\t\tvar y:number = pos.y;\n\t\t\tvar z:number = pos.z;\n\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0]*x + this._pInverseSceneMatrix[4]*y + this._pInverseSceneMatrix[8]*z + this._pInverseSceneMatrix[12];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1]*x + this._pInverseSceneMatrix[5]*y + this._pInverseSceneMatrix[9]*z + this._pInverseSceneMatrix[13];\n\t\t\tthis.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2]*x + this._pInverseSceneMatrix[6]*y + this._pInverseSceneMatrix[10]*z + this._pInverseSceneMatrix[14];\n\t\t}\n\t}\n\n\tpublic dispose()\n\t{\n\t\t//TODO uncount associated program data\n\t}\n}\n\nexport = ShaderObjectBase;",
    "import RegisterPool\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/RegisterPool\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\n\n/**\n * ShaderRegister Cache provides the usage management system for all registers during shading compilation.\n */\nclass ShaderRegisterCache\n{\n\tprivate _fragmentTempCache:RegisterPool;\n\tprivate _vertexTempCache:RegisterPool;\n\tprivate _varyingCache:RegisterPool;\n\tprivate _fragmentConstantsCache:RegisterPool;\n\tprivate _vertexConstantsCache:RegisterPool;\n\tprivate _textureCache:RegisterPool;\n\tprivate _vertexAttributesCache:RegisterPool;\n\tprivate _vertexConstantOffset:number; //TODO: check if this should be initialised to 0\n\tprivate _vertexAttributesOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _varyingsOffset:number;//TODO: check if this should be initialised to 0\n\tprivate _fragmentConstantOffset:number;//TODO: check if this should be initialised to 0\n\n\tprivate _fragmentOutputRegister:ShaderRegisterElement;\n\tprivate _vertexOutputRegister:ShaderRegisterElement;\n\tprivate _numUsedVertexConstants:number = 0;\n\tprivate _numUsedFragmentConstants:number = 0;\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\tprivate _numUsedVaryings:number = 0;\n\tprivate _profile:string;\n\n\t/**\n\t * Create a new ShaderRegisterCache object.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tconstructor(profile:string)\n\t{\n\t\tthis._profile = profile;\n\t}\n\n\t/**\n\t * Resets all registers.\n\t */\n\tpublic reset()\n\t{\n\t\tthis._fragmentTempCache = new RegisterPool(\"ft\", 8, false);\n\t\tthis._vertexTempCache = new RegisterPool(\"vt\", 8, false);\n\t\tthis._varyingCache = new RegisterPool(\"v\", 8);\n\t\tthis._textureCache = new RegisterPool(\"fs\", 8);\n\t\tthis._vertexAttributesCache = new RegisterPool(\"va\", 8);\n\t\tthis._fragmentConstantsCache = new RegisterPool(\"fc\", 28);\n\t\tthis._vertexConstantsCache = new RegisterPool(\"vc\", 128);\n\t\tthis._fragmentOutputRegister = new ShaderRegisterElement(\"oc\", -1);\n\t\tthis._vertexOutputRegister = new ShaderRegisterElement(\"op\", -1);\n\t\tthis._numUsedVertexConstants = 0;\n\t\tthis._numUsedStreams = 0;\n\t\tthis._numUsedTextures = 0;\n\t\tthis._numUsedVaryings = 0;\n\t\tthis._numUsedFragmentConstants = 0;\n\n\t\tvar i:number;\n\n\t\tfor (i = 0; i < this._vertexAttributesOffset; ++i)\n\t\t\tthis.getFreeVertexAttribute();\n\n\t\tfor (i = 0; i < this._vertexConstantOffset; ++i)\n\t\t\tthis.getFreeVertexConstant();\n\n\t\tfor (i = 0; i < this._varyingsOffset; ++i)\n\t\t\tthis.getFreeVarying();\n\n\t\tfor (i = 0; i < this._fragmentConstantOffset; ++i)\n\t\t\tthis.getFreeFragmentConstant();\n\t}\n\n\t/**\n\t * Disposes all resources used.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._fragmentTempCache.dispose();\n\t\tthis._vertexTempCache.dispose();\n\t\tthis._varyingCache.dispose();\n\t\tthis._fragmentConstantsCache.dispose();\n\t\tthis._vertexAttributesCache.dispose();\n\n\t\tthis._fragmentTempCache = null;\n\t\tthis._vertexTempCache = null;\n\t\tthis._varyingCache = null;\n\t\tthis._fragmentConstantsCache = null;\n\t\tthis._vertexAttributesCache = null;\n\t\tthis._fragmentOutputRegister = null;\n\t\tthis._vertexOutputRegister = null;\n\t}\n\n\t/**\n\t * Marks a fragment temporary register as used, so it cannot be retrieved. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addFragmentTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._fragmentTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a fragment temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeFragmentTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._fragmentTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Marks a vertex temporary register as used, so it cannot be retrieved. The register won't be able to be used\n\t * until removeUsage has been called usageCount times again.\n\t * @param register The register to mark as used.\n\t * @param usageCount The amount of usages to add.\n\t */\n\tpublic addVertexTempUsages(register:ShaderRegisterElement, usageCount:number)\n\t{\n\t\tthis._vertexTempCache.addUsage(register, usageCount);\n\t}\n\n\t/**\n\t * Removes a usage from a vertex temporary register. When usages reach 0, the register is freed again.\n\t * @param register The register for which to remove a usage.\n\t */\n\tpublic removeVertexTempUsage(register:ShaderRegisterElement)\n\t{\n\t\tthis._vertexTempCache.removeUsage(register);\n\t}\n\n\t/**\n\t * Retrieve an entire fragment temporary register that's still available. The register won't be able to be used until removeUsage\n\t * has been called usageCount times again.\n\t */\n\tpublic getFreeFragmentVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a fragment temporary register that's still available.\n\t */\n\tpublic getFreeFragmentSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available varying register\n\t */\n\tpublic getFreeVarying():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVaryings;\n\t\treturn this._varyingCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available fragment constant register\n\t */\n\tpublic getFreeFragmentConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedFragmentConstants;\n\t\treturn this._fragmentConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available vertex constant register\n\t */\n\tpublic getFreeVertexConstant():ShaderRegisterElement\n\t{\n\t\t++this._numUsedVertexConstants;\n\t\treturn this._vertexConstantsCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an entire vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexVectorTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve a single component from a vertex temporary register that's still available.\n\t */\n\tpublic getFreeVertexSingleTemp():ShaderRegisterElement\n\t{\n\t\treturn this._vertexTempCache.requestFreeRegComponent();\n\t}\n\n\t/**\n\t * Retrieve an available vertex attribute register\n\t */\n\tpublic getFreeVertexAttribute():ShaderRegisterElement\n\t{\n\t\t++this._numUsedStreams;\n\t\treturn this._vertexAttributesCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Retrieve an available texture register\n\t */\n\tpublic getFreeTextureReg():ShaderRegisterElement\n\t{\n\t\t++this._numUsedTextures;\n\t\treturn this._textureCache.requestFreeVectorReg();\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex constants.\n\t */\n\tpublic get vertexConstantOffset():number\n\t{\n\t\treturn this._vertexConstantOffset;\n\t}\n\n\tpublic set vertexConstantOffset(vertexConstantOffset:number)\n\t{\n\t\tthis._vertexConstantOffset = vertexConstantOffset;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve vertex attributes.\n\t */\n\tpublic get vertexAttributesOffset():number\n\t{\n\t\treturn this._vertexAttributesOffset;\n\t}\n\n\tpublic set vertexAttributesOffset(value:number)\n\t{\n\t\tthis._vertexAttributesOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve varying registers.\n\t */\n\tpublic get varyingsOffset():number\n\t{\n\t\treturn this._varyingsOffset;\n\t}\n\n\tpublic set varyingsOffset(value:number)\n\t{\n\t\tthis._varyingsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the start index from which to retrieve fragment constants.\n\t */\n\tpublic get fragmentConstantOffset():number\n\t{\n\t\treturn this._fragmentConstantOffset;\n\t}\n\n\tpublic set fragmentConstantOffset(value:number)\n\t{\n\t\tthis._fragmentConstantOffset = value;\n\t}\n\n\t/**\n\t * The fragment output register.\n\t */\n\tpublic get fragmentOutputRegister():ShaderRegisterElement\n\t{\n\t\treturn this._fragmentOutputRegister;\n\t}\n\n\t/**\n\t * The amount of used vertex constant registers.\n\t */\n\tpublic get numUsedVertexConstants():number\n\t{\n\t\treturn this._numUsedVertexConstants;\n\t}\n\n\t/**\n\t * The amount of used fragment constant registers.\n\t */\n\tpublic get numUsedFragmentConstants():number\n\t{\n\t\treturn this._numUsedFragmentConstants;\n\t}\n\n\t/**\n\t * The amount of used vertex streams.\n\t */\n\tpublic get numUsedStreams():number\n\t{\n\t\treturn this._numUsedStreams;\n\t}\n\n\t/**\n\t * The amount of used texture slots.\n\t */\n\tpublic get numUsedTextures():number\n\t{\n\t\treturn this._numUsedTextures;\n\t}\n\n\t/**\n\t * The amount of used varying registers.\n\t */\n\tpublic get numUsedVaryings():number\n\t{\n\t\treturn this._numUsedVaryings;\n\t}\n}\n\nexport = ShaderRegisterCache;",
    "import ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\n\n/**\n * ShaderRegisterData contains the \"named\" registers, generated by the compiler and to be passed on to the methods.\n */\nclass ShaderRegisterData\n{\n\tpublic normalVarying:ShaderRegisterElement;\n\tpublic tangentVarying:ShaderRegisterElement;\n\tpublic bitangentVarying:ShaderRegisterElement;\n\tpublic uvVarying:ShaderRegisterElement;\n\tpublic secondaryUVVarying:ShaderRegisterElement;\n\tpublic viewDirVarying:ShaderRegisterElement;\n\tpublic shadowTarget:ShaderRegisterElement;\n\tpublic shadedTarget:ShaderRegisterElement;\n\tpublic globalPositionVertex:ShaderRegisterElement;\n\tpublic globalPositionVarying:ShaderRegisterElement;\n\tpublic localPosition:ShaderRegisterElement;\n\tpublic normalInput:ShaderRegisterElement;\n\tpublic tangentInput:ShaderRegisterElement;\n\tpublic animatedNormal:ShaderRegisterElement;\n\tpublic animatedTangent:ShaderRegisterElement;\n\tpublic commons:ShaderRegisterElement;\n\tpublic projectionFragment:ShaderRegisterElement;\n\tpublic normalFragment:ShaderRegisterElement;\n\tpublic viewDirFragment:ShaderRegisterElement;\n\tpublic bitangent:ShaderRegisterElement;\n\n\tconstructor()\n\t{\n\n\t}\n}\n\nexport = ShaderRegisterData;",
    "/**\n * A single register element (an entire register or a single register's component) used by the RegisterPool.\n */\nclass ShaderRegisterElement\n{\n\tprivate _regName:string;\n\tprivate _index:number;\n\tprivate _toStr:string;\n\n\tprivate static COMPONENTS = [\"x\", \"y\", \"z\", \"w\"];\n\n\tpublic _component:number;\n\n\t/**\n\t * Creates a new ShaderRegisterElement object.\n\t *\n\t * @param regName The name of the register.\n\t * @param index The index of the register.\n\t * @param component The register's component, if not the entire register is represented.\n\t */\n\tconstructor(regName:string, index:number, component:number = -1)\n\t{\n\t\tthis._component = component;\n\t\tthis._regName = regName;\n\t\tthis._index = index;\n\n\t\tthis._toStr = this._regName;\n\n\t\tif (this._index >= 0)\n\t\t\tthis._toStr += this._index;\n\n\t\tif (component > -1)\n\t\t\tthis._toStr += \".\" + ShaderRegisterElement.COMPONENTS[component];\n\t}\n\n\t/**\n\t * Converts the register or the components AGAL string representation.\n\t */\n\tpublic toString():string\n\t{\n\t\treturn this._toStr;\n\t}\n\n\t/**\n\t * The register's name.\n\t */\n\tpublic get regName():string\n\t{\n\t\treturn this._regName;\n\t}\n\n\t/**\n\t * The register's index.\n\t */\n\tpublic get index():number\n\t{\n\t\treturn this._index;\n\t}\n}\n\nexport = ShaderRegisterElement;",
    "import Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\n\n/**\n * AmbientBasicMethod provides the default shading method for uniform ambient lighting.\n */\nclass AmbientBasicMethod extends ShadingMethodBase\n{\n\tprivate _color:number = 0xffffff;\n\tprivate _alpha:number = 1;\n\n\tprivate _colorR:number = 1;\n\tprivate _colorG:number = 1;\n\tprivate _colorB:number = 1;\n\n\tprivate _ambient:number = 1;\n\n\t/**\n\t * Creates a new AmbientBasicMethod object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iInitVO(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\t\tmethodVO.needsUV = Boolean(shaderObject.texture != null);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iInitConstants(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\t\tif (!methodVO.needsUV) {\n\t\t\tthis._color = shaderObject.color;\n\t\t\tthis.updateColor();\n\t\t}\n\t}\n\n\t/**\n\t * The strength of the ambient reflection of the surface.\n\t */\n\tpublic get ambient():number\n\t{\n\t\treturn this._ambient;\n\t}\n\n\tpublic set ambient(value:number)\n\t{\n\t\tif (this._ambient == value)\n\t\t\treturn;\n\n\t\tthis._ambient = value;\n\n\t\tthis.updateColor();\n\t}\n\n\t/**\n\t * The alpha component of the surface.\n\t */\n\tpublic get alpha():number\n\t{\n\t\treturn this._alpha;\n\t}\n\n\tpublic set alpha(value:number)\n\t{\n\t\tif (this._alpha == value)\n\t\t\treturn;\n\n\t\tthis._alpha = value;\n\n\t\tthis.updateColor();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic copyFrom(method:ShadingMethodBase)\n\t{\n\t\tvar m:any = method;\n\t\tvar b:AmbientBasicMethod = <AmbientBasicMethod> m;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar ambientInputRegister:ShaderRegisterElement;\n\n\t\tif (methodVO.needsUV) {\n\t\t\tambientInputRegister = registerCache.getFreeTextureReg();\n\n\t\t\tmethodVO.texturesIndex = ambientInputRegister.index;\n\n\t\t\tcode += ShaderCompilerHelper.getTex2DSampleCode(targetReg, sharedRegisters, ambientInputRegister, shaderObject.texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\t\t\tmethodVO.fragmentConstantsIndex = cutOffReg.index*4;\n\n\t\t\t\tcode += \"sub \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\t\"kil \" + targetReg + \".w\\n\" +\n\t\t\t\t\t\"add \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\";\n\t\t\t}\n\n\t\t} else {\n\t\t\tambientInputRegister = registerCache.getFreeFragmentConstant();\n\t\t\tmethodVO.fragmentConstantsIndex = ambientInputRegister.index*4;\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + ambientInputRegister + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(shaderObject:ShaderObjectBase, methodVO:MethodVO, stage:Stage)\n\t{\n\t\tif (methodVO.needsUV) {\n\t\t\tstage.context.setSamplerStateAt(methodVO.texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR:ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR:ContextGLMipFilter.MIPNONE);\n\t\t\tstage.context.activateTexture(methodVO.texturesIndex, shaderObject.texture);\n\n\t\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\t\tshaderObject.fragmentConstantData[methodVO.fragmentConstantsIndex] = shaderObject.alphaThreshold;\n\t\t} else {\n\t\t\tvar index:number = methodVO.fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\t\tdata[index] = this._colorR;\n\t\t\tdata[index + 1] = this._colorG;\n\t\t\tdata[index + 2] = this._colorB;\n\t\t\tdata[index + 3] = this._alpha;\n\t\t}\n\t}\n\n\t/**\n\t * Updates the ambient color data used by the render state.\n\t */\n\tprivate updateColor()\n\t{\n\t\tthis._colorR = ((this._color >> 16) & 0xff)/0xff*this._ambient;\n\t\tthis._colorG = ((this._color >> 8) & 0xff)/0xff*this._ambient;\n\t\tthis._colorB = (this._color & 0xff)/0xff*this._ambient;\n\t}\n}\n\nexport = AmbientBasicMethod;",
    "import Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\n\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderLightingObject\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingObject\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\nimport LightingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/LightingMethodBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * DiffuseBasicMethod provides the default shading method for Lambert (dot3) diffuse lighting.\n */\nclass DiffuseBasicMethod extends LightingMethodBase\n{\n\tprivate _multiply:boolean = true;\n\n\tpublic _pUseTexture:boolean;\n\tpublic _pTotalLightColorReg:ShaderRegisterElement;\n\tpublic _pDiffuseInputRegister:ShaderRegisterElement;\n\n\tprivate _texture:Texture2DBase;\n\tprivate _diffuseColor:number = 0xffffff;\n\tprivate _ambientColor:number = 0xffffff;\n\tprivate _diffuseR:number = 1;\n\tprivate _diffuseG:number = 1;\n\tprivate _diffuseB:number = 1;\n\tprivate _ambientR:number = 1;\n\tprivate _ambientG:number = 1;\n\tprivate _ambientB:number = 1;\n\n\tpublic _pIsFirstLight:boolean;\n\n\t/**\n\t * Creates a new DiffuseBasicMethod object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic iIsUsed(shaderObject:ShaderLightingObject):boolean\n\t{\n\t\tif (!shaderObject.numLights)\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Set internally if diffuse color component multiplies or replaces the ambient color\n\t */\n\tpublic get multiply():boolean\n\t{\n\t\treturn this._multiply;\n\t}\n\n\tpublic set multiply(value:boolean)\n\t{\n\t\tif (this._multiply == value)\n\t\t\treturn;\n\n\t\tthis._multiply = value;\n\n\t\tthis.iInvalidateShaderProgram();\n\t}\n\n\tpublic iInitVO(shaderObject:ShaderLightingObject, methodVO:MethodVO)\n\t{\n\t\tmethodVO.needsUV = this._pUseTexture;\n\t\tmethodVO.needsNormals = shaderObject.numLights > 0;\n\t}\n\n\t/**\n\t * Forces the creation of the texture.\n\t * @param stage The Stage used by the renderer\n\t */\n\tpublic generateMip(stage:Stage)\n\t{\n\t\tif (this._pUseTexture)\n\t\t\tstage.context.activateTexture(0, this._texture);\n\t}\n\n\t/**\n\t * The color of the diffuse reflection when not using a texture.\n\t */\n\tpublic get diffuseColor():number\n\t{\n\t\treturn this._diffuseColor;\n\t}\n\n\tpublic set diffuseColor(value:number)\n\t{\n\t\tif (this._diffuseColor == value)\n\t\t\treturn;\n\n\t\tthis._diffuseColor = value;\n\n\t\tthis.updateDiffuse();\n\t}\n\n\t/**\n\t * The color of the ambient reflection\n\t */\n\tpublic get ambientColor():number\n\t{\n\t\treturn this._ambientColor;\n\t}\n\n\tpublic set ambientColor(value:number)\n\t{\n\t\tif (this._ambientColor == value)\n\t\t\treturn;\n\n\t\tthis._ambientColor = value;\n\n\t\tthis.updateAmbient();\n\t}\n\n\n\t/**\n\t * The bitmapData to use to define the diffuse reflection color per texel.\n\t */\n\tpublic get texture():Texture2DBase\n\t{\n\t\treturn this._texture;\n\t}\n\n\tpublic set texture(value:Texture2DBase)\n\t{\n\t\tvar b:boolean = (value != null);\n\n\t\tif (b != this._pUseTexture || (value && this._texture && (value.hasMipmaps != this._texture.hasMipmaps || value.format != this._texture.format)))\n\t\t\tthis.iInvalidateShaderProgram();\n\n\t\tthis._pUseTexture = b;\n\t\tthis._texture = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._texture = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic copyFrom(method:ShadingMethodBase)\n\t{\n\t\tvar diff:DiffuseBasicMethod = <DiffuseBasicMethod> method;\n\n\t\tthis.texture = diff.texture;\n\t\tthis.multiply = diff.multiply;\n\t\tthis.diffuseColor = diff.diffuseColor;\n\t\tthis.ambientColor = diff.ambientColor;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iCleanCompilationData()\n\t{\n\t\tsuper.iCleanCompilationData();\n\n\t\tthis._pTotalLightColorReg = null;\n\t\tthis._pDiffuseInputRegister = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentPreLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tthis._pIsFirstLight = true;\n\n\t\tthis._pTotalLightColorReg = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(this._pTotalLightColorReg, 1);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCodePerLight(shaderObject:ShaderLightingObject, methodVO:MethodVO, lightDirReg:ShaderRegisterElement, lightColReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar t:ShaderRegisterElement;\n\n\t\t// write in temporary if not first light, so we can add to total diffuse colour\n\t\tif (this._pIsFirstLight) {\n\t\t\tt = this._pTotalLightColorReg;\n\t\t} else {\n\t\t\tt = registerCache.getFreeFragmentVectorTemp();\n\t\t\tregisterCache.addFragmentTempUsages(t, 1);\n\t\t}\n\n\t\tcode += \"dp3 \" + t + \".x, \" + lightDirReg + \", \" + sharedRegisters.normalFragment + \"\\n\" +\n\t\t\t\t\"max \" + t + \".w, \" + t + \".x, \" + sharedRegisters.commons + \".y\\n\";\n\n\t\tif (shaderObject.usesLightFallOff)\n\t\t\tcode += \"mul \" + t + \".w, \" + t + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\tif (this._iModulateMethod != null)\n\t\t\tcode += this._iModulateMethod(shaderObject, methodVO, t, registerCache, sharedRegisters);\n\n\t\tcode += \"mul \" + t + \", \" + t + \".w, \" + lightColReg + \"\\n\";\n\n\t\tif (!this._pIsFirstLight) {\n\t\t\tcode += \"add \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + t + \"\\n\";\n\t\t\tregisterCache.removeFragmentTempUsage(t);\n\t\t}\n\n\t\tthis._pIsFirstLight = false;\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCodePerProbe(shaderObject:ShaderLightingObject, methodVO:MethodVO, cubeMapReg:ShaderRegisterElement, weightRegister:string, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar t:ShaderRegisterElement;\n\n\t\t// write in temporary if not first light, so we can add to total diffuse colour\n\t\tif (this._pIsFirstLight) {\n\t\t\tt = this._pTotalLightColorReg;\n\t\t} else {\n\t\t\tt = registerCache.getFreeFragmentVectorTemp();\n\t\t\tregisterCache.addFragmentTempUsages(t, 1);\n\t\t}\n\n\t\tcode += \"tex \" + t + \", \" + sharedRegisters.normalFragment + \", \" + cubeMapReg + \" <cube,linear,miplinear>\\n\" +\n\t\t\t\t\"mul \" + t + \".xyz, \" + t + \".xyz, \" + weightRegister + \"\\n\";\n\n\t\tif (this._iModulateMethod != null)\n\t\t\tcode += this._iModulateMethod(shaderObject, methodVO, t, registerCache, sharedRegisters);\n\n\t\tif (!this._pIsFirstLight) {\n\t\t\tcode += \"add \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + t + \"\\n\";\n\t\t\tregisterCache.removeFragmentTempUsage(t);\n\t\t}\n\n\t\tthis._pIsFirstLight = false;\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentPostLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tvar albedo:ShaderRegisterElement;\n\t\tvar cutOffReg:ShaderRegisterElement;\n\n\t\t// incorporate input from ambient\n\t\tif (sharedRegisters.shadowTarget)\n\t\t\tcode += this.pApplyShadow(shaderObject, methodVO, registerCache, sharedRegisters);\n\n\t\talbedo = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(albedo, 1);\n\n\t\tvar ambientColorRegister:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tmethodVO.fragmentConstantsIndex = ambientColorRegister.index*4;\n\n\t\tif (this._pUseTexture) {\n\t\t\tthis._pDiffuseInputRegister = registerCache.getFreeTextureReg();\n\n\t\t\tmethodVO.texturesIndex = this._pDiffuseInputRegister.index;\n\n\t\t\tcode += ShaderCompilerHelper.getTex2DSampleCode(albedo, sharedRegisters, this._pDiffuseInputRegister, this._texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t} else {\n\t\t\tthis._pDiffuseInputRegister = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"mov \" + albedo + \", \" + this._pDiffuseInputRegister + \"\\n\";\n\t\t}\n\n\t\tcode += \"sat \" + this._pTotalLightColorReg + \", \" + this._pTotalLightColorReg + \"\\n\" +\n\t\t\t\"mul \" + albedo + \".xyz, \" + albedo + \", \" + this._pTotalLightColorReg + \"\\n\";\n\n\t\tif (this._multiply) {\n\t\t\tcode += \"add \" + albedo + \".xyz, \" + albedo + \", \" + ambientColorRegister + \"\\n\" +\n\t\t\t\t\"mul \" + targetReg + \".xyz, \" + targetReg + \", \" + albedo + \"\\n\";\n\t\t} else {\n\t\t\tcode += \"mul \" + targetReg + \".xyz, \" + targetReg + \", \" + ambientColorRegister + \"\\n\" +\n\t\t\t\t\"mul \" + this._pTotalLightColorReg + \".xyz, \" + targetReg + \", \" + this._pTotalLightColorReg + \"\\n\" +\n\t\t\t\t\"sub \" + targetReg + \".xyz, \" + targetReg + \", \" + this._pTotalLightColorReg + \"\\n\" +\n\t\t\t\t\"add \" + targetReg + \".xyz, \" + targetReg + \", \" + albedo + \"\\n\";\n\t\t}\n\n\t\tregisterCache.removeFragmentTempUsage(this._pTotalLightColorReg);\n\t\tregisterCache.removeFragmentTempUsage(albedo);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * Generate the code that applies the calculated shadow to the diffuse light\n\t * @param methodVO The MethodVO object for which the compilation is currently happening.\n\t * @param regCache The register cache the compiler is currently using for the register management.\n\t */\n\tpublic pApplyShadow(shaderObject:ShaderLightingObject, methodVO:MethodVO, regCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"mul \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + sharedRegisters.shadowTarget + \".w\\n\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(shaderObject:ShaderLightingObject, methodVO:MethodVO, stage:Stage)\n\t{\n\t\tif (this._pUseTexture) {\n\t\t\tstage.context.setSamplerStateAt(methodVO.texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE);\n\t\t\tstage.context.activateTexture(methodVO.texturesIndex, this._texture);\n\t\t} else {\n\t\t\tvar index:number = methodVO.fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\t\tdata[index + 4] = this._diffuseR;\n\t\t\tdata[index + 5] = this._diffuseG;\n\t\t\tdata[index + 6] = this._diffuseB;\n\t\t\tdata[index + 7] = 1;\n\t\t}\n\t}\n\n\t/**\n\t * Updates the diffuse color data used by the render state.\n\t */\n\tprivate updateDiffuse()\n\t{\n\t\tthis._diffuseR = ((this._diffuseColor >> 16) & 0xff)/0xff;\n\t\tthis._diffuseG = ((this._diffuseColor >> 8) & 0xff)/0xff;\n\t\tthis._diffuseB = (this._diffuseColor & 0xff)/0xff;\n\t}\n\n\t/**\n\t * Updates the ambient color data used by the render state.\n\t */\n\tprivate updateAmbient()\n\t{\n\t\tthis._ambientR = ((this._ambientColor >> 16) & 0xff)/0xff;\n\t\tthis._ambientG = ((this._ambientColor >> 8) & 0xff)/0xff;\n\t\tthis._ambientB = (this._ambientColor & 0xff)/0xff;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iSetRenderState(shaderObject:ShaderLightingObject, methodVO:MethodVO, renderable:RenderableBase, stage:Stage, camera:Camera)\n\t{\n\t\t//TODO move this to Activate (ambientR/G/B currently calc'd in render state)\n\t\tif (shaderObject.numLights > 0) {\n\t\t\tvar index:number = methodVO.fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\t\tdata[index] = shaderObject.ambientR*this._ambientR;\n\t\t\tdata[index + 1] = shaderObject.ambientG*this._ambientG;\n\t\t\tdata[index + 2] = shaderObject.ambientB*this._ambientB;\n\t\t\tdata[index + 3] = 1;\n\t\t}\n\t}\n}\n\nexport = DiffuseBasicMethod;",
    "import ColorTransform\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport EffectMethodBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/EffectMethodBase\");\n\n/**\n * EffectColorTransformMethod provides a shading method that changes the colour of a material analogous to a\n * ColorTransform object.\n */\nclass EffectColorTransformMethod extends EffectMethodBase\n{\n\tprivate _colorTransform:ColorTransform;\n\n\t/**\n\t * Creates a new EffectColorTransformMethod.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * The ColorTransform object to transform the colour of the material with.\n\t */\n\tpublic get colorTransform():ColorTransform\n\t{\n\t\treturn this._colorTransform;\n\t}\n\n\tpublic set colorTransform(value:ColorTransform)\n\t{\n\t\tthis._colorTransform = value;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar colorMultReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar colorOffsReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tmethodVO.fragmentConstantsIndex = colorMultReg.index*4;\n\n\t\t//TODO: AGAL <> GLSL\n\n\t\tcode += \"mul \" + targetReg + \", \" + targetReg + \", \" + colorMultReg + \"\\n\" + \"add \" + targetReg + \", \" + targetReg + \", \" + colorOffsReg + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(shaderObject:ShaderObjectBase, methodVO:MethodVO, stage:Stage)\n\t{\n\t\tvar inv:number = 1/0xff;\n\t\tvar index:number = methodVO.fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\n\t\tdata[index] = this._colorTransform.redMultiplier;\n\t\tdata[index + 1] = this._colorTransform.greenMultiplier;\n\t\tdata[index + 2] = this._colorTransform.blueMultiplier;\n\t\tdata[index + 3] = this._colorTransform.alphaMultiplier;\n\t\tdata[index + 4] = this._colorTransform.redOffset*inv;\n\t\tdata[index + 5] = this._colorTransform.greenOffset*inv;\n\t\tdata[index + 6] = this._colorTransform.blueOffset*inv;\n\t\tdata[index + 7] = this._colorTransform.alphaOffset*inv;\n\n\t}\n}\n\nexport = EffectColorTransformMethod;",
    "import AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\n\n/**\n * EffectMethodBase forms an abstract base class for shader methods that are not dependent on light sources,\n * and are in essence post-process effects on the materials.\n */\nclass EffectMethodBase extends ShadingMethodBase implements IAsset\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.EFFECTS_METHOD;\n\t}\n\n\t/**\n\t * Get the fragment shader code that should be added after all per-light code. Usually composits everything to the target register.\n\t * @param methodVO The MethodVO object containing the method data for the currently compiled material pass.\n\t * @param regCache The register cache used during the compilation.\n\t * @param targetReg The register that will be containing the method's output.\n\t * @private\n\t */\n\tpublic iGetFragmentCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tthrow new AbstractMethodError();\n\t\treturn \"\";\n\t}\n}\n\nexport = EffectMethodBase;",
    "import MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderLightingObject\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingObject\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\n\n/**\n * LightingMethodBase provides an abstract base method for shading methods that uses lights.\n * Used for diffuse and specular shaders only.\n */\nclass LightingMethodBase extends ShadingMethodBase\n{\n\t/**\n\t * A method that is exposed to wrappers in case the strength needs to be controlled\n\t */\n\tpublic _iModulateMethod:(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData) => string;\n\n\t/**\n\t * Creates a new LightingMethodBase.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Get the fragment shader code that will be needed before any per-light code is added.\n\t * @param methodVO The MethodVO object containing the method data for the currently compiled material pass.\n\t * @param regCache The register cache used during the compilation.\n\t * @private\n\t */\n\tpublic iGetFragmentPreLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Get the fragment shader code that will generate the code relevant to a single light.\n\t *\n\t * @param methodVO The MethodVO object containing the method data for the currently compiled material pass.\n\t * @param lightDirReg The register containing the light direction vector.\n\t * @param lightColReg The register containing the light colour.\n\t * @param regCache The register cache used during the compilation.\n\t */\n\tpublic iGetFragmentCodePerLight(shaderObject:ShaderLightingObject, methodVO:MethodVO, lightDirReg:ShaderRegisterElement, lightColReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Get the fragment shader code that will generate the code relevant to a single light probe object.\n\t *\n\t * @param methodVO The MethodVO object containing the method data for the currently compiled material pass.\n\t * @param cubeMapReg The register containing the cube map for the current probe\n\t * @param weightRegister A string representation of the register + component containing the current weight\n\t * @param regCache The register cache providing any necessary registers to the shader\n\t */\n\tpublic iGetFragmentCodePerProbe(shaderObject:ShaderLightingObject, methodVO:MethodVO, cubeMapReg:ShaderRegisterElement, weightRegister:string, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * Get the fragment shader code that should be added after all per-light code. Usually composits everything to the target register.\n\t *\n\t * @param methodVO The MethodVO object containing the method data for the currently compiled material pass.\n\t * @param regCache The register cache used during the compilation.\n\t * @param targetReg The register containing the final shading output.\n\t * @private\n\t */\n\tpublic iGetFragmentPostLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n}\n\nexport = LightingMethodBase;",
    "import Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\n\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\n\n/**\n * NormalBasicMethod is the default method for standard tangent-space normal mapping.\n */\nclass NormalBasicMethod extends ShadingMethodBase\n{\n\tprivate _texture:Texture2DBase;\n\tprivate _useTexture:boolean;\n\tpublic _pNormalTextureRegister:ShaderRegisterElement;\n\n\t/**\n\t * Creates a new NormalBasicMethod object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic iIsUsed(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\tif (!this._useTexture || !shaderObject.normalDependencies)\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iInitVO(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\t\tmethodVO.needsUV = this._useTexture;\n\t}\n\n\t/**\n\t * Indicates whether or not this method outputs normals in tangent space. Override for object-space normals.\n\t */\n\tpublic iOutputsTangentNormals():boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic copyFrom(method:ShadingMethodBase)\n\t{\n\t\tvar s:any = method;\n\t\tvar bnm:NormalBasicMethod = <NormalBasicMethod> method;\n\n\t\tif (bnm.normalMap != null)\n\t\t\tthis.normalMap = bnm.normalMap;\n\t}\n\n\t/**\n\t * The texture containing the normals per pixel.\n\t */\n\tpublic get normalMap():Texture2DBase\n\t{\n\t\treturn this._texture;\n\t}\n\n\tpublic set normalMap(value:Texture2DBase)\n\t{\n\t\tvar b:boolean = (value != null);\n\n\t\tif (b != this._useTexture || (value && this._texture && (value.hasMipmaps != this._texture.hasMipmaps || value.format != this._texture.format)))\n\t\t\tthis.iInvalidateShaderProgram();\n\n\t\tthis._useTexture = b;\n\t\tthis._texture = value;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iCleanCompilationData()\n\t{\n\t\tsuper.iCleanCompilationData();\n\t\tthis._pNormalTextureRegister = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tif (this._texture)\n\t\t\tthis._texture = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(shaderObject:ShaderObjectBase, methodVO:MethodVO, stage:Stage)\n\t{\n\t\tif (methodVO.texturesIndex >= 0) {\n\t\t\tstage.context.setSamplerStateAt(methodVO.texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE);\n\t\t\tstage.context.activateTexture(methodVO.texturesIndex, this._texture);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tthis._pNormalTextureRegister = registerCache.getFreeTextureReg();\n\n\t\tmethodVO.texturesIndex = this._pNormalTextureRegister.index;\n\n\t\treturn ShaderCompilerHelper.getTex2DSampleCode(targetReg, sharedRegisters, this._pNormalTextureRegister, this._texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping) +\n\t\t\t\"sub \" + targetReg + \".xyz, \" + targetReg + \".xyz, \" + sharedRegisters.commons + \".xxx\\n\" +\n\t\t\t\"nrm \" + targetReg + \".xyz, \" + targetReg + \"\\n\";\n\t}\n}\n\nexport = NormalBasicMethod;",
    "import NamedAssetBase\t\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShadingMethodEvent\t\t\t= require(\"awayjs-renderergl/lib/events/ShadingMethodEvent\");\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\n\n\n/**\n * ShadingMethodBase provides an abstract base method for shading methods, used by compiled passes to compile\n * the final shading program.\n */\nclass ShadingMethodBase extends NamedAssetBase\n{\n\tpublic _passes:Array<MaterialPassBase>; // should be protected\n\n\t/**\n\t * Create a new ShadingMethodBase object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic iIsUsed(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t * Initializes the properties for a MethodVO, including register and texture indices.\n\t *\n\t * @param methodVO The MethodVO object linking this method with the pass currently being compiled.\n\t *\n\t * @internal\n\t */\n\tpublic iInitVO(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\n\t}\n\n\t/**\n\t * Initializes unchanging shader constants using the data from a MethodVO.\n\t *\n\t * @param methodVO The MethodVO object linking this method with the pass currently being compiled.\n\t *\n\t * @internal\n\t */\n\tpublic iInitConstants(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\n\n\t}\n\n\t/**\n\t * Indicates whether or not this method expects normals in tangent space. Override for object-space normals.\n\t */\n\tpublic iUsesTangentSpace():boolean\n\t{\n\t\treturn true;\n\t}\n\n\t/**\n\t * Any passes required that render to a texture used by this method.\n\t */\n\tpublic get passes():Array<MaterialPassBase>\n\t{\n\t\treturn this._passes;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t */\n\tpublic dispose()\n\t{\n\n\t}\n\n\t/**\n\t * Resets the compilation state of the method.\n\t *\n\t * @internal\n\t */\n\tpublic iReset()\n\t{\n\t\tthis.iCleanCompilationData();\n\t}\n\n\t/**\n\t * Resets the method's state for compilation.\n\t *\n\t * @internal\n\t */\n\tpublic iCleanCompilationData()\n\t{\n\t}\n\n\t/**\n\t * Get the vertex shader code for this method.\n\t * @param vo The MethodVO object linking this method with the pass currently being compiled.\n\t * @param regCache The register cache used during the compilation.\n\t *\n\t * @internal\n\t */\n\tpublic iGetVertexCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCode(shaderObject:ShaderObjectBase, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn null;\n\t}\n\n\t/**\n\t * Sets the render state for this method.\n\t *\n\t * @param methodVO The MethodVO object linking this method with the pass currently being compiled.\n\t * @param stage The Stage object currently used for rendering.\n\t *\n\t * @internal\n\t */\n\tpublic iActivate(shaderObject:ShaderObjectBase, methodVO:MethodVO, stage:Stage)\n\t{\n\n\t}\n\n\t/**\n\t * Sets the render state for a single renderable.\n\t *\n\t * @param vo The MethodVO object linking this method with the pass currently being compiled.\n\t * @param renderable The renderable currently being rendered.\n\t * @param stage The Stage object currently used for rendering.\n\t * @param camera The camera from which the scene is currently rendered.\n\t *\n\t * @internal\n\t */\n\tpublic iSetRenderState(shaderObject:ShaderObjectBase, methodVO:MethodVO, renderable:RenderableBase, stage:Stage, camera:Camera)\n\t{\n\n\t}\n\n\t/**\n\t * Clears the render state for this method.\n\t * @param vo The MethodVO object linking this method with the pass currently being compiled.\n\t * @param stage The Stage object currently used for rendering.\n\t *\n\t * @internal\n\t */\n\tpublic iDeactivate(shaderObject:ShaderObjectBase, methodVO:MethodVO, stage:Stage)\n\t{\n\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @internal\n\t */\n\tpublic iInvalidateShaderProgram()\n\t{\n\t\tthis.dispatchEvent(new ShadingMethodEvent(ShadingMethodEvent.SHADER_INVALIDATED));\n\t}\n\n\t/**\n\t * Copies the state from a ShadingMethodBase object into the current object.\n\t */\n\tpublic copyFrom(method:ShadingMethodBase)\n\t{\n\t}\n}\n\nexport = ShadingMethodBase;",
    "import Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport MethodVO\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderLightingObject\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingObject\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport LightingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/LightingMethodBase\");\nimport ShadingMethodBase\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadingMethodBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\n\n/**\n * SpecularBasicMethod provides the default shading method for Blinn-Phong specular highlights (an optimized but approximated\n * version of Phong specularity).\n */\nclass SpecularBasicMethod extends LightingMethodBase\n{\n\tpublic _pUseTexture:boolean;\n\tpublic _pTotalLightColorReg:ShaderRegisterElement;\n\tpublic _pSpecularTextureRegister:ShaderRegisterElement;\n\tpublic _pSpecularTexData:ShaderRegisterElement;\n\tpublic _pSpecularDataRegister:ShaderRegisterElement;\n\n\tprivate _texture:Texture2DBase;\n\n\tprivate _gloss:number = 50;\n\tprivate _specular:number = 1;\n\tprivate _specularColor:number = 0xffffff;\n\tpublic _iSpecularR:number = 1;\n\tpublic _iSpecularG:number = 1;\n\tpublic _iSpecularB:number = 1;\n\tpublic _pIsFirstLight:boolean;\n\n\t/**\n\t * Creates a new SpecularBasicMethod object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic iIsUsed(shaderObject:ShaderLightingObject):boolean\n\t{\n\t\tif (!shaderObject.numLights)\n\t\t\treturn false;\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iInitVO(shaderObject:ShaderLightingObject, methodVO:MethodVO)\n\t{\n\t\tmethodVO.needsUV = this._pUseTexture;\n\t\tmethodVO.needsNormals = shaderObject.numLights > 0;\n\t\tmethodVO.needsView = shaderObject.numLights > 0;\n\t}\n\n\t/**\n\t * The sharpness of the specular highlight.\n\t */\n\tpublic get gloss():number\n\t{\n\t\treturn this._gloss;\n\t}\n\n\tpublic set gloss(value:number)\n\t{\n\t\tthis._gloss = value;\n\t}\n\n\t/**\n\t * The overall strength of the specular highlights.\n\t */\n\tpublic get specular():number\n\t{\n\t\treturn this._specular;\n\t}\n\n\tpublic set specular(value:number)\n\t{\n\t\tif (value == this._specular)\n\t\t\treturn;\n\n\t\tthis._specular = value;\n\t\tthis.updateSpecular();\n\t}\n\n\t/**\n\t * The colour of the specular reflection of the surface.\n\t */\n\tpublic get specularColor():number\n\t{\n\t\treturn this._specularColor;\n\t}\n\n\tpublic set specularColor(value:number)\n\t{\n\t\tif (this._specularColor == value)\n\t\t\treturn;\n\n\t\t// specular is now either enabled or disabled\n\t\tif (this._specularColor == 0 || value == 0)\n\t\t\tthis.iInvalidateShaderProgram();\n\n\t\tthis._specularColor = value;\n\t\tthis.updateSpecular();\n\t}\n\n\t/**\n\t * The bitmapData that encodes the specular highlight strength per texel in the red channel, and the sharpness\n\t * in the green channel. You can use SpecularBitmapTexture if you want to easily set specular and gloss maps\n\t * from grayscale images, but prepared images are preferred.\n\t */\n\tpublic get texture():Texture2DBase\n\t{\n\t\treturn this._texture;\n\t}\n\n\tpublic set texture(value:Texture2DBase)\n\t{\n\t\tvar b:boolean = ( value != null );\n\n\t\tif (b != this._pUseTexture || (value && this._texture && (value.hasMipmaps != this._texture.hasMipmaps || value.format != this._texture.format)))\n\t\t\tthis.iInvalidateShaderProgram();\n\n\t\tthis._pUseTexture = b;\n\t\tthis._texture = value;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic copyFrom(method:ShadingMethodBase)\n\t{\n\n\t\tvar m:any = method;\n\t\tvar bsm:SpecularBasicMethod = <SpecularBasicMethod> method;\n\n\t\tvar spec:SpecularBasicMethod = bsm;//SpecularBasicMethod(method);\n\t\tthis.texture = spec.texture;\n\t\tthis.specular = spec.specular;\n\t\tthis.specularColor = spec.specularColor;\n\t\tthis.gloss = spec.gloss;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iCleanCompilationData()\n\t{\n\t\tsuper.iCleanCompilationData();\n\t\tthis._pTotalLightColorReg = null;\n\t\tthis._pSpecularTextureRegister = null;\n\t\tthis._pSpecularTexData = null;\n\t\tthis._pSpecularDataRegister = null;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentPreLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tthis._pIsFirstLight = true;\n\n\t\tthis._pSpecularDataRegister = registerCache.getFreeFragmentConstant();\n\t\tmethodVO.fragmentConstantsIndex = this._pSpecularDataRegister.index*4;\n\n\t\tif (this._pUseTexture) {\n\n\t\t\tthis._pSpecularTexData = registerCache.getFreeFragmentVectorTemp();\n\t\t\tregisterCache.addFragmentTempUsages(this._pSpecularTexData, 1);\n\t\t\tthis._pSpecularTextureRegister = registerCache.getFreeTextureReg();\n\t\t\tmethodVO.texturesIndex = this._pSpecularTextureRegister.index;\n\t\t\tcode = ShaderCompilerHelper.getTex2DSampleCode(this._pSpecularTexData, sharedRegisters, this._pSpecularTextureRegister, this._texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t} else {\n\n\t\t\tthis._pSpecularTextureRegister = null;\n\t\t}\n\n\t\tthis._pTotalLightColorReg = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(this._pTotalLightColorReg, 1);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCodePerLight(shaderObject:ShaderLightingObject, methodVO:MethodVO, lightDirReg:ShaderRegisterElement, lightColReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar t:ShaderRegisterElement;\n\n\t\tif (this._pIsFirstLight) {\n\t\t\tt = this._pTotalLightColorReg;\n\t\t} else {\n\t\t\tt = registerCache.getFreeFragmentVectorTemp();\n\t\t\tregisterCache.addFragmentTempUsages(t, 1);\n\t\t}\n\n\t\tvar viewDirReg:ShaderRegisterElement = sharedRegisters.viewDirFragment;\n\t\tvar normalReg:ShaderRegisterElement = sharedRegisters.normalFragment;\n\n\t\t// blinn-phong half vector model\n\t\tcode += \"add \" + t + \", \" + lightDirReg + \", \" + viewDirReg + \"\\n\" +\n\t\t\t\t\"nrm \" + t + \".xyz, \" + t + \"\\n\" +\n\t\t\t\t\"dp3 \" + t + \".w, \" + normalReg + \", \" + t + \"\\n\" +\n\t\t\t\t\"sat \" + t + \".w, \" + t + \".w\\n\";\n\n\t\tif (this._pUseTexture) {\n\t\t\t// apply gloss modulation from texture\n\t\t\tcode += \"mul \" + this._pSpecularTexData + \".w, \" + this._pSpecularTexData + \".y, \" + this._pSpecularDataRegister + \".w\\n\" +\n\t\t\t\t\t\"pow \" + t + \".w, \" + t + \".w, \" + this._pSpecularTexData + \".w\\n\";\n\t\t} else {\n\t\t\tcode += \"pow \" + t + \".w, \" + t + \".w, \" + this._pSpecularDataRegister + \".w\\n\";\n\t\t}\n\n\t\t// attenuate\n\t\tif (shaderObject.usesLightFallOff)\n\t\t\tcode += \"mul \" + t + \".w, \" + t + \".w, \" + lightDirReg + \".w\\n\";\n\n\t\tif (this._iModulateMethod != null)\n\t\t\tcode += this._iModulateMethod(shaderObject, methodVO, t, registerCache, sharedRegisters);\n\n\t\tcode += \"mul \" + t + \".xyz, \" + lightColReg + \", \" + t + \".w\\n\";\n\n\t\tif (!this._pIsFirstLight) {\n\t\t\tcode += \"add \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + t + \"\\n\";\n\t\t\tregisterCache.removeFragmentTempUsage(t);\n\t\t}\n\n\t\tthis._pIsFirstLight = false;\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentCodePerProbe(shaderObject:ShaderLightingObject, methodVO:MethodVO, cubeMapReg:ShaderRegisterElement, weightRegister:string, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar t:ShaderRegisterElement;\n\n\t\t// write in temporary if not first light, so we can add to total diffuse colour\n\t\tif (this._pIsFirstLight) {\n\t\t\tt = this._pTotalLightColorReg;\n\t\t} else {\n\t\t\tt = registerCache.getFreeFragmentVectorTemp();\n\t\t\tregisterCache.addFragmentTempUsages(t, 1);\n\t\t}\n\n\t\tvar normalReg:ShaderRegisterElement = sharedRegisters.normalFragment;\n\t\tvar viewDirReg:ShaderRegisterElement = sharedRegisters.viewDirFragment;\n\n\t\tcode += \"dp3 \" + t + \".w, \" + normalReg + \", \" + viewDirReg + \"\\n\" +\n\t\t\t\t\"add \" + t + \".w, \" + t + \".w, \" + t + \".w\\n\" +\n\t\t\t\t\"mul \" + t + \", \" + t + \".w, \" + normalReg + \"\\n\" +\n\t\t\t\t\"sub \" + t + \", \" + t + \", \" + viewDirReg + \"\\n\" +\n\t\t\t\t\"tex \" + t + \", \" + t + \", \" + cubeMapReg + \" <cube,\" + (shaderObject.useSmoothTextures? \"linear\":\"nearest\") + \",miplinear>\\n\" +\n\t\t\t\t\"mul \" + t + \".xyz, \" + t + \", \" + weightRegister + \"\\n\";\n\n\t\tif (this._iModulateMethod != null)\n\t\t\tcode += this._iModulateMethod(shaderObject, methodVO, t, registerCache, sharedRegisters);\n\n\t\tif (!this._pIsFirstLight) {\n\t\t\tcode += \"add \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + t + \"\\n\";\n\t\t\tregisterCache.removeFragmentTempUsage(t);\n\t\t}\n\n\t\tthis._pIsFirstLight = false;\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iGetFragmentPostLightingCode(shaderObject:ShaderLightingObject, methodVO:MethodVO, targetReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tif (sharedRegisters.shadowTarget)\n\t\t\tcode += \"mul \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + sharedRegisters.shadowTarget + \".w\\n\";\n\n\t\tif (this._pUseTexture) {\n\t\t\t// apply strength modulation from texture\n\t\t\tcode += \"mul \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + this._pSpecularTexData + \".x\\n\";\n\t\t\tregisterCache.removeFragmentTempUsage(this._pSpecularTexData);\n\t\t}\n\n\t\t// apply material's specular reflection\n\t\tcode += \"mul \" + this._pTotalLightColorReg + \".xyz, \" + this._pTotalLightColorReg + \", \" + this._pSpecularDataRegister + \"\\n\" +\n\t\t\t\"add \" + targetReg + \".xyz, \" + targetReg + \", \" + this._pTotalLightColorReg + \"\\n\";\n\t\tregisterCache.removeFragmentTempUsage(this._pTotalLightColorReg);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic iActivate(shaderObject:ShaderLightingObject, methodVO:MethodVO, stage:Stage)\n\t{\n\t\tif (this._pUseTexture) {\n\t\t\tstage.context.setSamplerStateAt(methodVO.texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR:ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR:ContextGLMipFilter.MIPNONE);\n\t\t\tstage.context.activateTexture(methodVO.texturesIndex, this._texture);\n\t\t}\n\n\t\tvar index:number = methodVO.fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index] = this._iSpecularR;\n\t\tdata[index + 1] = this._iSpecularG;\n\t\tdata[index + 2] = this._iSpecularB;\n\t\tdata[index + 3] = this._gloss;\n\t}\n\n\t/**\n\t * Updates the specular color data used by the render state.\n\t */\n\tprivate updateSpecular()\n\t{\n\t\tthis._iSpecularR = (( this._specularColor >> 16) & 0xff)/0xff*this._specular;\n\t\tthis._iSpecularG = (( this._specularColor >> 8) & 0xff)/0xff*this._specular;\n\t\tthis._iSpecularB = ( this._specularColor & 0xff)/0xff*this._specular;\n\t}\n}\n\nexport = SpecularBasicMethod;",
    "﻿import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n/**\n * DepthMapPass is a pass that writes depth values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render shadow maps, depth maps, etc.\n */\nclass DepthMapPass extends MaterialPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\tprivate _texturesIndex:number;\n\n\t/**\n\t * Creates a new DepthMapPass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iInitConstantData(shaderObject);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index] = 1.0;\n\t\tdata[index + 1] = 255.0;\n\t\tdata[index + 2] = 65025.0;\n\t\tdata[index + 3] = 16581375.0;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tshaderObject.projectionDependencies++;\n\n\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\tshaderObject.uvDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar diffuseInputReg:ShaderRegisterElement = registerCache.getFreeTextureReg();\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\tcode += \"div \" + temp1 + \", \" + sharedRegisters.projectionFragment + \", \" + sharedRegisters.projectionFragment + \".w\\n\" + //\"sub ft2.z, fc0.x, ft2.z\\n\" +    //invert\n\t\t\t\"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t\"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t\"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\t//codeF += \"mov ft1.w, fc1.w\t\\n\" +\n\t\t//    \"mov ft0.w, fc0.x\t\\n\";\n\n\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\tdiffuseInputReg = registerCache.getFreeTextureReg();\n\n\t\t\tthis._texturesIndex = diffuseInputReg.index;\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += ShaderCompilerHelper.getTex2DSampleCode(albedo, sharedRegisters, diffuseInputReg, shaderObject.texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\tregisterCache.removeFragmentTempUsage(temp1);\n\t\tregisterCache.removeFragmentTempUsage(temp2);\n\n\t\treturn code;\n\t}\n\n\tpublic _iRender(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\t//this.setRenderState(pass, renderable, stage, camera, viewProjection);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, renderer, camera);\n\n\t\tvar context:IContextStageGL = renderer.context;\n\t\tvar shaderObject:ShaderObjectBase = pass.shaderObject;\n\n\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\tcontext.setSamplerStateAt(this._texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE);\n\t\t\tcontext.activateTexture(this._texturesIndex, shaderObject.texture);\n\n\t\t\tshaderObject.fragmentConstantData[this._fragmentConstantsIndex + 8] = pass.shaderObject.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DepthMapPass;",
    "﻿import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n/**\n * DistanceMapPass is a pass that writes distance values to a depth map as a 32-bit value exploded over the 4 texture channels.\n * This is used to render omnidirectional shadow maps.\n */\nclass DistanceMapPass extends MaterialPassBase\n{\n\tprivate _fragmentConstantsIndex:number;\n\tprivate _texturesIndex:number;\n\n\t/**\n\t * Creates a new DistanceMapPass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iInitConstantData(shaderObject);\n\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index + 4] = 1.0/255.0;\n\t\tdata[index + 5] = 1.0/255.0;\n\t\tdata[index + 6] = 1.0/255.0;\n\t\tdata[index + 7] = 0.0;\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tshaderObject.projectionDependencies++;\n\t\tshaderObject.viewDirDependencies++;\n\n\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\tshaderObject.uvDependencies++;\n\n\t\tshaderObject.addWorldSpaceDependencies(false);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string;\n\t\tvar targetReg:ShaderRegisterElement = sharedRegisters.shadedTarget;\n\t\tvar diffuseInputReg:ShaderRegisterElement = registerCache.getFreeTextureReg();\n\t\tvar dataReg1:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\t\tvar dataReg2:ShaderRegisterElement = registerCache.getFreeFragmentConstant()\n\n\t\tthis._fragmentConstantsIndex = dataReg1.index*4;\n\n\t\tvar temp1:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp1, 1);\n\t\tvar temp2:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\tregisterCache.addFragmentTempUsages(temp2, 1);\n\n\t\t// squared distance to view\n\t\tcode = \"dp3 \" + temp1 + \".z, \" + sharedRegisters.viewDirVarying + \".xyz, \" + sharedRegisters.viewDirVarying + \".xyz\\n\" +\n\t\t\t   \"mul \" + temp1 + \", \" + dataReg1 + \", \" + temp1 + \".z\\n\" +\n\t\t\t   \"frc \" + temp1 + \", \" + temp1 + \"\\n\" +\n\t\t\t   \"mul \" + temp2 + \", \" + temp1 + \".yzww, \" + dataReg2 + \"\\n\";\n\n\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\tdiffuseInputReg = registerCache.getFreeTextureReg();\n\n\t\t\tthis._texturesIndex = diffuseInputReg.index;\n\n\t\t\tvar albedo:ShaderRegisterElement = registerCache.getFreeFragmentVectorTemp();\n\t\t\tcode += ShaderCompilerHelper.getTex2DSampleCode(albedo, sharedRegisters, diffuseInputReg, shaderObject.texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t\tvar cutOffReg:ShaderRegisterElement = registerCache.getFreeFragmentConstant();\n\n\t\t\tcode += \"sub \" + albedo + \".w, \" + albedo + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\"kil \" + albedo + \".w\\n\";\n\t\t}\n\n\t\tcode += \"sub \" + targetReg + \", \" + temp1 + \", \" + temp2 + \"\\n\";\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, renderer, camera);\n\n\t\tvar context:IContextStageGL = renderer.context;\n\t\tvar shaderObject:ShaderObjectBase = pass.shaderObject;\n\n\t\tvar f:number = camera.projection.far;\n\n\t\tf = 1/(2*f*f);\n\t\t// sqrt(f*f+f*f) is largest possible distance for any frustum, so we need to divide by it. Rarely a tight fit, but with 32 bits precision, it's enough.\n\t\tvar index:number = this._fragmentConstantsIndex;\n\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\tdata[index] = 1.0*f;\n\t\tdata[index + 1] = 255.0*f;\n\t\tdata[index + 2] = 65025.0*f;\n\t\tdata[index + 3] = 16581375.0*f;\n\n\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\tcontext.setSamplerStateAt(this._texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE);\n\t\t\tcontext.activateTexture(this._texturesIndex, shaderObject.texture);\n\n\t\t\tdata[index + 8] = pass.shaderObject.alphaThreshold;\n\t\t}\n\t}\n}\n\nexport = DistanceMapPass;",
    "﻿import ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\n\n/**\n * LineBasicPass is a material pass that draws wireframe segments.\n */\nclass LineBasicPass extends MaterialPassBase\n{\n\t/**\n\t * Creates a new SegmentPass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar targetReg:ShaderRegisterElement = sharedReg.shadedTarget;\n\n\t\treturn \"mov \" + targetReg + \", v0\\n\";\n\t}\n}\n\nexport = LineBasicPass;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport NamedAssetBase\t\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport BlendMode\t\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IMaterialPass\t\t\t\t= require(\"awayjs-display/lib/materials/passes/IMaterialPass\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\")\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport IMaterialPassStageGL\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/IMaterialPassStageGL\");\nimport MaterialPassMode\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassMode\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n\n/**\n * MaterialPassBase provides an abstract base class for material shader passes. A material pass constitutes at least\n * a render call per required renderable.\n */\nclass MaterialPassBase extends NamedAssetBase implements IMaterialPass, IMaterialPassStageGL\n{\n\tprivate _materialPassData:Array<MaterialPassData> = new Array<MaterialPassData>();\n\tprivate _maxLights:number = 3;\n\tprivate _preserveAlpha:boolean = true;\n\tprivate _includeCasters:boolean = true;\n\tprivate _forceSeparateMVP:boolean = false;\n\n\tprivate _directionalLightsOffset:number = 0;\n\tprivate _pointLightsOffset:number = 0;\n\tprivate _lightProbesOffset:number = 0;\n\n\tpublic _pNumPointLights:number = 0;\n\tpublic _pNumDirectionalLights:number = 0;\n\tpublic _pNumLightProbes:number = 0;\n\tpublic _pNumLights:number = 0;\n\n\tprivate _passMode:number;\n\n\tprivate _depthCompareMode:string = ContextGLCompareMode.LESS_EQUAL;\n\n\tprivate _blendFactorSource:string = ContextGLBlendFactor.ONE;\n\tprivate _blendFactorDest:string = ContextGLBlendFactor.ZERO;\n\n\tpublic _pEnableBlending:boolean = false;\n\n\tpublic  _pLightPicker:LightPickerBase;\n\n\tprivate _writeDepth:boolean = true;\n\tprivate _onLightsChangeDelegate:(event:Event) => void;\n\n\t/**\n\t * Indicates whether the output alpha value should remain unchanged compared to the material's original alpha.\n\t */\n\tpublic get preserveAlpha():boolean\n\t{\n\t\treturn this._preserveAlpha;\n\t}\n\n\tpublic set preserveAlpha(value:boolean)\n\t{\n\t\tif (this._preserveAlpha == value)\n\t\t\treturn;\n\n\t\tthis._preserveAlpha = value;\n\n\t\tthis._pInvalidatePass();\n\t}\n\n\t/**\n\t * Indicates whether or not shadow casting lights need to be included.\n\t */\n\tpublic get includeCasters():boolean\n\t{\n\t\treturn this._includeCasters;\n\t}\n\n\tpublic set includeCasters(value:boolean)\n\t{\n\t\tif (this._includeCasters == value)\n\t\t\treturn;\n\n\t\tthis._includeCasters = value;\n\n\t\tthis._pInvalidatePass();\n\t}\n\n\t/**\n\t * Indicates whether the screen projection should be calculated by forcing a separate scene matrix and\n\t * view-projection matrix. This is used to prevent rounding errors when using multiple passes with different\n\t * projection code.\n\t */\n\tpublic get forceSeparateMVP():boolean\n\t{\n\t\treturn this._forceSeparateMVP;\n\t}\n\n\tpublic set forceSeparateMVP(value:boolean)\n\t{\n\t\tif (this._forceSeparateMVP == value)\n\t\t\treturn;\n\n\t\tthis._forceSeparateMVP = value;\n\n\t\tthis._pInvalidatePass();\n\t}\n\t/**\n\t * Indicates the offset in the light picker's directional light vector for which to start including lights.\n\t * This needs to be set before the light picker is assigned.\n\t */\n\tpublic get directionalLightsOffset():number\n\t{\n\t\treturn this._directionalLightsOffset;\n\t}\n\n\tpublic set directionalLightsOffset(value:number)\n\t{\n\t\tthis._directionalLightsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the offset in the light picker's point light vector for which to start including lights.\n\t * This needs to be set before the light picker is assigned.\n\t */\n\tpublic get pointLightsOffset():number\n\t{\n\t\treturn this._pointLightsOffset;\n\t}\n\n\tpublic set pointLightsOffset(value:number)\n\t{\n\t\tthis._pointLightsOffset = value;\n\t}\n\n\t/**\n\t * Indicates the offset in the light picker's light probes vector for which to start including lights.\n\t * This needs to be set before the light picker is assigned.\n\t */\n\tpublic get lightProbesOffset():number\n\t{\n\t\treturn this._lightProbesOffset;\n\t}\n\n\tpublic set lightProbesOffset(value:number)\n\t{\n\t\tthis._lightProbesOffset = value;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get passMode():number\n\t{\n\t\treturn this._passMode;\n\t}\n\n\tpublic set passMode(value:number)\n\t{\n\t\tthis._passMode = value;\n\n\t\tthis._pInvalidatePass();\n\t}\n\n\t/**\n\t * Creates a new MaterialPassBase object.\n\t */\n\tconstructor(passMode:number = 0x03)\n\t{\n\t\tsuper();\n\n\t\tthis._passMode = passMode;\n\n\t\tthis._onLightsChangeDelegate = (event:Event) => this.onLightsChange(event);\n\t}\n\n\t/**\n\t * Factory method to create a concrete shader object for this pass.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tpublic createShaderObject(profile:string):ShaderObjectBase\n\t{\n\t\treturn new ShaderObjectBase(profile);\n\t}\n\n\t/**\n\t * Indicate whether this pass should write to the depth buffer or not. Ignored when blending is enabled.\n\t */\n\tpublic get writeDepth():boolean\n\t{\n\t\treturn this._writeDepth;\n\t}\n\n\tpublic set writeDepth(value:boolean)\n\t{\n\t\tthis._writeDepth = value;\n\t}\n\n\t/**\n\t * The depth compare mode used to render the renderables using this material.\n\t *\n\t * @see away.stagegl.ContextGLCompareMode\n\t */\n\tpublic get depthCompareMode():string\n\t{\n\t\treturn this._depthCompareMode;\n\t}\n\n\tpublic set depthCompareMode(value:string)\n\t{\n\t\tthis._depthCompareMode = value;\n\t}\n\n\t/**\n\t * Cleans up any resources used by the current object.\n\t * @param deep Indicates whether other resources should be cleaned up, that could potentially be shared across different instances.\n\t */\n\tpublic dispose()\n\t{\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.removeEventListener(Event.CHANGE, this._onLightsChangeDelegate);\n\n\t\twhile (this._materialPassData.length)\n\t\t\tthis._materialPassData[0].dispose();\n\n\t\tthis._materialPassData = null;\n\t}\n\n\t/**\n\t * Renders an object to the current render target.\n\t *\n\t * @private\n\t */\n\tpublic _iRender(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tthis.setRenderState(pass, renderable, stage, camera, viewProjection);\n\t}\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic setRenderState(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tpass.shaderObject.setRenderState(renderable, stage, camera, viewProjection);\n\t}\n\n\t/**\n\t * The blend mode to use when drawing this renderable. The following blend modes are supported:\n\t * <ul>\n\t * <li>BlendMode.NORMAL: No blending, unless the material inherently needs it</li>\n\t * <li>BlendMode.LAYER: Force blending. This will draw the object the same as NORMAL, but without writing depth writes.</li>\n\t * <li>BlendMode.MULTIPLY</li>\n\t * <li>BlendMode.ADD</li>\n\t * <li>BlendMode.ALPHA</li>\n\t * </ul>\n\t */\n\tpublic setBlendMode(value:string)\n\t{\n\t\tswitch (value) {\n\n\t\t\tcase BlendMode.NORMAL:\n\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._pEnableBlending = false;\n\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.LAYER:\n\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA;\n\t\t\t\tthis._pEnableBlending = true;\n\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.MULTIPLY:\n\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_COLOR;\n\t\t\t\tthis._pEnableBlending = true;\n\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ADD:\n\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.ONE;\n\t\t\t\tthis._pEnableBlending = true;\n\n\t\t\t\tbreak;\n\n\t\t\tcase BlendMode.ALPHA:\n\n\t\t\t\tthis._blendFactorSource = ContextGLBlendFactor.ZERO;\n\t\t\t\tthis._blendFactorDest = ContextGLBlendFactor.SOURCE_ALPHA;\n\t\t\t\tthis._pEnableBlending = true;\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tthrow new ArgumentError(\"Unsupported blend mode!\");\n\n\t\t}\n\t}\n\n\t/**\n\t * Sets the render state for the pass that is independent of the rendered object. This needs to be called before\n\t * calling renderPass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivate(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\trenderer.context.setDepthTest(( this._writeDepth && !this._pEnableBlending ), this._depthCompareMode);\n\n\t\tif (this._pEnableBlending)\n\t\t\trenderer.context.setBlendFactors(this._blendFactorSource, this._blendFactorDest);\n\n\t\trenderer.activateMaterialPass(pass, camera);\n\t}\n\n\t/**\n\t * Clears the render state for the pass. This needs to be called before activating another pass.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @private\n\t */\n\tpublic _iDeactivate(pass:MaterialPassData, renderer:RendererBase)\n\t{\n\t\trenderer.deactivateMaterialPass(pass);\n\n\t\trenderer.context.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL); // TODO : imeplement\n\t}\n\n\t/**\n\t * Marks the shader program as invalid, so it will be recompiled before the next render.\n\t *\n\t * @param updateMaterial Indicates whether the invalidation should be performed on the entire material. Should always pass \"true\" unless it's called from the material itself.\n\t */\n\tpublic _pInvalidatePass()\n\t{\n\t\tvar len:number = this._materialPassData.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._materialPassData[i].invalidate();\n\n\t\tthis.dispatchEvent(new Event(Event.CHANGE));\n\t}\n\n\t/**\n\t * The light picker used by the material to provide lights to the material if it supports lighting.\n\t *\n\t * @see away.materials.LightPickerBase\n\t * @see away.materials.StaticLightPicker\n\t */\n\tpublic get lightPicker():LightPickerBase\n\t{\n\t\treturn this._pLightPicker;\n\t}\n\n\tpublic set lightPicker(value:LightPickerBase)\n\t{\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.removeEventListener(Event.CHANGE, this._onLightsChangeDelegate);\n\n\t\tthis._pLightPicker = value;\n\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.addEventListener(Event.CHANGE, this._onLightsChangeDelegate);\n\n\t\tthis.pUpdateLights();\n\t}\n\n\t/**\n\t * Called when the light picker's configuration changes.\n\t */\n\tprivate onLightsChange(event:Event)\n\t{\n\t\tthis.pUpdateLights();\n\t}\n\n\t/**\n\t * Implemented by subclasses if the pass uses lights to update the shader.\n\t */\n\tpublic pUpdateLights()\n\t{\n\t\tvar numDirectionalLightsOld:number = this._pNumDirectionalLights;\n\t\tvar numPointLightsOld:number = this._pNumPointLights;\n\t\tvar numLightProbesOld:number = this._pNumLightProbes;\n\n\t\tif (this._pLightPicker && (this._passMode & MaterialPassMode.LIGHTING)) {\n\t\t\tthis._pNumDirectionalLights = this.calculateNumDirectionalLights(this._pLightPicker.numDirectionalLights);\n\t\t\tthis._pNumPointLights = this.calculateNumPointLights(this._pLightPicker.numPointLights);\n\t\t\tthis._pNumLightProbes = this.calculateNumProbes(this._pLightPicker.numLightProbes);\n\n\t\t\tif (this._includeCasters) {\n\t\t\t\tthis._pNumDirectionalLights += this._pLightPicker.numCastingDirectionalLights;\n\t\t\t\tthis._pNumPointLights += this._pLightPicker.numCastingPointLights;\n\t\t\t}\n\n\t\t} else {\n\t\t\tthis._pNumDirectionalLights = 0;\n\t\t\tthis._pNumPointLights = 0;\n\t\t\tthis._pNumLightProbes = 0;\n\t\t}\n\n\t\tthis._pNumLights = this._pNumDirectionalLights + this._pNumPointLights;\n\n\t\tif (numDirectionalLightsOld != this._pNumDirectionalLights || numPointLightsOld != this._pNumPointLights || numLightProbesOld != this._pNumLightProbes)\n\t\t\tthis._pInvalidatePass();\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderObjectBase)\n\t{\n\t\tif (this._forceSeparateMVP)\n\t\t\tshaderObject.globalPosDependencies++;\n\n\t\tshaderObject.outputsNormals = this._pOutputsNormals(shaderObject);\n\t\tshaderObject.outputsTangentNormals = shaderObject.outputsNormals && this._pOutputsTangentNormals(shaderObject);\n\t\tshaderObject.usesTangentSpace = shaderObject.outputsTangentNormals && this._pUsesTangentSpace(shaderObject);\n\n\t\tif (!shaderObject.usesTangentSpace)\n\t\t\tshaderObject.addWorldSpaceDependencies(Boolean(this._passMode & MaterialPassMode.EFFECTS));\n\t}\n\n\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\tpublic _iGetNormalFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn \"\";\n\t}\n\n\t/**\n\t * The amount of point lights that need to be supported.\n\t */\n\tpublic get iNumPointLights():number\n\t{\n\t\treturn this._pNumPointLights;\n\t}\n\n\t/**\n\t * The amount of directional lights that need to be supported.\n\t */\n\tpublic get iNumDirectionalLights():number\n\t{\n\t\treturn this._pNumDirectionalLights;\n\t}\n\n\t/**\n\t * The amount of light probes that need to be supported.\n\t */\n\tpublic get iNumLightProbes():number\n\t{\n\t\treturn this._pNumLightProbes;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are calculated at all.\n\t */\n\tpublic _pOutputsNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are calculated in tangent space.\n\t */\n\tpublic _pOutputsTangentNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are allowed in tangent space. This is only the case if no object-space\n\t * dependencies exist.\n\t */\n\tpublic _pUsesTangentSpace(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * Calculates the amount of directional lights this material will support.\n\t * @param numDirectionalLights The maximum amount of directional lights to support.\n\t * @return The amount of directional lights this material will support, bounded by the amount necessary.\n\t */\n\tprivate calculateNumDirectionalLights(numDirectionalLights:number):number\n\t{\n\t\treturn Math.min(numDirectionalLights - this._directionalLightsOffset, this._maxLights);\n\t}\n\n\t/**\n\t * Calculates the amount of point lights this material will support.\n\t * @param numDirectionalLights The maximum amount of point lights to support.\n\t * @return The amount of point lights this material will support, bounded by the amount necessary.\n\t */\n\tprivate calculateNumPointLights(numPointLights:number):number\n\t{\n\t\tvar numFree:number = this._maxLights - this._pNumDirectionalLights;\n\t\treturn Math.min(numPointLights - this._pointLightsOffset, numFree);\n\t}\n\n\t/**\n\t * Calculates the amount of light probes this material will support.\n\t * @param numDirectionalLights The maximum amount of light probes to support.\n\t * @return The amount of light probes this material will support, bounded by the amount necessary.\n\t */\n\tprivate calculateNumProbes(numLightProbes:number):number\n\t{\n\t\tvar numChannels:number = 0;\n\t\t//\t\t\tif ((this._pSpecularLightSources & LightSources.PROBES) != 0)\n\t\t//\t\t\t\t++numChannels;\n\t\t//\n\t\t//\t\t\tif ((this._pDiffuseLightSources & LightSources.PROBES) != 0)\n\t\t//\t\t\t\t++numChannels;\n\n\t\t// 4 channels available\n\t\treturn Math.min(numLightProbes - this._lightProbesOffset, (4/numChannels) | 0);\n\t}\n\n\tpublic _iAddMaterialPassData(materialPassData:MaterialPassData):MaterialPassData\n\t{\n\t\tthis._materialPassData.push(materialPassData);\n\n\t\treturn materialPassData;\n\t}\n\n\tpublic _iRemoveMaterialPassData(materialPassData:MaterialPassData):MaterialPassData\n\t{\n\t\tthis._materialPassData.splice(this._materialPassData.indexOf(materialPassData), 1);\n\n\t\treturn materialPassData;\n\t}\n}\n\nexport = MaterialPassBase;",
    "class MaterialPassMode\n{\n\tpublic static EFFECTS:number = 0x01\n\t/**\n\t *\n\t */\n\tpublic static LIGHTING:number = 0x02;\n\t/**\n\t *\n\t */\n\tpublic static SUPER_SHADER:number = 0x03;\n}\n\nexport = MaterialPassMode;",
    "﻿import Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport ShadingMethodEvent\t\t\t= require(\"awayjs-renderergl/lib/events/ShadingMethodEvent\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport ShaderCompilerHelper\t\t\t= require(\"awayjs-renderergl/lib/materials/utils/ShaderCompilerHelper\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n/**\n * CompiledPass forms an abstract base class for the default compiled pass materials provided by Away3D,\n * using material methods to define their appearance.\n */\nclass TriangleBasicPass extends MaterialPassBase\n{\n\tprivate _diffuseColor:number = 0xffffff;\n\tprivate _diffuseR:number = 1;\n\tprivate _diffuseG:number = 1;\n\tprivate _diffuseB:number = 1;\n\tprivate _diffuseA:number = 1;\n\n\tprivate _fragmentConstantsIndex:number;\n\tprivate _texturesIndex:number;\n\n\t/**\n\t * The alpha component of the diffuse reflection.\n\t */\n\tpublic get diffuseAlpha():number\n\t{\n\t\treturn this._diffuseA;\n\t}\n\n\tpublic set diffuseAlpha(value:number)\n\t{\n\t\tthis._diffuseA = value;\n\t}\n\n\t/**\n\t * The color of the diffuse reflection when not using a texture.\n\t */\n\tpublic get diffuseColor():number\n\t{\n\t\treturn this._diffuseColor;\n\t}\n\n\tpublic set diffuseColor(diffuseColor:number)\n\t{\n\t\tthis._diffuseColor = diffuseColor;\n\n\t\tthis._diffuseR = ((this._diffuseColor >> 16) & 0xff)/0xff;\n\t\tthis._diffuseG = ((this._diffuseColor >> 8) & 0xff)/0xff;\n\t\tthis._diffuseB = (this._diffuseColor & 0xff)/0xff;\n\t}\n\n\t/**\n\t * Creates a new CompiledPass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar targetReg:ShaderRegisterElement = sharedReg.shadedTarget;\n\t\tvar diffuseInputReg:ShaderRegisterElement;\n\n\t\tif (shaderObject.texture != null) {\n\t\t\tdiffuseInputReg = regCache.getFreeTextureReg();\n\n\t\t\tthis._texturesIndex = diffuseInputReg.index;\n\n\t\t\tcode += ShaderCompilerHelper.getTex2DSampleCode(targetReg, sharedReg, diffuseInputReg, shaderObject.texture, shaderObject.useSmoothTextures, shaderObject.repeatTextures, shaderObject.useMipmapping);\n\n\t\t\tif (shaderObject.alphaThreshold > 0) {\n\t\t\t\tvar cutOffReg:ShaderRegisterElement = regCache.getFreeFragmentConstant();\n\t\t\t\tthis._fragmentConstantsIndex = cutOffReg.index*4;\n\n\t\t\t\tcode += \"sub \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\" +\n\t\t\t\t\t\"kil \" + targetReg + \".w\\n\" +\n\t\t\t\t\t\"add \" + targetReg + \".w, \" + targetReg + \".w, \" + cutOffReg + \".x\\n\";\n\t\t\t}\n\n\t\t} else {\n\t\t\tdiffuseInputReg = regCache.getFreeFragmentConstant();\n\n\t\t\tthis._fragmentConstantsIndex = diffuseInputReg.index*4;\n\n\t\t\tcode += \"mov \" + targetReg + \", \" + diffuseInputReg + \"\\n\";\n\t\t}\n\n\t\treturn code;\n\t}\n\n\tpublic _iIncludeDependencies(dependencyCounter:ShaderObjectBase)\n\t{\n\t\tif (dependencyCounter.texture != null)\n\t\t\tdependencyCounter.uvDependencies++;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, renderer, camera);\n\n\t\tvar shaderObject:ShaderObjectBase = pass.shaderObject;\n\n\t\tif (shaderObject.texture != null) {\n\t\t\trenderer.context.setSamplerStateAt(this._texturesIndex, shaderObject.repeatTextures? ContextGLWrapMode.REPEAT:ContextGLWrapMode.CLAMP, shaderObject.useSmoothTextures? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST, shaderObject.useMipmapping? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE);\n\t\t\trenderer.context.activateTexture(this._texturesIndex, shaderObject.texture);\n\n\t\t\tif (shaderObject.alphaThreshold > 0)\n\t\t\t\tshaderObject.fragmentConstantData[this._fragmentConstantsIndex] = shaderObject.alphaThreshold;\n\t\t} else {\n\t\t\tvar index:number = this._fragmentConstantsIndex;\n\t\t\tvar data:Array<number> = shaderObject.fragmentConstantData;\n\t\t\tdata[index] = this._diffuseR;\n\t\t\tdata[index + 1] = this._diffuseG;\n\t\t\tdata[index + 2] = this._diffuseB;\n\t\t\tdata[index + 3] = this._diffuseA;\n\t\t}\n\t}\n}\n\nexport = TriangleBasicPass;",
    "import ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Matrix\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Matrix3DUtils\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3DUtils\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport Texture2DBase\t\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\nimport MaterialPassData\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport ShadingMethodEvent\t\t\t\t= require(\"awayjs-renderergl/lib/events/ShadingMethodEvent\");\nimport MethodVO\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/MethodVO\");\nimport ShaderLightingObject\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderLightingObject\");\nimport ShaderObjectBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport ShaderRegisterCache\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterCache\");\nimport ShaderRegisterData\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\nimport AmbientBasicMethod\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/AmbientBasicMethod\");\nimport DiffuseBasicMethod\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/DiffuseBasicMethod\");\nimport EffectColorTransformMethod\t\t= require(\"awayjs-renderergl/lib/materials/methods/EffectColorTransformMethod\");\nimport EffectMethodBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/EffectMethodBase\");\nimport LightingMethodBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/LightingMethodBase\");\nimport NormalBasicMethod\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/NormalBasicMethod\");\nimport ShadowMapMethodBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/ShadowMapMethodBase\");\nimport SpecularBasicMethod\t\t\t\t= require(\"awayjs-renderergl/lib/materials/methods/SpecularBasicMethod\");\nimport ILightingPassStageGL\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/ILightingPassStageGL\");\nimport MaterialPassBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport MaterialPassMode\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassMode\");\nimport RendererBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\n\n/**\n * CompiledPass forms an abstract base class for the default compiled pass materials provided by Away3D,\n * using material methods to define their appearance.\n */\nclass TriangleMethodPass extends MaterialPassBase implements ILightingPassStageGL\n{\n\tpublic _iColorTransformMethodVO:MethodVO;\n\tpublic _iNormalMethodVO:MethodVO;\n\tpublic _iAmbientMethodVO:MethodVO;\n\tpublic _iShadowMethodVO:MethodVO;\n\tpublic _iDiffuseMethodVO:MethodVO;\n\tpublic _iSpecularMethodVO:MethodVO;\n\tpublic _iMethodVOs:Array<MethodVO> = new Array<MethodVO>();\n\n\tpublic _numEffectDependencies:number = 0;\n\n\tprivate _onShaderInvalidatedDelegate:(event:ShadingMethodEvent) => void;\n\n\t/**\n\t * Creates a new CompiledPass object.\n\t *\n\t * @param material The material to which this pass belongs.\n\t */\n\tconstructor(passMode:number = 0x03)\n\t{\n\t\tsuper(passMode);\n\n\t\tthis._onShaderInvalidatedDelegate = (event:ShadingMethodEvent) => this.onShaderInvalidated(event);\n\t}\n\n\t/**\n\t * Factory method to create a concrete shader object for this pass.\n\t *\n\t * @param profile The compatibility profile used by the renderer.\n\t */\n\tpublic createShaderObject(profile:string):ShaderObjectBase\n\t{\n\t\tif (this._pLightPicker && (this.passMode & MaterialPassMode.LIGHTING))\n\t\t\treturn new ShaderLightingObject(profile);\n\n\t\treturn new ShaderObjectBase(profile);\n\t}\n\n\t/**\n\t * Initializes the unchanging constant data for this material.\n\t */\n\tpublic _iInitConstantData(shaderObject:ShaderObjectBase)\n\t{\n\t\tsuper._iInitConstantData(shaderObject);\n\n\t\t//Updates method constants if they have changed.\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tthis._iMethodVOs[i].method.iInitConstants(shaderObject, this._iMethodVOs[i]);\n\t}\n\n\t/**\n\t * The ColorTransform object to transform the colour of the material with. Defaults to null.\n\t */\n\tpublic get colorTransform():ColorTransform\n\t{\n\t\treturn this.colorTransformMethod? this.colorTransformMethod.colorTransform : null;\n\t}\n\n\tpublic set colorTransform(value:ColorTransform)\n\t{\n\t\tif (value) {\n\t\t\tif (this.colorTransformMethod == null)\n\t\t\t\tthis.colorTransformMethod = new EffectColorTransformMethod();\n\n\t\t\tthis.colorTransformMethod.colorTransform = value;\n\n\t\t} else if (!value) {\n\t\t\tif (this.colorTransformMethod)\n\t\t\t\tthis.colorTransformMethod = null;\n\t\t}\n\t}\n\n\t/**\n\t * The EffectColorTransformMethod object to transform the colour of the material with. Defaults to null.\n\t */\n\tpublic get colorTransformMethod():EffectColorTransformMethod\n\t{\n\t\treturn this._iColorTransformMethodVO? <EffectColorTransformMethod> this._iColorTransformMethodVO.method : null;\n\t}\n\n\tpublic set colorTransformMethod(value:EffectColorTransformMethod)\n\t{\n\t\tif (this._iColorTransformMethodVO && this._iColorTransformMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iColorTransformMethodVO) {\n\t\t\tthis._removeDependency(this._iColorTransformMethodVO);\n\t\t\tthis._iColorTransformMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iColorTransformMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iColorTransformMethodVO);\n\t\t}\n\t}\n\n\tprivate _removeDependency(methodVO:MethodVO, effectsDependency:boolean = false)\n\t{\n\t\tvar index:number = this._iMethodVOs.indexOf(methodVO);\n\n\t\tif (!effectsDependency)\n\t\t\tthis._numEffectDependencies--;\n\n\t\tmethodVO.method.removeEventListener(ShadingMethodEvent.SHADER_INVALIDATED, this._onShaderInvalidatedDelegate);\n\t\tthis._iMethodVOs.splice(index, 1);\n\n\t\tthis._pInvalidatePass();\n\t}\n\n\tprivate _addDependency(methodVO:MethodVO, effectsDependency:boolean = false, index:number = -1)\n\t{\n\t\tmethodVO.method.addEventListener(ShadingMethodEvent.SHADER_INVALIDATED, this._onShaderInvalidatedDelegate);\n\n\t\tif (effectsDependency) {\n\t\t\tif (index != -1)\n\t\t\t\tthis._iMethodVOs.splice(index + this._iMethodVOs.length - this._numEffectDependencies, 0, methodVO);\n\t\t\telse\n\t\t\t\tthis._iMethodVOs.push(methodVO);\n\t\t\tthis._numEffectDependencies++;\n\t\t} else {\n\t\t\tthis._iMethodVOs.splice(this._iMethodVOs.length - this._numEffectDependencies, 0, methodVO);\n\t\t}\n\n\t\tthis._pInvalidatePass();\n\t}\n\n\t/**\n\t * Appends an \"effect\" shading method to the shader. Effect methods are those that do not influence the lighting\n\t * but modulate the shaded colour, used for fog, outlines, etc. The method will be applied to the result of the\n\t * methods added prior.\n\t */\n\tpublic addEffectMethod(method:EffectMethodBase)\n\t{\n\t\tthis._addDependency(new MethodVO(method), true);\n\t}\n\n\t/**\n\t * The number of \"effect\" methods added to the material.\n\t */\n\tpublic get numEffectMethods():number\n\t{\n\t\treturn this._numEffectDependencies;\n\t}\n\n\t/**\n\t * Queries whether a given effects method was added to the material.\n\t *\n\t * @param method The method to be queried.\n\t * @return true if the method was added to the material, false otherwise.\n\t */\n\tpublic hasEffectMethod(method:EffectMethodBase):boolean\n\t{\n\t\treturn this.getDependencyForMethod(method) != null;\n\t}\n\n\t/**\n\t * Returns the method added at the given index.\n\t * @param index The index of the method to retrieve.\n\t * @return The method at the given index.\n\t */\n\tpublic getEffectMethodAt(index:number):EffectMethodBase\n\t{\n\t\tif (index < 0 || index > this._numEffectDependencies - 1)\n\t\t\treturn null;\n\n\t\treturn <EffectMethodBase> this._iMethodVOs[index + this._iMethodVOs.length - this._numEffectDependencies].method;\n\t}\n\n\t/**\n\t * Adds an effect method at the specified index amongst the methods already added to the material. Effect\n\t * methods are those that do not influence the lighting but modulate the shaded colour, used for fog, outlines,\n\t * etc. The method will be applied to the result of the methods with a lower index.\n\t */\n\tpublic addEffectMethodAt(method:EffectMethodBase, index:number)\n\t{\n\t\tthis._addDependency(new MethodVO(method), true, index);\n\t}\n\n\t/**\n\t * Removes an effect method from the material.\n\t * @param method The method to be removed.\n\t */\n\tpublic removeEffectMethod(method:EffectMethodBase)\n\t{\n\t\tvar methodVO:MethodVO = this.getDependencyForMethod(method);\n\n\t\tif (methodVO != null)\n\t\t\tthis._removeDependency(methodVO, true);\n\t}\n\n\n\tprivate getDependencyForMethod(method:EffectMethodBase):MethodVO\n\t{\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\tif (this._iMethodVOs[i].method == method)\n\t\t\t\treturn this._iMethodVOs[i];\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * The method used to generate the per-pixel normals. Defaults to NormalBasicMethod.\n\t */\n\tpublic get normalMethod():NormalBasicMethod\n\t{\n\t\treturn this._iNormalMethodVO? <NormalBasicMethod> this._iNormalMethodVO.method : null;\n\t}\n\n\tpublic set normalMethod(value:NormalBasicMethod)\n\t{\n\t\tif (this._iNormalMethodVO && this._iNormalMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iNormalMethodVO) {\n\t\t\tthis._removeDependency(this._iNormalMethodVO);\n\t\t\tthis._iNormalMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iNormalMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iNormalMethodVO);\n\t\t}\n\t}\n\n\t/**\n\t * The method that provides the ambient lighting contribution. Defaults to AmbientBasicMethod.\n\t */\n\tpublic get ambientMethod():AmbientBasicMethod\n\t{\n\t\treturn this._iAmbientMethodVO? <AmbientBasicMethod> this._iAmbientMethodVO.method : null;\n\t}\n\n\tpublic set ambientMethod(value:AmbientBasicMethod)\n\t{\n\t\tif (this._iAmbientMethodVO && this._iAmbientMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iAmbientMethodVO) {\n\t\t\tthis._removeDependency(this._iAmbientMethodVO);\n\t\t\tthis._iAmbientMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iAmbientMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iAmbientMethodVO);\n\t\t}\n\t}\n\n\t/**\n\t * The method used to render shadows cast on this surface, or null if no shadows are to be rendered. Defaults to null.\n\t */\n\tpublic get shadowMethod():ShadowMapMethodBase\n\t{\n\t\treturn this._iShadowMethodVO? <ShadowMapMethodBase> this._iShadowMethodVO.method : null;\n\t}\n\n\tpublic set shadowMethod(value:ShadowMapMethodBase)\n\t{\n\t\tif (this._iShadowMethodVO && this._iShadowMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iShadowMethodVO) {\n\t\t\tthis._removeDependency(this._iShadowMethodVO);\n\t\t\tthis._iShadowMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iShadowMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iShadowMethodVO);\n\t\t}\n\t}\n\n\t/**\n\t * The method that provides the diffuse lighting contribution. Defaults to DiffuseBasicMethod.\n\t */\n\tpublic get diffuseMethod():DiffuseBasicMethod\n\t{\n\t\treturn this._iDiffuseMethodVO? <DiffuseBasicMethod> this._iDiffuseMethodVO.method : null;\n\t}\n\n\tpublic set diffuseMethod(value:DiffuseBasicMethod)\n\t{\n\t\tif (this._iDiffuseMethodVO && this._iDiffuseMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iDiffuseMethodVO) {\n\t\t\tthis._removeDependency(this._iDiffuseMethodVO);\n\t\t\tthis._iDiffuseMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iDiffuseMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iDiffuseMethodVO);\n\t\t}\n\t}\n\n\t/**\n\t * The method that provides the specular lighting contribution. Defaults to SpecularBasicMethod.\n\t */\n\tpublic get specularMethod():SpecularBasicMethod\n\t{\n\t\treturn this._iSpecularMethodVO? <SpecularBasicMethod> this._iSpecularMethodVO.method : null;\n\t}\n\n\tpublic set specularMethod(value:SpecularBasicMethod)\n\t{\n\t\tif (this._iSpecularMethodVO && this._iSpecularMethodVO.method == value)\n\t\t\treturn;\n\n\t\tif (this._iSpecularMethodVO) {\n\t\t\tthis._removeDependency(this._iSpecularMethodVO);\n\t\t\tthis._iSpecularMethodVO = null;\n\t\t}\n\n\t\tif (value) {\n\t\t\tthis._iSpecularMethodVO = new MethodVO(value);\n\t\t\tthis._addDependency(this._iSpecularMethodVO);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\twhile (this._iMethodVOs.length)\n\t\t\tthis._removeDependency(this._iMethodVOs[0]);\n\n\t\tthis._iMethodVOs = null;\n\t}\n\n\t/**\n\t * Called when any method's shader code is invalidated.\n\t */\n\tprivate onShaderInvalidated(event:ShadingMethodEvent)\n\t{\n\t\tthis._pInvalidatePass();\n\t}\n\n\t// RENDER LOOP\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iActivate(pass:MaterialPassData, renderer:RendererBase, camera:Camera)\n\t{\n\t\tsuper._iActivate(pass, renderer, camera);\n\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod)\n\t\t\t\tmethodVO.method.iActivate(pass.shaderObject, methodVO, renderer.stage);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t *\n\t * @param renderable\n\t * @param stage\n\t * @param camera\n\t */\n\tpublic setRenderState(pass:MaterialPassData, renderable:RenderableBase, stage:Stage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tsuper.setRenderState(pass, renderable, stage, camera, viewProjection);\n\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod)\n\t\t\t\tmethodVO.method.iSetRenderState(pass.shaderObject, methodVO, renderable, stage, camera);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iDeactivate(pass:MaterialPassData, renderer:RendererBase)\n\t{\n\t\tsuper._iDeactivate(pass, renderer);\n\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod)\n\t\t\t\tmethodVO.method.iDeactivate(pass.shaderObject, methodVO, renderer.stage);\n\t\t}\n\t}\n\n\tpublic _iIncludeDependencies(shaderObject:ShaderLightingObject)\n\t{\n\t\tvar i:number;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis.setupAndCountDependencies(shaderObject, this._iMethodVOs[i]);\n\n\t\tfor (i = 0; i < len; ++i)\n\t\t\tthis._iMethodVOs[i].useMethod = this._iMethodVOs[i].method.iIsUsed(shaderObject);\n\n\t\tsuper._iIncludeDependencies(shaderObject);\n\t}\n\n\n\t/**\n\t * Counts the dependencies for a given method.\n\t * @param method The method to count the dependencies for.\n\t * @param methodVO The method's data for this material.\n\t */\n\tprivate setupAndCountDependencies(shaderObject:ShaderObjectBase, methodVO:MethodVO)\n\t{\n\t\tmethodVO.reset();\n\n\t\tmethodVO.method.iInitVO(shaderObject, methodVO);\n\n\t\tif (methodVO.needsProjection)\n\t\t\tshaderObject.projectionDependencies++;\n\n\t\tif (methodVO.needsGlobalVertexPos) {\n\n\t\t\tshaderObject.globalPosDependencies++;\n\n\t\t\tif (methodVO.needsGlobalFragmentPos)\n\t\t\t\tshaderObject.usesGlobalPosFragment = true;\n\n\t\t} else if (methodVO.needsGlobalFragmentPos) {\n\t\t\tshaderObject.globalPosDependencies++;\n\t\t\tshaderObject.usesGlobalPosFragment = true;\n\t\t}\n\n\t\tif (methodVO.needsNormals)\n\t\t\tshaderObject.normalDependencies++;\n\n\t\tif (methodVO.needsTangents)\n\t\t\tshaderObject.tangentDependencies++;\n\n\t\tif (methodVO.needsView)\n\t\t\tshaderObject.viewDirDependencies++;\n\n\t\tif (methodVO.needsUV)\n\t\t\tshaderObject.uvDependencies++;\n\n\t\tif (methodVO.needsSecondaryUV)\n\t\t\tshaderObject.secondaryUVDependencies++;\n\t}\n\n\tpublic _iGetPreLightingVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tif (this._iAmbientMethodVO && this._iAmbientMethodVO.useMethod)\n\t\t\tcode += this._iAmbientMethodVO.method.iGetVertexCode(shaderObject, this._iAmbientMethodVO, registerCache, sharedRegisters);\n\n\t\tif (this._iDiffuseMethodVO && this._iDiffuseMethodVO.useMethod)\n\t\t\tcode += this._iDiffuseMethodVO.method.iGetVertexCode(shaderObject, this._iDiffuseMethodVO, registerCache, sharedRegisters);\n\n\t\tif (this._iSpecularMethodVO && this._iSpecularMethodVO.useMethod)\n\t\t\tcode += this._iSpecularMethodVO.method.iGetVertexCode(shaderObject, this._iSpecularMethodVO, registerCache, sharedRegisters);\n\n\t\treturn code;\n\t}\n\n\tpublic _iGetPreLightingFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tif (this._iAmbientMethodVO && this._iAmbientMethodVO.useMethod) {\n\t\t\tcode += this._iAmbientMethodVO.method.iGetFragmentCode(shaderObject, this._iAmbientMethodVO, sharedRegisters.shadedTarget, registerCache, sharedRegisters);\n\n\t\t\tif (this._iAmbientMethodVO.needsNormals)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.normalFragment);\n\n\t\t\tif (this._iAmbientMethodVO.needsView)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.viewDirFragment);\n\t\t}\n\n\t\tif (this._iDiffuseMethodVO && this._iDiffuseMethodVO.useMethod)\n\t\t\tcode += (<LightingMethodBase> this._iDiffuseMethodVO.method).iGetFragmentPreLightingCode(<ShaderLightingObject> shaderObject, this._iDiffuseMethodVO, registerCache, sharedRegisters);\n\n\t\tif (this._iSpecularMethodVO && this._iSpecularMethodVO.useMethod)\n\t\t\tcode += (<LightingMethodBase> this._iSpecularMethodVO.method).iGetFragmentPreLightingCode(<ShaderLightingObject> shaderObject, this._iSpecularMethodVO, registerCache, sharedRegisters);\n\n\t\treturn code;\n\t}\n\n\tpublic _iGetPerLightDiffuseFragmentCode(shaderObject:ShaderLightingObject, lightDirReg:ShaderRegisterElement, diffuseColorReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn (<LightingMethodBase> this._iDiffuseMethodVO.method).iGetFragmentCodePerLight(shaderObject, this._iDiffuseMethodVO, lightDirReg, diffuseColorReg, registerCache, sharedRegisters);\n\t}\n\n\tpublic _iGetPerLightSpecularFragmentCode(shaderObject:ShaderLightingObject, lightDirReg:ShaderRegisterElement, specularColorReg:ShaderRegisterElement, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn (<LightingMethodBase> this._iSpecularMethodVO.method).iGetFragmentCodePerLight(shaderObject, this._iSpecularMethodVO, lightDirReg, specularColorReg, registerCache, sharedRegisters);\n\t}\n\n\tpublic _iGetPerProbeDiffuseFragmentCode(shaderObject:ShaderLightingObject, texReg:ShaderRegisterElement, weightReg:string, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn (<LightingMethodBase> this._iDiffuseMethodVO.method).iGetFragmentCodePerProbe(shaderObject, this._iDiffuseMethodVO, texReg, weightReg, registerCache, sharedRegisters);\n\t}\n\n\tpublic _iGetPerProbeSpecularFragmentCode(shaderObject:ShaderLightingObject, texReg:ShaderRegisterElement, weightReg:string, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn (<LightingMethodBase> this._iSpecularMethodVO.method).iGetFragmentCodePerProbe(shaderObject, this._iSpecularMethodVO, texReg, weightReg, registerCache, sharedRegisters);\n\t}\n\n\tpublic _iGetPostLightingVertexCode(shaderObject:ShaderLightingObject, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tif (this._iShadowMethodVO)\n\t\t\tcode += this._iShadowMethodVO.method.iGetVertexCode(shaderObject, this._iShadowMethodVO, registerCache, sharedRegisters);\n\n\t\treturn code;\n\t}\n\n\tpublic _iGetPostLightingFragmentCode(shaderObject:ShaderLightingObject, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\n\t\tif (shaderObject.useAlphaPremultiplied && this._pEnableBlending) {\n\t\t\tcode += \"add \" + sharedRegisters.shadedTarget + \".w, \" + sharedRegisters.shadedTarget + \".w, \" + sharedRegisters.commons + \".z\\n\" +\n\t\t\t\t\"div \" + sharedRegisters.shadedTarget + \".xyz, \" + sharedRegisters.shadedTarget + \", \" + sharedRegisters.shadedTarget + \".w\\n\" +\n\t\t\t\t\"sub \" + sharedRegisters.shadedTarget + \".w, \" + sharedRegisters.shadedTarget + \".w, \" + sharedRegisters.commons + \".z\\n\" +\n\t\t\t\t\"sat \" + sharedRegisters.shadedTarget + \".xyz, \" + sharedRegisters.shadedTarget + \"\\n\";\n\t\t}\n\n\t\tif (this._iShadowMethodVO)\n\t\t\tcode += this._iShadowMethodVO.method.iGetFragmentCode(shaderObject, this._iShadowMethodVO, sharedRegisters.shadowTarget, registerCache, sharedRegisters);\n\n\t\tif (this._iDiffuseMethodVO && this._iDiffuseMethodVO.useMethod) {\n\t\t\tcode += (<LightingMethodBase> this._iDiffuseMethodVO.method).iGetFragmentPostLightingCode(shaderObject, this._iDiffuseMethodVO, sharedRegisters.shadedTarget, registerCache, sharedRegisters);\n\n\t\t\t// resolve other dependencies as well?\n\t\t\tif (this._iDiffuseMethodVO.needsNormals)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.normalFragment);\n\n\t\t\tif (this._iDiffuseMethodVO.needsView)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.viewDirFragment);\n\t\t}\n\n\t\tif (this._iSpecularMethodVO && this._iSpecularMethodVO.useMethod) {\n\t\t\tcode += (<LightingMethodBase> this._iSpecularMethodVO.method).iGetFragmentPostLightingCode(shaderObject, this._iSpecularMethodVO, sharedRegisters.shadedTarget, registerCache, sharedRegisters);\n\t\t\tif (this._iSpecularMethodVO.needsNormals)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.normalFragment);\n\t\t\tif (this._iSpecularMethodVO.needsView)\n\t\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.viewDirFragment);\n\t\t}\n\n\t\tif (this._iShadowMethodVO)\n\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.shadowTarget);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are allowed in tangent space. This is only the case if no object-space\n\t * dependencies exist.\n\t */\n\tpublic _pUsesTangentSpace(shaderObject:ShaderLightingObject):boolean\n\t{\n\t\tif (shaderObject.usesProbes)\n\t\t\treturn false;\n\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = 0; i < len; ++i) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod && !methodVO.method.iUsesTangentSpace())\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Indicates whether or not normals are output in tangent space.\n\t */\n\tpublic _pOutputsTangentNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn (<NormalBasicMethod> this._iNormalMethodVO.method).iOutputsTangentNormals();\n\t}\n\n\t/**\n\t * Indicates whether or not normals are output by the pass.\n\t */\n\tpublic _pOutputsNormals(shaderObject:ShaderObjectBase):boolean\n\t{\n\t\treturn this._iNormalMethodVO && this._iNormalMethodVO.useMethod;\n\t}\n\n\n\tpublic _iGetNormalVertexCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\treturn this._iNormalMethodVO.method.iGetVertexCode(shaderObject, this._iNormalMethodVO, registerCache, sharedRegisters);\n\t}\n\n\tpublic _iGetNormalFragmentCode(shaderObject:ShaderObjectBase, registerCache:ShaderRegisterCache, sharedRegisters:ShaderRegisterData):string\n\t{\n\t\tvar code:string = this._iNormalMethodVO.method.iGetFragmentCode(shaderObject, this._iNormalMethodVO, sharedRegisters.normalFragment, registerCache, sharedRegisters);\n\n\t\tif (this._iNormalMethodVO.needsView)\n\t\t\tregisterCache.removeFragmentTempUsage(sharedRegisters.viewDirFragment);\n\n\t\tif (this._iNormalMethodVO.needsGlobalFragmentPos || this._iNormalMethodVO.needsGlobalVertexPos)\n\t\t\tregisterCache.removeVertexTempUsage(sharedRegisters.globalPositionVertex);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetVertexCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = len - this._numEffectDependencies; i < len; i++) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod) {\n\t\t\t\tcode += methodVO.method.iGetVertexCode(shaderObject, methodVO, regCache, sharedReg);\n\n\t\t\t\tif (methodVO.needsGlobalVertexPos || methodVO.needsGlobalFragmentPos)\n\t\t\t\t\tregCache.removeVertexTempUsage(sharedReg.globalPositionVertex);\n\t\t\t}\n\t\t}\n\n\t\tif (this._iColorTransformMethodVO && this._iColorTransformMethodVO.useMethod)\n\t\t\tcode += this._iColorTransformMethodVO.method.iGetVertexCode(shaderObject, this._iColorTransformMethodVO, regCache, sharedReg);\n\n\t\treturn code;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iGetFragmentCode(shaderObject:ShaderObjectBase, regCache:ShaderRegisterCache, sharedReg:ShaderRegisterData):string\n\t{\n\t\tvar code:string = \"\";\n\t\tvar alphaReg:ShaderRegisterElement;\n\n\t\tif (this.preserveAlpha && this._numEffectDependencies > 0) {\n\t\t\talphaReg = regCache.getFreeFragmentSingleTemp();\n\t\t\tregCache.addFragmentTempUsages(alphaReg, 1);\n\t\t\tcode += \"mov \" + alphaReg + \", \" + sharedReg.shadedTarget + \".w\\n\";\n\t\t}\n\n\t\tvar methodVO:MethodVO;\n\t\tvar len:number = this._iMethodVOs.length;\n\t\tfor (var i:number = len - this._numEffectDependencies; i < len; i++) {\n\t\t\tmethodVO = this._iMethodVOs[i];\n\t\t\tif (methodVO.useMethod) {\n\t\t\t\tcode += methodVO.method.iGetFragmentCode(shaderObject, methodVO, sharedReg.shadedTarget, regCache, sharedReg);\n\n\t\t\t\tif (methodVO.needsNormals)\n\t\t\t\t\tregCache.removeFragmentTempUsage(sharedReg.normalFragment);\n\n\t\t\t\tif (methodVO.needsView)\n\t\t\t\t\tregCache.removeFragmentTempUsage(sharedReg.viewDirFragment);\n\n\t\t\t}\n\t\t}\n\n\t\tif (this.preserveAlpha && this._numEffectDependencies > 0) {\n\t\t\tcode += \"mov \" + sharedReg.shadedTarget + \".w, \" + alphaReg + \"\\n\";\n\t\t\tregCache.removeFragmentTempUsage(alphaReg);\n\t\t}\n\n\t\tif (this._iColorTransformMethodVO && this._iColorTransformMethodVO.useMethod)\n\t\t\tcode += this._iColorTransformMethodVO.method.iGetFragmentCode(shaderObject, this._iColorTransformMethodVO, sharedReg.shadedTarget, regCache, sharedReg);\n\n\t\treturn code;\n\t}\n\t/**\n\t * Indicates whether the shader uses any shadows.\n\t */\n\tpublic _iUsesShadows():boolean\n\t{\n\t\treturn Boolean(this._iShadowMethodVO || this.lightPicker.castingDirectionalLights.length > 0 || this.lightPicker.castingPointLights.length > 0);\n\t}\n\n\t/**\n\t * Indicates whether the shader uses any specular component.\n\t */\n\tpublic _iUsesSpecular():boolean\n\t{\n\t\treturn Boolean(this._iSpecularMethodVO);\n\t}\n}\n\nexport = TriangleMethodPass;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport BitmapTexture\t\t\t\t= require(\"awayjs-core/lib/textures/BitmapTexture\");\n\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\n\nimport LineBasicMaterial\t\t\t= require(\"awayjs-renderergl/lib/materials/LineBasicMaterial\");\nimport TriangleBasicMaterial\t\t= require(\"awayjs-renderergl/lib/materials/TriangleBasicMaterial\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\n\nclass DefaultMaterialManager\n{\n\tprivate static _defaultBitmapData:BitmapData;\n\tprivate static _defaultTriangleMaterial:TriangleBasicMaterial;\n\tprivate static _defaultLineMaterial:LineBasicMaterial;\n\tprivate static _defaultTexture:BitmapTexture;\n\n\tpublic static getDefaultMaterial(materialOwner:IMaterialOwner = null):StageGLMaterialBase\n\t{\n\t\tif (materialOwner != null && materialOwner.assetType == AssetType.LINE_SUB_MESH) {\n\t\t\tif (!DefaultMaterialManager._defaultLineMaterial)\n\t\t\t\tDefaultMaterialManager.createDefaultLineMaterial();\n\n\t\t\treturn DefaultMaterialManager._defaultLineMaterial;\n\t\t} else {\n\t\t\tif (!DefaultMaterialManager._defaultTriangleMaterial)\n\t\t\t\tDefaultMaterialManager.createDefaultTriangleMaterial();\n\n\t\t\treturn DefaultMaterialManager._defaultTriangleMaterial;\n\t\t}\n\t}\n\n\tpublic static getDefaultTexture(materialOwner:IMaterialOwner = null):BitmapTexture\n\t{\n\t\tif (!DefaultMaterialManager._defaultTexture)\n\t\t\tDefaultMaterialManager.createDefaultTexture();\n\n\t\treturn DefaultMaterialManager._defaultTexture;\n\t}\n\n\tprivate static createDefaultTexture()\n\t{\n\t\tDefaultMaterialManager._defaultBitmapData = DefaultMaterialManager.createCheckeredBitmapData();\n\t\tDefaultMaterialManager._defaultTexture = new BitmapTexture(DefaultMaterialManager._defaultBitmapData, true);\n\t\tDefaultMaterialManager._defaultTexture.name = \"defaultTexture\";\n\t}\n\n\tpublic static createCheckeredBitmapData():BitmapData\n\t{\n\t\tvar b:BitmapData = new BitmapData(8, 8, false, 0x000000);\n\n\t\t//create chekerboard\n\t\tvar i:number, j:number;\n\t\tfor (i = 0; i < 8; i++) {\n\t\t\tfor (j = 0; j < 8; j++) {\n\t\t\t\tif ((j & 1) ^ (i & 1)) {\n\t\t\t\t\tb.setPixel(i, j, 0XFFFFFF);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn b;\n\t}\n\n\tprivate static createDefaultTriangleMaterial()\n\t{\n\t\tif (!DefaultMaterialManager._defaultTexture)\n\t\t\tDefaultMaterialManager.createDefaultTexture();\n\n\t\tDefaultMaterialManager._defaultTriangleMaterial = new TriangleBasicMaterial(DefaultMaterialManager._defaultTexture);\n\t\tDefaultMaterialManager._defaultTriangleMaterial.mipmap = false;\n\t\tDefaultMaterialManager._defaultTriangleMaterial.smooth = false;\n\t\tDefaultMaterialManager._defaultTriangleMaterial.name = \"defaultTriangleMaterial\";\n\t}\n\n\tprivate static createDefaultLineMaterial()\n\t{\n\t\tDefaultMaterialManager._defaultLineMaterial = new LineBasicMaterial();\n\t\tDefaultMaterialManager._defaultLineMaterial.name = \"defaultSegmentMaterial\";\n\t}\n}\n\nexport = DefaultMaterialManager;",
    "import TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\n\nimport ShaderRegisterData\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterData\");\nimport ShaderRegisterElement\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderRegisterElement\");\n\nclass ShaderCompilerHelper\n{\n\t/**\n\t * A helper method that generates standard code for sampling from a texture using the normal uv coordinates.\n\t * @param vo The MethodVO object linking this method with the pass currently being compiled.\n\t * @param sharedReg The shared register object for the shader.\n\t * @param inputReg The texture stream register.\n\t * @param texture The texture which will be assigned to the given slot.\n\t * @param uvReg An optional uv register if coordinates different from the primary uv coordinates are to be used.\n\t * @param forceWrap If true, texture wrapping is enabled regardless of the material setting.\n\t * @return The fragment code that performs the sampling.\n\t *\n\t * @protected\n\t */\n\tpublic static getTex2DSampleCode(targetReg:ShaderRegisterElement, sharedReg:ShaderRegisterData, inputReg:ShaderRegisterElement, texture:TextureProxyBase, smooth:boolean, repeat:boolean, mipmaps:boolean, uvReg:ShaderRegisterElement = null, forceWrap:string = null):string\n\t{\n\t\tvar wrap:string = forceWrap || (repeat? \"wrap\":\"clamp\");\n\t\tvar format:string = ShaderCompilerHelper.getFormatStringForTexture(texture);\n\t\tvar enableMipMaps:boolean = mipmaps && texture.hasMipmaps;\n\t\tvar filter:string = (smooth)? (enableMipMaps? \"linear,miplinear\" : \"linear\") : (enableMipMaps? \"nearest,mipnearest\" : \"nearest\");\n\n\t\tif (uvReg == null)\n\t\t\tuvReg = sharedReg.uvVarying;\n\n\t\treturn \"tex \" + targetReg + \", \" + uvReg + \", \" + inputReg + \" <2d,\" + filter + \",\" + format + wrap + \">\\n\";\n\n\t}\n\n\n\t/**\n\t * A helper method that generates standard code for sampling from a cube texture.\n\t * @param vo The MethodVO object linking this method with the pass currently being compiled.\n\t * @param targetReg The register in which to store the sampled colour.\n\t * @param inputReg The texture stream register.\n\t * @param texture The cube map which will be assigned to the given slot.\n\t * @param uvReg The direction vector with which to sample the cube map.\n\t *\n\t * @protected\n\t */\n\tpublic static getTexCubeSampleCode(targetReg:ShaderRegisterElement, inputReg:ShaderRegisterElement, texture:TextureProxyBase, smooth:boolean, mipmaps:boolean, uvReg:ShaderRegisterElement):string\n\t{\n\t\tvar filter:string;\n\t\tvar format:string = ShaderCompilerHelper.getFormatStringForTexture(texture);\n\t\tvar enableMipMaps:boolean = mipmaps && texture.hasMipmaps;\n\t\tvar filter:string = (smooth)? (enableMipMaps? \"linear,miplinear\" : \"linear\") : (enableMipMaps? \"nearest,mipnearest\" : \"nearest\");\n\n\t\treturn \"tex \" + targetReg + \", \" + uvReg + \", \" + inputReg + \" <cube,\" + format + filter + \">\\n\";\n\t}\n\n\t/**\n\t * Generates a texture format string for the sample instruction.\n\t * @param texture The texture for which to get the format string.\n\t * @return\n\t *\n\t * @protected\n\t */\n\tpublic static getFormatStringForTexture(texture:TextureProxyBase):string\n\t{\n\t\tswitch (texture.format) {\n\t\t\tcase ContextGLTextureFormat.COMPRESSED:\n\t\t\t\treturn \"dxt1,\";\n\t\t\t\tbreak;\n\t\t\tcase ContextGLTextureFormat.COMPRESSED_ALPHA:\n\t\t\t\treturn \"dxt5,\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn \"\";\n\t\t}\n\t}\n}\n\nexport = ShaderCompilerHelper;",
    "import SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * @class away.pool.RenderableListItem\n */\nclass BillboardRenderable extends RenderableBase\n{\n\tprivate static _materialGeometry:Object = new Object();\n\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"billboard\";\n\n\t/**\n\t *\n\t */\n\tprivate _billboard:Billboard;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param billboard\n\t */\n\tconstructor(pool:RenderablePool, billboard:Billboard)\n\t{\n\t\tsuper(pool, billboard, billboard);\n\n\t\tthis._billboard = billboard;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t */\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tvar material:MaterialBase = this._billboard.material;\n\n\t\tvar geometry:TriangleSubGeometry = BillboardRenderable._materialGeometry[material.id];\n\n\t\tif (!geometry) {\n\t\t\tgeometry = BillboardRenderable._materialGeometry[material.id] = new TriangleSubGeometry(true);\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.updateIndices(Array<number>(0, 1, 2, 0, 2, 3));\n\t\t\tgeometry.updatePositions(Array<number>(0, material.height, 0, material.width, material.height, 0, material.width, 0, 0, 0, 0, 0));\n\t\t\tgeometry.updateVertexNormals(Array<number>(1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0));\n\t\t\tgeometry.updateVertexTangents(Array<number>(0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1));\n\t\t\tgeometry.updateUVs(Array<number>(0, 0, 1, 0, 1, 1, 0, 1));\n\t\t} else {\n\t\t\tgeometry.updatePositions(Array<number>(0, material.height, 0, material.width, material.height, 0, material.width, 0, 0, 0, 0, 0));\n\t\t}\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.NORMAL_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.TANGENT_DATA] = true;\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.UV_DATA] = true;\n\n\t\treturn geometry;\n\t}\n}\n\nexport = BillboardRenderable;",
    "import IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport LineSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/LineSubGeometry\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * @class away.pool.LineSubMeshRenderable\n */\nclass LineSubMeshRenderable extends RenderableBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"linesubmesh\";\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:LineSubMesh;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param dataOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:LineSubMesh, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, level, indexOffset);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {base.LineSubGeometry}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():LineSubGeometry\n\t{\n\t\tvar subGeometry:LineSubGeometry = this.subMesh.subGeometry;\n\n\t\tthis._pVertexDataDirty[LineSubGeometry.START_POSITION_DATA] = true;\n\t\tthis._pVertexDataDirty[LineSubGeometry.END_POSITION_DATA] = true;\n\n\t\tif (subGeometry.thickness)\n\t\t\tthis._pVertexDataDirty[LineSubGeometry.THICKNESS_DATA] = true;\n\n\t\tif (subGeometry.startColors)\n\t\t\tthis._pVertexDataDirty[LineSubGeometry.COLOR_DATA] = true;\n\n\t\treturn subGeometry;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param materialOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.LineSubMeshRenderable}\n\t * @private\n\t */\n\tpublic _pGetOverflowRenderable(pool:RenderablePool, materialOwner:IMaterialOwner, level:number, indexOffset:number):RenderableBase\n\t{\n\t\treturn new LineSubMeshRenderable(pool, <LineSubMesh> materialOwner, level, indexOffset);\n\t}\n}\n\nexport = LineSubMeshRenderable;",
    "import IMaterialData\t\t\t\t= require(\"awayjs-display/lib/pool/IMaterialData\");\n\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\n\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport ShaderCompilerBase\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderCompilerBase\");\nimport MaterialDataPool\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialDataPool\");\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport MaterialPassDataPool\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassDataPool\");\n\n/**\n *\n * @class away.pool.MaterialData\n */\nclass MaterialData implements IMaterialData\n{\n\tprivate _pool:MaterialDataPool;\n\n\tprivate _materialPassDataPool:MaterialPassDataPool;\n\n\tprivate _passes:Array<MaterialPassData>;\n\n\tpublic material:StageGLMaterialBase;\n\n\tpublic renderOrderId:number;\n\n\tpublic invalidAnimation:boolean = true;\n\n\tconstructor(pool:MaterialDataPool, material:StageGLMaterialBase)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.material = material;\n\n\t\tthis._materialPassDataPool = new MaterialPassDataPool(material);\n\t}\n\n\tpublic getMaterialPass(materialPass:MaterialPassBase, profile:string):MaterialPassData\n\t{\n\t\tvar materialPassData:MaterialPassData = this._materialPassDataPool.getItem(materialPass);\n\n\t\tif (!materialPassData.shaderObject) {\n\t\t\tmaterialPassData.shaderObject = materialPass.createShaderObject(profile);\n\t\t\tmaterialPassData.invalid = true;\n\t\t}\n\n\t\tif (materialPassData.invalid) {\n\t\t\tmaterialPassData.invalid = false;\n\t\t\tvar compiler:ShaderCompilerBase = materialPassData.shaderObject.createCompiler(this.material, materialPass);\n\t\t\tcompiler.compile();\n\n\t\t\tmaterialPassData.shadedTarget = compiler.shadedTarget;\n\t\t\tmaterialPassData.vertexCode = compiler.vertexCode;\n\t\t\tmaterialPassData.fragmentCode = compiler.fragmentCode;\n\t\t\tmaterialPassData.postAnimationFragmentCode = compiler.postAnimationFragmentCode;\n\t\t\tmaterialPassData.key = \"\";\n\t\t}\n\n\t\treturn materialPassData;\n\t}\n\n\tpublic getMaterialPasses(profile:string):Array<MaterialPassData>\n\t{\n\t\tif (this._passes == null) {\n\t\t\tvar passes:Array<MaterialPassBase> = <Array<MaterialPassBase>> this.material._iScreenPasses;\n\t\t\tvar numPasses:number = passes.length;\n\n\t\t\t//reset the material passes in MaterialData\n\t\t\tthis._passes = new Array<MaterialPassData>(numPasses);\n\n\t\t\t//get the shader object for each screen pass and store\n\t\t\tfor (var i:number = 0; i < numPasses; i++)\n\t\t\t\tthis._passes[i] = this.getMaterialPass(passes[i], profile);\n\t\t}\n\n\t\treturn this._passes;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._materialPassDataPool.disposePool();\n\n\t\tthis._materialPassDataPool = null;\n\n\t\tthis._pool.disposeItem(this.material);\n\n\t\tthis._passes = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateMaterial()\n\t{\n\t\tthis._passes = null;\n\n\t\tthis.invalidateAnimation();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateAnimation()\n\t{\n\t\tthis.invalidAnimation = true;\n\t}\n}\n\nexport = MaterialData;",
    "import ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\n\nimport MaterialData\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialData\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\n\n/**\n * @class away.pool.MaterialDataPool\n */\nclass MaterialDataPool\n{\n\tprivate _pool:Object = new Object();\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor()\n\t{\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(material:StageGLMaterialBase):MaterialData\n\t{\n\t\treturn (this._pool[material.id] || (this._pool[material.id] = material._iAddMaterialData(new MaterialData(this, material))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(material:StageGLMaterialBase)\n\t{\n\t\tmaterial._iRemoveMaterialData(this._pool[material.id]);\n\n\t\tthis._pool[material.id] = null;\n\t}\n}\n\nexport = MaterialDataPool;",
    "import IMaterialPassData\t\t\t= require(\"awayjs-display/lib/pool/IMaterialPassData\");\n\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\n\nimport MaterialPassDataPool\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassDataPool\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\n\n/**\n *\n * @class away.pool.MaterialPassData\n */\nclass MaterialPassData implements IMaterialPassData\n{\n\tprivate _pool:MaterialPassDataPool;\n\n\tpublic material:StageGLMaterialBase;\n\n\tpublic shaderObject:ShaderObjectBase;\n\n\tpublic materialPass:MaterialPassBase;\n\n\tpublic programData:ProgramData;\n\n\tpublic shadedTarget:string;\n\n\tpublic vertexCode:string;\n\n\tpublic postAnimationFragmentCode:string;\n\n\tpublic fragmentCode:string;\n\n\tpublic animationVertexCode:string = \"\";\n\n\tpublic animationFragmentCode:string = \"\";\n\n\tpublic key:string;\n\n\tpublic invalid:boolean;\n\n\tpublic usesAnimation:boolean;\n\n\tconstructor(pool:MaterialPassDataPool, material:StageGLMaterialBase, materialPass:MaterialPassBase)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.material = material;\n\t\tthis.materialPass = materialPass;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.materialPass);\n\n\t\tthis.shaderObject.dispose();\n\t\tthis.shaderObject = null;\n\n\t\tthis.programData.dispose();\n\t\tthis.programData = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n}\n\nexport = MaterialPassData;",
    "import MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\n\n/**\n * @class away.pool.MaterialPassDataPool\n */\nclass MaterialPassDataPool\n{\n\tprivate _pool:Object = new Object();\n\tprivate _material:StageGLMaterialBase;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(material:StageGLMaterialBase)\n\t{\n\t\tthis._material = material;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(materialPass:MaterialPassBase):MaterialPassData\n\t{\n\t\treturn (this._pool[materialPass.id] || (this._pool[materialPass.id] = this._material._iAddMaterialPassData(materialPass._iAddMaterialPassData(new MaterialPassData(this, this._material, materialPass)))));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(materialPass:MaterialPassBase)\n\t{\n\t\tmaterialPass._iRemoveMaterialPassData(this._pool[materialPass.id]);\n\n\t\tdelete this._pool[materialPass.id];\n\t}\n\n\tpublic disposePool()\n\t{\n\t\tfor (var id in this._pool)\n\t\t\t(<MaterialPassData> this._pool[id]).materialPass._iRemoveMaterialPassData(this._pool[id]);\n\n\t\tdelete this._pool;\n\t}\n}\n\nexport = MaterialPassDataPool;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\nimport IndexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexData\");\nimport IndexDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexDataPool\");\nimport VertexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexData\");\nimport VertexDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexDataPool\");\n\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\n\n/**\n * @class RenderableListItem\n */\nclass RenderableBase implements IRenderable\n{\n\tprivate _onIndicesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _onVerticesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _geometryDirty:boolean = true;\n\tprivate _indexData:IndexData;\n\tprivate _indexDataDirty:boolean = true;\n\tprivate _vertexData:Object = new Object();\n\tpublic _pVertexDataDirty:Object = new Object();\n\tprivate _vertexOffset:Object = new Object();\n\n\tprivate _level:number;\n\tprivate _indexOffset:number;\n\tprivate _overflow:RenderableBase;\n\tprivate _numTriangles:number;\n\tprivate _concatenateArrays:boolean;\n\n\n\tpublic JOINT_INDEX_FORMAT:string;\n\tpublic JOINT_WEIGHT_FORMAT:string;\n\n\t/**\n\t *\n\t */\n\tpublic _pool:RenderablePool;\n\n\t/**\n\t *\n\t */\n\tpublic get overflow():RenderableBase\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\treturn this._overflow;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get numTriangles():number\n\t{\n\t\treturn this._numTriangles;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic next:RenderableBase;\n\n\t/**\n\t *\n\t */\n\tpublic materialId:number;\n\n\t/**\n\t *\n\t */\n\tpublic renderOrderId:number;\n\n\t/**\n\t *\n\t */\n\tpublic zIndex:number;\n\n\t/**\n\t *\n\t */\n\tpublic cascaded:boolean;\n\n\t/**\n\t *\n\t */\n\tpublic renderSceneTransform:Matrix3D;\n\n\t/**\n\t *\n\t */\n\tpublic sourceEntity:IEntity;\n\n\t/**\n\t *\n\t */\n\tpublic materialOwner:IMaterialOwner;\n\n\t/**\n\t *\n\t */\n\tpublic material:StageGLMaterialBase;\n\n\t/**\n\t *\n\t */\n\tpublic getIndexData():IndexData\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\treturn this._indexData;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVertexData(dataType:string):VertexData\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\tif (this._pVertexDataDirty[dataType])\n\t\t\tthis._updateVertexData(dataType);\n\n\t\treturn this._vertexData[this._concatenateArrays? TriangleSubGeometry.VERTEX_DATA : dataType]\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic getVertexOffset(dataType:string):number\n\t{\n\t\tif (this._indexDataDirty)\n\t\t\tthis._updateIndexData();\n\n\t\tif (this._pVertexDataDirty[dataType])\n\t\t\tthis._updateVertexData(dataType);\n\n\t\treturn this._vertexOffset[dataType];\n\t}\n\n\t/**\n\t *\n\t * @param sourceEntity\n\t * @param materialOwner\n\t * @param subGeometry\n\t * @param animationSubGeometry\n\t */\n\tconstructor(pool:RenderablePool, sourceEntity:IEntity, materialOwner:IMaterialOwner, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tthis._onIndicesUpdatedDelegate = (event:SubGeometryEvent) => this._onIndicesUpdated(event);\n\t\tthis._onVerticesUpdatedDelegate = (event:SubGeometryEvent) => this._onVerticesUpdated(event);\n\n\t\t//store a reference to the pool for later disposal\n\t\tthis._pool = pool;\n\n\t\t//reference to level of overflow\n\t\tthis._level = level;\n\n\t\t//reference to the offset on indices (if this is an overflow renderable)\n\t\tthis._indexOffset = indexOffset;\n\n\t\tthis.sourceEntity = sourceEntity;\n\t\tthis.materialOwner = materialOwner;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.materialOwner);\n\n\t\tthis._indexData.dispose();\n\t\tthis._indexData = null;\n\n\t\tfor (var dataType in this._vertexData) {\n\t\t\t(<VertexData> this._vertexData[dataType]).dispose();\n\t\t\tthis._vertexData[dataType] = null;\n\t\t}\n\n\t\tif (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\tpublic invalidateGeometry()\n\t{\n\t\tthis._geometryDirty = true;\n\n\t\t//invalidate indices\n\t\tif (this._level == 0)\n\t\t\tthis._indexDataDirty = true;\n\n\t\tif (this._overflow)\n\t\t\tthis._overflow.invalidateGeometry();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidateIndexData()\n\t{\n\t\tthis._indexDataDirty = true;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param dataType\n\t */\n\tpublic invalidateVertexData(dataType:string)\n\t{\n\t\tthis._pVertexDataDirty[dataType] = true;\n\t}\n\n\tpublic _pGetSubGeometry():SubGeometryBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param subGeometry\n\t * @param offset\n\t * @internal\n\t */\n\tpublic _iFillIndexData(indexOffset:number)\n\t{\n\t\tif (this._geometryDirty)\n\t\t\tthis._updateGeometry();\n\n\t\tthis._indexData = IndexDataPool.getItem(this._subGeometry, this._level, indexOffset);\n\n\t\tthis._numTriangles = this._indexData.data.length/3;\n\n\t\tindexOffset = this._indexData.offset;\n\n\t\t//check if there is more to split\n\t\tif (indexOffset < this._subGeometry.indices.length) {\n\t\t\tif (!this._overflow)\n\t\t\t\tthis._overflow = this._pGetOverflowRenderable(this._pool, this.materialOwner, indexOffset, this._level + 1);\n\n\t\t\tthis._overflow._iFillIndexData(indexOffset);\n\t\t} else if (this._overflow) {\n\t\t\tthis._overflow.dispose();\n\t\t\tthis._overflow = null;\n\t\t}\n\t}\n\n\tpublic _pGetOverflowRenderable(pool:RenderablePool, materialOwner:IMaterialOwner, level:number, indexOffset:number):RenderableBase\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateGeometry()\n\t{\n\t\tif (this._subGeometry) {\n\t\t\tif (this._level == 0)\n\t\t\t\tthis._subGeometry.removeEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\t\t\tthis._subGeometry.removeEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\t\t}\n\n\t\tthis._subGeometry = this._pGetSubGeometry();\n\n\t\tthis._concatenateArrays = this._subGeometry.concatenateArrays;\n\n\t\tif (this._subGeometry) {\n\t\t\tif (this._level == 0)\n\t\t\t\tthis._subGeometry.addEventListener(SubGeometryEvent.INDICES_UPDATED, this._onIndicesUpdatedDelegate);\n\t\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\t\t}\n\n\t\t//dispose\n//\t\t\tif (this._indexData) {\n//\t\t\t\tthis._indexData.dispose(); //TODO where is a good place to dispose?\n//\t\t\t\tthis._indexData = null;\n//\t\t\t}\n\n//\t\t\tfor (var dataType in this._vertexData) {\n//\t\t\t\t(<VertexData> this._vertexData[dataType]).dispose(); //TODO where is a good place to dispose?\n//\t\t\t\tthis._vertexData[dataType] = null;\n//\t\t\t}\n\n\t\tthis._geometryDirty = false;\n\n\t\t//specific vertex data types have to be invalidated in the specific renderable\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @private\n\t */\n\tprivate _updateIndexData()\n\t{\n\t\tthis._iFillIndexData(this._indexOffset);\n\n\t\tthis._indexDataDirty = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param dataType\n\t * @private\n\t */\n\tprivate _updateVertexData(dataType:string)\n\t{\n\t\tthis._vertexOffset[dataType] = this._subGeometry.getOffset(dataType);\n\n\t\tif (this._subGeometry.concatenateArrays)\n\t\t\tdataType = SubGeometryBase.VERTEX_DATA;\n\n\t\tthis._vertexData[dataType] = VertexDataPool.getItem(this._subGeometry, this.getIndexData(), dataType);\n\n\t\tthis._pVertexDataDirty[dataType] = false;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onIndicesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis.invalidateIndexData();\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesUpdated(event:SubGeometryEvent)\n\t{\n\t\tthis._concatenateArrays = (<SubGeometryBase> event.target).concatenateArrays;\n\n\t\tthis.invalidateVertexData(event.dataType);\n\t}\n}\n\nexport = RenderableBase;",
    "import TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * @class away.pool.SkyboxRenderable\n */\nclass SkyboxRenderable extends RenderableBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"skybox\";\n\n\t/**\n\t *\n\t */\n\tprivate static _geometry:TriangleSubGeometry;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param skybox\n\t */\n\tconstructor(pool:RenderablePool, skybox:Skybox)\n\t{\n\t\tsuper(pool, skybox, skybox);\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @returns {away.base.TriangleSubGeometry}\n\t * @private\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar geometry:TriangleSubGeometry = SkyboxRenderable._geometry;\n\n\t\tif (!geometry) {\n\t\t\tgeometry = SkyboxRenderable._geometry = new TriangleSubGeometry(true);\n\t\t\tgeometry.autoDeriveNormals = false;\n\t\t\tgeometry.autoDeriveTangents = false;\n\t\t\tgeometry.updateIndices(Array<number>(0, 1, 2, 2, 3, 0, 6, 5, 4, 4, 7, 6, 2, 6, 7, 7, 3, 2, 4, 5, 1, 1, 0, 4, 4, 0, 3, 3, 7, 4, 2, 1, 5, 5, 6, 2));\n\t\t\tgeometry.updatePositions(Array<number>(-1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1));\n\t\t}\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\n\t\treturn geometry;\n\t}\n}\n\nexport = SkyboxRenderable;",
    "import IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport TriangleSubGeometry\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\n\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\n\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\n\n/**\n * @class away.pool.TriangleSubMeshRenderable\n */\nclass TriangleSubMeshRenderable extends RenderableBase\n{\n\t/**\n\t *\n\t */\n\tpublic static id:string = \"trianglesubmesh\";\n\n\t/**\n\t *\n\t */\n\tpublic subMesh:TriangleSubMesh;\n\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param subMesh\n\t * @param level\n\t * @param indexOffset\n\t */\n\tconstructor(pool:RenderablePool, subMesh:TriangleSubMesh, level:number = 0, indexOffset:number = 0)\n\t{\n\t\tsuper(pool, subMesh.parentMesh, subMesh, level, indexOffset);\n\n\t\tthis.subMesh = subMesh;\n\t}\n\n\t/**\n\t *\n\t * @returns {SubGeometryBase}\n\t * @protected\n\t */\n\tpublic _pGetSubGeometry():TriangleSubGeometry\n\t{\n\t\tvar subGeometry:TriangleSubGeometry;\n\n\t\tif (this.subMesh.animator)\n\t\t\tsubGeometry = <TriangleSubGeometry> this.subMesh.animator.getRenderableSubGeometry(this, this.subMesh.subGeometry);\n\t\telse\n\t\t\tsubGeometry = this.subMesh.subGeometry;\n\n\t\tthis._pVertexDataDirty[TriangleSubGeometry.POSITION_DATA] = true;\n\n\t\tif (subGeometry.vertexNormals)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.NORMAL_DATA] = true;\n\n\t\tif (subGeometry.vertexTangents)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.TANGENT_DATA] = true;\n\n\t\tif (subGeometry.uvs)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.UV_DATA] = true;\n\n\t\tif (subGeometry.secondaryUVs)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.SECONDARY_UV_DATA] = true;\n\n\t\tif (subGeometry.jointIndices)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.JOINT_INDEX_DATA] = true;\n\n\t\tif (subGeometry.jointWeights)\n\t\t\tthis._pVertexDataDirty[TriangleSubGeometry.JOINT_WEIGHT_DATA] = true;\n\n\t\tswitch(subGeometry.jointsPerVertex) {\n\t\t\tcase 1:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_1;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_2;\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_3;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tthis.JOINT_INDEX_FORMAT = this.JOINT_WEIGHT_FORMAT = ContextGLVertexBufferFormat.FLOAT_4;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\n\t\treturn subGeometry;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param pool\n\t * @param materialOwner\n\t * @param level\n\t * @param indexOffset\n\t * @returns {away.pool.TriangleSubMeshRenderable}\n\t * @protected\n\t */\n\tpublic _pGetOverflowRenderable(pool:RenderablePool, materialOwner:IMaterialOwner, level:number, indexOffset:number):RenderableBase\n\t{\n\t\treturn new TriangleSubMeshRenderable(pool, <TriangleSubMesh> materialOwner, level, indexOffset);\n\t}\n}\n\nexport = TriangleSubMeshRenderable;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport RenderTexture\t\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport IMaterialPass\t\t\t\t= require(\"awayjs-display/lib/materials/passes/IMaterialPass\");\nimport ShadowMapperBase\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-stagegl/lib/filters/Filter3DBase\");\nimport StageManager\t\t\t\t\t= require(\"awayjs-stagegl/lib/managers/StageManager\");\n\nimport MaterialData\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialData\");\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport SkyboxRenderable\t\t\t\t= require(\"awayjs-renderergl/lib/pool/SkyboxRenderable\");\nimport DepthRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/render/DepthRenderer\");\nimport Filter3DRenderer\t\t\t\t= require(\"awayjs-renderergl/lib/render/Filter3DRenderer\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport DepthMapPass\t\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/DepthMapPass\");\nimport DistanceMapPass\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/DistanceMapPass\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\n\n/**\n * The DefaultRenderer class provides the default rendering method. It renders the scene graph objects using the\n * materials assigned to them.\n *\n * @class away.render.DefaultRenderer\n */\nclass DefaultRenderer extends RendererBase implements IRenderer\n{\n\tpublic _pRequireDepthRender:boolean;\n\tprivate _skyboxRenderablePool:RenderablePool;\n\n//\t\tprivate _activeMaterial:MaterialBase;\n\tprivate _pDistanceRenderer:DepthRenderer;\n\tprivate _pDepthRenderer:DepthRenderer;\n\tprivate _skyboxProjection:Matrix3D = new Matrix3D();\n\tpublic _pFilter3DRenderer:Filter3DRenderer;\n\n\tpublic _pDepthRender:TextureProxyBase;\n\n\tprivate _antiAlias:number;\n\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(value:number)\n\t{\n\t\tif (this._antiAlias == value)\n\t\t\treturn;\n\n\t\tthis._antiAlias = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get depthPrepass():boolean\n\t{\n\t\treturn this._depthPrepass;\n\t}\n\n\tpublic set depthPrepass(value:boolean)\n\t{\n\t\tthis._depthPrepass = value;\n\t}\n\n\t/**\n\t *\n\t * @returns {*}\n\t */\n\tpublic get filters3d():Array<Filter3DBase>\n\t{\n\t\treturn this._pFilter3DRenderer? this._pFilter3DRenderer.filters : null;\n\t}\n\tpublic set filters3d(value:Array<Filter3DBase>)\n\t{\n\t\tif (value && value.length == 0)\n\t\t\tvalue = null;\n\n\t\tif (this._pFilter3DRenderer && !value) {\n\t\t\tthis._pFilter3DRenderer.dispose();\n\t\t\tthis._pFilter3DRenderer = null;\n\t\t} else if (!this._pFilter3DRenderer && value) {\n\t\t\tthis._pFilter3DRenderer = new Filter3DRenderer(this._pStage);\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t}\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis._pFilter3DRenderer.filters = value;\n\t\t\tthis._pRequireDepthRender = this._pFilter3DRenderer.requireDepthRender;\n\t\t} else {\n\t\t\tthis._pRequireDepthRender = false;\n\n\t\t\tif (this._pDepthRender) {\n\t\t\t\tthis._pDepthRender.dispose();\n\t\t\t\tthis._pDepthRender = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Creates a new DefaultRenderer object.\n\t *\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param renderMode The render mode to use.\n\t */\n\tconstructor(forceSoftware:boolean = false, profile:string = \"baseline\", mode = \"auto\")\n\t{\n\t\tsuper();\n\n\t\tthis._skyboxRenderablePool = RenderablePool.getPool(SkyboxRenderable);\n\n\t\tthis._pDepthRenderer = new DepthRenderer(new DepthMapPass());\n\t\tthis._pDistanceRenderer = new DepthRenderer(new DistanceMapPass());\n\n\t\tif (this._pStage == null)\n\t\t\tthis.stage = StageManager.getInstance().getFreeStage(forceSoftware, profile, mode);\n\n\t\tthis._pRttBufferManager = RTTBufferManager.getInstance(this._pStage);\n\n\t\tif (this._width == 0)\n\t\t\tthis.width = window.innerWidth;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewWidth = this._width;\n\n\t\tif (this._height == 0)\n\t\t\tthis.height = window.innerHeight;\n\t\telse\n\t\t\tthis._pRttBufferManager.viewHeight = this._height;\n\t}\n\n\tpublic render(entityCollector:ICollector)\n\t{\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._pStage.recoverFromDisposal()) {//if context has Disposed by the OS,don't render at this frame\n\t\t\tthis._pBackBufferInvalid = true;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._pBackBufferInvalid)// reset or update render settings\n\t\t\tthis.pUpdateBackBuffer();\n\n\t\tif (this._shareContext && this._pContext)\n\t\t\tthis._pContext.clear(0, 0, 0, 1, 1, 0, ContextGLClearMask.DEPTH);\n\n\t\tif (this._pFilter3DRenderer) {\n\t\t\tthis.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\t\tthis.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\t} else {\n\t\t\tthis.textureRatioX = 1;\n\t\t\tthis.textureRatioY = 1;\n\t\t}\n\n\t\tif (this._pRequireDepthRender)\n\t\t\tthis.pRenderSceneDepthToTexture(<EntityCollector> entityCollector);\n\n\t\tif (this._depthPrepass)\n\t\t\tthis.pRenderDepthPrepass(<EntityCollector> entityCollector);\n\n\t\tif (this._pFilter3DRenderer && this._pContext) { //TODO\n\t\t\t//this._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t\t//this._pFilter3DRenderer.render(this._pStage, entityCollector.camera, this._pDepthRender);\n\n\t\t} else {\n\n\t\t\tif (this._shareContext)\n\t\t\t\tthis._iRender(entityCollector, null, this._pScissorRect);\n\t\t\telse\n\t\t\t\tthis._iRender(entityCollector);\n\t\t}\n\n\t\tsuper.render(entityCollector);\n\n\t\tif (!this._shareContext && this._pContext)\n\t\t\tthis._pContext.present();\n\n\t\t// register that a view has been rendered\n\t\tthis._pStage.bufferClear = false;\n\t}\n\n\tpublic pExecuteRender(entityCollector:EntityCollector, target:TextureProxyBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis.updateLights(entityCollector);\n\n\t\t// otherwise RTT will interfere with other RTTs\n\t\tif (target) {\n\t\t\tthis.pCollectRenderables(entityCollector);\n\n\t\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\t\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\t\t}\n\n\t\tsuper.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\t}\n\n\tprivate updateLights(entityCollector:EntityCollector)\n\t{\n\t\tvar dirLights:Array<DirectionalLight> = entityCollector.directionalLights;\n\t\tvar pointLights:Array<PointLight> = entityCollector.pointLights;\n\t\tvar len:number, i:number;\n\t\tvar light:LightBase;\n\t\tvar shadowMapper:ShadowMapperBase;\n\n\t\tlen = dirLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = dirLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid ))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDepthRenderer);\n\t\t}\n\n\t\tlen = pointLights.length;\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tlight = pointLights[i];\n\n\t\t\tshadowMapper = light.shadowMapper;\n\n\t\t\tif (light.castsShadows && (shadowMapper.autoUpdateShadows || shadowMapper._iShadowsInvalid))\n\t\t\t\tshadowMapper.iRenderDepthMap(entityCollector, this._pDistanceRenderer);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector, target:TextureProxyBase)\n\t{\n\t\tif (!target)\n\t\t\tthis.pCollectRenderables(entityCollector);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\n\t\tif (entityCollector.skyBox) {\n\t\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.ALWAYS);\n\n\t\t\tthis.drawSkybox(entityCollector);\n\t\t}\n\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\t}\n\n\t/**\n\t * Draw the skybox if present.\n\t *\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawSkybox(entityCollector:EntityCollector)\n\t{\n\t\tvar skyBox:SkyboxRenderable = <SkyboxRenderable> this._skyboxRenderablePool.getItem(entityCollector.skyBox);\n\n\t\tvar material:StageGLMaterialBase = <StageGLMaterialBase> entityCollector.skyBox.material;\n\n\t\tvar camera:Camera = entityCollector.camera;\n\n\t\tthis.updateSkyboxProjection(camera);\n\n\t\tvar activePass:MaterialPassData = this.getMaterial(material, this._pStage.profile).getMaterialPass(<MaterialPassBase> material._iScreenPasses[0], this._pStage.profile);\n\n\t\tmaterial._iActivatePass(activePass, this, camera);\n\t\tmaterial._iRenderPass(activePass, skyBox, this._pStage, camera, this._skyboxProjection);\n\t\tmaterial._iDeactivatePass(activePass, this);\n\t}\n\n\tprivate updateSkyboxProjection(camera:Camera)\n\t{\n\t\tvar near:Vector3D = new Vector3D();\n\n\t\tthis._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);\n\t\tthis._skyboxProjection.copyRowTo(2, near);\n\n\t\tvar camPos:Vector3D = camera.scenePosition;\n\n\t\tvar cx:number = near.x;\n\t\tvar cy:number = near.y;\n\t\tvar cz:number = near.z;\n\t\tvar cw:number = -(near.x*camPos.x + near.y*camPos.y + near.z*camPos.z + Math.sqrt(cx*cx + cy*cy + cz*cz));\n\n\t\tvar signX:number = cx >= 0? 1 : -1;\n\t\tvar signY:number = cy >= 0? 1 : -1;\n\n\t\tvar p:Vector3D = new Vector3D(signX, signY, 1, 1);\n\n\t\tvar inverse:Matrix3D = this._skyboxProjection.clone();\n\t\tinverse.invert();\n\n\t\tvar q:Vector3D = inverse.transformVector(p);\n\n\t\tthis._skyboxProjection.copyRowTo(3, p);\n\n\t\tvar a:number = (q.x*p.x + q.y*p.y + q.z*p.z + q.w*p.w)/(cx*q.x + cy*q.y + cz*q.z + cw*q.w);\n\n\t\tthis._skyboxProjection.copyRowFrom(2, new Vector3D(cx*a, cy*a, cz*a, cw*a));\n\t}\n\n\t/**\n\t * Draw a list of renderables.\n\t *\n\t * @param renderables The renderables to draw.\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawRenderables(renderable:RenderableBase, entityCollector:ICollector)\n\t{\n\t\tvar i:number;\n\t\tvar len:number;\n\t\tvar passes:Array<IMaterialPass>;\n\t\tvar activePass:MaterialPassData;\n\t\tvar activeMaterial:MaterialData;\n\t\tvar context:IContextStageGL = <IContextStageGL> this._pStage.context;\n\t\tvar camera:Camera = entityCollector.camera;\n\t\tvar renderable2:RenderableBase;\n\n\t\twhile (renderable) {\n\t\t\tactiveMaterial = this.getMaterial(renderable.material, this._pStage.profile);\n\n\t\t\t//iterate through each screen pass\n\t\t\tpasses = renderable.material._iScreenPasses;\n\t\t\tlen = renderable.material._iNumScreenPasses();\n\t\t\tfor (i = 0; i < len; i++) {\n\t\t\t\trenderable2 = renderable;\n\n\t\t\t\tactivePass = activeMaterial.getMaterialPass(<MaterialPassBase> passes[i], this._pStage.profile);\n\n\t\t\t\trenderable.material._iActivatePass(activePass, this, camera);\n\n\t\t\t\tdo {\n\t\t\t\t\trenderable.material._iRenderPass(activePass, renderable2, this._pStage, camera, this._pRttViewProjectionMatrix);\n\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.material == renderable.material);\n\n\t\t\t\tactiveMaterial.material._iDeactivatePass(activePass, this);\n\t\t\t}\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (!this._shareContext)\n\t\t\tthis._pStage.dispose();\n\n\t\tthis._pDepthRenderer.dispose();\n\t\tthis._pDistanceRenderer.dispose();\n\t\tthis._pDepthRenderer = null;\n\t\tthis._pDistanceRenderer = null;\n\n\t\tthis._pDepthRender = null;\n\n\t\tsuper.dispose();\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderDepthPrepass(entityCollector:EntityCollector)\n\t{\n\t\tthis._pDepthRenderer.disableColor = true;\n\n\t\tif (this._pFilter3DRenderer) { //TODO\n//\t\t\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n//\t\t\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n//\t\t\t\tthis._pDepthRenderer._iRender(entityCollector, this._pFilter3DRenderer.getMainInputTexture(this._pStage), this._pRttBufferManager.renderToTextureRect);\n\t\t} else {\n\t\t\tthis._pDepthRenderer.textureRatioX = 1;\n\t\t\tthis._pDepthRenderer.textureRatioY = 1;\n\t\t\tthis._pDepthRenderer._iRender(entityCollector);\n\t\t}\n\n\t\tthis._pDepthRenderer.disableColor = false;\n\t}\n\n\n\t/**\n\t *\n\t */\n\tpublic pRenderSceneDepthToTexture(entityCollector:EntityCollector)\n\t{\n\t\tif (this._pDepthTextureInvalid || !this._pDepthRender)\n\t\t\tthis.initDepthTexture(<IContextStageGL> this._pStage.context);\n\n\t\tthis._pDepthRenderer.textureRatioX = this._pRttBufferManager.textureRatioX;\n\t\tthis._pDepthRenderer.textureRatioY = this._pRttBufferManager.textureRatioY;\n\t\tthis._pDepthRenderer._iRender(entityCollector, this._pDepthRender);\n\t}\n\n\n\t/**\n\t * Updates the backbuffer dimensions.\n\t */\n\tpublic pUpdateBackBuffer()\n\t{\n\t\t// No reason trying to configure back buffer if there is no context available.\n\t\t// Doing this anyway (and relying on _stage to cache width/height for\n\t\t// context does get available) means usesSoftwareRendering won't be reliable.\n\t\tif (this._pStage.context && !this._shareContext) {\n\t\t\tif (this._width && this._height) {\n\t\t\t\tthis._pStage.configureBackBuffer(this._width, this._height, this._antiAlias, true);\n\t\t\t\tthis._pBackBufferInvalid = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic iSetStage(value:Stage)\n\t{\n\t\tsuper.iSetStage(value);\n\n\t\tthis._pDistanceRenderer.iSetStage(value);\n\t\tthis._pDepthRenderer.iSetStage(value);\n\t}\n\n\t/**\n\t *\n\t */\n\tprivate initDepthTexture(context:IContextStageGL):void\n\t{\n\t\tthis._pDepthTextureInvalid = false;\n\n\t\tif (this._pDepthRender)\n\t\t\tthis._pDepthRender.dispose();\n\n\t\tthis._pDepthRender = new RenderTexture(this._pRttBufferManager.textureWidth, this._pRttBufferManager.textureHeight);\n\t}\n}\n\nexport = DefaultRenderer;",
    "import Plane3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Plane3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\n\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\n\nimport MaterialData\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialData\");\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport RendererBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/render/RendererBase\");\nimport MaterialPassBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/passes/MaterialPassBase\");\n\n\n/**\n * The DepthRenderer class renders 32-bit depth information encoded as RGBA\n *\n * @class away.render.DepthRenderer\n */\nclass DepthRenderer extends RendererBase\n{\n\tprivate _pass:MaterialPassBase;\n\tprivate _renderBlended:boolean;\n\tprivate _disableColor:boolean;\n\n\t/**\n\t * Creates a new DepthRenderer object.\n\t * @param renderBlended Indicates whether semi-transparent objects should be rendered.\n\t * @param distanceBased Indicates whether the written depth value is distance-based or projected depth-based\n\t */\n\tconstructor(pass:MaterialPassBase, renderBlended:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._pass = pass;\n\n\t\tthis._renderBlended = renderBlended;\n\t\tthis._iBackgroundR = 1;\n\t\tthis._iBackgroundG = 1;\n\t\tthis._iBackgroundB = 1;\n\n\t}\n\n\tpublic get disableColor():boolean\n\t{\n\t\treturn this._disableColor;\n\t}\n\n\tpublic set disableColor(value:boolean)\n\t{\n\t\tthis._disableColor = value;\n\t}\n\n\tpublic _iRenderCascades(entityCollector:ShadowCasterCollector, target:TextureProxyBase, numCascades:number, scissorRects:Array<Rectangle>, cameras:Array<Camera>)\n\t{\n\t\tthis.pCollectRenderables(entityCollector);\n\n\t\tthis._pContext.setRenderTarget(target, true, 0);\n\t\tthis._pContext.clear(1, 1, 1, 1, 1, 0);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS);\n\n\t\tvar head:RenderableBase = this._pOpaqueRenderableHead;\n\n\t\tvar first:boolean = true;\n\n\t\tfor (var i:number = numCascades - 1; i >= 0; --i) {\n\t\t\tthis._pStage.scissorRect = scissorRects[i];\n\t\t\tthis.drawCascadeRenderables(head, cameras[i], first? null : cameras[i].frustumPlanes);\n\t\t\tfirst = false;\n\t\t}\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL);\n\n\t\tthis._pStage.scissorRect = null;\n\n\t}\n\n\tprivate drawCascadeRenderables(renderable:RenderableBase, camera:Camera, cullPlanes:Array<Plane3D>)\n\t{\n\t\tvar activePass:MaterialPassData;\n\t\tvar activeMaterial:MaterialData;\n\t\tvar context:IContextStageGL = this._pStage.context;\n\t\tvar renderable2:RenderableBase;\n\n\t\twhile (renderable) {\n\t\t\tactiveMaterial = this.getMaterial(renderable.material, this._pStage.profile);\n\n\t\t\trenderable2 = renderable;\n\n\t\t\tactivePass = activeMaterial.getMaterialPass(this._pass, this._pStage.profile);\n\n\t\t\t//TODO: generalise this test\n\t\t\tif (activePass.key == \"\")\n\t\t\t\tthis.calcAnimationCode(renderable.material, activePass);\n\n\t\t\trenderable.material._iActivatePass(activePass, this, camera);\n\n\t\t\tdo {\n\t\t\t\t// if completely in front, it will fall in a different cascade\n\t\t\t\t// do not use near and far planes\n\t\t\t\tif (!cullPlanes || renderable2.sourceEntity.worldBounds.isInFrustum(cullPlanes, 4)) {\n\t\t\t\t\trenderable2.material._iRenderPass(activePass, renderable2, this._pStage, camera, this._pRttViewProjectionMatrix);\n\t\t\t\t} else {\n\t\t\t\t\trenderable2.cascaded = true;\n\t\t\t\t}\n\n\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t} while (renderable2 && renderable2.material == renderable.material && !renderable2.cascaded);\n\n\t\t\trenderable.material._iDeactivatePass(activePass, this);\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic pDraw(entityCollector:EntityCollector, target:TextureProxyBase)\n\t{\n\t\tthis.pCollectRenderables(entityCollector);\n\n\t\tthis._pContext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\n\t\tthis._pContext.setDepthTest(true, ContextGLCompareMode.LESS);\n\n\t\tthis.drawRenderables(this._pOpaqueRenderableHead, entityCollector);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(false, false, false, false);\n\n\t\tif (this._renderBlended)\n\t\t\tthis.drawRenderables(this._pBlendedRenderableHead, entityCollector);\n\n\t\tif (this._disableColor)\n\t\t\tthis._pContext.setColorMask(true, true, true, true);\n\t}\n\n\t/**\n\t * Draw a list of renderables.\n\t * @param renderables The renderables to draw.\n\t * @param entityCollector The EntityCollector containing all potentially visible information.\n\t */\n\tprivate drawRenderables(renderable:RenderableBase, entityCollector:EntityCollector)\n\t{\n\t\tvar activePass:MaterialPassData;\n\t\tvar activeMaterial:MaterialData;\n\t\tvar context:IContextStageGL = this._pStage.context;\n\t\tvar camera:Camera = entityCollector.camera;\n\t\tvar renderable2:RenderableBase;\n\n\t\twhile (renderable) {\n\t\t\tactiveMaterial = this.getMaterial(renderable.material, this._pStage.profile);\n\n\t\t\t// otherwise this would result in depth rendered anyway because fragment shader kil is ignored\n\t\t\tif (this._disableColor && renderable.material.alphaThreshold != 0) {\n\t\t\t\trenderable2 = renderable;\n\t\t\t\t// fast forward\n\t\t\t\tdo {\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.material == renderable.material);\n\t\t\t} else {\n\t\t\t\trenderable2 = renderable;\n\n\t\t\t\tactivePass = activeMaterial.getMaterialPass(this._pass, this._pStage.profile);\n\n\t\t\t\t//TODO: generalise this test\n\t\t\t\tif (activePass.key == \"\")\n\t\t\t\t\tthis.calcAnimationCode(renderable.material, activePass);\n\n\t\t\t\trenderable.material._iActivatePass(activePass, this, camera);\n\n\t\t\t\tdo {\n\t\t\t\t\trenderable2.material._iRenderPass(activePass, renderable2, this._pStage, camera, this._pRttViewProjectionMatrix);\n\n\t\t\t\t\trenderable2 = renderable2.next;\n\n\t\t\t\t} while (renderable2 && renderable2.material == renderable.material);\n\n\t\t\t\trenderable.material._iDeactivatePass(activePass, this);\n\t\t\t}\n\n\t\t\trenderable = renderable2;\n\t\t}\n\t}\n}\n\nexport = DepthRenderer;",
    "import Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\nimport Filter3DBase\t\t\t\t\t= require(\"awayjs-stagegl/lib/filters/Filter3DBase\");\nimport Filter3DTaskBase\t\t\t\t= require(\"awayjs-stagegl/lib/filters/tasks/Filter3DTaskBase\");\n\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\n\n/**\n * @class away.render.Filter3DRenderer\n */\nclass Filter3DRenderer\n{\n\tprivate _filters:Array<Filter3DBase>;\n\tprivate _tasks:Array<Filter3DTaskBase>;\n\tprivate _filterTasksInvalid:boolean;\n\tprivate _mainInputTexture:ITexture;\n\tprivate _requireDepthRender:boolean;\n\tprivate _rttManager:RTTBufferManager;\n\tprivate _stage:Stage;\n\tprivate _filterSizesInvalid:boolean = true;\n\tprivate _onRTTResizeDelegate:(event:Event) => void;\n\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._onRTTResizeDelegate = (event:Event) => this.onRTTResize(event);\n\n\t\tthis._stage = stage;\n\t\tthis._rttManager = RTTBufferManager.getInstance(stage);\n\t\tthis._rttManager.addEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\n\t}\n\n\tprivate onRTTResize(event:Event)\n\t{\n\t\tthis._filterSizesInvalid = true;\n\t}\n\n\tpublic get requireDepthRender():boolean\n\t{\n\t\treturn this._requireDepthRender;\n\t}\n\n\tpublic getMainInputTexture(stage:Stage):ITexture\n\t{\n\t\tif (this._filterTasksInvalid) {\n\n\t\t\tthis.updateFilterTasks(stage);\n\n\t\t}\n\n\t\treturn this._mainInputTexture;\n\t}\n\n\tpublic get filters():Filter3DBase[]\n\t{\n\t\treturn this._filters;\n\t}\n\n\tpublic set filters(value:Filter3DBase[])\n\t{\n\t\tthis._filters = value;\n\n\t\tthis._filterTasksInvalid = true;\n\n\t\tthis._requireDepthRender = false;\n\n\t\tif (!this._filters) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\n\t\t\t// TODO: check logic:\n\t\t\t// this._requireDepthRender ||=  Boolean ( this._filters[i].requireDepthRender )\n\n\t\t\tvar s:any = this._filters[i];\n\t\t\tvar b:boolean = <boolean> ( s.requireDepthRender == null )? false : s.requireDepthRender;\n\n\t\t\tthis._requireDepthRender = this._requireDepthRender || b;\n\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tprivate updateFilterTasks(stage:Stage)\n\t{\n\t\tvar len:number;\n\n\t\tif (this._filterSizesInvalid) {\n\n\t\t\tthis.updateFilterSizes();\n\n\t\t}\n\n\t\tif (!this._filters) {\n\t\t\tthis._tasks = null;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tasks = new Array<Filter3DTaskBase>();\n\n\t\tlen = this._filters.length - 1;\n\n\t\tvar filter:Filter3DBase;\n\n\t\tfor (var i:number = 0; i <= len; ++i) {\n\n\t\t\t// make sure all internal tasks are linked together\n\t\t\tfilter = this._filters[i];\n\n\t\t\t// TODO: check logic\n\t\t\t// filter.setRenderTargets(i == len? null : Filter3DBase(_filters[i + 1]).getMainInputTexture(stage), stage);\n\n\t\t\tfilter.setRenderTargets(i == len? null : this._filters[i + 1].getMainInputTexture(stage), stage);\n\n\t\t\tthis._tasks = this._tasks.concat(filter.tasks);\n\n\t\t}\n\n\t\tthis._mainInputTexture = this._filters[0].getMainInputTexture(stage);\n\n\t}\n\n\tpublic render(stage:Stage, camera:Camera, depthTexture:ITexture)\n\t{\n\t\tvar len:number;\n\t\tvar i:number;\n\t\tvar task:Filter3DTaskBase;\n\t\tvar context:IContextStageGL = <IContextStageGL> stage.context;\n\n\t\tvar indexBuffer:IIndexBuffer = this._rttManager.indexBuffer;\n\n\t\tvar vertexBuffer:IVertexBuffer = this._rttManager.renderToTextureVertexBuffer;\n\n\t\tif (!this._filters) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._filterSizesInvalid) {\n\t\t\tthis.updateFilterSizes();\n\t\t}\n\n\t\tif (this._filterTasksInvalid) {\n\t\t\tthis.updateFilterTasks(stage);\n\t\t}\n\n\t\tlen = this._filters.length;\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._filters[i].update(stage, camera);\n\t\t}\n\n\t\tlen = this._tasks.length;\n\n\t\tif (len > 1) {\n\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t}\n\n\t\tfor (i = 0; i < len; ++i) {\n\n\t\t\ttask = this._tasks[i];\n\n\t\t\t//stage.setRenderTarget(task.target); //TODO\n\n\t\t\tif (!task.target) {\n\n\t\t\t\tstage.scissorRect = null;\n\t\t\t\tvertexBuffer = this._rttManager.renderToScreenVertexBuffer;\n\t\t\t\tcontext.setVertexBufferAt(0, vertexBuffer, 0, ContextGLVertexBufferFormat.FLOAT_2);\n\t\t\t\tcontext.setVertexBufferAt(1, vertexBuffer, 2, ContextGLVertexBufferFormat.FLOAT_2);\n\n\t\t\t}\n\n\t\t\tcontext.setTextureAt(0, task.getMainInputTexture(stage));\n\t\t\tcontext.setProgram(task.getProgram(stage));\n\t\t\tcontext.clear(0.0, 0.0, 0.0, 0.0);\n\n\t\t\ttask.activate(stage, camera, depthTexture);\n\n\t\t\tcontext.setBlendFactors(ContextGLBlendFactor.ONE, ContextGLBlendFactor.ZERO);\n\t\t\tcontext.drawTriangles(indexBuffer, 0, 2);\n\n\t\t\ttask.deactivate(stage);\n\t\t}\n\n\t\tcontext.setTextureAt(0, null);\n\t\tcontext.setVertexBufferAt(0, null);\n\t\tcontext.setVertexBufferAt(1, null);\n\t}\n\n\tprivate updateFilterSizes()\n\t{\n\t\tfor (var i:number = 0; i < this._filters.length; ++i) {\n\t\t\tthis._filters[i].textureWidth = this._rttManager.textureWidth;\n\t\t\tthis._filters[i].textureHeight = this._rttManager.textureHeight;\n\t\t}\n\n\t\tthis._filterSizesInvalid = true;\n\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._rttManager.removeEventListener(Event.RESIZE, this._onRTTResizeDelegate);\n\t\tthis._rttManager = null;\n\t\tthis._stage = null;\n\t}\n}\n\nexport = Filter3DRenderer;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Point\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Vector3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport LineSubMesh\t\t\t\t\t= require(\"awayjs-display/lib/base/LineSubMesh\");\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport TriangleSubMesh\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubMesh\");\nimport EntityListItem\t\t\t\t= require(\"awayjs-display/lib/pool/EntityListItem\");\nimport RenderablePool\t\t\t\t= require(\"awayjs-display/lib/pool/RenderablePool\");\nimport IEntitySorter\t\t\t\t= require(\"awayjs-display/lib/sort/IEntitySorter\");\nimport RenderableMergeSort\t\t\t= require(\"awayjs-display/lib/sort/RenderableMergeSort\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\nimport Billboard\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport RendererEvent\t\t\t\t= require(\"awayjs-display/lib/events/RendererEvent\");\nimport StageEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/StageEvent\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport EntityCollector\t\t\t\t= require(\"awayjs-display/lib/traverse/EntityCollector\");\nimport ICollector\t\t\t\t\t= require(\"awayjs-display/lib/traverse/ICollector\");\nimport ShadowCasterCollector\t\t= require(\"awayjs-display/lib/traverse/ShadowCasterCollector\");\n\nimport AGALMiniAssembler\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\n\nimport AnimationSetBase\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport BillboardRenderable\t\t\t= require(\"awayjs-renderergl/lib/pool/BillboardRenderable\");\nimport LineSubMeshRenderable\t\t= require(\"awayjs-renderergl/lib/pool/LineSubMeshRenderable\");\nimport MaterialData\t\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialData\");\nimport MaterialDataPool\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialDataPool\");\nimport MaterialPassData\t\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassData\");\nimport MaterialPassDataPool\t\t\t= require(\"awayjs-renderergl/lib/pool/MaterialPassDataPool\");\nimport RenderableBase\t\t\t\t= require(\"awayjs-renderergl/lib/pool/RenderableBase\");\nimport TriangleSubMeshRenderable\t= require(\"awayjs-renderergl/lib/pool/TriangleSubMeshRenderable\");\nimport RTTBufferManager\t\t\t\t= require(\"awayjs-renderergl/lib/managers/RTTBufferManager\");\nimport StageGLMaterialBase\t\t\t= require(\"awayjs-renderergl/lib/materials/StageGLMaterialBase\");\nimport ShaderObjectBase\t\t\t\t= require(\"awayjs-renderergl/lib/materials/compilation/ShaderObjectBase\");\nimport DefaultMaterialManager\t\t= require(\"awayjs-renderergl/lib/materials/utils/DefaultMaterialManager\");\n\n/**\n * RendererBase forms an abstract base class for classes that are used in the rendering pipeline to render the\n * contents of a partition\n *\n * @class away.render.RendererBase\n */\nclass RendererBase extends EventDispatcher\n{\n\tprivate _numUsedStreams:number = 0;\n\tprivate _numUsedTextures:number = 0;\n\n\tprivate _materialDataPool:MaterialDataPool;\n\tprivate _billboardRenderablePool:RenderablePool;\n\tprivate _triangleSubMeshRenderablePool:RenderablePool;\n\tprivate _lineSubMeshRenderablePool:RenderablePool;\n\n\tpublic _pContext:IContextStageGL;\n\tpublic _pStage:Stage;\n\n\tpublic _pCamera:Camera;\n\tpublic _iEntryPoint:Vector3D;\n\tpublic _pCameraForward:Vector3D;\n\n\tpublic _pRttBufferManager:RTTBufferManager;\n\tprivate _viewPort:Rectangle = new Rectangle();\n\tprivate _viewportDirty:boolean;\n\tprivate _scissorDirty:boolean;\n\n\tpublic _pBackBufferInvalid:boolean = true;\n\tpublic _pDepthTextureInvalid:boolean = true;\n\tpublic _depthPrepass:boolean = false;\n\tprivate _backgroundR:number = 0;\n\tprivate _backgroundG:number = 0;\n\tprivate _backgroundB:number = 0;\n\tprivate _backgroundAlpha:number = 1;\n\tpublic _shareContext:boolean = false;\n\n\t// only used by renderers that need to render geometry to textures\n\tpublic _width:number;\n\tpublic _height:number;\n\n\tpublic textureRatioX:number = 1;\n\tpublic textureRatioY:number = 1;\n\n\tprivate _snapshotBitmapData:BitmapData;\n\tprivate _snapshotRequired:boolean;\n\n\tpublic _pRttViewProjectionMatrix:Matrix3D = new Matrix3D();\n\n\tprivate _localPos:Point = new Point();\n\tprivate _globalPos:Point = new Point();\n\tpublic _pScissorRect:Rectangle = new Rectangle();\n\n\tprivate _scissorUpdated:RendererEvent;\n\tprivate _viewPortUpdated:RendererEvent;\n\n\tprivate _onContextUpdateDelegate:Function;\n\tprivate _onViewportUpdatedDelegate;\n\n\tpublic _pNumTriangles:number = 0;\n\n\tpublic _pOpaqueRenderableHead:RenderableBase;\n\tpublic _pBlendedRenderableHead:RenderableBase;\n\n\t/**\n\t *\n\t */\n\tpublic get numTriangles():number\n\t{\n\t\treturn this._pNumTriangles;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic renderableSorter:IEntitySorter;\n\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * A scissor rectangle equivalent of the view size and position.\n\t */\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._pScissorRect;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._localPos.x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tif (this.x == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.x = this._localPos.x = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._localPos.y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tif (this.y == value)\n\t\t\treturn;\n\n\t\tthis._globalPos.y = this._localPos.y = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(value:number)\n\t{\n\t\tif (this._width == value)\n\t\t\treturn;\n\n\t\tthis._width = value;\n\t\tthis._pScissorRect.width = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewWidth = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(value:number)\n\t{\n\t\tif (this._height == value)\n\t\t\treturn;\n\n\t\tthis._height = value;\n\t\tthis._pScissorRect.height = value;\n\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.viewHeight = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t\tthis._pDepthTextureInvalid = true;\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\t/**\n\t * Creates a new RendererBase object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._onViewportUpdatedDelegate = (event:StageEvent) => this.onViewportUpdated(event);\n\n\t\tthis._materialDataPool = new MaterialDataPool();\n\n\t\tthis._billboardRenderablePool = RenderablePool.getPool(BillboardRenderable);\n\t\tthis._triangleSubMeshRenderablePool = RenderablePool.getPool(TriangleSubMeshRenderable);\n\t\tthis._lineSubMeshRenderablePool = RenderablePool.getPool(LineSubMeshRenderable);\n\n\t\tthis._onContextUpdateDelegate = (event:Event) => this.onContextUpdate(event);\n\n\t\t//default sorting algorithm\n\t\tthis.renderableSorter = new RenderableMergeSort();\n\t}\n\n\n\tpublic getProgram(materialPassData:MaterialPassData):ProgramData\n\t{\n\t\t//check key doesn't need re-concatenating\n\t\tif (!materialPassData.key.length) {\n\t\t\tmaterialPassData.key = materialPassData.animationVertexCode +\n\t\t\tmaterialPassData.vertexCode +\n\t\t\t\"---\" +\n\t\t\tmaterialPassData.fragmentCode +\n\t\t\tmaterialPassData.animationFragmentCode +\n\t\t\tmaterialPassData.postAnimationFragmentCode;\n\t\t} else {\n\t\t\treturn materialPassData.programData;\n\t\t}\n\n\t\tvar programData:ProgramData = this._pContext.getProgramData(materialPassData.key);\n\n\t\t//check program data hasn't changed, keep count of program usages\n\t\tif (materialPassData.programData != programData) {\n\t\t\tif (materialPassData.programData)\n\t\t\t\tmaterialPassData.programData.dispose();\n\n\t\t\tmaterialPassData.programData = programData;\n\n\t\t\tprogramData.usages++;\n\t\t}\n\n\t\treturn programData;\n\t}\n\n\t/**\n\t *\n\t * @param material\n\t */\n\tpublic getMaterial(material:StageGLMaterialBase, profile:string):MaterialData\n\t{\n\t\tvar materialData:MaterialData = this._materialDataPool.getItem(material);\n\n\t\tif (materialData.invalidAnimation) {\n\t\t\tmaterialData.invalidAnimation = false;\n\n\t\t\tvar materialDataPasses:Array<MaterialPassData> = materialData.getMaterialPasses(profile);\n\n\t\t\tvar enabledGPUAnimation:boolean = this.getEnabledGPUAnimation(material, materialDataPasses);\n\n\t\t\tvar renderOrderId = 0;\n\t\t\tvar mult:number = 1;\n\t\t\tvar materialPassData:MaterialPassData;\n\t\t\tvar len:number = materialDataPasses.length;\n\t\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\t\tmaterialPassData = materialDataPasses[i];\n\n\t\t\t\tif (materialPassData.usesAnimation != enabledGPUAnimation) {\n\t\t\t\t\tmaterialPassData.usesAnimation = enabledGPUAnimation;\n\t\t\t\t\tmaterialPassData.key == \"\";\n\t\t\t\t}\n\n\t\t\t\tif (materialPassData.key == \"\")\n\t\t\t\t\tthis.calcAnimationCode(material, materialPassData);\n\n\t\t\t\trenderOrderId += this.getProgram(materialPassData).id*mult;\n\t\t\t\tmult *= 1000;\n\t\t\t}\n\n\t\t\tmaterialData.renderOrderId = renderOrderId;\n\t\t}\n\n\t\treturn materialData;\n\t}\n\n\tpublic activateMaterialPass(materialPassData:MaterialPassData, camera:Camera)\n\t{\n\t\tvar shaderObject:ShaderObjectBase = materialPassData.shaderObject;\n\n\t\t//clear unused vertex streams\n\t\tfor (var i = shaderObject.numUsedStreams; i < this._numUsedStreams; i++)\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\n\t\t//clear unused texture streams\n\t\tfor (var i = shaderObject.numUsedTextures; i < this._numUsedTextures; i++)\n\t\t\tthis._pContext.setTextureAt(i, null);\n\n\t\tif (materialPassData.usesAnimation)\n\t\t\t(<AnimationSetBase> materialPassData.material.animationSet).activate(shaderObject, this._pStage);\n\n\t\t//activate shader object\n\t\tshaderObject.iActivate(this._pStage, camera);\n\n\t\t//check program data is uploaded\n\t\tvar programData:ProgramData = this.getProgram(materialPassData);\n\n\t\tif (!programData.program) {\n\t\t\tprogramData.program = this._pContext.createProgram();\n\t\t\tvar vertexByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part vertex 1\\n\" + materialPassData.animationVertexCode + materialPassData.vertexCode + \"endpart\"))['vertex'].data;\n\t\t\tvar fragmentByteCode:ByteArray = (new AGALMiniAssembler().assemble(\"part fragment 1\\n\" + materialPassData.fragmentCode + materialPassData.animationFragmentCode + materialPassData.postAnimationFragmentCode + \"endpart\"))['fragment'].data;\n\t\t\tprogramData.program.upload(vertexByteCode, fragmentByteCode);\n\t\t}\n\n\t\t//set program data\n\t\tthis._pContext.setProgram(programData.program);\n\t}\n\n\tpublic deactivateMaterialPass(materialPassData:MaterialPassData)\n\t{\n\t\tvar shaderObject:ShaderObjectBase = materialPassData.shaderObject;\n\n\t\tif (materialPassData.usesAnimation)\n\t\t\t(<AnimationSetBase> materialPassData.material.animationSet).deactivate(shaderObject, this._pStage);\n\n\t\tmaterialPassData.shaderObject.iDeactivate(this._pStage);\n\n\t\tthis._numUsedStreams = shaderObject.numUsedStreams;\n\t\tthis._numUsedTextures = shaderObject.numUsedTextures;\n\t}\n\n\tpublic _iCreateEntityCollector():ICollector\n\t{\n\t\treturn new EntityCollector();\n\t}\n\n\t/**\n\t * The background color's red component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundR():number\n\t{\n\t\treturn this._backgroundR;\n\t}\n\n\tpublic set _iBackgroundR(value:number)\n\t{\n\t\tif (this._backgroundR == value)\n\t\t\treturn;\n\n\t\tthis._backgroundR = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's green component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundG():number\n\t{\n\t\treturn this._backgroundG;\n\t}\n\n\tpublic set _iBackgroundG(value:number)\n\t{\n\t\tif (this._backgroundG == value)\n\t\t\treturn;\n\n\t\tthis._backgroundG = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/**\n\t * The background color's blue component, used when clearing.\n\t *\n\t * @private\n\t */\n\tpublic get _iBackgroundB():number\n\t{\n\t\treturn this._backgroundB;\n\t}\n\n\tpublic set _iBackgroundB(value:number)\n\t{\n\t\tif (this._backgroundB == value)\n\t\t\treturn;\n\n\t\tthis._backgroundB = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\tpublic get context():IContextStageGL\n\t{\n\t\treturn this._pContext;\n\t}\n\n\t/**\n\t * The Stage that will provide the ContextGL used for rendering.\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._pStage;\n\t}\n\n\tpublic set stage(value:Stage)\n\t{\n\t\tif (value == this._pStage)\n\t\t\treturn;\n\n\t\tthis.iSetStage(value);\n\t}\n\n\tpublic iSetStage(value:Stage)\n\t{\n\t\tif (this._pStage) {\n\t\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.removeEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\t\t}\n\n\t\tif (!value) {\n\t\t\tthis._pStage = null;\n\t\t\tthis._pContext = null;\n\t\t} else {\n\t\t\tthis._pStage = value;\n\t\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.addEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\t\tthis._pStage.addEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\t\t/*\n\t\t\t if (_backgroundImageRenderer)\n\t\t\t _backgroundImageRenderer.stage = value;\n\t\t\t */\n\t\t\tif (this._pStage.context)\n\t\t\t\tthis._pContext = <IContextStageGL> this._pStage.context;\n\t\t}\n\n\t\tthis._pBackBufferInvalid = true;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t * Defers control of ContextGL clear() and present() calls to Stage, enabling multiple Stage frameworks\n\t * to share the same ContextGL object.\n\t */\n\tpublic get shareContext():boolean\n\t{\n\t\treturn this._shareContext;\n\t}\n\n\tpublic set shareContext(value:boolean)\n\t{\n\t\tif (this._shareContext == value)\n\t\t\treturn;\n\n\t\tthis._shareContext = value;\n\n\t\tthis.updateGlobalPos();\n\t}\n\n\t/**\n\t * Disposes the resources used by the RendererBase.\n\t */\n\tpublic dispose()\n\t{\n\t\tif (this._pRttBufferManager)\n\t\t\tthis._pRttBufferManager.dispose();\n\n\t\tthis._pRttBufferManager = null;\n\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.CONTEXT_RECREATED, this._onContextUpdateDelegate);\n\t\tthis._pStage.removeEventListener(StageEvent.VIEWPORT_UPDATED, this._onViewportUpdatedDelegate);\n\n\t\tthis._pStage = null;\n\n\t\t/*\n\t\t if (_backgroundImageRenderer) {\n\t\t _backgroundImageRenderer.dispose();\n\t\t _backgroundImageRenderer = null;\n\t\t }\n\t\t */\n\t}\n\n\tpublic render(entityCollector:ICollector)\n\t{\n\t\tthis._viewportDirty = false;\n\t\tthis._scissorDirty = false;\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic _iRender(entityCollector:ICollector, target:TextureProxyBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\t//TODO refactor setTarget so that rendertextures are created before this check\n\t\tif (!this._pStage || !this._pContext)\n\t\t\treturn;\n\n\t\tthis._pRttViewProjectionMatrix.copyFrom(entityCollector.camera.viewProjection);\n\t\tthis._pRttViewProjectionMatrix.appendScale(this.textureRatioX, this.textureRatioY, 1);\n\n\t\tthis.pExecuteRender(entityCollector, target, scissorRect, surfaceSelector);\n\n\t\t// generate mip maps on target (if target exists) //TODO\n\t\t//if (target)\n\t\t//\t(<Texture>target).generateMipmaps();\n\n\t\t// clear buffers\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tthis._pContext.setVertexBufferAt(i, null);\n\t\t\tthis._pContext.setTextureAt(i, null);\n\t\t}\n\t}\n\n\tpublic _iRenderCascades(entityCollector:ShadowCasterCollector, target:TextureProxyBase, numCascades:number, scissorRects:Array<Rectangle>, cameras:Array<Camera>)\n\t{\n\n\t}\n\n\tpublic pCollectRenderables(entityCollector:ICollector)\n\t{\n\t\t//reset head values\n\t\tthis._pBlendedRenderableHead = null;\n\t\tthis._pOpaqueRenderableHead = null;\n\t\tthis._pNumTriangles = 0;\n\n\t\t//grab entity head\n\t\tvar item:EntityListItem = entityCollector.entityHead;\n\n\t\t//set temp values for entry point and camera forward vector\n\t\tthis._pCamera = entityCollector.camera;\n\t\tthis._iEntryPoint = this._pCamera.scenePosition;\n\t\tthis._pCameraForward = this._pCamera.transform.forwardVector;\n\n\t\t//iterate through all entities\n\t\twhile (item) {\n\t\t\titem.entity._iCollectRenderables(this);\n\t\t\titem = item.next;\n\t\t}\n\n\t\t//sort the resulting renderables\n\t\tthis._pOpaqueRenderableHead = <RenderableBase> this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);\n\t\tthis._pBlendedRenderableHead = <RenderableBase> this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead);\n\t}\n\n\t/**\n\t * Renders the potentially visible geometry to the back buffer or texture. Only executed if everything is set up.\n\t *\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t * @param target An option target texture to render to.\n\t * @param surfaceSelector The index of a CubeTexture's face to render to.\n\t * @param additionalClearMask Additional clear mask information, in case extra clear channels are to be omitted.\n\t */\n\tpublic pExecuteRender(entityCollector:ICollector, target:TextureProxyBase = null, scissorRect:Rectangle = null, surfaceSelector:number = 0)\n\t{\n\t\tthis._pContext.setRenderTarget(target, true, surfaceSelector);\n\n\t\tif ((target || !this._shareContext) && !this._depthPrepass)\n\t\t\tthis._pContext.clear(this._backgroundR, this._backgroundG, this._backgroundB, this._backgroundAlpha, 1, 0);\n\n\t\tthis._pContext.setDepthTest(false, ContextGLCompareMode.ALWAYS);\n\n\t\tthis._pStage.scissorRect = scissorRect;\n\n\t\t/*\n\t\t if (_backgroundImageRenderer)\n\t\t _backgroundImageRenderer.render();\n\t\t */\n\n\t\tthis.pDraw(entityCollector, target);\n\n\t\t//line required for correct rendering when using away3d with starling. DO NOT REMOVE UNLESS STARLING INTEGRATION IS RETESTED!\n\t\t//this._pContext.setDepthTest(false, ContextGLCompareMode.LESS_EQUAL); //oopsie\n\n\t\tif (!this._shareContext) {\n\t\t\tif (this._snapshotRequired && this._snapshotBitmapData) {\n\t\t\t\tthis._pContext.drawToBitmapData(this._snapshotBitmapData);\n\t\t\t\tthis._snapshotRequired = false;\n\t\t\t}\n\t\t}\n\n\t\tthis._pStage.scissorRect = null;\n\t}\n\n\t/*\n\t * Will draw the renderer's output on next render to the provided bitmap data.\n\t * */\n\tpublic queueSnapshot(bmd:BitmapData)\n\t{\n\t\tthis._snapshotRequired = true;\n\t\tthis._snapshotBitmapData = bmd;\n\t}\n\n\t/**\n\t * Performs the actual drawing of geometry to the target.\n\t * @param entityCollector The EntityCollector object containing the potentially visible geometry.\n\t */\n\tpublic pDraw(entityCollector:ICollector, target:TextureProxyBase)\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\t/**\n\t * Assign the context once retrieved\n\t */\n\tprivate onContextUpdate(event:Event)\n\t{\n\t\tthis._pContext = <IContextStageGL> this._pStage.context;\n\t}\n\n\tpublic get _iBackgroundAlpha():number\n\t{\n\t\treturn this._backgroundAlpha;\n\t}\n\n\tpublic set _iBackgroundAlpha(value:number)\n\t{\n\t\tif (this._backgroundAlpha == value)\n\t\t\treturn;\n\n\t\tthis._backgroundAlpha = value;\n\n\t\tthis._pBackBufferInvalid = true;\n\t}\n\n\t/*\n\t public get iBackground():Texture2DBase\n\t {\n\t return this._background;\n\t }\n\t */\n\n\t/*\n\t public set iBackground(value:Texture2DBase)\n\t {\n\t if (this._backgroundImageRenderer && !value) {\n\t this._backgroundImageRenderer.dispose();\n\t this._backgroundImageRenderer = null;\n\t }\n\n\t if (!this._backgroundImageRenderer && value)\n\t {\n\n\t this._backgroundImageRenderer = new BackgroundImageRenderer(this._pStage);\n\n\t }\n\n\n\t this._background = value;\n\n\t if (this._backgroundImageRenderer)\n\t this._backgroundImageRenderer.texture = value;\n\t }\n\t */\n\t/*\n\t public get backgroundImageRenderer():BackgroundImageRenderer\n\t {\n\t return _backgroundImageRenderer;\n\t }\n\t */\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyScissorUpdate()\n\t{\n\t\tif (this._scissorDirty)\n\t\t\treturn;\n\n\t\tthis._scissorDirty = true;\n\n\t\tif (!this._scissorUpdated)\n\t\t\tthis._scissorUpdated = new RendererEvent(RendererEvent.SCISSOR_UPDATED);\n\n\t\tthis.dispatchEvent(this._scissorUpdated);\n\t}\n\n\n\t/**\n\t * @private\n\t */\n\tprivate notifyViewportUpdate()\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\tif (!this._viewPortUpdated)\n\t\t\tthis._viewPortUpdated = new RendererEvent(RendererEvent.VIEWPORT_UPDATED);\n\n\t\tthis.dispatchEvent(this._viewPortUpdated);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onViewportUpdated(event:StageEvent)\n\t{\n\t\tthis._viewPort = this._pStage.viewPort;\n\t\t//TODO stop firing viewport updated for every stagegl viewport change\n\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._pStage.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._pStage.y;\n\t\t\tthis.notifyScissorUpdate();\n\t\t}\n\n\t\tthis.notifyViewportUpdate();\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic updateGlobalPos()\n\t{\n\t\tif (this._shareContext) {\n\t\t\tthis._pScissorRect.x = this._globalPos.x - this._viewPort.x;\n\t\t\tthis._pScissorRect.y = this._globalPos.y - this._viewPort.y;\n\t\t} else {\n\t\t\tthis._pScissorRect.x = 0;\n\t\t\tthis._pScissorRect.y = 0;\n\t\t\tthis._viewPort.x = this._globalPos.x;\n\t\t\tthis._viewPort.y = this._globalPos.y;\n\t\t}\n\n\t\tthis.notifyScissorUpdate();\n\t}\n\n\n\t/**\n\t *\n\t * @param billboard\n\t * @protected\n\t */\n\tpublic applyBillboard(billboard:Billboard)\n\t{\n\t\tthis._applyRenderable(<RenderableBase> this._billboardRenderablePool.getItem(billboard));\n\t}\n\n\t/**\n\t *\n\t * @param triangleSubMesh\n\t */\n\tpublic applyTriangleSubMesh(triangleSubMesh:TriangleSubMesh)\n\t{\n\t\tthis._applyRenderable(<RenderableBase> this._triangleSubMeshRenderablePool.getItem(triangleSubMesh));\n\t}\n\n\t/**\n\t *\n\t * @param lineSubMesh\n\t */\n\tpublic applyLineSubMesh(lineSubMesh:LineSubMesh)\n\t{\n\t\tthis._applyRenderable(<RenderableBase> this._lineSubMeshRenderablePool.getItem(lineSubMesh));\n\t}\n\n\t/**\n\t *\n\t * @param renderable\n\t * @protected\n\t */\n\tprivate _applyRenderable(renderable:RenderableBase)\n\t{\n\t\tvar material:StageGLMaterialBase = <StageGLMaterialBase> renderable.materialOwner.material;\n\t\tvar entity:IEntity = renderable.sourceEntity;\n\t\tvar position:Vector3D = entity.scenePosition;\n\n\t\tif (!material)\n\t\t\tmaterial = DefaultMaterialManager.getDefaultMaterial(renderable.materialOwner);\n\n\t\t//update material if invalidated\n\t\tmaterial._iUpdateMaterial();\n\n\t\t//set ids for faster referencing\n\t\trenderable.material = material;\n\t\trenderable.materialId = material._iMaterialId;\n\t\trenderable.renderOrderId = this.getMaterial(material, this._pStage.profile).renderOrderId;\n\t\trenderable.cascaded = false;\n\n\t\t// project onto camera's z-axis\n\t\tposition = this._iEntryPoint.subtract(position);\n\t\trenderable.zIndex = entity.zOffset + position.dotProduct(this._pCameraForward);\n\n\t\t//store reference to scene transform\n\t\trenderable.renderSceneTransform = renderable.sourceEntity.getRenderSceneTransform(this._pCamera);\n\n\t\tif (material.requiresBlending) {\n\t\t\trenderable.next = this._pBlendedRenderableHead;\n\t\t\tthis._pBlendedRenderableHead = renderable;\n\t\t} else {\n\t\t\trenderable.next = this._pOpaqueRenderableHead;\n\t\t\tthis._pOpaqueRenderableHead = renderable;\n\t\t}\n\n\t\tthis._pNumTriangles += renderable.numTriangles;\n\n\t\t//handle any overflow for renderables with data that exceeds GPU limitations\n\t\tif (renderable.overflow)\n\t\t\tthis._applyRenderable(renderable.overflow);\n\t}\n\n\n\t/**\n\t * test if animation will be able to run on gpu BEFORE compiling materials\n\t * test if the shader objects supports animating the animation set in the vertex shader\n\t * if any object using this material fails to support accelerated animations for any of the shader objects,\n\t * we should do everything on cpu (otherwise we have the cost of both gpu + cpu animations)\n\t */\n\tprivate getEnabledGPUAnimation(material:MaterialBase, materialDataPasses:Array<MaterialPassData>):boolean\n\t{\n\t\tif (material.animationSet) {\n\t\t\tmaterial.animationSet.resetGPUCompatibility();\n\n\t\t\tvar owners:Array<IMaterialOwner> = material.iOwners;\n\t\t\tvar numOwners:number = owners.length;\n\n\t\t\tvar len:number = materialDataPasses.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tfor (var j:number = 0; j < numOwners; j++)\n\t\t\t\t\tif (owners[j].animator)\n\t\t\t\t\t\t(<AnimatorBase> owners[j].animator).testGPUCompatibility(materialDataPasses[i].shaderObject);\n\n\t\t\treturn !material.animationSet.usesCPU;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tpublic calcAnimationCode(material:MaterialBase, materialPassData:MaterialPassData)\n\t{\n\t\t//reset key so that the program is re-calculated\n\t\tmaterialPassData.key = \"\";\n\t\tmaterialPassData.animationVertexCode = \"\";\n\t\tmaterialPassData.animationFragmentCode = \"\";\n\n\t\tvar shaderObject:ShaderObjectBase = materialPassData.shaderObject;\n\n\t\t//check to see if GPU animation is used\n\t\tif (materialPassData.usesAnimation) {\n\n\t\t\tvar animationSet:AnimationSetBase = <AnimationSetBase> material.animationSet;\n\n\t\t\tmaterialPassData.animationVertexCode += animationSet.getAGALVertexCode(shaderObject);\n\n\t\t\tif (shaderObject.uvDependencies > 0 && !shaderObject.usesUVTransform)\n\t\t\t\tmaterialPassData.animationVertexCode += animationSet.getAGALUVCode(shaderObject);\n\n\t\t\tif (shaderObject.usesFragmentAnimation)\n\t\t\t\tmaterialPassData.animationFragmentCode += animationSet.getAGALFragmentCode(shaderObject, materialPassData.shadedTarget);\n\n\t\t\tanimationSet.doneAGALCode(shaderObject);\n\n\t\t} else {\n\t\t\t// simply write attributes to targets, do not animate them\n\t\t\t// projection will pick up on targets[0] to do the projection\n\t\t\tvar len:number = shaderObject.animatableAttributes.length;\n\t\t\tfor (var i:number = 0; i < len; ++i)\n\t\t\t\tmaterialPassData.animationVertexCode += \"mov \" + shaderObject.animationTargetRegisters[i] + \", \" + shaderObject.animatableAttributes[i] + \"\\n\";\n\n\t\t\tif (shaderObject.uvDependencies > 0 && !shaderObject.usesUVTransform)\n\t\t\t\tmaterialPassData.animationVertexCode += \"mov \" + shaderObject.uvTarget + \",\" + shaderObject.uvSource + \"\\n\";\n\t\t}\n\t}\n}\n\nexport = RendererBase;",
    "import ColorUtils\t\t\t\t= require(\"awayjs-core/lib/utils/ColorUtils\");\n\n/**\n * The ColorTransform class lets you adjust the color values in a display\n * object. The color adjustment or <i>color transformation</i> can be applied\n * to all four channels: red, green, blue, and alpha transparency.\n *\n * <p>When a ColorTransform object is applied to a display object, a new value\n * for each color channel is calculated like this:</p>\n *\n * <ul>\n *   <li>New red value = (old red value * <code>redMultiplier</code>) +\n * <code>redOffset</code></li>\n *   <li>New green value = (old green value * <code>greenMultiplier</code>) +\n * <code>greenOffset</code></li>\n *   <li>New blue value = (old blue value * <code>blueMultiplier</code>) +\n * <code>blueOffset</code></li>\n *   <li>New alpha value = (old alpha value * <code>alphaMultiplier</code>) +\n * <code>alphaOffset</code></li>\n * </ul>\n *\n * <p>If any of the color channel values is greater than 255 after the\n * calculation, it is set to 255. If it is less than 0, it is set to 0.</p>\n *\n * <p>You can use ColorTransform objects in the following ways:</p>\n *\n * <ul>\n *   <li>In the <code>colorTransform</code> parameter of the\n * <code>colorTransform()</code> method of the BitmapData class</li>\n *   <li>As the <code>colorTransform</code> property of a Transform object\n * (which can be used as the <code>transform</code> property of a display\n * object)</li>\n * </ul>\n *\n * <p>You must use the <code>new ColorTransform()</code> constructor to create\n * a ColorTransform object before you can call the methods of the\n * ColorTransform object.</p>\n *\n * <p>Color transformations do not apply to the background color of a movie\n * clip(such as a loaded SWF object). They apply only to graphics and symbols\n * that are attached to the movie clip.</p>\n */\nclass ColorTransform\n{\n\t/**\n\t * A decimal value that is multiplied with the alpha transparency channel\n\t * value.\n\t *\n\t * <p>If you set the alpha transparency value of a display object directly by\n\t * using the <code>alpha</code> property of the DisplayObject instance, it\n\t * affects the value of the <code>alphaMultiplier</code> property of that\n\t * display object's <code>transform.colorTransform</code> property.</p>\n\t */\n\tpublic alphaMultiplier:number;\n\n\t/**\n\t * A number from -255 to 255 that is added to the alpha transparency channel\n\t * value after it has been multiplied by the <code>alphaMultiplier</code>\n\t * value.\n\t */\n\tpublic alphaOffset:number;\n\n\t/**\n\t * A decimal value that is multiplied with the blue channel value.\n\t */\n\tpublic blueMultiplier:number;\n\n\t/**\n\t * A number from -255 to 255 that is added to the blue channel value after it\n\t * has been multiplied by the <code>blueMultiplier</code> value.\n\t */\n\tpublic blueOffset:number;\n\n\t/**\n\t * A decimal value that is multiplied with the green channel value.\n\t */\n\tpublic greenMultiplier:number;\n\n\t/**\n\t * A number from -255 to 255 that is added to the green channel value after\n\t * it has been multiplied by the <code>greenMultiplier</code> value.\n\t */\n\tpublic greenOffset:number;\n\n\t/**\n\t * A decimal value that is multiplied with the red channel value.\n\t */\n\tpublic redMultiplier:number;\n\n\t/**\n\t * A number from -255 to 255 that is added to the red channel value after it\n\t * has been multiplied by the <code>redMultiplier</code> value.\n\t */\n\tpublic redOffset:number;\n\n\t/**\n\t * The RGB color value for a ColorTransform object.\n\t *\n\t * <p>When you set this property, it changes the three color offset values\n\t * (<code>redOffset</code>, <code>greenOffset</code>, and\n\t * <code>blueOffset</code>) accordingly, and it sets the three color\n\t * multiplier values(<code>redMultiplier</code>,\n\t * <code>greenMultiplier</code>, and <code>blueMultiplier</code>) to 0. The\n\t * alpha transparency multiplier and offset values do not change.</p>\n\t *\n\t * <p>When you pass a value for this property, use the format\n\t * 0x<i>RRGGBB</i>. <i>RR</i>, <i>GG</i>, and <i>BB</i> each consist of two\n\t * hexadecimal digits that specify the offset of each color component. The 0x\n\t * tells the ActionScript compiler that the number is a hexadecimal\n\t * value.</p>\n\t */\n\tpublic get color():number\n\t{\n\t\treturn((this.redOffset << 16) | ( this.greenOffset << 8) | this.blueOffset);\n\t}\n\n\tpublic set color(value:number)\n\t{\n\t\tvar argb:number[] = ColorUtils.float32ColorToARGB(value);\n\n\t\tthis.redOffset = argb[1];  //(value >> 16) & 0xFF;\n\t\tthis.greenOffset = argb[2];  //(value >> 8) & 0xFF;\n\t\tthis.blueOffset = argb[3];  //value & 0xFF;\n\n\t\tthis.redMultiplier = 0;\n\t\tthis.greenMultiplier = 0;\n\t\tthis.blueMultiplier = 0;\n\t}\n\n\t/**\n\t * Creates a ColorTransform object for a display object with the specified\n\t * color channel values and alpha values.\n\t *\n\t * @param redMultiplier   The value for the red multiplier, in the range from\n\t *                        0 to 1.\n\t * @param greenMultiplier The value for the green multiplier, in the range\n\t *                        from 0 to 1.\n\t * @param blueMultiplier  The value for the blue multiplier, in the range\n\t *                        from 0 to 1.\n\t * @param alphaMultiplier The value for the alpha transparency multiplier, in\n\t *                        the range from 0 to 1.\n\t * @param redOffset       The offset value for the red color channel, in the\n\t *                        range from -255 to 255.\n\t * @param greenOffset     The offset value for the green color channel, in\n\t *                        the range from -255 to 255.\n\t * @param blueOffset      The offset for the blue color channel value, in the\n\t *                        range from -255 to 255.\n\t * @param alphaOffset     The offset for alpha transparency channel value, in\n\t *                        the range from -255 to 255.\n\t */\n\tconstructor(redMultiplier:number = 1, greenMultiplier:number = 1, blueMultiplier:number = 1, alphaMultiplier:number = 1, redOffset:number = 0, greenOffset:number = 0, blueOffset:number = 0, alphaOffset:number = 0)\n\t{\n\t\tthis.redMultiplier = redMultiplier;\n\t\tthis.greenMultiplier = greenMultiplier;\n\t\tthis.blueMultiplier = blueMultiplier;\n\t\tthis.alphaMultiplier = alphaMultiplier;\n\t\tthis.redOffset = redOffset;\n\t\tthis.greenOffset = greenOffset;\n\t\tthis.blueOffset = blueOffset;\n\t\tthis.alphaOffset = alphaOffset;\n\t}\n\n\t/**\n\t * Concatenates the ColorTranform object specified by the <code>second</code>\n\t * parameter with the current ColorTransform object and sets the current\n\t * object as the result, which is an additive combination of the two color\n\t * transformations. When you apply the concatenated ColorTransform object,\n\t * the effect is the same as applying the <code>second</code> color\n\t * transformation after the <i>original</i> color transformation.\n\t *\n\t * @param second The ColorTransform object to be combined with the current\n\t *               ColorTransform object.\n\t */\n\tpublic concat(second:ColorTransform):void\n\t{\n\t\tthis.redMultiplier += second.redMultiplier;\n\t\tthis.greenMultiplier += second.greenMultiplier;\n\t\tthis.blueMultiplier += second.blueMultiplier;\n\t\tthis.alphaMultiplier += second.alphaMultiplier;\n\t}\n}\n\nexport = ColorTransform;",
    "﻿import BitmapData\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Error\t\t\t\t\t= require(\"awayjs-core/lib/errors/Error\");\nimport Texture2DBase\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\nimport TextureUtils\t\t\t\t= require(\"awayjs-core/lib/utils/TextureUtils\");\n\n\nclass BitmapTexture extends Texture2DBase\n{\n\tpublic _bitmapData:BitmapData;\n\n\t/**\n\t *\n\t * @returns {BitmapData}\n\t */\n\tpublic get bitmapData():BitmapData\n\t{\n\t\treturn this._bitmapData;\n\t}\n\n\tpublic set bitmapData(value:BitmapData)\n\t{\n\t\tif (this._bitmapData == value)\n\t\t\treturn;\n\n\t\tif (!TextureUtils.isBitmapDataValid(value))\n\t\t\tthrow new Error(\"Invalid bitmapData: Width and height must be power of 2 and cannot exceed 2048\");\n\n\t\tthis._bitmapData = value;\n\n\t\tthis.invalidateContent();\n\n\t\tthis._pSetSize(value.width, value.height);\n\t}\n\n\tconstructor(bitmapData:BitmapData, generateMipmaps:boolean = false)\n\t{\n\t\tsuper(generateMipmaps);\n\n\t\tthis.bitmapData = bitmapData;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tsuper.dispose();\n\n\t\tthis._bitmapData.dispose();\n\t\tthis._bitmapData = null;\n\t}\n\n\tpublic _iGetTextureData():BitmapData\n\t{\n\t\treturn this._bitmapData;\n\t}\n}\n\nexport = BitmapTexture;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass MaterialEvent extends Event\n{\n\tpublic static SIZE_CHANGED:string = \"sizeChanged\";\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n}\n\nexport = MaterialEvent;",
    "import Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\n\nclass StageEvent extends Event\n{\n\tpublic static CONTEXT_CREATED:string = \"contextCreated\";\n\tpublic static CONTEXT_DISPOSED:string = \"contextDisposed\";\n\tpublic static CONTEXT_RECREATED:string = \"contextRecreated\";\n\tpublic static VIEWPORT_UPDATED:string = \"viewportUpdated\";\n\n\tconstructor(type:string)\n\t{\n\t\tsuper(type);\n\t}\n}\n\nexport = StageEvent;",
    "/**\n * Enumeration class for defining which lighting types affect the specific material\n * lighting component (diffuse and specular). This can be useful if, for example, you\n * want to use light probes for diffuse global lighting, but want specular reflections from\n * traditional light sources without those affecting the diffuse light.\n *\n * @see away.materials.ColorMaterial.diffuseLightSources\n * @see away.materials.ColorMaterial.specularLightSources\n * @see away.materials.TextureMaterial.diffuseLightSources\n * @see away.materials.TextureMaterial.specularLightSources\n */\nclass LightSources\n{\n\t/**\n\t * Defines normal lights are to be used as the source for the lighting\n\t * component.\n\t */\n\tpublic static LIGHTS:number = 0x01;\n\n\t/**\n\t * Defines that global lighting probes are to be used as the source for the\n\t * lighting component.\n\t */\n\tpublic static PROBES:number = 0x02;\n\n\t/**\n\t * Defines that both normal and global lighting probes  are to be used as the\n\t * source for the lighting component. This is equivalent to LightSources.LIGHTS | LightSources.PROBES.\n\t */\n\tpublic static ALL:number = 0x03;\n}\n\nexport = LightSources;",
    "import Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Event\t\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport AssetType\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetType\");\nimport IAsset\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport NamedAssetBase\t\t\t\t= require(\"awayjs-core/lib/library/NamedAssetBase\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\n\nimport IAnimationSet\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimationSet\");\nimport IAnimator\t\t\t\t\t= require(\"awayjs-display/lib/animators/IAnimator\");\nimport BlendMode\t\t\t\t\t= require(\"awayjs-display/lib/base/BlendMode\");\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport IStage\t\t\t\t\t\t= require(\"awayjs-display/lib/base/IStage\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IMaterialData\t\t\t\t= require(\"awayjs-display/lib/pool/IMaterialData\");\nimport IMaterialPassData\t\t\t= require(\"awayjs-display/lib/pool/IMaterialPassData\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialEvent\t\t\t\t= require(\"awayjs-display/lib/events/MaterialEvent\");\nimport LightPickerBase\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport IMaterialPass\t\t\t\t= require(\"awayjs-display/lib/materials/passes/IMaterialPass\");\nimport IRenderer\t\t\t\t\t= require(\"awayjs-display/lib/render/IRenderer\");\n\n\n/**\n * MaterialBase forms an abstract base class for any material.\n * A material consists of several passes, each of which constitutes at least one render call. Several passes could\n * be used for special effects (render lighting for many lights in several passes, render an outline in a separate\n * pass) or to provide additional render-to-texture passes (rendering diffuse light to texture for texture-space\n * subsurface scattering, or rendering a depth map for specialized self-shadowing).\n *\n * Away3D provides default materials trough SinglePassMaterialBase and TriangleMaterial, which use modular\n * methods to build the shader code. MaterialBase can be extended to build specific and high-performant custom\n * shaders, or entire new material frameworks.\n */\nclass MaterialBase extends NamedAssetBase implements IAsset\n{\n\tprivate _sizeChanged:MaterialEvent;\n\tprivate _materialPassData:Array<IMaterialPassData> = new Array<IMaterialPassData>();\n\tprivate _materialData:Array<IMaterialData> = new Array<IMaterialData>();\n\n\tpublic _pAlphaThreshold:number = 0;\n\tpublic _pAnimateUVs:boolean = false;\n\tprivate _enableLightFallOff:boolean = true;\n\tprivate _specularLightSources:number = 0x01;\n\tprivate _diffuseLightSources:number = 0x03;\n\n\t/**\n\t * An object to contain any extra data.\n\t */\n\tpublic extra:Object;\n\n\t/**\n\t * A value that can be used by materials that only work with a given type of renderer. The renderer can test the\n\t * classification to choose which render path to use. For example, a deferred material could set this value so\n\t * that the deferred renderer knows not to take the forward rendering path.\n\t *\n\t * @private\n\t */\n\tpublic _iClassification:string;\n\n\n\t/**\n\t * An id for this material used to sort the renderables by shader program, which reduces Program state changes.\n\t *\n\t * @private\n\t */\n\tpublic _iMaterialId:number = 0;\n\n\tpublic _iBaseScreenPassIndex:number = 0;\n\n\tprivate _bothSides:boolean = false; // update\n\tprivate _animationSet:IAnimationSet;\n\tpublic _pScreenPassesInvalid:boolean = true;\n\n\t/**\n\t * A list of material owners, renderables or custom Entities.\n\t */\n\tprivate _owners:Array<IMaterialOwner>;\n\n\tprivate _alphaPremultiplied:boolean;\n\n\tpublic _pBlendMode:string = BlendMode.NORMAL;\n\n\tprivate _numPasses:number = 0;\n\tprivate _passes:Array<IMaterialPass>;\n\n\tprivate _mipmap:boolean = false;\n\tprivate _smooth:boolean = true;\n\tprivate _repeat:boolean = false;\n\tprivate _color:number = 0xFFFFFF;\n\tpublic _pTexture:Texture2DBase;\n\n\tpublic _pLightPicker:LightPickerBase;\n\n\tpublic _pHeight:number = 1;\n\tpublic _pWidth:number = 1;\n\tpublic _pRequiresBlending:boolean = false;\n\n\tprivate _onPassChangeDelegate:(event:Event) => void;\n\tprivate _onLightChangeDelegate:(event:Event) => void;\n\n\t/**\n\t * Creates a new MaterialBase object.\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._iMaterialId = Number(this.id);\n\n\t\tthis._owners = new Array<IMaterialOwner>();\n\t\tthis._passes = new Array<IMaterialPass>();\n\n\t\tthis._onPassChangeDelegate = (event:Event) => this.onPassChange(event);\n\t\tthis._onLightChangeDelegate = (event:Event) => this.onLightsChange(event);\n\n\t\tthis.alphaPremultiplied = false; //TODO: work out why this is different for WebGL\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic get assetType():string\n\t{\n\t\treturn AssetType.MATERIAL;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._pHeight;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get animationSet():IAnimationSet\n\t{\n\t\treturn this._animationSet;\n\t}\n\n\n\t/**\n\t * The light picker used by the material to provide lights to the material if it supports lighting.\n\t *\n\t * @see LightPickerBase\n\t * @see StaticLightPicker\n\t */\n\tpublic get lightPicker():LightPickerBase\n\t{\n\t\treturn this._pLightPicker;\n\t}\n\n\tpublic set lightPicker(value:LightPickerBase)\n\t{\n\t\tif (this._pLightPicker == value)\n\t\t\treturn;\n\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.removeEventListener(Event.CHANGE, this._onLightChangeDelegate);\n\n\t\tthis._pLightPicker = value;\n\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.addEventListener(Event.CHANGE, this._onLightChangeDelegate);\n\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\t/**\n\t * Indicates whether or not any used textures should use mipmapping. Defaults to true.\n\t */\n\tpublic get mipmap():boolean\n\t{\n\t\treturn this._mipmap;\n\t}\n\n\tpublic set mipmap(value:boolean)\n\t{\n\t\tif (this._mipmap == value)\n\t\t\treturn;\n\n\t\tthis._mipmap = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Indicates whether or not any used textures should use smoothing.\n\t */\n\tpublic get smooth():boolean\n\t{\n\t\treturn this._smooth;\n\t}\n\n\tpublic set smooth(value:boolean)\n\t{\n\t\tif (this._smooth == value)\n\t\t\treturn;\n\n\t\tthis._smooth = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Indicates whether or not any used textures should be tiled. If set to false, texture samples are clamped to\n\t * the texture's borders when the uv coordinates are outside the [0, 1] interval.\n\t */\n\tpublic get repeat():boolean\n\t{\n\t\treturn this._repeat;\n\t}\n\n\tpublic set repeat(value:boolean)\n\t{\n\t\tif (this._repeat == value)\n\t\t\treturn;\n\n\t\tthis._repeat = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The diffuse reflectivity color of the surface.\n\t */\n\tpublic get color():number\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic set color(value:number)\n\t{\n\t\tif (this._color == value)\n\t\t\treturn;\n\n\t\tthis._color = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The texture object to use for the albedo colour.\n\t */\n\tpublic get texture():Texture2DBase\n\t{\n\t\treturn this._pTexture;\n\t}\n\n\tpublic set texture(value:Texture2DBase)\n\t{\n\t\tif (this._pTexture == value)\n\t\t\treturn;\n\n\t\tthis._pTexture = value;\n\n\t\tthis._pInvalidatePasses();\n\n\t\tthis._pHeight = this._pTexture.height;\n\t\tthis._pWidth = this._pTexture.width;\n\n\t\tthis._pNotifySizeChanged();\n\t}\n\n\t/**\n\t * Specifies whether or not the UV coordinates should be animated using a transformation matrix.\n\t */\n\tpublic get animateUVs():boolean\n\t{\n\t\treturn this._pAnimateUVs;\n\t}\n\n\tpublic set animateUVs(value:boolean)\n\t{\n\t\tif (this._pAnimateUVs == value)\n\t\t\treturn;\n\n\t\tthis._pAnimateUVs = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Whether or not to use fallOff and radius properties for lights. This can be used to improve performance and\n\t * compatibility for constrained mode.\n\t */\n\tpublic get enableLightFallOff():boolean\n\t{\n\t\treturn this._enableLightFallOff;\n\t}\n\n\tpublic set enableLightFallOff(value:boolean)\n\t{\n\t\tif (this._enableLightFallOff == value)\n\t\t\treturn;\n\n\t\tthis._enableLightFallOff = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Define which light source types to use for diffuse reflections. This allows choosing between regular lights\n\t * and/or light probes for diffuse reflections.\n\t *\n\t * @see away3d.materials.LightSources\n\t */\n\tpublic get diffuseLightSources():number\n\t{\n\t\treturn this._diffuseLightSources;\n\t}\n\n\tpublic set diffuseLightSources(value:number)\n\t{\n\t\tif (this._diffuseLightSources == value)\n\t\t\treturn;\n\n\t\tthis._diffuseLightSources = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Define which light source types to use for specular reflections. This allows choosing between regular lights\n\t * and/or light probes for specular reflections.\n\t *\n\t * @see away3d.materials.LightSources\n\t */\n\tpublic get specularLightSources():number\n\t{\n\t\treturn this._specularLightSources;\n\t}\n\n\tpublic set specularLightSources(value:number)\n\t{\n\t\tif (this._specularLightSources == value)\n\t\t\treturn;\n\n\t\tthis._specularLightSources = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Cleans up resources owned by the material, including passes. Textures are not owned by the material since they\n\t * could be used by other materials and will not be disposed.\n\t */\n\tpublic dispose()\n\t{\n\t\tvar i:number;\n\t\tvar len:number;\n\n\t\tthis._pClearScreenPasses();\n\n\t\tlen = this._materialData.length;\n\t\tfor (i = 0; i < len; i++)\n\t\t\tthis._materialData[i].dispose();\n\n\t\tthis._materialData = new Array<IMaterialData>();\n\n\t\tlen = this._materialPassData.length;\n\t\tfor (i = 0; i < len; i++)\n\t\t\tthis._materialPassData[i].dispose();\n\n\t\tthis._materialPassData = new Array<IMaterialPassData>();\n\t}\n\n\t/**\n\t * Defines whether or not the material should cull triangles facing away from the camera.\n\t */\n\tpublic get bothSides():boolean\n\t{\n\t\treturn this._bothSides;\n\t}\n\n\tpublic set bothSides(value:boolean)\n\t{\n\t\tif (this._bothSides = value)\n\t\t\treturn;\n\n\t\tthis._bothSides = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The blend mode to use when drawing this renderable. The following blend modes are supported:\n\t * <ul>\n\t * <li>BlendMode.NORMAL: No blending, unless the material inherently needs it</li>\n\t * <li>BlendMode.LAYER: Force blending. This will draw the object the same as NORMAL, but without writing depth writes.</li>\n\t * <li>BlendMode.MULTIPLY</li>\n\t * <li>BlendMode.ADD</li>\n\t * <li>BlendMode.ALPHA</li>\n\t * </ul>\n\t */\n\tpublic get blendMode():string\n\t{\n\t\treturn this._pBlendMode;\n\t}\n\n\tpublic set blendMode(value:string)\n\t{\n\t\tif (this._pBlendMode == value)\n\t\t\treturn;\n\n\t\tthis._pBlendMode = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Indicates whether visible textures (or other pixels) used by this material have\n\t * already been premultiplied. Toggle this if you are seeing black halos around your\n\t * blended alpha edges.\n\t */\n\tpublic get alphaPremultiplied():boolean\n\t{\n\t\treturn this._alphaPremultiplied;\n\t}\n\n\tpublic set alphaPremultiplied(value:boolean)\n\t{\n\t\tif (this._alphaPremultiplied == value)\n\t\t\treturn;\n\n\t\tthis._alphaPremultiplied = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * The minimum alpha value for which pixels should be drawn. This is used for transparency that is either\n\t * invisible or entirely opaque, often used with textures for foliage, etc.\n\t * Recommended values are 0 to disable alpha, or 0.5 to create smooth edges. Default value is 0 (disabled).\n\t */\n\tpublic get alphaThreshold():number\n\t{\n\t\treturn this._pAlphaThreshold;\n\t}\n\n\tpublic set alphaThreshold(value:number)\n\t{\n\t\tif (value < 0)\n\t\t\tvalue = 0;\n\t\telse if (value > 1)\n\t\t\tvalue = 1;\n\n\t\tif (this._pAlphaThreshold == value)\n\t\t\treturn;\n\n\t\tthis._pAlphaThreshold = value;\n\n\t\tthis._pInvalidatePasses();\n\t}\n\n\t/**\n\t * Indicates whether or not the material requires alpha blending during rendering.\n\t */\n\tpublic get requiresBlending():boolean\n\t{\n\t\treturn this._pRequiresBlending;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._pWidth;\n\t}\n\n\t/**\n\t * Sets the render state for a pass that is independent of the rendered object. This needs to be called before\n\t * calling renderPass. Before activating a pass, the previously used pass needs to be deactivated.\n\t * @param pass The pass data to activate.\n\t * @param stage The Stage object which is currently used for rendering.\n\t * @param camera The camera from which the scene is viewed.\n\t * @private\n\t */\n\tpublic _iActivatePass(pass:IMaterialPassData, renderer:IRenderer, camera:Camera) // ARCANE\n\t{\n\t\tpass.materialPass._iActivate(pass, renderer, camera);\n\t}\n\n\t/**\n\t * Clears the render state for a pass. This needs to be called before activating another pass.\n\t * @param pass The pass to deactivate.\n\t * @param stage The Stage used for rendering\n\t *\n\t * @internal\n\t */\n\tpublic _iDeactivatePass(pass:IMaterialPassData, renderer:IRenderer) // ARCANE\n\t{\n\t\tpass.materialPass._iDeactivate(pass, renderer);\n\t}\n\n\t/**\n\t * Renders the current pass. Before calling renderPass, activatePass needs to be called with the same index.\n\t * @param pass The pass used to render the renderable.\n\t * @param renderable The IRenderable object to draw.\n\t * @param stage The Stage object used for rendering.\n\t * @param entityCollector The EntityCollector object that contains the visible scene data.\n\t * @param viewProjection The view-projection matrix used to project to the screen. This is not the same as\n\t * camera.viewProjection as it includes the scaling factors when rendering to textures.\n\t *\n\t * @internal\n\t */\n\tpublic _iRenderPass(pass:IMaterialPassData, renderable:IRenderable, stage:IStage, camera:Camera, viewProjection:Matrix3D)\n\t{\n\t\tif (this._pLightPicker)\n\t\t\tthis._pLightPicker.collectLights(renderable);\n\n\t\tpass.materialPass._iRender(pass, renderable, stage, camera, viewProjection);\n\t}\n\n\t//\n\t// MATERIAL MANAGEMENT\n\t//\n\t/**\n\t * Mark an IMaterialOwner as owner of this material.\n\t * Assures we're not using the same material across renderables with different animations, since the\n\t * Programs depend on animation. This method needs to be called when a material is assigned.\n\t *\n\t * @param owner The IMaterialOwner that had this material assigned\n\t *\n\t * @internal\n\t */\n\tpublic iAddOwner(owner:IMaterialOwner)\n\t{\n\t\tthis._owners.push(owner);\n\n\t\tvar animationSet:IAnimationSet;\n\t\tvar animator:IAnimator = <IAnimator> owner.animator;\n\n\t\tif (animator)\n\t\t\tanimationSet = <IAnimationSet> animator.animationSet;\n\n\t\tif (owner.animator) {\n\t\t\tif (this._animationSet && animationSet != this._animationSet) {\n\t\t\t\tthrow new Error(\"A Material instance cannot be shared across material owners with different animation sets\");\n\t\t\t} else {\n\t\t\t\tif (this._animationSet != animationSet) {\n\n\t\t\t\t\tthis._animationSet = animationSet;\n\n\t\t\t\t\tthis.invalidateAnimation();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Removes an IMaterialOwner as owner.\n\t * @param owner\n\t *\n\t * @internal\n\t */\n\tpublic iRemoveOwner(owner:IMaterialOwner)\n\t{\n\t\tthis._owners.splice(this._owners.indexOf(owner), 1);\n\n\t\tif (this._owners.length == 0) {\n\t\t\tthis._animationSet = null;\n\n\t\t\tthis.invalidateAnimation();\n\t\t}\n\t}\n\n\t/**\n\t * A list of the IMaterialOwners that use this material\n\t *\n\t * @private\n\t */\n\tpublic get iOwners():Array<IMaterialOwner>\n\t{\n\t\treturn this._owners;\n\t}\n\n\t/**\n\t * The amount of passes used by the material.\n\t *\n\t * @private\n\t */\n\tpublic _iNumScreenPasses():number\n\t{\n\t\treturn this._numPasses;\n\t}\n\n\t/**\n\t * A list of the screen passes used in this material\n\t *\n\t * @private\n\t */\n\tpublic get _iScreenPasses():Array<IMaterialPass>\n\t{\n\t\treturn this._passes;\n\t}\n\n\t/**\n\t * Marks the shader programs for all passes as invalid, so they will be recompiled before the next use.\n\t *\n\t * @private\n\t */\n\tpublic _pInvalidatePasses()\n\t{\n\t\tvar len:number = this._materialPassData.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._materialPassData[i].invalidate();\n\n\t\tthis.invalidateMaterial();\n\t}\n\n\t/**\n\t * Flags that the screen passes have become invalid and need possible re-ordering / adding / deleting\n\t */\n\tpublic _pInvalidateScreenPasses()\n\t{\n\t\tthis._pScreenPassesInvalid = true;\n\t}\n\n\t/**\n\t * Removes a pass from the material.\n\t * @param pass The pass to be removed.\n\t */\n\tpublic _pRemoveScreenPass(pass:IMaterialPass)\n\t{\n\t\tpass.removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\t\tthis._passes.splice(this._passes.indexOf(pass), 1);\n\n\t\tthis._numPasses--;\n\t}\n\n\t/**\n\t * Removes all passes from the material\n\t */\n\tpublic _pClearScreenPasses()\n\t{\n\t\tfor (var i:number = 0; i < this._numPasses; ++i)\n\t\t\tthis._passes[i].removeEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\n\t\tthis._passes.length = this._numPasses = 0;\n\t}\n\n\t/**\n\t * Adds a pass to the material\n\t * @param pass\n\t */\n\tpublic _pAddScreenPass(pass:IMaterialPass)\n\t{\n\t\tthis._passes[this._numPasses++] = pass;\n\n\t\tpass.lightPicker = this._pLightPicker;\n\t\tpass.addEventListener(Event.CHANGE, this._onPassChangeDelegate);\n\n\t\tthis.invalidateMaterial();\n\t}\n\n\tpublic _iAddMaterialData(materialData:IMaterialData):IMaterialData\n\t{\n\t\tthis._materialData.push(materialData);\n\n\t\treturn materialData;\n\t}\n\n\tpublic _iRemoveMaterialData(materialData:IMaterialData):IMaterialData\n\t{\n\t\tthis._materialData.splice(this._materialData.indexOf(materialData), 1);\n\n\t\treturn materialData;\n\t}\n\n\t/**\n\t * Performs any processing that needs to occur before any of its passes are used.\n\t *\n\t * @private\n\t */\n\tpublic _iUpdateMaterial()\n\t{\n\t}\n\t\n\t/**\n\t * Listener for when a pass's shader code changes. It recalculates the render order id.\n\t */\n\tprivate onPassChange(event:Event)\n\t{\n\t\tthis.invalidateMaterial();\n\t}\n\n\tprivate invalidateAnimation()\n\t{\n\t\tvar len:number = this._materialData.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._materialData[i].invalidateAnimation();\n\t}\n\t\n\tprivate invalidateMaterial()\n\t{\n\t\tvar len:number = this._materialData.length;\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._materialData[i].invalidateMaterial();\n\t}\n\n\t/**\n\t * Called when the light picker's configuration changed.\n\t */\n\tprivate onLightsChange(event:Event)\n\t{\n\t\tthis._pInvalidateScreenPasses();\n\t}\n\n\tpublic _pNotifySizeChanged()\n\t{\n\t\tif (!this._sizeChanged)\n\t\t\tthis._sizeChanged = new MaterialEvent(MaterialEvent.SIZE_CHANGED);\n\n\t\tthis.dispatchEvent(this._sizeChanged);\n\t}\n\n\tpublic _iAddMaterialPassData(materialPassData:IMaterialPassData):IMaterialPassData\n\t{\n\t\tthis._materialPassData.push(materialPassData);\n\n\t\treturn materialPassData;\n\t}\n\n\tpublic _iRemoveMaterialPassData(materialPassData:IMaterialPassData):IMaterialPassData\n\t{\n\t\tthis._materialPassData.splice(this._materialPassData.indexOf(materialPassData), 1);\n\n\t\treturn materialPassData;\n\t}\n}\n\nexport = MaterialBase;",
    "import IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IRenderableClass\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderableClass\");\n\n/**\n * @class away.pool.RenderablePool\n */\nclass RenderablePool\n{\n\tprivate static _pools:Object = new Object();\n\n\tprivate _pool:Object = new Object();\n\tprivate _renderableClass:IRenderableClass;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t */\n\tconstructor(renderableClass:IRenderableClass)\n\t{\n\t\tthis._renderableClass = renderableClass;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns IRenderable\n\t */\n\tpublic getItem(materialOwner:IMaterialOwner):IRenderable\n\t{\n\t\treturn <IRenderable> (this._pool[materialOwner.id] || (this._pool[materialOwner.id] = materialOwner._iAddRenderable(new this._renderableClass(this, materialOwner))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(materialOwner:IMaterialOwner)\n\t{\n\t\tmaterialOwner._iRemoveRenderable(this._pool[materialOwner.id]);\n\n\t\tthis._pool[materialOwner.id] = null;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t * @returns RenderablePool\n\t */\n\tpublic static getPool(renderableClass:IRenderableClass):RenderablePool\n\t{\n\t\tvar pool:RenderablePool = RenderablePool._pools[renderableClass.id];\n\n\t\tif (pool != undefined)\n\t\t\treturn pool;\n\n\t\treturn <RenderablePool> (RenderablePool._pools[renderableClass.id] = new RenderablePool(renderableClass));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param renderableClass\n\t */\n\tpublic static disposePool(renderableClass:any)\n\t{\n\t\tif (RenderablePool._pools[renderableClass.id])\n\t\t\tRenderablePool._pools[renderableClass.id] = undefined;\n\t}\n}\n\nexport = RenderablePool;",
    "import IRenderable\t\t\t\t\t= require(\"awayjs-display/lib/pool/IRenderable\");\nimport IEntitySorter\t\t\t\t= require(\"awayjs-display/lib/sort/IEntitySorter\");\n\n/**\n * @class away.sort.RenderableMergeSort\n */\nclass RenderableMergeSort implements IEntitySorter\n{\n\tpublic sortBlendedRenderables(head:IRenderable):IRenderable\n\t{\n\t\tvar headB:IRenderable;\n\t\tvar fast:IRenderable;\n\t\tvar slow:IRenderable;\n\n\t\tif (!head || !head.next) {\n\t\t\treturn head;\n\t\t}\n\n\t\t// split in two sublists\n\t\tslow = head;\n\t\tfast = head.next;\n\n\t\twhile (fast) {\n\t\t\tfast = fast.next;\n\t\t\tif (fast) {\n\t\t\t\tslow = slow.next;\n\t\t\t\tfast = fast.next;\n\t\t\t}\n\t\t}\n\n\t\theadB = slow.next;\n\t\tslow.next = null;\n\n\t\t// recurse\n\t\thead = this.sortBlendedRenderables(head);\n\t\theadB = this.sortBlendedRenderables(headB);\n\n\t\t// merge sublists while respecting order\n\t\tvar result:IRenderable;\n\t\tvar curr:IRenderable;\n\t\tvar l:IRenderable;\n\n\t\tif (!head)\n\t\t\treturn headB;\n\t\tif (!headB)\n\t\t\treturn head;\n\n\t\twhile (head && headB) {\n\t\t\tif (head.zIndex < headB.zIndex) {\n\t\t\t\tl = head;\n\t\t\t\thead = head.next;\n\t\t\t} else {\n\t\t\t\tl = headB;\n\t\t\t\theadB = headB.next;\n\t\t\t}\n\n\t\t\tif (!result)\n\t\t\t\tresult = l; else\n\t\t\t\tcurr.next = l;\n\n\t\t\tcurr = l;\n\t\t}\n\n\t\tif (head)\n\t\t\tcurr.next = head; else if (headB)\n\t\t\tcurr.next = headB;\n\n\t\treturn result;\n\t}\n\n\tpublic sortOpaqueRenderables(head:IRenderable):IRenderable\n\t{\n\t\tvar headB:IRenderable;\n\t\tvar fast:IRenderable, slow:IRenderable;\n\n\t\tif (!head || !head.next) {\n\t\t\treturn head;\n\t\t}\n\n\t\t// split in two sublists\n\t\tslow = head;\n\t\tfast = head.next;\n\n\t\twhile (fast) {\n\t\t\tfast = fast.next;\n\t\t\tif (fast) {\n\t\t\t\tslow = slow.next;\n\t\t\t\tfast = fast.next;\n\t\t\t}\n\t\t}\n\n\t\theadB = slow.next;\n\t\tslow.next = null;\n\n\t\t// recurse\n\t\thead = this.sortOpaqueRenderables(head);\n\t\theadB = this.sortOpaqueRenderables(headB);\n\n\t\t// merge sublists while respecting order\n\t\tvar result:IRenderable;\n\t\tvar curr:IRenderable;\n\t\tvar l:IRenderable;\n\t\tvar cmp:number = 0;\n\n\t\tif (!head)\n\t\t\treturn headB;\n\t\tif (!headB)\n\t\t\treturn head;\n\n\t\twhile (head && headB && head != null && headB != null) {\n\n\t\t\t// first sort per render order id (reduces program3D switches),\n\t\t\t// then on material id (reduces setting props),\n\t\t\t// then on zIndex (reduces overdraw)\n\t\t\tvar aid:number = head.renderOrderId;\n\t\t\tvar bid:number = headB.renderOrderId;\n\n\t\t\tif (aid == bid) {\n\t\t\t\tvar ma:number = head.materialId;\n\t\t\t\tvar mb:number = headB.materialId;\n\n\t\t\t\tif (ma == mb) {\n\t\t\t\t\tif (head.zIndex < headB.zIndex)\n\t\t\t\t\t\tcmp = 1; else\n\t\t\t\t\t\tcmp = -1;\n\t\t\t\t} else if (ma > mb) {\n\t\t\t\t\tcmp = 1;\n\t\t\t\t} else {\n\t\t\t\t\tcmp = -1;\n\t\t\t\t}\n\t\t\t} else if (aid > bid) {\n\t\t\t\tcmp = 1;\n\t\t\t} else {\n\t\t\t\tcmp = -1;\n\t\t\t}\n\n\t\t\tif (cmp < 0) {\n\t\t\t\tl = head;\n\t\t\t\thead = head.next;\n\t\t\t} else {\n\t\t\t\tl = headB;\n\t\t\t\theadB = headB.next;\n\t\t\t}\n\n\t\t\tif (!result) {\n\t\t\t\tresult = l;\n\t\t\t\tcurr = l;\n\t\t\t} else {\n\t\t\t\tcurr.next = l;\n\t\t\t\tcurr = l;\n\t\t\t}\n\t\t}\n\n\t\tif (head)\n\t\t\tcurr.next = head; else if (headB)\n\t\t\tcurr.next = headB;\n\n\t\treturn result;\n\t}\n}\n\nexport = RenderableMergeSort;",
    "import LightBase\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport CollectorBase\t\t\t\t= require(\"awayjs-display/lib/traverse/CollectorBase\");\nimport DirectionalLight\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport IEntity\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/IEntity\");\nimport LightProbe\t\t\t\t\t= require(\"awayjs-display/lib/entities/LightProbe\");\nimport PointLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport Skybox\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\n\n/**\n * @class away.traverse.EntityCollector\n */\nclass EntityCollector extends CollectorBase\n{\n\tpublic _pSkybox:Skybox;\n\tpublic _pLights:Array<LightBase>;\n\tprivate _directionalLights:Array<DirectionalLight>;\n\tprivate _pointLights:Array<PointLight>;\n\tprivate _lightProbes:Array<LightProbe>;\n\n\tpublic _pNumLights:number = 0;\n\n\tprivate _numDirectionalLights:number = 0;\n\tprivate _numPointLights:number = 0;\n\tprivate _numLightProbes:number = 0;\n\n\t/**\n\t *\n\t */\n\tpublic get directionalLights():Array<DirectionalLight>\n\t{\n\t\treturn this._directionalLights;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get lightProbes():Array<LightProbe>\n\t{\n\t\treturn this._lightProbes;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get lights():Array<LightBase>\n\t{\n\t\treturn this._pLights;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get pointLights():Array<PointLight>\n\t{\n\t\treturn this._pointLights;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic get skyBox():Skybox\n\t{\n\t\treturn this._pSkybox;\n\t}\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._pLights = new Array<LightBase>();\n\t\tthis._directionalLights = new Array<DirectionalLight>();\n\t\tthis._pointLights = new Array<PointLight>();\n\t\tthis._lightProbes = new Array<LightProbe>();\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyDirectionalLight(entity:IEntity)\n\t{\n\t\tthis._directionalLights[ this._numDirectionalLights++ ] = <DirectionalLight> entity;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyLightProbe(entity:IEntity)\n\t{\n\t\tthis._lightProbes[ this._numLightProbes++ ] = <LightProbe> entity;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applyPointLight(entity:IEntity)\n\t{\n\t\tthis._pointLights[ this._numPointLights++ ] = <PointLight> entity;\n\t}\n\n\t/**\n\t *\n\t * @param entity\n\t */\n\tpublic applySkybox(entity:IEntity)\n\t{\n\t\tthis._pSkybox = <Skybox> entity;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clear()\n\t{\n\t\tsuper.clear();\n\n\t\tthis._pSkybox = null;\n\n\t\tif (this._pNumLights > 0)\n\t\t\tthis._pLights.length = this._pNumLights = 0;\n\n\t\tif (this._numDirectionalLights > 0)\n\t\t\tthis._directionalLights.length = this._numDirectionalLights = 0;\n\n\t\tif (this._numPointLights > 0)\n\t\t\tthis._pointLights.length = this._numPointLights = 0;\n\n\t\tif (this._numLightProbes > 0)\n\t\t\tthis._lightProbes.length = this._numLightProbes = 0;\n\t}\n}\n\nexport = EntityCollector;",
    "import ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Description\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Description\");\nimport Header\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Header\");\nimport Mapping\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Mapping\");\nimport Token\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Token\");\n\nclass AGALTokenizer\n{\n\tconstructor()\n\t{\n\t}\n\n\tpublic decribeAGALByteArray(bytes:ByteArray)\n\t{\n\t\tvar header:Header = new Header();\n\n\t\tif (bytes.readUnsignedByte() != 0xa0) {\n\t\t\tthrow \"Bad AGAL: Missing 0xa0 magic byte.\";\n\t\t}\n\n\t\theader.version = bytes.readUnsignedInt();\n\t\tif (header.version >= 0x10) {\n\t\t\tbytes.readUnsignedByte();\n\t\t\theader.version >>= 1;\n\t\t}\n\t\tif (bytes.readUnsignedByte() != 0xa1) {\n\t\t\tthrow \"Bad AGAL: Missing 0xa1 magic byte.\";\n\t\t}\n\n\t\theader.progid = bytes.readUnsignedByte();\n\t\tswitch (header.progid) {\n\t\t\tcase 1:\n\t\t\t\theader.type = \"fragment\";\n\t\t\t\tbreak;\n\t\t\tcase 0:\n\t\t\t\theader.type = \"vertex\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\theader.type = \"cpu\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\theader.type = \"\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tvar desc:Description = new Description();\n\t\tvar tokens:Token[] = [];\n\t\twhile (bytes.position < bytes.length) {\n\t\t\tvar token:Token = new Token();\n\n\t\t\ttoken.opcode = bytes.readUnsignedInt();\n\t\t\tvar lutentry = Mapping.agal2glsllut[token.opcode];\n\t\t\tif (!lutentry) {\n\t\t\t\tthrow \"Opcode not valid or not implemented yet: \" + token.opcode;\n\t\t\t}\n\t\t\tif (lutentry.matrixheight) {\n\t\t\t\tdesc.hasmatrix = true;\n\t\t\t}\n\t\t\tif (lutentry.dest) {\n\t\t\t\ttoken.dest.regnum = bytes.readUnsignedShort();\n\t\t\t\ttoken.dest.mask = bytes.readUnsignedByte();\n\t\t\t\ttoken.dest.regtype = bytes.readUnsignedByte();\n\t\t\t\tdesc.regwrite[token.dest.regtype][token.dest.regnum] |= token.dest.mask;\n\t\t\t} else {\n\t\t\t\ttoken.dest = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\tif (lutentry.a) {\n\t\t\t\tthis.readReg(token.a, 1, desc, bytes);\n\t\t\t} else {\n\t\t\t\ttoken.a = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\tif (lutentry.b) {\n\t\t\t\tthis.readReg(token.b, lutentry.matrixheight | 0, desc, bytes);\n\t\t\t} else {\n\t\t\t\ttoken.b = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\ttokens.push(token);\n\t\t}\n\t\tdesc.header = header;\n\t\tdesc.tokens = tokens;\n\n\t\treturn desc;\n\t}\n\n\tpublic readReg(s, mh, desc, bytes)\n\t{\n\t\ts.regnum = bytes.readUnsignedShort();\n\t\ts.indexoffset = bytes.readByte();\n\t\ts.swizzle = bytes.readUnsignedByte();\n\t\ts.regtype = bytes.readUnsignedByte();\n\t\tdesc.regread[s.regtype][s.regnum] = 0xf; // sould be swizzle to mask? should be |=                                                 \n\t\tif (s.regtype == 0x5) {\n\t\t\t// sampler\n\t\t\ts.lodbiad = s.indexoffset;\n\t\t\ts.indexoffset = undefined;\n\t\t\ts.swizzle = undefined;\n\n\t\t\t// sampler \n\t\t\ts.readmode = bytes.readUnsignedByte();\n\t\t\ts.dim = s.readmode >> 4;\n\t\t\ts.readmode &= 0xf;\n\t\t\ts.special = bytes.readUnsignedByte();\n\t\t\ts.wrap = s.special >> 4;\n\t\t\ts.special &= 0xf;\n\t\t\ts.mipmap = bytes.readUnsignedByte();\n\t\t\ts.filter = s.mipmap >> 4;\n\t\t\ts.mipmap &= 0xf;\n\t\t\tdesc.samplers[s.regnum] = s;\n\t\t} else {\n\t\t\ts.indexregtype = bytes.readUnsignedByte();\n\t\t\ts.indexselect = bytes.readUnsignedByte();\n\t\t\ts.indirectflag = bytes.readUnsignedByte();\n\t\t}\n\t\tif (s.indirectflag) {\n\t\t\tdesc.hasindirect = true;\n\t\t}\n\t\tif (!s.indirectflag && mh) {\n\t\t\tfor (var mhi:number = 0; mhi < mh; mhi++) //TODO wrong, should be |=\n\t\t\t{\n\t\t\t\tdesc.regread[s.regtype][s.regnum + mhi] = desc.regread[s.regtype][s.regnum];\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport = AGALTokenizer;",
    "import Description\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Description\");\nimport Mapping\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Mapping\");\nimport ContextStage3D\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\n\nclass AGLSLParser\n{\n\tpublic parse(desc:Description)\n\t{\n\t\tvar header:string = \"\";\n\t\tvar body:string = \"\";\n\n\t\theader += \"precision highp float;\\n\";\n\t\tvar tag = desc.header.type[0]; //TODO\n\n\t\t// declare uniforms\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\theader += \"uniform float yflip;\\n\";\n\t\t}\n\t\tif (!desc.hasindirect) {\n\t\t\tfor (var i:number = 0; i < desc.regread[0x1].length; i++) {\n\t\t\t\tif (desc.regread[0x1][i]) {\n\t\t\t\t\theader += \"uniform vec4 \" + tag + \"c\" + i + \";\\n\";\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\theader += \"uniform vec4 \" + tag + \"carrr[\" + ContextStage3D.maxvertexconstants + \"];\\n\";                // use max const count instead\n\t\t}\n\n\t\t// declare temps\n\t\tfor (var i = 0; i < desc.regread[0x2].length || i < desc.regwrite[0x2].length; i++) {\n\t\t\tif (desc.regread[0x2][i] || desc.regwrite[0x2][i]) // duh, have to check write only also...\n\t\t\t{\n\t\t\t\theader += \"vec4 \" + tag + \"t\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare streams\n\t\tfor (var i:number = 0; i < desc.regread[0x0].length; i++) {\n\t\t\tif (desc.regread[0x0][i]) {\n\t\t\t\theader += \"attribute vec4 va\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare interpolated\n\t\tfor (var i:number = 0; i < desc.regread[0x4].length || i < desc.regwrite[0x4].length; i++) {\n\t\t\tif (desc.regread[0x4][i] || desc.regwrite[0x4][i]) {\n\t\t\t\theader += \"varying vec4 vi\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare samplers\n\t\tvar samptype:Array<string> = [\"2D\", \"Cube\", \"3D\", \"\"];\n\t\tfor (var i:number = 0; i < desc.samplers.length; i++) {\n\t\t\tif (desc.samplers[i]) {\n\t\t\t\theader += \"uniform sampler\" + samptype[ desc.samplers[i].dim & 3 ] + \" fs\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// extra gl fluff: setup position and depth adjust temps\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\theader += \"vec4 outpos;\\n\";\n\t\t}\n\t\tif (desc.writedepth) {\n\t\t\theader += \"vec4 tmp_FragDepth;\\n\";\n\t\t}\n\t\t//if ( desc.hasmatrix ) \n\t\t//    header += \"vec4 tmp_matrix;\\n\";\n\n\t\t// start body of code\n\t\tbody += \"void main() {\\n\";\n\n\t\tfor (var i:number = 0; i < desc.tokens.length; i++) {\n\t\t\tvar lutentry = Mapping.agal2glsllut[desc.tokens[i].opcode];\n\t\t\tif (!lutentry) {\n\t\t\t\tthrow \"Opcode not valid or not implemented yet: \"\n\t\t\t\t/*+token.opcode;*/\n\t\t\t}\n\t\t\tvar sublines = lutentry.matrixheight || 1;\n\n\t\t\tfor (var sl:number = 0; sl < sublines; sl++) {\n\t\t\t\tvar line:string = \"  \" + lutentry.s;\n\t\t\t\tif (desc.tokens[i].dest) {\n\t\t\t\t\tif (lutentry.matrixheight) {\n\t\t\t\t\t\tif (((desc.tokens[i].dest.mask >> sl) & 1) != 1) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar destregstring:string = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n\t\t\t\t\t\tvar destcaststring:string = \"float\";\n\t\t\t\t\t\tvar destmaskstring = [\"x\", \"y\", \"z\", \"w\"][sl];\n\t\t\t\t\t\tdestregstring += \".\" + destmaskstring;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar destregstring:string = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n\t\t\t\t\t\tvar destcaststring:string;\n\t\t\t\t\t\tvar destmaskstring:string;\n\t\t\t\t\t\tif (desc.tokens[i].dest.mask != 0xf) {\n\t\t\t\t\t\t\tvar ndest:number = 0;\n\t\t\t\t\t\t\tdestmaskstring = \"\";\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 1) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"x\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 2) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"y\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 4) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"z\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 8) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"w\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdestregstring += \".\" + destmaskstring;\n\t\t\t\t\t\t\tswitch (ndest) {\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"float\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"vec2\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"vec3\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tthrow \"Unexpected destination mask\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdestcaststring = \"vec4\";\n\t\t\t\t\t\t\tdestmaskstring = \"xyzw\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tline = line.replace(\"%dest\", destregstring);\n\t\t\t\t\tline = line.replace(\"%cast\", destcaststring);\n\t\t\t\t\tline = line.replace(\"%dm\", destmaskstring);\n\t\t\t\t}\n\t\t\t\tvar dwm:number = 0xf;\n\t\t\t\tif (!lutentry.ndwm && lutentry.dest && desc.tokens[i].dest) {\n\t\t\t\t\tdwm = desc.tokens[i].dest.mask;\n\t\t\t\t}\n\t\t\t\tif (desc.tokens[i].a) {\n\t\t\t\t\tline = line.replace(\"%a\", this.sourcetostring(desc.tokens[i].a, 0, dwm, lutentry.scalar, desc, tag));\n\t\t\t\t}\n\t\t\t\tif (desc.tokens[i].b) {\n\t\t\t\t\tline = line.replace(\"%b\", this.sourcetostring(desc.tokens[i].b, sl, dwm, lutentry.scalar, desc, tag));\n\t\t\t\t\tif (desc.tokens[i].b.regtype == 0x5) {\n\t\t\t\t\t\t// sampler dim\n\t\t\t\t\t\tvar texdim = [\"2D\", \"Cube\", \"3D\"][desc.tokens[i].b.dim];\n\t\t\t\t\t\tvar texsize = [\"vec2\", \"vec3\", \"vec3\"][desc.tokens[i].b.dim];\n\t\t\t\t\t\tline = line.replace(\"%texdim\", texdim);\n\t\t\t\t\t\tline = line.replace(\"%texsize\", texsize);\n\t\t\t\t\t\tvar texlod:string = \"\";\n\t\t\t\t\t\tline = line.replace(\"%lod\", texlod);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbody += line;\n\t\t\t}\n\t\t}\n\n\t\t// adjust z from opengl range of -1..1 to 0..1 as in d3d, this also enforces a left handed coordinate system\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\tbody += \"  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\\n\";\n\t\t}\n\n\t\t// clamp fragment depth\n\t\tif (desc.writedepth) {\n\t\t\tbody += \"  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\\n\";\n\t\t}\n\n\t\t// close main\n\t\tbody += \"}\\n\";\n\n\t\treturn header + body;\n\t}\n\n\tpublic regtostring(regtype:number, regnum:number, desc:Description, tag)\n\t{\n\t\tswitch (regtype) {\n\t\t\tcase 0x0:\n\t\t\t\treturn \"va\" + regnum;\n\t\t\tcase 0x1:\n\t\t\t\tif (desc.hasindirect && desc.header.type == \"vertex\") {\n\t\t\t\t\treturn \"vcarrr[\" + regnum + \"]\";\n\t\t\t\t} else {\n\t\t\t\t\treturn tag + \"c\" + regnum;\n\t\t\t\t}\n\t\t\tcase 0x2:\n\t\t\t\treturn tag + \"t\" + regnum;\n\t\t\tcase 0x3:\n\t\t\t\treturn desc.header.type == \"vertex\"? \"outpos\" : \"gl_FragColor\";\n\t\t\tcase 0x4:\n\t\t\t\treturn \"vi\" + regnum;\n\t\t\tcase 0x5:\n\t\t\t\treturn \"fs\" + regnum;\n\t\t\tcase 0x6:\n\t\t\t\treturn \"tmp_FragDepth\";\n\t\t\tdefault:\n\t\t\t\tthrow \"Unknown register type\";\n\t\t}\n\t}\n\n\tpublic sourcetostring(s, subline, dwm, isscalar, desc, tag):string\n\t{\n\t\tvar swiz = [ \"x\", \"y\", \"z\", \"w\" ];\n\t\tvar r;\n\n\t\tif (s.indirectflag) {\n\t\t\tr = \"vcarrr[int(\" + this.regtostring(s.indexregtype, s.regnum, desc, tag) + \".\" + swiz[s.indexselect] + \")\";\n\t\t\tvar realofs = subline + s.indexoffset;\n\t\t\tif (realofs < 0) r += realofs.toString();\n\t\t\tif (realofs > 0) r += \"+\" + realofs.toString();\n\t\t\tr += \"]\";\n\t\t} else {\n\t\t\tr = this.regtostring(s.regtype, s.regnum + subline, desc, tag);\n\t\t}\n\n\t\t// samplers never add swizzle        \n\t\tif (s.regtype == 0x5) {\n\t\t\treturn r;\n\t\t}\n\n\t\t// scalar, first component only\n\t\tif (isscalar) {\n\t\t\treturn r + \".\" + swiz[(s.swizzle >> 0) & 3];\n\t\t}\n\n\t\t// identity\n\t\tif (s.swizzle == 0xe4 && dwm == 0xf) {\n\t\t\treturn r;\n\t\t}\n\n\t\t// with destination write mask folded in\n\t\tr += \".\";\n\t\tif (dwm & 1) r += swiz[(s.swizzle >> 0) & 3];\n\t\tif (dwm & 2) r += swiz[(s.swizzle >> 2) & 3];\n\t\tif (dwm & 4) r += swiz[(s.swizzle >> 4) & 3];\n\t\tif (dwm & 8) r += swiz[(s.swizzle >> 6) & 3];\n\t\treturn r;\n\t}\n}\n\nexport = AGLSLParser;",
    "import Header\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Header\");\nimport Token\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Token\");\n\nclass Description\n{\n\tpublic regread:any[] = [\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[]\n\t];\n\tpublic regwrite:any[] = [\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[]\n\t];\n\tpublic hasindirect:boolean = false;\n\tpublic writedepth:boolean = false;\n\tpublic hasmatrix:boolean = false;\n\tpublic samplers:any[] = [];\n\n\t// added due to dynamic assignment 3*0xFFFFFFuuuu\n\tpublic tokens:Token[] = [];\n\tpublic header:Header = new Header();\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = Description;",
    "class Destination\n{\n\tpublic mask:number = 0;\n\tpublic regnum:number = 0;\n\tpublic regtype:number = 0;\n\tpublic dim:number = 0;\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = Destination;",
    "class Header\n{\n\tpublic progid:number = 0;\n\tpublic version:number = 0;\n\tpublic type:string = \"\";\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = Header;",
    "import OpLUT\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/OpLUT\");\n\nclass Mapping\n{\n\tstatic agal2glsllut:Array<OpLUT> = [\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\tflags   dest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(%a);\\n\", 0, true, true, false, null, null, null, null, null, null), //mov\n\t\tnew OpLUT(\"%dest = %cast(%a + %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //add\n\t\tnew OpLUT(\"%dest = %cast(%a - %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //sub\n\t\tnew OpLUT(\"%dest = %cast(%a * %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //mul\n\t\tnew OpLUT(\"%dest = %cast(%a / %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //div\n\t\tnew OpLUT(\"%dest = %cast(1.0) / %a;\\n\", 0, true, true, false, null, null, null, null, null, null), //rcp\n\t\tnew OpLUT(\"%dest = %cast(min(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //min\n\t\tnew OpLUT(\"%dest = %cast(max(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //max\n\t\tnew OpLUT(\"%dest = %cast(fract(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //frc\n\t\tnew OpLUT(\"%dest = %cast(sqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //sqt\n\t\tnew OpLUT(\"%dest = %cast(inversesqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //rsq\n\t\tnew OpLUT(\"%dest = %cast(pow(abs(%a),%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //pow\n\t\tnew OpLUT(\"%dest = %cast(log2(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //log\n\t\tnew OpLUT(\"%dest = %cast(exp2(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //exp\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(normalize(vec3( %a ) ));\\n\", 0, true, true, false, null, null, true, null, null, null), //nrm\n\t\tnew OpLUT(\"%dest = %cast(sin(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //sin\n\t\tnew OpLUT(\"%dest = %cast(cos(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //cos\n\t\tnew OpLUT(\"%dest = %cast(cross(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //crs\n\t\tnew OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //dp3\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //dp4\n\t\tnew OpLUT(\"%dest = %cast(abs(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //abs\n\t\tnew OpLUT(\"%dest = %cast(%a * -1.0);\\n\", 0, true, true, false, null, null, null, null, null, null), //neg\n\t\tnew OpLUT(\"%dest = %cast(clamp(%a,0.0,1.0));\\n\", 0, true, true, false, null, null, null, null, null, null), //sat\n\t\tnew OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", null, true, true, true, 3, 3, true, null, null, null), //m33\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 4, true, null, null, null), //m44\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 3, true, null, null, null), //m43\n\t\tnew OpLUT(\"%dest = %cast(dFdx(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //dFdx\n\t\tnew OpLUT(\"%dest = %cast(dFdx(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //dFdx\n\t\tnew OpLUT(\"if (float(%a)==float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)!=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)>=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)<float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"} else {;\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT(\"};\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null),\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\\n\", null, true, true, true, null, null, null, null, true, null), new OpLUT(\"if ( float(%a)<0.0 ) discard;\\n\", null, false, true, false, null, null, null, true, null, null), new OpLUT(\"%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\\n\", null, true, true, true, null, null, true, null, true, true), new OpLUT(\"%dest = %cast(greaterThanEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(lessThan(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(sign(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), new OpLUT(\"%dest = %cast(equal(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(notEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null)\n\n\t];\n\n\t//TODO: get rid of hack that fixes including definition file\n\tconstructor(include?:OpLUT)\n\t{\n\n\t}\n}\n\nexport = Mapping;",
    "class OpLUT\n{\n\n\tpublic s:string;\n\tpublic flags:number;\n\tpublic dest:boolean;\n\tpublic a:boolean;\n\tpublic b:boolean;\n\tpublic matrixwidth:number;\n\tpublic matrixheight:number;\n\tpublic ndwm:boolean;\n\tpublic scalar:boolean;\n\tpublic dm:boolean;\n\tpublic lod:boolean;\n\n\tconstructor(s:string, flags:number, dest:boolean, a:boolean, b:boolean, matrixwidth:number, matrixheight:number, ndwm:boolean, scaler:boolean, dm:boolean, lod:boolean)\n\t{\n\t\tthis.s = s;\n\t\tthis.flags = flags;\n\t\tthis.dest = dest;\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.matrixwidth = matrixwidth;\n\t\tthis.matrixheight = matrixheight;\n\t\tthis.ndwm = ndwm;\n\t\tthis.scalar = scaler;\n\t\tthis.dm = dm;\n\t\tthis.lod = lod;\n\t}\n}\n\nexport = OpLUT;",
    "class Sampler\n{\n\tpublic lodbias:number = 0;\n\tpublic dim:number = 0;\n\tpublic readmode:number = 0;\n\tpublic special:number = 0;\n\tpublic wrap:number = 0;\n\tpublic mipmap:number = 0;\n\tpublic filter:number = 0;\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = Sampler;",
    "import Destination\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Destination\");\n\nclass Token\n{\n\tpublic dest:Destination = new Destination();\n\tpublic opcode:number = 0;\n\tpublic a:Destination = new Destination();\n\tpublic b:Destination = new Destination();\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = Token;",
    "import Sampler\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Sampler\");\nimport Opcode\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Opcode\");\nimport OpcodeMap\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap\");\nimport Part\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Part\");\nimport RegMap\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/RegMap\");\nimport SamplerMap\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/SamplerMap\");\n\n\nclass AGALMiniAssembler\n{\n\tpublic r:Object;\n\tpublic cur:Part;\n\n\tconstructor()\n\t{\n\t\tthis.r = {};\n\t\tthis.cur = new Part();\n\t}\n\n\tpublic assemble(source:string, ext_part = null, ext_version = null)\n\t{\n\t\tif (!ext_version) {\n\t\t\text_version = 1;\n\t\t}\n\n\t\tif (ext_part) {\n\t\t\tthis.addHeader(ext_part, ext_version);\n\t\t}\n\n\t\tvar lines = source.replace(/[\\f\\n\\r\\v]+/g, \"\\n\").split(\"\\n\"); // handle breaks, then split into lines\n\n\t\tfor (var i in lines) {\n\t\t\tthis.processLine(lines[i], i);\n\t\t}\n\n\t\treturn this.r;\n\t}\n\n\tprivate processLine(line, linenr)\n\t{\n\t\tvar startcomment:number = line.search(\"//\");  // remove comments\n\t\tif (startcomment != -1) {\n\t\t\tline = line.slice(0, startcomment);\n\t\t}\n\t\tline = line.replace(/^\\s+|\\s+$/g, \"\"); // remove outer space\n\t\tif (!(line.length > 0 )) {\n\t\t\treturn;\n\t\t}\n\t\tvar optsi:number = line.search(/<.*>/g); // split of options part <*> if there\n\t\tvar opts:string[] = null;\n\t\tif (optsi != -1) {\n\t\t\topts = line.slice(optsi).match(/([\\w\\.\\-\\+]+)/gi);\n\t\t\tline = line.slice(0, optsi);\n\t\t}\n\n\t\t// get opcode/command\t\t\t\t            \n\t\tvar tokens = line.match(/([\\w\\.\\+\\[\\]]+)/gi); // get tokens in line\n\t\tif (!tokens || tokens.length < 1) {\n\t\t\tif (line.length >= 3) {\n\t\t\t\tconsole.log(\"Warning: bad line \" + linenr + \": \" + line);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t//console.log ( linenr, line, cur, tokens ); \n\t\tswitch (tokens[0]) {\n\t\t\tcase \"part\":\n\t\t\t\tthis.addHeader(tokens[1], Number(tokens[2]));\n\t\t\t\tbreak;\n\t\t\tcase \"endpart\":\n\t\t\t\tif (!this.cur) {\n\t\t\t\t\tthrow \"Unexpected endpart\";\n\t\t\t\t}\n\t\t\t\tthis.cur.data.position = 0;\n\t\t\t\tthis.cur = null;\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\tif (!this.cur) {\n\t\t\t\t\tconsole.log(\"Warning: bad line \" + linenr + \": \" + line + \" (Outside of any part definition)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.cur.name == \"comment\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar op:Opcode = <Opcode> OpcodeMap.map[tokens[0]];\n\t\t\t\tif (!op) {\n\t\t\t\t\tthrow \"Bad opcode \" + tokens[0] + \" \" + linenr + \": \" + line;\n\t\t\t\t}\n\t\t\t\t// console.log( 'AGALMiniAssembler' , 'op' , op );\n\n\t\t\t\tthis.emitOpcode(this.cur, op.opcode);\n\t\t\t\tvar ti:number = 1;\n\t\t\t\tif (op.dest && op.dest != \"none\") {\n\t\t\t\t\tif (!this.emitDest(this.cur, tokens[ti++], op.dest)) {\n\t\t\t\t\t\tthrow \"Bad destination register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroDword(this.cur);\n\t\t\t\t}\n\n\t\t\t\tif (op.a && op.a.format != \"none\") {\n\t\t\t\t\tif (!this.emitSource(this.cur, tokens[ti++], op.a)) throw \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroQword(this.cur);\n\t\t\t\t}\n\n\t\t\t\tif (op.b && op.b.format != \"none\") {\n\t\t\t\t\tif (op.b.format == \"sampler\") {\n\t\t\t\t\t\tif (!this.emitSampler(this.cur, tokens[ti++], op.b, opts)) {\n\t\t\t\t\t\t\tthrow \"Bad sampler register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!this.emitSource(this.cur, tokens[ti++], op.b)) {\n\t\t\t\t\t\t\tthrow \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroQword(this.cur);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic emitHeader(pr:Part)\n\t{\n\t\tpr.data.writeUnsignedByte(0xa0); \t// tag version\n\t\tpr.data.writeUnsignedInt(pr.version);\n\t\tif (pr.version >= 0x10) {\n\t\t\tpr.data.writeUnsignedByte(0); // align, for higher versions\n\t\t}\n\t\tpr.data.writeUnsignedByte(0xa1);\t\t// tag program id\n\t\tswitch (pr.name) {\n\t\t\tcase \"fragment\" :\n\t\t\t\tpr.data.writeUnsignedByte(1);\n\t\t\t\tbreak;\n\t\t\tcase \"vertex\" :\n\t\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\t\tbreak;\n\t\t\tcase \"cpu\" :\n\t\t\t\tpr.data.writeUnsignedByte(2);\n\t\t\t\tbreak;\n\t\t\tdefault :\n\t\t\t\tpr.data.writeUnsignedByte(0xff);\n\t\t\t\tbreak; // unknown/comment\n\t\t}\n\t}\n\n\tpublic emitOpcode(pr:Part, opcode)\n\t{\n\t\tpr.data.writeUnsignedInt(opcode);\n\t\t//console.log ( \"Emit opcode: \", opcode ); \n\t}\n\n\tpublic emitZeroDword(pr:Part)\n\t{\n\t\tpr.data.writeUnsignedInt(0);\n\t}\n\n\tpublic emitZeroQword(pr)\n\t{\n\t\tpr.data.writeUnsignedInt(0);\n\t\tpr.data.writeUnsignedInt(0);\n\t}\n\n\tpublic emitDest(pr, token, opdest)\n\t{\n\n\t\t//console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map' , RegMap.map);\n\t\tvar reg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:mask\n\n\t\t// console.log( 'AGALMiniAssembler' , 'emitDest' , 'reg' , reg , reg[1] , RegMap.map[reg[1]] );\n\t\t// console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map[reg[1]]' , RegMap.map[reg[1]] , 'bool' , !RegMap.map[reg[1]] ) ;\n\n\t\tif (!RegMap.map[reg[1]]) return false;\n\t\tvar em = { num:reg[2]? reg[2] : 0, code:RegMap.map[reg[1]].code, mask:this.stringToMask(reg[3]) };\n\t\tpr.data.writeUnsignedShort(em.num);\n\t\tpr.data.writeUnsignedByte(em.mask);\n\t\tpr.data.writeUnsignedByte(em.code);\n\t\t//console.log ( \"  Emit dest: \", em );\n\t\treturn true;\n\t}\n\n\tpublic stringToMask(s:string):number\n\t{\n\t\tif (!s) return 0xf;\n\t\tvar r = 0;\n\t\tif (s.indexOf(\"x\") != -1) r |= 1;\n\t\tif (s.indexOf(\"y\") != -1) r |= 2;\n\t\tif (s.indexOf(\"z\") != -1) r |= 4;\n\t\tif (s.indexOf(\"w\") != -1) r |= 8;\n\t\treturn r;\n\t}\n\n\tpublic stringToSwizzle(s)\n\t{\n\t\tif (!s) {\n\t\t\treturn 0xe4;\n\t\t}\n\t\tvar chartoindex = { x:0, y:1, z:2, w:3 };\n\t\tvar sw = 0;\n\n\t\tif (s.charAt(0) != \".\") {\n\t\t\tthrow \"Missing . for swizzle\";\n\t\t}\n\n\t\tif (s.length > 1) {\n\t\t\tsw |= chartoindex[s.charAt(1)];\n\t\t}\n\n\t\tif (s.length > 2) {\n\t\t\tsw |= chartoindex[s.charAt(2)] << 2;\n\t\t} else {\n\t\t\tsw |= (sw & 3) << 2;\n\t\t}\n\n\t\tif (s.length > 3) {\n\t\t\tsw |= chartoindex[s.charAt(3)] << 4;\n\t\t} else {\n\t\t\tsw |= (sw & (3 << 2)) << 2;\n\t\t}\n\n\t\tif (s.length > 4) {\n\t\t\tsw |= chartoindex[s.charAt(4)] << 6;\n\t\t} else {\n\t\t\tsw |= (sw & (3 << 4)) << 2;\n\t\t}\n\n\t\treturn sw;\n\t}\n\n\tpublic emitSampler(pr:Part, token, opsrc, opts)\n\t{\n\t\tvar reg:string[] = token.match(/fs(\\d*)/i); // g1:regnum\n\t\tif (!reg || !reg[1]) {\n\t\t\treturn false;\n\t\t}\n\t\tpr.data.writeUnsignedShort(parseInt(reg[1]));\n\t\tpr.data.writeUnsignedByte(0);   // bias\n\t\tpr.data.writeUnsignedByte(0);\n\t\t/*\n\t\t pr.data.writeUnsignedByte ( 0x5 );\n\t\t pr.data.writeUnsignedByte ( 0 );   // readmode, dim\n\t\t pr.data.writeUnsignedByte ( 0 );   // special, wrap\n\t\t pr.data.writeUnsignedByte ( 0 );   // mip, filter\n\t\t */\n\t\tvar samplerbits:number = 0x5;\n\t\tvar sampleroptset:number = 0;\n\t\tfor (var i:number = 0; i < opts.length; i++) {\n\t\t\tvar o:Sampler = <Sampler> SamplerMap.map[ opts[i].toLowerCase() ];\n\n\t\t\t//console.log( 'AGALMiniAssembler' , 'emitSampler' , 'SampleMap opt:' , o , '<-------- WATCH FOR THIS');\n\n\t\t\tif (o) {\n\t\t\t\tif (((sampleroptset >> o.shift) & o.mask) != 0) {\n\t\t\t\t\tconsole.log(\"Warning, duplicate sampler option\");\n\t\t\t\t}\n\t\t\t\tsampleroptset |= o.mask << o.shift;\n\t\t\t\tsamplerbits &= ~(o.mask << o.shift);\n\t\t\t\tsamplerbits |= o.value << o.shift;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"Warning, unknown sampler option: \", opts[i]);\n\t\t\t\t// todo bias\n\t\t\t}\n\t\t}\n\t\tpr.data.writeUnsignedInt(samplerbits);\n\t\treturn true;\n\t}\n\n\tpublic emitSource(pr, token, opsrc)\n\t{\n\t\tvar indexed = token.match(/vc\\[(v[tcai])(\\d+)\\.([xyzw])([\\+\\-]\\d+)?\\](\\.[xyzw]{1,4})?/i); // g1: indexregname, g2:indexregnum, g3:select, [g4:offset], [g5:swizzle]\n\t\tvar reg;\n\t\tif (indexed) {\n\t\t\tif (!RegMap.map[indexed[1]]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar selindex = { x:0, y:1, z:2, w:3 };\n\t\t\tvar em:any = { num:indexed[2] | 0, code:RegMap.map[indexed[1]].code, swizzle:this.stringToSwizzle(indexed[5]), select:selindex[indexed[3]], offset:indexed[4] | 0 };\n\t\t\tpr.data.writeUnsignedShort(em.num);\n\t\t\tpr.data.writeByte(em.offset);\n\t\t\tpr.data.writeUnsignedByte(em.swizzle);\n\t\t\tpr.data.writeUnsignedByte(0x1); // constant reg\n\t\t\tpr.data.writeUnsignedByte(em.code);\n\t\t\tpr.data.writeUnsignedByte(em.select);\n\t\t\tpr.data.writeUnsignedByte(1 << 7);\n\t\t} else {\n\t\t\treg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:swizzle\n\t\t\tif (!RegMap.map[reg[1]]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar em:any = { num:reg[2] | 0, code:RegMap.map[reg[1]].code, swizzle:this.stringToSwizzle(reg[3]) };\n\t\t\tpr.data.writeUnsignedShort(em.num);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(em.swizzle);\n\t\t\tpr.data.writeUnsignedByte(em.code);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\t//console.log ( \"  Emit source: \", em, pr.data.length );\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic addHeader(partname, version)\n\t{\n\t\tif (!version) {\n\t\t\tversion = 1;\n\t\t}\n\t\tif (this.r[partname] == undefined) {\n\t\t\tthis.r[partname] = new Part(partname, version);\n\t\t\tthis.emitHeader(this.r[ partname ]);\n\t\t} else if (this.r[partname].version != version) {\n\t\t\tthrow \"Multiple versions for part \" + partname;\n\t\t}\n\t\tthis.cur = this.r[partname];\n\t}\n}\n\nexport = AGALMiniAssembler;",
    "class FS\n{\n\tpublic format:string;\n\tpublic size:number;\n}\n\nexport = FS;\n",
    "class Flags\n{\n\tpublic simple:boolean;\n\tpublic horizontal:boolean;\n\tpublic fragonly:boolean;\n\tpublic matrix:boolean;\n}\n\nexport = Flags;\n",
    "import Flags\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Flags\");\nimport FS\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/FS\");\n\n/**\n *\n */\nclass Opcode\n{\n\tpublic dest:string;\n\tpublic a:FS;\n\tpublic b:FS;\n\tpublic opcode:number;\n\tpublic flags:Flags;\n\n\tconstructor(dest:string, aformat:string, asize:number, bformat:string, bsize:number, opcode:number, simple:boolean, horizontal:boolean, fragonly:boolean, matrix:boolean)\n\t{\n\t\tthis.a = new FS();\n\t\tthis.b = new FS();\n\t\tthis.flags = new Flags();\n\n\t\tthis.dest = dest;\n\t\tthis.a.format = aformat;\n\t\tthis.a.size = asize;\n\t\tthis.b.format = bformat;\n\t\tthis.b.size = bsize;\n\t\tthis.opcode = opcode;\n\t\tthis.flags.simple = simple;\n\t\tthis.flags.horizontal = horizontal;\n\t\tthis.flags.fragonly = fragonly;\n\t\tthis.flags.matrix = matrix;\n\t}\n}\n\nexport = Opcode;\n",
    "import Opcode\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Opcode\");\n\nclass OpcodeMap\n{\n\t// dest:\t\t\t\t\t  \t\t\t\t\t   string,  aformat, asize, bformat,   bsize, opcode, simple, horizontal, fragonly   matrix\n\t/*\n\t public static mov:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x00,   true,   null,       null,      null );\n\t public static add:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x01,   true,   null,       null,      null );\n\n\t public static sub:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x02,   true,   null,       null,      null );\n\t public static mul:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x03,   true,   null,       null,      null );\n\t public static div:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x04,   true,   null,       null,      null );\n\t public static rcp:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x05,   true,   null,       null,      null );\n\t public static min:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x06,   true,   null,       null,      null );\n\t public static max:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x07,   true,   null,       null,      null );\n\t public static frc:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x08,   true,   null,       null,      null );\n\t public static sqt:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x09,   true,   null,       null,      null );\n\t public static rsq:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0a,   true,   null,       null,      null );\n\t public static pow:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x0b,   true,   null,       null,      null );\n\t public static log:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0c,   true,   null,       null,      null );\n\t public static exp:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0d,   true,   null,       null,      null );\n\t public static nrm:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0e,   true,   null,       null,      null );\n\t public static sin:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0f,   true,   null,       null,      null );\n\t public static cos:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x10,   true,   null,       null,      null );\n\t public static crs:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x11,   true,   true,       null,      null );\n\t public static dp3:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x12,   true,   true,       null,      null );\n\t public static dp4:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x13,   true,   true,       null,      null );\n\t public static abs:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x14,   true,   null,       null,      null );\n\t public static neg:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x15,   true,   null,       null,      null );\n\t public static sat:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x16,   true,   null,       null,      null );\n\n\t public static ted:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"sampler\", 1,     0x26,   true,   null,       true,      null );\n\t public static kil:Opcode = new Opcode( \"none\",   \"scalar\", 1,    \"none\",    0,     0x27,   true,   null,       true,      null );\n\t public static tex:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"sampler\", 1,     0x28,   true,   null,       true,      null );\n\n\t public static m33:Opcode = new Opcode( \"vector\", \"matrix\", 3,    \"vector\",  3,     0x17,   true,   null,       null,      true );\n\t public static m44:Opcode = new Opcode( \"vector\", \"matrix\", 4,    \"vector\",  4,     0x18,   true,   null,       null,      true );\n\t public static m43:Opcode = new Opcode( \"vector\", \"matrix\", 3,    \"vector\",  4,     0x19,   true,   null,       null,      true );\n\n\t public static sge:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x29,   true,   null,       null,      null );\n\t public static slt:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2a,   true,   null,       null,      null );\n\t public static sgn:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2b,   true,   null,       null,      null );\n\t public static seq:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2c,   true,   null,       null,      null );\n\t public static sne:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2d,   true,   null,       null,      null );\n\t */\n\n\n\tprivate static _map:Object[];\n\n\tpublic static get map():Object[]\n\t{\n\n\t\tif (!OpcodeMap._map) {\n\n\t\t\tOpcodeMap._map = new Array<Object>();\n\t\t\tOpcodeMap._map['mov'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x00, true, null, null, null);\n\t\t\tOpcodeMap._map['add'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x01, true, null, null, null);\n\t\t\tOpcodeMap._map['sub'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x02, true, null, null, null);\n\t\t\tOpcodeMap._map['mul'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x03, true, null, null, null);\n\t\t\tOpcodeMap._map['div'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x04, true, null, null, null);\n\t\t\tOpcodeMap._map['rcp'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x05, true, null, null, null);\n\t\t\tOpcodeMap._map['min'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x06, true, null, null, null);\n\t\t\tOpcodeMap._map['max'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x07, true, null, null, null);\n\t\t\tOpcodeMap._map['frc'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x08, true, null, null, null);\n\t\t\tOpcodeMap._map['sqt'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x09, true, null, null, null);\n\t\t\tOpcodeMap._map['rsq'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0a, true, null, null, null);\n\t\t\tOpcodeMap._map['pow'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x0b, true, null, null, null);\n\t\t\tOpcodeMap._map['log'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0c, true, null, null, null);\n\t\t\tOpcodeMap._map['exp'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0d, true, null, null, null);\n\t\t\tOpcodeMap._map['nrm'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0e, true, null, null, null);\n\t\t\tOpcodeMap._map['sin'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0f, true, null, null, null);\n\t\t\tOpcodeMap._map['cos'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x10, true, null, null, null);\n\t\t\tOpcodeMap._map['crs'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x11, true, true, null, null);\n\t\t\tOpcodeMap._map['dp3'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x12, true, true, null, null);\n\t\t\tOpcodeMap._map['dp4'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x13, true, true, null, null);\n\t\t\tOpcodeMap._map['abs'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x14, true, null, null, null);\n\t\t\tOpcodeMap._map['neg'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x15, true, null, null, null);\n\t\t\tOpcodeMap._map['sat'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x16, true, null, null, null);\n\n\t\t\tOpcodeMap._map['ted'] = new Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x26, true, null, true, null);\n\t\t\tOpcodeMap._map['kil'] = new Opcode(\"none\", \"scalar\", 1, \"none\", 0, 0x27, true, null, true, null);\n\t\t\tOpcodeMap._map['tex'] = new Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x28, true, null, true, null);\n\n\t\t\tOpcodeMap._map['m33'] = new Opcode(\"vector\", \"matrix\", 3, \"vector\", 3, 0x17, true, null, null, true);\n\t\t\tOpcodeMap._map['m44'] = new Opcode(\"vector\", \"matrix\", 4, \"vector\", 4, 0x18, true, null, null, true);\n\t\t\tOpcodeMap._map['m43'] = new Opcode(\"vector\", \"matrix\", 3, \"vector\", 4, 0x19, true, null, null, true);\n\n\t\t\tOpcodeMap._map['sge'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x29, true, null, null, null);\n\t\t\tOpcodeMap._map['slt'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2a, true, null, null, null);\n\t\t\tOpcodeMap._map['sgn'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2b, true, null, null, null);\n\t\t\tOpcodeMap._map['seq'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2c, true, null, null, null);\n\t\t\tOpcodeMap._map['sne'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2d, true, null, null, null);\n\n\n\t\t}\n\n\t\treturn OpcodeMap._map;\n\n\t}\n\n\n\tconstructor()\n\t{\n\t}\n}\n\nexport = OpcodeMap;",
    "import ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nclass Part\n{\n\tpublic name:string = \"\";\n\tpublic version:number = 0;\n\tpublic data:ByteArray;\n\n\tconstructor(name:string = null, version:number = null)\n\t{\n\t\tthis.name = name;\n\t\tthis.version = version;\n\t\tthis.data = new ByteArray();\n\t}\n}\n\nexport = Part;",
    "\nclass Reg\n{\n\n\tpublic code:number;\n\tpublic desc:string;\n\n\tconstructor(code:number, desc:string)\n\t{\n\t\tthis.code = code;\n\t\tthis.desc = desc;\n\t}\n}\n\nclass RegMap\n{\n\n\t/*\n\t public static map = [ new Reg( 0x00, \"vertex attribute\" ),\n\t new Reg( 0x01, \"fragment constant\" ),\n\t new Reg( 0x01, \"vertex constant\" ),\n\t new Reg( 0x02, \"fragment temporary\" ),\n\t new Reg( 0x02, \"vertex temporary\" ),\n\t new Reg( 0x03, \"vertex output\" ),\n\t new Reg( 0x03, \"vertex output\" ),\n\t new Reg( 0x03, \"fragment depth output\" ),\n\t new Reg( 0x03, \"fragment output\" ),\n\t new Reg( 0x03, \"fragment output\" ),\n\t new Reg( 0x04, \"varying\" ),\n\t new Reg( 0x04, \"varying output\" ),\n\t new Reg( 0x04, \"varying input\" ),\n\t new Reg( 0x05, \"sampler\" ) ];\n\t */\n\n\tprivate static _map:any[];\n\tpublic static get map():any[]\n\t{\n\n\t\tif (!RegMap._map) {\n\n\t\t\tRegMap._map = new Array<Object>();\n\t\t\tRegMap._map['va'] = new Reg(0x00, \"vertex attribute\");\n\t\t\tRegMap._map['fc'] = new Reg(0x01, \"fragment constant\");\n\t\t\tRegMap._map['vc'] = new Reg(0x01, \"vertex constant\")\n\t\t\tRegMap._map['ft'] = new Reg(0x02, \"fragment temporary\");\n\t\t\tRegMap._map['vt'] = new Reg(0x02, \"vertex temporary\");\n\t\t\tRegMap._map['vo'] = new Reg(0x03, \"vertex output\");\n\t\t\tRegMap._map['op'] = new Reg(0x03, \"vertex output\");\n\t\t\tRegMap._map['fd'] = new Reg(0x03, \"fragment depth output\");\n\t\t\tRegMap._map['fo'] = new Reg(0x03, \"fragment output\");\n\t\t\tRegMap._map['oc'] = new Reg(0x03, \"fragment output\");\n\t\t\tRegMap._map['v'] = new Reg(0x04, \"varying\")\n\t\t\tRegMap._map['vi'] = new Reg(0x04, \"varying output\");\n\t\t\tRegMap._map['fi'] = new Reg(0x04, \"varying input\");\n\t\t\tRegMap._map['fs'] = new Reg(0x05, \"sampler\");\n\n\n\t\t}\n\n\t\treturn RegMap._map;\n\n\t}\n\n\t/*\n\t public static va:Reg = new Reg( 0x00, \"vertex attribute\" );\n\t public static fc:Reg = new Reg( 0x01, \"fragment constant\" );\n\t public static vc:Reg = new Reg( 0x01, \"vertex constant\" );\n\t public static ft:Reg = new Reg( 0x02, \"fragment temporary\" );\n\t public static vt:Reg = new Reg( 0x02, \"vertex temporary\" );\n\t public static vo:Reg = new Reg( 0x03, \"vertex output\" );\n\t public static op:Reg = new Reg( 0x03, \"vertex output\" );\n\t public static fd:Reg = new Reg( 0x03, \"fragment depth output\" );\n\t public static fo:Reg = new Reg( 0x03, \"fragment output\" );\n\t public static oc:Reg = new Reg( 0x03, \"fragment output\" );\n\t public static v: Reg = new Reg( 0x04, \"varying\" );\n\t public static vi:Reg = new Reg( 0x04, \"varying output\" );\n\t public static fi:Reg = new Reg( 0x04, \"varying input\" );\n\t public static fs:Reg = new Reg( 0x05, \"sampler\" );\n\t */\n\tconstructor()\n\t{\n\t}\n}\n\nexport = RegMap;",
    "class Sampler\n{\n\tpublic shift:number;\n\tpublic mask:number;\n\tpublic value:number;\n\n\tconstructor(shift:number, mask:number, value:number)\n\t{\n\t\tthis.shift = shift;\n\t\tthis.mask = mask;\n\t\tthis.value = value;\n\t}\n}\n\nexport = Sampler;",
    "import Sampler\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/assembler/Sampler\");\n\nclass SamplerMap\n{\n\n\tprivate static _map:Object[];\n\n\tpublic static get map():Object[]\n\t{\n\n\t\tif (!SamplerMap._map) {\n\n\t\t\tSamplerMap._map = new Array<Object>();\n\t\t\tSamplerMap._map['rgba'] = new Sampler(8, 0xf, 0);\n\t\t\tSamplerMap._map['rg'] = new Sampler(8, 0xf, 5);\n\t\t\tSamplerMap._map['r'] = new Sampler(8, 0xf, 4);\n\t\t\tSamplerMap._map['compressed'] = new Sampler(8, 0xf, 1);\n\t\t\tSamplerMap._map['compressed_alpha'] = new Sampler(8, 0xf, 2);\n\t\t\tSamplerMap._map['dxt1'] = new Sampler(8, 0xf, 1);\n\t\t\tSamplerMap._map['dxt5'] = new Sampler(8, 0xf, 2);\n\n\t\t\t// dimension\n\t\t\tSamplerMap._map['2d'] = new Sampler(12, 0xf, 0);\n\t\t\tSamplerMap._map['cube'] = new Sampler(12, 0xf, 1);\n\t\t\tSamplerMap._map['3d'] = new Sampler(12, 0xf, 2);\n\n\t\t\t// special\n\t\t\tSamplerMap._map['centroid'] = new Sampler(16, 1, 1);\n\t\t\tSamplerMap._map['ignoresampler'] = new Sampler(16, 4, 4);\n\n\t\t\t// repeat\n\t\t\tSamplerMap._map['clamp'] = new Sampler(20, 0xf, 0);\n\t\t\tSamplerMap._map['repeat'] = new Sampler(20, 0xf, 1);\n\t\t\tSamplerMap._map['wrap'] = new Sampler(20, 0xf, 1);\n\n\t\t\t// mip\n\t\t\tSamplerMap._map['nomip'] = new Sampler(24, 0xf, 0);\n\t\t\tSamplerMap._map['mipnone'] = new Sampler(24, 0xf, 0);\n\t\t\tSamplerMap._map['mipnearest'] = new Sampler(24, 0xf, 1);\n\t\t\tSamplerMap._map['miplinear'] = new Sampler(24, 0xf, 2);\n\n\t\t\t// filter\n\t\t\tSamplerMap._map['nearest'] = new Sampler(28, 0xf, 0);\n\t\t\tSamplerMap._map['linear'] = new Sampler(28, 0xf, 1);\n\n\t\t}\n\n\t\treturn SamplerMap._map;\n\n\t}\n\n\t/*\n\t public static map =     [ new Sampler( 8, 0xf, 0 ),\n\t new Sampler( 8, 0xf, 5 ),\n\t new Sampler( 8, 0xf, 4 ),\n\t new Sampler( 8, 0xf, 1 ),\n\t new Sampler( 8, 0xf, 2 ),\n\t new Sampler( 8, 0xf, 1 ),\n\t new Sampler( 8, 0xf, 2 ),\n\n\t // dimension\n\t new Sampler( 12, 0xf, 0 ),\n\t new Sampler( 12, 0xf, 1 ),\n\t new Sampler( 12, 0xf, 2 ),\n\n\t // special\n\t new Sampler( 16, 1, 1 ),\n\t new Sampler( 16, 4, 4 ),\n\n\t // repeat\n\t new Sampler( 20, 0xf, 0 ),\n\t new Sampler( 20, 0xf, 1 ),\n\t new Sampler( 20, 0xf, 1 ),\n\n\t // mip\n\t new Sampler( 24, 0xf, 0 ),\n\t new Sampler( 24, 0xf, 0 ),\n\t new Sampler( 24, 0xf, 1 ),\n\t new Sampler( 24, 0xf, 2 ),\n\n\t // filter\n\t new Sampler( 28, 0xf, 0 ),\n\t new Sampler( 28, 0xf, 1 ) ]\n\t */\n\t/*\n\t public static rgba: Sampler = new Sampler( 8, 0xf, 0 );\n\t public static rg: Sampler = new Sampler( 8, 0xf, 5 );\n\t public static r: Sampler = new Sampler( 8, 0xf, 4 );\n\t public static compressed: Sampler = new Sampler( 8, 0xf, 1 );\n\t public static compressed_alpha: Sampler = new Sampler( 8, 0xf, 2 );\n\t public static dxt1: Sampler = new Sampler( 8, 0xf, 1 );\n\t public static dxt5: Sampler = new Sampler( 8, 0xf, 2 );\n\n\t // dimension\n\t public static sampler2d: Sampler = new Sampler( 12, 0xf, 0 );\n\t public static cube: Sampler = new Sampler( 12, 0xf, 1 );\n\t public static sampler3d: Sampler = new Sampler( 12, 0xf, 2 );\n\n\t // special\n\t public static centroid: Sampler = new Sampler( 16, 1, 1 );\n\t public static ignoresampler: Sampler = new Sampler( 16, 4, 4 );\n\n\t // repeat\n\t public static clamp: Sampler = new Sampler( 20, 0xf, 0 );\n\t public static repeat: Sampler = new Sampler( 20, 0xf, 1 );\n\t public static wrap: Sampler = new Sampler( 20, 0xf, 1 );\n\n\t // mip\n\t public static nomip: Sampler = new Sampler( 24, 0xf, 0 );\n\t public static mipnone: Sampler = new Sampler( 24, 0xf, 0 );\n\t public static mipnearest: Sampler = new Sampler( 24, 0xf, 1 );\n\t public static miplinear: Sampler = new Sampler( 24, 0xf, 2 );\n\n\t // filter\n\t public static nearest: Sampler = new Sampler( 28, 0xf, 0 );\n\t public static linear: Sampler = new Sampler( 28, 0xf, 1 );\n\t */\n\tconstructor()\n\t{\n\t}\n}\n\nexport = SamplerMap;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport CubeTextureBase\t\t\t\t= require(\"awayjs-core/lib/textures/CubeTextureBase\");\nimport RenderTexture\t\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport Texture2DBase\t\t\t\t= require(\"awayjs-core/lib/textures/Texture2DBase\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport IMaterialOwner\t\t\t\t= require(\"awayjs-display/lib/base/IMaterialOwner\");\nimport IContext\t\t\t\t\t\t= require(\"awayjs-display/lib/display/IContext\");\nimport Camera\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport MaterialBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\nimport IndexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexData\");\nimport TextureData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/TextureData\");\nimport TextureDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/TextureDataPool\");\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\nimport ProgramDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramDataPool\");\nimport VertexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexData\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLTextureFormat\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFormat\");\nimport ICubeTexture\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ICubeTexture\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport ITextureBase\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITextureBase\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\n/**\n * Stage provides a proxy class to handle the creation and attachment of the Context\n * (and in turn the back buffer) it uses. Stage should never be created directly,\n * but requested through StageManager.\n *\n * @see away.managers.StageManager\n *\n */\nclass ContextGLBase implements IContext\n{\n\tprivate _programData:Array<ProgramData> = new Array<ProgramData>();\n\n\tpublic _pContainer:HTMLElement;\n\n\tprivate _texturePool:TextureDataPool;\n\n\tprivate _programDataPool:ProgramDataPool;\n\n\tprivate _width:number;\n\tprivate _height:number;\n\n\t//private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver / request animation frame\n\n\tprivate _stageIndex:number = -1;\n\tprivate _antiAlias:number = 0;\n\tprivate _enableDepthAndStencil:boolean;\n\tprivate _renderTarget:TextureProxyBase = null;\n\tprivate _renderSurfaceSelector:number = 0;\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._pContainer;\n\t}\n\n\tconstructor(stageIndex:number)\n\t{\n\t\tthis._stageIndex = stageIndex;\n\t\tthis._texturePool = new TextureDataPool(this);\n\t\tthis._programDataPool = new ProgramDataPool(this);\n\t}\n\n\tpublic getProgramData(key:string):ProgramData\n\t{\n\t\treturn this._programDataPool.getItem(key);\n\t}\n\n\tpublic setRenderTarget(target:TextureProxyBase, enableDepthAndStencil:boolean = false, surfaceSelector:number = 0)\n\t{\n\t\tif (this._renderTarget === target && surfaceSelector == this._renderSurfaceSelector && this._enableDepthAndStencil == enableDepthAndStencil)\n\t\t\treturn;\n\n\t\tthis._renderTarget = target;\n\t\tthis._renderSurfaceSelector = surfaceSelector;\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\t\tif (target instanceof RenderTexture) {\n\t\t\tthis.setRenderToTexture(this.getRenderTexture(<RenderTexture> target), enableDepthAndStencil, this._antiAlias, surfaceSelector);\n\t\t} else {\n\t\t\tthis.setRenderToBackBuffer();\n\t\t\tthis.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\t\t}\n\t}\n\n\tpublic getRenderTexture(textureProxy:RenderTexture):ITextureBase\n\t{\n\t\tvar textureData:TextureData = this._texturePool.getItem(textureProxy);\n\n\t\tif (!textureData.texture)\n\t\t\ttextureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);\n\n\t\treturn textureData.texture;\n\t}\n\n\t/**\n\t * Assigns an attribute stream\n\t *\n\t * @param index The attribute stream index for the vertex shader\n\t * @param buffer\n\t * @param offset\n\t * @param stride\n\t * @param format\n\t */\n\tpublic activateBuffer(index:number, buffer:VertexData, offset:number, format:string)\n\t{\n\t\tif (!buffer.contexts[this._stageIndex])\n\t\t\tbuffer.contexts[this._stageIndex] = this;\n\n\t\tif (!buffer.buffers[this._stageIndex]) {\n\t\t\tbuffer.buffers[this._stageIndex] = this.createVertexBuffer(buffer.data.length/buffer.dataPerVertex, buffer.dataPerVertex);\n\t\t\tbuffer.invalid[this._stageIndex] = true;\n\t\t}\n\n\t\tif (buffer.invalid[this._stageIndex]) {\n\t\t\tbuffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length/buffer.dataPerVertex);\n\t\t\tbuffer.invalid[this._stageIndex] = false;\n\t\t}\n\n\t\tthis.setVertexBufferAt(index, buffer.buffers[this._stageIndex], offset, format);\n\t}\n\n\tpublic disposeVertexData(buffer:VertexData)\n\t{\n\t\tbuffer.buffers[this._stageIndex].dispose();\n\t\tbuffer.buffers[this._stageIndex] = null;\n\t}\n\n\tpublic activateRenderTexture(index:number, textureProxy:RenderTexture)\n\t{\n\t\tthis.setTextureAt(index, this.getRenderTexture(textureProxy));\n\t}\n\n\tpublic activateTexture(index:number, textureProxy:Texture2DBase)\n\t{\n\t\tvar textureData:TextureData = <TextureData> this._texturePool.getItem(textureProxy);\n\n\t\tif (!textureData.texture) {\n\t\t\ttextureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);\n\t\t\ttextureData.invalid = true;\n\t\t}\n\n\t\tif (textureData.invalid) {\n\t\t\ttextureData.invalid = false;\n\t\t\tif (textureProxy.generateMipmaps) {\n\t\t\t\tvar mipmapData:Array<BitmapData> = textureProxy._iGetMipmapData();\n\t\t\t\tvar len:number = mipmapData.length;\n\t\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\t\t(<ITexture> textureData.texture).uploadFromData(mipmapData[i], i);\n\t\t\t} else {\n\t\t\t\t(<ITexture> textureData.texture).uploadFromData(textureProxy._iGetTextureData(), 0);\n\t\t\t}\n\t\t}\n\n\t\tthis.setTextureAt(index, textureData.texture);\n\t}\n\n\tpublic activateCubeTexture(index:number, textureProxy:CubeTextureBase)\n\t{\n\t\tvar textureData:TextureData = <TextureData> this._texturePool.getItem(textureProxy);\n\n\t\tif (!textureData.texture) {\n\t\t\ttextureData.texture = this.createCubeTexture(textureProxy.size, ContextGLTextureFormat.BGRA, false);\n\t\t\ttextureData.invalid = true;\n\t\t}\n\n\t\tif (textureData.invalid) {\n\t\t\ttextureData.invalid = false;\n\t\t\tfor (var i:number = 0; i < 6; ++i) {\n\t\t\t\tif (textureProxy.generateMipmaps) {\n\t\t\t\t\tvar mipmapData:Array<BitmapData> = textureProxy._iGetMipmapData(i);\n\t\t\t\t\tvar len:number = mipmapData.length;\n\t\t\t\t\tfor (var j:number = 0; j < len; j++)\n\t\t\t\t\t\t(<ICubeTexture> textureData.texture).uploadFromData(mipmapData[j], i, j);\n\t\t\t\t} else {\n\t\t\t\t\t(<ICubeTexture> textureData.texture).uploadFromData(textureProxy._iGetTextureData(i), i, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.setTextureAt(index, textureData.texture);\n\t}\n\n\t/**\n\t * Retrieves the VertexBuffer object that contains triangle indices.\n\t * @param context The ContextWeb for which we request the buffer\n\t * @return The VertexBuffer object that contains triangle indices.\n\t */\n\tpublic getIndexBuffer(buffer:IndexData):IIndexBuffer\n\t{\n\t\tif (!buffer.contexts[this._stageIndex])\n\t\t\tbuffer.contexts[this._stageIndex] = this;\n\n\t\tif (!buffer.buffers[this._stageIndex]) {\n\t\t\tbuffer.buffers[this._stageIndex] = this.createIndexBuffer(buffer.data.length);\n\t\t\tbuffer.invalid[this._stageIndex] = true;\n\t\t}\n\n\t\tif (buffer.invalid[this._stageIndex]) {\n\t\t\tbuffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length);\n\t\t\tbuffer.invalid[this._stageIndex] = false;\n\t\t}\n\n\t\treturn buffer.buffers[this._stageIndex];\n\t}\n\n\tpublic disposeIndexData(buffer:IndexData)\n\t{\n\t\tbuffer.buffers[this._stageIndex].dispose();\n\t\tbuffer.buffers[this._stageIndex] = null;\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL)\n\t{\n\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean = true)\n\t{\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IIndexBuffer\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, data32PerVertex:number):IVertexBuffer\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):ITexture\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):ICubeTexture\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic createProgram():IProgram\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\tpublic dispose()\n\t{\n\n\t}\n\n\tpublic present()\n\t{\n\n\t}\n\n\tpublic setRenderToTexture(target:ITextureBase, enableDepthAndStencil:boolean = false, antiAlias:number = 0, surfaceSelector:number = 0)\n\t{\n\n\t}\n\n\tpublic setRenderToBackBuffer()\n\t{\n\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle)\n\t{\n\n\t}\n\n\tpublic setTextureAt(sampler:number, texture:ITextureBase)\n\t{\n\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:IVertexBuffer, bufferOffset:number = 0, format:string = null)\n\t{\n\n\t}\n\n\tpublic setProgram(program:IProgram)\n\t{\n\n\t}\n\n\tpublic registerProgram(programData:ProgramData)\n\t{\n\t\tvar i:number = 0;\n\t\twhile (this._programData[i] != null)\n\t\t\ti++;\n\n\t\tthis._programData[i] = programData;\n\t\tprogramData.id = i;\n\t}\n\n\tpublic unRegisterProgram(programData:ProgramData)\n\t{\n\t\tthis._programData[programData.id] = null;\n\t\tprogramData.id = -1;\n\t}\n}\n\nexport = ContextGLBase;",
    "class ContextGLBlendFactor\n{\n\tpublic static DESTINATION_ALPHA:string = \"destinationAlpha\";\n\tpublic static DESTINATION_COLOR:string = \"destinationColor\";\n\tpublic static ONE:string = \"one\";\n\tpublic static ONE_MINUS_DESTINATION_ALPHA:string = \"oneMinusDestinationAlpha\";\n\tpublic static ONE_MINUS_DESTINATION_COLOR:string = \"oneMinusDestinationColor\";\n\tpublic static ONE_MINUS_SOURCE_ALPHA:string = \"oneMinusSourceAlpha\";\n\tpublic static ONE_MINUS_SOURCE_COLOR:string = \"oneMinusSourceColor\";\n\tpublic static SOURCE_ALPHA:string = \"sourceAlpha\";\n\tpublic static SOURCE_COLOR:string = \"sourceColor\";\n\tpublic static ZERO:string = \"zero\";\n}\n\nexport = ContextGLBlendFactor;",
    "class ContextGLClearMask\n{\n\tstatic COLOR:number = 1;\n\tstatic DEPTH:number = 2;\n\tstatic STENCIL:number = 4;\n\tstatic ALL:number = ContextGLClearMask.COLOR | ContextGLClearMask.DEPTH | ContextGLClearMask.STENCIL;\n}\n\nexport = ContextGLClearMask;",
    "class ContextGLCompareMode\n{\n\tpublic static ALWAYS:string = \"always\";\n\tpublic static EQUAL:string = \"equal\";\n\tpublic static GREATER:string = \"greater\";\n\tpublic static GREATER_EQUAL:string = \"greaterEqual\";\n\tpublic static LESS:string = \"less\";\n\tpublic static LESS_EQUAL:string = \"lessEqual\";\n\tpublic static NEVER:string = \"never\";\n\tpublic static NOT_EQUAL:string = \"notEqual\";\n}\n\nexport = ContextGLCompareMode;",
    "class ContextGLMipFilter\n{\n\tpublic static MIPLINEAR:string = \"miplinear\";\n\tpublic static MIPNEAREST:string = \"mipnearest\";\n\tpublic static MIPNONE:string = \"mipnone\";\n}\n\nexport = ContextGLMipFilter;",
    "class ContextGLProfile\n{\n\tpublic static BASELINE:string = \"baseline\";\n\tpublic static BASELINE_CONSTRAINED:string = \"baselineConstrained\";\n\tpublic static BASELINE_EXTENDED:string = \"baselineExtended\";\n}\nexport = ContextGLProfile;",
    "class ContextGLProgramType\n{\n\tstatic FRAGMENT:string = \"fragment\";\n\tstatic VERTEX:string = \"vertex\";\n}\n\nexport = ContextGLProgramType;",
    "class ContextGLTextureFilter\n{\n\tpublic static LINEAR:string = \"linear\";\n\tpublic static NEAREST:string = \"nearest\";\n}\n\nexport = ContextGLTextureFilter;",
    "class ContextGLTextureFormat\n{\n\tstatic BGRA:string = \"bgra\";\n\tstatic BGRA_PACKED:string = \"bgraPacked4444\";\n\tstatic BGR_PACKED:string = \"bgrPacked565\";\n\tstatic COMPRESSED:string = \"compressed\";\n\tstatic COMPRESSED_ALPHA:string = \"compressedAlpha\";\n}\n\nexport = ContextGLTextureFormat;",
    "class ContextGLTriangleFace\n{\n\tstatic BACK:string = \"back\";\n\tstatic FRONT:string = \"front\";\n\tstatic FRONT_AND_BACK:string = \"frontAndBack\";\n\tstatic NONE:string = \"none\";\n}\n\nexport = ContextGLTriangleFace;",
    "class ContextGLVertexBufferFormat\n{\n\tstatic BYTES_4:string = \"bytes4\";\n\tstatic FLOAT_1:string = \"float1\";\n\tstatic FLOAT_2:string = \"float2\";\n\tstatic FLOAT_3:string = \"float3\";\n\tstatic FLOAT_4:string = \"float4\";\n}\n\nexport = ContextGLVertexBufferFormat;",
    "class ContextGLWrapMode\n{\n\tpublic static CLAMP:string = \"clamp\";\n\tpublic static REPEAT:string = \"repeat\";\n}\n\nexport = ContextGLWrapMode;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\n\nimport swfobject\t\t\t\t\t= require(\"awayjs-stagegl/lib/swfobject\");\nimport Sampler\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/Sampler\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport CubeTextureFlash\t\t\t\t= require(\"awayjs-stagegl/lib/base/CubeTextureFlash\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport IndexBufferFlash\t\t\t\t= require(\"awayjs-stagegl/lib/base/IndexBufferFlash\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ProgramFlash\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ProgramFlash\");\nimport TextureFlash\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/TextureFlash\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\nimport VertexBufferFlash\t\t\t= require(\"awayjs-stagegl/lib/base/VertexBufferFlash\");\n\nclass ContextStage3D extends ContextGLBase implements IContextStageGL\n{\n\tpublic static contexts:Object = new Object();\n\tpublic static maxvertexconstants:number = 128;\n\tpublic static maxfragconstants:number = 28;\n\tpublic static maxtemp:number = 8;\n\tpublic static maxstreams:number = 8;\n\tpublic static maxtextures:number = 8;\n\tpublic static defaultsampler = new Sampler();\n\n\tpublic _iDriverInfo;\n\n\tprivate _cmdStream:string = \"\";\n\tprivate _errorCheckingEnabled:boolean;\n\tprivate _resources:Array<ResourceBaseFlash>;\n\tprivate _oldCanvas:HTMLCanvasElement;\n\tprivate _oldParent:HTMLElement;\n\n\n\tpublic static debug:boolean = false;\n\tpublic static logStream:boolean = false;\n\n\tpublic _iCallback:(context:IContextStageGL) => void;\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._pContainer;\n\t}\n\n\tpublic get driverInfo()\n\t{\n\t\treturn this._iDriverInfo;\n\t}\n\n\tpublic get errorCheckingEnabled():boolean\n\t{\n\t\treturn this._errorCheckingEnabled;\n\t}\n\n\tpublic set errorCheckingEnabled(value:boolean)\n\t{\n\t\tif (this._errorCheckingEnabled == value)\n\t\t\treturn;\n\n\t\tthis._errorCheckingEnabled = value;\n\n\t\tthis.addStream(String.fromCharCode(OpCodes.enableErrorChecking, value? OpCodes.trueValue : OpCodes.falseValue));\n\t\tthis.execute();\n\t}\n\n\t//TODO: get rid of hack that fixes including definition file\n\tconstructor(container:HTMLCanvasElement, stageIndex:number, callback:(context:IContextStageGL) => void, include?:Sampler)\n\t{\n\t\tsuper(stageIndex);\n\n\t\tthis._resources = new Array<ResourceBaseFlash>();\n\n\t\tvar swfVersionStr = \"11.0.0\";\n\n\t\t// To use express install, set to playerProductInstall.swf, otherwise the empty string.\n\t\tvar flashvars = {\n\t\t\tid:container.id\n\t\t};\n\n\t\tvar params = {\n\t\t\tquality:\"high\",\n\t\t\tbgcolor:\"#ffffff\",\n\t\t\tallowscriptaccess:\"sameDomain\",\n\t\t\tallowfullscreen:\"true\",\n\t\t\twmode:\"direct\"\n\t\t};\n\n\t\tthis._errorCheckingEnabled = false;\n\t\tthis._iDriverInfo = \"Unknown\";\n\n\t\tvar attributes = {\n\t\t\tsalign:\"tl\",\n\t\t\tid:container.id,\n\t\t\tname:container[\"name\"] //TODO: needed?\n\t\t};\n\n\t\tthis._oldCanvas = <HTMLCanvasElement> container.cloneNode(); // keep the old one to restore on dispose\n\t\tthis._oldParent = <HTMLElement> container.parentNode;\n\n\t\tvar context3dObj = this;\n\t\tContextStage3D.contexts[container.id] = this;\n\n\t\tfunction callbackSWFObject(callbackInfo)\n\t\t{\n\t\t\tif (!callbackInfo.success)\n\t\t\t\treturn;\n\n\t\t\tcontext3dObj._pContainer = callbackInfo.ref;\n\t\t\tcontext3dObj._iCallback = callback;\n\t\t}\n\n\t\tswfobject.embedSWF(\"libs/molehill_js_flashbridge.swf\", container.id, String(container.width), String(container.height), swfVersionStr, \"\", flashvars, params, attributes, callbackSWFObject);\n\t}\n\n\tpublic _iAddResource(resource:ResourceBaseFlash)\n\t{\n\t\tthis._resources.push(resource);\n\t}\n\n\tpublic _iRemoveResource(resource:ResourceBaseFlash)\n\t{\n\t\tthis._resources.splice(this._resources.indexOf(resource));\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):TextureFlash\n\t{\n\t\t//TODO:streaming\n\t\treturn new TextureFlash(this, width, height, format, optimizeForRenderToTexture);\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):CubeTextureFlash\n\t{\n\t\t//TODO:streaming\n\t\treturn new CubeTextureFlash(this, size, format, optimizeForRenderToTexture);\n\t}\n\n\n\tpublic setTextureAt(sampler:number, texture:ResourceBaseFlash)\n\t{\n\t\tif (texture) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setTextureAt) + sampler + \",\" + texture.id + \",\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearTextureAt) + sampler.toString() + \",\");\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setSamplerStateAt(sampler:number, wrap:string, filter:string, mipfilter:string):void\n\t{\n\t\t//nothing to do here\n\t}\n\n\tpublic setStencilActions(triangleFace:string = \"frontAndBack\", compareMode:string = \"always\", actionOnBothPass:string = \"keep\", actionOnDepthFail:string = \"keep\", actionOnDepthPassStencilFail:string = \"keep\")\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setStencilActions) + triangleFace + \"$\" + compareMode + \"$\" + actionOnBothPass + \"$\" + actionOnDepthFail + \"$\" + actionOnDepthPassStencilFail + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setStencilReferenceValue(referenceValue:number, readMask:number = 255, writeMask:number = 255)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setStencilReferenceValue, referenceValue + OpCodes.intMask, readMask + OpCodes.intMask, writeMask + OpCodes.intMask));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setCulling(triangleFaceToCull:string, coordinateSystem:string = \"leftHanded\")\n\t{\n\t\t//TODO implement coordinateSystem option\n\t\tthis.addStream(String.fromCharCode(OpCodes.setCulling) + triangleFaceToCull + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic drawTriangles(indexBuffer:IndexBufferFlash, firstIndex:number = 0, numTriangles:number = -1)\n\t{\n\t\tfirstIndex = firstIndex || 0;\n\t\tif (!numTriangles || numTriangles < 0)\n\t\t\tnumTriangles = indexBuffer.numIndices/3;\n\n\t\tthis.addStream(String.fromCharCode(OpCodes.drawTriangles, indexBuffer.id + OpCodes.intMask) + firstIndex + \",\" + numTriangles + \",\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setProgramConstantsFromMatrix(programType:string, firstRegister:number, matrix:Matrix3D, transposedMatrix:boolean = false)\n\t{\n\t\t//this._gl.uniformMatrix4fv(this._gl.getUniformLocation(this._currentProgram.glProgram, this._uniformLocationNameDictionary[programType]), !transposedMatrix, new Float32Array(matrix.rawData));\n\n\t\t//TODO remove special case for WebGL matrix calls?\n\t\tvar d:number[] = matrix.rawData;\n\t\tif (transposedMatrix) {\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister, [ d[0], d[4], d[8], d[12] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 1, [ d[1], d[5], d[9], d[13] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 2, [ d[2], d[6], d[10], d[14] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 3, [ d[3], d[7], d[11], d[15] ], 1);\n\t\t} else {\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister, [ d[0], d[1], d[2], d[3] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 1, [ d[4], d[5], d[6], d[7] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 2, [ d[8], d[9], d[10], d[11] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 3, [ d[12], d[13], d[14], d[15] ], 1);\n\t\t}\n\t}\n\n\tpublic setProgramConstantsFromArray(programType:string, firstRegister:number, data:number[], numRegisters:number = -1)\n\t{\n\t\tvar startIndex:number;\n\t\tvar target:number = (programType == ContextGLProgramType.VERTEX)? OpCodes.trueValue : OpCodes.falseValue;\n\t\tfor (var i:number = 0; i < numRegisters; i++) {\n\t\t\tstartIndex = i*4;\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setProgramConstant, target, (firstRegister + i) + OpCodes.intMask) + data[startIndex] + \",\" + data[startIndex + 1] + \",\" + data[startIndex + 2] + \",\" + data[startIndex + 3] + \",\");\n\n\t\t\tif (ContextStage3D.debug)\n\t\t\t\tthis.execute();\n\t\t}\n\t}\n\n\tpublic setProgram(program:ProgramFlash)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setProgram, program.id + OpCodes.intMask));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic present()\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.present));\n\t\tthis.execute();\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.clear) + red + \",\" + green + \",\" + blue + \",\" + alpha + \",\" + depth + \",\" + stencil + \",\" + mask + \",\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic createProgram():ProgramFlash\n\t{\n\t\treturn new ProgramFlash(this);\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, data32PerVertex:number):VertexBufferFlash\n\t{\n\t\treturn new VertexBufferFlash(this, numVertices, data32PerVertex);\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IndexBufferFlash\n\t{\n\t\treturn new IndexBufferFlash(this, numIndices);\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean = true)\n\t{\n\t\tsuper.configureBackBuffer(width, height, antiAlias, enableDepthAndStencil);\n\n\t\t//TODO: add Anitalias setting\n\t\tthis.addStream(String.fromCharCode(OpCodes.configureBackBuffer) + width + \",\" + height + \",\");\n\t}\n\n\tpublic drawToBitmapData(destination:BitmapData)\n\t{\n\t\t//TODO\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:VertexBufferFlash, bufferOffset:number = 0, format:string = null)\n\t{\n\t\tif (buffer) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setVertexBufferAt, index + OpCodes.intMask) + buffer.id + \",\" + bufferOffset + \",\" + format + \"$\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearVertexBufferAt, index + OpCodes.intMask));\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setColorMask(red:boolean, green:boolean, blue:boolean, alpha:boolean)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setColorMask, red? OpCodes.trueValue : OpCodes.falseValue, green? OpCodes.trueValue : OpCodes.falseValue, blue? OpCodes.trueValue : OpCodes.falseValue, alpha? OpCodes.trueValue : OpCodes.falseValue));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setBlendFactors(sourceFactor:string, destinationFactor:string)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setBlendFactors) + sourceFactor + \"$\" + destinationFactor + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setRenderToTexture(target:ResourceBaseFlash, enableDepthAndStencil:boolean = false, antiAlias:number = 0, surfaceSelector:number = 0)\n\t{\n\t\tif (target === null || target === undefined) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearRenderToTexture));\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setRenderToTexture, enableDepthAndStencil? OpCodes.trueValue : OpCodes.falseValue) + target.id + \",\" + (antiAlias || 0) + \",\");\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\n\tpublic setRenderToBackBuffer()\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.clearRenderToTexture));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle)\n\t{\n\t\tif (rectangle) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setScissorRect) + rectangle.x + \",\" + rectangle.y + \",\" + rectangle.width + \",\" + rectangle.height + \",\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearScissorRect));\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setDepthTest(depthMask:boolean, passCompareMode:string)\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setDepthTest, depthMask? OpCodes.trueValue : OpCodes.falseValue) + passCompareMode + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic dispose()\n\t{\n\t\tif (this._pContainer == null)\n\t\t\treturn;\n\n\t\tconsole.log(\"Context3D dispose, releasing \" + this._resources.length + \" resources.\");\n\n\t\twhile (this._resources.length)\n\t\t\tthis._resources[0].dispose();\n\n\t\tif (this._pContainer) {\n\t\t\t// encode command\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.disposeContext));\n\t\t\tthis.execute();\n\t\t\tswfobject.removeSWF(this._oldCanvas.id);\n\t\t\tif (this._oldCanvas && this._oldParent) {\n\t\t\t\tthis._oldParent.appendChild(this._oldCanvas);\n\t\t\t\tthis._oldParent = null;\n\t\t\t}\n\t\t\tthis._pContainer = null;\n\t\t}\n\n\t\tthis._oldCanvas = null;\n\t}\n\n\tpublic addStream(stream:string)\n\t{\n\t\tthis._cmdStream += stream;\n\t}\n\n\tpublic execute():number\n\t{\n\t\tif (ContextStage3D.logStream)\n\t\t\tconsole.log(this._cmdStream);\n\n\t\tvar result:number = this._pContainer[\"CallFunction\"](\"<invoke name=\\\"execStage3dOpStream\\\" returntype=\\\"javascript\\\"><arguments><string>\" + this._cmdStream + \"</string></arguments></invoke>\");\n\n\t\tif (Number(result) <= -3)\n\t\t\tthrow \"Exec stream failed\";\n\n\t\tthis._cmdStream = \"\";\n\n\t\treturn Number(result);\n\t}\n}\n\nexport = ContextStage3D;\n\n/**\n* global function for flash callback\n*/\nfunction mountain_js_context_available(id, driverInfo)\n{\n\tvar ctx:ContextStage3D = ContextStage3D.contexts[id];\n\tif (ctx._iCallback) {\n\t\tctx._iDriverInfo = driverInfo;\n\t\t// get out of the current JS stack frame and call back from flash player\n\t\tvar timeOutId = window.setTimeout(function ()\n\t\t{\n\t\t\twindow.clearTimeout(timeOutId);\n\t\t\ttry {\n\t\t\t\tctx._iCallback(ctx);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(\"Callback failed during flash initialization with '\" + e.toString() + \"'\");\n\t\t\t}\n\t\t}, 1);\n\t}\n}\n",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport Matrix3D\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Rectangle\t\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport ContextGLBlendFactor\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBlendFactor\");\nimport ContextGLClearMask\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLClearMask\");\nimport ContextGLCompareMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLCompareMode\");\nimport ContextGLMipFilter\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLMipFilter\");\nimport ContextGLProgramType\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLProgramType\");\nimport ContextGLTextureFilter\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTextureFilter\");\nimport ContextGLTriangleFace\t\t= require(\"awayjs-stagegl/lib/base/ContextGLTriangleFace\");\nimport ContextGLVertexBufferFormat\t= require(\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\");\nimport ContextGLWrapMode\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLWrapMode\");\nimport CubeTextureWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/CubeTextureWebGL\");\nimport IContextStageGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport IndexBufferWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/IndexBufferWebGL\");\nimport ProgramWebGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ProgramWebGL\");\nimport TextureBaseWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/TextureBaseWebGL\");\nimport TextureWebGL\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/TextureWebGL\");\nimport SamplerState\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/SamplerState\");\nimport VertexBufferWebGL\t\t\t= require(\"awayjs-stagegl/lib/base/VertexBufferWebGL\");\n\nclass ContextWebGL extends ContextGLBase implements IContextStageGL\n{\n\tprivate _blendFactorDictionary:Object = new Object();\n\tprivate _depthTestDictionary:Object = new Object();\n\tprivate _textureIndexDictionary:Array<number> = new Array<number>(8);\n\tprivate _textureTypeDictionary:Object = new Object();\n\tprivate _wrapDictionary:Object = new Object();\n\tprivate _filterDictionary:Object = new Object();\n\tprivate _mipmapFilterDictionary:Object = new Object();\n\tprivate _uniformLocationNameDictionary:Object = new Object();\n\tprivate _vertexBufferDimensionDictionary:Object = new Object();\n\n\tprivate _drawing:boolean;\n\tprivate _blendEnabled:boolean;\n\tprivate _blendSourceFactor:number;\n\tprivate _blendDestinationFactor:number;\n\n\tprivate _indexBufferList:Array<IndexBufferWebGL> = new Array<IndexBufferWebGL>();\n\tprivate _vertexBufferList:Array<VertexBufferWebGL> = new Array<VertexBufferWebGL>();\n\tprivate _textureList:Array<TextureBaseWebGL> = new Array<TextureBaseWebGL>();\n\tprivate _programList:Array<ProgramWebGL> = new Array<ProgramWebGL>();\n\n\tprivate _samplerStates:Array<SamplerState> = new Array<SamplerState>(8);\n\n\tpublic static MAX_SAMPLERS:number = 8;\n\n\t//@protected\n\tpublic _gl:WebGLRenderingContext;\n\n\t//@protected\n\tpublic _currentProgram:ProgramWebGL;\n\tprivate _activeTexture:number;\n\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._pContainer;\n\t}\n\n\tconstructor(canvas:HTMLCanvasElement, stageIndex:number)\n\t{\n\t\tsuper(stageIndex);\n\n\t\tthis._pContainer = canvas;\n\n\t\ttry {\n\t\t\tthis._gl = <WebGLRenderingContext> canvas.getContext(\"experimental-webgl\", { premultipliedAlpha:false, alpha:false });\n\n\t\t\tif (!this._gl)\n\t\t\t\tthis._gl = <WebGLRenderingContext> canvas.getContext(\"webgl\", { premultipliedAlpha:false, alpha:false });\n\t\t} catch (e) {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_FAILED, e ) );\n\t\t}\n\n\t\tif (this._gl) {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_SUCCESS ) );\n\t\t\t//setup shortcut dictionaries\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE] = this._gl.ONE;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.DESTINATION_ALPHA] = this._gl.DST_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.DESTINATION_COLOR] = this._gl.DST_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE] = this._gl.ONE;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_DESTINATION_ALPHA] = this._gl.ONE_MINUS_DST_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_DESTINATION_COLOR] = this._gl.ONE_MINUS_DST_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA] = this._gl.ONE_MINUS_SRC_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_SOURCE_COLOR] = this._gl.ONE_MINUS_SRC_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.SOURCE_ALPHA] = this._gl.SRC_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.SOURCE_COLOR] = this._gl.SRC_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ZERO] = this._gl.ZERO;\n\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.ALWAYS] = this._gl.ALWAYS;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.EQUAL] = this._gl.EQUAL;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.GREATER] = this._gl.GREATER;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.GREATER_EQUAL] = this._gl.GEQUAL;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.LESS] = this._gl.LESS;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.LESS_EQUAL] = this._gl.LEQUAL;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.NEVER] = this._gl.NEVER;\n\t\t\tthis._depthTestDictionary[ContextGLCompareMode.NOT_EQUAL] = this._gl.NOTEQUAL;\n\n\t\t\tthis._textureIndexDictionary[0] = this._gl.TEXTURE0;\n\t\t\tthis._textureIndexDictionary[1] = this._gl.TEXTURE1;\n\t\t\tthis._textureIndexDictionary[2] = this._gl.TEXTURE2;\n\t\t\tthis._textureIndexDictionary[3] = this._gl.TEXTURE3;\n\t\t\tthis._textureIndexDictionary[4] = this._gl.TEXTURE4;\n\t\t\tthis._textureIndexDictionary[5] = this._gl.TEXTURE5;\n\t\t\tthis._textureIndexDictionary[6] = this._gl.TEXTURE6;\n\t\t\tthis._textureIndexDictionary[7] = this._gl.TEXTURE7;\n\n\t\t\tthis._textureTypeDictionary[\"texture2d\"] = this._gl.TEXTURE_2D;\n\t\t\tthis._textureTypeDictionary[\"textureCube\"] = this._gl.TEXTURE_CUBE_MAP;\n\n\t\t\tthis._wrapDictionary[ContextGLWrapMode.REPEAT] = this._gl.REPEAT;\n\t\t\tthis._wrapDictionary[ContextGLWrapMode.CLAMP] = this._gl.CLAMP_TO_EDGE;\n\n\t\t\tthis._filterDictionary[ContextGLTextureFilter.LINEAR] = this._gl.LINEAR;\n\t\t\tthis._filterDictionary[ContextGLTextureFilter.NEAREST] = this._gl.NEAREST;\n\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR] = new Object();\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPNEAREST] = this._gl.LINEAR_MIPMAP_NEAREST;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPLINEAR] = this._gl.LINEAR_MIPMAP_LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPNONE] = this._gl.LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST] = new Object();\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPNEAREST] = this._gl.NEAREST_MIPMAP_NEAREST;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPLINEAR] = this._gl.NEAREST_MIPMAP_LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPNONE] = this._gl.NEAREST;\n\n\t\t\tthis._uniformLocationNameDictionary[ContextGLProgramType.VERTEX] = \"vc\";\n\t\t\tthis._uniformLocationNameDictionary[ContextGLProgramType.FRAGMENT] = \"fc\";\n\n\t\t\tthis._vertexBufferDimensionDictionary[ContextGLVertexBufferFormat.FLOAT_1] = 1;\n\t\t\tthis._vertexBufferDimensionDictionary[ContextGLVertexBufferFormat.FLOAT_2] = 2;\n\t\t\tthis._vertexBufferDimensionDictionary[ContextGLVertexBufferFormat.FLOAT_3] = 3;\n\t\t\tthis._vertexBufferDimensionDictionary[ContextGLVertexBufferFormat.FLOAT_4] = 4;\n\t\t\tthis._vertexBufferDimensionDictionary[ContextGLVertexBufferFormat.BYTES_4] = 4;\n\t\t} else {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_FAILED, e ) );\n\t\t\talert(\"WebGL is not available.\");\n\t\t}\n\n\t\t//defaults\n\t\tfor (var i:number = 0; i < ContextWebGL.MAX_SAMPLERS; ++i) {\n\t\t\tthis._samplerStates[i] = new SamplerState();\n\t\t\tthis._samplerStates[i].wrap = this._gl.REPEAT;\n\t\t\tthis._samplerStates[i].filter = this._gl.LINEAR;\n\t\t\tthis._samplerStates[i].mipfilter = this._gl.LINEAR;\n\t\t}\n\t}\n\n\tpublic gl():WebGLRenderingContext\n\t{\n\t\treturn this._gl;\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL)\n\t{\n\t\tif (!this._drawing) {\n\t\t\tthis.updateBlendStatus();\n\t\t\tthis._drawing = true;\n\t\t}\n\n\t\tvar glmask:number = 0;\n\t\tif (mask & ContextGLClearMask.COLOR) glmask |= this._gl.COLOR_BUFFER_BIT;\n\t\tif (mask & ContextGLClearMask.STENCIL) glmask |= this._gl.STENCIL_BUFFER_BIT;\n\t\tif (mask & ContextGLClearMask.DEPTH) glmask |= this._gl.DEPTH_BUFFER_BIT;\n\n\t\tthis._gl.clearColor(red, green, blue, alpha);\n\t\tthis._gl.clearDepth(depth);\n\t\tthis._gl.clearStencil(stencil);\n\t\tthis._gl.clear(glmask);\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean = true)\n\t{\n\t\tsuper.configureBackBuffer(width, height, antiAlias, enableDepthAndStencil);\n\n\t\tif (enableDepthAndStencil) {\n\t\t\tthis._gl.enable(this._gl.STENCIL_TEST);\n\t\t\tthis._gl.enable(this._gl.DEPTH_TEST);\n\t\t}\n\n\t\tthis._gl.viewport['width'] = width;\n\t\tthis._gl.viewport['height'] = height;\n\n\t\tthis._gl.viewport(0, 0, width, height);\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):CubeTextureWebGL\n\t{\n\t\tvar texture:CubeTextureWebGL = new CubeTextureWebGL(this._gl, size);\n\t\tthis._textureList.push(texture);\n\t\treturn texture;\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IndexBufferWebGL\n\t{\n\t\tvar indexBuffer:IndexBufferWebGL = new IndexBufferWebGL(this._gl, numIndices);\n\t\tthis._indexBufferList.push(indexBuffer);\n\t\treturn indexBuffer;\n\t}\n\n\tpublic createProgram():ProgramWebGL\n\t{\n\t\tvar program:ProgramWebGL = new ProgramWebGL(this._gl);\n\t\tthis._programList.push(program);\n\t\treturn program;\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):TextureWebGL\n\t{\n\t\t//TODO streaming\n\t\tvar texture:TextureWebGL = new TextureWebGL(this._gl, width, height);\n\t\tthis._textureList.push(texture);\n\t\treturn texture;\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, data32PerVertex:number):VertexBufferWebGL\n\t{\n\t\tvar vertexBuffer:VertexBufferWebGL = new VertexBufferWebGL(this._gl, numVertices, data32PerVertex);\n\t\tthis._vertexBufferList.push(vertexBuffer);\n\t\treturn vertexBuffer;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tvar i:number;\n\t\tfor (i = 0; i < this._indexBufferList.length; ++i)\n\t\t\tthis._indexBufferList[i].dispose();\n\n\t\tthis._indexBufferList = null;\n\n\t\tfor (i = 0; i < this._vertexBufferList.length; ++i)\n\t\t\tthis._vertexBufferList[i].dispose();\n\n\t\tthis._vertexBufferList = null;\n\n\t\tfor (i = 0; i < this._textureList.length; ++i)\n\t\t\tthis._textureList[i].dispose();\n\n\t\tthis._textureList = null;\n\n\t\tfor (i = 0; i < this._programList.length; ++i)\n\t\t\tthis._programList[i].dispose();\n\n\t\tfor (i = 0; i < this._samplerStates.length; ++i)\n\t\t\tthis._samplerStates[i] = null;\n\n\t\tthis._programList = null;\n\t}\n\n\tpublic drawToBitmapData(destination:BitmapData)\n\t{\n\t\tvar arrayBuffer:ArrayBuffer = new ArrayBuffer(destination.width*destination.height*4);\n\n\t\tthis._gl.readPixels(0, 0, destination.width, destination.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, new Uint8Array(arrayBuffer));\n\n\t\tvar byteArray:ByteArray = new ByteArray();\n\t\tbyteArray.setArrayBuffer(arrayBuffer);\n\n\t\tdestination.setPixels(new Rectangle(0, 0, destination.width, destination.height), byteArray);\n\t}\n\n\tpublic drawTriangles(indexBuffer:IndexBufferWebGL, firstIndex:number = 0, numTriangles:number = -1)\n\t{\n\t\tif (!this._drawing)\n\t\t\tthrow \"Need to clear before drawing if the buffer has not been cleared since the last present() call.\";\n\n\t\tthis._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, indexBuffer.glBuffer);\n\t\tthis._gl.drawElements(this._gl.TRIANGLES, (numTriangles == -1)? indexBuffer.numIndices : numTriangles*3, this._gl.UNSIGNED_SHORT, firstIndex);\n\t}\n\n\tpublic present()\n\t{\n\t\tthis._drawing = false;\n\t}\n\n\tpublic setBlendFactors(sourceFactor:string, destinationFactor:string)\n\t{\n\t\tthis._blendEnabled = true;\n\n\t\tthis._blendSourceFactor = this._blendFactorDictionary[sourceFactor];\n\n\t\tthis._blendDestinationFactor = this._blendFactorDictionary[destinationFactor];\n\n\t\tthis.updateBlendStatus();\n\t}\n\n\tpublic setColorMask(red:boolean, green:boolean, blue:boolean, alpha:boolean)\n\t{\n\t\tthis._gl.colorMask(red, green, blue, alpha);\n\t}\n\n\tpublic setCulling(triangleFaceToCull:string, coordinateSystem:string = \"leftHanded\")\n\t{\n\t\tif (triangleFaceToCull == ContextGLTriangleFace.NONE) {\n\t\t\tthis._gl.disable(this._gl.CULL_FACE);\n\t\t} else {\n\t\t\tthis._gl.enable(this._gl.CULL_FACE);\n\t\t\tswitch (triangleFaceToCull) {\n\t\t\t\tcase ContextGLTriangleFace.BACK:\n\t\t\t\t\tthis._gl.cullFace((coordinateSystem == \"leftHanded\")? this._gl.FRONT : this._gl.BACK);\n\t\t\t\t\tbreak\n\t\t\t\tcase ContextGLTriangleFace.FRONT:\n\t\t\t\t\tthis._gl.cullFace((coordinateSystem == \"leftHanded\")? this._gl.BACK : this._gl.FRONT);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextGLTriangleFace.FRONT_AND_BACK:\n\t\t\t\t\tthis._gl.cullFace(this._gl.FRONT_AND_BACK);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Unknown ContextGLTriangleFace type.\"; // TODO error\n\t\t\t}\n\t\t}\n\t}\n\n\t// TODO ContextGLCompareMode\n\tpublic setDepthTest(depthMask:boolean, passCompareMode:string)\n\t{\n\t\tthis._gl.depthFunc(this._depthTestDictionary[passCompareMode]);\n\n\t\tthis._gl.depthMask(depthMask);\n\t}\n\n\tpublic setProgram(program:ProgramWebGL)\n\t{\n\t\t//TODO decide on construction/reference resposibilities\n\t\tthis._currentProgram = program;\n\t\tprogram.focusProgram();\n\t}\n\n\tpublic setProgramConstantsFromMatrix(programType:string, firstRegister:number, matrix:Matrix3D, transposedMatrix:boolean = false)\n\t{\n\t\t//this._gl.uniformMatrix4fv(this._gl.getUniformLocation(this._currentProgram.glProgram, this._uniformLocationNameDictionary[programType]), !transposedMatrix, new Float32Array(matrix.rawData));\n\n\t\t//TODO remove special case for WebGL matrix calls?\n\t\tvar d:number[] = matrix.rawData;\n\t\tif (transposedMatrix) {\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister, [ d[0], d[4], d[8], d[12] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 1, [ d[1], d[5], d[9], d[13] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 2, [ d[2], d[6], d[10], d[14] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 3, [ d[3], d[7], d[11], d[15] ], 1);\n\t\t} else {\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister, [ d[0], d[1], d[2], d[3] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 1, [ d[4], d[5], d[6], d[7] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 2, [ d[8], d[9], d[10], d[11] ], 1);\n\t\t\tthis.setProgramConstantsFromArray(programType, firstRegister + 3, [ d[12], d[13], d[14], d[15] ], 1);\n\t\t}\n\t}\n\n\tpublic static modulo:number = 0;\n\n\tpublic setProgramConstantsFromArray(programType:string, firstRegister:number, data:number[], numRegisters:number = -1)\n\t{\n\t\tvar locationName:string = this._uniformLocationNameDictionary[programType];\n\t\tvar startIndex:number;\n\t\tfor (var i:number = 0; i < numRegisters; i++) {\n\t\t\tstartIndex = i*4;\n\t\t\tthis._gl.uniform4f(this._gl.getUniformLocation(this._currentProgram.glProgram, locationName + (firstRegister + i)), data[startIndex], data[startIndex + 1], data[startIndex + 2], data[startIndex + 3]);\n\t\t}\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle)\n\t{\n\t\tif (!rectangle) {\n\t\t\tthis._gl.disable(this._gl.SCISSOR_TEST);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._gl.enable(this._gl.SCISSOR_TEST);\n\t\tthis._gl.scissor(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n\t}\n\n\tpublic setTextureAt(sampler:number, texture:TextureBaseWebGL)\n\t{\n\t\tvar samplerState:SamplerState = this._samplerStates[sampler];\n\n\t\tif (this._activeTexture != sampler && (texture || samplerState.type)) {\n\t\t\tthis._activeTexture = sampler;\n\t\t\tthis._gl.activeTexture(this._textureIndexDictionary[sampler]);\n\t\t}\n\n\t\tif (!texture) {\n\t\t\tif (samplerState.type) {\n\t\t\t\tthis._gl.bindTexture(samplerState.type, null);\n\t\t\t\tsamplerState.type = null;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar textureType:number = this._textureTypeDictionary[texture.textureType];\n\t\tsamplerState.type = textureType;\n\n\t\tthis._gl.bindTexture(textureType, texture.glTexture);\n\n\t\tthis._gl.uniform1i(this._gl.getUniformLocation(this._currentProgram.glProgram, \"fs\" + sampler), sampler);\n\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_S, samplerState.wrap);\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_T, samplerState.wrap);\n\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_MAG_FILTER, samplerState.filter);\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_MIN_FILTER, samplerState.mipfilter);\n\t}\n\n\tpublic setSamplerStateAt(sampler:number, wrap:string, filter:string, mipfilter:string):void\n\t{\n\t\tif (0 <= sampler && sampler < ContextWebGL.MAX_SAMPLERS) {\n\t\t\tthis._samplerStates[sampler].wrap = this._wrapDictionary[wrap];\n\t\t\tthis._samplerStates[sampler].filter = this._filterDictionary[filter];\n\t\t\tthis._samplerStates[sampler].mipfilter = this._mipmapFilterDictionary[filter][mipfilter];\n\t\t} else {\n\t\t\tthrow \"Sampler is out of bounds.\";\n\t\t}\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:VertexBufferWebGL, bufferOffset:number = 0, format:string = null)\n\t{\n\t\tvar location:number = this._currentProgram? this._gl.getAttribLocation(this._currentProgram.glProgram, \"va\" + index) : -1;\n\n\t\tif (!buffer) {\n\t\t\tif (location > -1)\n\t\t\t\tthis._gl.disableVertexAttribArray(location);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis._gl.bindBuffer(this._gl.ARRAY_BUFFER, buffer.glBuffer);\n\t\tthis._gl.enableVertexAttribArray(location);\n\t\tthis._gl.vertexAttribPointer(location, this._vertexBufferDimensionDictionary[format], this._gl.FLOAT, false, buffer.data32PerVertex*4, bufferOffset*4);\n\t}\n\n\tpublic setRenderToTexture(target:TextureBaseWebGL, enableDepthAndStencil:boolean = false, antiAlias:number = 0, surfaceSelector:number = 0)\n\t{\n\t\tvar texture:TextureWebGL = <TextureWebGL> target;\n\t\tvar frameBuffer:WebGLFramebuffer = texture.frameBuffer;\n\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, frameBuffer);\n\n\t\tif (enableDepthAndStencil) {\n\t\t\tthis._gl.enable(this._gl.STENCIL_TEST);\n\t\t\tthis._gl.enable(this._gl.DEPTH_TEST);\n\t\t}\n\n\t\tthis._gl.viewport(0, 0, texture.width, texture.height );\n\t}\n\n\tpublic setRenderToBackBuffer()\n\t{\n\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n\t}\n\n\tprivate updateBlendStatus()\n\t{\n\t\tif (this._blendEnabled) {\n\t\t\tthis._gl.enable(this._gl.BLEND);\n\t\t\tthis._gl.blendEquation(this._gl.FUNC_ADD);\n\t\t\tthis._gl.blendFunc(this._blendSourceFactor, this._blendDestinationFactor);\n\t\t} else {\n\t\t\tthis._gl.disable(this._gl.BLEND);\n\t\t}\n\t}\n}\n\nexport = ContextWebGL;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport ByteArrayBase\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArrayBase\");\n\nimport ContextStage3D\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport ICubeTexture\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ICubeTexture\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\n\nclass CubeTextureFlash extends ResourceBaseFlash implements ICubeTexture\n{\n\tprivate _context:ContextStage3D;\n\tprivate _size:number;\n\n\tpublic get size():number\n\t{\n\t\treturn this._size;\n\t}\n\n\tconstructor(context:ContextStage3D, size:number, format:string, forRTT:boolean, streaming:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._size = size;\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initCubeTexture, (forRTT? OpCodes.trueValue : OpCodes.falseValue)) + size + \",\" + streaming + \",\" + format + \"$\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeCubeTexture) + this._pId.toString() + \",\");\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic uploadFromData(bitmapData:BitmapData, side:number, miplevel?:number);\n\tpublic uploadFromData(image:HTMLImageElement, side:number, miplevel?:number);\n\tpublic uploadFromData(data:any, side:number, miplevel:number = 0)\n\t{\n\t\tif (data instanceof BitmapData) {\n\t\t\tdata = (<BitmapData> data).imageData.data;\n\t\t} else if (data instanceof HTMLImageElement) {\n\t\t\tvar can = document.createElement(\"canvas\");\n\t\t\tvar w = data.width;\n\t\t\tvar h = data.height;\n\t\t\tcan.width = w;\n\t\t\tcan.height = h;\n\t\t\tvar ctx = can.getContext(\"2d\");\n\t\t\tctx.drawImage(data, 0, 0);\n\t\t\tdata = ctx.getImageData(0, 0, w, h).data;\n\t\t}\n\n\t\tvar pos = 0;\n\t\tvar bytes = ByteArrayBase.internalGetBase64String(data.length, function () {\n\t\t\treturn data[pos++];\n\t\t}, null);\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadBytesCubeTexture) + this._pId + \",\" + miplevel + \",\" + side + \",\" + (this.size >> miplevel) + \",\" + bytes + \"%\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false)\n\t{\n\n\t}\n}\n\nexport = CubeTextureFlash;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport ICubeTexture\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ICubeTexture\");\nimport TextureBaseWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/TextureBaseWebGL\");\n\nclass CubeTextureWebGL extends TextureBaseWebGL implements ICubeTexture\n{\n\n\tprivate _textureSelectorDictionary:Array<number> = new Array<number>(6);\n\n\tpublic textureType:string = \"textureCube\";\n\tprivate _texture:WebGLTexture;\n\tprivate _size:number;\n\n\tconstructor(gl:WebGLRenderingContext, size:number)\n\t{\n\t\tsuper(gl);\n\t\tthis._size = size;\n\t\tthis._texture = this._gl.createTexture();\n\n\t\tthis._textureSelectorDictionary[0] = gl.TEXTURE_CUBE_MAP_POSITIVE_X;\n\t\tthis._textureSelectorDictionary[1] = gl.TEXTURE_CUBE_MAP_NEGATIVE_X;\n\t\tthis._textureSelectorDictionary[2] = gl.TEXTURE_CUBE_MAP_POSITIVE_Y;\n\t\tthis._textureSelectorDictionary[3] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Y;\n\t\tthis._textureSelectorDictionary[4] = gl.TEXTURE_CUBE_MAP_POSITIVE_Z;\n\t\tthis._textureSelectorDictionary[5] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Z;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._gl.deleteTexture(this._texture);\n\t}\n\n\tpublic uploadFromData(bitmapData:BitmapData, side:number, miplevel?:number);\n\tpublic uploadFromData(image:HTMLImageElement, side:number, miplevel?:number);\n\tpublic uploadFromData(data:any, side:number, miplevel:number = 0)\n\t{\n\t\tif (data instanceof BitmapData)\n\t\t\tdata = (<BitmapData> data).imageData;\n\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, this._texture);\n\t\tthis._gl.texImage2D(this._textureSelectorDictionary[side], miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, null);\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false)\n\t{\n\n\t}\n\n\tpublic get size():number\n\t{\n\t\treturn this._size;\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\treturn this._texture;\n\t}\n}\n\nexport = CubeTextureWebGL;",
    "import ContextStage3D\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\n\nclass IndexBufferFlash extends ResourceBaseFlash implements IIndexBuffer\n{\n\tprivate _context:ContextStage3D;\n\tprivate _numIndices:number;\n\n\tconstructor(context:ContextStage3D, numIndices:number)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._numIndices = numIndices;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initIndexBuffer, numIndices + OpCodes.intMask));\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic uploadFromArray(data:number[], startOffset:number, count:number):void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadArrayIndexBuffer, this._pId + OpCodes.intMask) + data.join() + \"#\" + startOffset + \",\" + count + \",\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeIndexBuffer, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n}\n\nexport = IndexBufferFlash;",
    "import IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\n\nclass IndexBufferWebGL implements IIndexBuffer\n{\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _numIndices:number;\n\tprivate _buffer:WebGLBuffer;\n\n\tconstructor(gl:WebGLRenderingContext, numIndices:number)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._buffer = this._gl.createBuffer();\n\t\tthis._numIndices = numIndices;\n\t}\n\n\tpublic uploadFromArray(data:number[], startOffset:number, count:number):void\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._buffer);\n\n\t\t// TODO add index offsets\n\t\tthis._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(data), this._gl.STATIC_DRAW);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteBuffer(this._buffer);\n\t}\n\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n\n\tpublic get glBuffer():WebGLBuffer\n\t{\n\t\treturn this._buffer;\n\t}\n}\n\nexport = IndexBufferWebGL;",
    "class OpCodes\n{\n\tpublic static trueValue:number = 32;\n\tpublic static falseValue:number = 33;\n\tpublic static intMask:number = 63;\n\tpublic static drawTriangles:number = 41;\n\tpublic static setProgramConstant:number = 42;\n\tpublic static setProgram:number = 43;\n\tpublic static present:number = 44;\n\tpublic static clear:number = 45;\n\tpublic static initProgram:number = 46;\n\tpublic static initVertexBuffer:number = 47;\n\tpublic static initIndexBuffer:number = 48;\n\tpublic static configureBackBuffer:number = 49;\n\tpublic static uploadArrayIndexBuffer:number = 50;\n\tpublic static uploadArrayVertexBuffer:number = 51;\n\tpublic static uploadAGALBytesProgram:number = 52;\n\tpublic static setVertexBufferAt:number = 53;\n\tpublic static uploadBytesIndexBuffer:number = 54;\n\tpublic static uploadBytesVertexBuffer:number = 55;\n\tpublic static setColorMask:number = 56;\n\tpublic static setDepthTest:number = 57;\n\tpublic static disposeProgram:number = 58;\n\tpublic static disposeContext:number = 59;\n\t// must skip 60 '<' as it will invalidate xml being passed over the bridge\n\tpublic static disposeVertexBuffer:number = 61;\n\t// must skip 62 '>' as it will invalidate xml being passed over the bridge\n\tpublic static disposeIndexBuffer:number = 63;\n\tpublic static initTexture:number = 64;\n\tpublic static setTextureAt:number = 65;\n\tpublic static uploadBytesTexture:number = 66;\n\tpublic static disposeTexture:number = 67;\n\tpublic static setCulling:number = 68;\n\tpublic static setScissorRect:number = 69;\n\tpublic static clearScissorRect:number = 70;\n\tpublic static setBlendFactors:number = 71;\n\tpublic static setRenderToTexture:number = 72;\n\tpublic static clearTextureAt:number = 73;\n\tpublic static clearVertexBufferAt:number = 74;\n\tpublic static setStencilActions:number = 75;\n\tpublic static setStencilReferenceValue:number = 76;\n\tpublic static initCubeTexture:number = 77;\n\tpublic static disposeCubeTexture:number = 78;\n\tpublic static uploadBytesCubeTexture:number = 79;\n\tpublic static clearRenderToTexture:number = 80;\n\tpublic static enableErrorChecking:number = 81;\n}\n\nexport = OpCodes;",
    "import ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport ContextStage3D\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\n\nclass ProgramFlash extends ResourceBaseFlash implements IProgram\n{\n\tprivate _context:ContextStage3D;\n\n\tconstructor(context:ContextStage3D)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initProgram));\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic upload(vertexProgram:ByteArray, fragmentProgram:ByteArray)\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadAGALBytesProgram, this._pId + OpCodes.intMask) + vertexProgram.readBase64String(vertexProgram.length) + \"%\" + fragmentProgram.readBase64String(fragmentProgram.length) + \"%\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis._context.execute();\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeProgram, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n}\n\nexport = ProgramFlash;",
    "import ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport AGALTokenizer\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/AGALTokenizer\");\nimport AGLSLParser\t\t\t\t\t= require(\"awayjs-stagegl/lib/aglsl/AGLSLParser\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\n\n\nclass ProgramWebGL implements IProgram\n{\n\tprivate static _tokenizer:AGALTokenizer = new AGALTokenizer();\n\tprivate static _aglslParser:AGLSLParser = new AGLSLParser();\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _program:WebGLProgram;\n\tprivate _vertexShader:WebGLShader;\n\tprivate _fragmentShader:WebGLShader;\n\n\tconstructor(gl:WebGLRenderingContext)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._program = this._gl.createProgram();\n\t}\n\n\tpublic upload(vertexProgram:ByteArray, fragmentProgram:ByteArray)\n\t{\n\t\tvar vertexString:string = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(vertexProgram));\n\t\tvar fragmentString:string = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(fragmentProgram));\n\n\t\tthis._vertexShader = this._gl.createShader(this._gl.VERTEX_SHADER);\n\t\tthis._fragmentShader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\n\n\t\tthis._gl.shaderSource(this._vertexShader, vertexString);\n\t\tthis._gl.compileShader(this._vertexShader);\n\n\t\tif (!this._gl.getShaderParameter(this._vertexShader, this._gl.COMPILE_STATUS)) {\n\t\t\tthrow new Error(this._gl.getShaderInfoLog(this._vertexShader));\n\t\t\treturn;\n\t\t}\n\n\t\tthis._gl.shaderSource(this._fragmentShader, fragmentString);\n\t\tthis._gl.compileShader(this._fragmentShader);\n\n\t\tif (!this._gl.getShaderParameter(this._fragmentShader, this._gl.COMPILE_STATUS)) {\n\t\t\tthrow new Error(this._gl.getShaderInfoLog(this._fragmentShader));\n\t\t\treturn;\n\t\t}\n\n\t\tthis._gl.attachShader(this._program, this._vertexShader);\n\t\tthis._gl.attachShader(this._program, this._fragmentShader);\n\t\tthis._gl.linkProgram(this._program);\n\n\t\tif (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS)) {\n\t\t\tthrow new Error(this._gl.getProgramInfoLog(this._program));\n\t\t}\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._gl.deleteProgram(this._program);\n\t}\n\n\tpublic focusProgram()\n\t{\n\t\tthis._gl.useProgram(this._program);\n\t}\n\n\tpublic get glProgram():WebGLProgram\n\t{\n\t\treturn this._program;\n\t}\n}\n\nexport = ProgramWebGL;",
    "class ResourceBaseFlash\n{\n\tpublic _pId:number;\n\n\tpublic get id():number\n\t{\n\t\treturn this._pId;\n\t}\n\n\tpublic dispose()\n\t{\n\n\t}\n}\n\nexport = ResourceBaseFlash;",
    "class SamplerState\n{\n\tpublic type:number;\n\tpublic wrap:number;\n\tpublic filter:number;\n\tpublic mipfilter:number;\n}\n\nexport = SamplerState;",
    "import Rectangle\t\t\t\t= require(\"awayjs-core/lib/geom/Rectangle\");\nimport Event\t\t\t\t\t= require(\"awayjs-core/lib/events/Event\");\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport CubeTextureBase\t\t\t= require(\"awayjs-core/lib/textures/CubeTextureBase\");\nimport RenderTexture\t\t\t= require(\"awayjs-core/lib/textures/RenderTexture\");\nimport TextureProxyBase\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\nimport CSS\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/CSS\");\n\nimport ContextMode\t\t\t\t= require(\"awayjs-display/lib/display/ContextMode\");\nimport StageEvent\t\t\t\t= require(\"awayjs-display/lib/events/StageEvent\");\n\nimport ContextStage3D\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport ContextWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextWebGL\");\nimport IContextStageGL\t\t\t= require(\"awayjs-stagegl/lib/base/IContextStageGL\");\nimport StageManager\t\t\t\t= require(\"awayjs-stagegl/lib/managers/StageManager\");\n\n/**\n * Stage provides a proxy class to handle the creation and attachment of the Context\n * (and in turn the back buffer) it uses. Stage should never be created directly,\n * but requested through StageManager.\n *\n * @see away.managers.StageManager\n *\n */\nclass Stage extends EventDispatcher\n{\n\tprivate _context:IContextStageGL;\n\tprivate _container:HTMLElement;\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _x:number = 0;\n\tprivate _y:number = 0;\n\n\t//private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver / request animation frame\n\n\tprivate _stageIndex:number = -1;\n\n\tprivate _usesSoftwareRendering:boolean;\n\tprivate _profile:string;\n\tprivate _stageManager:StageManager;\n\tprivate _antiAlias:number = 0;\n\tprivate _enableDepthAndStencil:boolean;\n\tprivate _contextRequested:boolean;\n\n\t//private var _activeVertexBuffers : Vector.<VertexBuffer> = new Vector.<VertexBuffer>(8, true);\n\t//private var _activeTextures : Vector.<TextureBase> = new Vector.<TextureBase>(8, true);\n\tprivate _renderTarget:TextureProxyBase = null;\n\tprivate _renderSurfaceSelector:number = 0;\n\tprivate _scissorRect:Rectangle;\n\tprivate _color:number;\n\tprivate _backBufferDirty:boolean;\n\tprivate _viewPort:Rectangle;\n\tprivate _enterFrame:Event;\n\tprivate _exitFrame:Event;\n\tprivate _viewportUpdated:StageEvent;\n\tprivate _viewportDirty:boolean;\n\tprivate _bufferClear:boolean;\n\n\t//private _mouse3DManager:away.managers.Mouse3DManager;\n\t//private _touch3DManager:Touch3DManager; //TODO: imeplement dependency Touch3DManager\n\n\tprivate _initialised:boolean = false;\n\n\tconstructor(container:HTMLCanvasElement, stageIndex:number, stageManager:StageManager, forceSoftware:boolean = false, profile:string = \"baseline\")\n\t{\n\t\tsuper();\n\n\t\tthis._container = container;\n\n\t\tthis._stageIndex = stageIndex;\n\n\t\tthis._stageManager = stageManager;\n\n\t\tthis._viewPort = new Rectangle();\n\n\t\tthis._enableDepthAndStencil = true;\n\n\t\tCSS.setElementX(this._container, 0);\n\t\tCSS.setElementY(this._container, 0);\n\n\t\tthis.visible = true;\n\t}\n\n\t/**\n\t * Requests a Context object to attach to the managed gl canvas.\n\t */\n\tpublic requestContext(forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\")\n\t{\n\t\t// If forcing software, we can be certain that the\n\t\t// returned Context will be running software mode.\n\t\t// If not, we can't be sure and should stick to the\n\t\t// old value (will likely be same if re-requesting.)\n\n\t\tif (this._usesSoftwareRendering != null)\n\t\t\tthis._usesSoftwareRendering = forceSoftware;\n\n\t\tthis._profile = profile;\n\n\t\ttry {\n\t\t\tif (mode == ContextMode.FLASH)\n\t\t\t\tnew ContextStage3D(<HTMLCanvasElement> this._container, this._stageIndex, (context:IContextStageGL) => this._callback(context));\n\t\t\telse\n\t\t\t\tthis._context = new ContextWebGL(<HTMLCanvasElement> this._container, this._stageIndex);\n\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tif (mode == ContextMode.AUTO)\n\t\t\t\t\tnew ContextStage3D(<HTMLCanvasElement> this._container, this._stageIndex, (context:IContextStageGL) => this._callback(context));\n\t\t\t\telse\n\t\t\t\t\tthis.dispatchEvent(new Event(Event.ERROR));\n\t\t\t} catch (e) {\n\t\t\t\tthis.dispatchEvent(new Event(Event.ERROR));\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._context)\n\t\t\tthis._callback(this._context);\n\t}\n\n\t/**\n\t * The width of the gl canvas\n\t */\n\tpublic get width()\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(val:number)\n\t{\n\t\tif (this._width == val)\n\t\t\treturn;\n\n\t\tCSS.setElementWidth(this._container, val);\n\n\t\tthis._width = this._viewPort.width = val;\n\n\t\tthis._backBufferDirty = true;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The height of the gl canvas\n\t */\n\tpublic get height()\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(val:number)\n\t{\n\t\tif (this._height == val)\n\t\t\treturn;\n\n\t\tCSS.setElementHeight(this._container, val);\n\n\t\tthis._height = this._viewPort.height = val;\n\n\t\tthis._backBufferDirty = true;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The x position of the gl canvas\n\t */\n\tpublic get x()\n\t{\n\t\treturn this._x;\n\t}\n\n\tpublic set x(val:number)\n\t{\n\t\tif (this._x == val)\n\t\t\treturn;\n\n\t\tCSS.setElementX(this._container, val);\n\n\t\tthis._x = this._viewPort.x = val;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The y position of the gl canvas\n\t */\n\tpublic get y()\n\t{\n\t\treturn this._y;\n\t}\n\n\tpublic set y(val:number)\n\t{\n\t\tif (this._y == val)\n\t\t\treturn;\n\n\t\tCSS.setElementY(this._container, val);\n\n\t\tthis._y = this._viewPort.y = val;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\tpublic set visible(val:boolean)\n\t{\n\t\tCSS.setElementVisibility(this._container, val);\n\t}\n\n\tpublic get visible()\n\t{\n\t\treturn CSS.getElementVisibility(this._container);\n\t}\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._container;\n\t}\n\n\t/**\n\t * The Context object associated with the given stage object.\n\t */\n\tpublic get context():IContextStageGL\n\t{\n\t\treturn this._context;\n\t}\n\n\tprivate notifyViewportUpdated()\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\t//if (!this.hasEventListener(StageEvent.VIEWPORT_UPDATED))\n\t\t//return;\n\n\t\t//if (!_viewportUpdated)\n\t\tthis._viewportUpdated = new StageEvent(StageEvent.VIEWPORT_UPDATED);\n\n\t\tthis.dispatchEvent(this._viewportUpdated);\n\t}\n\n\tprivate notifyEnterFrame()\n\t{\n\t\t//if (!hasEventListener(Event.ENTER_FRAME))\n\t\t//return;\n\n\t\tif (!this._enterFrame)\n\t\t\tthis._enterFrame = new Event(Event.ENTER_FRAME);\n\n\t\tthis.dispatchEvent(this._enterFrame);\n\n\t}\n\n\tprivate notifyExitFrame()\n\t{\n\t\t//if (!hasEventListener(Event.EXIT_FRAME))\n\t\t//return;\n\n\t\tif (!this._exitFrame)\n\t\t\tthis._exitFrame = new Event(Event.EXIT_FRAME);\n\n\t\tthis.dispatchEvent(this._exitFrame);\n\t}\n\n\tpublic get profile():string\n\t{\n\t\treturn this._profile;\n\t}\n\n\t/**\n\t * Disposes the Stage object, freeing the Context attached to the Stage.\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._stageManager.iRemoveStage(this);\n\t\tthis.freeContext();\n\t\tthis._stageManager = null;\n\t\tthis._stageIndex = -1;\n\t}\n\n\t/**\n\t * Configures the back buffer associated with the Stage object.\n\t * @param backBufferWidth The width of the backbuffer.\n\t * @param backBufferHeight The height of the backbuffer.\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param enableDepthAndStencil Indicates whether the back buffer contains a depth and stencil buffer.\n\t */\n\tpublic configureBackBuffer(backBufferWidth:number, backBufferHeight:number, antiAlias:number, enableDepthAndStencil:boolean)\n\t{\n\t\tthis.width = backBufferWidth;\n\t\tthis.height = backBufferHeight;\n\n\t\tthis._antiAlias = antiAlias;\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\n\t\tif (this._context)\n\t\t\tthis._context.configureBackBuffer(backBufferWidth, backBufferHeight, antiAlias, enableDepthAndStencil);\n\t}\n\n\t/*\n\t * Indicates whether the depth and stencil buffer is used\n\t */\n\tpublic get enableDepthAndStencil():boolean\n\t{\n\t\treturn this._enableDepthAndStencil;\n\t}\n\n\tpublic set enableDepthAndStencil(enableDepthAndStencil:boolean)\n\t{\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\t\tthis._backBufferDirty = true;\n\t}\n\n\tpublic get renderTarget():TextureProxyBase\n\t{\n\t\treturn this._renderTarget;\n\t}\n\n\tpublic get renderSurfaceSelector():number\n\t{\n\t\treturn this._renderSurfaceSelector;\n\t}\n\n\t/*\n\t * Clear and reset the back buffer when using a shared context\n\t */\n\tpublic clear()\n\t{\n\t\tif (!this._context)\n\t\t\treturn;\n\n\t\tif (this._backBufferDirty) {\n\t\t\tthis.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\t\t\tthis._backBufferDirty = false;\n\t\t}\n\n\t\tthis._context.clear(( this._color & 0xff000000 ) >>> 24, // <--------- Zero-fill right shift\n\t\t\t\t\t\t\t  ( this._color & 0xff0000 ) >>> 16, // <-------------|\n\t\t\t\t\t\t\t  ( this._color & 0xff00 ) >>> 8, // <----------------|\n\t\t\t\t\t\t\t\tthis._color & 0xff);\n\n\t\tthis._bufferClear = true;\n\t}\n\n\t/**\n\t * Registers an event listener object with an EventDispatcher object so that the listener receives notification of an event. Special case for enterframe and exitframe events - will switch StageProxy into automatic render mode.\n\t * You can register event listeners on all nodes in the display list for a specific type of event, phase, and priority.\n\t *\n\t * @param type The type of event.\n\t * @param listener The listener function that processes the event.\n\t * @param useCapture Determines whether the listener works in the capture phase or the target and bubbling phases. If useCapture is set to true, the listener processes the event only during the capture phase and not in the target or bubbling phase. If useCapture is false, the listener processes the event only during the target or bubbling phase. To listen for the event in all three phases, call addEventListener twice, once with useCapture set to true, then again with useCapture set to false.\n\t * @param priority The priority level of the event listener. The priority is designated by a signed 32-bit integer. The higher the number, the higher the priority. All listeners with priority n are processed before listeners of priority n-1. If two or more listeners share the same priority, they are processed in the order in which they were added. The default priority is 0.\n\t * @param useWeakReference Determines whether the reference to the listener is strong or weak. A strong reference (the default) prevents your listener from being garbage-collected. A weak reference does not.\n\t */\n\tpublic addEventListener(type:string, listener:Function)\n\t{\n\t\tsuper.addEventListener(type, listener);\n\n\t\t//away.Debug.throwPIR( 'StageProxy' , 'addEventListener' ,  'EnterFrame, ExitFrame');\n\n\t\t//if ((type == Event.ENTER_FRAME || type == Event.EXIT_FRAME) ){//&& ! this._frameEventDriver.hasEventListener(Event.ENTER_FRAME)){\n\n\t\t//_frameEventDriver.addEventListener(Event.ENTER_FRAME, onEnterFrame, useCapture, priority, useWeakReference);\n\n\t\t//}\n\n\t\t/* Original code\n\t\t if ((type == Event.ENTER_FRAME || type == Event.EXIT_FRAME) && ! _frameEventDriver.hasEventListener(Event.ENTER_FRAME)){\n\n\t\t _frameEventDriver.addEventListener(Event.ENTER_FRAME, onEnterFrame, useCapture, priority, useWeakReference);\n\n\n\t\t }\n\t\t */\n\t}\n\n\t/**\n\t * Removes a listener from the EventDispatcher object. Special case for enterframe and exitframe events - will switch StageProxy out of automatic render mode.\n\t * If there is no matching listener registered with the EventDispatcher object, a call to this method has no effect.\n\t *\n\t * @param type The type of event.\n\t * @param listener The listener object to remove.\n\t * @param useCapture Specifies whether the listener was registered for the capture phase or the target and bubbling phases. If the listener was registered for both the capture phase and the target and bubbling phases, two calls to removeEventListener() are required to remove both, one call with useCapture() set to true, and another call with useCapture() set to false.\n\t */\n\tpublic removeEventListener(type:string, listener:Function)\n\t{\n\t\tsuper.removeEventListener(type, listener);\n\n\t\t/*\n\t\t // Remove the main rendering listener if no EnterFrame listeners remain\n\t\t if (    ! this.hasEventListener(Event.ENTER_FRAME , this.onEnterFrame , this )\n\t\t &&  ! this.hasEventListener(Event.EXIT_FRAME , this.onEnterFrame , this) ) //&& _frameEventDriver.hasEventListener(Event.ENTER_FRAME))\n\t\t {\n\n\t\t //_frameEventDriver.removeEventListener(Event.ENTER_FRAME, this.onEnterFrame, this );\n\n\t\t }\n\t\t */\n\t}\n\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._scissorRect;\n\t}\n\n\tpublic set scissorRect(value:Rectangle)\n\t{\n\t\tthis._scissorRect = value;\n\n\t\tthis._context.setScissorRectangle(this._scissorRect);\n\t}\n\n\t/**\n\t * The index of the Stage which is managed by this instance of StageProxy.\n\t */\n\tpublic get stageIndex():number\n\t{\n\t\treturn this._stageIndex;\n\t}\n\n\t/**\n\t * Indicates whether the Stage managed by this proxy is running in software mode.\n\t * Remember to wait for the CONTEXT_CREATED event before checking this property,\n\t * as only then will it be guaranteed to be accurate.\n\t */\n\tpublic get usesSoftwareRendering():boolean\n\t{\n\t\treturn this._usesSoftwareRendering;\n\t}\n\n\t/**\n\t * The antiAliasing of the Stage.\n\t */\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(antiAlias:number)\n\t{\n\t\tthis._antiAlias = antiAlias;\n\t\tthis._backBufferDirty = true;\n\t}\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\tthis._viewportDirty = false;\n\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * The background color of the Stage.\n\t */\n\tpublic get color():number\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic set color(color:number)\n\t{\n\t\tthis._color = color;\n\t}\n\n\t/**\n\t * The freshly cleared state of the backbuffer before any rendering\n\t */\n\tpublic get bufferClear():boolean\n\t{\n\t\treturn this._bufferClear;\n\t}\n\n\tpublic set bufferClear(newBufferClear:boolean)\n\t{\n\t\tthis._bufferClear = newBufferClear;\n\t}\n\n\t/*\n\t * Access to fire mouseevents across multiple layered view3D instances\n\t */\n\t//\t\tpublic get mouse3DManager():Mouse3DManager\n\t//\t\t{\n\t//\t\t\treturn this._mouse3DManager;\n\t//\t\t}\n\t//\n\t//\t\tpublic set mouse3DManager(value:Mouse3DManager)\n\t//\t\t{\n\t//\t\t\tthis._mouse3DManager = value;\n\t//\t\t}\n\n\t/* TODO: implement dependency Touch3DManager\n\t public get touch3DManager():Touch3DManager\n\t {\n\t return _touch3DManager;\n\t }\n\n\t public set touch3DManager(value:Touch3DManager)\n\t {\n\t _touch3DManager = value;\n\t }\n\t */\n\n\t/**\n\t * Frees the Context associated with this StageProxy.\n\t */\n\tprivate freeContext()\n\t{\n\t\tif (this._context) {\n\t\t\tthis._context.dispose();\n\n\t\t\tthis.dispatchEvent(new StageEvent(StageEvent.CONTEXT_DISPOSED));\n\t\t}\n\n\t\tthis._context = null;\n\n\t\tthis._initialised = false;\n\t}\n\n\t/**\n\t * The Enter_Frame handler for processing the proxy.ENTER_FRAME and proxy.EXIT_FRAME event handlers.\n\t * Typically the proxy.ENTER_FRAME listener would render the layers for this Stage instance.\n\t */\n\tprivate onEnterFrame(event:Event)\n\t{\n\t\tif (!this._context)\n\t\t\treturn;\n\n\t\t// Clear the stage instance\n\t\tthis.clear();\n\t\t//notify the enterframe listeners\n\t\tthis.notifyEnterFrame();\n\t\t// Call the present() to render the frame\n\t\tif (!this._context)\n\t\t\tthis._context.present();\n\t\t//notify the exitframe listeners\n\t\tthis.notifyExitFrame();\n\t}\n\n\tpublic recoverFromDisposal():boolean\n\t{\n\t\tif (!this._context)\n\t\t\treturn false;\n\n\t\t//away.Debug.throwPIR( 'StageProxy' , 'recoverFromDisposal' , '' );\n\n\t\t/*\n\t\t if (this._iContext.driverInfo == \"Disposed\")\n\t\t {\n\t\t this._iContext = null;\n\t\t this.dispatchEvent(new StageEvent(StageEvent.CONTEXT_DISPOSED));\n\t\t return false;\n\n\t\t }\n\t\t */\n\t\treturn true;\n\n\t}\n\n\tprivate _callback(context:IContextStageGL)\n\t{\n\t\tthis._context = context;\n\n\t\tthis._container = this._context.container;\n\n\t\t// Only configure back buffer if width and height have been set,\n\t\t// which they may not have been if View.render() has yet to be\n\t\t// invoked for the first time.\n\t\tif (this._width && this._height)\n\t\t\tthis._context.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\n\t\t// Dispatch the appropriate event depending on whether context was\n\t\t// created for the first time or recreated after a device loss.\n\t\tthis.dispatchEvent(new StageEvent(this._initialised? StageEvent.CONTEXT_RECREATED : StageEvent.CONTEXT_CREATED));\n\n\t\tthis._initialised = true;\n\t}\n}\n\nexport = Stage;",
    "import AbstractMethodError\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\n\nclass TextureBaseWebGL\n{\n\tpublic textureType:string = \"\";\n\tpublic _gl:WebGLRenderingContext;\n\n\tconstructor(gl:WebGLRenderingContext)\n\t{\n\t\tthis._gl = gl;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthrow \"Abstract method must be overridden.\";\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}\n\nexport = TextureBaseWebGL;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport ByteArrayBase\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArrayBase\");\n\nimport ContextStage3D\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\n\nclass TextureFlash extends ResourceBaseFlash implements ITexture\n{\n\tprivate _context:ContextStage3D;\n\tprivate _width:number;\n\tprivate _height:number;\n\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tconstructor(context:ContextStage3D, width:number, height:number, format:string, forRTT:boolean, streaming:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initTexture, (forRTT? OpCodes.trueValue : OpCodes.falseValue)) + width + \",\" + height + \",\" + streaming + \",\" + format + \"$\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeTexture) + this._pId.toString() + \",\");\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic uploadFromData(bitmapData:BitmapData, miplevel?:number);\n\tpublic uploadFromData(image:HTMLImageElement, miplevel?:number);\n\tpublic uploadFromData(data:any, miplevel:number = 0)\n\t{\n\t\tif (data instanceof BitmapData) {\n\t\t\tdata = (<BitmapData> data).imageData.data;\n\t\t} else if (data instanceof HTMLImageElement) {\n\t\t\tvar can = document.createElement(\"canvas\");\n\t\t\tvar w = data.width;\n\t\t\tvar h = data.height;\n\t\t\tcan.width = w;\n\t\t\tcan.height = h;\n\t\t\tvar ctx = can.getContext(\"2d\");\n\t\t\tctx.drawImage(data, 0, 0);\n\t\t\tdata = ctx.getImageData(0, 0, w, h).data;\n\t\t}\n\n\t\tvar pos = 0;\n\t\tvar bytes = ByteArrayBase.internalGetBase64String(data.length, function () {\n\t\t\treturn data[pos++];\n\t\t}, null);\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadBytesTexture) + this._pId + \",\" + miplevel + \",\" + (this._width >> miplevel) + \",\" + (this._height >> miplevel) + \",\" + bytes + \"%\");\n\t\tthis._context.execute();\n\t}\n}\n\nexport = TextureFlash;",
    "import BitmapData\t\t\t\t\t= require(\"awayjs-core/lib/base/BitmapData\");\nimport ByteArray\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport ITexture\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITexture\");\nimport TextureBaseWebGL\t\t\t\t= require(\"awayjs-stagegl/lib/base/TextureBaseWebGL\");\n\nclass TextureWebGL extends TextureBaseWebGL implements ITexture\n{\n\n\tpublic textureType:string = \"texture2d\";\n\n\tprivate _width:number;\n\tprivate _height:number;\n\n\tprivate _frameBuffer:WebGLFramebuffer;\n\n\tprivate _glTexture:WebGLTexture;\n\n\tconstructor(gl:WebGLRenderingContext, width:number, height:number)\n\t{\n\t\tsuper(gl);\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._glTexture = this._gl.createTexture();\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._gl.deleteTexture(this._glTexture);\n\t}\n\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic get frameBuffer():WebGLFramebuffer\n\t{\n\t\tif (!this._frameBuffer) {\n\t\t\tthis._frameBuffer = this._gl.createFramebuffer();\n\t\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._frameBuffer);\n\t\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n\t\t\tthis._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._width, this._height, 0, this._gl.RGBA, this._gl.UNSIGNED_BYTE, null);\n\n\t\t\tvar renderBuffer:WebGLRenderbuffer = this._gl.createRenderbuffer();\n\t\t\tthis._gl.bindRenderbuffer(this._gl.RENDERBUFFER, renderBuffer);\n\t\t\tthis._gl.renderbufferStorage(this._gl.RENDERBUFFER, this._gl.DEPTH_COMPONENT16, this._width, this._height);\n\n\t\t\tthis._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, this._gl.COLOR_ATTACHMENT0, this._gl.TEXTURE_2D, this._glTexture, 0);\n\t\t\tthis._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER, this._gl.DEPTH_ATTACHMENT, this._gl.RENDERBUFFER, renderBuffer);\n\n\t\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, null);\n\t\t\tthis._gl.bindRenderbuffer(this._gl.RENDERBUFFER, null);\n\t\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n\t\t}\n\n\t\treturn this._frameBuffer;\n\t}\n\n\tpublic uploadFromData(bitmapData:BitmapData, miplevel?:number);\n\tpublic uploadFromData(image:HTMLImageElement, miplevel?:number);\n\tpublic uploadFromData(data:any, miplevel:number = 0)\n\t{\n\t\tif (data instanceof BitmapData)\n\t\t\tdata = (<BitmapData> data).imageData;\n\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n\t\tthis._gl.texImage2D(this._gl.TEXTURE_2D, miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, null);\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false)\n\t{\n\t\tvar ext:Object = this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\");\n\t\t//this._gl.compressedTexImage2D(this._gl.TEXTURE_2D, 0, this)\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\treturn this._glTexture;\n\t}\n\n\tpublic generateMipmaps()\n\t{\n\t\t//TODO: implement generating mipmaps\n\t\t//this._gl.bindTexture( this._gl.TEXTURE_2D, this._glTexture );\n\t\t//this._gl.generateMipmap(this._gl.TEXTURE_2D);\n\t\t//this._gl.bindTexture( this._gl.TEXTURE_2D, null );\n\t}\n}\n\nexport = TextureWebGL;",
    "import ContextStage3D\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextStage3D\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\nimport OpCodes\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/OpCodes\");\nimport ResourceBaseFlash\t\t\t= require(\"awayjs-stagegl/lib/base/ResourceBaseFlash\");\n\nclass VertexBufferFlash extends ResourceBaseFlash implements IVertexBuffer\n{\n\tprivate _context:ContextStage3D;\n\tprivate _numVertices:number;\n\tprivate _data32PerVertex:number;\n\n\tconstructor(context:ContextStage3D, numVertices:number, data32PerVertex:number)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._numVertices = numVertices;\n\t\tthis._data32PerVertex = data32PerVertex;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initVertexBuffer, data32PerVertex + OpCodes.intMask) + numVertices.toString() + \",\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic uploadFromArray(data:number[], startVertex:number, numVertices:number)\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadArrayVertexBuffer, this._pId + OpCodes.intMask) + data.join() + \"#\" + [startVertex, numVertices].join() + \",\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get data32PerVertex():number\n\t{\n\t\treturn this._data32PerVertex;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeVertexBuffer, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n}\n\nexport = VertexBufferFlash;",
    "import IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\nclass VertexBufferWebGL implements IVertexBuffer\n{\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _numVertices:number;\n\tprivate _data32PerVertex:number;\n\tprivate _buffer:WebGLBuffer;\n\n\tconstructor(gl:WebGLRenderingContext, numVertices:number, data32PerVertex:number)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._buffer = this._gl.createBuffer();\n\t\tthis._numVertices = numVertices;\n\t\tthis._data32PerVertex = data32PerVertex;\n\t}\n\n\tpublic uploadFromArray(vertices:number[], startVertex:number, numVertices:number)\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._buffer);\n\n\t\t//console.log( \"** WARNING upload not fully implemented, startVertex & numVertices not considered.\" );\n\t\t// TODO add offsets , startVertex, numVertices * this._data32PerVertex\n\t\tthis._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(vertices), this._gl.STATIC_DRAW);\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get data32PerVertex():number\n\t{\n\t\treturn this._data32PerVertex;\n\t}\n\n\tpublic get glBuffer():WebGLBuffer\n\t{\n\t\treturn this._buffer;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tthis._gl.deleteBuffer(this._buffer);\n\t}\n}\n\nexport = VertexBufferWebGL;",
    "import EventDispatcher\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ArgumentError\t\t\t\t= require(\"awayjs-core/lib/errors/ArgumentError\");\n\nimport StageEvent\t\t\t\t\t= require(\"awayjs-display/lib/events/StageEvent\");\n\nimport Stage\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/Stage\");\n\n/**\n * The StageManager class provides a multiton object that handles management for Stage objects.\n *\n * @see away.base.Stage\n */\nclass StageManager extends EventDispatcher\n{\n\tprivate static STAGE_MAX_QUANTITY:number = 8;\n\tprivate _stages:Array<Stage>;\n\n\tprivate static _instance:StageManager;\n\tprivate static _numStages:number = 0;\n\tprivate _onContextCreatedDelegate:(event:Event) => void;\n\n\t/**\n\t * Creates a new StageManager class.\n\t * @param stage The Stage object that contains the Stage objects to be managed.\n\t * @private\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._stages = new Array<Stage>(StageManager.STAGE_MAX_QUANTITY);\n\n\t\tthis._onContextCreatedDelegate = (event:Event) => this.onContextCreated(event);\n\t}\n\n\t/**\n\t * Gets a StageManager instance for the given Stage object.\n\t * @param stage The Stage object that contains the Stage objects to be managed.\n\t * @return The StageManager instance for the given Stage object.\n\t */\n\tpublic static getInstance():StageManager\n\t{\n\t\tif (this._instance == null)\n\t\t\tthis._instance = new StageManager();\n\n\t\treturn this._instance;\n\t}\n\n\t/**\n\t * Requests the Stage for the given index.\n\t *\n\t * @param index The index of the requested Stage.\n\t * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n\t * @param profile The compatibility profile, an enumeration of ContextProfile\n\t * @return The Stage for the given index.\n\t */\n\tpublic getStageAt(index:number, forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\"):Stage\n\t{\n\t\tif (index < 0 || index >= StageManager.STAGE_MAX_QUANTITY)\n\t\t\tthrow new ArgumentError(\"Index is out of bounds [0..\" + StageManager.STAGE_MAX_QUANTITY + \"]\");\n\n\t\tif (!this._stages[index]) {\n\t\t\tStageManager._numStages++;\n\n\t\t\tvar canvas:HTMLCanvasElement = document.createElement(\"canvas\");\n\t\t\tcanvas.id = \"stage\" + index;\n\t\t\tdocument.body.appendChild(canvas);\n\t\t\tvar stage:Stage = this._stages[index] = new Stage(canvas, index, this, forceSoftware, profile);\n\t\t\tstage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n\t\t\tstage.requestContext(forceSoftware, profile, mode);\n\t\t}\n\n\t\treturn stage;\n\t}\n\n\t/**\n\t * Removes a Stage from the manager.\n\t * @param stage\n\t * @private\n\t */\n\tpublic iRemoveStage(stage:Stage)\n\t{\n\t\tStageManager._numStages--;\n\n\t\tstage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n\n\t\tthis._stages[stage.stageIndex] = null;\n\t}\n\n\t/**\n\t * Get the next available stage. An error is thrown if there are no StageProxies available\n\t * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n\t * @param profile The compatibility profile, an enumeration of ContextProfile\n\t * @return The allocated stage\n\t */\n\tpublic getFreeStage(forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\"):Stage\n\t{\n\t\tvar i:number = 0;\n\t\tvar len:number = this._stages.length;\n\n\t\twhile (i < len) {\n\t\t\tif (!this._stages[i])\n\t\t\t\treturn this.getStageAt(i, forceSoftware, profile, mode);\n\n\t\t\t++i;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Checks if a new stage can be created and managed by the class.\n\t * @return true if there is one slot free for a new stage\n\t */\n\tpublic get hasFreeStage():boolean\n\t{\n\t\treturn StageManager._numStages < StageManager.STAGE_MAX_QUANTITY? true : false;\n\t}\n\n\t/**\n\t * Returns the amount of stage objects that can be created and managed by the class\n\t * @return the amount of free slots\n\t */\n\tpublic get numSlotsFree():number\n\t{\n\t\treturn StageManager.STAGE_MAX_QUANTITY - StageManager._numStages;\n\t}\n\n\t/**\n\t * Returns the amount of Stage objects currently managed by the class.\n\t * @return the amount of slots used\n\t */\n\tpublic get numSlotsUsed():number\n\t{\n\t\treturn StageManager._numStages;\n\t}\n\n\t/**\n\t * The maximum amount of Stage objects that can be managed by the class\n\t */\n\tpublic get numSlotsTotal():number\n\t{\n\t\treturn this._stages.length;\n\t}\n\n\tprivate onContextCreated(event:Event):void\n\t{\n\t\t//var stage:Stage = <Stage> e.target;\n\t\t//document.body.appendChild(stage.canvas)\n\t}\n}\n\nexport = StageManager;",
    "import SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport IIndexBuffer\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IIndexBuffer\");\n\n/**\n *\n */\nclass IndexData\n{\n\tprivate static LIMIT_VERTS:number = 0xffff;\n\n\tprivate static LIMIT_INDICES:number = 0xffffff;\n\n\tprivate _dataDirty = true;\n\n\tpublic invalid:Array<boolean> = new Array(8);\n\n\tpublic contexts:Array<ContextGLBase> = new Array<ContextGLBase>(8);\n\n\tpublic buffers:Array<IIndexBuffer> = new Array<IIndexBuffer>(8);\n\n\tpublic data:Array<number>;\n\n\tpublic indexMappings:Array<number>;\n\n\tpublic originalIndices:Array<number>;\n\n\tpublic offset:number;\n\n\tpublic level:number;\n\n\tconstructor(level:number)\n\t{\n\t\tthis.level = level;\n\t}\n\n\tpublic updateData(offset:number, indices:Array<number>, numVertices:number)\n\t{\n\t\tif (this._dataDirty) {\n\t\t\tthis._dataDirty = false;\n\n\t\t\tif (indices.length < IndexData.LIMIT_INDICES && numVertices < IndexData.LIMIT_VERTS) {\n\t\t\t\t//shortcut for those buffers that fit into the maximum buffer sizes\n\t\t\t\tthis.indexMappings = null;\n\t\t\t\tthis.originalIndices = null;\n\t\t\t\tthis.setData(indices);\n\t\t\t\tthis.offset = indices.length;\n\t\t\t} else {\n\t\t\t\tvar i:number;\n\t\t\t\tvar len:number;\n\t\t\t\tvar outIndex:number;\n\t\t\t\tvar j:number;\n\t\t\t\tvar k:number;\n\t\t\t\tvar splitIndices:Array<number> = new Array<number>();\n\n\t\t\t\tthis.indexMappings = new Array<number>(indices.length);\n\t\t\t\tthis.originalIndices = new Array<number>();\n\n\t\t\t\ti = this.indexMappings.length;\n\n\t\t\t\twhile (i--)\n\t\t\t\t\tthis.indexMappings[i] = -1;\n\n\t\t\t\tvar originalIndex:number;\n\t\t\t\tvar splitIndex:number;\n\n\t\t\t\t// Loop over all triangles\n\t\t\t\toutIndex = 0;\n\t\t\t\tlen = indices.length;\n\t\t\t\ti = offset;\n\t\t\t\tk = 0;\n\t\t\t\twhile (i < len && outIndex + 3 < IndexData.LIMIT_INDICES && k + 3 < IndexData.LIMIT_VERTS) {\n\t\t\t\t\t// Loop over all vertices in a triangle //TODO ensure this works for segments or any grouping\n\t\t\t\t\tfor (j = 0; j < 3; j++) {\n\n\t\t\t\t\t\toriginalIndex = indices[i + j];\n\n\t\t\t\t\t\tif (this.indexMappings[originalIndex] >= 0) {\n\t\t\t\t\t\t\tsplitIndex = this.indexMappings[originalIndex];\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// This vertex does not yet exist in the split list and\n\t\t\t\t\t\t\t// needs to be copied from the long list.\n\t\t\t\t\t\t\tsplitIndex = k++;\n\t\t\t\t\t\t\tthis.indexMappings[originalIndex] = splitIndex;\n\t\t\t\t\t\t\tthis.originalIndices.push(originalIndex);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Store new index, which may have come from the mapping look-up,\n\t\t\t\t\t\t// or from copying a new set of vertex data from the original vector\n\t\t\t\t\t\tsplitIndices[outIndex + j] = splitIndex;\n\t\t\t\t\t}\n\n\t\t\t\t\toutIndex += 3;\n\t\t\t\t\ti += 3\n\t\t\t\t}\n\n\t\t\t\tthis.setData(splitIndices);\n\t\t\t\tthis.offset = i;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic invalidateData()\n\t{\n\t\tthis._dataDirty = true;\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tif (this.contexts[i]) {\n\t\t\t\tthis.contexts[i].disposeIndexData(this);\n\t\t\t\tthis.contexts[i] = null\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate disposeBuffers()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tif (this.buffers[i]) {\n\t\t\t\tthis.buffers[i].dispose();\n\t\t\t\tthis.buffers[i] = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidateBuffers()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i)\n\t\t\tthis.invalid[i] = true;\n\t}\n\n\t/**\n\t *\n\t * @param data\n\t * @private\n\t */\n\tprivate setData(data:Array<number>)\n\t{\n\t\tif (this.data && this.data.length != data.length)\n\t\t\tthis.disposeBuffers();\n\t\telse\n\t\t\tthis.invalidateBuffers();\n\n\t\tthis.data = data;\n\t}\n}\n\nexport = IndexData;",
    "import SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\nimport IndexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexData\");\n\n/**\n *\n */\nclass IndexDataPool\n{\n\tprivate static _pool:Object = new Object();\n\n\tconstructor()\n\t{\n\t}\n\n\tpublic static getItem(subGeometry:SubGeometryBase, level:number, indexOffset:number):IndexData\n\t{\n\t\tvar subGeometryData:Array<IndexData> = <Array<IndexData>> (IndexDataPool._pool[subGeometry.id] || (IndexDataPool._pool[subGeometry.id] = new Array<IndexData>()));\n\n\t\tvar indexData:IndexData = subGeometryData[level] || (subGeometryData[level] = new IndexData(level));\n\t\tindexData.updateData(indexOffset, subGeometry.indices, subGeometry.numVertices);\n\n\t\treturn indexData;\n\t}\n\n\tpublic static disposeItem(id:number, level:number)\n\t{\n\t\tvar subGeometryData:Array<IndexData> = <Array<IndexData>> this._pool[id];\n\n\t\tsubGeometryData[level].dispose();\n\t\tsubGeometryData[level] = null;\n\t}\n\n\tpublic disposeData(id:number)\n\t{\n\t\tvar subGeometryData:Array<IndexData> = <Array<IndexData>> IndexDataPool._pool[id];\n\n\t\tvar len:number = subGeometryData.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tsubGeometryData[i].dispose();\n\t\t\tsubGeometryData[i] = null;\n\t\t}\n\n\t\tIndexDataPool._pool[id] = null;\n\t}\n}\n\nexport = IndexDataPool;",
    "import ProgramDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramDataPool\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport IProgram\t\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/IProgram\");\n\n/**\n *\n * @class away.pool.ProgramDataBase\n */\nclass ProgramData\n{\n\tpublic static PROGRAMDATA_ID_COUNT:number = 0;\n\n\tprivate _pool:ProgramDataPool;\n\tprivate _key:string;\n\n\tpublic context:ContextGLBase;\n\n\tpublic usages:number = 0;\n\n\tpublic program:IProgram;\n\n\tpublic id:number;\n\n\tconstructor(pool:ProgramDataPool, context:ContextGLBase, key:string)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.context = context;\n\t\tthis._key = key;\n\t\tthis.context.registerProgram(this);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis.usages--;\n\n\t\tif (!this.usages) {\n\t\t\tthis._pool.disposeItem(this._key);\n\n\t\t\tthis.context.unRegisterProgram(this);\n\n\t\t\tif (this.program)\n\t\t\t\tthis.program.dispose();\n\t\t}\n\n\t\tthis.program = null;\n\t}\n}\n\nexport = ProgramData;",
    "import TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport ProgramData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/ProgramData\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\n\n/**\n * @class away.pool.ProgramDataPool\n */\nclass ProgramDataPool\n{\n\tprivate _pool:Object = new Object();\n\tprivate _context:ContextGLBase;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(context:ContextGLBase)\n\t{\n\t\tthis._context = context;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(key:string):ProgramData\n\t{\n\t\treturn this._pool[key] || (this._pool[key] = new ProgramData(this, this._context, key));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(key:string)\n\t{\n\t\tthis._pool[key] = null;\n\t}\n}\n\nexport = ProgramDataPool;",
    "import ITextureData\t\t\t\t\t= require(\"awayjs-core/lib/pool/ITextureData\");\nimport TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport TextureDataPool\t\t\t\t= require(\"awayjs-stagegl/lib/pool/TextureDataPool\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport ITextureBase\t\t\t\t\t= require(\"awayjs-stagegl/lib/base/ITextureBase\");\n\n/**\n *\n * @class away.pool.TextureDataBase\n */\nclass TextureData implements ITextureData\n{\n\tprivate _pool:TextureDataPool;\n\n\tpublic context:ContextGLBase;\n\n\tpublic texture:ITextureBase;\n\n\tpublic textureProxy:TextureProxyBase;\n\n\tpublic invalid:boolean;\n\n\tconstructor(pool:TextureDataPool, context:ContextGLBase, textureProxy:TextureProxyBase)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.context = context;\n\t\tthis.textureProxy = textureProxy;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose()\n\t{\n\t\tthis._pool.disposeItem(this.textureProxy);\n\n\t\tthis.texture.dispose();\n\t\tthis.texture = null;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic invalidate()\n\t{\n\t\tthis.invalid = true;\n\t}\n}\n\nexport = TextureData;",
    "import TextureProxyBase\t\t\t\t= require(\"awayjs-core/lib/textures/TextureProxyBase\");\n\nimport TextureData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/TextureData\");\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\n\n/**\n * @class away.pool.TextureDataPool\n */\nclass TextureDataPool\n{\n\tprivate _pool:Object = new Object();\n\tprivate _context:ContextGLBase;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(context:ContextGLBase)\n\t{\n\t\tthis._context = context;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(textureProxy:TextureProxyBase):TextureData\n\t{\n\t\treturn (this._pool[textureProxy.id] || (this._pool[textureProxy.id] = textureProxy._iAddTextureData(new TextureData(this, this._context, textureProxy))))\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(textureProxy:TextureProxyBase)\n\t{\n\t\ttextureProxy._iRemoveTextureData(this._pool[textureProxy.id]);\n\n\t\tthis._pool[textureProxy.id] = null;\n\t}\n}\n\nexport = TextureDataPool;",
    "import SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport SubGeometryEvent\t\t\t\t= require(\"awayjs-display/lib/events/SubGeometryEvent\");\n\nimport ContextGLBase\t\t\t\t= require(\"awayjs-stagegl/lib/base/ContextGLBase\");\nimport IVertexBuffer\t\t\t\t= require(\"awayjs-stagegl/lib/base/IVertexBuffer\");\n\n/**\n *\n */\nclass VertexData\n{\n\tprivate _onVerticesUpdatedDelegate:(event:SubGeometryEvent) => void;\n\tprivate _subGeometry:SubGeometryBase;\n\tprivate _dataType:string;\n\tprivate _dataDirty = true;\n\n\tpublic invalid:Array<boolean> = new Array<boolean>(8);\n\n\tpublic buffers:Array<IVertexBuffer> = new Array<IVertexBuffer>(8);\n\n\tpublic contexts:Array<ContextGLBase> = new Array<ContextGLBase>(8);\n\n\tpublic data:Array<number>;\n\n\tpublic dataPerVertex:number;\n\n\tconstructor(subGeometry:SubGeometryBase, dataType:string)\n\t{\n\t\tthis._subGeometry = subGeometry;\n\t\tthis._dataType = dataType;\n\n\t\tthis._onVerticesUpdatedDelegate = (event:SubGeometryEvent) => this._onVerticesUpdated(event);\n\t\tthis._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);\n\t}\n\n\tpublic updateData(originalIndices:Array<number> = null, indexMappings:Array<number> = null)\n\t{\n\t\tif (this._dataDirty) {\n\t\t\tthis._dataDirty = false;\n\n\t\t\tthis.dataPerVertex = this._subGeometry.getStride(this._dataType);\n\n\t\t\tvar vertices:Array<number> = this._subGeometry[this._dataType];\n\n\t\t\tif (indexMappings == null) {\n\t\t\t\tthis.setData(vertices);\n\t\t\t} else {\n\t\t\t\tvar splitVerts:Array<number> = new Array<number>(originalIndices.length*this.dataPerVertex);\n\t\t\t\tvar originalIndex:number;\n\t\t\t\tvar splitIndex:number;\n\t\t\t\tvar i:number = 0;\n\t\t\t\tvar j:number = 0;\n\t\t\t\twhile(i < originalIndices.length) {\n\t\t\t\t\toriginalIndex = originalIndices[i];\n\n\t\t\t\t\tsplitIndex = indexMappings[originalIndex]*this.dataPerVertex;\n\t\t\t\t\toriginalIndex *= this.dataPerVertex;\n\n\t\t\t\t\tfor (j = 0; j < this.dataPerVertex; j++)\n\t\t\t\t\t\tsplitVerts[splitIndex + j] = vertices[originalIndex + j];\n\n\t\t\t\t\ti++;\n\t\t\t\t}\n\n\t\t\t\tthis.setData(splitVerts);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic dispose()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tif (this.contexts[i]) {\n\t\t\t\tthis.contexts[i].disposeVertexData(this);\n\t\t\t\tthis.contexts[i] = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate disposeBuffers()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i) {\n\t\t\tif (this.buffers[i]) {\n\t\t\t\tthis.buffers[i].dispose();\n\t\t\t\tthis.buffers[i] = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tprivate invalidateBuffers()\n\t{\n\t\tfor (var i:number = 0; i < 8; ++i)\n\t\t\tthis.invalid[i] = true;\n\t}\n\n\t/**\n\t *\n\t * @param data\n\t * @param dataPerVertex\n\t * @private\n\t */\n\tprivate setData(data:Array<number>)\n\t{\n\t\tif (this.data && this.data.length != data.length)\n\t\t\tthis.disposeBuffers();\n\t\telse\n\t\t\tthis.invalidateBuffers();\n\n\t\tthis.data = data;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param event\n\t * @private\n\t */\n\tprivate _onVerticesUpdated(event:SubGeometryEvent)\n\t{\n\t\tvar dataType:string = this._subGeometry.concatenateArrays? SubGeometryBase.VERTEX_DATA : event.dataType;\n\n\t\tif (dataType == this._dataType)\n\t\t\tthis._dataDirty = true;\n\t}\n}\n\nexport = VertexData;",
    "import SubGeometryBase\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\n\nimport IndexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/IndexData\");\nimport VertexData\t\t\t\t\t= require(\"awayjs-stagegl/lib/pool/VertexData\");\n\n/**\n *\n */\nclass VertexDataPool\n{\n\tprivate static _pool:Object = new Object();\n\n\tconstructor()\n\t{\n\t}\n\n\tpublic static getItem(subGeometry:SubGeometryBase, indexData:IndexData, dataType:string):VertexData\n\t{\n\t\tif (subGeometry.concatenateArrays)\n\t\t\tdataType = SubGeometryBase.VERTEX_DATA;\n\n\t\tvar subGeometryDictionary:Object = <Object> (VertexDataPool._pool[subGeometry.id] || (VertexDataPool._pool[subGeometry.id] = new Object()));\n\t\tvar subGeometryData:Array<VertexData> = <Array<VertexData>> (subGeometryDictionary[dataType] || (subGeometryDictionary[dataType] = new Array<VertexData>()));\n\n\t\tvar vertexData:VertexData = subGeometryData[indexData.level] || (subGeometryData[indexData.level] = new VertexData(subGeometry, dataType));\n\t\tvertexData.updateData(indexData.originalIndices, indexData.indexMappings);\n\n\t\treturn vertexData;\n\t}\n\n\tpublic static disposeItem(subGeometry:SubGeometryBase, level:number, dataType:string)\n\t{\n\t\tvar subGeometryDictionary:Object = <Object> VertexDataPool._pool[subGeometry.id];\n\t\tvar subGeometryData:Array<VertexData> = <Array<VertexData>> subGeometryDictionary[dataType];\n\n\t\tsubGeometryData[level].dispose();\n\t\tsubGeometryData[level] = null;\n\t}\n\n\tpublic disposeData(subGeometry:SubGeometryBase)\n\t{\n\t\tvar subGeometryDictionary:Object = <Object> VertexDataPool._pool[subGeometry.id];\n\n\t\tfor (var key in subGeometryDictionary) {\n\t\t\tvar subGeometryData:Array<VertexData> = <Array<VertexData>> subGeometryDictionary[key];\n\n\t\t\tvar len:number = subGeometryData.length;\n\t\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\t\tsubGeometryData[i].dispose();\n\t\t\t\tsubGeometryData[i] = null;\n\t\t\t}\n\t\t}\n\n\t\tVertexDataPool._pool[subGeometry.id] = null;\n\t}\n}\n\nexport = VertexDataPool;",
    "/*!\tSWFObject v2.2 <http://code.google.com/p/swfobject/> \n\tis released under the MIT License <http://www.opensource.org/licenses/mit-license.php> \n*/\n\nvar swfobject = function() {\n\t\n\tvar UNDEF = \"undefined\",\n\t\tOBJECT = \"object\",\n\t\tSHOCKWAVE_FLASH = \"Shockwave Flash\",\n\t\tSHOCKWAVE_FLASH_AX = \"ShockwaveFlash.ShockwaveFlash\",\n\t\tFLASH_MIME_TYPE = \"application/x-shockwave-flash\",\n\t\tEXPRESS_INSTALL_ID = \"SWFObjectExprInst\",\n\t\tON_READY_STATE_CHANGE = \"onreadystatechange\",\n\t\t\n\t\twin = window,\n\t\tdoc = document,\n\t\tnav = navigator,\n\t\t\n\t\tplugin = false,\n\t\tdomLoadFnArr = [main],\n\t\tregObjArr = [],\n\t\tobjIdArr = [],\n\t\tlistenersArr = [],\n\t\tstoredAltContent,\n\t\tstoredAltContentId,\n\t\tstoredCallbackFn,\n\t\tstoredCallbackObj,\n\t\tisDomLoaded = false,\n\t\tisExpressInstallActive = false,\n\t\tdynamicStylesheet,\n\t\tdynamicStylesheetMedia,\n\t\tautoHideShow = true,\n\t\n\t/* Centralized function for browser feature detection\n\t\t- User agent string detection is only used when no good alternative is possible\n\t\t- Is executed directly for optimal performance\n\t*/\t\n\tua = function() {\n\t\tvar w3cdom = typeof doc.getElementById != UNDEF && typeof doc.getElementsByTagName != UNDEF && typeof doc.createElement != UNDEF,\n\t\t\tu = nav.userAgent.toLowerCase(),\n\t\t\tp = nav.platform.toLowerCase(),\n\t\t\twindows = p ? /win/.test(p) : /win/.test(u),\n\t\t\tmac = p ? /mac/.test(p) : /mac/.test(u),\n\t\t\twebkit = /webkit/.test(u) ? parseFloat(u.replace(/^.*webkit\\/(\\d+(\\.\\d+)?).*$/, \"$1\")) : false, // returns either the webkit version or false if not webkit\n\t\t\tie = !+\"\\v1\", // feature detection based on Andrea Giammarchi's solution: http://webreflection.blogspot.com/2009/01/32-bytes-to-know-if-your-browser-is-ie.html\n\t\t\tplayerVersion = [0,0,0],\n\t\t\td = null;\n\t\tif (typeof nav.plugins != UNDEF && typeof nav.plugins[SHOCKWAVE_FLASH] == OBJECT) {\n\t\t\td = nav.plugins[SHOCKWAVE_FLASH].description;\n\t\t\tif (d && !(typeof nav.mimeTypes != UNDEF && nav.mimeTypes[FLASH_MIME_TYPE] && !nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)) { // navigator.mimeTypes[\"application/x-shockwave-flash\"].enabledPlugin indicates whether plug-ins are enabled or disabled in Safari 3+\n\t\t\t\tplugin = true;\n\t\t\t\tie = false; // cascaded feature detection for Internet Explorer\n\t\t\t\td = d.replace(/^.*\\s+(\\S+\\s+\\S+$)/, \"$1\");\n\t\t\t\tplayerVersion[0] = parseInt(d.replace(/^(.*)\\..*$/, \"$1\"), 10);\n\t\t\t\tplayerVersion[1] = parseInt(d.replace(/^.*\\.(.*)\\s.*$/, \"$1\"), 10);\n\t\t\t\tplayerVersion[2] = /[a-zA-Z]/.test(d) ? parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/, \"$1\"), 10) : 0;\n\t\t\t}\n\t\t}\n\t\telse if (typeof win.ActiveXObject != UNDEF) {\n\t\t\ttry {\n\t\t\t\tvar a = new ActiveXObject(SHOCKWAVE_FLASH_AX);\n\t\t\t\tif (a) { // a will return null when ActiveX is disabled\n\t\t\t\t\td = a.GetVariable(\"$version\");\n\t\t\t\t\tif (d) {\n\t\t\t\t\t\tie = true; // cascaded feature detection for Internet Explorer\n\t\t\t\t\t\td = d.split(\" \")[1].split(\",\");\n\t\t\t\t\t\tplayerVersion = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch(e) {}\n\t\t}\n\t\treturn { w3:w3cdom, pv:playerVersion, wk:webkit, ie:ie, win:windows, mac:mac };\n\t}(),\n\t\n\t/* Cross-browser onDomLoad\n\t\t- Will fire an event as soon as the DOM of a web page is loaded\n\t\t- Internet Explorer workaround based on Diego Perini's solution: http://javascript.nwbox.com/IEContentLoaded/\n\t\t- Regular onload serves as fallback\n\t*/ \n\tonDomLoad = function() {\n\t\tif (!ua.w3) { return; }\n\t\tif ((typeof doc.readyState != UNDEF && doc.readyState == \"complete\") || (typeof doc.readyState == UNDEF && (doc.getElementsByTagName(\"body\")[0] || doc.body))) { // function is fired after onload, e.g. when script is inserted dynamically \n\t\t\tcallDomLoadFunctions();\n\t\t}\n\t\tif (!isDomLoaded) {\n\t\t\tif (typeof doc.addEventListener != UNDEF) {\n\t\t\t\tdoc.addEventListener(\"DOMContentLoaded\", callDomLoadFunctions, false);\n\t\t\t}\t\t\n\t\t\tif (ua.ie && ua.win) {\n\t\t\t\tdoc.attachEvent(ON_READY_STATE_CHANGE, function() {\n\t\t\t\t\tif (doc.readyState == \"complete\") {\n\t\t\t\t\t\tdoc.detachEvent(ON_READY_STATE_CHANGE, arguments.callee);\n\t\t\t\t\t\tcallDomLoadFunctions();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (win == top) { // if not inside an iframe\n\t\t\t\t\t(function(){\n\t\t\t\t\t\tif (isDomLoaded) { return; }\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdoc.documentElement.doScroll(\"left\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcallDomLoadFunctions();\n\t\t\t\t\t})();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ua.wk) {\n\t\t\t\t(function(){\n\t\t\t\t\tif (isDomLoaded) { return; }\n\t\t\t\t\tif (!/loaded|complete/.test(doc.readyState)) {\n\t\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcallDomLoadFunctions();\n\t\t\t\t})();\n\t\t\t}\n\t\t\taddLoadEvent(callDomLoadFunctions);\n\t\t}\n\t}();\n\t\n\tfunction callDomLoadFunctions() {\n\t\tif (isDomLoaded) { return; }\n\t\ttry { // test if we can really add/remove elements to/from the DOM; we don't want to fire it too early\n\t\t\tvar t = doc.getElementsByTagName(\"body\")[0].appendChild(createElement(\"span\"));\n\t\t\tt.parentNode.removeChild(t);\n\t\t}\n\t\tcatch (e) { return; }\n\t\tisDomLoaded = true;\n\t\tvar dl = domLoadFnArr.length;\n\t\tfor (var i = 0; i < dl; i++) {\n\t\t\tdomLoadFnArr[i]();\n\t\t}\n\t}\n\t\n\tfunction addDomLoadEvent(fn) {\n\t\tif (isDomLoaded) {\n\t\t\tfn();\n\t\t}\n\t\telse { \n\t\t\tdomLoadFnArr[domLoadFnArr.length] = fn; // Array.push() is only available in IE5.5+\n\t\t}\n\t}\n\t\n\t/* Cross-browser onload\n\t\t- Based on James Edwards' solution: http://brothercake.com/site/resources/scripts/onload/\n\t\t- Will fire an event as soon as a web page including all of its assets are loaded \n\t */\n\tfunction addLoadEvent(fn) {\n\t\tif (typeof win.addEventListener != UNDEF) {\n\t\t\twin.addEventListener(\"load\", fn, false);\n\t\t}\n\t\telse if (typeof doc.addEventListener != UNDEF) {\n\t\t\tdoc.addEventListener(\"load\", fn, false);\n\t\t}\n\t\telse if (typeof win.attachEvent != UNDEF) {\n\t\t\taddListener(win, \"onload\", fn);\n\t\t}\n\t\telse if (typeof win.onload == \"function\") {\n\t\t\tvar fnOld = win.onload;\n\t\t\twin.onload = function() {\n\t\t\t\tfnOld();\n\t\t\t\tfn();\n\t\t\t};\n\t\t}\n\t\telse {\n\t\t\twin.onload = fn;\n\t\t}\n\t}\n\t\n\t/* Main function\n\t\t- Will preferably execute onDomLoad, otherwise onload (as a fallback)\n\t*/\n\tfunction main() { \n\t\tif (plugin) {\n\t\t\ttestPlayerVersion();\n\t\t}\n\t\telse {\n\t\t\tmatchVersions();\n\t\t}\n\t}\n\t\n\t/* Detect the Flash Player version for non-Internet Explorer browsers\n\t\t- Detecting the plug-in version via the object element is more precise than using the plugins collection item's description:\n\t\t  a. Both release and build numbers can be detected\n\t\t  b. Avoid wrong descriptions by corrupt installers provided by Adobe\n\t\t  c. Avoid wrong descriptions by multiple Flash Player entries in the plugin Array, caused by incorrect browser imports\n\t\t- Disadvantage of this method is that it depends on the availability of the DOM, while the plugins collection is immediately available\n\t*/\n\tfunction testPlayerVersion() {\n\t\tvar b = doc.getElementsByTagName(\"body\")[0];\n\t\tvar o = createElement(OBJECT);\n\t\to.setAttribute(\"type\", FLASH_MIME_TYPE);\n\t\tvar t = b.appendChild(o);\n\t\tif (t) {\n\t\t\tvar counter = 0;\n\t\t\t(function(){\n\t\t\t\tif (typeof t.GetVariable != UNDEF) {\n\t\t\t\t\tvar d = t.GetVariable(\"$version\");\n\t\t\t\t\tif (d) {\n\t\t\t\t\t\td = d.split(\" \")[1].split(\",\");\n\t\t\t\t\t\tua.pv = [parseInt(d[0], 10), parseInt(d[1], 10), parseInt(d[2], 10)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (counter < 10) {\n\t\t\t\t\tcounter++;\n\t\t\t\t\tsetTimeout(arguments.callee, 10);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tb.removeChild(o);\n\t\t\t\tt = null;\n\t\t\t\tmatchVersions();\n\t\t\t})();\n\t\t}\n\t\telse {\n\t\t\tmatchVersions();\n\t\t}\n\t}\n\t\n\t/* Perform Flash Player and SWF version matching; static publishing only\n\t*/\n\tfunction matchVersions() {\n\t\tvar rl = regObjArr.length;\n\t\tif (rl > 0) {\n\t\t\tfor (var i = 0; i < rl; i++) { // for each registered object element\n\t\t\t\tvar id = regObjArr[i].id;\n\t\t\t\tvar cb = regObjArr[i].callbackFn;\n\t\t\t\tvar cbObj = {success:false, id:id};\n\t\t\t\tif (ua.pv[0] > 0) {\n\t\t\t\t\tvar obj = getElementById(id);\n\t\t\t\t\tif (obj) {\n\t\t\t\t\t\tif (hasPlayerVersion(regObjArr[i].swfVersion) && !(ua.wk && ua.wk < 312)) { // Flash Player version >= published SWF version: Houston, we have a match!\n\t\t\t\t\t\t\tsetVisibility(id, true);\n\t\t\t\t\t\t\tif (cb) {\n\t\t\t\t\t\t\t\tcbObj.success = true;\n\t\t\t\t\t\t\t\tcbObj.ref = getObjectById(id);\n\t\t\t\t\t\t\t\tcb(cbObj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (regObjArr[i].expressInstall && canExpressInstall()) { // show the Adobe Express Install dialog if set by the web page author and if supported\n\t\t\t\t\t\t\tvar att = {};\n\t\t\t\t\t\t\tatt.data = regObjArr[i].expressInstall;\n\t\t\t\t\t\t\tatt.width = obj.getAttribute(\"width\") || \"0\";\n\t\t\t\t\t\t\tatt.height = obj.getAttribute(\"height\") || \"0\";\n\t\t\t\t\t\t\tif (obj.getAttribute(\"class\")) { att.styleclass = obj.getAttribute(\"class\"); }\n\t\t\t\t\t\t\tif (obj.getAttribute(\"align\")) { att.align = obj.getAttribute(\"align\"); }\n\t\t\t\t\t\t\t// parse HTML object param element's name-value pairs\n\t\t\t\t\t\t\tvar par = {};\n\t\t\t\t\t\t\tvar p = obj.getElementsByTagName(\"param\");\n\t\t\t\t\t\t\tvar pl = p.length;\n\t\t\t\t\t\t\tfor (var j = 0; j < pl; j++) {\n\t\t\t\t\t\t\t\tif (p[j].getAttribute(\"name\").toLowerCase() != \"movie\") {\n\t\t\t\t\t\t\t\t\tpar[p[j].getAttribute(\"name\")] = p[j].getAttribute(\"value\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tshowExpressInstall(att, par, id, cb);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse { // Flash Player and SWF version mismatch or an older Webkit engine that ignores the HTML object element's nested param elements: display alternative content instead of SWF\n\t\t\t\t\t\t\tdisplayAltContent(obj);\n\t\t\t\t\t\t\tif (cb) { cb(cbObj); }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\t// if no Flash Player is installed or the fp version cannot be detected we let the HTML object element do its job (either show a SWF or alternative content)\n\t\t\t\t\tsetVisibility(id, true);\n\t\t\t\t\tif (cb) {\n\t\t\t\t\t\tvar o = getObjectById(id); // test whether there is an HTML object element or not\n\t\t\t\t\t\tif (o && typeof o.SetVariable != UNDEF) { \n\t\t\t\t\t\t\tcbObj.success = true;\n\t\t\t\t\t\t\tcbObj.ref = o;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcb(cbObj);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction getObjectById(objectIdStr) {\n\t\tvar r = null;\n\t\tvar o = getElementById(objectIdStr);\n\t\tif (o && o.nodeName == \"OBJECT\") {\n\t\t\tif (typeof o.SetVariable != UNDEF) {\n\t\t\t\tr = o;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar n = o.getElementsByTagName(OBJECT)[0];\n\t\t\t\tif (n) {\n\t\t\t\t\tr = n;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\t\n\t/* Requirements for Adobe Express Install\n\t\t- only one instance can be active at a time\n\t\t- fp 6.0.65 or higher\n\t\t- Win/Mac OS only\n\t\t- no Webkit engines older than version 312\n\t*/\n\tfunction canExpressInstall() {\n\t\treturn !isExpressInstallActive && hasPlayerVersion(\"6.0.65\") && (ua.win || ua.mac) && !(ua.wk && ua.wk < 312);\n\t}\n\t\n\t/* Show the Adobe Express Install dialog\n\t\t- Reference: http://www.adobe.com/cfusion/knowledgebase/index.cfm?id=6a253b75\n\t*/\n\tfunction showExpressInstall(att, par, replaceElemIdStr, callbackFn) {\n\t\tisExpressInstallActive = true;\n\t\tstoredCallbackFn = callbackFn || null;\n\t\tstoredCallbackObj = {success:false, id:replaceElemIdStr};\n\t\tvar obj = getElementById(replaceElemIdStr);\n\t\tif (obj) {\n\t\t\tif (obj.nodeName == \"OBJECT\") { // static publishing\n\t\t\t\tstoredAltContent = abstractAltContent(obj);\n\t\t\t\tstoredAltContentId = null;\n\t\t\t}\n\t\t\telse { // dynamic publishing\n\t\t\t\tstoredAltContent = obj;\n\t\t\t\tstoredAltContentId = replaceElemIdStr;\n\t\t\t}\n\t\t\tatt.id = EXPRESS_INSTALL_ID;\n\t\t\tif (typeof att.width == UNDEF || (!/%$/.test(att.width) && parseInt(att.width, 10) < 310)) { att.width = \"310\"; }\n\t\t\tif (typeof att.height == UNDEF || (!/%$/.test(att.height) && parseInt(att.height, 10) < 137)) { att.height = \"137\"; }\n\t\t\tdoc.title = doc.title.slice(0, 47) + \" - Flash Player Installation\";\n\t\t\tvar pt = ua.ie && ua.win ? \"ActiveX\" : \"PlugIn\",\n\t\t\t\tfv = \"MMredirectURL=\" + encodeURI(window.location).toString().replace(/&/g,\"%26\") + \"&MMplayerType=\" + pt + \"&MMdoctitle=\" + doc.title;\n\t\t\tif (typeof par.flashvars != UNDEF) {\n\t\t\t\tpar.flashvars += \"&\" + fv;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpar.flashvars = fv;\n\t\t\t}\n\t\t\t// IE only: when a SWF is loading (AND: not available in cache) wait for the readyState of the object element to become 4 before removing it,\n\t\t\t// because you cannot properly cancel a loading SWF file without breaking browser load references, also obj.onreadystatechange doesn't work\n\t\t\tif (ua.ie && ua.win && obj.readyState != 4) {\n\t\t\t\tvar newObj = createElement(\"div\");\n\t\t\t\treplaceElemIdStr += \"SWFObjectNew\";\n\t\t\t\tnewObj.setAttribute(\"id\", replaceElemIdStr);\n\t\t\t\tobj.parentNode.insertBefore(newObj, obj); // insert placeholder div that will be replaced by the object element that loads expressinstall.swf\n\t\t\t\tobj.style.display = \"none\";\n\t\t\t\t(function(){\n\t\t\t\t\tif (obj.readyState == 4) {\n\t\t\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsetTimeout(arguments.callee, 10);\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t}\n\t\t\tcreateSWF(att, par, replaceElemIdStr);\n\t\t}\n\t}\n\t\n\t/* Functions to abstract and display alternative content\n\t*/\n\tfunction displayAltContent(obj) {\n\t\tif (ua.ie && ua.win && obj.readyState != 4) {\n\t\t\t// IE only: when a SWF is loading (AND: not available in cache) wait for the readyState of the object element to become 4 before removing it,\n\t\t\t// because you cannot properly cancel a loading SWF file without breaking browser load references, also obj.onreadystatechange doesn't work\n\t\t\tvar el = createElement(\"div\");\n\t\t\tobj.parentNode.insertBefore(el, obj); // insert placeholder div that will be replaced by the alternative content\n\t\t\tel.parentNode.replaceChild(abstractAltContent(obj), el);\n\t\t\tobj.style.display = \"none\";\n\t\t\t(function(){\n\t\t\t\tif (obj.readyState == 4) {\n\t\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsetTimeout(arguments.callee, 10);\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\t\telse {\n\t\t\tobj.parentNode.replaceChild(abstractAltContent(obj), obj);\n\t\t}\n\t} \n\n\tfunction abstractAltContent(obj) {\n\t\tvar ac = createElement(\"div\");\n\t\tif (ua.win && ua.ie) {\n\t\t\tac.innerHTML = obj.innerHTML;\n\t\t}\n\t\telse {\n\t\t\tvar nestedObj = obj.getElementsByTagName(OBJECT)[0];\n\t\t\tif (nestedObj) {\n\t\t\t\tvar c = nestedObj.childNodes;\n\t\t\t\tif (c) {\n\t\t\t\t\tvar cl = c.length;\n\t\t\t\t\tfor (var i = 0; i < cl; i++) {\n\t\t\t\t\t\tif (!(c[i].nodeType == 1 && c[i].nodeName == \"PARAM\") && !(c[i].nodeType == 8)) {\n\t\t\t\t\t\t\tac.appendChild(c[i].cloneNode(true));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ac;\n\t}\n\t\n\t/* Cross-browser dynamic SWF creation\n\t*/\n\tfunction createSWF(attObj, parObj, id) {\n\t\tvar r, el = getElementById(id);\n\t\tif (ua.wk && ua.wk < 312) { return r; }\n\t\tif (el) {\n\t\t\tif (typeof attObj.id == UNDEF) { // if no 'id' is defined for the object element, it will inherit the 'id' from the alternative content\n\t\t\t\tattObj.id = id;\n\t\t\t}\n\t\t\tif (ua.ie && ua.win) { // Internet Explorer + the HTML object element + W3C DOM methods do not combine: fall back to outerHTML\n\t\t\t\tvar att = \"\";\n\t\t\t\tfor (var i in attObj) {\n\t\t\t\t\tif (attObj[i] != Object.prototype[i]) { // filter out prototype additions from other potential libraries\n\t\t\t\t\t\tif (i.toLowerCase() == \"data\") {\n\t\t\t\t\t\t\tparObj.movie = attObj[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (i.toLowerCase() == \"styleclass\") { // 'class' is an ECMA4 reserved keyword\n\t\t\t\t\t\t\tatt += ' class=\"' + attObj[i] + '\"';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (i.toLowerCase() != \"classid\") {\n\t\t\t\t\t\t\tatt += ' ' + i + '=\"' + attObj[i] + '\"';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar par = \"\";\n\t\t\t\tfor (var j in parObj) {\n\t\t\t\t\tif (parObj[j] != Object.prototype[j]) { // filter out prototype additions from other potential libraries\n\t\t\t\t\t\tpar += '<param name=\"' + j + '\" value=\"' + parObj[j] + '\" />';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tel.outerHTML = '<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"' + att + '>' + par + '</object>';\n\t\t\t\tobjIdArr[objIdArr.length] = attObj.id; // stored to fix object 'leaks' on unload (dynamic publishing only)\n\t\t\t\tr = getElementById(attObj.id);\t\n\t\t\t}\n\t\t\telse { // well-behaving browsers\n\t\t\t\tvar o = createElement(OBJECT);\n\t\t\t\to.setAttribute(\"type\", FLASH_MIME_TYPE);\n\t\t\t\tfor (var m in attObj) {\n\t\t\t\t\tif (attObj[m] != Object.prototype[m]) { // filter out prototype additions from other potential libraries\n\t\t\t\t\t\tif (m.toLowerCase() == \"styleclass\") { // 'class' is an ECMA4 reserved keyword\n\t\t\t\t\t\t\to.setAttribute(\"class\", attObj[m]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (m.toLowerCase() != \"classid\") { // filter out IE specific attribute\n\t\t\t\t\t\t\to.setAttribute(m, attObj[m]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var n in parObj) {\n\t\t\t\t\tif (parObj[n] != Object.prototype[n] && n.toLowerCase() != \"movie\") { // filter out prototype additions from other potential libraries and IE specific param element\n\t\t\t\t\t\tcreateObjParam(o, n, parObj[n]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tel.parentNode.replaceChild(o, el);\n\t\t\t\tr = o;\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\t\n\tfunction createObjParam(el, pName, pValue) {\n\t\tvar p = createElement(\"param\");\n\t\tp.setAttribute(\"name\", pName);\t\n\t\tp.setAttribute(\"value\", pValue);\n\t\tel.appendChild(p);\n\t}\n\t\n\t/* Cross-browser SWF removal\n\t\t- Especially needed to safely and completely remove a SWF in Internet Explorer\n\t*/\n\tfunction removeSWF(id) {\n\t\tvar obj = getElementById(id);\n\t\tif (obj && obj.nodeName == \"OBJECT\") {\n\t\t\tif (ua.ie && ua.win) {\n\t\t\t\tobj.style.display = \"none\";\n\t\t\t\t(function(){\n\t\t\t\t\tif (obj.readyState == 4) {\n\t\t\t\t\t\tremoveObjectInIE(id);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tsetTimeout(arguments.callee, 10);\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction removeObjectInIE(id) {\n\t\tvar obj = getElementById(id);\n\t\tif (obj) {\n\t\t\tfor (var i in obj) {\n\t\t\t\tif (typeof obj[i] == \"function\") {\n\t\t\t\t\tobj[i] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tobj.parentNode.removeChild(obj);\n\t\t}\n\t}\n\t\n\t/* Functions to optimize JavaScript compression\n\t*/\n\tfunction getElementById(id) {\n\t\tvar el = null;\n\t\ttry {\n\t\t\tel = doc.getElementById(id);\n\t\t}\n\t\tcatch (e) {}\n\t\treturn el;\n\t}\n\t\n\tfunction createElement(el) {\n\t\treturn doc.createElement(el);\n\t}\n\t\n\t/* Updated attachEvent function for Internet Explorer\n\t\t- Stores attachEvent information in an Array, so on unload the detachEvent functions can be called to avoid memory leaks\n\t*/\t\n\tfunction addListener(target, eventType, fn) {\n\t\ttarget.attachEvent(eventType, fn);\n\t\tlistenersArr[listenersArr.length] = [target, eventType, fn];\n\t}\n\t\n\t/* Flash Player and SWF content version matching\n\t*/\n\tfunction hasPlayerVersion(rv) {\n\t\tvar pv = ua.pv, v = rv.split(\".\");\n\t\tv[0] = parseInt(v[0], 10);\n\t\tv[1] = parseInt(v[1], 10) || 0; // supports short notation, e.g. \"9\" instead of \"9.0.0\"\n\t\tv[2] = parseInt(v[2], 10) || 0;\n\t\treturn (pv[0] > v[0] || (pv[0] == v[0] && pv[1] > v[1]) || (pv[0] == v[0] && pv[1] == v[1] && pv[2] >= v[2])) ? true : false;\n\t}\n\t\n\t/* Cross-browser dynamic CSS creation\n\t\t- Based on Bobby van der Sluis' solution: http://www.bobbyvandersluis.com/articles/dynamicCSS.php\n\t*/\t\n\tfunction createCSS(sel, decl, media, newStyle) {\n\t\tif (ua.ie && ua.mac) { return; }\n\t\tvar h = doc.getElementsByTagName(\"head\")[0];\n\t\tif (!h) { return; } // to also support badly authored HTML pages that lack a head element\n\t\tvar m = (media && typeof media == \"string\") ? media : \"screen\";\n\t\tif (newStyle) {\n\t\t\tdynamicStylesheet = null;\n\t\t\tdynamicStylesheetMedia = null;\n\t\t}\n\t\tif (!dynamicStylesheet || dynamicStylesheetMedia != m) { \n\t\t\t// create dynamic stylesheet + get a global reference to it\n\t\t\tvar s = createElement(\"style\");\n\t\t\ts.setAttribute(\"type\", \"text/css\");\n\t\t\ts.setAttribute(\"media\", m);\n\t\t\tdynamicStylesheet = h.appendChild(s);\n\t\t\tif (ua.ie && ua.win && typeof doc.styleSheets != UNDEF && doc.styleSheets.length > 0) {\n\t\t\t\tdynamicStylesheet = doc.styleSheets[doc.styleSheets.length - 1];\n\t\t\t}\n\t\t\tdynamicStylesheetMedia = m;\n\t\t}\n\t\t// add style rule\n\t\tif (ua.ie && ua.win) {\n\t\t\tif (dynamicStylesheet && typeof dynamicStylesheet.addRule == OBJECT) {\n\t\t\t\tdynamicStylesheet.addRule(sel, decl);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (dynamicStylesheet && typeof doc.createTextNode != UNDEF) {\n\t\t\t\tdynamicStylesheet.appendChild(doc.createTextNode(sel + \" {\" + decl + \"}\"));\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction setVisibility(id, isVisible) {\n\t\tif (!autoHideShow) { return; }\n\t\tvar v = isVisible ? \"visible\" : \"hidden\";\n\t\tif (isDomLoaded && getElementById(id)) {\n\t\t\tgetElementById(id).style.visibility = v;\n\t\t}\n\t\telse {\n\t\t\tcreateCSS(\"#\" + id, \"visibility:\" + v);\n\t\t}\n\t}\n\n\t/* Filter to avoid XSS attacks\n\t*/\n\tfunction urlEncodeIfNecessary(s) {\n\t\tvar regex = /[\\\\\\\"<>\\.;]/;\n\t\tvar hasBadChars = regex.exec(s) != null;\n\t\treturn hasBadChars && typeof encodeURIComponent != UNDEF ? encodeURIComponent(s) : s;\n\t}\n\t\n\t/* Release memory to avoid memory leaks caused by closures, fix hanging audio/video threads and force open sockets/NetConnections to disconnect (Internet Explorer only)\n\t*/\n\tvar cleanup = function() {\n\t\tif (ua.ie && ua.win) {\n\t\t\twindow.attachEvent(\"onunload\", function() {\n\t\t\t\t// remove listeners to avoid memory leaks\n\t\t\t\tvar ll = listenersArr.length;\n\t\t\t\tfor (var i = 0; i < ll; i++) {\n\t\t\t\t\tlistenersArr[i][0].detachEvent(listenersArr[i][1], listenersArr[i][2]);\n\t\t\t\t}\n\t\t\t\t// cleanup dynamically embedded objects to fix audio/video threads and force open sockets and NetConnections to disconnect\n\t\t\t\tvar il = objIdArr.length;\n\t\t\t\tfor (var j = 0; j < il; j++) {\n\t\t\t\t\tremoveSWF(objIdArr[j]);\n\t\t\t\t}\n\t\t\t\t// cleanup library's main closures to avoid memory leaks\n\t\t\t\tfor (var k in ua) {\n\t\t\t\t\tua[k] = null;\n\t\t\t\t}\n\t\t\t\tua = null;\n\t\t\t\tfor (var l in swfobject) {\n\t\t\t\t\tswfobject[l] = null;\n\t\t\t\t}\n\t\t\t\tswfobject = null;\n\t\t\t});\n\t\t}\n\t}();\n\t\n\treturn {\n\t\t/* Public API\n\t\t\t- Reference: http://code.google.com/p/swfobject/wiki/documentation\n\t\t*/ \n\t\tregisterObject: function(objectIdStr, swfVersionStr, xiSwfUrlStr, callbackFn) {\n\t\t\tif (ua.w3 && objectIdStr && swfVersionStr) {\n\t\t\t\tvar regObj = {};\n\t\t\t\tregObj.id = objectIdStr;\n\t\t\t\tregObj.swfVersion = swfVersionStr;\n\t\t\t\tregObj.expressInstall = xiSwfUrlStr;\n\t\t\t\tregObj.callbackFn = callbackFn;\n\t\t\t\tregObjArr[regObjArr.length] = regObj;\n\t\t\t\tsetVisibility(objectIdStr, false);\n\t\t\t}\n\t\t\telse if (callbackFn) {\n\t\t\t\tcallbackFn({success:false, id:objectIdStr});\n\t\t\t}\n\t\t},\n\t\t\n\t\tgetObjectById: function(objectIdStr) {\n\t\t\tif (ua.w3) {\n\t\t\t\treturn getObjectById(objectIdStr);\n\t\t\t}\n\t\t},\n\t\t\n\t\tembedSWF: function(swfUrlStr, replaceElemIdStr, widthStr, heightStr, swfVersionStr, xiSwfUrlStr, flashvarsObj, parObj, attObj, callbackFn) {\n\t\t\tvar callbackObj = {success:false, id:replaceElemIdStr};\n\t\t\tif (ua.w3 && !(ua.wk && ua.wk < 312) && swfUrlStr && replaceElemIdStr && widthStr && heightStr && swfVersionStr) {\n\t\t\t\tsetVisibility(replaceElemIdStr, false);\n\t\t\t\taddDomLoadEvent(function() {\n\t\t\t\t\twidthStr += \"\"; // auto-convert to string\n\t\t\t\t\theightStr += \"\";\n\t\t\t\t\tvar att = {};\n\t\t\t\t\tif (attObj && typeof attObj === OBJECT) {\n\t\t\t\t\t\tfor (var i in attObj) { // copy object to avoid the use of references, because web authors often reuse attObj for multiple SWFs\n\t\t\t\t\t\t\tatt[i] = attObj[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tatt.data = swfUrlStr;\n\t\t\t\t\tatt.width = widthStr;\n\t\t\t\t\tatt.height = heightStr;\n\t\t\t\t\tvar par = {}; \n\t\t\t\t\tif (parObj && typeof parObj === OBJECT) {\n\t\t\t\t\t\tfor (var j in parObj) { // copy object to avoid the use of references, because web authors often reuse parObj for multiple SWFs\n\t\t\t\t\t\t\tpar[j] = parObj[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (flashvarsObj && typeof flashvarsObj === OBJECT) {\n\t\t\t\t\t\tfor (var k in flashvarsObj) { // copy object to avoid the use of references, because web authors often reuse flashvarsObj for multiple SWFs\n\t\t\t\t\t\t\tif (typeof par.flashvars != UNDEF) {\n\t\t\t\t\t\t\t\tpar.flashvars += \"&\" + k + \"=\" + flashvarsObj[k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tpar.flashvars = k + \"=\" + flashvarsObj[k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (hasPlayerVersion(swfVersionStr)) { // create SWF\n\t\t\t\t\t\tvar obj = createSWF(att, par, replaceElemIdStr);\n\t\t\t\t\t\tif (att.id == replaceElemIdStr) {\n\t\t\t\t\t\t\tsetVisibility(replaceElemIdStr, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcallbackObj.success = true;\n\t\t\t\t\t\tcallbackObj.ref = obj;\n\t\t\t\t\t}\n\t\t\t\t\telse if (xiSwfUrlStr && canExpressInstall()) { // show Adobe Express Install\n\t\t\t\t\t\tatt.data = xiSwfUrlStr;\n\t\t\t\t\t\tshowExpressInstall(att, par, replaceElemIdStr, callbackFn);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\telse { // show alternative content\n\t\t\t\t\t\tsetVisibility(replaceElemIdStr, true);\n\t\t\t\t\t}\n\t\t\t\t\tif (callbackFn) { callbackFn(callbackObj); }\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (callbackFn) { callbackFn(callbackObj);\t}\n\t\t},\n\t\t\n\t\tswitchOffAutoHideShow: function() {\n\t\t\tautoHideShow = false;\n\t\t},\n\t\t\n\t\tua: ua,\n\t\t\n\t\tgetFlashPlayerVersion: function() {\n\t\t\treturn { major:ua.pv[0], minor:ua.pv[1], release:ua.pv[2] };\n\t\t},\n\t\t\n\t\thasFlashPlayerVersion: hasPlayerVersion,\n\t\t\n\t\tcreateSWF: function(attObj, parObj, replaceElemIdStr) {\n\t\t\tif (ua.w3) {\n\t\t\t\treturn createSWF(attObj, parObj, replaceElemIdStr);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t},\n\t\t\n\t\tshowExpressInstall: function(att, par, replaceElemIdStr, callbackFn) {\n\t\t\tif (ua.w3 && canExpressInstall()) {\n\t\t\t\tshowExpressInstall(att, par, replaceElemIdStr, callbackFn);\n\t\t\t}\n\t\t},\n\t\t\n\t\tremoveSWF: function(objElemIdStr) {\n\t\t\tif (ua.w3) {\n\t\t\t\tremoveSWF(objElemIdStr);\n\t\t\t}\n\t\t},\n\t\t\n\t\tcreateCSS: function(selStr, declStr, mediaStr, newStyleBoolean) {\n\t\t\tif (ua.w3) {\n\t\t\t\tcreateCSS(selStr, declStr, mediaStr, newStyleBoolean);\n\t\t\t}\n\t\t},\n\t\t\n\t\taddDomLoadEvent: addDomLoadEvent,\n\t\t\n\t\taddLoadEvent: addLoadEvent,\n\t\t\n\t\tgetQueryParamValue: function(param) {\n\t\t\tvar q = doc.location.search || doc.location.hash;\n\t\t\tif (q) {\n\t\t\t\tif (/\\?/.test(q)) { q = q.split(\"?\")[1]; } // strip question mark\n\t\t\t\tif (param == null) {\n\t\t\t\t\treturn urlEncodeIfNecessary(q);\n\t\t\t\t}\n\t\t\t\tvar pairs = q.split(\"&\");\n\t\t\t\tfor (var i = 0; i < pairs.length; i++) {\n\t\t\t\t\tif (pairs[i].substring(0, pairs[i].indexOf(\"=\")) == param) {\n\t\t\t\t\t\treturn urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf(\"=\") + 1)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\t\n\t\t// For internal usage only\n\t\texpressInstallCallback: function() {\n\t\t\tif (isExpressInstallActive) {\n\t\t\t\tvar obj = getElementById(EXPRESS_INSTALL_ID);\n\t\t\t\tif (obj && storedAltContent) {\n\t\t\t\t\tobj.parentNode.replaceChild(storedAltContent, obj);\n\t\t\t\t\tif (storedAltContentId) {\n\t\t\t\t\t\tsetVisibility(storedAltContentId, true);\n\t\t\t\t\t\tif (ua.ie && ua.win) { storedAltContent.style.display = \"block\"; }\n\t\t\t\t\t}\n\t\t\t\t\tif (storedCallbackFn) { storedCallbackFn(storedCallbackObj); }\n\t\t\t\t}\n\t\t\t\tisExpressInstallActive = false;\n\t\t\t} \n\t\t}\n\t};\n}();\n\nmodule.exports = swfobject;",
    "class CSS\n{\n\tpublic static setElementSize(element:HTMLElement, width:number, height:number)\n\t{\n\t\telement.style.width = width + \"px\";\n\t\telement.style.height = height + \"px\";\n\t\telement[\"width\"] = width;\n\t\telement[\"height\"] = height;\n\t}\n\n\tpublic static setElementWidth(element:HTMLElement, width:number)\n\t{\n\t\telement.style.width = width + \"px\";\n\t\telement[\"width\"] = width;\n\t}\n\n\tpublic static setElementHeight(element:HTMLElement, height:number)\n\t{\n\t\telement.style.height = height + \"px\";\n\t\telement[\"height\"] = height;\n\t}\n\n\tpublic static setElementX(element:HTMLElement, x:number)\n\t{\n\t\telement.style.position = 'absolute';\n\t\telement.style.left = x + \"px\";\n\t}\n\n\tpublic static setElementY(element:HTMLElement, y:number)\n\t{\n\t\telement.style.position = 'absolute';\n\t\telement.style.top = y + \"px\";\n\t}\n\n\tpublic static getElementVisibility(element:HTMLElement):boolean\n\t{\n\t\treturn element.style.visibility == 'visible';\n\t}\n\n\tpublic static setElementVisibility(element:HTMLElement, visible:boolean)\n\t{\n\t\tif (visible) {\n\t\t\telement.style.visibility = 'visible';\n\t\t} else {\n\t\t\telement.style.visibility = 'hidden';\n\t\t}\n\t}\n\n\tpublic static setElementAlpha(element:HTMLElement, alpha:number)\n\t{\n\t\tif (element instanceof HTMLCanvasElement) {\n\t\t\tvar context = (<HTMLCanvasElement> element).getContext(\"2d\");\n\t\t\tcontext.globalAlpha = alpha;\n\t\t}\n\t}\n\n\tpublic static setElementPosition(element:HTMLElement, x:number, y:number, absolute:boolean = false)\n\t{\n\t\tif (absolute) {\n\t\t\telement.style.position = \"absolute\";\n\t\t} else {\n\t\t\telement.style.position = \"relative\";\n\t\t}\n\n\t\telement.style.left = x + \"px\";\n\t\telement.style.top = y + \"px\";\n\t}\n}\n\nexport = CSS;",
    "class ContextMode\n{\n\tstatic AUTO:string = \"auto\";\n\tstatic WEBGL:string = \"webgl\";\n\tstatic FLASH:string = \"flash\";\n\tstatic NATIVE:string = \"native\";\n}\n\nexport = ContextMode;"
  ],
  "sourceRoot": ""
}
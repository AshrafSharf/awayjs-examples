require=function t(e,i,r){function a(n,o){if(!i[n]){if(!e[n]){var h=typeof require=="function"&&require;if(!o&&h)return h(n,!0);if(s)return s(n,!0);var u=new Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[n]={exports:{}};e[n][0].call(c.exports,function(t){var i=e[n][1][t];return a(i?i:t)},c,c.exports,t,e,i,r)}return i[n].exports}var s=typeof require=="function"&&require;for(var n=0;n<r.length;n++)a(r[n]);return a}({"awayjs-core/lib/attributes/AttributesBuffer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetBase");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=0}if(i===void 0){i=0}t.call(this);this._attributesBufferVO=new Array;this._count=0;this._stride=0;this._newStride=0;this._viewVOs=new Array;this._stride=this._newStride=e;this._count=i;this._buffer=new ArrayBuffer(this._stride*this._count);this._bufferView=new Uint8Array(this._buffer,0,this._buffer.byteLength)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"stride",{get:function(){if(this._lengthDirty)this._updateLength();return this._stride},set:function(t){if(this._newStride==t)return;this._newStride=t;this.invalidateLength()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"count",{get:function(){return this._count},set:function(t){if(this._count==t)return;this._count=t;this.invalidateLength()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"buffer",{get:function(){if(this._lengthDirty)this._updateLength();this._contentDirty=false;return this._buffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bufferView",{get:function(){if(this._lengthDirty)this._updateLength();this._contentDirty=false;return this._bufferView},set:function(t){this._bufferView=t;this._buffer=this._bufferView.buffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._count*this.stride},enumerable:true,configurable:true});e.prototype.invalidateContent=function(){if(this._contentDirty)return;var t=this._attributesBufferVO.length;for(var e=0;e<t;e++)this._attributesBufferVO[e].invalidate();this._contentDirty=true};e.prototype.invalidateLength=function(){if(this._lengthDirty)return;while(this._attributesBufferVO.length)this._attributesBufferVO[0].dispose();this._lengthDirty=true};e.prototype.clone=function(){var t=new e(this._stride,this._count);t.bufferView.set(this.bufferView);var i=this._viewVOs.length;for(var r=0;r<i;r++)this._viewVOs[r].view._internalClone(t);return t};e.prototype.getView=function(t){if(t<this._viewVOs.length)return this._viewVOs[t].view;return null};e.prototype.dispose=function(){while(this._attributesBufferVO.length)this._attributesBufferVO[0].dispose()};e.prototype._setAttributes=function(t,e,i){if(i===void 0){i=0}var r=e instanceof Uint8Array?e:new Uint8Array(e.buffer);var a=this._viewVOs[t];var s=a.length;var n=a.offset;var o=r.length/s;if(this.count<o+i)this.count=o+i;if(this._lengthDirty)this._updateLength();if(this._viewVOs.length==1){this._bufferView.set(r)}else{for(var h=0;h<o;h++)this._bufferView.set(r.subarray(h*s,(h+1)*s),(h+i)*this._stride+n)}this.invalidateContent()};e.prototype._getLocalArrayBuffer=function(t){var e=this._viewVOs[t];var i=e.length;var r=e.offset;if(this._lengthDirty)this._updateLength();if(this._viewVOs.length==1)return this._buffer;var a=new ArrayBuffer(this._count*i);var s=new Uint8Array(a);for(var n=0;n<this._count;n++)s.set(this._bufferView.subarray(n*this._stride+r,n*this._stride+r+i),n*i);return a};e.prototype._iAddAttributesBufferVO=function(t){this._attributesBufferVO.push(t);return t};e.prototype._iRemoveAttributesBufferVO=function(t){this._attributesBufferVO.splice(this._attributesBufferVO.indexOf(t),1);return t};e.prototype._addView=function(t){var e=new n(t);var i=this._viewVOs.length;e.offset=i?this._viewVOs[i-1].offset+this._viewVOs[i-1].length:0;this._viewVOs.push(e);if(this._newStride<e.offset+e.length){this._newStride=e.offset+e.length;this.invalidateLength()}t._index=i};e.prototype._removeView=function(t){var e=t._index;var i=this._viewVOs.splice(e,1)[0];var r=this._viewVOs.length;i.dispose();for(var a=e;a<r;a++){i=this._viewVOs[a];i.offset=a?this._viewVOs[a-1].offset+this._viewVOs[a-1].length:0;i.view._index=a}this._newStride=i.offset+i.length;this.invalidateLength()};e.prototype._getOffset=function(t){return this._viewVOs[t].offset};e.prototype._updateLength=function(){this._lengthDirty=false;var t;var e;var i=this._viewVOs.length;var r=this._newStride*this._count;if(!this._buffer||this._buffer.byteLength!=r){var a=new ArrayBuffer(r);var s=new Uint8Array(a,0,a.byteLength);var n;var o;var h;var u;if(this._stride!=this._newStride){for(t=0;t<i;t++){n=this._viewVOs[t];o=n.length;h=n.offset;u=n.oldOffset;for(e=0;e<this._count;e++)if(u!=null)s.set(new Uint8Array(this._buffer,e*this._stride+u,o),e*this._newStride+h);n.oldOffset=n.offset}this._stride=this._newStride}else{s.set(new Uint8Array(this._buffer,0,Math.min(r,this._buffer.byteLength)))}this._buffer=a;this._bufferView=s}};e.assetType="[assets AttributesBuffer]";return e}(a);var n=function(){function t(t){this.view=t;this.length=t.size*t.dimensions}t.prototype.dispose=function(){this.view=null};t.prototype.clone=function(){return new t(this.view)};return t}();e.exports=s},{"awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase"}],"awayjs-core/lib/attributes/AttributesView":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesBuffer");var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=0}t.call(this);this._arrayClass=e;this._size=e.BYTES_PER_ELEMENT;this._dimensions=i;this._attributesBuffer=r instanceof a?r:new a(this._dimensions*this._size,r);this._attributesBuffer._addView(this)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"buffer",{get:function(){return this._attributesBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){if(this._size==t)return;this._size=t;this._attributesBuffer._removeView(this);this._attributesBuffer._addView(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dimensions",{get:function(){return this._dimensions},set:function(t){if(this._dimensions==t)return;this._dimensions=t;this._attributesBuffer._removeView(this);this._attributesBuffer._addView(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"count",{get:function(){return this._attributesBuffer.count},set:function(t){this._attributesBuffer.count=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset",{get:function(){return this._attributesBuffer._getOffset(this._index)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._attributesBuffer.count*this._dimensions},enumerable:true,configurable:true});e.prototype.set=function(t,e){if(e===void 0){e=0}this._attributesBuffer._setAttributes(this._index,t instanceof Array?new this._arrayClass(t):t,e);this._localArrayBuffer=null};e.prototype.get=function(t,e){if(e===void 0){e=0}if(!this._localArrayBuffer)this._localArrayBuffer=this._attributesBuffer._getLocalArrayBuffer(this._index);var i=this._dimensions*this._size;return new this._arrayClass(this._localArrayBuffer,e*i,t*this._dimensions)};e.prototype._internalClone=function(t){return this._cloneCache=new e(this._arrayClass,this._dimensions,t)};e.prototype.clone=function(t){if(t===void 0){t=null}if(t)this._internalClone(t);if(!this._cloneCache)this._attributesBuffer.clone();var e=this._cloneCache;this._cloneCache=null;return e};e.prototype.dispose=function(){this._attributesBuffer._removeView(this);this._attributesBuffer=null};e.assetType="[attributes AttributesView]";return e}(s);e.exports=n},{"awayjs-core/lib/attributes/AttributesBuffer":"awayjs-core/lib/attributes/AttributesBuffer","awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase"}],"awayjs-core/lib/attributes/Byte4Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=true}t.call(this,i?Uint8Array:Int8Array,4,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint8Array)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Byte4Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Float1Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e){t.call(this,Float32Array,1,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Float1Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Float2Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e){t.call(this,Float32Array,2,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Float2Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Float3Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e){t.call(this,Float32Array,3,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Float3Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Float4Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e){t.call(this,Float32Array,4,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Float4Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Short2Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=true}t.call(this,i?Uint16Array:Int16Array,2,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint16Array)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Short2Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/attributes/Short3Attributes":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/attributes/AttributesView");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=true}t.call(this,i?Uint16Array:Int16Array,3,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.set=function(e,i){if(i===void 0){i=0}t.prototype.set.call(this,e,i)};e.prototype.get=function(e,i){if(i===void 0){i=0}return t.prototype.get.call(this,e,i)};e.prototype._internalClone=function(t){return this._cloneCache=new e(t,this._arrayClass==Uint16Array)};e.prototype.clone=function(e){if(e===void 0){e=null}return t.prototype.clone.call(this,e)};e.assetType="[attributes Short3Attributes]";return e}(a);e.exports=s},{"awayjs-core/lib/attributes/AttributesView":"awayjs-core/lib/attributes/AttributesView"}],"awayjs-core/lib/data/BitmapImage2D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/Image2D");var s=t("awayjs-core/lib/utils/ColorUtils");var n=t("awayjs-core/lib/utils/BitmapImageUtils");var o=function(t){r(e,t);function e(e,i,r,a,s){if(r===void 0){r=true}if(a===void 0){a=null}if(s===void 0){s=true}t.call(this,e,i,s);this._locked=false;this._transparent=r;this._imageCanvas=document.createElement("canvas");this._imageCanvas.width=e;this._imageCanvas.height=i;this._context=this._imageCanvas.getContext("2d");if(a!=null)this.fillRect(this._rect,a)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"transparent",{get:function(){return this._transparent},set:function(t){this._transparent=t},enumerable:true,configurable:true});e.prototype.clone=function(){var t=new e(this.width,this.height,this.transparent);t.draw(this);return t};e.prototype.colorTransform=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);var i=this._imageData.data;var r,a,s;for(r=0;r<t.width;++r){for(a=0;a<t.height;++a){s=(r+t.x+(a+t.y)*this.width)*4;i[s]=i[s]*e.redMultiplier+e.redOffset;i[s+1]=i[s+1]*e.greenMultiplier+e.greenOffset;i[s+2]=i[s+2]*e.blueMultiplier+e.blueOffset;i[s+3]=i[s+3]*e.alphaMultiplier+e.alphaOffset}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.copyChannel=function(t,e,i,r,a){var s=t.getImageData();if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);var n=t.getImageData().data;var o=this._imageData.data;var h=Math.round(Math.log(r)/Math.log(2));var u=Math.round(Math.log(a)/Math.log(2));var c,p,l,f;for(c=0;c<e.width;++c){for(p=0;p<e.height;++p){l=(c+e.x+(p+e.y)*t.width)*4;f=(c+i.x+(p+i.y)*this.width)*4;o[f+u]=n[l+h]}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.copyPixels=function(t,i,r){if(t instanceof e)t=t.getCanvas();if(this._locked){this._context.putImageData(this._imageData,0,0);n._copyPixels(this._context,t,i,r);this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}else{n._copyPixels(this._context,t,i,r)}this.invalidateContent()};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._context=null;this._imageCanvas=null;this._imageData=null;this._rect=null;this._transparent=null;this._locked=null};e.prototype.draw=function(t,i,r,a,s,o){if(t instanceof e)t=t.getCanvas();if(this._locked){this._context.putImageData(this._imageData,0,0);n._draw(this._context,t,i,r,a,s,o);this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}else{n._draw(this._context,t,i,r,a,s,o)}this.invalidateContent()};e.prototype.fillRect=function(t,e){if(this._locked){if(this._imageData)this._context.putImageData(this._imageData,0,0);n._fillRect(this._context,t,e,this._transparent);if(this._imageData)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)}else{n._fillRect(this._context,t,e,this._transparent)}this.invalidateContent()};e.prototype.getPixel=function(t,e){var i;var r;var a;var s;if(!this._locked){var n=this._context.getImageData(t,e,1,1);i=n.data[0];r=n.data[1];a=n.data[2];s=n.data[3]}else{var o=(t+e*this._imageCanvas.width)*4;i=this._imageData.data[o+0];r=this._imageData.data[o+1];a=this._imageData.data[o+2];s=this._imageData.data[o+3]}if(!s)return 0;return i<<16|r<<8|a};e.prototype.getPixel32=function(t,e){var i;var r;var a;var s;if(!this._locked){var n=this._context.getImageData(t,e,1,1);i=n.data[0];r=n.data[1];a=n.data[2];s=n.data[3]}else{var o=(t+e*this._imageCanvas.width)*4;i=this._imageData.data[o+0];r=this._imageData.data[o+1];a=this._imageData.data[o+2];s=this._imageData.data[o+3]}return s<<24|i<<16|r<<8|a};e.prototype.lock=function(){if(this._locked)return;this._locked=true;this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)};e.prototype.setArray=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);var i,r,a,n;for(i=0;i<t.width;++i){for(r=0;r<t.height;++r){n=s.float32ColorToARGB(e[i+r*t.width]);a=(i+t.x+(r+t.y)*this._imageCanvas.width)*4;this._imageData.data[a+0]=n[1];this._imageData.data[a+1]=n[2];this._imageData.data[a+2]=n[3];this._imageData.data[a+3]=n[0]}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.setPixel=function(t,e,i){var r=s.float32ColorToARGB(i);if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);var a=(t+e*this._imageCanvas.width)*4;this._imageData.data[a+0]=r[1];this._imageData.data[a+1]=r[2];this._imageData.data[a+2]=r[3];this._imageData.data[a+3]=255;if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.setPixel32=function(t,e,i){var r=s.float32ColorToARGB(i);if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);var a=(t+e*this._imageCanvas.width)*4;this._imageData.data[a+0]=r[1];this._imageData.data[a+1]=r[2];this._imageData.data[a+2]=r[3];this._imageData.data[a+3]=r[0];if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.setPixels=function(t,e){if(!this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height);e.position=0;var i,r,a;for(i=0;i<t.width;++i){for(r=0;r<t.height;++r){a=(i+t.x+(r+t.y)*this._imageCanvas.width)*4;this._imageData.data[a+0]=e.readUnsignedInt();this._imageData.data[a+1]=e.readUnsignedInt();this._imageData.data[a+2]=e.readUnsignedInt();this._imageData.data[a+3]=e.readUnsignedInt()}}if(!this._locked){this._context.putImageData(this._imageData,0,0);this._imageData=null}this.invalidateContent()};e.prototype.unlock=function(){if(!this._locked)return;this._locked=false;this._context.putImageData(this._imageData,0,0);this._imageData=null};e.prototype.getImageData=function(){if(!this._locked)return this._context.getImageData(0,0,this._rect.width,this._rect.height);return this._imageData};e.prototype.getCanvas=function(){return this._imageCanvas};e.prototype._setSize=function(e,i){if(this._locked)this._context.putImageData(this._imageData,0,0);this._imageCanvas.width=e;this._imageCanvas.height=i;t.prototype._setSize.call(this,e,i);if(this._locked)this._imageData=this._context.getImageData(0,0,this._rect.width,this._rect.height)};e.assetType="[image BitmapImage2D]";return e}(a);e.exports=o},{"awayjs-core/lib/data/Image2D":"awayjs-core/lib/data/Image2D","awayjs-core/lib/utils/BitmapImageUtils":"awayjs-core/lib/utils/BitmapImageUtils","awayjs-core/lib/utils/ColorUtils":"awayjs-core/lib/utils/ColorUtils"}],"awayjs-core/lib/data/BitmapImageChannel":[function(t,e,i){var r=function(){function t(){}t.ALPHA=8;t.BLUE=4;t.GREEN=2;t.RED=1;return t}();e.exports=r},{}],"awayjs-core/lib/data/BitmapImageCube":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/BitmapImage2D");var s=t("awayjs-core/lib/data/ImageCube");var n=t("awayjs-core/lib/geom/Rectangle");var o=t("awayjs-core/lib/utils/ColorUtils");var h=t("awayjs-core/lib/utils/BitmapImageUtils");var u=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=true}if(r===void 0){r=null}t.call(this,e);this._imageCanvas=new Array(6);this._context=new Array(6);this._imageData=new Array(6);this._locked=false;this._transparent=i;for(var a=0;a<6;a++){this._imageCanvas[a]=document.createElement("canvas");this._imageCanvas[a].width=e;this._imageCanvas[a].height=e;this._context[a]=this._imageCanvas[a].getContext("2d");if(r!=null)this.fillRect(a,new n(0,0,e,e),r)}}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"transparent",{get:function(){return this._transparent},set:function(t){this._transparent=t},enumerable:true,configurable:true});e.prototype.clone=function(){var t=new e(this._size,this.transparent);for(var i=0;i<6;i++){t.draw(i,this.getCanvas(i))}return t};e.prototype.colorTransform=function(t,e,i){if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);var r=this._imageData[t].data;var a,s,n;for(a=0;a<e.width;++a){for(s=0;s<e.height;++s){n=(a+e.x+(s+e.y)*this._size)*4;r[n]=r[n]*i.redMultiplier+i.redOffset;r[n+1]=r[n+1]*i.greenMultiplier+i.greenOffset;r[n+2]=r[n+2]*i.blueMultiplier+i.blueOffset;r[n+3]=r[n+3]*i.alphaMultiplier+i.alphaOffset}}if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}this.invalidateContent()};e.prototype.copyChannel=function(t,e,i,r,a,s){var n=e.getImageData();if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);var o=e.getImageData().data;var h=this._imageData[t].data;var u=Math.round(Math.log(a)/Math.log(2));var c=Math.round(Math.log(s)/Math.log(2));var p,l,f,y;for(p=0;p<i.width;++p){for(l=0;l<i.height;++l){f=(p+i.x+(l+i.y)*e.width)*4;y=(p+r.x+(l+r.y)*this._size)*4;h[y+c]=o[f+u]}}if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}this.invalidateContent()};e.prototype.copyPixels=function(t,e,i,r){if(e instanceof a)e=e.getCanvas();if(this._locked){this._context[t].putImageData(this._imageData[t],0,0);h._copyPixels(this._context[t],e,i,r);this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size)}else{h._copyPixels(this._context[t],e,i,r)}this.invalidateContent()};e.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0;e<6;e++){this._context[e]=null;this._imageCanvas[e]=null;this._imageData[e]=null}this._transparent=null;this._locked=null};e.prototype.draw=function(t,e,i,r,s,n,o){if(e instanceof a)e=e.getCanvas();if(this._locked){this._context[t].putImageData(this._imageData[t],0,0);h._draw(this._context[t],e,i,r,s,n,o);this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size)}else{h._draw(this._context[t],e,i,r,s,n,o)}this.invalidateContent()};e.prototype.fillRect=function(t,e,i){if(this._locked){if(this._imageData[t])this._context[t].putImageData(this._imageData[t],0,0);h._fillRect(this._context[t],e,i,this._transparent);if(this._imageData[t])this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size)}else{h._fillRect(this._context[t],e,i,this._transparent)}this.invalidateContent()};e.prototype.getPixel=function(t,e,i){var r;var a;var s;var n;if(!this._locked){var o=this._context[t].getImageData(e,i,1,1);r=o.data[0];a=o.data[1];s=o.data[2];n=o.data[3]}else{var h=(e+i*this._size)*4;r=this._imageData[t].data[h+0];a=this._imageData[t].data[h+1];s=this._imageData[t].data[h+2];n=this._imageData[t].data[h+3]}if(!n)return 0;return r<<16|a<<8|s};e.prototype.getPixel32=function(t,e,i){var r;var a;var s;var n;if(!this._locked){var o=this._context[t].getImageData(e,i,1,1);r=o.data[0];a=o.data[1];s=o.data[2];n=o.data[3]}else{var h=(e+i*this._size)*4;r=this._imageData[t].data[h+0];a=this._imageData[t].data[h+1];s=this._imageData[t].data[h+2];n=this._imageData[t].data[h+3]}return n<<24|r<<16|a<<8|s};e.prototype.lock=function(){if(this._locked)return;this._locked=true;for(var t=0;t<6;t++)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size)};e.prototype.setArray=function(t,e,i){if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);var r,a,s,n;for(r=0;r<e.width;++r){for(a=0;a<e.height;++a){n=o.float32ColorToARGB(i[r+a*e.width]);s=(r+e.x+(a+e.y)*this._size)*4;this._imageData[t].data[s+0]=n[1];this._imageData[t].data[s+1]=n[2];this._imageData[t].data[s+2]=n[3];this._imageData[t].data[s+3]=n[0]}}if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}this.invalidateContent()};e.prototype.setPixel=function(t,e,i,r){var a=o.float32ColorToARGB(r);if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);var s=(e+i*this._size)*4;this._imageData[t].data[s+0]=a[1];this._imageData[t].data[s+1]=a[2];this._imageData[t].data[s+2]=a[3];this._imageData[t].data[s+3]=255;if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData=null}this.invalidateContent()};e.prototype.setPixel32=function(t,e,i,r){var a=o.float32ColorToARGB(r);if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);var s=(e+i*this._size)*4;this._imageData[t].data[s+0]=a[1];this._imageData[t].data[s+1]=a[2];this._imageData[t].data[s+2]=a[3];this._imageData[t].data[s+3]=a[0];if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}this.invalidateContent()};e.prototype.setPixels=function(t,e,i){if(!this._locked)this._imageData[t]=this._context[t].getImageData(0,0,this._size,this._size);i.position=0;var r,a,s;for(r=0;r<e.width;++r){for(a=0;a<e.height;++a){s=(r+e.x+(a+e.y)*this._size)*4;this._imageData[t].data[s+0]=i.readUnsignedInt();this._imageData[t].data[s+1]=i.readUnsignedInt();this._imageData[t].data[s+2]=i.readUnsignedInt();this._imageData[t].data[s+3]=i.readUnsignedInt()}}if(!this._locked){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}this.invalidateContent()};e.prototype.unlock=function(){if(!this._locked)return;this._locked=false;for(var t=0;t<6;t++){this._context[t].putImageData(this._imageData[t],0,0);this._imageData[t]=null}};e.prototype.getImageData=function(t){if(!this._locked)return this._context[t].getImageData(0,0,this._size,this._size);return this._imageData[t]};e.prototype.getCanvas=function(t){return this._imageCanvas[t]};e.prototype._setSize=function(e){t.prototype._setSize.call(this,e);for(var i=0;i<6;i++){if(this._locked)this._context[i].putImageData(this._imageData[i],0,0);this._imageCanvas[i].width=e;this._imageCanvas[i].height=e;if(this._locked)this._imageData[i]=this._context[i].getImageData(0,0,this._size,this._size)}};e.assetType="[image BitmapImageCube]";e.posX=0;e.negX=1;e.posY=2;e.negY=3;e.posZ=4;e.negZ=5;return e}(s);e.exports=u},{"awayjs-core/lib/data/BitmapImage2D":"awayjs-core/lib/data/BitmapImage2D","awayjs-core/lib/data/ImageCube":"awayjs-core/lib/data/ImageCube","awayjs-core/lib/geom/Rectangle":"awayjs-core/lib/geom/Rectangle","awayjs-core/lib/utils/BitmapImageUtils":"awayjs-core/lib/utils/BitmapImageUtils","awayjs-core/lib/utils/ColorUtils":"awayjs-core/lib/utils/ColorUtils"}],"awayjs-core/lib/data/BlendMode":[function(t,e,i){var r=function(){function t(){}t.ADD="add";t.ALPHA="alpha";t.DARKEN="darken";t.DIFFERENCE="difference";t.ERASE="erase";t.HARDLIGHT="hardlight";t.INVERT="invert";t.LAYER="layer";t.LIGHTEN="lighten";t.MULTIPLY="multiply";t.NORMAL="normal";t.OVERLAY="overlay";t.SCREEN="screen";t.SHADER="shader";t.SUBTRACT="subtract";return t}();e.exports=r},{}],"awayjs-core/lib/data/Image2D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/ImageBase");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/utils/ImageUtils");var o=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=true}t.call(this);this._powerOfTwo=true;this._rect=new s(0,0,e,i);this._powerOfTwo=r;this._testDimensions()}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._rect.height},set:function(t){if(this._rect.height==t)return;this._setSize(this._rect.width,t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rect",{get:function(){return this._rect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._rect.width},set:function(t){if(this._rect.width==t)return;this._setSize(t,this._rect.height)},enumerable:true,configurable:true});e.prototype._setSize=function(t,e){if(this._rect.width!=t||this._rect.height!=e)this.invalidateSize();this._rect.width=t;this._rect.height=e;this._testDimensions()
};e.prototype._testDimensions=function(){if(this._powerOfTwo&&(!n.isDimensionValid(this._rect.width)||!n.isDimensionValid(this._rect.height)))throw new Error("Invalid dimension: Width and height must be power of 2 and cannot exceed 2048")};Object.defineProperty(e.prototype,"powerOfTwo",{get:function(){return this._powerOfTwo},set:function(t){if(this._powerOfTwo==t)return;this._powerOfTwo=t;this._testDimensions()},enumerable:true,configurable:true});e.assetType="[image Image2D]";return e}(a);e.exports=o},{"awayjs-core/lib/data/ImageBase":"awayjs-core/lib/data/ImageBase","awayjs-core/lib/geom/Rectangle":"awayjs-core/lib/geom/Rectangle","awayjs-core/lib/utils/ImageUtils":"awayjs-core/lib/utils/ImageUtils"}],"awayjs-core/lib/data/ImageBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetBase");var s=function(t){r(e,t);function e(){t.call(this);this._imageObject=new Array}e.prototype.invalidateContent=function(){var t=this._imageObject.length;for(var e=0;e<t;e++)this._imageObject[e].invalidate()};e.prototype.invalidateSize=function(){while(this._imageObject.length)this._imageObject[0].dispose()};e.prototype.dispose=function(){while(this._imageObject.length)this._imageObject[0].dispose()};e.prototype._iAddImageObject=function(t){this._imageObject.push(t);return t};e.prototype._iRemoveImageObject=function(t){this._imageObject.splice(this._imageObject.indexOf(t),1);return t};return e}(a);e.exports=s},{"awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase"}],"awayjs-core/lib/data/ImageCube":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/ImageBase");var s=t("awayjs-core/lib/utils/ImageUtils");var n=function(t){r(e,t);function e(e){t.call(this);this._size=e;this._testDimensions()}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){if(this._size==t)return;this._setSize(this._size)},enumerable:true,configurable:true});e.prototype._setSize=function(t){if(this._size!=t)this.invalidateSize();this._size=t;this._testDimensions()};e.prototype._testDimensions=function(){if(!s.isDimensionValid(this._size))throw new Error("Invalid dimension: Width and height must be power of 2 and cannot exceed 2048")};e.assetType="[image ImageCube]";return e}(a);e.exports=n},{"awayjs-core/lib/data/ImageBase":"awayjs-core/lib/data/ImageBase","awayjs-core/lib/utils/ImageUtils":"awayjs-core/lib/utils/ImageUtils"}],"awayjs-core/lib/data/Sampler2D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/SamplerBase");var s=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=null}if(i===void 0){i=false}if(r===void 0){r=false}if(a===void 0){a=false}t.call(this);this._offsetX=0;this._offsetY=0;this._scaleX=1;this._scaleY=1;this.image2D=e;this.repeat=i;this.smooth=r;this.mipmap=a;this._updateRect()}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offsetX",{get:function(){return this._offsetX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offsetY",{get:function(){return this._offsetY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleX",{get:function(){return this._scaleX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleY",{get:function(){return this._scaleY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},set:function(t){if(this._repeat==t)return;this._repeat=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"imageRect",{get:function(){return this._imageRect},set:function(t){if(this._imageRect==t)return;this._imageRect=t;this._updateRect()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frameRect",{get:function(){return this._frameRect},set:function(t){if(this._frameRect==t)return;this._frameRect=t;this._updateRect()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rect",{get:function(){return this._rect},enumerable:true,configurable:true});e.prototype._updateRect=function(){if(this._imageRect)this._rect=this._imageRect;else this._rect=this.image2D.rect;if(this._imageRect){this._offsetX=this._imageRect.x/this.image2D.width;this._offsetY=this._imageRect.y/this.image2D.height;this._scaleX=this._imageRect.width/this.image2D.width;this._scaleY=this._imageRect.height/this.image2D.height}else{this._offsetX=0;this._offsetY=0;this._scaleX=1;this._scaleY=1}};e.assetType="[asset Sampler2D]";return e}(a);e.exports=s},{"awayjs-core/lib/data/SamplerBase":"awayjs-core/lib/data/SamplerBase"}],"awayjs-core/lib/data/SamplerBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetBase");var s=function(t){r(e,t);function e(){t.call(this);this._pFormat="bgra"}Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){if(this._smooth==t)return;this._smooth=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){if(this._mipmap==t)return;this._mipmap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"format",{get:function(){return this._pFormat},enumerable:true,configurable:true});return e}(a);e.exports=s},{"awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase"}],"awayjs-core/lib/data/SamplerCube":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/SamplerBase");var s=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this.imageCube=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.assetType="[asset SamplerCube]";return e}(a);e.exports=s},{"awayjs-core/lib/data/SamplerBase":"awayjs-core/lib/data/SamplerBase"}],"awayjs-core/lib/data/SpecularImage2D":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/BitmapImage2D");var s=t("awayjs-core/lib/data/BitmapImageChannel");var n=t("awayjs-core/lib/data/Image2D");var o=t("awayjs-core/lib/geom/Point");var h=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=null}t.call(this,1,1);this._specularSource=e;this._glossSource=i;this._output=new a(1,1,false,16777215);this._testSize()}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularSource",{get:function(){return this._specularSource},set:function(t){if(this._specularSource==t)return;this._specularSource=t;this.invalidateContent();this._testSize()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glossSource",{get:function(){return this._glossSource},set:function(t){if(this._glossSource==t)return;this._glossSource=t;this.invalidateContent();this._testSize()},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._specularSource,this._glossSource)};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._rect=null;this._output.dispose()};e.prototype.getImageData=function(){var t=new o;this._output.fillRect(this._rect,16777215);if(this._glossSource)this._output.copyChannel(this._glossSource,this._rect,t,s.GREEN,s.GREEN);if(this._specularSource)this._output.copyChannel(this._specularSource,this._rect,t,s.RED,s.RED);return this._output.getImageData()};e.prototype.getCanvas=function(){return this._output.getCanvas()};e.prototype._setSize=function(e,i){t.prototype._setSize.call(this,e,i);this._output._setSize(e,i)};e.prototype._testSize=function(){var t,e;if(this._specularSource){t=this._specularSource.width;e=this._specularSource.height}else if(this._glossSource){t=this._glossSource.width;e=this._glossSource.height}else{t=1;e=1}if(t!=this._output.width&&e!=this._output.height){this._output.dispose();this._output=new a(t,e,false,16777215)}this._setSize(t,e)};e.assetType="[asset SpecularImage2D]";return e}(n);e.exports=h},{"awayjs-core/lib/data/BitmapImage2D":"awayjs-core/lib/data/BitmapImage2D","awayjs-core/lib/data/BitmapImageChannel":"awayjs-core/lib/data/BitmapImageChannel","awayjs-core/lib/data/Image2D":"awayjs-core/lib/data/Image2D","awayjs-core/lib/geom/Point":"awayjs-core/lib/geom/Point"}],"awayjs-core/lib/data/WaveAudio":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetBase");var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){var r=this;t.call(this);this._volume=1;this._startTime=0;this._currentTime=0;this._duration=0;this._buffer=e;this._audioCtx=i;this._gainNode=this._audioCtx.createGain();this._gainNode.gain.value=this._volume;this._gainNode.connect(this._audioCtx.destination);this._onEndedDelegate=function(t){return r.onEnded(t)}}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loop",{get:function(){return this._source.loop},set:function(t){if(this._loop==t)return;this._loop=t;if(this._source)this._source.loop=this._loop},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"volume",{get:function(){return this._volume},set:function(t){if(this._volume==t)return;this._volume=t;this._gainNode.gain.value=this._volume},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"currentTime",{get:function(){if(!this._isPlaying)return this._currentTime;return this._audioCtx.currentTime-this._startTime},set:function(t){this._currentTime=t;if(this._isPlaying){var e=this._audioCtx.createBufferSource();e.buffer=this._source.buffer;this._source.disconnect();delete this._source;this._source=e;this._source.loop=this._loop;this._source.connect(this._gainNode);this._startTime=this._audioCtx.currentTime-this._currentTime;this._source.start(this._audioCtx.currentTime,this._currentTime)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:true,configurable:true});e.prototype.dispose=function(){this.stop();delete this._audioCtx;this._audioCtx=null;delete this._buffer;this._buffer=null};e.prototype.play=function(){if(this._isPlaying)return;this._createSource()};e.prototype.stop=function(){if(!this._isPlaying)return;this._isPlaying=false;this._currentTime=this._audioCtx.currentTime-this._startTime;this._source.stop(this._audioCtx.currentTime);this._disposeSource()};e.prototype.clone=function(){return new e(this._buffer,this._audioCtx)};e.prototype.onLoadComplete=function(t){this._source.buffer=t;this._duration=t.duration;this._isPlaying=true;this._startTime=this._audioCtx.currentTime-this._currentTime;this._source.onended=this._onEndedDelegate;this._source.start(this._audioCtx.currentTime,this._currentTime)};e.prototype.onError=function(t){};e.prototype._createSource=function(){var t=this;if(this._source)return;this._source=this._audioCtx.createBufferSource();this._source.loop=this._loop;this._source.connect(this._gainNode);this._audioCtx.decodeAudioData(this._buffer,function(e){return t.onLoadComplete(e)},function(e){return t.onError(e)})};e.prototype._disposeSource=function(){this._source.disconnect();delete this._source;this._source=null};e.prototype.onEnded=function(t){this.stop();this.dispatchEvent(new s("ended"))};e.assetType="[asset WaveAudio]";return e}(a);e.exports=n},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event","awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase"}],"awayjs-core/lib/errors/AbstractMethodError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"An abstract method was called! Either an instance of an abstract class was created, or an abstract method was not overridden by the subclass.",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error"}],"awayjs-core/lib/errors/ArgumentError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"ArgumentError",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error"}],"awayjs-core/lib/errors/DocumentError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e="DocumentError"}if(i===void 0){i=0}t.call(this,e,i)}e.DOCUMENT_DOES_NOT_EXIST="documentDoesNotExist";return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error"}],"awayjs-core/lib/errors/Error":[function(t,e,i){var r=function(){function t(t,e,i){if(t===void 0){t=""}if(e===void 0){e=0}if(i===void 0){i=""}this._errorID=0;this._messsage="";this._name="";this._messsage=t;this._name=name;this._errorID=e}Object.defineProperty(t.prototype,"message",{get:function(){return this._messsage},set:function(t){this._messsage=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"errorID",{get:function(){return this._errorID},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-core/lib/errors/PartialImplementationError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=""}if(i===void 0){i=0}t.call(this,"PartialImplementationError - this function is in development. Required Dependency: "+e,i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error"}],"awayjs-core/lib/errors/RangeError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=0}t.call(this,e||"RangeError",i)}return e}(a);e.exports=s},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error"}],"awayjs-core/lib/events/AssetEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=null}if(r===void 0){r=null}t.call(this,e);this._asset=i;this._prevName=r||(this._asset?this._asset.name:null)}Object.defineProperty(e.prototype,"asset",{get:function(){return this._asset},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetPrevName",{get:function(){return this._prevName},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this.asset,this.assetPrevName)};e.ASSET_COMPLETE="assetComplete";e.ASSET_RENAME="assetRename";e.ASSET_CONFLICT_RESOLVED="assetConflictResolved";e.TEXTURE_SIZE_ERROR="textureSizeError";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/EventDispatcher":[function(t,e,i){var r=function(){function t(t){if(t===void 0){t=null}this.listeners=new Array;this.target=t||this}t.prototype.addEventListener=function(t,e){if(this.listeners[t]===undefined)this.listeners[t]=new Array;if(this.getEventListenerIndex(t,e)===-1)this.listeners[t].push(e)};t.prototype.removeEventListener=function(t,e){var i=this.getEventListenerIndex(t,e);if(i!==-1)this.listeners[t].splice(i,1)};t.prototype.dispatchEvent=function(t){var e=this.listeners[t.type];if(e!==undefined){var i=e.length;t.target=this.target;for(var r=0;r<i;r++)e[r](t)}};t.prototype.getEventListenerIndex=function(t,e){if(this.listeners[t]!==undefined){var i=this.listeners[t];var r=i.length;for(var a=0;a<r;a++)if(e==i[a])return a}return-1};t.prototype.hasEventListener=function(t,e){if(e!=null){return this.getEventListenerIndex(t,e)!==-1}else{if(this.listeners[t]!==undefined)return this.listeners[t].length>0;return false}return false};return t}();e.exports=r},{}],"awayjs-core/lib/events/Event":[function(t,e,i){var r=function(){function t(t){this.type=undefined;this.target=undefined;this.type=t}t.prototype.clone=function(){return new t(this.type)};t.COMPLETE="complete";t.OPEN="open";t.ENTER_FRAME="enterFrame";t.EXIT_FRAME="exitFrame";t.RESIZE="resize";t.ERROR="error";t.CHANGE="change";return t}();e.exports=r},{}],"awayjs-core/lib/events/HTTPStatusEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,e);this.status=i}e.HTTP_STATUS="httpStatus";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/IEventDispatcher":[function(t,e,i){},{}],"awayjs-core/lib/events/IOErrorEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.IO_ERROR="ioError";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/LoaderEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}t.call(this,e);this._url=i;this._content=r;this._assets=a}Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assets",{get:function(){return this._assets},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._url,this._content,this._assets)};e.RESOURCE_COMPLETE="resourceComplete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/ParserEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){if(i===void 0){i=""}t.call(this,e);this._message=i}Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this.message)};e.PARSE_COMPLETE="parseComplete";e.PARSE_ERROR="parseError";e.READY_FOR_DEPENDENCIES="readyForDependencies";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/ProgressEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.PROGRESS="progress";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/ProjectionEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e,i){t.call(this,e);this._projection=i}Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},enumerable:true,configurable:true});e.MATRIX_CHANGED="matrixChanged";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/events/TimerEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var s=function(t){r(e,t);function e(e){t.call(this,e)}e.TIMER="timer";e.TIMER_COMPLETE="timerComplete";return e}(a);e.exports=s},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event"}],"awayjs-core/lib/geom/Box":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var a=function(){function t(t,e,i,r,a,s){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}if(s===void 0){s=0}this.x=t;this.y=e;this.z=i;this.width=r;this.height=a;this.depth=s}Object.defineProperty(t.prototype,"back",{get:function(){return this.z+this.depth},set:function(t){this.depth=t-this.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottomRightBack",{get:function(){if(this._bottomRightBack==null)this._bottomRightBack=new r;this._bottomRightBack.x=this.x+this.width;this._bottomRightBack.y=this.y+this.height;this._bottomRightBack.z=this.z+this.depth;return this._bottomRightBack},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"front",{get:function(){return this.z},set:function(t){this.depth+=this.z-t;this.z=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t;this.x=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"size",{get:function(){if(this._size==null)this._size=new r;this._size.x=this.width;this._size.y=this.height;this._size.z=this.depth;return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t;this.y=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"topLeftFront",{get:function(){if(this._topLeftFront==null)this._topLeftFront=new r;this._topLeftFront.x=this.x;this._topLeftFront.y=this.y;this._topLeftFront.z=this.z;return this._topLeftFront},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.width,this.height,this.depth)};t.prototype.contains=function(t,e,i){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e&&this.z<=i&&this.z+this.depth>=i};t.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y&&this.z<=t.z&&this.z+this.depth>=t.z};t.prototype.containsBox=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height&&this.z<=t.z&&this.z+this.depth>=t.z+t.depth};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.width=t.width;this.height=t.height;this.depth=t.depth};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.width==t.width&&this.height==t.height&&this.depth==t.depth};t.prototype.inflate=function(t,e,i){this.x-=t/2;this.y-=e/2;this.z-=i/2;this.width+=t/2;this.height+=e/2;this.depth+=i/2};t.prototype.inflatePoint=function(t){this.x-=t.x/2;this.y-=t.y/2;this.z-=t.z/2;this.width+=t.x/2;this.height+=t.y/2;this.depth+=t.z/2};t.prototype.intersection=function(e){if(this.intersects(e)){var i=new t;if(this.x>e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width>this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width>e.width)i.width=e.width}if(this.y>e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height>this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height>e.height)i.height=e.height}if(this.z>e.z){i.z=this.z;i.depth=e.z-this.z+e.depth;if(i.depth>this.depth)i.depth=this.depth}else{i.z=e.z;i.depth=this.z-e.z+this.depth;if(i.depth>e.depth)i.depth=e.depth}return i}return new t};t.prototype.intersects=function(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height&&this.z+this.depth>t.z&&this.z<t.z+t.depth};t.prototype.rayIntersection=function(t,e,i){if(this.containsPoint(t))return 0;var r=this.width/2;var a=this.height/2;var s=this.depth/2;var n=this.x+r;var o=this.y+a;var h=this.z+s;var u=t.x-n;var c=t.y-o;var p=t.z-h;var l=e.x;var f=e.y;var y=e.z;var _;var d;var w;var v;var b;if(l<0){v=(r-u)/l;if(v>0){d=c+v*f;w=p+v*y;if(d>-a&&d<a&&w>-s&&w<s){i.x=1;i.y=0;i.z=0;b=true}}}if(!b&&l>0){v=(-r-u)/l;if(v>0){d=c+v*f;w=p+v*y;if(d>-a&&d<a&&w>-s&&w<s){i.x=-1;i.y=0;i.z=0;b=true}}}if(!b&&f<0){v=(a-c)/f;if(v>0){_=u+v*l;w=p+v*y;if(_>-r&&_<r&&w>-s&&w<s){i.x=0;i.y=1;i.z=0;b=true}}}if(!b&&f>0){v=(-a-c)/f;if(v>0){_=u+v*l;w=p+v*y;if(_>-r&&_<r&&w>-s&&w<s){i.x=0;i.y=-1;i.z=0;b=true}}}if(!b&&y<0){v=(s-p)/y;if(v>0){_=u+v*l;d=c+v*f;if(d>-a&&d<a&&_>-r&&_<r){i.x=0;i.y=0;i.z=1;b=true}}}if(!b&&y>0){v=(-s-p)/y;if(v>0){_=u+v*l;d=c+v*f;if(d>-a&&d<a&&_>-r&&_<r){i.x=0;i.y=0;i.z=-1;b=true}}}return b?v:-1};t.prototype.closestPointToPoint=function(t,e){if(e===void 0){e=null}var i;if(e==null)e=new r;i=t.x;if(i<this.x)i=this.x;if(i>this.x+this.width)i=this.x+this.width;e.x=i;i=t.y;if(i<this.y+this.height)i=this.y+this.height;if(i>this.y)i=this.y;e.y=i;i=t.z;if(i<this.z)i=this.z;if(i>this.z+this.depth)i=this.z+this.depth;e.z=i;return e};t.prototype.isEmpty=function(){return this.x==0&&this.y==0&&this.z==0&&this.width==0&&this.height==0&&this.depth==0};t.prototype.offset=function(t,e,i){this.x+=t;this.y+=e;this.z+=i};t.prototype.offsetPosition=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z};t.prototype.setEmpty=function(){this.x=0;this.y=0;this.z=0;this.width=0;this.height=0;this.depth=0};t.prototype.setTo=function(t,e,i,r,a,s){this.x=t;this.y=e;this.z=i;this.width=r;this.height=a;this.depth=s};t.prototype.toString=function(){return"[Box] (x="+this.x+", y="+this.y+", z="+this.z+", width="+this.width+", height="+this.height+", depth="+this.depth+")"};t.prototype.union=function(e){var i=new t;if(this.x<e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width<this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width<e.width)i.width=e.width}if(this.y<e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height<this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height<e.height)i.height=e.height}if(this.z<e.z){i.z=this.z;i.depth=e.z-this.z+e.depth;if(i.depth<this.depth)i.depth=this.depth}else{i.z=e.z;i.depth=this.z-e.z+this.depth;if(i.depth<e.depth)i.depth=e.depth}return i};return t}();e.exports=a},{"awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D"}],"awayjs-core/lib/geom/ColorTransform":[function(t,e,i){var r=t("awayjs-core/lib/utils/ColorUtils");var a=function(){function t(t,e,i,r,a,s,n,o){if(t===void 0){t=1}if(e===void 0){e=1}if(i===void 0){i=1}if(r===void 0){r=1}if(a===void 0){a=0}if(s===void 0){s=0}if(n===void 0){n=0}if(o===void 0){o=0}this.redMultiplier=t;this.greenMultiplier=e;this.blueMultiplier=i;this.alphaMultiplier=r;this.redOffset=a;this.greenOffset=s;this.blueOffset=n;this.alphaOffset=o}Object.defineProperty(t.prototype,"color",{get:function(){return this.redOffset<<16|this.greenOffset<<8|this.blueOffset},set:function(t){var e=r.float32ColorToARGB(t);this.redOffset=e[1];this.greenOffset=e[2];this.blueOffset=e[3];this.redMultiplier=0;this.greenMultiplier=0;this.blueMultiplier=0},enumerable:true,configurable:true});t.prototype.clear=function(){this.redMultiplier=1;this.greenMultiplier=1;this.blueMultiplier=1;this.alphaMultiplier=1;this.redOffset=0;this.greenOffset=0;this.blueOffset=0;this.alphaOffset=0};t.prototype.clone=function(){return new t(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)};t.prototype.copyFrom=function(t){this.redMultiplier=t.redMultiplier;this.greenMultiplier=t.greenMultiplier;this.blueMultiplier=t.blueMultiplier;this.alphaMultiplier=t.alphaMultiplier;this.redOffset=t.redOffset;this.greenOffset=t.greenOffset;this.blueOffset=t.blueOffset;this.alphaOffset=t.alphaOffset};t.prototype.copyTo=function(t){t.copyFrom(this)};t.prototype.prepend=function(t){this.redOffset+=t.redOffset*this.redMultiplier;this.greenOffset+=t.greenOffset*this.greenMultiplier;this.blueOffset+=t.blueOffset*this.blueMultiplier;this.alphaOffset+=t.alphaOffset*this.alphaMultiplier;this.redMultiplier*=t.redMultiplier;this.greenMultiplier*=t.greenMultiplier;this.blueMultiplier*=t.blueMultiplier;this.alphaMultiplier*=t.alphaMultiplier};return t}();e.exports=a},{"awayjs-core/lib/utils/ColorUtils":"awayjs-core/lib/utils/ColorUtils"}],"awayjs-core/lib/geom/MathConsts":[function(t,e,i){var r=function(){function t(){}t.RADIANS_TO_DEGREES=180/Math.PI;t.DEGREES_TO_RADIANS=Math.PI/180;return t}();e.exports=r},{}],"awayjs-core/lib/geom/Matrix3DUtils":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3D");var a=t("awayjs-core/lib/geom/Vector3D");var s=function(){function t(){}t.quaternion2matrix=function(e,i){if(i===void 0){i=null}var a=e.x;var s=e.y;var n=e.z;var o=e.w;var h=a*a;var u=a*s;var c=a*n;var p=a*o;var l=s*s;var f=s*n;var y=s*o;var _=n*n;var d=n*o;var w=t.RAW_DATA_CONTAINER;w[0]=1-2*(l+_);w[1]=2*(u+d);w[2]=2*(c-y);w[4]=2*(u-d);w[5]=1-2*(h+_);w[6]=2*(f+p);w[8]=2*(c+y);w[9]=2*(f-p);w[10]=1-2*(h+l);w[3]=w[7]=w[11]=w[12]=w[13]=w[14]=0;w[15]=1;if(i){i.copyRawDataFrom(w);return i}else return new r(w)};t.getForward=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(2,e);e.normalize();return e};t.getUp=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(1,e);e.normalize();return e};t.getRight=function(t,e){if(e===void 0){e=null}if(e===null){e=new a(0,0,0)}t.copyColumnTo(0,e);e.normalize();return e};t.compare=function(e,i){var r=t.RAW_DATA_CONTAINER;var a=i.rawData;e.copyRawDataTo(r);
for(var s=0;s<16;++s){if(r[s]!=a[s])return false}return true};t.lookAt=function(e,i,r,a){var s;var n;var o;var h=t.RAW_DATA_CONTAINER;o=r.crossProduct(a);o.normalize();n=o.crossProduct(r);n.normalize();s=r.clone();s.normalize();h[0]=o.x;h[1]=n.x;h[2]=-s.x;h[3]=0;h[4]=o.y;h[5]=n.y;h[6]=-s.y;h[7]=0;h[8]=o.z;h[9]=n.z;h[10]=-s.z;h[11]=0;h[12]=-o.dotProduct(i);h[13]=-n.dotProduct(i);h[14]=s.dotProduct(i);h[15]=1;e.copyRawDataFrom(h)};t.reflection=function(e,i){if(i===void 0){i=null}if(i===null)i=new r;var a=e.a,s=e.b,n=e.c,o=e.d;var h=t.RAW_DATA_CONTAINER;var u=-2*a*s;var c=-2*a*n;var p=-2*s*n;h[0]=1-2*a*a;h[4]=u;h[8]=c;h[12]=-2*a*o;h[1]=u;h[5]=1-2*s*s;h[9]=p;h[13]=-2*s*o;h[2]=c;h[6]=p;h[10]=1-2*n*n;h[14]=-2*n*o;h[3]=0;h[7]=0;h[11]=0;h[15]=1;i.copyRawDataFrom(h);return i};t.transformVector=function(e,i,r){if(r===void 0){r=null}if(!r)r=new a;var s=t.RAW_DATA_CONTAINER;e.copyRawDataTo(s);var n=s[0];var o=s[1];var h=s[2];var u=s[3];var c=s[4];var p=s[5];var l=s[6];var f=s[7];var y=s[8];var _=s[9];var d=s[10];var w=s[11];var v=s[12];var b=s[13];var g=s[14];var m=s[15];var D=i.x;var x=i.y;var E=i.z;r.x=n*D+c*x+y*E+v;r.y=o*D+p*x+_*E+b;r.z=h*D+l*x+d*E+g;r.w=u*D+f*x+w*E+m;return r};t.deltaTransformVector=function(e,i,r){if(r===void 0){r=null}if(!r)r=new a;var s=t.RAW_DATA_CONTAINER;e.copyRawDataTo(s);var n=s[0];var o=s[1];var h=s[2];var u=s[3];var c=s[4];var p=s[5];var l=s[6];var f=s[7];var y=s[8];var _=s[9];var d=s[10];var w=s[11];var v=i.x;var b=i.y;var g=i.z;r.x=n*v+c*b+y*g;r.y=o*v+p*b+_*g;r.z=h*v+l*b+d*g;r.w=u*v+f*b+w*g;return r};t.getTranslation=function(t,e){if(e===void 0){e=null}if(!e)e=new a;t.copyColumnTo(3,e);return e};t.deltaTransformVectors=function(e,i,r){var a=t.RAW_DATA_CONTAINER;e.copyRawDataTo(a);var s=a[0];var n=a[1];var o=a[2];var h=a[3];var u=a[4];var c=a[5];var p=a[6];var l=a[7];var f=a[8];var y=a[9];var _=a[10];var d=a[11];var w=0;var v=i.length;for(var b=0;b<v;b+=3){var g=i[b];var m=i[b+1];var D=i[b+2];r[w++]=s*g+u*m+f*D;r[w++]=n*g+c*m+y*D;r[w++]=o*g+p*m+_*D}};t.RAW_DATA_CONTAINER=new Float32Array(16);t.CALCULATION_MATRIX=new r;return t}();e.exports=s},{"awayjs-core/lib/geom/Matrix3D":"awayjs-core/lib/geom/Matrix3D","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D"}],"awayjs-core/lib/geom/Matrix3D":[function(t,e,i){var r=t("awayjs-core/lib/geom/Box");var a=t("awayjs-core/lib/geom/Orientation3D");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/errors/ArgumentError");var o=function(){function t(t){if(t===void 0){t=null}if(t!=null&&t.length==16){this.copyRawDataFrom(t)}else{this.rawData=new Float32Array(16);this.identity()}}t.prototype.append=function(t){var e=t.rawData;var i=this.rawData[0];var r=this.rawData[1];var a=this.rawData[2];var s=this.rawData[3];var n=this.rawData[4];var o=this.rawData[5];var h=this.rawData[6];var u=this.rawData[7];var c=this.rawData[8];var p=this.rawData[9];var l=this.rawData[10];var f=this.rawData[11];var y=this.rawData[12];var _=this.rawData[13];var d=this.rawData[14];var w=this.rawData[15];var v=e[0];var b=e[1];var g=e[2];var m=e[3];var D=e[4];var x=e[5];var E=e[6];var A=e[7];var j=e[8];var P=e[9];var R=e[10];var O=e[11];var M=e[12];var C=e[13];var I=e[14];var S=e[15];this.rawData[0]=i*v+r*D+a*j+s*M;this.rawData[1]=i*b+r*x+a*P+s*C;this.rawData[2]=i*g+r*E+a*R+s*I;this.rawData[3]=i*m+r*A+a*O+s*S;this.rawData[4]=n*v+o*D+h*j+u*M;this.rawData[5]=n*b+o*x+h*P+u*C;this.rawData[6]=n*g+o*E+h*R+u*I;this.rawData[7]=n*m+o*A+h*O+u*S;this.rawData[8]=c*v+p*D+l*j+f*M;this.rawData[9]=c*b+p*x+l*P+f*C;this.rawData[10]=c*g+p*E+l*R+f*I;this.rawData[11]=c*m+p*A+l*O+f*S;this.rawData[12]=y*v+_*D+d*j+w*M;this.rawData[13]=y*b+_*x+d*P+w*C;this.rawData[14]=y*g+_*E+d*R+w*I;this.rawData[15]=y*m+_*A+d*O+w*S};t.prototype.appendRotation=function(e,i){this.append(t.getAxisRotation(i.x,i.y,i.z,e))};t.prototype.appendSkew=function(e,i,r){if(e==0&&i==0&&r==0)return;var a=t.tempRawData;a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=e;a[5]=1;a[6]=0;a[7]=0;a[8]=i;a[9]=r;a[10]=1;a[11]=0;a[8]=0;a[9]=0;a[10]=0;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;this.append(t.tempMatrix)};t.prototype.appendScale=function(e,i,r){if(e==1&&i==1&&r==1)return;var a=t.tempRawData;a[0]=e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=i;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=r;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;this.append(t.tempMatrix)};t.prototype.appendTranslation=function(t,e,i){this.rawData[12]+=t;this.rawData[13]+=e;this.rawData[14]+=i};t.prototype.clone=function(){return new t(this.rawData)};t.prototype.copyColumnFrom=function(t,e){switch(t){case 0:this.rawData[0]=e.x;this.rawData[1]=e.y;this.rawData[2]=e.z;this.rawData[3]=e.w;break;case 1:this.rawData[4]=e.x;this.rawData[5]=e.y;this.rawData[6]=e.z;this.rawData[7]=e.w;break;case 2:this.rawData[8]=e.x;this.rawData[9]=e.y;this.rawData[10]=e.z;this.rawData[11]=e.w;break;case 3:this.rawData[12]=e.x;this.rawData[13]=e.y;this.rawData[14]=e.z;this.rawData[15]=e.w;break;default:throw new n("ArgumentError, Column "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyColumnTo=function(t,e){switch(t){case 0:e.x=this.rawData[0];e.y=this.rawData[1];e.z=this.rawData[2];e.w=this.rawData[3];break;case 1:e.x=this.rawData[4];e.y=this.rawData[5];e.z=this.rawData[6];e.w=this.rawData[7];break;case 2:e.x=this.rawData[8];e.y=this.rawData[9];e.z=this.rawData[10];e.w=this.rawData[11];break;case 3:e.x=this.rawData[12];e.y=this.rawData[13];e.z=this.rawData[14];e.w=this.rawData[15];break;default:throw new n("ArgumentError, Column "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyFrom=function(t){var e=t.rawData;var i=e.length;for(var r=0;r<i;r++)this.rawData[r]=e[r]};t.prototype.copyRawDataFrom=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=false}if(i)this.transpose();var r=t.length-e;for(var a=0;a<r;a++)this.rawData[a]=t[a+e];if(i)this.transpose()};t.prototype.copyRawDataTo=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=false}if(i)this.transpose();var r=this.rawData.length;for(var a=0;a<r;a++)t[a+e]=this.rawData[a];if(i)this.transpose()};t.prototype.copyRowFrom=function(t,e){switch(t){case 0:this.rawData[0]=e.x;this.rawData[4]=e.y;this.rawData[8]=e.z;this.rawData[12]=e.w;break;case 1:this.rawData[1]=e.x;this.rawData[5]=e.y;this.rawData[9]=e.z;this.rawData[13]=e.w;break;case 2:this.rawData[2]=e.x;this.rawData[6]=e.y;this.rawData[10]=e.z;this.rawData[14]=e.w;break;case 3:this.rawData[3]=e.x;this.rawData[7]=e.y;this.rawData[11]=e.z;this.rawData[15]=e.w;break;default:throw new n("ArgumentError, Row "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyRowTo=function(t,e){switch(t){case 0:e.x=this.rawData[0];e.y=this.rawData[4];e.z=this.rawData[8];e.w=this.rawData[12];break;case 1:e.x=this.rawData[1];e.y=this.rawData[5];e.z=this.rawData[9];e.w=this.rawData[13];break;case 2:e.x=this.rawData[2];e.y=this.rawData[6];e.z=this.rawData[10];e.w=this.rawData[14];break;case 3:e.x=this.rawData[3];e.y=this.rawData[7];e.z=this.rawData[11];e.w=this.rawData[15];break;default:throw new n("ArgumentError, Row "+t+" out of bounds [0, ..., 3]")}};t.prototype.copyToMatrix3D=function(t){this.copyRawDataTo(t.rawData)};t.prototype.decompose=function(t){if(t===void 0){t="eulerAngles"}var e;var i=[];var r=new s(this.rawData[0],this.rawData[1],this.rawData[2]);var n=new s(this.rawData[4],this.rawData[5],this.rawData[6]);var o=new s(this.rawData[8],this.rawData[9],this.rawData[10]);var h=new s(this.rawData[12],this.rawData[13],this.rawData[14]);var u=new s;var c=new s;u.x=r.length;r.scaleBy(1/u.x);c.x=r.dotProduct(n);n=s.combine(n,r,1,-c.x);u.y=n.length;n.scaleBy(1/u.y);c.x/=u.y;c.y=r.dotProduct(o);o=s.combine(o,r,1,-c.y);c.z=n.dotProduct(o);o=s.combine(o,n,1,-c.z);u.z=o.length;o.scaleBy(1/u.z);c.y/=u.z;c.z/=u.z;if(r.dotProduct(n.crossProduct(o))<0){u.z=-u.z;o.x=-o.x;o.y=-o.y;o.z=-o.z}var p=new s;switch(t){case a.AXIS_ANGLE:p.w=Math.acos((r.x+n.y+o.z-1)/2);var l=Math.sqrt((n.z-o.y)*(n.z-o.y)+(o.x-r.z)*(o.x-r.z)+(r.y-n.x)*(r.y-n.x));p.x=(n.z-o.y)/l;p.y=(o.x-r.z)/l;p.z=(r.y-n.x)/l;break;case a.QUATERNION:var f=r.x+n.y+o.z;if(f>0){p.w=Math.sqrt(1+f)/2;p.x=(n.z-o.y)/(4*p.w);p.y=(o.x-r.z)/(4*p.w);p.z=(r.y-n.x)/(4*p.w)}else if(r.x>n.y&&r.x>o.z){p.x=Math.sqrt(1+r.x-n.y-o.z)/2;p.w=(n.z-o.y)/(4*p.x);p.y=(r.y+n.x)/(4*p.x);p.z=(o.x+r.z)/(4*p.x)}else if(n.y>o.z){p.y=Math.sqrt(1+n.y-r.x-o.z)/2;p.x=(r.y+n.x)/(4*p.y);p.w=(o.x-r.z)/(4*p.y);p.z=(n.z+o.y)/(4*p.y)}else{p.z=Math.sqrt(1+o.z-r.x-n.y)/2;p.x=(o.x+r.z)/(4*p.z);p.y=(n.z+o.y)/(4*p.z);p.w=(r.y-n.x)/(4*p.z)}break;case a.EULER_ANGLES:p.y=Math.asin(-r.z);if(r.z!=1&&r.z!=-1){p.x=Math.atan2(n.z,o.z);p.z=Math.atan2(r.y,r.x)}else{p.z=0;p.x=Math.atan2(n.x,n.y)}break}i.push(h);i.push(p);i.push(c);i.push(u);return i};t.prototype.deltaTransformVector=function(t){var e=t.x;var i=t.y;var r=t.z;return new s(e*this.rawData[0]+i*this.rawData[4]+r*this.rawData[8],e*this.rawData[1]+i*this.rawData[5]+r*this.rawData[9],e*this.rawData[2]+i*this.rawData[6]+r*this.rawData[10],e*this.rawData[3]+i*this.rawData[7]+r*this.rawData[11])};t.prototype.identity=function(){this.rawData[0]=1;this.rawData[1]=0;this.rawData[2]=0;this.rawData[3]=0;this.rawData[4]=0;this.rawData[5]=1;this.rawData[6]=0;this.rawData[7]=0;this.rawData[8]=0;this.rawData[9]=0;this.rawData[10]=1;this.rawData[11]=0;this.rawData[12]=0;this.rawData[13]=0;this.rawData[14]=0;this.rawData[15]=1};t.interpolate=function(e,i,r){var a=new t;for(var s=0;s<16;++s)a.rawData[s]=e.rawData[s]+(i.rawData[s]-e.rawData[s])*r;return a};t.prototype.interpolateTo=function(t,e){for(var i=0;i<16;++i)this.rawData[i]=this.rawData[i]+(t.rawData[i]-this.rawData[i])*e};t.prototype.invert=function(){var t=this.determinant;var e=Math.abs(t)>1e-11;if(e){t=1/t;var i=this.rawData[0];var r=this.rawData[1];var a=this.rawData[2];var s=this.rawData[3];var n=this.rawData[4];var o=this.rawData[5];var h=this.rawData[6];var u=this.rawData[7];var c=this.rawData[8];var p=this.rawData[9];var l=this.rawData[10];var f=this.rawData[11];var y=this.rawData[12];var _=this.rawData[13];var d=this.rawData[14];var w=this.rawData[15];this.rawData[0]=t*(o*(l*w-d*f)-p*(h*w-d*u)+_*(h*f-l*u));this.rawData[1]=-t*(r*(l*w-d*f)-p*(a*w-d*s)+_*(a*f-l*s));this.rawData[2]=t*(r*(h*w-d*u)-o*(a*w-d*s)+_*(a*u-h*s));this.rawData[3]=-t*(r*(h*f-l*u)-o*(a*f-l*s)+p*(a*u-h*s));this.rawData[4]=-t*(n*(l*w-d*f)-c*(h*w-d*u)+y*(h*f-l*u));this.rawData[5]=t*(i*(l*w-d*f)-c*(a*w-d*s)+y*(a*f-l*s));this.rawData[6]=-t*(i*(h*w-d*u)-n*(a*w-d*s)+y*(a*u-h*s));this.rawData[7]=t*(i*(h*f-l*u)-n*(a*f-l*s)+c*(a*u-h*s));this.rawData[8]=t*(n*(p*w-_*f)-c*(o*w-_*u)+y*(o*f-p*u));this.rawData[9]=-t*(i*(p*w-_*f)-c*(r*w-_*s)+y*(r*f-p*s));this.rawData[10]=t*(i*(o*w-_*u)-n*(r*w-_*s)+y*(r*u-o*s));this.rawData[11]=-t*(i*(o*f-p*u)-n*(r*f-p*s)+c*(r*u-o*s));this.rawData[12]=-t*(n*(p*d-_*l)-c*(o*d-_*h)+y*(o*l-p*h));this.rawData[13]=t*(i*(p*d-_*l)-c*(r*d-_*a)+y*(r*l-p*a));this.rawData[14]=-t*(i*(o*d-_*h)-n*(r*d-_*a)+y*(r*h-o*a));this.rawData[15]=t*(i*(o*l-p*h)-n*(r*l-p*a)+c*(r*h-o*a))}return e};t.prototype.prepend=function(t){var e=t.rawData[0];var i=t.rawData[1];var r=t.rawData[2];var a=t.rawData[3];var s=t.rawData[4];var n=t.rawData[5];var o=t.rawData[6];var h=t.rawData[7];var u=t.rawData[8];var c=t.rawData[9];var p=t.rawData[10];var l=t.rawData[11];var f=t.rawData[12];var y=t.rawData[13];var _=t.rawData[14];var d=t.rawData[15];var w=this.rawData[0];var v=this.rawData[1];var b=this.rawData[2];var g=this.rawData[3];var m=this.rawData[4];var D=this.rawData[5];var x=this.rawData[6];var E=this.rawData[7];var A=this.rawData[8];var j=this.rawData[9];var P=this.rawData[10];var R=this.rawData[11];var O=this.rawData[12];var M=this.rawData[13];var C=this.rawData[14];var I=this.rawData[15];this.rawData[0]=e*w+i*m+r*A+a*O;this.rawData[1]=e*v+i*D+r*j+a*M;this.rawData[2]=e*b+i*x+r*P+a*C;this.rawData[3]=e*g+i*E+r*R+a*I;this.rawData[4]=s*w+n*m+o*A+h*O;this.rawData[5]=s*v+n*D+o*j+h*M;this.rawData[6]=s*b+n*x+o*P+h*C;this.rawData[7]=s*g+n*E+o*R+h*I;this.rawData[8]=u*w+c*m+p*A+l*O;this.rawData[9]=u*v+c*D+p*j+l*M;this.rawData[10]=u*b+c*x+p*P+l*C;this.rawData[11]=u*g+c*E+p*R+l*I;this.rawData[12]=f*w+y*m+_*A+d*O;this.rawData[13]=f*v+y*D+_*j+d*M;this.rawData[14]=f*b+y*x+_*P+d*C;this.rawData[15]=f*g+y*E+_*R+d*I};t.prototype.prependRotation=function(e,i){var r=t.getAxisRotation(i.x,i.y,i.z,e);this.prepend(r)};t.prototype.prependScale=function(e,i,r){if(e==1&&i==1&&r==1)return;var a=t.tempRawData;a[0]=e;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=i;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=r;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;this.prepend(t.tempMatrix)};t.prototype.prependTranslation=function(e,i,r){var a=new t;a.position=new s(e,i,r);this.prepend(a)};t.prototype.recompose=function(e){if(e.length<3)return false;this.identity();var i=e[3];if(i.x!=1||i.y!=1||i.z!=1)this.appendScale(i.x,i.y,i.z);var r=e[2];if(r.x!=0||r.y!=0||r.z!=0)this.appendSkew(r.x,r.y,r.z);var a;var s=e[1];a=-s.x;if(a!=0){var n=Math.sin(a);var o=Math.cos(a);var h=t.tempRawData;h[0]=1;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=o;h[6]=-n;h[7]=0;h[8]=0;h[9]=n;h[10]=o;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=0;this.append(t.tempMatrix)}a=-s.y;if(a!=0){n=Math.sin(a);o=Math.cos(a);var h=t.tempRawData;h[0]=o;h[1]=0;h[2]=n;h[3]=0;h[4]=0;h[5]=1;h[6]=0;h[7]=0;h[8]=-n;h[9]=0;h[10]=o;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=0;this.append(t.tempMatrix)}a=-s.z;if(a!=0){n=Math.sin(a);o=Math.cos(a);var h=t.tempRawData;h[0]=o;h[1]=-n;h[2]=0;h[3]=0;h[4]=n;h[5]=o;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=1;h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=0;this.append(t.tempMatrix)}this.position=e[0];this.rawData[15]=1;return true};t.prototype.transformVector=function(t){if(t==null)return new s;var e=t.x;var i=t.y;var r=t.z;return new s(e*this.rawData[0]+i*this.rawData[4]+r*this.rawData[8]+this.rawData[12],e*this.rawData[1]+i*this.rawData[5]+r*this.rawData[9]+this.rawData[13],e*this.rawData[2]+i*this.rawData[6]+r*this.rawData[10]+this.rawData[14],e*this.rawData[3]+i*this.rawData[7]+r*this.rawData[11]+this.rawData[15])};t.prototype.transformBox=function(t){if(t==null)return new r;var e,i,a;var s,n,o;s=t.width+(e=t.x);n=t.height+(i=t.y);o=t.depth+(a=t.z);var h=new r;h.width=s*this.rawData[0]+n*this.rawData[4]+o*this.rawData[8]+this.rawData[12]-(h.x=e*this.rawData[0]+i*this.rawData[4]+a*this.rawData[8]+this.rawData[12]);h.height=s*this.rawData[1]+n*this.rawData[5]+o*this.rawData[9]+this.rawData[13]-(h.y=e*this.rawData[1]+i*this.rawData[5]+a*this.rawData[9]+this.rawData[13]);h.depth=s*this.rawData[2]+n*this.rawData[6]+o*this.rawData[10]+this.rawData[14]-(h.z=e*this.rawData[2]+i*this.rawData[6]+a*this.rawData[10]+this.rawData[14]);return h};t.prototype.transformVectors=function(t,e){var i=0;var r=0,a=0,s=0;while(i+3<=t.length){r=t[i];a=t[i+1];s=t[i+2];e[i]=r*this.rawData[0]+a*this.rawData[4]+s*this.rawData[8]+this.rawData[12];e[i+1]=r*this.rawData[1]+a*this.rawData[5]+s*this.rawData[9]+this.rawData[13];e[i+2]=r*this.rawData[2]+a*this.rawData[6]+s*this.rawData[10]+this.rawData[14];i+=3}};t.prototype.transpose=function(){var e=t.tempRawData;this.copyRawDataTo(e);this.rawData[1]=e[4];this.rawData[2]=e[8];this.rawData[3]=e[12];this.rawData[4]=e[1];this.rawData[6]=e[9];this.rawData[7]=e[13];this.rawData[8]=e[2];this.rawData[9]=e[6];this.rawData[11]=e[14];this.rawData[12]=e[3];this.rawData[13]=e[7];this.rawData[14]=e[11]};t.getAxisRotation=function(e,i,r,a){var s=new t;var n=a*(Math.PI/180);var o=Math.cos(n);var h=Math.sin(n);var u=1-o;var c,p;s.rawData[0]=o+e*e*u;s.rawData[5]=o+i*i*u;s.rawData[10]=o+r*r*u;c=e*i*u;p=r*h;s.rawData[1]=c+p;s.rawData[4]=c-p;c=e*r*u;p=i*h;s.rawData[8]=c+p;s.rawData[2]=c-p;c=i*r*u;p=e*h;s.rawData[9]=c-p;s.rawData[6]=c+p;return s};Object.defineProperty(t.prototype,"determinant",{get:function(){return(this.rawData[0]*this.rawData[5]-this.rawData[4]*this.rawData[1])*(this.rawData[10]*this.rawData[15]-this.rawData[14]*this.rawData[11])-(this.rawData[0]*this.rawData[9]-this.rawData[8]*this.rawData[1])*(this.rawData[6]*this.rawData[15]-this.rawData[14]*this.rawData[7])+(this.rawData[0]*this.rawData[13]-this.rawData[12]*this.rawData[1])*(this.rawData[6]*this.rawData[11]-this.rawData[10]*this.rawData[7])+(this.rawData[4]*this.rawData[9]-this.rawData[8]*this.rawData[5])*(this.rawData[2]*this.rawData[15]-this.rawData[14]*this.rawData[3])-(this.rawData[4]*this.rawData[13]-this.rawData[12]*this.rawData[5])*(this.rawData[2]*this.rawData[11]-this.rawData[10]*this.rawData[3])+(this.rawData[8]*this.rawData[13]-this.rawData[12]*this.rawData[9])*(this.rawData[2]*this.rawData[7]-this.rawData[6]*this.rawData[3])},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"position",{get:function(){return new s(this.rawData[12],this.rawData[13],this.rawData[14])},set:function(t){this.rawData[12]=t.x;this.rawData[13]=t.y;this.rawData[14]=t.z},enumerable:true,configurable:true});t.prototype.toFixed=function(t){var e=Math.pow(10,t);return"matrix3d("+Math.round(this.rawData[0]*e)/e+","+Math.round(this.rawData[1]*e)/e+","+Math.round(this.rawData[2]*e)/e+","+Math.round(this.rawData[3]*e)/e+","+Math.round(this.rawData[4]*e)/e+","+Math.round(this.rawData[5]*e)/e+","+Math.round(this.rawData[6]*e)/e+","+Math.round(this.rawData[7]*e)/e+","+Math.round(this.rawData[8]*e)/e+","+Math.round(this.rawData[9]*e)/e+","+Math.round(this.rawData[10]*e)/e+","+Math.round(this.rawData[11]*e)/e+","+Math.round(this.rawData[12]*e)/e+","+Math.round(this.rawData[13]*e)/e+","+Math.round(this.rawData[14]*e)/e+","+Math.round(this.rawData[15]*e)/e+")"};t.prototype.toString=function(){return"matrix3d("+Math.round(this.rawData[0]*1e3)/1e3+","+Math.round(this.rawData[1]*1e3)/1e3+","+Math.round(this.rawData[2]*1e3)/1e3+","+Math.round(this.rawData[3]*1e3)/1e3+","+Math.round(this.rawData[4]*1e3)/1e3+","+Math.round(this.rawData[5]*1e3)/1e3+","+Math.round(this.rawData[6]*1e3)/1e3+","+Math.round(this.rawData[7]*1e3)/1e3+","+Math.round(this.rawData[8]*1e3)/1e3+","+Math.round(this.rawData[9]*1e3)/1e3+","+Math.round(this.rawData[10]*1e3)/1e3+","+Math.round(this.rawData[11]*1e3)/1e3+","+Math.round(this.rawData[12]*1e3)/1e3+","+Math.round(this.rawData[13]*1e3)/1e3+","+Math.round(this.rawData[14]*1e3)/1e3+","+Math.round(this.rawData[15]*1e3)/1e3+")"};t.tempMatrix=new t;t.tempRawData=t.tempMatrix.rawData;return t}();e.exports=o},{"awayjs-core/lib/errors/ArgumentError":"awayjs-core/lib/errors/ArgumentError","awayjs-core/lib/geom/Box":"awayjs-core/lib/geom/Box","awayjs-core/lib/geom/Orientation3D":"awayjs-core/lib/geom/Orientation3D","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D"}],"awayjs-core/lib/geom/Matrix":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=t("awayjs-core/lib/errors/ArgumentError");var s=function(){function t(t,e,i,r,a,s){if(t===void 0){t=1}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}if(a===void 0){a=0}if(s===void 0){s=0}this.a=t;this.b=e;this.c=i;this.d=r;this.tx=a;this.ty=s}t.prototype.clone=function(){return new t(this.a,this.b,this.c,this.d,this.tx,this.ty)};t.prototype.concat=function(t){var e=this.a*t.a+this.b*t.c;this.b=this.a*t.b+this.b*t.d;this.a=e;var i=this.c*t.a+this.d*t.c;this.d=this.c*t.b+this.d*t.d;this.c=i;var r=this.tx*t.a+this.ty*t.c+t.tx;this.ty=this.tx*t.b+this.ty*t.d+t.ty;this.tx=r};t.prototype.copyColumnFrom=function(t,e){if(t>2){throw"Column "+t+" out of bounds (2)"}else if(t==0){this.a=e.x;this.c=e.y}else if(t==1){this.b=e.x;this.d=e.y}else{this.tx=e.x;this.ty=e.y}};t.prototype.copyColumnTo=function(t,e){if(t>2){throw new a("ArgumentError, Column "+t+" out of bounds [0, ..., 2]")}else if(t==0){e.x=this.a;e.y=this.c;e.z=0}else if(t==1){e.x=this.b;e.y=this.d;e.z=0}else{e.x=this.tx;e.y=this.ty;e.z=1}};t.prototype.copyFrom=function(t){this.a=t.a;this.b=t.b;this.c=t.c;this.d=t.d;this.tx=t.tx;this.ty=t.ty};t.prototype.copyRowFrom=function(t,e){if(t>2){throw new a("ArgumentError, Row "+t+" out of bounds [0, ..., 2]")}else if(t==0){this.a=e.x;this.c=e.y}else if(t==1){this.b=e.x;this.d=e.y}else{this.tx=e.x;this.ty=e.y}};t.prototype.copyRowTo=function(t,e){if(t>2){throw new a("ArgumentError, Row "+t+" out of bounds [0, ..., 2]")}else if(t==0){e.x=this.a;e.y=this.b;e.z=this.tx}else if(t==1){e.x=this.c;e.y=this.d;e.z=this.ty}else{e.setTo(0,0,1)}};t.prototype.createBox=function(t,e,i,r,a){if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=t;this.d=e;this.b=i;this.tx=r;this.ty=a};t.prototype.createGradientBox=function(t,e,i,r,a){if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=t/1638.4;this.d=e/1638.4;if(i!=0){var s=Math.cos(i);var n=Math.sin(i);this.b=n*this.d;this.c=-n*this.a;this.a*=s;this.d*=s}else{this.b=this.c=0}this.tx=r+t/2;this.ty=a+e/2};t.prototype.deltaTransformPoint=function(t){return new r(t.x*this.a+t.y*this.c,t.x*this.b+t.y*this.d)};t.prototype.identity=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0};t.prototype.invert=function(){var t=this.a*this.d-this.b*this.c;if(t==0){this.a=this.b=this.c=this.d=0;this.tx=-this.tx;this.ty=-this.ty}else{t=1/t;var e=this.d*t;this.d=this.a*t;this.a=e;this.b*=-t;this.c*=-t;var i=-this.a*this.tx-this.c*this.ty;this.ty=-this.b*this.tx-this.d*this.ty;this.tx=i}};t.prototype.multiply=function(e){var i=new t;i.a=this.a*e.a+this.b*e.c;i.b=this.a*e.b+this.b*e.d;i.c=this.c*e.a+this.d*e.c;i.d=this.c*e.b+this.d*e.d;i.tx=this.tx*e.a+this.ty*e.c+e.tx;i.ty=this.tx*e.b+this.ty*e.d+e.ty;return i};t.prototype.rotate=function(t){var e=Math.cos(t);var i=Math.sin(t);var r=this.a*e-this.b*i;this.b=this.a*i+this.b*e;this.a=r;var a=this.c*e-this.d*i;this.d=this.c*i+this.d*e;this.c=a;var s=this.tx*e-this.ty*i;this.ty=this.tx*i+this.ty*e;this.tx=s};t.prototype.scale=function(t,e){this.a*=t;this.b*=e;this.c*=t;this.d*=e;this.tx*=t;this.ty*=e};t.prototype.setTo=function(t,e,i,r,a,s){this.a=t;this.b=e;this.c=i;this.d=r;this.tx=a;this.ty=s};t.prototype.toString=function(){return"[Matrix] (a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"};t.prototype.transformPoint=function(t){return new r(t.x*this.a+t.y*this.c+this.tx,t.x*this.b+t.y*this.d+this.ty)};t.prototype.translate=function(t,e){this.tx+=t;this.ty+=e};return t}();e.exports=s},{"awayjs-core/lib/errors/ArgumentError":"awayjs-core/lib/errors/ArgumentError","awayjs-core/lib/geom/Point":"awayjs-core/lib/geom/Point"}],"awayjs-core/lib/geom/Orientation3D":[function(t,e,i){var r=function(){function t(){}t.AXIS_ANGLE="axisAngle";t.EULER_ANGLES="eulerAngles";t.QUATERNION="quaternion";return t}();e.exports=r},{}],"awayjs-core/lib/geom/PerspectiveProjection":[function(t,e,i){var r=function(){function t(){}t.prototype.toMatrix3D=function(){return this._matrix3D};return t}();e.exports=r},{}],"awayjs-core/lib/geom/Plane3D":[function(t,e,i){var r=t("awayjs-core/lib/geom/PlaneClassification");var a=function(){function t(e,i,r,a){if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}if(a===void 0){a=0}this.a=e;this.b=i;this.c=r;this.d=a;if(e==0&&i==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(i==0&&r==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(e==0&&r==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}}t.prototype.fromPoints=function(e,i,r){var a=i.x-e.x;var s=i.y-e.y;var n=i.z-e.z;var o=r.x-e.x;var h=r.y-e.y;var u=r.z-e.z;this.a=s*u-n*h;this.b=n*o-a*u;this.c=a*h-s*o;this.d=this.a*e.x+this.b*e.y+this.c*e.z;if(this.a==0&&this.b==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(this.b==0&&this.c==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(this.a==0&&this.c==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}};t.prototype.fromNormalAndPoint=function(e,i){this.a=e.x;this.b=e.y;this.c=e.z;this.d=this.a*i.x+this.b*i.y+this.c*i.z;if(this.a==0&&this.b==0){this._iAlignment=t.ALIGN_XY_AXIS}else if(this.b==0&&this.c==0){this._iAlignment=t.ALIGN_YZ_AXIS}else if(this.a==0&&this.c==0){this._iAlignment=t.ALIGN_XZ_AXIS}else{this._iAlignment=t.ALIGN_ANY}};t.prototype.normalize=function(){var t=1/Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a*=t;this.b*=t;this.c*=t;this.d*=t;return this};t.prototype.distance=function(e){if(this._iAlignment==t.ALIGN_YZ_AXIS){return this.a*e.x-this.d}else if(this._iAlignment==t.ALIGN_XZ_AXIS){return this.b*e.y-this.d}else if(this._iAlignment==t.ALIGN_XY_AXIS){return this.c*e.z-this.d}else{return this.a*e.x+this.b*e.y+this.c*e.z-this.d}};t.prototype.classifyPoint=function(e,i){if(i===void 0){i=.01}if(this.d!=this.d)return r.FRONT;var a;if(this._iAlignment==t.ALIGN_YZ_AXIS)a=this.a*e.x-this.d;else if(this._iAlignment==t.ALIGN_XZ_AXIS)a=this.b*e.y-this.d;else if(this._iAlignment==t.ALIGN_XY_AXIS)a=this.c*e.z-this.d;else a=this.a*e.x+this.b*e.y+this.c*e.z-this.d;if(a<-i)return r.BACK;else if(a>i)return r.FRONT;else return r.INTERSECT};t.prototype.toString=function(){return"Plane3D [a:"+this.a+", b:"+this.b+", c:"+this.c+", d:"+this.d+"]"};t.ALIGN_ANY=0;t.ALIGN_XY_AXIS=1;t.ALIGN_YZ_AXIS=2;t.ALIGN_XZ_AXIS=3;return t}();e.exports=a},{"awayjs-core/lib/geom/PlaneClassification":"awayjs-core/lib/geom/PlaneClassification"}],"awayjs-core/lib/geom/PlaneClassification":[function(t,e,i){var r=function(){function t(){}t.BACK=0;t.FRONT=1;t.IN=0;t.OUT=1;t.INTERSECT=2;return t}();e.exports=r},{}],"awayjs-core/lib/geom/Point":[function(t,e,i){var r=function(){function t(t,e){if(t===void 0){t=0}if(e===void 0){e=0}this.x=t;this.y=e}Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:true,configurable:true});t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)};t.prototype.clone=function(){return new t(this.x,this.y)};t.prototype.copyFrom=function(t){};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y};t.prototype.normalize=function(t){if(t===void 0){t=1}if(this.length!=0){var e=t/this.length;this.x*=e;this.y*=e;return}throw"Cannot divide by zero length."};t.prototype.offset=function(t,e){this.x+=t;this.y+=e};t.prototype.setTo=function(t,e){this.x=t;this.y=e};t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)};t.prototype.toString=function(){return"[Point] (x="+this.x+", y="+this.y+")"};t.distance=function(t,e){var i=e.x-t.x;var r=e.y-t.y;return Math.sqrt(i*i+r*r)};t.interpolate=function(e,i,r){return new t(i.x+(e.x-i.x)*r,i.y+(e.y-i.y)*r)};t.polar=function(e,i){return new t(e*Math.cos(i),e*Math.sin(i))};return t}();e.exports=r},{}],"awayjs-core/lib/geom/PoissonLookup":[function(t,e,i){var r=function(){function t(){}t.initDistributions=function(){this._distributions=new Array;this._distributions[0]=new Array(.3082841,.4320919);this._distributions[1]=new Array(.3082841,.4320919,-.2274942,-.6640266);this._distributions[2]=new Array(.8742689,.0009265686,-.6864116,-.5536607,-.2325206,.7678371);this._distributions[3]=new Array(.3913446,-.7084417,-.7511101,-.5935929,-.2323436,.5320091,.8435315,.5035911);this._distributions[4]=new Array(.2122471,-.5771395,-.8543506,-.1763534,.5189021,.8323698,-.3616908,.5865368,.9523004,-.04948437);this._distributions[5]=new Array(.5791035,.3496495,.2959551,-.6006749,-.2419119,-.06879545,-.7403072,.6110353,-.04555973,.8059174,-.5275017,-.737129);this._distributions[6]=new Array(.06941478,.8519508,-.7441907,.2426432,.6439992,-.2405252,-.1007523,-.2327587,-.6427067,-.7248485,.8050759,.5492936,.3573822,-.8824506);this._distributions[7]=new Array(.8509863,.4452587,-.09507271,.2073005,.1706571,-.6434793,.8029777,-.2718274,-.4401725,.8196304,.2715359,.8598521,-.8121575,-.006447683,-.6486837,-.7237598);this._distributions[8]=new Array(.6951686,-.2680728,-.04933243,.3710589,.6592212,.3661054,-.01579228,-.6909603,-.3275101,-.1756866,.3811549,.9218544,-.216032,.9755028,-.7065172,.3355389,-.6579109,-.6798355);this._distributions[9]=new Array(.6181276,-.09790418,-.2537868,-.5570995,-.1964931,.3459414,.3474613,-.8885581,.5135743,.5753114,-.9549091,.1480672,-.8711916,-.4293123,-.6928071,.6190156,-.13369,.8892705,.0548224,-.1246777);this._distributions[10]=new Array(.4853027,-.5080479,-.1331675,-.506597,.139575,.01316885,.803486,-.07568797,.5240274,.4883182,-.4334005,.1207938,-.7794577,-.3985141,.1576432,-.9861221,-.3712867,.6959021,.1517378,.9847429,-.9762396,.1661073);this._distributions[11]=new Array(-.2790166,-.01252619,.3389016,.3921154,.2408341,-.313211,-.8151779,-.3898362,-.6347761,.3486495,.09471484,-.7722448,-.1385674,.6364574,.2456331,.9295807,-.3864306,-.8247881,.6111673,-.7164014,.8287669,.05466961,.837706,.5415626);this._distributions[12]=new Array(.056417,.3185693,-.8245888,.1882799,.8575996,.1136829,.1070375,.875332,.4076743,-.06000621,-.4311306,.7239349,.2677574,-.538472,-.08486642,-.2083647,-.888989,-.3906443,-.4768958,-.6664082,.09334993,-.9861541,.808736,-.455949,.5889823,.7660807);this._distributions[13]=new Array(-.2681346,-.3955857,-.1315102,-.8852947,-.5143692,.09551838,.4344836,-.546945,-.8620899,-.3813288,.1650431,.02034803,-.1543657,.3842218,-.828457,.5376903,-.6145,-.7818927,-.2639062,.8784655,.1912684,.9720125,.3135219,.5224229,.7850655,.4592297,.7465045,-.1368916);this._distributions[14]=new Array(.4241029,.695281,.150511,-.02304107,-.2482675,.9120338,.8057325,.2622084,-.2445909,.2765962,.8588713,-.1772072,.3117845,-.4385471,-.3923851,-.3298936,-.1751254,-.7405846,.6926506,-.684163,-.9304563,-.3254691,-.8533293,.1523024,.2510415,-.917345,-.6239773,-.7105472,-.6104624,.6041355);this._distributions[15]=new Array(.5844554,.06651045,.1343258,.6756578,.3799674,-.6301104,.5590436,.7940555,.09574714,.02262517,.8697868,.393301,.003945862,-.421735,.9043913,-.2432393,-.4844007,.7190998,-.3201078,.2972371,-.3852352,-.6341155,-.5413069,-.09223081,-.8468984,-.5126905,.004156174,-.8633173,-.9681889,-.03305046,-.846509,.4414353);this._distributions[16]=new Array(.4506488,.657668,.4621297,.07441051,-.2782125,.6201044,.9750003,.09110117,.1019436,.2986514,.03457398,.9631706,.542098,-.5505635,.8675668,.4938077,-.5414361,.2655292,-.7941836,.6003053,-.09847672,-.1001604,-.9316511,-.08572888,.07286467,-.611899,-.5232627,-.4082253,-.5481608,-.827938,-.1551939,-.9621193,.9220031,-.3315949);this._distributions[17]=new Array(.197908,-.4697656,-.4474689,-.3428435,.8529873,-.2228634,.6022478,-.5469642,.2545276,-.931133,-.1507547,-.7855865,-.07606658,.1011628,.3046715,.2785755,.4698432,-.1064076,.6831254,.4152522,.1374381,.8363233,-.2166121,.6682042,.5511393,.7996449,-.4278994,.28836,-.8875198,.2181732,-.8772842,-.2818254,-.7000262,.5762185,-.6062385,-.7439126);this._distributions[18]=new Array(.6645703,-.05678739,.5720971,.4533803,-.07660709,.08802763,.5163431,-.4426552,.1163455,-.3404382,-.4004807,-.5046007,.2932099,-.8201418,-.5322125,.03834766,-.1490209,-.8817304,-.8000439,-.3509448,.5260983,.8421043,.1197811,.6963812,.9498612,.3122156,-.9285746,.02120355,-.6670724,.7217396,.9155889,-.3510147,-.271941,.4727852,.318879,.1634057,-.2686755,.9253026);this._distributions[19]=new Array(.5064292,.422527,.8935515,-.06610427,.1199719,.175568,.403388,-.2003276,.1657927,.8154403,.9301245,.2929218,-.1644068,.6201534,.7113559,-.6589743,-.3364046,-.1799502,.02109996,-.392765,-.382213,.3219992,-.9201946,.1207967,-.726185,.4291916,-.7443482,-.2480059,-.5147594,.7418784,.1935272,-.7406143,-.3643523,-.5559214,-.7147766,-.6326278,-.2524151,-.9096627,.5161405,.7908453);this._distributions[20]=new Array(.7921003,-.3032096,.5992879,-.009052323,.2538549,-.1872749,.7053444,.3677175,.5417761,-.8170255,.9749611,.1210478,.1969143,-.6117041,-.1824499,-.4634196,-.1181338,-.8668742,-.3050112,-.1352596,-.4409327,-.7082354,-.03225285,.1171548,.3113096,.3250439,-.8166144,-.463995,-.01014475,.4715334,-.6868284,.05091889,-.4011163,.2717285,-.06756835,.8307694,-.7938535,.4352129,-.4663842,.7165329,.559729,.8093995);this._distributions[21]=new Array(.07832243,.426151,-.3856795,.5799953,.01970797,.06706189,.4822682,.3014512,-.1532982,.87485,-.4959527,.07888043,.260601,-.2304784,.4996209,.7167382,.585986,-.04265174,-.7679967,.5509416,-.9041753,.1802134,-.8407655,-.4442826,-.2058258,-.2636995,-.4984115,-.5928579,.2926032,-.7886473,-.06933882,-.621177,.578115,-.4813387,.8981777,-.3291056,.1942733,.9255584,.8084362,.5066984,.9920095,.03103104,-.2403206,-.9389018);this._distributions[22]=new Array(-.5691095,.1014316,-.7788262,.384012,-.8253665,-.1645582,-.1830993,.002997211,-.2555013,-.4177977,-.6640869,-.4794711,-.2351242,.5850121,.02436554,.2825883,.006061143,-.8200245,.1618791,-.3063331,-.3765897,-.7249815,.6092919,-.6769328,-.5956934,.6957655,.5383642,.4522677,-.1489165,.9125596,.4167473,.1335986,.1898309,.5874342,.2288171,.9624356,.7540846,-.07672304,.8986252,.2788797,.3555991,-.9262139,.8454325,-.4027667,.4945236,-.2935512);
this._distributions[23]=new Array(-.4481403,-.3758374,-.8877251,.08739938,.05015831,-.1339983,-.4070427,-.8534173,.1019274,-.5503222,-.445998,.1997541,-.8686263,-.2788867,-.7695944,-.6033704,-.05515742,-.885711,-.7714347,.5790485,.3466263,-.8799297,.4487582,-.5321087,-.2461368,.6053771,-.05568117,.2457351,-.4668669,.8523816,.8103387,-.4255538,.4054182,-.175663,-.2802011,-.08920153,.2665959,.382935,.555679,.1621837,.105246,.8420411,.6921161,.6902903,.880946,.2483067,.9699264,-.1021767);this._distributions[24]=new Array(-.1703323,-.3119385,.2916039,-.2988263,-.008472982,-.9277695,-.7730271,-.3277904,.3440474,-.6815342,-.2910278,.03461745,-.6764899,-.657078,-.3505501,-.7311988,-.03478927,.3258755,-.6048835,.159423,.2035525,.02212214,.5116573,.2226856,.6664805,-.2500189,.7147882,-.6609634,.03030632,-.5763278,-.2516585,.6116219,-.9434413,-.0116792,.9061816,.2491155,.182867,.6076167,.286593,.9485695,-.5992439,.6970096,-.2082874,.9416641,.9880044,-.1541709,-.9122881,.331555,.7324886,.6725098);this._distributions[25]=new Array(.3869598,-.04974834,.7168844,-.0693711,-.07166742,.1725325,.4599592,.3232779,.5872094,-.4198674,.2442266,-.625667,.1254557,.4500048,-.2290154,-.1803567,.890583,.3373493,.1256081,.7853789,-.2676466,.5305805,-.7063224,.252168,-.3989835,.1189921,.09617215,-.2451447,.6302541,.6085876,.9380925,-.3234899,.5086241,-.8573482,.03576187,-.9876697,-.0876712,-.6365195,-.5276513,.823456,-.6935764,-.2240411,-.5212318,-.5383121,-.2116208,.9639363,-.9840096,.02743555,-.3991577,-.8994547,-.7830126,.614068);this._distributions[26]=new Array(-.8366601,.4464895,-.5917366,-.02073906,-.9845258,.1635625,-.3097973,.4379579,-.5478154,.7173221,-.1685888,.9261969,.01503595,.6046097,.4452421,.5449086,.0315687,.1944619,.3753404,.8688548,.4143643,.1396648,.8711032,.4304703,.7328773,.1461501,.6374492,-.3521495,.145613,-.1341466,.9040975,-.135123,-.7839059,-.5450199,-.516019,-.3320859,-.206158,-.4431106,-.9703014,-.2368356,-.2473119,-.0864351,.2130725,-.4604077,-.003726701,-.7122303,-.4072131,-.6833169,.1632999,-.9776646,.4686888,-.680495,-.2293511,-.9509777);this._distributions[27]=new Array(.107311,-.1311369,-.4194764,-.3148777,.6171439,-.2745973,.2796618,.1937153,-.09106886,.4180236,.6044006,.05577846,.02927299,-.6738263,-.2580845,.1179939,-.09023564,-.3830024,.3570953,-.5000587,.81591,-.5518309,.9300217,-.1257987,.4904627,-.8381903,-.3163182,-.8632009,.1137595,-.9875998,.8390043,.3538185,.2149114,.4993694,.5191584,.3833552,.5002763,.7061465,-.2567276,.9068756,-.5197366,.3467845,.03668867,.9734009,-.5347553,.66747,-.9028882,.1023768,-.8967977,.412834,-.5821944,.0426479,-.8032165,-.2397038,-.5597343,-.6358021);this._distributions[28]=new Array(-.6562496,-.1781036,-.9301494,.1185208,-.3861143,-.4153562,-.1560799,-.1099607,-.5587025,.395218,-.5322112,-.699701,-.5008639,.08726846,-.970524,-.1963461,-.813577,-.5185111,-.1644458,.298,-.3216791,.639982,.3315373,.3339162,.2383235,-.00105722,.1137828,.5450742,-.01899921,.8798413,.2849685,.8255596,.6974412,.2123175,.7588523,.5470437,.5102502,-.1687844,.5853448,.8033476,.2590716,-.5262504,.5607718,-.6342825,.8666443,-.1491841,.8341052,-.4935003,-.1568441,-.6634066,.2512113,-.8769391,-.2559827,-.9572457,-.01928852,-.3966542,-.750667,.6409678);this._distributions[29]=new Array(.3454786,-.04837726,.2649553,.2406852,.5599093,-.3839145,-.1111814,-.05502108,.7586042,-.05818377,.2519488,-.4665135,-.1264972,.2602723,-.08766216,-.3671907,.6428129,.3999204,-.6105871,-.1246869,-.4589451,-.7646643,-.03021116,-.7899352,-.6036922,-.4293956,-.2481938,.6534185,.102798,.6784465,-.6392644,.4821358,-.6789002,.1779133,-.9140783,-.1989647,-.9262617,.3381507,.4794891,-.8093274,.3959447,.668478,.9602883,.2272305,-.123672,.9210883,.2375148,.9523395,-.52898,.7973378,-.382433,.1228794,.695015,.6948439,.7530277,-.6458191,.8777987,-.3272956,.2318525,-.962768);this._distributions[30]=new Array(.4518921,-.1146195,.4720805,-.4238748,.3655423,.1806341,.1589939,-.23568,.7673324,-.5149941,.01163658,.09045836,.7010971,.1245747,.7518286,-.1855433,.4960719,.4601022,.2566979,-.6308268,-.0654714,-.5126389,-.1823319,-.1343282,-.1464312,.4883236,-.3858738,.203523,.1484799,.4432284,-.477109,-.116241,.2719092,.7208626,.9104174,.3578536,-.5956199,.7662588,-.6996251,.3678654,-.2514512,.9251933,.1275825,-.9478135,-.204608,-.8611552,.4264838,-.877443,.9854161,.05521112,.5912951,.7997434,.1140349,.982093,-.9324368,-.2094094,-.42436,-.6441524,-.6722705,-.3554261,-.7844236,.08587621);this._distributions[31]=new Array(-.4206714,-.5613642,-.8733016,-.3373051,-.1046226,-.2902999,-.1318562,-.8434365,.1145093,-.5962623,-.4965627,-.1873259,-.5011808,-.8546229,-.7165636,-.5743566,.1090901,.2017643,.3404809,-.220455,-.1989015,.2372122,-.4538706,.0979171,.4514146,-.572846,.2314168,-.8514503,-.4247236,.5650803,-.943347,.04514639,-.1309718,.5221877,-.7004157,.4561877,.6306441,.04448673,.4301621,.5766876,.1078042,.7245752,.3875354,.2794483,.702876,-.2924213,.7360667,-.6210318,.7486517,.6531103,.4898235,.8591025,.6549174,.3854057,-.2596106,.7916998,.9251194,-.05296265,-.5620695,.820877,-.01228026,.9937211,.9612103,.2628758)};t.getDistribution=function(t){if(!this._distributions)this.initDistributions();if(t<2||t>32)return null;return this._distributions[t-1]};return t}();e.exports=r},{}],"awayjs-core/lib/geom/Quaternion":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3DUtils");var a=t("awayjs-core/lib/geom/Orientation3D");var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Vector3D");var o=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=1}this.x=0;this.y=0;this.z=0;this.w=1;this.x=t;this.y=e;this.z=i;this.w=r}Object.defineProperty(t.prototype,"magnitude",{get:function(){return Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:true,configurable:true});t.prototype.multiply=function(t,e){var i=t.w,r=t.x,a=t.y,s=t.z;var n=e.w,o=e.x,h=e.y,u=e.z;this.w=i*n-r*o-a*h-s*u;this.x=i*o+r*n+a*u-s*h;this.y=i*h-r*u+a*n+s*o;this.z=i*u+r*h-a*o+s*n};t.prototype.multiplyVector=function(e,i){if(i===void 0){i=null}if(i===null){i=new t}var r=e.x;var a=e.y;var s=e.z;i.w=-this.x*r-this.y*a-this.z*s;i.x=this.w*r+this.y*s-this.z*a;i.y=this.w*a-this.x*s+this.z*r;i.z=this.w*s+this.x*a-this.y*r;return i};t.prototype.fromAxisAngle=function(t,e){var i=Math.sin(e/2);var r=Math.cos(e/2);this.x=t.x*i;this.y=t.y*i;this.z=t.z*i;this.w=r;this.normalize()};t.prototype.slerp=function(t,e,i){var r=t.w,a=t.x,s=t.y,n=t.z;var o=e.w,h=e.x,u=e.y,c=e.z;var p=r*o+a*h+s*u+n*c;if(p<0){p=-p;o=-o;h=-h;u=-u;c=-c}if(p<.95){var l=Math.acos(p);var f=1/Math.sin(l);var y=Math.sin(l*(1-i))*f;var _=Math.sin(l*i)*f;this.w=r*y+o*_;this.x=a*y+h*_;this.y=s*y+u*_;this.z=n*y+c*_}else{this.w=r+i*(o-r);this.x=a+i*(h-a);this.y=s+i*(u-s);this.z=n+i*(c-n);var d=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=d;this.x*=d;this.y*=d;this.z*=d}};t.prototype.lerp=function(t,e,i){var r=t.w,a=t.x,s=t.y,n=t.z;var o=e.w,h=e.x,u=e.y,c=e.z;var p;if(r*o+a*h+s*u+n*c<0){o=-o;h=-h;u=-u;c=-c}this.w=r+i*(o-r);this.x=a+i*(h-a);this.y=s+i*(u-s);this.z=n+i*(c-n);p=1/Math.sqrt(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);this.w*=p;this.x*=p;this.y*=p;this.z*=p};t.prototype.fromEulerAngles=function(t,e,i){var r=t*.5,a=e*.5,s=i*.5;var n=Math.cos(r),o=Math.sin(r);var h=Math.cos(a),u=Math.sin(a);var c=Math.cos(s),p=Math.sin(s);this.w=n*h*c+o*u*p;this.x=o*h*c-n*u*p;this.y=n*u*c+o*h*p;this.z=n*h*p-o*u*c};t.prototype.toEulerAngles=function(t){if(t===void 0){t=null}if(t===null){t=new n}t.x=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y));t.y=Math.asin(2*(this.w*this.y-this.z*this.x));t.z=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return t};t.prototype.normalize=function(t){if(t===void 0){t=1}var e=t/Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);this.x*=e;this.y*=e;this.z*=e;this.w*=e};t.prototype.toString=function(){return"{x:"+this.x+" y:"+this.y+" z:"+this.z+" w:"+this.w+"}"};t.prototype.toMatrix3D=function(t){if(t===void 0){t=null}var e=r.RAW_DATA_CONTAINER;var i=2*this.x*this.y,a=2*this.x*this.z,n=2*this.x*this.w;var o=2*this.y*this.z,h=2*this.y*this.w,u=2*this.z*this.w;var c=this.x*this.x,p=this.y*this.y,l=this.z*this.z,f=this.w*this.w;e[0]=c-p-l+f;e[4]=i-u;e[8]=a+h;e[12]=0;e[1]=i+u;e[5]=-c+p-l+f;e[9]=o-n;e[13]=0;e[2]=a-h;e[6]=o+n;e[10]=-c-p+l+f;e[14]=0;e[3]=0;e[7]=0;e[11]=0;e[15]=1;if(!t)return new s(e);else t.copyRawDataFrom(e);return t};t.prototype.fromMatrix=function(t){var e=t.decompose(a.QUATERNION)[1];this.x=e.x;this.y=e.y;this.z=e.z;this.w=e.w};t.prototype.toRawData=function(t,e){if(e===void 0){e=false}var i=2*this.x*this.y,r=2*this.x*this.z,a=2*this.x*this.w;var s=2*this.y*this.z,n=2*this.y*this.w,o=2*this.z*this.w;var h=this.x*this.x,u=this.y*this.y,c=this.z*this.z,p=this.w*this.w;t[0]=h-u-c+p;t[1]=i-o;t[2]=r+n;t[4]=i+o;t[5]=-h+u-c+p;t[6]=s-a;t[8]=r-n;t[9]=s+a;t[10]=-h-u+c+p;t[3]=t[7]=t[11]=0;if(!e){t[12]=t[13]=t[14]=0;t[15]=1}};t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)};t.prototype.rotatePoint=function(t,e){if(e===void 0){e=null}var i,r,a,s;var o=t.x,h=t.y,u=t.z;if(e===null){e=new n}s=-this.x*o-this.y*h-this.z*u;i=this.w*o+this.y*u-this.z*h;r=this.w*h-this.x*u+this.z*o;a=this.w*u+this.x*h-this.y*o;e.x=-s*this.x+i*this.w-r*this.z+a*this.y;e.y=-s*this.y+i*this.z+r*this.w-a*this.x;e.z=-s*this.z-i*this.y+r*this.x+a*this.w;return e};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w};return t}();e.exports=o},{"awayjs-core/lib/geom/Matrix3D":"awayjs-core/lib/geom/Matrix3D","awayjs-core/lib/geom/Matrix3DUtils":"awayjs-core/lib/geom/Matrix3DUtils","awayjs-core/lib/geom/Orientation3D":"awayjs-core/lib/geom/Orientation3D","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D"}],"awayjs-core/lib/geom/Rectangle":[function(t,e,i){var r=t("awayjs-core/lib/geom/Point");var a=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this.x=t;this.y=e;this.width=i;this.height=r}Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bottomRight",{get:function(){if(this._bottomRight==null)this._bottomRight=new r;this._bottomRight.x=this.x+this.width;this._bottomRight.y=this.y+this.height;return this._bottomRight},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"size",{get:function(){if(this._size==null)this._size=new r;this._size.x=this.width;this._size.y=this.height;return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"topLeft",{get:function(){if(this._topLeft==null)this._topLeft=new r;this._topLeft.x=this.x;this._topLeft.y=this.y;return this._topLeft},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)};t.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e};t.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y};t.prototype.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height};t.prototype.copyFrom=function(t){};t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height};t.prototype.inflate=function(t,e){this.x-=t/2;this.y-=e/2;this.width+=t/2;this.height+=e/2};t.prototype.inflatePoint=function(t){this.x-=t.x/2;this.y-=t.y/2;this.width+=t.x/2;this.height+=t.y/2};t.prototype.intersection=function(e){if(this.intersects(e)){var i=new t;if(this.x>e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width>this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width>e.width)i.width=e.width}if(this.y>e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height>this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height>e.height)i.height=e.height}return i}return new t};t.prototype.intersects=function(t){return this.x+this.width>t.x&&this.x<t.x+t.width&&this.y+this.height>t.y&&this.y<t.y+t.height};t.prototype.isEmpty=function(){return this.x==0&&this.y==0&&this.width==0&&this.height==0};t.prototype.offset=function(t,e){this.x+=t;this.y+=e};t.prototype.offsetPoint=function(t){this.x+=t.x;this.y+=t.y};t.prototype.setEmpty=function(){this.x=0;this.y=0;this.width=0;this.height=0};t.prototype.setTo=function(t,e,i,r){this.x=t;this.y=e;this.width=i;this.height=r};t.prototype.toString=function(){return"[Rectangle] (x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"};t.prototype.union=function(e){var i=new t;if(this.x<e.x){i.x=this.x;i.width=e.x-this.x+e.width;if(i.width<this.width)i.width=this.width}else{i.x=e.x;i.width=this.x-e.x+this.width;if(i.width<e.width)i.width=e.width}if(this.y<e.y){i.y=this.y;i.height=e.y-this.y+e.height;if(i.height<this.height)i.height=this.height}else{i.y=e.y;i.height=this.y-e.y+this.height;if(i.height<e.height)i.height=e.height}return i};return t}();e.exports=a},{"awayjs-core/lib/geom/Point":"awayjs-core/lib/geom/Point"}],"awayjs-core/lib/geom/Sphere":[function(t,e,i){var r=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this.x=t;this.y=e;this.z=i;this.radius=r}t.prototype.rayIntersection=function(t,e,i){if(this.containsPoint(t))return 0;var r=t.x-this.x,a=t.y-this.y,s=t.z-this.z;var n=e.x,o=e.y,h=e.z;var u;var c=n*n+o*o+h*h;var p=2*(r*n+a*o+s*h);var l=r*r+a*a+s*s-this.radius*this.radius;var f=p*p-4*c*l;if(f>=0){var y=Math.sqrt(f);u=(-p-y)/(2*c);if(u>=0){i.x=r+u*n;i.y=a+u*o;i.z=s+u*h;i.normalize();return u}}return-1};t.prototype.containsPoint=function(t){var e=t.x-this.x;var i=t.y-this.y;var r=t.z-this.z;var a=Math.sqrt(e*e+i*i+r*r);return a<=this.radius};t.prototype.toString=function(){return"Sphere [x:"+this.x+", y:"+this.y+", z:"+this.z+", radius:"+this.radius+"]"};return t}();e.exports=r},{}],"awayjs-core/lib/geom/UVTransform":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix");var a=function(){function t(){this._uvMatrix=new r;this._rotation=0;this._scaleU=1;this._scaleV=1;this._offsetU=0;this._offsetV=0}Object.defineProperty(t.prototype,"offsetU",{get:function(){return this._offsetU},set:function(t){if(t==this._offsetU)return;this._offsetU=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"offsetV",{get:function(){return this._offsetV},set:function(t){if(t==this._offsetV)return;this._offsetV=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){if(t==this._rotation)return;this._rotation=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scaleU",{get:function(){return this._scaleU},set:function(t){if(t==this._scaleU)return;this._scaleU=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scaleV",{get:function(){return this._scaleV},set:function(t){if(t==this._scaleV)return;this._scaleV=t;this._uvMatrixDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"matrix",{get:function(){if(this._uvMatrixDirty)this.updateUVMatrix();return this._uvMatrix},enumerable:true,configurable:true});t.prototype.updateUVMatrix=function(){this._uvMatrix.identity();if(this._rotation!=0)this._uvMatrix.rotate(this._rotation);if(this._scaleU!=1||this._scaleV!=1)this._uvMatrix.scale(this._scaleU,this._scaleV);this._uvMatrix.translate(this._offsetU,this._offsetV);this._uvMatrixDirty=false};return t}();e.exports=a},{"awayjs-core/lib/geom/Matrix":"awayjs-core/lib/geom/Matrix"}],"awayjs-core/lib/geom/Vector3D":[function(t,e,i){var r=function(){function t(t,e,i,r){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(r===void 0){r=0}this.x=t;this.y=e;this.z=i;this.w=r}Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lengthSquared",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:true,configurable:true});t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)};t.angleBetween=function(t,e){return Math.acos(t.dotProduct(e)/(t.length*e.length))};t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)};t.combine=function(e,i,r,a){return new t(e.x*r+i.x*a,e.y*r+i.y*a,e.z*r+i.z*a)};t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w};t.prototype.crossProduct=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x,1)};t.prototype.decrementBy=function(t){this.x-=t.x;this.y-=t.y;this.z-=t.z};t.distance=function(t,e){var i=t.x-e.x;var r=t.y-e.y;var a=t.z-e.z;return Math.sqrt(i*i+r*r+a*a)};t.prototype.dotProduct=function(t){return this.x*t.x+this.y*t.y+this.z*t.z};t.prototype.equals=function(t,e){if(e===void 0){e=false}return this.x==t.x&&this.y==t.y&&this.z==t.z&&(!e||this.w==t.w)};t.prototype.incrementBy=function(t){this.x+=t.x;this.y+=t.y;this.z+=t.z};t.prototype.nearEquals=function(t,e,i){if(i===void 0){i=true}return Math.abs(this.x-t.x)<e&&Math.abs(this.y-t.y)<e&&Math.abs(this.z-t.z)<e&&(!i||Math.abs(this.w-t.w)<e)};t.prototype.negate=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z};t.prototype.normalize=function(t){if(t===void 0){t=1}if(this.length!=0){var e=t/this.length;this.x*=e;this.y*=e;this.z*=e;return}};t.prototype.project=function(){this.x/=this.w;this.y/=this.w;this.z/=this.w};t.prototype.scaleBy=function(t){this.x*=t;this.y*=t;this.z*=t};t.prototype.setTo=function(t,e,i){this.x=t;this.y=e;this.z=i};t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)};t.prototype.toString=function(){return"[Vector3D] (x:"+this.x+" ,y:"+this.y+", z"+this.z+", w:"+this.w+")"};t.X_AXIS=new t(1,0,0);t.Y_AXIS=new t(0,1,0);t.Z_AXIS=new t(0,0,1);return t}();e.exports=r},{}],"awayjs-core/lib/library/AssetBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/events/EventDispatcher");var o=function(t){r(e,t);function e(i){if(i===void 0){i=null}t.call(this);this._id=e.ID_COUNT++;if(i==null)i="null";this._name=i;this._originalName=i;this.updateFullPath()}Object.defineProperty(e.prototype,"assetType",{get:function(){throw new a},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originalName",{get:function(){return this._originalName},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){var e;e=this._name;this._name=t;if(this._name==null)this._name="null";this.updateFullPath();this.dispatchEvent(new s(s.ASSET_RENAME,this,e))},enumerable:true,configurable:true});e.prototype.dispose=function(){throw new a};Object.defineProperty(e.prototype,"assetNamespace",{get:function(){return this._namespace},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetFullPath",{get:function(){return this._full_path},enumerable:true,configurable:true});e.prototype.assetPathEquals=function(t,e){return this._name==t&&(!e||this._namespace==e)};e.prototype.isAsset=function(t){return this.assetType==t.assetType};e.prototype.resetAssetPath=function(t,i,r){if(i===void 0){i=null}if(r===void 0){r=true}this._name=t?t:"null";this._namespace=i?i:e.DEFAULT_NAMESPACE;if(r)this._originalName=this._name;this.updateFullPath()};e.prototype.updateFullPath=function(){this._full_path=[this._namespace,this._name]};e.ID_COUNT=0;e.DEFAULT_NAMESPACE="default";return e}(n);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":"awayjs-core/lib/errors/AbstractMethodError","awayjs-core/lib/events/AssetEvent":"awayjs-core/lib/events/AssetEvent","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher"}],"awayjs-core/lib/library/AssetLibraryBundle":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetLibraryIterator");var s=t("awayjs-core/lib/library/LoaderSession");var n=t("awayjs-core/lib/library/ConflictPrecedence");var o=t("awayjs-core/lib/library/ConflictStrategy");var h=t("awayjs-core/lib/library/AssetBase");var u=t("awayjs-core/lib/errors/Error");var c=t("awayjs-core/lib/events/AssetEvent");var p=t("awayjs-core/lib/events/IOErrorEvent");var l=t("awayjs-core/lib/events/LoaderEvent");var f=t("awayjs-core/lib/events/EventDispatcher");var y=t("awayjs-core/lib/events/ParserEvent");var _=function(t){r(e,t);function e(){var e=this;t.call(this);this._loaderSessionsGarbage=new Array;this._assets=new Array;this._assetDictionary=new Object;this._loaderSessions=new Array;this.conflictStrategy=o.IGNORE.create();this.conflictPrecedence=n.FAVOR_NEW;this._onAssetRenameDelegate=function(t){return e.onAssetRename(t)};this._onAssetConflictResolvedDelegate=function(t){return e.onAssetConflictResolved(t)};this._onResourceCompleteDelegate=function(t){return e.onResourceComplete(t)};this._onTextureSizeErrorDelegate=function(t){return e.onTextureSizeError(t)};this._onAssetCompleteDelegate=function(t){return e.onAssetComplete(t)};this._onLoadErrorDelegate=function(t){return e.onLoadError(t)};this._onParseErrorDelegate=function(t){return e.onParseError(t)}}e.getInstance=function(t){if(t===void 0){t="default"}if(!t)t="default";if(!e._iInstances.hasOwnProperty(t))e._iInstances[t]=new e;return e._iInstances[t]};e.prototype.enableParser=function(t){s.enableParser(t)};e.prototype.enableParsers=function(t){s.enableParsers(t)};Object.defineProperty(e.prototype,"conflictStrategy",{get:function(){return this._strategy},set:function(t){if(!t)throw new u("namingStrategy must not be null. To ignore naming, use AssetLibrary.IGNORE");this._strategy=t.create()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"conflictPrecedence",{get:function(){return this._strategyPreference},set:function(t){this._strategyPreference=t},enumerable:true,configurable:true});e.prototype.createIterator=function(t,e,i){if(t===void 0){t=null}if(e===void 0){e=null}if(i===void 0){i=null}return new a(this._assets,t,e,i)};e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this.getLoaderSession().load(t,e,i,r)};e.prototype.loadData=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this.getLoaderSession().loadData(t,"",e,i,r)};e.prototype.getLoaderSession=function(){var t=new s;this._loaderSessions.push(t);t.addEventListener(l.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);t.addEventListener(c.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);t.addEventListener(c.ASSET_COMPLETE,this._onAssetCompleteDelegate);t._iAddErrorHandler(this._onLoadErrorDelegate);t._iAddParseErrorHandler(this._onParseErrorDelegate);return t};e.prototype.disposeLoaderSession=function(t){var e=this;var i=this._loaderSessions.indexOf(t);this._loaderSessions.splice(i,1);this._loaderSessionsGarbage.push(t);this._gcTimeoutIID=setTimeout(function(){e.loaderSessionGC()},100)};e.prototype.getAsset=function(t,e){if(e===void 0){e=null}if(this._assetDictDirty)this.rehashAssetDict();if(e==null)e=h.DEFAULT_NAMESPACE;if(!this._assetDictionary.hasOwnProperty(e))return null;return this._assetDictionary[e][t]};e.prototype.addAsset=function(t){var e;var i;if(this._assets.indexOf(t)>=0)return;i=this.getAsset(t.name,t.assetNamespace);e=t.assetNamespace||h.DEFAULT_NAMESPACE;if(i!=null)this._strategy.resolveConflict(t,i,this._assetDictionary[e],this._strategyPreference);this._assets.push(t);if(!this._assetDictionary.hasOwnProperty(e))this._assetDictionary[e]=new Object;this._assetDictionary[e][t.name]=t;t.addEventListener(c.ASSET_RENAME,this._onAssetRenameDelegate);t.addEventListener(c.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate)};e.prototype.removeAsset=function(t,e){if(e===void 0){e=true}var i;this.removeAssetFromDict(t);t.removeEventListener(c.ASSET_RENAME,this._onAssetRenameDelegate);t.removeEventListener(c.ASSET_CONFLICT_RESOLVED,this._onAssetConflictResolvedDelegate);i=this._assets.indexOf(t);if(i>=0)this._assets.splice(i,1);if(e)t.dispose()};e.prototype.removeAssetByName=function(t,e,i){if(e===void 0){e=null}if(i===void 0){i=true}var r=this.getAsset(t,e);if(r)this.removeAsset(r,i);return r};e.prototype.removeAllAssets=function(t){if(t===void 0){t=true}if(t){var e;var i=this._assets.length;for(var r=0;r<i;r++){e=this._assets[r];e.dispose()}}this._assets.length=0;this.rehashAssetDict()};e.prototype.removeNamespaceAssets=function(t,e){if(t===void 0){t=null}if(e===void 0){e=true}var i=0;var r;var a;a=this._assets.concat();this._assets.length=0;if(t==null)t=h.DEFAULT_NAMESPACE;var s=a.length;for(var n=0;n<s;n++){r=a[n];if(r.assetNamespace==t){if(e)r.dispose();this.removeAssetFromDict(r,false)}else{this._assets[i++]=r}}if(this._assetDictionary.hasOwnProperty(t))delete this._assetDictionary[t]};e.prototype.removeAssetFromDict=function(t,e){if(e===void 0){e=true}if(this._assetDictDirty)this.rehashAssetDict();if(this._assetDictionary.hasOwnProperty(t.assetNamespace)){if(this._assetDictionary[t.assetNamespace].hasOwnProperty(t.name))delete this._assetDictionary[t.assetNamespace][t.name];if(e){var i;var r=true;for(i in this._assetDictionary[t.assetNamespace]){r=false;break}if(r)delete this._assetDictionary[t.assetNamespace]}}};e.prototype.stopAllLoaderSessions=function(){var t=this._loaderSessions.length;for(var e=0;e<t;e++)this.killloaderSession(this._loaderSessions[e]);this._loaderSessions=new Array};e.prototype.rehashAssetDict=function(){var t;this._assetDictionary={};var e=this._assets.length;for(var i=0;i<e;i++){t=this._assets[i];if(!this._assetDictionary.hasOwnProperty(t.assetNamespace))this._assetDictionary[t.assetNamespace]={};this._assetDictionary[t.assetNamespace][t.name]=t}this._assetDictDirty=false};e.prototype.onLoadError=function(t){if(this.hasEventListener(p.IO_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onParseError=function(t){if(this.hasEventListener(y.PARSE_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onAssetComplete=function(t){if(t.type==c.ASSET_COMPLETE)this.addAsset(t.asset);this.dispatchEvent(t)};e.prototype.onTextureSizeError=function(t){this.dispatchEvent(t)};e.prototype.onResourceComplete=function(t){var e=t.target;this.dispatchEvent(t);this.disposeLoaderSession(e)};e.prototype.loaderSessionGC=function(){var t;while(this._loaderSessionsGarbage.length>0){t=this._loaderSessionsGarbage.pop();this.killloaderSession(t)}clearTimeout(this._gcTimeoutIID);this._gcTimeoutIID=null};e.prototype.killloaderSession=function(t){t.removeEventListener(l.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);t.removeEventListener(c.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);t.removeEventListener(c.ASSET_COMPLETE,this._onAssetCompleteDelegate);t.stop()};e.prototype.onAssetRename=function(t){var e=t.target;var i=this.getAsset(e.assetNamespace,e.name);if(i!=null){this._strategy.resolveConflict(e,i,this._assetDictionary[e.assetNamespace],this._strategyPreference)}else{var r=this._assetDictionary[t.asset.assetNamespace];if(r==null)return;r[t.assetPrevName]=null;r[t.asset.name]=t.asset}};e.prototype.onAssetConflictResolved=function(t){this.dispatchEvent(t.clone())};e._iInstances=new Object;return e}(f);e.exports=_},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error","awayjs-core/lib/events/AssetEvent":"awayjs-core/lib/events/AssetEvent","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/IOErrorEvent":"awayjs-core/lib/events/IOErrorEvent","awayjs-core/lib/events/LoaderEvent":"awayjs-core/lib/events/LoaderEvent","awayjs-core/lib/events/ParserEvent":"awayjs-core/lib/events/ParserEvent","awayjs-core/lib/library/AssetBase":"awayjs-core/lib/library/AssetBase","awayjs-core/lib/library/AssetLibraryIterator":"awayjs-core/lib/library/AssetLibraryIterator","awayjs-core/lib/library/ConflictPrecedence":"awayjs-core/lib/library/ConflictPrecedence","awayjs-core/lib/library/ConflictStrategy":"awayjs-core/lib/library/ConflictStrategy","awayjs-core/lib/library/LoaderSession":"awayjs-core/lib/library/LoaderSession"}],"awayjs-core/lib/library/AssetLibraryIterator":[function(t,e,i){var r=function(){function t(t,e,i,r){this._assets=t;this.filter(e,i,r)}Object.defineProperty(t.prototype,"currentAsset",{get:function(){return this._idx<this._filtered.length?this._filtered[this._idx]:null},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numAssets",{get:function(){return this._filtered.length},enumerable:true,configurable:true});t.prototype.next=function(){var t=null;if(this._idx<this._filtered.length)t=this._filtered[this._idx];this._idx++;return t};t.prototype.reset=function(){this._idx=0};t.prototype.setIndex=function(t){this._idx=t};t.prototype.filter=function(t,e,i){if(t||e){var r;var a;r=0;this._filtered=new Array;var s=this._assets.length;for(var n=0;n<s;n++){a=this._assets[n];if(t&&a.assetType!=t)continue;if(e&&a.assetNamespace!=e)continue;if(i!=null&&!i(a))continue;this._filtered[r++]=a}}else{this._filtered=this._assets}};return t}();e.exports=r},{}],"awayjs-core/lib/library/AssetLibrary":[function(t,e,i){var r=t("awayjs-core/lib/library/AssetLibraryBundle");var a=t("awayjs-core/lib/library/LoaderSession");var s=function(){function t(){}t.getBundle=function(t){if(t===void 0){t="default"}return r.getInstance(t)};t.enableParser=function(t){a.enableParser(t)};t.enableParsers=function(t){a.enableParsers(t)};Object.defineProperty(t,"conflictStrategy",{get:function(){return t.getBundle().conflictStrategy},set:function(e){t.getBundle().conflictStrategy=e},enumerable:true,configurable:true});Object.defineProperty(t,"conflictPrecedence",{get:function(){return t.getBundle().conflictPrecedence},set:function(e){t.getBundle().conflictPrecedence=e},enumerable:true,configurable:true});t.createIterator=function(e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}return t.getBundle().createIterator(e,i,r)};t.load=function(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}t.getBundle().load(e,i,r,a)};t.loadData=function(e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}t.getBundle().loadData(e,i,r,a)};t.stopLoad=function(){t.getBundle().stopAllLoaderSessions()};t.getLoaderSession=function(){return t.getBundle().getLoaderSession()};t.getAsset=function(e,i){if(i===void 0){i=null}return t.getBundle().getAsset(e,i)};t.addEventListener=function(e,i){t.getBundle().addEventListener(e,i)};t.removeEventListener=function(e,i){t.getBundle().removeEventListener(e,i)};t.addAsset=function(e){t.getBundle().addAsset(e)};t.removeAsset=function(e,i){if(i===void 0){i=true}t.getBundle().removeAsset(e,i)};t.removeAssetByName=function(e,i,r){if(i===void 0){i=null}if(r===void 0){r=true}return t.getBundle().removeAssetByName(e,i,r)};t.removeAllAssets=function(e){if(e===void 0){e=true}t.getBundle().removeAllAssets(e)};t.removeNamespaceAssets=function(e,i){if(e===void 0){e=null
}if(i===void 0){i=true}t.getBundle().removeNamespaceAssets(e,i)};return t}();e.exports=s},{"awayjs-core/lib/library/AssetLibraryBundle":"awayjs-core/lib/library/AssetLibraryBundle","awayjs-core/lib/library/LoaderSession":"awayjs-core/lib/library/LoaderSession"}],"awayjs-core/lib/library/ConflictPrecedence":[function(t,e,i){var r=function(){function t(){}t.FAVOR_OLD="favorOld";t.FAVOR_NEW="favorNew";return t}();e.exports=r},{}],"awayjs-core/lib/library/ConflictStrategyBase":[function(t,e,i){var r=t("awayjs-core/lib/library/ConflictPrecedence");var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=function(){function t(){}t.prototype.resolveConflict=function(t,e,i,r){throw new a};t.prototype.create=function(){throw new a};t.prototype._pUpdateNames=function(t,e,i,a,n,o){var h;var u;var c;u=o===r.FAVOR_NEW?a:i;c=o===r.FAVOR_NEW?i:a;h=c.name;n[u.name]=u;n[e]=c;c.resetAssetPath(e,t,false);c.dispatchEvent(new s(s.ASSET_CONFLICT_RESOLVED,c,h))};return t}();e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":"awayjs-core/lib/errors/AbstractMethodError","awayjs-core/lib/events/AssetEvent":"awayjs-core/lib/events/AssetEvent","awayjs-core/lib/library/ConflictPrecedence":"awayjs-core/lib/library/ConflictPrecedence"}],"awayjs-core/lib/library/ConflictStrategy":[function(t,e,i){var r=t("awayjs-core/lib/library/ErrorConflictStrategy");var a=t("awayjs-core/lib/library/IgnoreConflictStrategy");var s=t("awayjs-core/lib/library/NumSuffixConflictStrategy");var n=function(){function t(t){}t.APPEND_NUM_SUFFIX=new s;t.IGNORE=new a;t.THROW_ERROR=new r;return t}();e.exports=n},{"awayjs-core/lib/library/ErrorConflictStrategy":"awayjs-core/lib/library/ErrorConflictStrategy","awayjs-core/lib/library/IgnoreConflictStrategy":"awayjs-core/lib/library/IgnoreConflictStrategy","awayjs-core/lib/library/NumSuffixConflictStrategy":"awayjs-core/lib/library/NumSuffixConflictStrategy"}],"awayjs-core/lib/library/ErrorConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=t("awayjs-core/lib/errors/Error");var n=function(t){r(e,t);function e(){t.call(this)}e.prototype.resolveConflict=function(t,e,i,r){throw new s("Asset name collision while AssetLibrary.namingStrategy set to AssetLibrary.THROW_ERROR. Asset path: "+t.assetFullPath)};e.prototype.create=function(){return new e};return e}(a);e.exports=n},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error","awayjs-core/lib/library/ConflictStrategyBase":"awayjs-core/lib/library/ConflictStrategyBase"}],"awayjs-core/lib/library/IAssetClass":[function(t,e,i){},{}],"awayjs-core/lib/library/IAsset":[function(t,e,i){},{}],"awayjs-core/lib/library/IDUtil":[function(t,e,i){var r=function(){function t(){}t.createUID=function(){var e=new Array(36);var i=0;var r;var a;for(r=0;r<8;r++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)];for(r=0;r<3;r++){e[i++]=45;for(a=0;a<4;a++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)]}e[i++]=45;var s=(new Date).getTime();var n=("0000000"+s.toString(16).toUpperCase()).substr(-8);for(r=0;r<8;r++)e[i++]=n.charCodeAt(r);for(r=0;r<4;r++)e[i++]=t.ALPHA_CHAR_CODES[Math.floor(Math.random()*16)];return String.fromCharCode.apply(null,e)};t.ALPHA_CHAR_CODES=[48,49,50,51,52,53,54,55,56,57,65,66,67,68,69,70];return t}();e.exports=r},{}],"awayjs-core/lib/library/IWrapperClass":[function(t,e,i){},{}],"awayjs-core/lib/library/IgnoreConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=function(t){r(e,t);function e(){t.call(this)}e.prototype.resolveConflict=function(t,e,i,r){return};e.prototype.create=function(){return new e};return e}(a);e.exports=s},{"awayjs-core/lib/library/ConflictStrategyBase":"awayjs-core/lib/library/ConflictStrategyBase"}],"awayjs-core/lib/library/LoaderContext":[function(t,e,i){var r=function(){function t(e,i){if(e===void 0){e=true}if(i===void 0){i=null}this._includeDependencies=e;this._dependencyBaseUrl=i||"";this._embeddedDataByUrl={};this._remappedUrls={};this._materialMode=t.UNDEFINED}Object.defineProperty(t.prototype,"includeDependencies",{get:function(){return this._includeDependencies},set:function(t){this._includeDependencies=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dependencyBaseUrl",{get:function(){return this._dependencyBaseUrl},set:function(t){this._dependencyBaseUrl=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"overrideAbsolutePaths",{get:function(){return this._overrideAbsPath},set:function(t){this._overrideAbsPath=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"overrideFullURLs",{get:function(){return this._overrideFullUrls},set:function(t){this._overrideFullUrls=t},enumerable:true,configurable:true});t.prototype.mapUrl=function(t,e){this._remappedUrls[t]=e};t.prototype.mapUrlToData=function(t,e){this._embeddedDataByUrl[t]=e};t.prototype._iHasDataForUrl=function(t){return this._embeddedDataByUrl.hasOwnProperty(t)};t.prototype._iGetDataForUrl=function(t){return this._embeddedDataByUrl[t]};t.prototype._iHasMappingForUrl=function(t){return this._remappedUrls.hasOwnProperty(t)};t.prototype._iGetRemappedUrl=function(t){return this._remappedUrls[t]};t.UNDEFINED=0;t.SINGLEPASS_MATERIALS=1;t.MULTIPASS_MATERIALS=2;return t}();e.exports=r},{}],"awayjs-core/lib/library/LoaderSession":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoader");var s=t("awayjs-core/lib/net/URLLoaderDataFormat");var n=t("awayjs-core/lib/errors/Error");var o=t("awayjs-core/lib/events/AssetEvent");var h=t("awayjs-core/lib/events/Event");var u=t("awayjs-core/lib/events/EventDispatcher");var c=t("awayjs-core/lib/events/IOErrorEvent");var p=t("awayjs-core/lib/events/LoaderEvent");var l=t("awayjs-core/lib/events/ParserEvent");var f=t("awayjs-core/lib/parsers/Image2DParser");var y=t("awayjs-core/lib/parsers/ImageCubeParser");var _=t("awayjs-core/lib/parsers/TextureAtlasParser");var d=t("awayjs-core/lib/parsers/ResourceDependency");var w=t("awayjs-core/lib/parsers/WaveAudioParser");var v=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=0}t.call(this);this._materialMode=e;this._stack=new Array;this._errorHandlers=new Array;this._parseErrorHandlers=new Array;this._onReadyForDependenciesDelegate=function(t){return i.onReadyForDependencies(t)};this._onParseCompleteDelegate=function(t){return i.onParseComplete(t)};this._onParseErrorDelegate=function(t){return i.onParseError(t)};this._onLoadCompleteDelegate=function(t){return i.onLoadComplete(t)};this._onLoadErrorDelegate=function(t){return i.onLoadError(t)};this._onTextureSizeErrorDelegate=function(t){return i.onTextureSizeError(t)};this._onAssetCompleteDelegate=function(t){return i.onAssetComplete(t)}}e.enableParser=function(t){if(e._parsers.indexOf(t)<0)e._parsers.push(t)};e.enableParsers=function(t){for(var i=0;i<t.length;i++)e.enableParser(t[i])};Object.defineProperty(e.prototype,"baseDependency",{get:function(){return this._baseDependency},enumerable:true,configurable:true});e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this._uri=t.url=t.url.replace(/\\/g,"/");this._context=e;this._namespace=i;this._baseDependency=new d("",t,null,r,null);this.retrieveDependency(this._baseDependency)};e.prototype.loadData=function(t,e,i,r,a){if(i===void 0){i=null}if(r===void 0){r=null}if(a===void 0){a=null}this._uri=e;this._context=i;this._namespace=r;this._baseDependency=new d(e,null,t,a,null);this.retrieveDependency(this._baseDependency)};e.prototype.retrieveNext=function(t){if(t===void 0){t=null}if(this._currentDependency.dependencies.length){var e=this._currentDependency.dependencies.pop();this._stack.push(this._currentDependency);this.retrieveDependency(e)}else if(this._currentDependency.parser&&this._currentDependency.parser.parsingPaused){this._currentDependency.parser._iResumeParsing();this._stack.pop()}else if(this._stack.length){var i=this._currentDependency;this._currentDependency=this._stack.pop();if(i._iSuccess)i.resolve();this.retrieveNext(t)}else{this.dispatchEvent(new p(p.RESOURCE_COMPLETE,this._uri,this._baseDependency.parser.content,this._baseDependency.assets))}};e.prototype.retrieveDependency=function(t){var e;if(this._context&&this._context.materialMode!=0)this._materialMode=this._context.materialMode;this._currentDependency=t;t._iLoader=new a;this.addEventListeners(t._iLoader);e=t.data;if(this._context&&t.request&&this._context._iHasDataForUrl(t.request.url))e=this._context._iGetDataForUrl(t.request.url);if(e){if(e.constructor===Function)e=new e;t._iSetData(e);if(t.retrieveAsRawData){t.resolve();this.retrieveNext()}else{this.parseDependency(t)}}else{t.request.url=this.resolveDependencyUrl(t);if(t.retrieveAsRawData){t._iLoader.dataFormat=s.BINARY}else{if(!t.parser)t._iSetParser(this.getParserFromSuffix(t.request.url));if(t.parser){t._iLoader.dataFormat=t.parser.dataFormat}else{t._iLoader.dataFormat=s.BINARY}}t._iLoader.load(t.request)}};e.prototype.joinUrl=function(t,e){if(e.charAt(0)=="/"||e.charAt(0)=="\\")e=e.substr(1);if(e.charAt(0)==".")e=e.substr(2);if(t.length==0)return e;if(t.charAt(t.length-1)=="/"||t.charAt(t.length-1)=="\\")t=t.substr(0,t.length-1);return t.concat("/",e)};e.prototype.resolveDependencyUrl=function(t){var e;var i;var r=t.request.url;if(this._context&&this._context._iHasMappingForUrl(r))return this._context._iGetRemappedUrl(r);if(r==this._uri)return r;e=new RegExp("/^[a-zA-Z]{3,4}:///");if(r.charAt(0)=="/"){if(this._context&&this._context.overrideAbsolutePaths)return this.joinUrl(this._context.dependencyBaseUrl,r);else return r}else if(e.test(r)){if(this._context&&this._context.overrideFullURLs){var a=r.replace(e,"");return this.joinUrl(this._context.dependencyBaseUrl,a)}}if(this._context&&this._context.dependencyBaseUrl){i=this._context.dependencyBaseUrl;return this.joinUrl(i,r)}else{i=this._uri.substring(0,this._uri.lastIndexOf("/")+1);return this.joinUrl(i,r)}};e.prototype.retrieveParserDependencies=function(){if(!this._currentDependency)return;var t=this._currentDependency.parser.dependencies;var e,i=t.length;for(e=0;e<i;e++)this._currentDependency.dependencies[e]=t[e];t.length=0;this._stack.push(this._currentDependency);this.retrieveNext()};e.prototype.resolveParserDependencies=function(){this._currentDependency._iSuccess=true;if(this._currentDependency.parser&&this._currentDependency.parser.dependencies.length&&(!this._context||this._context.includeDependencies))this.retrieveParserDependencies();else this.retrieveNext()};e.prototype.onLoadError=function(t){var e;var i=this._currentDependency!=this._baseDependency;var r=t.target;this.removeEventListeners(r);if(this.hasEventListener(c.IO_ERROR)){this.dispatchEvent(t);e=true}else{var a,s=this._errorHandlers.length;for(a=0;a<s;a++)if(!e)e=this._errorHandlers[a](t)}if(e){if(i){this._currentDependency.resolveFailure();this.retrieveNext()}else{this.dispose();return}}else{throw new n}};e.prototype.onParseError=function(t){var e;var i=this._currentDependency!=this._baseDependency;var r=t.target;this.removeEventListeners(r);if(this.hasEventListener(l.PARSE_ERROR)){this.dispatchEvent(t);e=true}else{var a,s=this._parseErrorHandlers.length;for(a=0;a<s;a++)if(!e)e=this._parseErrorHandlers[a](t)}if(e){this.retrieveNext()}else{throw new n(t.message)}};e.prototype.onAssetComplete=function(t){if(this._currentDependency)this._currentDependency.assets.push(t.asset);t.asset.resetAssetPath(t.asset.name,this._namespace);if(!this._currentDependency.suppresAssetEvents)this.dispatchEvent(t)};e.prototype.onReadyForDependencies=function(t){var e=t.target;if(this._context&&!this._context.includeDependencies)e._iResumeParsing();else this.retrieveParserDependencies()};e.prototype.onLoadComplete=function(t){var e=t.target;this.removeEventListeners(e);this._currentDependency._iSetData(e.data);if(this._currentDependency.retrieveAsRawData){this.resolveParserDependencies()}else{this.parseDependency(this._currentDependency)}};e.prototype.onParseComplete=function(t){var e=t.target;this.resolveParserDependencies();e.removeEventListener(l.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate);e.removeEventListener(l.PARSE_COMPLETE,this._onParseCompleteDelegate);e.removeEventListener(l.PARSE_ERROR,this._onParseErrorDelegate);e.removeEventListener(o.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);e.removeEventListener(o.ASSET_COMPLETE,this._onAssetCompleteDelegate)};e.prototype.onTextureSizeError=function(t){t.asset.name=this._currentDependency.resolveName(t.asset);this.dispatchEvent(t)};e.prototype.addEventListeners=function(t){t.addEventListener(h.COMPLETE,this._onLoadCompleteDelegate);t.addEventListener(c.IO_ERROR,this._onLoadErrorDelegate)};e.prototype.removeEventListeners=function(t){t.removeEventListener(h.COMPLETE,this._onLoadCompleteDelegate);t.removeEventListener(c.IO_ERROR,this._onLoadErrorDelegate)};e.prototype.stop=function(){this.dispose()};e.prototype.dispose=function(){this._errorHandlers=null;this._parseErrorHandlers=null;this._context=null;this._stack=null;if(this._currentDependency&&this._currentDependency._iLoader)this.removeEventListeners(this._currentDependency._iLoader);this._currentDependency=null};e.prototype._iAddParseErrorHandler=function(t){if(this._parseErrorHandlers.indexOf(t)<0)this._parseErrorHandlers.push(t)};e.prototype._iAddErrorHandler=function(t){if(this._errorHandlers.indexOf(t)<0)this._errorHandlers.push(t)};e.prototype.getParserFromData=function(t){var i=e._parsers.length;for(var r=i-1;r>=0;r--)if(e._parsers[r].supportsData(t))return new e._parsers[r];return null};e.prototype.parseDependency=function(t){var e=t.parser;if(!e)t._iSetParser(e=this.getParserFromData(t.data));if(e){e.addEventListener(l.READY_FOR_DEPENDENCIES,this._onReadyForDependenciesDelegate);e.addEventListener(l.PARSE_COMPLETE,this._onParseCompleteDelegate);e.addEventListener(l.PARSE_ERROR,this._onParseErrorDelegate);e.addEventListener(o.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);e.addEventListener(o.ASSET_COMPLETE,this._onAssetCompleteDelegate);if(t.request&&t.request.url)e._iFileName=t.request.url;e.materialMode=this._materialMode;e.parseAsync(t.data)}else{var i;var r="No parser defined. To enable all parsers for auto-detection, use Parsers.enableAllBundled()";var a=new l(l.PARSE_ERROR,r);if(this.hasEventListener(l.PARSE_ERROR)){this.dispatchEvent(a);i=true}else{var s,h=this._parseErrorHandlers.length;for(s=0;s<h;s++)if(!i)i=this._parseErrorHandlers[s](a)}if(i){this.retrieveNext()}else{throw new n(r)}}};e.prototype.getParserFromSuffix=function(t){var i=t.indexOf("?")>0?t.split("?")[0]:t;var r=i.substr(i.lastIndexOf(".")+1).toLowerCase();var a=e._parsers.length;for(var s=a-1;s>=0;s--){var n=e._parsers[s];if(n.supportsType(r))return new n}return null};e._parsers=new Array(f,y,_,w);return e}(u);e.exports=v},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error","awayjs-core/lib/events/AssetEvent":"awayjs-core/lib/events/AssetEvent","awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/IOErrorEvent":"awayjs-core/lib/events/IOErrorEvent","awayjs-core/lib/events/LoaderEvent":"awayjs-core/lib/events/LoaderEvent","awayjs-core/lib/events/ParserEvent":"awayjs-core/lib/events/ParserEvent","awayjs-core/lib/net/URLLoader":"awayjs-core/lib/net/URLLoader","awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/parsers/Image2DParser":"awayjs-core/lib/parsers/Image2DParser","awayjs-core/lib/parsers/ImageCubeParser":"awayjs-core/lib/parsers/ImageCubeParser","awayjs-core/lib/parsers/ResourceDependency":"awayjs-core/lib/parsers/ResourceDependency","awayjs-core/lib/parsers/TextureAtlasParser":"awayjs-core/lib/parsers/TextureAtlasParser","awayjs-core/lib/parsers/WaveAudioParser":"awayjs-core/lib/parsers/WaveAudioParser"}],"awayjs-core/lib/library/NumSuffixConflictStrategy":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/ConflictStrategyBase");var s=function(t){r(e,t);function e(e){if(e===void 0){e="."}t.call(this);this._separator=e;this._next_suffix={}}e.prototype.resolveConflict=function(t,e,i,r){var a;var s;var n;var o;a=t.name;if(a.indexOf(this._separator)>=0){n=a.substring(0,a.lastIndexOf(this._separator));o=parseInt(a.substring(n.length-1));if(isNaN(o)){n=a;o=0}}else{n=a;o=0}if(o==0&&this._next_suffix.hasOwnProperty(n)){o=this._next_suffix[n]}do{o++;s=n.concat(this._separator,o.toString())}while(i.hasOwnProperty(s));this._next_suffix[n]=o;this._pUpdateNames(e.assetNamespace,s,e,t,i,r)};e.prototype.create=function(){return new e(this._separator)};return e}(a);e.exports=s},{"awayjs-core/lib/library/ConflictStrategyBase":"awayjs-core/lib/library/ConflictStrategyBase"}],"awayjs-core/lib/net/CrossDomainPolicy":[function(t,e,i){var r=function(){function t(){}t.ANONYMOUS="anonymous";t.USE_CREDENTIALS="use-credentials";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLLoaderDataFormat":[function(t,e,i){var r=function(){function t(){}t.TEXT="text";t.VARIABLES="variables";t.BLOB="blob";t.ARRAY_BUFFER="arraybuffer";t.BINARY="binary";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLLoader":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/net/URLRequestMethod");var n=t("awayjs-core/lib/net/URLVariables");var o=t("awayjs-core/lib/events/Event");var h=t("awayjs-core/lib/events/EventDispatcher");var u=t("awayjs-core/lib/events/HTTPStatusEvent");var c=t("awayjs-core/lib/events/IOErrorEvent");var p=t("awayjs-core/lib/events/ProgressEvent");var l=function(t){r(e,t);function e(){t.call(this);this._bytesLoaded=0;this._bytesTotal=0;this._dataFormat=a.TEXT;this._loadError=false}Object.defineProperty(e.prototype,"url",{get:function(){return this._request?this._request.url:""},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},set:function(t){this._dataFormat=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:true,configurable:true});e.prototype.load=function(t){this._request=t;this.initXHR();if(t.method===s.POST)this.postRequest(t);else this.getRequest(t)};e.prototype.close=function(){this._XHR.abort();this.disposeXHR()};e.prototype.dispose=function(){if(this._XHR)this._XHR.abort();this.disposeXHR();this._data=null;this._dataFormat=null;this._bytesLoaded=null;this._bytesTotal=null};e.prototype.setResponseType=function(t,e){switch(e){case a.ARRAY_BUFFER:case a.BLOB:case a.TEXT:t.responseType=e;break;case a.VARIABLES:t.responseType=a.TEXT;break;case a.BINARY:t.responseType="";break;default:}};e.prototype.getRequest=function(t){try{this._XHR.open(t.method,t.url,t.async);this.setResponseType(this._XHR,this._dataFormat);this._XHR.send()}catch(e){this.handleXmlHttpRequestException(e)}};e.prototype.postRequest=function(t){this._loadError=false;this._XHR.open(t.method,t.url,t.async);if(t.data!=null){if(t.data instanceof n){var e=t.data;try{this._XHR.responseType="text";this._XHR.send(e.formData)}catch(i){this.handleXmlHttpRequestException(i)}}else{this.setResponseType(this._XHR,this._dataFormat);if(t.data)this._XHR.send(t.data);else this._XHR.send()}}else{this._XHR.send()}};e.prototype.handleXmlHttpRequestException=function(t){switch(t.code){case 101:break}};e.prototype.initXHR=function(){var t=this;if(!this._XHR){this._XHR=new XMLHttpRequest;this._XHR.onloadstart=function(e){return t.onLoadStart(e)};this._XHR.onprogress=function(e){return t.onProgress(e)};this._XHR.onabort=function(e){return t.onAbort(e)};this._XHR.onerror=function(e){return t.onLoadError(e)};this._XHR.onload=function(e){return t.onLoadComplete(e)};this._XHR.ontimeout=function(e){return t.onTimeOut(e)};this._XHR.onloadend=function(e){return t.onLoadEnd(e)};this._XHR.onreadystatechange=function(e){return t.onReadyStateChange(e)}}};e.prototype.disposeXHR=function(){if(this._XHR!==null){this._XHR.onloadstart=null;this._XHR.onprogress=null;this._XHR.onabort=null;this._XHR.onerror=null;this._XHR.onload=null;this._XHR.ontimeout=null;this._XHR.onloadend=null;this._XHR=null}};e.prototype.decodeURLVariables=function(t){var e=new Object;t=t.split("+").join(" ");var i,r=/[?&]?([^=]+)=([^&]*)/g;while(i=r.exec(t))e[decodeURIComponent(i[1])]=decodeURIComponent(i[2]);return e};e.prototype.onReadyStateChange=function(t){if(this._XHR.readyState==4){if(this._XHR.status==404){this._loadError=true;if(!this._loadErrorEvent)this._loadErrorEvent=new c(c.IO_ERROR);this.dispatchEvent(this._loadErrorEvent)}this.dispatchEvent(new u(u.HTTP_STATUS,this._XHR.status))}};e.prototype.onLoadEnd=function(t){if(this._loadError===true)return};e.prototype.onTimeOut=function(t){};e.prototype.onAbort=function(t){};e.prototype.onProgress=function(t){if(!this._progressEvent)this._progressEvent=new p(p.PROGRESS);this._progressEvent.bytesTotal=t.total;this._progressEvent.bytesLoaded=t.loaded;this.dispatchEvent(this._progressEvent)};e.prototype.onLoadStart=function(t){if(!this._loadStartEvent)this._loadStartEvent=new o(o.OPEN);this.dispatchEvent(this._loadStartEvent)};e.prototype.onLoadComplete=function(t){if(this._loadError===true)return;switch(this._dataFormat){case a.TEXT:this._data=this._XHR.responseText;break;case a.VARIABLES:this._data=this.decodeURLVariables(this._XHR.responseText);break;case a.BLOB:case a.ARRAY_BUFFER:case a.BINARY:this._data=this._XHR.response;break;default:this._data=this._XHR.responseText;break}if(!this._loadCompleteEvent)this._loadCompleteEvent=new o(o.COMPLETE);this.dispatchEvent(this._loadCompleteEvent)};e.prototype.onLoadError=function(t){this._loadError=true;if(!this._loadErrorEvent)this._loadErrorEvent=new c(c.IO_ERROR);this.dispatchEvent(this._loadErrorEvent)};return e}(h);e.exports=l},{"awayjs-core/lib/events/Event":"awayjs-core/lib/events/Event","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/HTTPStatusEvent":"awayjs-core/lib/events/HTTPStatusEvent","awayjs-core/lib/events/IOErrorEvent":"awayjs-core/lib/events/IOErrorEvent","awayjs-core/lib/events/ProgressEvent":"awayjs-core/lib/events/ProgressEvent","awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/net/URLRequestMethod":"awayjs-core/lib/net/URLRequestMethod","awayjs-core/lib/net/URLVariables":"awayjs-core/lib/net/URLVariables"}],"awayjs-core/lib/net/URLRequestMethod":[function(t,e,i){var r=function(){function t(){}t.POST="POST";t.GET="GET";return t}();e.exports=r},{}],"awayjs-core/lib/net/URLRequest":[function(t,e,i){var r=t("awayjs-core/lib/net/URLRequestMethod");var a=function(){function t(t){if(t===void 0){t=null}this.method=r.GET;this.async=true;this._url=t}Object.defineProperty(t.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:true,configurable:true});t.prototype.dispose=function(){this.data=null;this._url=null};return t}();e.exports=a},{"awayjs-core/lib/net/URLRequestMethod":"awayjs-core/lib/net/URLRequestMethod"}],"awayjs-core/lib/net/URLVariables":[function(t,e,i){var r=function(){function t(t){if(t===void 0){t=null}this._variables=new Object;if(t!==null)this.decode(t)}t.prototype.decode=function(t){t=t.split("+").join(" ");var e,i=/[?&]?([^=]+)=([^&]*)/g;while(e=i.exec(t))this._variables[decodeURIComponent(e[1])]=decodeURIComponent(e[2])};t.prototype.toString=function(){return""};Object.defineProperty(t.prototype,"variables",{get:function(){return this._variables},set:function(t){this._variables=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"formData",{get:function(){var t=new FormData;for(var e in this._variables)t.append(e,this._variables[e]);return t},enumerable:true,configurable:true});return t}();e.exports=r},{}],"awayjs-core/lib/parsers/Image2DParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/net/URLLoaderDataFormat");var s=t("awayjs-core/lib/parsers/ParserBase");var n=t("awayjs-core/lib/parsers/ParserUtils");var o=t("awayjs-core/lib/utils/ByteArray");var h=t("awayjs-core/lib/utils/ImageUtils");var u=function(t){r(e,t);function e(){t.call(this,a.BLOB)}e.supportsType=function(t){t=t.toLowerCase();return t=="jpg"||t=="jpeg"||t=="png"||t=="gif"};e.supportsData=function(t){if(t instanceof HTMLImageElement)return true;if(!(t instanceof o))return false;var e=t;e.position=0;if(e.readUnsignedShort()==65496)return true;e.position=0;if(e.readShort()==16973)return true;e.position=1;if(e.readUTFBytes(3)=="PNG")return true;e.position=0;if(e.readUTFBytes(3)=="GIF"&&e.readShort()==14393&&e.readByte()==97)return true;e.position=0;if(e.readUTFBytes(3)=="ATF")return true;return false};e.prototype._pProceedParsing=function(){var t=this;var e;var i=false;if(this._loadingImage){return s.MORE_TO_PARSE}else if(this._htmlImageElement){if(h.isHTMLImageElementValid(this._htmlImageElement)){e=n.imageToBitmapImage2D(this._htmlImageElement);this._pFinalizeAsset(e,this._iFileName)}}else if(this.data instanceof HTMLImageElement){var r=this.data;if(h.isHTMLImageElementValid(r)){e=n.imageToBitmapImage2D(r);this._pFinalizeAsset(e,this._iFileName)}else{i=true}}else if(this.data instanceof o){var a=this.data;a.position=0;var r=n.byteArrayToImage(this.data);if(h.isHTMLImageElementValid(r)){e=n.imageToBitmapImage2D(r);this._pFinalizeAsset(e,this._iFileName)}else{i=true}}else if(this.data instanceof ArrayBuffer){this._htmlImageElement=n.arrayBufferToImage(this.data);e=n.imageToBitmapImage2D(this._htmlImageElement);this._pFinalizeAsset(e,this._iFileName)}else if(this.data instanceof Blob){this._htmlImageElement=n.blobToImage(this.data);this._htmlImageElement.onload=function(e){return t.onLoadComplete(e)};this._loadingImage=true;return s.MORE_TO_PARSE}if(i==true){}this._pContent=e;return s.PARSING_DONE};e.prototype.onLoadComplete=function(t){this._loadingImage=false};return e}(s);e.exports=u},{"awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/parsers/ParserBase":"awayjs-core/lib/parsers/ParserBase","awayjs-core/lib/parsers/ParserUtils":"awayjs-core/lib/parsers/ParserUtils","awayjs-core/lib/utils/ByteArray":"awayjs-core/lib/utils/ByteArray","awayjs-core/lib/utils/ImageUtils":"awayjs-core/lib/utils/ImageUtils"}],"awayjs-core/lib/parsers/ImageCubeParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/BitmapImageCube");var s=t("awayjs-core/lib/net/URLLoaderDataFormat");var n=t("awayjs-core/lib/net/URLRequest");var o=t("awayjs-core/lib/parsers/ParserBase");var h=function(t){r(e,t);function e(){t.call(this,s.TEXT)}e.supportsType=function(t){t=t.toLowerCase();return t=="cube"};e.supportsData=function(t){try{var e=JSON.parse(t);if(e){return true}return false}catch(i){return false}return false};e.prototype._iResolveDependency=function(t){};e.prototype._iResolveDependencyFailure=function(t){};e.prototype._pProceedParsing=function(){if(this._imgDependencyDictionary!=null){var t=new a(this._getBitmapImage2D(e.posX).width);t.draw(a.posX,this._getBitmapImage2D(e.posX));t.draw(a.negX,this._getBitmapImage2D(e.negX));t.draw(a.posY,this._getBitmapImage2D(e.posY));t.draw(a.negY,this._getBitmapImage2D(e.negY));t.draw(a.posZ,this._getBitmapImage2D(e.posZ));t.draw(a.negZ,this._getBitmapImage2D(e.negZ));this._imgDependencyDictionary=null;t.name=this._iFileName;this._pFinalizeAsset(t,this._iFileName);return o.PARSING_DONE}try{var i=JSON.parse(this.data);var r=i.data;var s;if(r.length!=6)this._pDieWithError("ImageCubeParser: Error - cube texture should have exactly 6 images");if(i){this._imgDependencyDictionary=new Object;for(var h=0;h<r.length;h++){s=r[h];this._imgDependencyDictionary[s.id]=this._pAddDependency(s.id,new n(s.image.toString()))}if(!this._validateCubeData()){this._pDieWithError("ImageCubeParser: JSON data error - cubes require id of:   \n"+e.posX+", "+e.negX+",  \n"+e.posY+", "+e.negY+",  \n"+e.posZ+", "+e.negZ);return o.PARSING_DONE}this._pPauseAndRetrieveDependencies();return o.MORE_TO_PARSE}}catch(u){this._pDieWithError("CubeTexturePaser Error parsing JSON")}return o.PARSING_DONE};e.prototype._validateCubeData=function(){return this._imgDependencyDictionary[e.posX]!=null&&this._imgDependencyDictionary[e.negX]!=null&&this._imgDependencyDictionary[e.posY]!=null&&this._imgDependencyDictionary[e.negY]!=null&&this._imgDependencyDictionary[e.posZ]!=null&&this._imgDependencyDictionary[e.negZ]!=null};e.prototype._getBitmapImage2D=function(t){var e=this._imgDependencyDictionary[t];if(e)return e.assets[0];return null};e.posX="posX";e.negX="negX";e.posY="posY";e.negY="negY";e.posZ="posZ";e.negZ="negZ";return e}(o);e.exports=h},{"awayjs-core/lib/data/BitmapImageCube":"awayjs-core/lib/data/BitmapImageCube","awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/net/URLRequest":"awayjs-core/lib/net/URLRequest","awayjs-core/lib/parsers/ParserBase":"awayjs-core/lib/parsers/ParserBase"}],"awayjs-core/lib/parsers/ParserBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-core/lib/events/AssetEvent");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/events/ParserEvent");var h=t("awayjs-core/lib/events/TimerEvent");var u=t("awayjs-core/lib/parsers/ParserUtils");var c=t("awayjs-core/lib/parsers/ResourceDependency");var p=t("awayjs-core/lib/utils/ImageUtils");var l=t("awayjs-core/lib/utils/Timer");var f=t("awayjs-core/lib/utils/getTimer");var y=function(t){r(e,t);function e(e){var i=this;t.call(this);this._materialMode=0;this._dataFormat=e;this._dependencies=new Array;this._pOnIntervalDelegate=function(t){return i._pOnInterval(t)}}e.supportsType=function(t){throw new a};Object.defineProperty(e.prototype,"content",{get:function(){return this._pContent},enumerable:true,configurable:true});e.prototype.isBitmapImage2DValid=function(t){var e=p.isImage2DValid(t);if(!e){console.log(">> Bitmap loaded is not having power of 2 dimensions or is higher than 2048")}return e};Object.defineProperty(e.prototype,"parsingFailure",{get:function(){return this._parsingFailure},set:function(t){this._parsingFailure=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parsingPaused",{get:function(){return this._parsingPaused},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parsingComplete",{get:function(){return this._parsingComplete
},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"materialMode",{get:function(){return this._materialMode},set:function(t){this._materialMode=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataFormat",{get:function(){return this._dataFormat},enumerable:true,configurable:true});e.prototype.parseAsync=function(t,e){if(e===void 0){e=30}this._data=t;this._pStartParsing(e)};Object.defineProperty(e.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:true,configurable:true});e.prototype._iResolveDependency=function(t){throw new a};e.prototype._iResolveDependencyFailure=function(t){throw new a};e.prototype._iResolveDependencyName=function(t,e){return e.name};e.prototype._iResumeParsing=function(){this._parsingPaused=false;if(this._timer)this._timer.start();if(!this._isParsing)this._pOnInterval()};e.prototype._pFinalizeAsset=function(t,e){if(e===void 0){e=null}var i;var r;if(e!=null)t.name=e;if(!t.name)t.name=t.assetType;this.dispatchEvent(new s(s.ASSET_COMPLETE,t))};e.prototype._pProceedParsing=function(){throw new a};e.prototype._pDieWithError=function(t){if(t===void 0){t="Unknown parsing error"}if(this._timer){this._timer.removeEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.stop();this._timer=null}this.dispatchEvent(new o(o.PARSE_ERROR,t))};e.prototype._pAddDependency=function(t,e,i,r,a,s){if(i===void 0){i=false}if(r===void 0){r=null}if(a===void 0){a=false}if(s===void 0){s=0}var n=new c(t,e,r,null,this,i,a,s);this._dependencies.push(n);return n};e.prototype._pPauseAndRetrieveDependencies=function(){this._pPauseParsing();this.dispatchEvent(new o(o.READY_FOR_DEPENDENCIES))};e.prototype._pPauseParsing=function(){if(this._timer)this._timer.stop();this._parsingPaused=true};e.prototype._pHasTime=function(){return f()-this._lastFrameTime<this._frameLimit};e.prototype._pOnInterval=function(t){if(t===void 0){t=null}this._lastFrameTime=f();this._isParsing=true;if(this._pProceedParsing()&&!this._parsingFailure)this._pFinishParsing();this._isParsing=false};e.prototype._pStartParsing=function(t){this._frameLimit=t;this._timer=new l(this._frameLimit,0);this._timer.addEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.start();this._pOnInterval()};e.prototype._pFinishParsing=function(){if(this._timer){this._timer.removeEventListener(h.TIMER,this._pOnIntervalDelegate);this._timer.stop()}this._timer=null;this._parsingComplete=true;this._isParsing=false;this.dispatchEvent(new o(o.PARSE_COMPLETE))};e.prototype._pGetTextData=function(){return u.toString(this._data)};e.prototype._pGetByteData=function(){return u.toByteArray(this._data)};e.PARSING_DONE=true;e.MORE_TO_PARSE=false;return e}(n);e.exports=y},{"awayjs-core/lib/errors/AbstractMethodError":"awayjs-core/lib/errors/AbstractMethodError","awayjs-core/lib/events/AssetEvent":"awayjs-core/lib/events/AssetEvent","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/ParserEvent":"awayjs-core/lib/events/ParserEvent","awayjs-core/lib/events/TimerEvent":"awayjs-core/lib/events/TimerEvent","awayjs-core/lib/parsers/ParserUtils":"awayjs-core/lib/parsers/ParserUtils","awayjs-core/lib/parsers/ResourceDependency":"awayjs-core/lib/parsers/ResourceDependency","awayjs-core/lib/utils/ImageUtils":"awayjs-core/lib/utils/ImageUtils","awayjs-core/lib/utils/Timer":"awayjs-core/lib/utils/Timer","awayjs-core/lib/utils/getTimer":"awayjs-core/lib/utils/getTimer"}],"awayjs-core/lib/parsers/ParserDataFormat":[function(t,e,i){var r=function(){function t(){}t.BINARY="binary";t.PLAIN_TEXT="plainText";t.IMAGE="image";return t}();e.exports=r},{}],"awayjs-core/lib/parsers/ParserUtils":[function(t,e,i){var r=t("awayjs-core/lib/data/BitmapImage2D");var a=t("awayjs-core/lib/utils/ByteArray");var s=function(){function t(){}t.arrayBufferToBase64=function(t,e){var i="";var r=new Uint8Array(t);var a=r.byteLength;for(var s=0;s<a;s++)i+=String.fromCharCode(r[s]);var n=window.btoa(i);return"data:"+e+";base64,"+n};t.arrayBufferToAudio=function(e,i){var r=t.arrayBufferToBase64(e,"audio/"+i);var a=new Audio;a.src=r;return a};t.arrayBufferToImage=function(e){var i=t.arrayBufferToBase64(e,"image/png");var r=new Image;r.src=i;return r};t.byteArrayToImage=function(e){var i=t.arrayBufferToBase64(e.arraybytes,"image/png");var r=new Image;r.src=i;return r};t.byteArrayToAudio=function(e,i){var r=t.arrayBufferToBase64(e.arraybytes,"audio/"+i);var a=new Audio;a.src=r;return a};t.blobToImage=function(t){var e=window["URL"]||window["webkitURL"];var i=e.createObjectURL(t);var r=new Image;r.src=i;return r};t.blobToAudio=function(t){var e=window["URL"]||window["webkitURL"];var i=e.createObjectURL(t);var r=new Audio;r.src=i;return r};t.imageToBitmapImage2D=function(t){var e=new r(t.width,t.height,true);e.draw(t);return e};t.toByteArray=function(t){var e=new a;e.setArrayBuffer(t);return e};t.toString=function(t,e){if(e===void 0){e=0}if(typeof t==="string"){var i=t;if(i["substr"]!=null)return i.substr(0,i.length)}if(t instanceof a){var r=t;r.position=0;return r.readUTFBytes(Math.min(r.getBytesAvailable(),e))}return null};return t}();e.exports=s},{"awayjs-core/lib/data/BitmapImage2D":"awayjs-core/lib/data/BitmapImage2D","awayjs-core/lib/utils/ByteArray":"awayjs-core/lib/utils/ByteArray"}],"awayjs-core/lib/parsers/ResourceDependency":[function(t,e,i){var r=function(){function t(t,e,i,r,a,s,n,o){if(s===void 0){s=false}if(n===void 0){n=false}if(o===void 0){o=0}this._id=t;this._sub_id=o;this._request=e;this._data=i;this._parser=r;this._parentParser=a;this._retrieveAsRawData=s;this._suppressAssetEvents=n;this._assets=new Array;this._dependencies=new Array}Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"sub_id",{get:function(){return this._sub_id},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"request",{get:function(){return this._request},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parentParser",{get:function(){return this._parentParser},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"retrieveAsRawData",{get:function(){return this._retrieveAsRawData},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"suppresAssetEvents",{get:function(){return this._suppressAssetEvents},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"assets",{get:function(){return this._assets},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:true,configurable:true});t.prototype._iSetData=function(t){this._data=t};t.prototype._iSetParser=function(t){this._parser=t};t.prototype.resolve=function(){if(this._parentParser)this._parentParser._iResolveDependency(this)};t.prototype.resolveFailure=function(){if(this._parentParser)this._parentParser._iResolveDependencyFailure(this)};t.prototype.resolveName=function(t){if(this._parentParser)return this._parentParser._iResolveDependencyName(this,t);return t.name};return t}();e.exports=r},{}],"awayjs-core/lib/parsers/TextureAtlasParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/Sampler2D");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/net/URLLoaderDataFormat");var o=t("awayjs-core/lib/net/URLRequest");var h=t("awayjs-core/lib/parsers/ParserBase");var u=t("awayjs-core/lib/parsers/ParserUtils");var c=t("awayjs-core/lib/utils/XmlUtils");var p=function(t){r(e,t);function e(){t.call(this,n.TEXT);this._parseState=0}e.supportsType=function(t){t=t.toLowerCase();return t=="xml"};e.supportsData=function(t){try{var e=u.toString(t);if(e.indexOf("TextureAtlas")!=-1||e.indexOf("textureatlas")!=-1)return true;return false}catch(i){return false}return false};e.prototype._iResolveDependency=function(t){if(t.assets.length){this._imageData=t.assets[0];this._parseState=l.PARSE_SUBTEXTURES}else{this._parseState=l.PARSE_COMPLETE}};e.prototype._iResolveDependencyFailure=function(t){this._parseState=l.PARSE_COMPLETE};e.prototype._pProceedParsing=function(){var t;switch(this._parseState){case l.PARSE_XML:try{this._doc=c.getChildrenWithTag(c.strToXml(this._pGetTextData()),"TextureAtlas")[0];this._imagePath=c.readAttributeValue(this._doc,"imagePath");this._subTextureNodes=c.getChildrenWithTag(this._doc,"SubTexture");this._parseState=l.PARSE_IMAGE}catch(e){return h.PARSING_DONE}break;case l.PARSE_IMAGE:if(this._imagePath){this._pAddDependency(this._imagePath,new o(this._imagePath));this._pPauseAndRetrieveDependencies()}else{return h.PARSING_DONE}break;case l.PARSE_SUBTEXTURES:var i;var r;var n;var u;var p;var f;var y=this._subTextureNodes.length;for(var _=0;_<y;_++){r=this._subTextureNodes[_];i=new a(this._imageData);n=c.readAttributeValue(r,"x");u=c.readAttributeValue(r,"y");p=c.readAttributeValue(r,"width");f=c.readAttributeValue(r,"height");if(n||u||p||f)i.imageRect=new s(parseInt(n),parseInt(u),parseInt(p),parseInt(f));n=c.readAttributeValue(r,"frameX");u=c.readAttributeValue(r,"frameY");p=c.readAttributeValue(r,"frameWidth");f=c.readAttributeValue(r,"frameHeight");if(n||u||p||f)i.frameRect=new s(parseInt(n),parseInt(u),parseInt(p),parseInt(f));this._pFinalizeAsset(i,c.readAttributeValue(r,"name"))}this._parseState=l.PARSE_COMPLETE;break;case l.PARSE_COMPLETE:return h.PARSING_DONE}return h.MORE_TO_PARSE};return e}(h);var l=function(){function t(){}t.PARSE_XML=0;t.PARSE_IMAGE=1;t.PARSE_SUBTEXTURES=2;t.PARSE_COMPLETE=3;return t}();e.exports=p},{"awayjs-core/lib/data/Sampler2D":"awayjs-core/lib/data/Sampler2D","awayjs-core/lib/geom/Rectangle":"awayjs-core/lib/geom/Rectangle","awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/net/URLRequest":"awayjs-core/lib/net/URLRequest","awayjs-core/lib/parsers/ParserBase":"awayjs-core/lib/parsers/ParserBase","awayjs-core/lib/parsers/ParserUtils":"awayjs-core/lib/parsers/ParserUtils","awayjs-core/lib/utils/XmlUtils":"awayjs-core/lib/utils/XmlUtils"}],"awayjs-core/lib/parsers/WaveAudioParser":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/WaveAudio");var s=t("awayjs-core/lib/net/URLLoaderDataFormat");var n=t("awayjs-core/lib/parsers/ParserBase");var o=t("awayjs-core/lib/utils/ByteArray");var h=function(t){r(e,t);function e(){t.call(this,s.BLOB)}e.getAudioContext=function(){var t=this._audioCtx||(this._audioCtx=new(window["AudioContext"]||window["webkitAudioContext"]));t.sampleRate=22050;return t};e.supportsType=function(t){t=t.toLowerCase();return t=="wav"||t=="mp3"||t=="ogg"};e.supportsData=function(t){if(!(t instanceof o))return false;var i=t;var r=e.parseFileType(i);return r?true:false};e.prototype._pStartParsing=function(e){delete this._pContent;this._pContent=null;this._noAudio=false;t.prototype._pStartParsing.call(this,e)};e.prototype._pProceedParsing=function(){if(this._noAudio||this._pContent){return n.PARSING_DONE}else if(this.data instanceof o){this._pContent=new a(this.data.arraybytes,e.getAudioContext());this._pFinalizeAsset(this._pContent,this._iFileName)}else if(this.data instanceof ArrayBuffer){this._pContent=new a(this.data,e.getAudioContext());this._pFinalizeAsset(this._pContent,this._iFileName)}return n.PARSING_DONE};e.prototype.onLoadComplete=function(t){this._pContent=new a(t,e.getAudioContext());this._pFinalizeAsset(this._pContent,this._iFileName);this._iResumeParsing()};e.prototype.onError=function(t){this._noAudio=true;this._iResumeParsing()};e.parseFileType=function(t){t.position=0;t.position=0;if(t.readUnsignedShort()&65504){return"mp3"}t.position=0;if(t.readUTFBytes(4)=="RIFF")return"wav";t.position=0;if(t.readUTFBytes(4)=="OggS")return"ogg";t.position=0;return null};return e}(n);e.exports=h},{"awayjs-core/lib/data/WaveAudio":"awayjs-core/lib/data/WaveAudio","awayjs-core/lib/net/URLLoaderDataFormat":"awayjs-core/lib/net/URLLoaderDataFormat","awayjs-core/lib/parsers/ParserBase":"awayjs-core/lib/parsers/ParserBase","awayjs-core/lib/utils/ByteArray":"awayjs-core/lib/utils/ByteArray"}],"awayjs-core/lib/pool/IImageObject":[function(t,e,i){},{}],"awayjs-core/lib/projections/CoordinateSystem":[function(t,e,i){var r=function(){function t(){}t.LEFT_HANDED="leftHanded";t.RIGHT_HANDED="rightHanded";return t}();e.exports=r},{}],"awayjs-core/lib/projections/FreeMatrixProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/projections/PerspectiveProjection");var s=t("awayjs-core/lib/projections/ProjectionBase");var n=function(t){r(e,t);function e(){t.call(this);this._pMatrix.copyFrom((new a).matrix)}Object.defineProperty(e.prototype,"near",{set:function(t){this._pNear=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{set:function(t){this._pFar=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iAspectRatio",{set:function(t){this._pAspectRatio=t},enumerable:true,configurable:true});e.prototype.clone=function(){var t=new e;t._pMatrix.copyFrom(this._pMatrix);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t.pInvalidateMatrix();return t};e.prototype.pUpdateMatrix=function(){this._pMatrixInvalid=false};return e}(s);e.exports=n},{"awayjs-core/lib/projections/PerspectiveProjection":"awayjs-core/lib/projections/PerspectiveProjection","awayjs-core/lib/projections/ProjectionBase":"awayjs-core/lib/projections/ProjectionBase"}],"awayjs-core/lib/projections/IProjection":[function(t,e,i){},{}],"awayjs-core/lib/projections/ObliqueNearPlaneProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/events/ProjectionEvent");var n=t("awayjs-core/lib/projections/ProjectionBase");var o=function(t){r(e,t);function e(e,i){var r=this;t.call(this);this.baseProjection=e;this.plane=i;this._onProjectionMatrixChangedDelegate=function(t){return r.onProjectionMatrixChanged(t)}}Object.defineProperty(e.prototype,"frustumCorners",{get:function(){return this._baseProjection.frustumCorners},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"near",{get:function(){return this._baseProjection.near},set:function(t){this._baseProjection.near=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{get:function(){return this._baseProjection.far},set:function(t){this._baseProjection.far=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iAspectRatio",{get:function(){return this._baseProjection._iAspectRatio},set:function(t){this._baseProjection._iAspectRatio=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"plane",{get:function(){return this._plane},set:function(t){this._plane=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"baseProjection",{set:function(t){if(this._baseProjection){this._baseProjection.removeEventListener(s.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate)}this._baseProjection=t;if(this._baseProjection){this._baseProjection.addEventListener(s.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate)}this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.onProjectionMatrixChanged=function(t){this.pInvalidateMatrix()};e.prototype.pUpdateMatrix=function(){this._pMatrix.copyFrom(this._baseProjection.matrix);var t=this._plane.a;var e=this._plane.b;var i=this._plane.c;var r=-this._plane.d+.05;var s=t>=0?1:-1;var n=e>=0?1:-1;var o=new a(s,n,1,1);var h=this._pMatrix.clone();h.invert();var u=h.transformVector(o);this._pMatrix.copyRowTo(3,o);var c=(u.x*o.x+u.y*o.y+u.z*o.z+u.w*o.w)/(t*u.x+e*u.y+i*u.z+r*u.w);this._pMatrix.copyRowFrom(2,new a(t*c,e*c,i*c,r*c))};return e}(n);e.exports=o},{"awayjs-core/lib/events/ProjectionEvent":"awayjs-core/lib/events/ProjectionEvent","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D","awayjs-core/lib/projections/ProjectionBase":"awayjs-core/lib/projections/ProjectionBase"}],"awayjs-core/lib/projections/OrthographicOffCenterProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/projections/ProjectionBase");var o=function(t){r(e,t);function e(e,i,r,a){t.call(this);this._minX=e;this._maxX=i;this._minY=r;this._maxY=a}Object.defineProperty(e.prototype,"minX",{get:function(){return this._minX},set:function(t){this._minX=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxX",{get:function(){return this._maxX},set:function(t){this._maxX=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minY",{get:function(){return this._minY},set:function(t){this._minY=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxY",{get:function(){return this._maxY},set:function(t){this._maxY=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new s(t,-e,i,1);r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e(this._minX,this._maxX,this._minY,this._maxY);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;return t};e.prototype.pUpdateMatrix=function(){var t=a.RAW_DATA_CONTAINER;var e=1/(this._maxX-this._minX);var i=1/(this._maxY-this._minY);var r=1/(this._pFar-this._pNear);t[0]=2*e;t[5]=2*i;t[10]=r;t[12]=-(this._maxX+this._minX)*e;t[13]=-(this._maxY+this._minY)*i;t[14]=-this._pNear*r;t[15]=1;t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=0;this._pMatrix.copyRawDataFrom(t);this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pFrustumCorners[12]=this._pFrustumCorners[21]=this._minX;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pFrustumCorners[15]=this._pFrustumCorners[18]=this._maxX;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pFrustumCorners[13]=this._pFrustumCorners[16]=this._minY;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pFrustumCorners[19]=this._pFrustumCorners[22]=this._maxY;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrixInvalid=false};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Matrix3DUtils":"awayjs-core/lib/geom/Matrix3DUtils","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D","awayjs-core/lib/projections/ProjectionBase":"awayjs-core/lib/projections/ProjectionBase"}],"awayjs-core/lib/projections/OrthographicProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/projections/ProjectionBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=500}t.call(this);this._projectionHeight=e}Object.defineProperty(e.prototype,"projectionHeight",{get:function(){return this._projectionHeight},set:function(t){if(t==this._projectionHeight){return}this._projectionHeight=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new s(t+this.matrix.rawData[12],-e+this.matrix.rawData[13],i,1);r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e;t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t.projectionHeight=this._projectionHeight;return t};e.prototype.pUpdateMatrix=function(){var t=a.RAW_DATA_CONTAINER;this._yMax=this._projectionHeight*.5;this._xMax=this._yMax*this._pAspectRatio;var e;var i;var r;var s;if(this._pScissorRect.x==0&&this._pScissorRect.y==0&&this._pScissorRect.width==this._pViewPort.width&&this._pScissorRect.height==this._pViewPort.height){e=-this._xMax;i=this._xMax;r=-this._yMax;s=this._yMax;t[0]=2/(this._projectionHeight*this._pAspectRatio);t[5]=2/this._projectionHeight;t[10]=1/(this._pFar-this._pNear);t[14]=this._pNear/(this._pNear-this._pFar);t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=0;t[15]=1}else{var n=this._xMax*(this._pViewPort.width/this._pScissorRect.width);var o=this._yMax*(this._pViewPort.height/this._pScissorRect.height);var h=this._xMax*(this._pScissorRect.x*2-this._pViewPort.width)/this._pScissorRect.width+this._xMax;var u=-this._yMax*(this._pScissorRect.y*2-this._pViewPort.height)/this._pScissorRect.height-this._yMax;e=h-n;i=h+n;r=u-o;s=u+o;t[0]=2*1/(i-e);t[5]=-2*1/(r-s);t[10]=1/(this._pFar-this._pNear);t[12]=(i+e)/(i-e);t[13]=(s+r)/(s-r);t[14]=this._pNear/(this.near-this.far);t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=0;t[15]=1}this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pFrustumCorners[12]=this._pFrustumCorners[21]=e;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pFrustumCorners[15]=this._pFrustumCorners[18]=i;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pFrustumCorners[13]=this._pFrustumCorners[16]=r;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pFrustumCorners[19]=this._pFrustumCorners[22]=s;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrix.copyRawDataFrom(t);this._pMatrixInvalid=false};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Matrix3DUtils":"awayjs-core/lib/geom/Matrix3DUtils","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D","awayjs-core/lib/projections/ProjectionBase":"awayjs-core/lib/projections/ProjectionBase"}],"awayjs-core/lib/projections/PerspectiveProjection":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3DUtils");var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-core/lib/projections/CoordinateSystem");var o=t("awayjs-core/lib/projections/ProjectionBase");var h=function(t){r(e,t);function e(e,i){if(e===void 0){e=60}if(i===void 0){i="leftHanded"}t.call(this,i);this._fieldOfView=60;this._focalLength=1e3;this._hFieldOfView=60;this._hFocalLength=1e3;this._preserveAspectRatio=true;this._preserveFocalLength=false;this.fieldOfView=e}Object.defineProperty(e.prototype,"preserveAspectRatio",{get:function(){return this._preserveAspectRatio},set:function(t){if(this._preserveAspectRatio==t)return;this._preserveAspectRatio=t;if(this._preserveAspectRatio)this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"preserveFocalLength",{get:function(){return this._preserveFocalLength},set:function(t){if(this._preserveFocalLength==t)return;this._preserveFocalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fieldOfView",{get:function(){return this._fieldOfView},set:function(t){if(this._fieldOfView==t)return;this._fieldOfView=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"focalLength",{get:function(){return this._focalLength},set:function(t){if(this._focalLength==t)return;this._focalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hFieldOfView",{get:function(){return this._hFieldOfView},set:function(t){if(this._hFieldOfView==t)return;this._hFieldOfView=t;this._hFocalLength=1/Math.tan(this._hFieldOfView*Math.PI/360);this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"hFocalLength",{get:function(){return this._hFocalLength},set:function(t){if(this._hFocalLength==t)return;this._hFocalLength=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){var r=new s(t,-e,i,1);r.x*=i;r.y*=i;r=this.unprojectionMatrix.transformVector(r);r.z=i;return r};e.prototype.clone=function(){var t=new e(this._fieldOfView);t._pNear=this._pNear;t._pFar=this._pFar;t._pAspectRatio=this._pAspectRatio;t._pCoordinateSystem=this._pCoordinateSystem;return t};e.prototype.pUpdateMatrix=function(){var t=a.RAW_DATA_CONTAINER;if(this._preserveFocalLength){if(this._preserveAspectRatio)this._hFocalLength=this._focalLength;this._fieldOfView=Math.atan(.5*this._pScissorRect.height/this._focalLength)*360/Math.PI;this._hFieldOfView=Math.atan(.5*this._pScissorRect.width/this._hFocalLength)*360/Math.PI}else{this._focalLength=.5*this._pScissorRect.height/Math.tan(this._fieldOfView*Math.PI/360);if(this._preserveAspectRatio)this._hFocalLength=this._focalLength;else this._hFocalLength=.5*this._pScissorRect.width/Math.tan(this._hFieldOfView*Math.PI/360)}var e=-this._pOriginX/this._hFocalLength;var i=(1-this._pOriginX)/this._hFocalLength;var r=-this._pOriginY/this._focalLength;var s=(1-this._pOriginY)/this._focalLength;var o;var h;var u;var c;var p=-((e-i)*this._pScissorRect.x+e*this._pScissorRect.width);var l=(r-s)*this._pScissorRect.y+r*this._pScissorRect.height;o=p-(i-e)*this._pViewPort.width;h=p;u=l;c=l+(s-r)*this._pViewPort.height;t[0]=2/(h-o);t[5]=2/(c-u);t[8]=(h+o)/(h-o);t[9]=(c+u)/(c-u);t[10]=(this._pFar+this._pNear)/(this._pFar-this._pNear);t[11]=1;t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[12]=t[13]=t[15]=0;t[14]=-2*this._pFar*this._pNear/(this._pFar-this._pNear);if(this._pCoordinateSystem==n.RIGHT_HANDED)t[5]=-t[5];this._pMatrix.copyRawDataFrom(t);this._pFrustumCorners[0]=this._pFrustumCorners[9]=this._pNear*o;this._pFrustumCorners[3]=this._pFrustumCorners[6]=this._pNear*h;this._pFrustumCorners[1]=this._pFrustumCorners[4]=this._pNear*u;this._pFrustumCorners[7]=this._pFrustumCorners[10]=this._pNear*c;this._pFrustumCorners[12]=this._pFrustumCorners[21]=this._pFar*o;this._pFrustumCorners[15]=this._pFrustumCorners[18]=this._pFar*h;this._pFrustumCorners[13]=this._pFrustumCorners[16]=this._pFar*u;this._pFrustumCorners[19]=this._pFrustumCorners[22]=this._pFar*c;this._pFrustumCorners[2]=this._pFrustumCorners[5]=this._pFrustumCorners[8]=this._pFrustumCorners[11]=this._pNear;this._pFrustumCorners[14]=this._pFrustumCorners[17]=this._pFrustumCorners[20]=this._pFrustumCorners[23]=this._pFar;this._pMatrixInvalid=false};return e}(o);e.exports=h},{"awayjs-core/lib/geom/Matrix3DUtils":"awayjs-core/lib/geom/Matrix3DUtils","awayjs-core/lib/geom/Vector3D":"awayjs-core/lib/geom/Vector3D","awayjs-core/lib/projections/CoordinateSystem":"awayjs-core/lib/projections/CoordinateSystem","awayjs-core/lib/projections/ProjectionBase":"awayjs-core/lib/projections/ProjectionBase"}],"awayjs-core/lib/projections/ProjectionBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/events/EventDispatcher");var o=t("awayjs-core/lib/events/ProjectionEvent");var h=t("awayjs-core/lib/errors/AbstractMethodError");var u=function(t){r(e,t);function e(e){if(e===void 0){e="leftHanded"}t.call(this);this._pMatrix=new a;this._pScissorRect=new s;this._pViewPort=new s;this._pNear=20;this._pFar=3e3;this._pAspectRatio=1;this._pMatrixInvalid=true;this._pFrustumCorners=[];this._pOriginX=.5;this._pOriginY=.5;this._unprojectionInvalid=true;this.coordinateSystem=e}Object.defineProperty(e.prototype,"coordinateSystem",{get:function(){return this._pCoordinateSystem},set:function(t){if(this._pCoordinateSystem==t)return;this._pCoordinateSystem=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frustumCorners",{get:function(){return this._pFrustumCorners},set:function(t){this._pFrustumCorners=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"matrix",{get:function(){if(this._pMatrixInvalid){this.pUpdateMatrix();this._pMatrixInvalid=false}return this._pMatrix},set:function(t){this._pMatrix=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"near",{get:function(){return this._pNear},set:function(t){if(t==this._pNear){return}this._pNear=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originX",{get:function(){return this._pOriginX},set:function(t){if(this._pOriginX==t)return;this._pOriginX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"originY",{get:function(){return this._pOriginY},set:function(t){if(this._pOriginY==t)return;this._pOriginY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"far",{get:function(){return this._pFar},set:function(t){if(t==this._pFar){return}this._pFar=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.project=function(t){var e=this.matrix.transformVector(t);e.x=e.x/e.w;e.y=-e.y/e.w;e.z=t.z;return e};Object.defineProperty(e.prototype,"unprojectionMatrix",{get:function(){if(this._unprojectionInvalid){if(!this._unprojection)this._unprojection=new a;this._unprojection.copyFrom(this.matrix);this._unprojection.invert();this._unprojectionInvalid=false}return this._unprojection},enumerable:true,configurable:true});e.prototype.unproject=function(t,e,i){throw new h};e.prototype.clone=function(){throw new h};Object.defineProperty(e.prototype,"_iAspectRatio",{get:function(){return this._pAspectRatio},set:function(t){if(this._pAspectRatio==t)return;this._pAspectRatio=t;this.pInvalidateMatrix()},enumerable:true,configurable:true});e.prototype.pInvalidateMatrix=function(){this._pMatrixInvalid=true;this._unprojectionInvalid=true;this.dispatchEvent(new o(o.MATRIX_CHANGED,this))};e.prototype.pUpdateMatrix=function(){throw new h};e.prototype._iUpdateScissorRect=function(t,e,i,r){this._pScissorRect.x=t;this._pScissorRect.y=e;this._pScissorRect.width=i;this._pScissorRect.height=r;this.pInvalidateMatrix()};e.prototype._iUpdateViewport=function(t,e,i,r){this._pViewPort.x=t;this._pViewPort.y=e;this._pViewPort.width=i;this._pViewPort.height=r;this.pInvalidateMatrix()};return e}(n);e.exports=u},{"awayjs-core/lib/errors/AbstractMethodError":"awayjs-core/lib/errors/AbstractMethodError","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/ProjectionEvent":"awayjs-core/lib/events/ProjectionEvent","awayjs-core/lib/geom/Matrix3D":"awayjs-core/lib/geom/Matrix3D","awayjs-core/lib/geom/Rectangle":"awayjs-core/lib/geom/Rectangle"}],"awayjs-core/lib/ui/Keyboard":[function(t,e,i){var r=function(){function t(){}t.A=65;t.ALTERNATE=18;t.AUDIO=16777239;t.B=66;t.BACK=16777238;t.BACKQUOTE=192;t.BACKSLASH=220;t.BACKSPACE=8;t.BLUE=16777219;t.C=67;t.CAPS_LOCK=20;t.CHANNEL_DOWN=16777221;t.CHANNEL_UP=16777221;t.COMMA=188;t.COMMAND=15;t.CONTROL=17;t.D=68;t.DELETE=46;t.DOWN=40;t.DVR=16777241;t.E=69;t.END=35;t.ENTER=13;t.EQUAL=187;t.ESCAPE=27;
t.EXIT=16777237;t.F=70;t.F1=112;t.F10=121;t.F11=122;t.F12=123;t.F13=124;t.F14=125;t.F15=126;t.F2=113;t.F3=114;t.F4=115;t.F5=116;t.F6=117;t.F7=118;t.F8=119;t.F9=120;t.FAST_FORWARD=16777226;t.G=71;t.GREEN=16777217;t.GUIDE=16777236;t.H=72;t.HELP=16777245;t.HOME=36;t.I=73;t.INFO=16777235;t.INPUT=16777243;t.INSERT=45;t.J=74;t.K=75;t.KEYNAME_BEGIN="Begin";t.KEYNAME_BREAK="Break";t.KEYNAME_CLEARDISPLAY="ClrDsp";t.KEYNAME_CLEARLINE="ClrLn";t.KEYNAME_DELETE="Delete";t.KEYNAME_DELETECHAR="DelChr";t.KEYNAME_DELETELINE="DelLn";t.KEYNAME_DOWNARROW="Down";t.KEYNAME_END="End";t.KEYNAME_EXECUTE="Exec";t.KEYNAME_F1="F1";t.KEYNAME_F10="F10";t.KEYNAME_F11="F11";t.KEYNAME_F12="F12";t.KEYNAME_F13="F13";t.KEYNAME_F14="F14";t.KEYNAME_F15="F15";t.KEYNAME_F16="F16";t.KEYNAME_F17="F17";t.KEYNAME_F18="F18";t.KEYNAME_F19="F19";t.KEYNAME_F2="F2";t.KEYNAME_F20="F20";t.KEYNAME_F21="F21";t.KEYNAME_F22="F22";t.KEYNAME_F23="F23";t.KEYNAME_F24="F24";t.KEYNAME_F25="F25";t.KEYNAME_F26="F26";t.KEYNAME_F27="F27";t.KEYNAME_F28="F28";t.KEYNAME_F29="F29";t.KEYNAME_F3="F3";t.KEYNAME_F30="F30";t.KEYNAME_F31="F31";t.KEYNAME_F32="F32";t.KEYNAME_F33="F33";t.KEYNAME_F34="F34";t.KEYNAME_F35="F35";t.KEYNAME_F4="F4";t.KEYNAME_F5="F5";t.KEYNAME_F6="F6";t.KEYNAME_F7="F7";t.KEYNAME_F8="F8";t.KEYNAME_F9="F9";t.KEYNAME_FIND="Find";t.KEYNAME_HELP="Help";t.KEYNAME_HOME="Home";t.KEYNAME_INSERT="Insert";t.KEYNAME_INSERTCHAR="InsChr";t.KEYNAME_INSERTLINE="LnsLn";t.KEYNAME_LEFTARROW="Left";t.KEYNAME_MENU="Menu";t.KEYNAME_MODESWITCH="ModeSw";t.KEYNAME_NEXT="Next";t.KEYNAME_PAGEDOWN="PgDn";t.KEYNAME_PAGEUP="PgUp";t.KEYNAME_PAUSE="Pause";t.KEYNAME_PREV="Prev";t.KEYNAME_PRINT="Print";t.KEYNAME_PRINTSCREEN="PrntScrn";t.KEYNAME_REDO="Redo";t.KEYNAME_RESET="Reset";t.KEYNAME_RIGHTARROW="Right";t.KEYNAME_SCROLLLOCK="ScrlLck";t.KEYNAME_SELECT="Select";t.KEYNAME_STOP="Stop";t.KEYNAME_SYSREQ="SysReq";t.KEYNAME_SYSTEM="Sys";t.KEYNAME_UNDO="Undo";t.KEYNAME_UPARROW="Up";t.KEYNAME_USER="User";t.L=76;t.LAST=16777233;t.LEFT=37;t.LEFTBRACKET=219;t.LIVE=16777232;t.M=77;t.MASTER_SHELL=16777246;t.MENU=16777234;t.MINUS=189;t.N=78;t.NEXT=16777230;t.NUMBER_0=48;t.NUMBER_1=49;t.NUMBER_2=50;t.NUMBER_3=51;t.NUMBER_4=52;t.NUMBER_5=53;t.NUMBER_6=54;t.NUMBER_7=55;t.NUMBER_8=56;t.NUMBER_9=57;t.NUMPAD=21;t.NUMPAD_0=96;t.NUMPAD_1=97;t.NUMPAD_2=98;t.NUMPAD_3=99;t.NUMPAD_4=100;t.NUMPAD_5=101;t.NUMPAD_6=102;t.NUMPAD_7=103;t.NUMPAD_8=104;t.NUMPAD_9=105;t.NUMPAD_ADD=107;t.NUMPAD_DECIMAL=110;t.NUMPAD_DIVIDE=111;t.NUMPAD_ENTER=108;t.NUMPAD_MULTIPLY=106;t.NUMPAD_SUBTRACT=109;t.O=79;t.P=80;t.PAGE_DOWN=34;t.PAGE_UP=33;t.PAUSE=16777224;t.PERIOD=190;t.PLAY=16777223;t.PREVIOUS=16777231;t.Q=81;t.QUOTE=222;t.R=82;t.RECORD=16777222;t.RED=16777216;t.REWIND=16777227;t.RIGHT=39;t.RIGHTBRACKET=221;t.S=83;t.SEARCH=16777247;t.SEMICOLON=186;t.SETUP=16777244;t.SHIFT=16;t.SKIP_BACKWARD=16777229;t.SKIP_FORWARD=16777228;t.SLASH=191;t.SPACE=32;t.STOP=16777225;t.SUBTITLE=16777240;t.T=84;t.TAB=9;t.U=85;t.UP=38;t.V=86;t.VOD=16777242;t.W=87;t.X=88;t.Y=89;t.YELLOW=16777218;t.Z=90;return t}();e.exports=r},{}],"awayjs-core/lib/utils/BitmapImageUtils":[function(t,e,i){var r=t("awayjs-core/lib/utils/ColorUtils");var a=function(){function t(){}t._fillRect=function(t,e,i,a){if(i==0&&a){t.clearRect(e.x,e.y,e.width,e.height)}else{var s=r.float32ColorToARGB(i);if(a)t.fillStyle="rgba("+s[1]+","+s[2]+","+s[3]+","+s[0]/255+")";else t.fillStyle="rgba("+s[1]+","+s[2]+","+s[3]+",1)";t.fillRect(e.x,e.y,e.width,e.height)}};t._copyPixels=function(t,e,i,r){t.drawImage(e,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)};t._draw=function(t,e,i,r,a,s,n){t.save();if(i!=null)t.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);if(s!=null)t.drawImage(e,s.x,s.y,s.width,s.height);else t.drawImage(e,0,0);t.restore()};return t}();e.exports=a},{"awayjs-core/lib/utils/ColorUtils":"awayjs-core/lib/utils/ColorUtils"}],"awayjs-core/lib/utils/ByteArrayBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var a=function(){function t(){this.position=0;this.length=0;this._mode=""}t.prototype.writeByte=function(t){throw"Virtual method"};t.prototype.readByte=function(){throw"Virtual method"};t.prototype.writeUnsignedByte=function(t){throw"Virtual method"};t.prototype.readUnsignedByte=function(){throw"Virtual method"};t.prototype.writeUnsignedShort=function(t){throw"Virtual method"};t.prototype.readUnsignedShort=function(){throw"Virtual method"};t.prototype.writeUnsignedInt=function(t){throw"Virtual method"};t.prototype.readUnsignedInt=function(){throw"Virtual method"};t.prototype.writeFloat=function(t){throw"Virtual method"};t.prototype.toFloatBits=function(t){throw"Virtual method"};t.prototype.readFloat=function(t){throw"Virtual method"};t.prototype.fromFloatBits=function(t){throw"Virtual method"};t.prototype.getBytesAvailable=function(){throw new r("ByteArrayBase, getBytesAvailable() not implemented ")};t.prototype.toString=function(){return"[ByteArray] ( "+this._mode+" ) position="+this.position+" length="+this.length};t.prototype.compareEqual=function(t,e){if(e==undefined||e>this.length-this.position)e=this.length-this.position;if(e>t.length-t.position)e=t.length-t.position;var i=e;var r=true;while(r&&e>=4){e-=4;if(this.readUnsignedInt()!=t.readUnsignedInt())r=false}while(r&&e>=1){e--;if(this.readUnsignedByte()!=t.readUnsignedByte())r=false}var a;this.position-=a-e;t.position-=a-e;return r};t.prototype.writeBase64String=function(t){for(var e=0;e<t.length;e++){var i=t.charAt(e)}};t.prototype.dumpToConsole=function(){var t=this.position;this.position=0;var e=8;function i(t,e){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];var r="";for(var a=0;a<e;a++){r=i[t>>(a<<2)&15]+r}return r}for(var r=0;r<this.length;r+=e){var a=i(r,4)+":";for(var s=0;s<e&&r+s<this.length;s++){a+=" "+i(this.readUnsignedByte(),2)}console.log(a)}this.position=t};t.prototype.readBase64String=function(e){if(e==undefined||e>this.length-this.position)e=this.length-this.position;if(!(e>0))return"";return t.internalGetBase64String(e,this.readUnsignedByte,this)};t.internalGetBase64String=function(e,i,r){var a="";var s,n,o,h,u,c,p;var l=t.Base64Key;while(e>=3){s=i.apply(r);n=i.apply(r);o=i.apply(r);h=s>>2;u=(s&3)<<4|n>>4;c=(n&15)<<2|o>>6;p=o&63;a+=l.charAt(h)+l.charAt(u)+l.charAt(c)+l.charAt(p);e-=3}if(e==2){s=i.apply(r);n=i.apply(r);h=s>>2;u=(s&3)<<4|n>>4;c=(n&15)<<2;a+=l.charAt(h)+l.charAt(u)+l.charAt(c)+"="}else if(e==1){s=i.apply(r);h=s>>2;u=(s&3)<<4;a+=l.charAt(h)+l.charAt(u)+"=="}return a};t.Base64Key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";return t}();e.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":"awayjs-core/lib/errors/AbstractMethodError"}],"awayjs-core/lib/utils/ByteArrayBuffer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/utils/ByteArrayBase");var s=function(t){r(e,t);function e(){t.call(this);this._bytes=[];this._mode="Array"}e.prototype.writeByte=function(t){var e=~~t;this._bytes[this.position++]=e;if(this.position>this.length){this.length=this.position}};e.prototype.readByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}return this._bytes[this.position++]};e.prototype.writeUnsignedByte=function(t){var e=~~t;this._bytes[this.position++]=e&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedByte=function(){if(this.position>=this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}return this._bytes[this.position++]};e.prototype.writeUnsignedShort=function(t){var e=~~t;this._bytes[this.position++]=e&255;this._bytes[this.position++]=e>>8&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedShort=function(){if(this.position+2>this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}var t=this._bytes[this.position]|this._bytes[this.position+1]<<8;this.position+=2;return t};e.prototype.writeUnsignedInt=function(t){var e=~~t;this._bytes[this.position++]=e&255;this._bytes[this.position++]=e>>>8&255;this._bytes[this.position++]=e>>>16&255;this._bytes[this.position++]=e>>>24&255;if(this.position>this.length){this.length=this.position}};e.prototype.readUnsignedInt=function(){if(this.position+4>this.length){throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length}var t=this._bytes[this.position]|this._bytes[this.position+1]<<8|this._bytes[this.position+2]<<16|this._bytes[this.position+3]<<24;this.position+=4;return t>>>0};e.prototype.writeFloat=function(t){this.writeUnsignedInt(this.toFloatBits(Number(t)))};e.prototype.toFloatBits=function(t){if(t==0){return 0}var e=0;if(t<0){t=-t;e=1}else{e=0}var i=Math.log(t)/Math.log(2);i=Math.floor(i);t=t*Math.pow(2,23-i);var r=Math.floor(t)-8388608;i=i+127;return e<<31>>>0|i<<23|r};e.prototype.readFloat=function(t){return this.fromFloatBits(this.readUnsignedInt())};e.prototype.fromFloatBits=function(t){if(t==0){return 0}var e=t>>>23&255;var i=t&8388607|8388608;var r=Math.pow(2,e-127-23)*i;if(t>>>31!=0){r=-r}return r};return e}(a);e.exports=s},{"awayjs-core/lib/utils/ByteArrayBase":"awayjs-core/lib/utils/ByteArrayBase"}],"awayjs-core/lib/utils/ByteArray":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/utils/ByteArrayBase");var s=function(t){r(e,t);function e(e){if(e===void 0){e=4}t.call(this);this._mode="Typed array";this.maxlength=Math.max(e+255&~255,4);this.arraybytes=new ArrayBuffer(this.maxlength);this.unalignedarraybytestemp=new ArrayBuffer(16)}e.prototype.ensureWriteableSpace=function(t){this.ensureSpace(t+this.position)};e.prototype.setArrayBuffer=function(t){this.ensureSpace(t.byteLength);this.length=t.byteLength;var e=new Int8Array(t);var i=new Int8Array(this.arraybytes,0,this.length);i.set(e);this.position=0};e.prototype.getBytesAvailable=function(){return this.length-this.position};e.prototype.ensureSpace=function(t){if(t>this.maxlength){var e=t+255&~255;var i=new ArrayBuffer(e);var r=new Uint8Array(this.arraybytes,0,this.length);var a=new Uint8Array(i,0,this.length);a.set(r);this.arraybytes=i;this.maxlength=e}};e.prototype.writeByte=function(t){this.ensureWriteableSpace(1);var e=new Int8Array(this.arraybytes);e[this.position++]=~~t;if(this.position>this.length){this.length=this.position}};e.prototype.readByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;var t=new Int8Array(this.arraybytes);return t[this.position++]};e.prototype.readBytes=function(t,e,i){if(e===void 0){e=0}if(i===void 0){i=0}if(i==null)i=t.length;t.ensureWriteableSpace(e+i);var r=new Int8Array(t.arraybytes);var a=new Int8Array(this.arraybytes);r.set(a.subarray(this.position,this.position+i),e);this.position+=i;if(i+e>t.length)t.length+=i+e-t.length};e.prototype.writeUnsignedByte=function(t){this.ensureWriteableSpace(1);var e=new Uint8Array(this.arraybytes);e[this.position++]=~~t&255;if(this.position>this.length)this.length=this.position};e.prototype.readUnsignedByte=function(){if(this.position>=this.length)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;var t=new Uint8Array(this.arraybytes);return t[this.position++]};e.prototype.writeUnsignedShort=function(t){this.ensureWriteableSpace(2);if((this.position&1)==0){var e=new Uint16Array(this.arraybytes);e[this.position>>1]=~~t&65535}else{var e=new Uint16Array(this.unalignedarraybytestemp,0,1);e[0]=~~t&65535;var i=new Uint8Array(this.arraybytes,this.position,2);var r=new Uint8Array(this.unalignedarraybytestemp,0,2);i.set(r)}this.position+=2;if(this.position>this.length)this.length=this.position};e.prototype.readUTFBytes=function(t){var e="";var i=this.position+t;var r=new DataView(this.arraybytes);while(this.position<i){var a=r.getUint8(this.position++);if(a<128){if(a==0)break;e+=String.fromCharCode(a)}else if(a<224){e+=String.fromCharCode((a&63)<<6|r.getUint8(this.position++)&127)}else if(a<240){var s=r.getUint8(this.position++);e+=String.fromCharCode((a&31)<<12|(s&127)<<6|r.getUint8(this.position++)&127)}else{var s=r.getUint8(this.position++);var n=r.getUint8(this.position++);e+=String.fromCharCode((a&15)<<18|(s&127)<<12|n<<6&127|r.getUint8(this.position++)&127)}}return e};e.prototype.readInt=function(){var t=new DataView(this.arraybytes);var e=t.getInt32(this.position,true);this.position+=4;return e};e.prototype.readShort=function(){var t=new DataView(this.arraybytes);var e=t.getInt16(this.position,true);this.position+=2;return e};e.prototype.readDouble=function(){var t=new DataView(this.arraybytes);var e=t.getFloat64(this.position,true);this.position+=8;return e};e.prototype.readUnsignedShort=function(){if(this.position>this.length+2)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if((this.position&1)==0){var t=new Uint16Array(this.arraybytes);var e=this.position>>1;this.position+=2;return t[e]}else{var t=new Uint16Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,2);var r=new Uint8Array(this.unalignedarraybytestemp,0,2);r.set(i);this.position+=2;return t[0]}};e.prototype.writeUnsignedInt=function(t){this.ensureWriteableSpace(4);if((this.position&3)==0){var e=new Uint32Array(this.arraybytes);e[this.position>>2]=~~t&4294967295}else{var e=new Uint32Array(this.unalignedarraybytestemp,0,1);e[0]=~~t&4294967295;var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);i.set(r)}this.position+=4;if(this.position>this.length)this.length=this.position};e.prototype.readUnsignedInt=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Position="+this.position+", Length="+this.length;if((this.position&3)==0){var t=new Uint32Array(this.arraybytes);var e=this.position>>2;this.position+=4;return t[e]}else{var t=new Uint32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);r.set(i);this.position+=4;return t[0]}};e.prototype.writeFloat=function(t){this.ensureWriteableSpace(4);if((this.position&3)==0){var e=new Float32Array(this.arraybytes);e[this.position>>2]=t}else{var e=new Float32Array(this.unalignedarraybytestemp,0,1);e[0]=t;var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);i.set(r)}this.position+=4;if(this.position>this.length)this.length=this.position};e.prototype.readFloat=function(){if(this.position>this.length+4)throw"ByteArray out of bounds read. Positon="+this.position+", Length="+this.length;if((this.position&3)==0){var t=new Float32Array(this.arraybytes);var e=this.position>>2;this.position+=4;return t[e]}else{var t=new Float32Array(this.unalignedarraybytestemp,0,1);var i=new Uint8Array(this.arraybytes,this.position,4);var r=new Uint8Array(this.unalignedarraybytestemp,0,4);r.set(i);this.position+=4;return t[0]}};return e}(a);e.exports=s},{"awayjs-core/lib/utils/ByteArrayBase":"awayjs-core/lib/utils/ByteArrayBase"}],"awayjs-core/lib/utils/CSS":[function(t,e,i){var r=function(){function t(){}t.setElementSize=function(t,e,i){t.style.width=e+"px";t.style.height=i+"px";t["width"]=e;t["height"]=i};t.setElementWidth=function(t,e){t.style.width=e+"px";t["width"]=e};t.setElementHeight=function(t,e){t.style.height=e+"px";t["height"]=e};t.setElementX=function(t,e){t.style.position="absolute";t.style.left=e+"px"};t.setElementY=function(t,e){t.style.position="absolute";t.style.top=e+"px"};t.getElementVisibility=function(t){return t.style.visibility=="visible"};t.setElementVisibility=function(t,e){if(e){t.style.visibility="visible"}else{t.style.visibility="hidden"}};t.setElementAlpha=function(t,e){if(t instanceof HTMLCanvasElement){var i=t.getContext("2d");i.globalAlpha=e}};t.setElementPosition=function(t,e,i,r){if(r===void 0){r=false}if(r){t.style.position="absolute"}else{t.style.position="relative"}t.style.left=e+"px";t.style.top=i+"px"};return t}();e.exports=r},{}],"awayjs-core/lib/utils/ColorUtils":[function(t,e,i){var r=function(){function t(){}t.float32ColorToARGB=function(t){var e=(t&4278190080)>>>24;var i=(t&16711680)>>>16;var r=(t&65280)>>>8;var a=t&255;var s=[e,i,r,a];return s};t.ARGBtoFloat32=function(t,e,i,r){return t<<24|e<<16|i<<8|r};t.componentToHex=function(t){var e=t.toString(16);return e.length==1?"0"+e:e};t.RGBToHexString=function(e){return"#"+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])};t.ARGBToHexString=function(e){return"#"+t.componentToHex(e[0])+t.componentToHex(e[1])+t.componentToHex(e[2])+t.componentToHex(e[3])};return t}();e.exports=r},{}],"awayjs-core/lib/utils/Debug":[function(t,e,i){var r=t("awayjs-core/lib/errors/PartialImplementationError");var a=function(){function t(){}t.breakpoint=function(){t["break"]()};t.throwPIROnKeyWordOnly=function(e,i){if(i===void 0){i=true}if(!i)t.keyword=null;else t.keyword=e};t.throwPIR=function(e,i,a){t.logPIR("PartialImplementationError "+e,i,a);if(t.THROW_ERRORS){if(t.keyword){var s=e+i+a;if(s.indexOf(t.keyword)==-1)return}throw new r(e+"."+i+": "+a)}};t.logPIR=function(e,i,r){if(r===void 0){r=""}if(t.LOG_PI_ERRORS)console.log(e+"."+i+": "+r)};t.log=function(){var e=[];for(var i=0;i<arguments.length;i++){e[i-0]=arguments[i]}if(t.ENABLE_LOG)console.log(e)};t.THROW_ERRORS=true;t.ENABLE_LOG=true;t.LOG_PI_ERRORS=true;t.keyword=null;return t}();e.exports=a},{"awayjs-core/lib/errors/PartialImplementationError":"awayjs-core/lib/errors/PartialImplementationError"}],"awayjs-core/lib/utils/IArrayBufferViewClass":[function(t,e,i){},{}],"awayjs-core/lib/utils/ImageUtils":[function(t,e,i){var r=function(){function t(){}t.isImage2DValid=function(e){if(e==null)return true;return t.isDimensionValid(e.width)&&t.isDimensionValid(e.height)};t.isHTMLImageElementValid=function(e){if(e==null)return true;return t.isDimensionValid(e.width)&&t.isDimensionValid(e.height)};t.isDimensionValid=function(e){return e>=1&&e<=t.MAX_SIZE&&t.isPowerOfTwo(e)};t.isPowerOfTwo=function(t){return t?(t&-t)==t:false};t.getBestPowerOf2=function(e){var i=1;while(i<e)i<<=1;if(i>t.MAX_SIZE)i=t.MAX_SIZE;return i};t.MAX_SIZE=2048;return t}();e.exports=r},{}],"awayjs-core/lib/utils/MipmapGenerator":[function(t,e,i){var r=t("awayjs-core/lib/data/BitmapImage2D");var a=t("awayjs-core/lib/geom/Matrix");var s=t("awayjs-core/lib/geom/Rectangle");var n=function(){function t(){}t._generateMipMaps=function(e,i,r){if(r===void 0){r=false}var a=e.width;var s=e.height;var n=0;var o;t._rect.width=a;t._rect.height=s;while(a>=1||s>=1){o=i[n]=t._getMipmapHolder(i[n],t._rect.width,t._rect.height);if(r)o.fillRect(t._rect,0);t._matrix.a=t._rect.width/e.width;t._matrix.d=t._rect.height/e.height;o.draw(e,t._matrix);a>>=1;s>>=1;t._rect.width=a>1?a:1;t._rect.height=s>1?s:1;n++}};t._getMipmapHolder=function(e,i,a){if(e){if(e.width==i&&e.height==a)return e;t._freeMipMapHolder(e)}if(!t._mipMaps[i]){t._mipMaps[i]=[];t._mipMapUses[i]=[]}if(!t._mipMaps[i][a]){e=t._mipMaps[i][a]=new r(i,a,true);t._mipMapUses[i][a]=1}else{t._mipMapUses[i][a]=t._mipMapUses[i][a]+1;e=t._mipMaps[i][a]}return e};t._freeMipMapHolder=function(e){var i=e.width;var r=e.height;if(--t._mipMapUses[i][r]==0){t._mipMaps[i][r].dispose();t._mipMaps[i][r]=null}};t._mipMaps=[];t._mipMapUses=[];t._matrix=new a;t._rect=new s;return t}();e.exports=n},{"awayjs-core/lib/data/BitmapImage2D":"awayjs-core/lib/data/BitmapImage2D","awayjs-core/lib/geom/Matrix":"awayjs-core/lib/geom/Matrix","awayjs-core/lib/geom/Rectangle":"awayjs-core/lib/geom/Rectangle"}],"awayjs-core/lib/utils/RequestAnimationFrame":[function(t,e,i){var r=t("awayjs-core/lib/utils/getTimer");var a=function(){function t(t,e){var i=this;this._active=false;this._argsArray=new Array;this._getTimer=r;this.setCallback(t,e);this._rafUpdateFunction=function(){if(i._active)i._tick()};this._argsArray.push(this._dt)}t.prototype.setCallback=function(t,e){this._callback=t;this._callbackContext=e};t.prototype.start=function(){this._prevTime=this._getTimer();this._active=true;if(window.requestAnimationFrame){window.requestAnimationFrame(this._rafUpdateFunction)}else{if(window["mozRequestAnimationFrame"])window.requestAnimationFrame=window["mozRequestAnimationFrame"];else if(window["webkitRequestAnimationFrame"])window.requestAnimationFrame=window["webkitRequestAnimationFrame"];else if(window["oRequestAnimationFrame"])window.requestAnimationFrame=window["oRequestAnimationFrame"]}};t.prototype.stop=function(){this._active=false};Object.defineProperty(t.prototype,"active",{get:function(){return this._active},enumerable:true,configurable:true});t.prototype._tick=function(){this._currentTime=this._getTimer();this._dt=this._currentTime-this._prevTime;this._argsArray[0]=this._dt;this._callback.apply(this._callbackContext,this._argsArray);window.requestAnimationFrame(this._rafUpdateFunction);this._prevTime=this._currentTime};return t}();e.exports=a},{"awayjs-core/lib/utils/getTimer":"awayjs-core/lib/utils/getTimer"}],"awayjs-core/lib/utils/Timer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/Error");var s=t("awayjs-core/lib/events/EventDispatcher");var n=t("awayjs-core/lib/events/TimerEvent");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=0}t.call(this);this._repeatCount=0;this._currentCount=0;this._running=false;this._delay=e;this._repeatCount=i;if(isNaN(e)||e<0)throw new a("Delay is negative or not a number")}Object.defineProperty(e.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"delay",{get:function(){return this._delay},set:function(t){this._delay=t;if(this._running){this.stop();this.start()}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(t){this._repeatCount=t},enumerable:true,configurable:true});e.prototype.reset=function(){if(this._running)this.stop();this._currentCount=0};Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:true,configurable:true});e.prototype.start=function(){var t=this;this._running=true;clearInterval(this._iid);this._iid=setInterval(function(){return t.tick()},this._delay)};e.prototype.stop=function(){this._running=false;clearInterval(this._iid)};e.prototype.tick=function(){this._currentCount++;if(this._repeatCount>0&&this._currentCount>=this._repeatCount){this.stop();this.dispatchEvent(new n(n.TIMER));this.dispatchEvent(new n(n.TIMER_COMPLETE))}else{this.dispatchEvent(new n(n.TIMER))}};return e}(s);e.exports=o},{"awayjs-core/lib/errors/Error":"awayjs-core/lib/errors/Error","awayjs-core/lib/events/EventDispatcher":"awayjs-core/lib/events/EventDispatcher","awayjs-core/lib/events/TimerEvent":"awayjs-core/lib/events/TimerEvent"}],"awayjs-core/lib/utils/XmlUtils":[function(t,e,i){var r=function(){function t(){}t.getChildrenWithTag=function(t,e){var i=document.createDocumentFragment();if(t){var r=t.childNodes.length;for(var a=0;a<r;a++){var s=t.childNodes[a];if(s!=null){if(s.nodeName==e){i.appendChild(s)}}}}return i.childNodes};t.filterListByParam=function(t,e,i){var r=document.createDocumentFragment();if(t){var a=t.length;for(var s=0;s<a;s++){var n=t[s];if(n!=null){if(n.attributes.getNamedItem(e).value==i){r.appendChild(n)}}}}return r.childNodes};t.strToXml=function(t){var e=new DOMParser;var i=e.parseFromString(t,"text/xml");return i};t.nodeToString=function(t){if(!t)return"";var e=(new XMLSerializer).serializeToString(t);return e};t.readAttributeValue=function(t,e){var i=t.attributes;if(i==undefined){return""}var r=i.getNamedItem(e);if(!r){return""}return r.value};t.writeAttributeValue=function(t,e,i){var r=new Attr;r.name=e;r.value=i;r=t.attributes.setNamedItem(r);console.log("XmlUltils - writeAttributeValue() - name: "+r.name+", value: "+r.value)};t.hasAttribute=function(t,e){var i=t.attributes;if(i==undefined){return false}var r=i.getNamedItem(e);return r!=null};return t}();e.exports=r},{}],"awayjs-core/lib/utils/getTimer":[function(t,e,i){function r(){return Date.now()}e.exports=r},{}],"awayjs-core/lib/vos/IAttributesBufferVO":[function(t,e,i){},{}],"awayjs-core/lib/vos/IAttributesVO":[function(t,e,i){},{}]},{},[]);


require=function t(e,i,r){function s(o,a){if(!i[o]){if(!e[o]){var l=typeof require=="function"&&require;if(!a&&l)return l(o,!0);if(n)return n(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){var i=e[o][1][t];return s(i?i:t)},u,u.exports,t,e,i,r)}return i[o].exports}var n=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({"awayjs-display/lib/IRenderer":[function(t,e,i){},{}],"awayjs-display/lib/adapters/IDisplayObjectAdapter":[function(t,e,i){},{}],"awayjs-display/lib/adapters/IMovieClipAdapter":[function(t,e,i){},{}],"awayjs-display/lib/animators/IAnimationSet":[function(t,e,i){},{}],"awayjs-display/lib/animators/IAnimator":[function(t,e,i){},{}],"awayjs-display/lib/animators/nodes/AnimationNodeBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"stateClass",{get:function(){return this._pStateClass},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.assetType="[asset AnimationNodeBase]";return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/base/AlignmentMode":[function(t,e,i){var r=function(){function t(){}t.REGISTRATION_POINT="registrationPoint";t.PIVOT_POINT="pivot";return t}();e.exports=r},{}],"awayjs-display/lib/base/CurveSubGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/Float3Attributes");var n=t("awayjs-core/lib/attributes/Float2Attributes");var o=t("awayjs-display/lib/base/SubGeometryBase");var a=t("awayjs-display/lib/utils/SubGeometryUtils");var l=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,e);this._numVertices=0;this._uvsDirty=true;this._autoDeriveUVs=false;this._scaleU=1;this._scaleV=1;this.devisions=32;this._positions=this._concatenatedBuffer?this._concatenatedBuffer.getView(0)||new s(this._concatenatedBuffer):new s;this._curves=this._concatenatedBuffer?this._concatenatedBuffer.getView(1)||new n(this._concatenatedBuffer):new n;this._numVertices=this._positions.count}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveUVs",{get:function(){return this._autoDeriveUVs},set:function(t){if(this._autoDeriveUVs==t)return;this._autoDeriveUVs=t;if(t)this._uvsDirty=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleU",{get:function(){return this._scaleU},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleV",{get:function(){return this._scaleV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"curves",{get:function(){return this._curves},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvs",{get:function(){if(this._uvsDirty)this.setUVs(this._uvs);return this._uvs},enumerable:true,configurable:true});e.prototype.getBoundingPositions=function(){return this._positions.get(this._numVertices)};e.prototype.getCell=function(t,e){var i=Math.floor((t-this.minx)*this.conversionX);var r=Math.floor((e-this.miny)*this.conversionY);if(i<0||i>this.devisions||r<0||r>this.devisions)return-1;return i+r*this.devisions};e.prototype.buildGrid=function(){var t=this.positions.get(this._numVertices);var e=this.positions.dimensions;this.minx=Number.MAX_VALUE;this.maxx=-Number.MAX_VALUE;this.miny=Number.MAX_VALUE;this.maxy=-Number.MAX_VALUE;for(var i=0;i<t.length;i+=3){var r=t[i];var s=t[i+1];if(r<this.minx)this.minx=r;if(r>this.maxx)this.maxx=r;if(s<this.miny)this.miny=s;if(s>this.maxy)this.maxy=s}var n=this.maxx-this.minx;var o=this.maxy-this.miny;var a=32;this.devisions=Math.ceil(Math.sqrt(this.numVertices));this.devisions=Math.min(this.devisions,a);var l=this.devisions*this.devisions;var h=n/this.devisions;var u=o/this.devisions;this.conversionX=1/h;this.conversionY=1/u;var p;var c;var f;var _;var d;var y;var b;var m;var v;this.cells=new Array(l);for(var i=0;i<this._numVertices;i+=3){p=i+2;c=i+1;f=i+0;_=t[p*e];d=t[p*e+1];y=t[c*e];b=t[c*e+1];m=t[f*e];v=t[f*e+1];var g=Math.min(_,y,m)-this.minx;var w=Math.max(_,y,m)-this.minx;var j=Math.min(d,b,v)-this.miny;var P=Math.max(d,b,v)-this.miny;var x=Math.floor(g*this.conversionX);var C=Math.floor(j*this.conversionY);var O=Math.floor(w*this.conversionX);var D=Math.floor(P*this.conversionY);for(var T=x;T<=O;T++){for(var E=C;E<=D;E++){var A=T+E*this.devisions;var S=this.cells[A];if(S==null){S=new Array;this.cells[A]=S}S.push(p,c,f)}}}};e.prototype.hitTestPoint=function(t,e,i){var r=this.positions.dimensions;var s=this.curves.dimensions;var n=this.positions.get(this._numVertices);var o=this.curves.get(this._numVertices);var a;var l;var h;var u;var p;var c;var f;var _;var d;if(this.numVertices>150){if(this.cells==null){this.buildGrid()}var y=this.getCell(t,e);if(y==-1)return false;var b=this.cells[y];if(b==null)return false;var m=b.length;for(var v=0;v<m;v+=3){a=b[v];l=b[v+1];h=b[v+2];u=n[a*r];p=n[a*r+1];c=n[l*r];f=n[l*r+1];_=n[h*r];d=n[h*r+1];var g=u-t;var w=p-e;var j=f-p;var P=-(c-u);var x=g*j+w*P;if(x>0)continue;g=c-t;w=f-e;j=d-f;P=-(_-c);x=g*j+w*P;if(x>0)continue;g=_-t;w=d-e;j=p-d;P=-(u-_);x=g*j+w*P;if(x>0)continue;var C=o[a*s];if(C!=2){var O=c-u;var D=f-p;var T=_-u;var E=d-p;var A=t-u;var S=e-p;var M=O*E-T*D;var I=(A*E-T*S)/M;var N=(O*S-A*D)/M;var B=.5*I+N;var R=N;var L=B*B-R;var V=n[a*r+2];if(L>0&&V==-1){continue}else if(L<0&&V==1){continue}}return true}return false}for(var v=0;v<this._numVertices;v+=3){a=v+2;l=v+1;h=v+0;u=n[a*r];p=n[a*r+1];c=n[l*r];f=n[l*r+1];_=n[h*r];d=n[h*r+1];var g=u-t;var w=p-e;var j=f-p;var P=-(c-u);var x=g*j+w*P;if(x>0)continue;g=c-t;w=f-e;j=d-f;P=-(_-c);x=g*j+w*P;if(x>0)continue;g=_-t;w=d-e;j=p-d;P=-(u-_);x=g*j+w*P;if(x>0)continue;var C=o[a*s];if(C!=2){var O=c-u;var D=f-p;var T=_-u;var E=d-p;var A=t-u;var S=e-p;var M=O*E-T*D;var I=(A*E-T*S)/M;var N=(O*S-A*D)/M;var B=.5*I+N;var R=N;var L=B*B-R;var V=n[a*r+2];if(L>0&&V==-1){continue}else if(L<0&&V==1){continue}}return true}return false};e.prototype.setPositions=function(t,e){if(e===void 0){e=0}if(t==this._positions)return;if(t instanceof s){this.notifyVerticesDispose(this._positions);this._positions=t}else if(t){this._positions.set(t,e)}else{this.notifyVerticesDispose(this._positions);this._positions=new s(this._concatenatedBuffer)}this._numVertices=this._positions.count;if(this._autoDeriveUVs)this.notifyVerticesUpdate(this._uvs);this.pInvalidateBounds();this.notifyVerticesUpdate(this._positions);this._verticesDirty[this._positions.id]=false};e.prototype.setCurves=function(t,e){if(e===void 0){e=0}if(t==this._curves)return;if(t instanceof n){this.notifyVerticesDispose(this._curves);this._curves=t}else if(t){this._curves.set(t,e)}else{this.notifyVerticesDispose(this._curves);this._curves=new n(this._concatenatedBuffer)}this.notifyVerticesUpdate(this._curves);this._verticesDirty[this._curves.id]=false};e.prototype.setUVs=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveUVs){if(t==this._uvs)return;if(t instanceof n){this.notifyVerticesDispose(this._uvs);this._uvs=t}else if(t){if(!this._uvs)this._uvs=new n(this._concatenatedBuffer);this._uvs.set(t,e)}else if(this._uvs){this.notifyVerticesDispose(this._uvs);this._uvs=null;return}}else{this._uvs=a.generateUVs(this._pIndices,this._uvs,this._concatenatedBuffer,this._numVertices)}this.notifyVerticesUpdate(this._uvs);this._verticesDirty[this._uvs.id]=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._positions.dispose();this._positions=null;this._curves.dispose();this._curves=null;if(this._uvs){this._uvs.dispose();this._uvs=null}};e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);t.autoDeriveUVs=false;if(this.indices)t.setIndices(this.indices.clone());if(this.uvs)t.setUVs(this.uvs.clone());t.autoDeriveUVs=this._autoDeriveUVs;return t};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}a.scaleUVs(t,e,this.uvs,this.uvs.count)};e.prototype.scale=function(t){a.scale(t,this.positions,this._numVertices)};e.prototype.applyTransformation=function(t){a.applyTransformation(t,this.positions,null,null,this.positions.count)};e.prototype._iTestCollision=function(t,e,i,r){return t.testCurveCollision(this,e,i,r)};e.assetType="[asset CurveSubGeometry]";return e}(o);e.exports=l},{"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-display/lib/base/SubGeometryBase":"awayjs-display/lib/base/SubGeometryBase","awayjs-display/lib/utils/SubGeometryUtils":"awayjs-display/lib/utils/SubGeometryUtils"}],"awayjs-display/lib/base/CurveSubMesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/base/CurveSubGeometry");var n=t("awayjs-display/lib/base/SubMeshBase");var o=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=null}t.call(this);this._pParentMesh=i;this._subGeometry=e;this.material=r}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this)};e.assetType="[asset CurveSubMesh]";e.assetClass=s;return e}(n);e.exports=o},{"awayjs-display/lib/base/CurveSubGeometry":"awayjs-display/lib/base/CurveSubGeometry","awayjs-display/lib/base/SubMeshBase":"awayjs-display/lib/base/SubMeshBase"}],"awayjs-display/lib/base/DisplayObject":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Box");var n=t("awayjs-core/lib/geom/ColorTransform");var o=t("awayjs-core/lib/geom/Sphere");var a=t("awayjs-core/lib/geom/MathConsts");var l=t("awayjs-core/lib/geom/Matrix3D");var h=t("awayjs-core/lib/geom/Matrix3DUtils");var u=t("awayjs-core/lib/geom/Point");var p=t("awayjs-core/lib/geom/Vector3D");var c=t("awayjs-core/lib/library/AssetBase");var f=t("awayjs-display/lib/base/HierarchicalProperties");var _=t("awayjs-display/lib/bounds/BoundsType");var d=t("awayjs-display/lib/containers/DisplayObjectContainer");var y=t("awayjs-display/lib/base/AlignmentMode");var b=t("awayjs-display/lib/base/OrientationMode");var m=t("awayjs-display/lib/base/Transform");var v=t("awayjs-display/lib/pick/PickingCollisionVO");var g=t("awayjs-display/lib/events/DisplayObjectEvent");var w=function(t){r(e,t);function e(){t.call(this);this._queuedEvents=new Array;this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;this._pSceneTransform=new l;this._pIsEntity=false;this._pIsContainer=false;this._sessionID=-1;this._depthID=-16384;this._matrix3D=new l;this._inverseSceneTransform=new l;this._scenePosition=new p;this._explicitVisibility=true;this._explicitMaskId=-1;this._pImplicitVisibility=true;this._pImplicitMaskId=-1;this._pImplicitMaskIds=new Array;this._explicitMouseEnabled=true;this._pImplicitMouseEnabled=true;this._pImplicitColorTransform=new n;this._rotationX=0;this._rotationY=0;this._rotationZ=0;this._eulers=new p;this._flipY=new l;this._zOffset=0;this._skewX=0;this._skewY=0;this._skewZ=0;this._scaleX=1;this._scaleY=1;this._scaleZ=1;this._x=0;this._y=0;this._z=0;this._pivot=new p;this._pivotScale=new p;this._orientationMatrix=new l;this._pivotZero=true;this._pos=new p;this._rot=new p;this._ske=new p;this._sca=new p;this._pRenderables=new Array;this._entityNodes=new Array;this._inheritColorTransform=false;this._tempVector3D=new p;this.alignmentMode=y.REGISTRATION_POINT;this.castsShadows=true;this.orientationMode=b.DEFAULT;this._transformComponents=new Array(4);this._transformComponents[0]=this._pos;this._transformComponents[1]=this._rot;this._transformComponents[2]=this._ske;this._transformComponents[3]=this._sca;this._transform=new m(this);this._matrix3D.identity();this._flipY.appendScale(1,-1,1);this._boundsType=_.AXIS_ALIGNED_BOX}Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter},set:function(t){this._adapter=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inheritColorTransform",{get:function(){return this._inheritColorTransform},set:function(t){this._inheritColorTransform=t;this.pInvalidateHierarchicalProperties(f.COLOR_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._explicitColorTransform?this._explicitColorTransform.alphaMultiplier:1},set:function(t){if(!this._explicitColorTransform)this._iColorTransform=new n;this._explicitColorTransform.alphaMultiplier=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"boundsType",{get:function(){return this._boundsType},set:function(t){if(this._boundsType==t)return;this._boundsType=t;this._pInvalidateBounds();var e=this._entityNodes.length;for(var i=0;i<e;i++)this._entityNodes[i].updateBounds()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this.getBox().depth*this.scaleZ},set:function(t){if(this._depth==t)return;this._depth=t;this._setScaleZ(t/this.getBox().depth)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eulers",{get:function(){this._eulers.x=this.rotationX;this._eulers.y=this.rotationY;this._eulers.z=this.rotationZ;return this._eulers},set:function(t){this.rotationX=t.x;this.rotationY=t.y;this.rotationZ=t.z},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this.getBox().height*this.scaleY},set:function(t){if(this._height==t)return;this._height=t;this._setScaleY(t/this.getBox().height)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"index",{get:function(){if(this._pParent)return this._pParent.getChildIndex(this);return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"inverseSceneTransform",{get:function(){if(this._inverseSceneTransformDirty){this._inverseSceneTransform.copyFrom(this.sceneTransform);this._inverseSceneTransform.invert();this._inverseSceneTransformDirty=false}return this._inverseSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isEntity",{get:function(){return this._pIsEntity},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isContainer",{get:function(){return this._pIsContainer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loaderInfo",{get:function(){return this._loaderInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maskMode",{get:function(){return this._maskMode},set:function(t){if(this._maskMode==t)return;this._maskMode=t;this._explicitMaskId=t?this.id:-1;this.mouseEnabled=!t;if(this.isAsset(d))this.mouseChildren=!t;this.pInvalidateHierarchicalProperties(f.MASK_ID)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseEnabled",{get:function(){return this._explicitMouseEnabled},set:function(t){if(this._explicitMouseEnabled==t)return;this._explicitMouseEnabled=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseX",{get:function(){return this._mouseX},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseY",{get:function(){return this._mouseY},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"name",{get:function(){return this._pName},set:function(t){this._pName=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parent",{get:function(){return this._pParent},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"partition",{get:function(){return this._explicitPartition},set:function(t){if(this._explicitPartition==t)return;this._explicitPartition=t;this._iSetScene(this._pScene,this._pParent?this._pParent._iAssignedPartition:null);this.dispatchEvent(new g(g.PARTITION_CHANGED,this))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pickingCollider",{get:function(){return this._pPickingCollider},set:function(t){this._pPickingCollider=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pivot",{get:function(){return this._pivot},set:function(t){if(this._pivot.x==t.x&&this._pivot.y==t.y&&this._pivot.z==t.z)return;this._pivot.x=t.x;this._pivot.y=t.y;this._pivot.z=t.z;this.invalidatePivot()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationX",{get:function(){if(this._elementsDirty)this.updateElements();return this._rotationX*a.RADIANS_TO_DEGREES},set:function(t){if(this.rotationX==t)return;this._rotationX=t*a.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationY",{get:function(){if(this._elementsDirty)this.updateElements();return this._rotationY*a.RADIANS_TO_DEGREES},set:function(t){if(this.rotationY==t)return;this._rotationY=t*a.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rotationZ",{get:function(){if(this._elementsDirty)this.updateElements();return this._rotationZ*a.RADIANS_TO_DEGREES},set:function(t){if(this.rotationZ==t)return;this._rotationZ=t*a.DEGREES_TO_RADIANS;this.invalidateRotation()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleX",{get:function(){if(this._elementsDirty)this.updateElements();return this._scaleX},set:function(t){this._width=null;this._setScaleX(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleY",{get:function(){if(this._elementsDirty)this.updateElements();return this._scaleY},set:function(t){this._height=null;this._setScaleY(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleZ",{get:function(){if(this._elementsDirty)this.updateElements();return this._scaleZ},set:function(t){this._depth=null;this._setScaleZ(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewX",{get:function(){if(this._elementsDirty)this.updateElements();return this._skewX},set:function(t){if(this.skewX==t)return;this._skewX=t;this.invalidateSkew()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewY",{get:function(){if(this._elementsDirty)this.updateElements();return this._skewY},set:function(t){if(this.skewY==t)return;this._skewY=t;this.invalidateSkew()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skewZ",{get:function(){if(this._elementsDirty)this.updateElements();return this._skewZ},set:function(t){if(this.skewZ==t)return;this._skewZ=t;this.invalidateSkew()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scene",{get:function(){return this._pScene},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scenePosition",{get:function(){if(this._scenePositionDirty){if(!this._pivotZero&&this.alignmentMode==y.PIVOT_POINT){this._scenePosition=this.sceneTransform.transformVector(this._pivotScale)}else{this.sceneTransform.copyColumnTo(3,this._scenePosition)}this._scenePositionDirty=false}return this._scenePosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneTransform",{get:function(){if(this._hierarchicalPropsDirty&f.SCENE_TRANSFORM)this.pUpdateSceneTransform();return this._pSceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shaderPickingDetails",{get:function(){return this._shaderPickingDetails},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"debugVisible",{get:function(){return this._debugVisible},set:function(t){if(t==this._debugVisible)return;this._debugVisible=t;var e=this._entityNodes.length;for(var i=0;i<e;i++)this._entityNodes[i].debugVisible=this._debugVisible},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"transform",{get:function(){return this._transform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"visible",{get:function(){return this._explicitVisibility},set:function(t){if(this._explicitVisibility==t)return;this._explicitVisibility=t;this.pInvalidateHierarchicalProperties(f.VISIBLE)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"masks",{get:function(){return this._explicitMasks},set:function(t){if(this._explicitMasks==t)return;this._explicitMasks=t;if(t!=null&&t.length){var e=t.length;for(var i=0;i<e;i++)t[i].maskMode=true}this.pInvalidateHierarchicalProperties(f.MASKS)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this.getBox().width*this.scaleX},set:function(t){if(this._width==t)return;this._width=t;this._setScaleX(t/this.getBox().width)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){if(this._x==t)return;this._x=this._matrix3D.rawData[12]=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){if(this._y==t)return;this._y=this._matrix3D.rawData[13]=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(t){if(this._z==t)return;this._z=this._matrix3D.rawData[14]=t;this.invalidatePosition()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(t){this._zOffset=t},enumerable:true,configurable:true});e.prototype.addEventListener=function(e,i){t.prototype.addEventListener.call(this,e,i);switch(e){case g.POSITION_CHANGED:this._listenToPositionChanged=true;break;case g.ROTATION_CHANGED:this._listenToRotationChanged=true;break;case g.SKEW_CHANGED:this._listenToSkewChanged=true;break;case g.SCALE_CHANGED:this._listenToScaleChanged=true;break;case g.SCENE_CHANGED:this._listenToSceneChanged=true;break;case g.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=true;break}};e.prototype.clone=function(t){if(t===void 0){t=null}if(!t)t=new e;t.pivot=this.pivot;t._iMatrix3D=this._iMatrix3D;t.maskMode=this._maskMode;t.masks=this._explicitMasks?this._explicitMasks.concat():null;if(this._adapter)t.adapter=this._adapter.clone(t);if(this._transform.colorTransform)t.transform.colorTransform=this._transform.colorTransform.clone();return t};e.prototype.dispose=function(){if(this.parent)this.parent.removeChild(this);while(this._pRenderables.length)this._pRenderables[0].dispose()};e.prototype.disposeAsset=function(){this.dispose()};e.prototype.getBounds=function(t){return this._bounds};e.prototype.getRect=function(t){if(t===void 0){t=null}return this._bounds};e.prototype.getBox=function(t){if(t===void 0){t=null}if(this._iSourcePrefab)this._iSourcePrefab._iValidate();if(this._boxBoundsInvalid){this._pUpdateBoxBounds();if(this._width!=null)this._setScaleX(this._width/this._pBoxBounds.width);if(this._height!=null)this._setScaleY(this._height/this._pBoxBounds.height);if(this._depth!=null)this._setScaleZ(this._depth/this._pBoxBounds.depth)}if(t==null||t==this)return this._pBoxBounds;if(t==this._pParent)return this._iMatrix3D.transformBox(this._pBoxBounds);else return t.inverseSceneTransform.transformBox(this.sceneTransform.transformBox(this._pBoxBounds))};e.prototype.getSphere=function(t){if(t===void 0){t=null}if(this._iSourcePrefab)this._iSourcePrefab._iValidate();if(this._sphereBoundsInvalid)this._pUpdateSphereBounds();return this._pSphereBounds};e.prototype.globalToLocal=function(t){this._tempVector3D.setTo(t.x,t.y,0);var e=this.inverseSceneTransform.transformVector(this._tempVector3D);return new u(e.x,e.y)};e.prototype.globalToLocal3D=function(t){return this.inverseSceneTransform.transformVector(t)};e.prototype.hitTestObject=function(t){var e=t.getBox();if(!e)return false;var i=new u(e.x,e.y);var r=new u(e.x,e.y-e.height);var s=new u(e.x+e.width,e.y);var n=new u(e.x+e.width,e.y-e.height);i=this.globalToLocal(t.localToGlobal(i));r=this.globalToLocal(t.localToGlobal(r));s=this.globalToLocal(t.localToGlobal(s));n=this.globalToLocal(t.localToGlobal(n));var o=this.getBox();if(!o)return false;if(i.x<=o.left&&i.x<=o.left&&i.y<=o.top&&i.y>=o.bottom)return true;if(r.x<=o.left&&r.x<=o.left&&r.y<=o.top&&r.y>=o.bottom)return true;if(s.x<=o.left&&s.x<=o.left&&s.y<=o.top&&s.y>=o.bottom)return true;if(n.x<=o.left&&n.x<=o.left&&n.y<=o.top&&n.y>=o.bottom)return true;var a=s.y-i.y;var l=-(s.x-i.x);var h=n.y-s.y;var p=-(n.x-s.x);var c=r.y-n.y;var f=-(r.x-n.x);var _=i.y-r.y;var d=-(i.x-r.x);var y=o.left-i.x;var b=o.top-i.y;var m=o.left-s.x;var v=o.top-s.y;var g=o.left-n.x;var w=o.top-n.y;var j=o.left-r.x;var P=o.top-r.y;var x=a*y+l*b;var C=h*m+p*v;var O=c*g+f*w;var D=_*j+d*P;if(x<0&&C<0&&O<0&&D<0)return true;y=o.right-i.x;b=o.top-i.y;m=o.right-s.x;v=o.top-s.y;g=o.right-n.x;w=o.top-n.y;j=o.right-r.x;P=o.top-r.y;x=a*y+l*b;C=h*m+p*v;O=c*g+f*w;D=_*j+d*P;if(x<0&&C<0&&O<0&&D<0)return true;y=o.left-i.x;b=o.bottom-i.y;m=o.left-s.x;v=o.bottom-s.y;g=o.left-n.x;w=o.bottom-n.y;j=o.left-r.x;P=o.bottom-r.y;x=a*y+l*b;C=h*m+p*v;O=c*g+f*w;D=_*j+d*P;if(x<0&&C<0&&O<0&&D<0)return true;y=o.right-i.x;b=o.bottom-i.y;m=o.right-s.x;v=o.bottom-s.y;g=o.right-n.x;w=o.bottom-n.y;j=o.right-r.x;P=o.bottom-r.y;x=a*y+l*b;C=h*m+p*v;O=c*g+f*w;D=_*j+d*P;if(x<0&&C<0&&O<0&&D<0)return true;return false};e.prototype.hitTestPoint=function(t,e,i,r){if(i===void 0){i=false}if(r===void 0){r=false}return false};e.prototype.isMask=function(){return this._explicitMaskId==-1};e.prototype.lookAt=function(t,e){if(e===void 0){e=null}var i;var r;var s;var n;if(e==null)e=p.Y_AXIS;else e.normalize();r=t.subtract(this._iMatrix3D.position);r.normalize();s=e.crossProduct(r);s.normalize();if(s.length<.05){s.x=e.y;s.y=e.x;s.z=0;s.normalize()}i=r.crossProduct(s);n=h.RAW_DATA_CONTAINER;n[0]=s.x;n[1]=s.y;n[2]=s.z;n[3]=0;n[4]=i.x;n[5]=i.y;n[6]=i.z;n[7]=0;n[8]=r.x;n[9]=r.y;n[10]=r.z;n[11]=0;var o=new l;o.copyRawDataFrom(n);var u=o.decompose()[1];this.rotationX=u.x*a.RADIANS_TO_DEGREES;this.rotationY=u.y*a.RADIANS_TO_DEGREES;this.rotationZ=u.z*a.RADIANS_TO_DEGREES};e.prototype.localToGlobal=function(t){this._tempVector3D.setTo(t.x,t.y,0);var e=this.sceneTransform.transformVector(this._tempVector3D);return new u(e.x,e.y)};e.prototype.localToGlobal3D=function(t){return this.sceneTransform.transformVector(t)};e.prototype.moveTo=function(t,e,i){if(this._x==t&&this._y==e&&this._z==i)return;this.x=t;this.y=e;this.z=i};e.prototype.movePivot=function(t,e,i){if(t==0&&e==0&&i==0)return;this._pivot.x+=t;this._pivot.y+=e;this._pivot.z+=i;this.invalidatePivot()};e.prototype.pitch=function(t){this.rotate(p.X_AXIS,t)};e.prototype.reset=function(){this.visible=true;if(this._iMatrix3D)this._iMatrix3D.identity();if(this._iColorTransform)this._iColorTransform.clear();this.masks=null;this.maskMode=false};e.prototype.getRenderSceneTransform=function(t){if(this.orientationMode==b.CAMERA_PLANE){var e=t.sceneTransform.decompose();var i=e[3];e[0]=this.scenePosition;i.x=this.scaleX;i.y=this.scaleY;i.z=this.scaleZ;this._orientationMatrix.recompose(e);if(!this._pivotZero&&this.alignmentMode==y.PIVOT_POINT)this._orientationMatrix.prependTranslation(-this._pivot.x/this.scaleX,-this._pivot.y/this.scaleY,-this._pivot.z/this.scaleZ);return this._orientationMatrix}return this.sceneTransform};e.prototype.roll=function(t){this.rotate(p.Z_AXIS,t)};e.prototype.rotate=function(t,e){var i=new l;i.prependRotation(e,t);var r=i.decompose()[1];this.rotationX+=r.x*a.RADIANS_TO_DEGREES;this.rotationY+=r.y*a.RADIANS_TO_DEGREES;this.rotationZ+=r.z*a.RADIANS_TO_DEGREES};e.prototype.rotateTo=function(t,e,i){this.rotationX=t;this.rotationY=e;this.rotationZ=i};e.prototype.removeEventListener=function(e,i){t.prototype.removeEventListener.call(this,e,i);if(this.hasEventListener(e))return;switch(e){case g.POSITION_CHANGED:this._listenToPositionChanged=false;break;case g.ROTATION_CHANGED:this._listenToRotationChanged=false;break;case g.SKEW_CHANGED:this._listenToSkewChanged=false;case g.SCALE_CHANGED:this._listenToScaleChanged=false;break;case g.SCENE_CHANGED:this._listenToSceneChanged=false;break;case g.SCENETRANSFORM_CHANGED:this._listenToSceneTransformChanged=true;break}};e.prototype.translate=function(t,e){var i=t.x,r=t.y,s=t.z;var n=e/Math.sqrt(i*i+r*r+s*s);this.x+=i*n;this.y+=r*n;this.z+=s*n};e.prototype.translateLocal=function(t,e){var i=t.x,r=t.y,s=t.z;var n=e/Math.sqrt(i*i+r*r+s*s);this._iMatrix3D.prependTranslation(i*n,r*n,s*n);this._matrix3D.copyColumnTo(3,this._pos);this.x=this._pos.x;this.y=this._pos.y;this.z=this._pos.z};e.prototype.yaw=function(t){this.rotate(p.Y_AXIS,t)};Object.defineProperty(e.prototype,"_iAssignedPartition",{get:function(){return this._pImplicitPartition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iMatrix3D",{get:function(){if(this._matrix3DDirty)this._pUpdateMatrix3D();if(this._pivotDirty)this._pUpdatePivot();return this._matrix3D},set:function(t){for(var e=0;e<12;e++)this._matrix3D.rawData[e]=t.rawData[e];this.x=t.rawData[12];this.y=t.rawData[13];this.z=t.rawData[14];this._elementsDirty=true;this.pInvalidateHierarchicalProperties(f.SCENE_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iColorTransform",{get:function(){return this._explicitColorTransform},set:function(t){this._explicitColorTransform=t;this.pInvalidateHierarchicalProperties(f.COLOR_TRANSFORM)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_iPickingCollisionVO",{get:function(){if(!this._pPickingCollisionVO)this._pPickingCollisionVO=new v(this);return this._pPickingCollisionVO},enumerable:true,configurable:true});e.prototype.iSetParent=function(t){this._pParent=t;if(t)this._iSetScene(t._pScene,t._iAssignedPartition);else this._iSetScene(null,null);this.pInvalidateHierarchicalProperties(f.ALL)};e.prototype.pInvalidateHierarchicalProperties=function(t){var e=(this._hierarchicalPropsDirty^t)&t;if(!e)return true;this._hierarchicalPropsDirty|=t;if(e&f.SCENE_TRANSFORM){this._inverseSceneTransformDirty=true;this._scenePositionDirty=true;if(this.isEntity)this.invalidatePartition();if(this._pParent)this._pParent._pInvalidateBounds();if(this._listenToSceneTransformChanged)this.queueDispatch(this._sceneTransformChanged||(this._sceneTransformChanged=new g(g.SCENETRANSFORM_CHANGED,this)))}return false};e.prototype._iSetScene=function(t,e){var i=this._pScene!=t;if(this._pScene&&this._pImplicitPartition){this._pScene._iUnregisterPartition(this._pImplicitPartition);this._pImplicitPartition._iUnregisterEntity(this)}this._pImplicitPartition=this._explicitPartition||e;if(i)this._pScene=t;if(this._pScene&&this._pImplicitPartition){this._pScene._iRegisterPartition(this._pImplicitPartition);this._pImplicitPartition._iRegisterEntity(this)}if(i&&this._listenToSceneChanged)this.queueDispatch(this._sceneChanged||(this._sceneChanged=new g(g.SCENE_CHANGED,this)))};e.prototype._pUpdateMatrix3D=function(){if(this._elementsDirty)this.updateElements();this._pos.x=this._x;this._pos.y=this._y;this._pos.z=this._z;
this._rot.x=this._rotationX;this._rot.y=this._rotationY;this._rot.z=this._rotationZ;this._ske.x=this._skewX;this._ske.y=this._skewY;this._ske.z=this._skewZ;this._sca.x=this._scaleX;this._sca.y=this._scaleY;this._sca.z=this._scaleZ;this._matrix3D.recompose(this._transformComponents);this._matrix3DDirty=false};e.prototype._pUpdatePivot=function(){if(!this._pivotZero){this._pivotScale.x=this._pivot.x/this._scaleX;this._pivotScale.y=this._pivot.y/this._scaleY;this._pivotScale.z=this._pivot.z/this._scaleZ;this._matrix3D.prependTranslation(-this._pivotScale.x,-this._pivotScale.y,-this._pivotScale.z);if(this.alignmentMode!=y.PIVOT_POINT)this._matrix3D.appendTranslation(this._pivot.x,this._pivot.y,this._pivot.z)}this._pivotDirty=false};e.prototype.pUpdateSceneTransform=function(){if(this._iController)this._iController.updateController();if(this._pParent&&!this._pParent._iIsRoot){this._pSceneTransform.copyFrom(this._pParent.sceneTransform);this._pSceneTransform.prepend(this._iMatrix3D)}else{this._pSceneTransform.copyFrom(this._iMatrix3D)}this._positionDirty=false;this._rotationDirty=false;this._skewDirty=false;this._scaleDirty=false;this._hierarchicalPropsDirty^=f.SCENE_TRANSFORM};e.prototype._iAddRenderable=function(t){this._pRenderables.push(t);return t};e.prototype._iRemoveRenderable=function(t){var e=this._pRenderables.indexOf(t);this._pRenderables.splice(e,1);return t};e.prototype._iTestCollision=function(t,e){return false};e.prototype._iInternalUpdate=function(){if(this._iController)this._iController.update();var t=this._queuedEvents.length;for(var e=0;e<t;++e)this.dispatchEvent(this._queuedEvents[e]);this._queuedEvents.length=0};e.prototype._iIsVisible=function(){if(this._hierarchicalPropsDirty&f.VISIBLE)this._updateVisible();return this._pImplicitVisibility};e.prototype._iAssignedMaskId=function(){if(this._hierarchicalPropsDirty&f.MASK_ID)this._updateMaskId();return this._pImplicitMaskId};e.prototype._iAssignedMasks=function(){if(this._hierarchicalPropsDirty&f.MASKS)this._updateMasks();return this._pImplicitMasks};e.prototype._iMasksConfig=function(){if(this._hierarchicalPropsDirty&f.MASKS)this._updateMasks();return this._pImplicitMaskIds};e.prototype._iAssignedColorTransform=function(){if(this._hierarchicalPropsDirty&f.COLOR_TRANSFORM)this._updateColorTransform();return this._pImplicitColorTransform};e.prototype._iIsMouseEnabled=function(){if(this._hierarchicalPropsDirty&f.MOUSE_ENABLED)this._updateMouseEnabled();return this._pImplicitMouseEnabled&&this._explicitMouseEnabled};e.prototype._applyRenderer=function(t){};e.prototype.invalidateMatrix3D=function(){if(this._matrix3DDirty)return;this._matrix3DDirty=true;this.pInvalidateHierarchicalProperties(f.SCENE_TRANSFORM)};e.prototype.invalidatePartition=function(){var t=this._entityNodes.length;for(var e=0;e<t;e++)this._entityNodes[e].invalidatePartition()};e.prototype.invalidatePivot=function(){this._pivotZero=this._pivot.x==0&&this._pivot.y==0&&this._pivot.z==0;if(this._pivotDirty)return;this._pivotDirty=true;this.invalidateMatrix3D()};e.prototype.invalidatePosition=function(){if(this._positionDirty)return;this._positionDirty=true;this.pInvalidateHierarchicalProperties(f.SCENE_TRANSFORM);if(!this._pivotZero)this.invalidatePivot();if(this._listenToPositionChanged)this.queueDispatch(this._positionChanged||(this._positionChanged=new g(g.POSITION_CHANGED,this)))};e.prototype.invalidateRotation=function(t){if(t===void 0){t=true}if(t)this.invalidateMatrix3D();if(this._rotationDirty)return;this._rotationDirty=true;if(this._listenToRotationChanged)this.queueDispatch(this._rotationChanged||(this._rotationChanged=new g(g.ROTATION_CHANGED,this)))};e.prototype.invalidateSkew=function(t){if(t===void 0){t=true}if(t)this.invalidateMatrix3D();if(this._skewDirty)return;this._skewDirty=true;if(this._listenToSkewChanged)this.queueDispatch(this._skewChanged||(this._skewChanged=new g(g.SKEW_CHANGED,this)))};e.prototype.invalidateScale=function(t){if(t===void 0){t=true}if(t)this.invalidateMatrix3D();if(this._scaleDirty)return;this._scaleDirty=true;if(this._listenToScaleChanged)this.queueDispatch(this._scaleChanged||(this._scaleChanged=new g(g.SCALE_CHANGED,this)))};e.prototype._iAddEntityNode=function(t){this._entityNodes.push(t);return t};e.prototype._iRemoveEntityNode=function(t){var e=this._entityNodes.indexOf(t);this._entityNodes.splice(e,1);return t};e.prototype._pInvalidateBounds=function(){this._boxBoundsInvalid=true;this._sphereBoundsInvalid=true;if(this.isEntity)this.invalidatePartition();if(this._pParent)this._pParent._pInvalidateBounds()};e.prototype._pUpdateBoxBounds=function(){this._boxBoundsInvalid=false;if(this._pBoxBounds==null)this._pBoxBounds=new s};e.prototype._pUpdateSphereBounds=function(){this._sphereBoundsInvalid=false;if(this._pSphereBounds==null)this._pSphereBounds=new o};e.prototype.queueDispatch=function(t){this._queuedEvents.push(t)};e.prototype.updateElements=function(){this._elementsDirty=false;var t=this._matrix3D.decompose();var e;e=t[1];if(this._rotationX!=e.x||this._rotationY!=e.y||this._rotationZ!=e.z){this._rotationX=e.x;this._rotationY=e.y;this._rotationZ=e.z;this.invalidateRotation(false)}e=t[2];if(this._skewX!=e.x||this._skewY!=e.y||this._skewZ!=e.z){this._skewX=e.x;this._skewY=e.y;this._skewZ=e.z;this.invalidateSkew(false)}e=t[3];this._width=null;this._height=null;this._depth=null;if(this._scaleX!=e.x||this._scaleY!=e.y||this._scaleZ!=e.z){this._scaleX=e.x;this._scaleY=e.y;this._scaleZ=e.z;this.invalidateScale(false)}};e.prototype._setScaleX=function(t){if(this.scaleX==t)return;this._scaleX=t;this.invalidateScale()};e.prototype._setScaleY=function(t){if(this.scaleY==t)return;this._scaleY=t;this.invalidateScale()};e.prototype._setScaleZ=function(t){if(this.scaleZ==t)return;this._scaleZ=t;this.invalidateScale()};e.prototype._updateMouseEnabled=function(){this._pImplicitMouseEnabled=this._pParent?this._pParent.mouseChildren&&this._pParent._pImplicitMouseEnabled:true;if(this._pImplicitMouseEnabled&&this._pParent&&!this._pPickingCollider)this._pPickingCollider=this._pParent._pPickingCollider;this._hierarchicalPropsDirty^=f.MOUSE_ENABLED};e.prototype._updateVisible=function(){this._pImplicitVisibility=this._pParent?this._explicitVisibility&&this._pParent._iIsVisible():this._explicitVisibility;this._hierarchicalPropsDirty^=f.VISIBLE};e.prototype._updateMaskId=function(){this._pImplicitMaskId=this._pParent&&this._pParent._iAssignedMaskId()!=-1?this._pParent._iAssignedMaskId():this._explicitMaskId;this._hierarchicalPropsDirty^=f.MASK_ID};e.prototype._updateMasks=function(){this._pImplicitMasks=this._pParent&&this._pParent._iAssignedMasks()?this._explicitMasks!=null?this._pParent._iAssignedMasks().concat([this._explicitMasks]):this._pParent._iAssignedMasks().concat():this._explicitMasks!=null?[this._explicitMasks]:null;this._pImplicitMaskIds.length=0;if(this._pImplicitMasks&&this._pImplicitMasks.length){var t=this._pImplicitMasks.length;var e;var i;var r;for(var s=0;s<t;s++){i=this._pImplicitMasks[s];e=i.length;r=new Array;for(var n=0;n<e;n++)r.push(i[n].id);this._pImplicitMaskIds.push(r)}}this._hierarchicalPropsDirty^=f.MASKS};e.prototype._updateColorTransform=function(){if(this._inheritColorTransform&&this._pParent){this._pImplicitColorTransform.copyFrom(this._pParent._iAssignedColorTransform());if(this._explicitColorTransform)this._pImplicitColorTransform.prepend(this._explicitColorTransform)}else{if(this._explicitColorTransform)this._pImplicitColorTransform.copyFrom(this._explicitColorTransform);else this._pImplicitColorTransform.clear()}this._hierarchicalPropsDirty^=f.COLOR_TRANSFORM};return e}(c);e.exports=w},{"awayjs-core/lib/geom/Box":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Sphere":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/base/AlignmentMode":"awayjs-display/lib/base/AlignmentMode","awayjs-display/lib/base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","awayjs-display/lib/base/OrientationMode":"awayjs-display/lib/base/OrientationMode","awayjs-display/lib/base/Transform":"awayjs-display/lib/base/Transform","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","awayjs-display/lib/pick/PickingCollisionVO":"awayjs-display/lib/pick/PickingCollisionVO"}],"awayjs-display/lib/base/Geometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=t("awayjs-display/lib/events/GeometryEvent");var o=function(t){r(e,t);function e(){t.call(this);this._subGeometries=new Array}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometries",{get:function(){return this._subGeometries},enumerable:true,configurable:true});e.prototype.applyTransformation=function(t){var e=this._subGeometries.length;for(var i=0;i<e;++i)this._subGeometries[i].applyTransformation(t)};e.prototype.addSubGeometry=function(t){this._subGeometries.push(t);t.parentGeometry=this;if(this.hasEventListener(n.SUB_GEOMETRY_ADDED))this.dispatchEvent(new n(n.SUB_GEOMETRY_ADDED,t));this.iInvalidateBounds(t)};e.prototype.removeSubGeometry=function(t){this._subGeometries.splice(this._subGeometries.indexOf(t),1);t.parentGeometry=null;if(this.hasEventListener(n.SUB_GEOMETRY_REMOVED))this.dispatchEvent(new n(n.SUB_GEOMETRY_REMOVED,t));this.iInvalidateBounds(t)};e.prototype.clone=function(){var t=new e;var i=this._subGeometries.length;for(var r=0;r<i;++r)t.addSubGeometry(this._subGeometries[r].clone());return t};e.prototype.scale=function(t){var e=this._subGeometries.length;for(var i=0;i<e;++i)this._subGeometries[i].scale(t)};e.prototype.dispose=function(){var t=this._subGeometries.length;for(var e=0;e<t;++e){var i=this._subGeometries[0];this.removeSubGeometry(i);i.dispose()}};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}var i=this._subGeometries.length;for(var r=0;r<i;++r)this._subGeometries[r].scaleUV(t,e)};e.prototype.iInvalidateBounds=function(t){if(this.hasEventListener(n.BOUNDS_INVALID))this.dispatchEvent(new n(n.BOUNDS_INVALID,t))};e.assetType="[asset Geometry]";return e}(s);e.exports=o},{"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/events/GeometryEvent":"awayjs-display/lib/events/GeometryEvent"}],"awayjs-display/lib/base/HierarchicalProperties":[function(t,e,i){var r=function(){function t(){}t.MOUSE_ENABLED=1;t.VISIBLE=2;t.MASK_ID=4;t.MASKS=8;t.COLOR_TRANSFORM=16;t.SCENE_TRANSFORM=32;t.ALL=63;return t}();e.exports=r},{}],"awayjs-display/lib/base/IBitmapDrawable":[function(t,e,i){},{}],"awayjs-display/lib/base/IRenderOwner":[function(t,e,i){},{}],"awayjs-display/lib/base/IRenderableOwner":[function(t,e,i){},{}],"awayjs-display/lib/base/ISubMeshClass":[function(t,e,i){},{}],"awayjs-display/lib/base/ISubMesh":[function(t,e,i){},{}],"awayjs-display/lib/base/LightBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/errors/AbstractMethodError");var n=t("awayjs-display/lib/containers/DisplayObjectContainer");var o=t("awayjs-display/lib/events/LightEvent");var a=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._colorR=1;this._colorG=1;this._colorB=1;this._ambientColor=16777215;this._ambient=0;this._iAmbientR=0;this._iAmbientG=0;this._iAmbientB=0;this._specular=1;this._iSpecularR=1;this._iSpecularG=1;this._iSpecularB=1;this._diffuse=1;this._iDiffuseR=1;this._iDiffuseG=1;this._iDiffuseB=1;this._castsShadows=false}Object.defineProperty(e.prototype,"castsShadows",{get:function(){return this._castsShadows},set:function(t){if(this._castsShadows==t)return;this._castsShadows=t;if(t){if(this._shadowMapper==null)this._shadowMapper=this.pCreateShadowMapper();this._shadowMapper.light=this}else{this._shadowMapper.dispose();this._shadowMapper=null}this.dispatchEvent(new o(o.CASTS_SHADOW_CHANGE))},enumerable:true,configurable:true});e.prototype.pCreateShadowMapper=function(){throw new s};Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){if(t<0)t=0;this._specular=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuse",{get:function(){return this._diffuse},set:function(t){if(t<0)t=0;this._diffuse=t;this.updateDiffuse()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;this._colorR=(this._color>>16&255)/255;this._colorG=(this._color>>8&255)/255;this._colorB=(this._color&255)/255;this.updateDiffuse();this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(t<0)t=0;else if(t>1)t=1;this._ambient=t;this.updateAmbient()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){this._ambientColor=t;this.updateAmbient()},enumerable:true,configurable:true});e.prototype.updateAmbient=function(){this._iAmbientR=(this._ambientColor>>16&255)/255*this._ambient;this._iAmbientG=(this._ambientColor>>8&255)/255*this._ambient;this._iAmbientB=(this._ambientColor&255)/255*this._ambient};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new s};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.updateSpecular=function(){this._iSpecularR=this._colorR*this._specular;this._iSpecularG=this._colorG*this._specular;this._iSpecularB=this._colorB*this._specular};e.prototype.updateDiffuse=function(){this._iDiffuseR=this._colorR*this._diffuse;this._iDiffuseG=this._colorG*this._diffuse;this._iDiffuseB=this._colorB*this._diffuse};Object.defineProperty(e.prototype,"shadowMapper",{get:function(){return this._shadowMapper},set:function(t){this._shadowMapper=t;this._shadowMapper.light=this},enumerable:true,configurable:true});e.assetType="[asset Light]";return e}(n);e.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/events/LightEvent":"awayjs-display/lib/events/LightEvent"}],"awayjs-display/lib/base/LineSubGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Byte4Attributes");var o=t("awayjs-core/lib/attributes/Float1Attributes");var a=t("awayjs-display/lib/base/SubGeometryBase");var l=t("awayjs-display/lib/utils/SubGeometryUtils");var h=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,e);this._numVertices=0;this._positions=new s(Float32Array,6,e)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){return this._thickness},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colors",{get:function(){if(!this._colors)this.setColors(this._colors);return this._colors},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});e.prototype.getBoundingPositions=function(){return this._positions.get(this._numVertices)};e.prototype.setPositions=function(t,e){if(e===void 0){e=0}if(t instanceof s){this.notifyVerticesDispose(this._positions);this._positions=t}else if(t){var i=0;var r=0;var n=0;var o=new Float32Array(t.length*4);var a=new Uint16Array(t.length);while(i<t.length){if(n/6&1){o[n]=t[i+3];o[n+1]=t[i+4];o[n+2]=t[i+5];o[n+3]=t[i];o[n+4]=t[i+1];o[n+5]=t[i+2]}else{o[n]=t[i];o[n+1]=t[i+1];o[n+2]=t[i+2];o[n+3]=t[i+3];o[n+4]=t[i+4];o[n+5]=t[i+5]}n+=6;if(++r==4){var l=n/6-4;a.set([l,l+1,l+2,l+3,l+2,l+1],i);r=0;i+=6}}this._positions.set(o,e*4);this.setIndices(a,e)}else{this.notifyVerticesDispose(this._positions);this._positions=new s(Float32Array,6,this._concatenatedBuffer)}this._numVertices=this._positions.count;this.pInvalidateBounds();this.notifyVerticesUpdate(this._positions);this._verticesDirty[this._positions.id]=false};e.prototype.setThickness=function(t,e){if(e===void 0){e=0}if(t instanceof o){this._thickness=t}else if(t){if(!this._thickness)this._thickness=new o(this._concatenatedBuffer);var i=0;var r=0;var s=0;var n=new Float32Array(t.length*4);while(i<t.length){n[s]=Math.floor(.5*s+.5)&1?-t[i]:t[i];if(++r==4){r=0;i++}s++}this._thickness.set(n,e*4)}else if(this._thickness){this._thickness.dispose();this._thickness=null}this.notifyVerticesUpdate(this._thickness);this._verticesDirty[this._thickness.id]=false};e.prototype.setColors=function(t,e){if(e===void 0){e=0}if(t){if(t==this._colors)return;if(t instanceof n){this.notifyVerticesDispose(this._colors);this._colors=t}else{if(!this._colors)this._colors=new n(this._concatenatedBuffer);var i=0;var r=0;var s=0;var o=new Uint8Array(t.length*4);while(i<t.length){if(s/4&1){o[s]=t[i+4];o[s+1]=t[i+5];o[s+2]=t[i+6];o[s+3]=t[i+7]}else{o[s]=t[i];o[s+1]=t[i+1];o[s+2]=t[i+2];o[s+3]=t[i+3]}if(++r==4){r=0;i+=8}s+=4}this._colors.set(t,e*4)}}else{this._colors=l.generateColors(this._pIndices,this._colors,this._concatenatedBuffer,this._numVertices)}this.notifyVerticesUpdate(this._colors);this._verticesDirty[this._colors.id]=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._positions=null;this._thickness=null;this._colors=null};e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);t.setIndices(this._pIndices.clone());t.setPositions(this._positions.clone());t.setThickness(this._thickness.clone());t.setColors(this._colors.clone());return t};e.prototype._iTestCollision=function(t,e,i,r){return t.testLineCollision(this,e,i,r)};e.assetType="[asset LineSubGeometry]";return e}(a);e.exports=h},{"awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float1Attributes":undefined,"awayjs-display/lib/base/SubGeometryBase":"awayjs-display/lib/base/SubGeometryBase","awayjs-display/lib/utils/SubGeometryUtils":"awayjs-display/lib/utils/SubGeometryUtils"}],"awayjs-display/lib/base/LineSubMesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/base/LineSubGeometry");var n=t("awayjs-display/lib/base/SubMeshBase");var o=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=null}t.call(this);this._pParentMesh=i;this._subGeometry=e;this.material=r}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.dispose=function(){this.material=null;t.prototype.dispose.call(this)};e.assetType="[asset LineSubMesh]";e.assetClass=s;return e}(n);e.exports=o},{"awayjs-display/lib/base/LineSubGeometry":"awayjs-display/lib/base/LineSubGeometry","awayjs-display/lib/base/SubMeshBase":"awayjs-display/lib/base/SubMeshBase"}],"awayjs-display/lib/base/LoaderInfo":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/EventDispatcher");var n=function(t){r(e,t);function e(){t.apply(this,arguments)}Object.defineProperty(e.prototype,"bytes",{get:function(){return this._bytes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesLoaded",{get:function(){return this._bytesLoaded},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bytesTotal",{get:function(){return this._bytesTotal},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"contentType",{get:function(){return this._contentType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-display/lib/base/OrientationMode":[function(t,e,i){var r=function(){function t(){}t.DEFAULT="default";t.CAMERA_PLANE="cameraPlane";t.CAMERA_POSITION="cameraPosition";return t}();e.exports=r},{}],"awayjs-display/lib/base/SubGeometryBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/Short3Attributes");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-core/lib/library/AssetBase");var a=t("awayjs-display/lib/events/SubGeometryEvent");var l=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._subGeometryVO=new Array;this._numElements=0;this._verticesDirty=new Object;this._verticesUpdated=new Object;this._concatenatedBuffer=e}Object.defineProperty(e.prototype,"concatenatedBuffer",{get:function(){return this._concatenatedBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"indices",{get:function(){return this._pIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numElements",{get:function(){return this._numElements},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){throw new n},enumerable:true,configurable:true});e.prototype.invalidate=function(){var t=this._subGeometryVO.length;for(var e=0;e<t;e++)this._subGeometryVO[e].invalidate()};e.prototype.dispose=function(){while(this._subGeometryVO.length)this._subGeometryVO[0].dispose();this._pIndices.dispose();this._pIndices=null};e.prototype.setIndices=function(t,e){if(e===void 0){e=0}if(t instanceof s){if(this._pIndices)this.notifyIndicesDispose();this._pIndices=t}else if(t){if(!this._pIndices)this._pIndices=new s;this._pIndices.set(t,e)}else if(this._pIndices){this._pIndices.dispose();this._pIndices=null;this.notifyIndicesDispose()}if(this._pIndices){this._numElements=this._pIndices.count;this.notifyIndicesUpdate()}else{this._numElements=0}};e.prototype.pInvalidateBounds=function(){if(this.parentGeometry)this.parentGeometry.iInvalidateBounds(this)};e.prototype.clone=function(){throw new n};e.prototype.applyTransformation=function(t){};e.prototype.scale=function(t){};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}};e.prototype.getBoundingPositions=function(){throw new n};e.prototype.hitTestPoint=function(t,e,i){throw new n};e.prototype.notifyIndicesUpdate=function(){if(!this._indicesUpdated)this._indicesUpdated=new a(a.INDICES_UPDATED,this._pIndices);this.dispatchEvent(this._indicesUpdated)};e.prototype.notifyIndicesDispose=function(){this.dispatchEvent(new a(a.INDICES_DISPOSED,this._pIndices))};e.prototype.notifyVerticesUpdate=function(t){if(!t||this._verticesDirty[t.id])return;this._verticesDirty[t.id]=true;if(!this._verticesUpdated[t.id])this._verticesUpdated[t.id]=new a(a.VERTICES_UPDATED,t);this.dispatchEvent(this._verticesUpdated[t.id])};e.prototype.notifyVerticesDispose=function(t){if(!t)return;t.dispose();this.dispatchEvent(new a(a.VERTICES_DISPOSED,t));this._verticesDirty[t.id]=null;this._verticesUpdated[t.id]=null};e.prototype._iAddSubGeometryVO=function(t){this._subGeometryVO.push(t);return t};e.prototype._iRemoveSubGeometryVO=function(t){this._subGeometryVO.splice(this._subGeometryVO.indexOf(t),1);return t};e.prototype._iTestCollision=function(t,e,i,r){throw new n};return e}(o);e.exports=l},{"awayjs-core/lib/attributes/Short3Attributes":undefined,"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/events/SubGeometryEvent":"awayjs-display/lib/events/SubGeometryEvent"}],"awayjs-display/lib/base/SubMeshBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._iIndex=0;this._renderables=new Array}Object.defineProperty(e.prototype,"animator",{get:function(){return this._pParentMesh.animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material||this._pParentMesh.material},set:function(t){if(this.material)this.material.iRemoveOwner(this);this._material=t;if(this.material)this.material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneTransform",{get:function(){return this._pParentMesh.sceneTransform},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parentMesh",{get:function(){return this._pParentMesh},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform||this._pParentMesh.uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this.material=null;var t=this._renderables.length;for(var e=0;e<t;e++)this._renderables[e].dispose();this._renderables=new Array};e.prototype.getRenderSceneTransform=function(t){return this._pParentMesh.getRenderSceneTransform(t)};e.prototype._iAddRenderable=function(t){this._renderables.push(t);return t};e.prototype._iRemoveRenderable=function(t){var e=this._renderables.indexOf(t);this._renderables.splice(e,1);return t};e.prototype._iInvalidateRenderableGeometry=function(){var t=this._renderables.length;for(var e=0;e<t;e++)this._renderables[e].invalidateGeometry()};e.prototype._iGetExplicitMaterial=function(){return this._material};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/base/Timeline":[function(t,e,i){var r=t("awayjs-display/lib/base/HierarchicalProperties");var s=t("awayjs-core/lib/geom/ColorTransform");var n=t("awayjs-display/lib/managers/FrameScriptManager");var o=function(){function t(){this.numKeyFrames=0;this.keyframe_indices=[];this._potentialPrototypes=[];this._labels={};this._framescripts={};this._framescripts_translated={}}t.prototype.init=function(){if(this.frame_command_indices==null||this.frame_recipe==null||this.keyframe_durations==null)return;this.keyframe_firstframes=[];this.keyframe_constructframes=[];var t=0;var e=0;var i=0;var r=0;var s=0;for(e=0;e<this.numKeyFrames;e++){var n=this.keyframe_durations[e];if(this.frame_recipe[e]&1)s=r;this.keyframe_firstframes[r]=t;this.keyframe_constructframes[r++]=s;for(i=0;i<n;i++)this.keyframe_indices[t++]=e}};t.prototype.get_framescript=function(t){if(this._framescripts[t]==null)return"";if(typeof this._framescripts[t]=="string")return this._framescripts[t];else{throw new Error("Framescript is already translated to Function!!!")}return""};t.prototype.add_framescript=function(t,e){this._framescripts[e]=t};t.prototype.regexIndexOf=function(t,e,i){var r=t.substring(i||0).search(e);return r>=0?r+(i||0):r};t.prototype.add_script_for_postcontruct=function(t,e,i){if(i===void 0){i=false}if(this._framescripts[e]!=null){if(this._framescripts_translated[e]==null){this._framescripts[e]=t.adapter.evalScript(this._framescripts[e]);this._framescripts_translated[e]=true}if(i)n.add_script_to_queue(t,this._framescripts[e]);else n.add_script_to_queue_pass2(t,this._framescripts[e])}};Object.defineProperty(t.prototype,"numFrames",{get:function(){return this.keyframe_indices.length},enumerable:true,configurable:true});t.prototype.getPotentialChildPrototype=function(t){return this._potentialPrototypes[t]};t.prototype.getKeyframeIndexForFrameIndex=function(t){return this.keyframe_indices[t]};t.prototype.getPotentialChilds=function(){return this._potentialPrototypes};t.prototype.getPotentialChildInstance=function(t){var e=this._potentialPrototypes[t].clone();e.name="";return e};t.prototype.registerPotentialChild=function(t){var e=this._potentialPrototypes.length;this._potentialPrototypes[e]=t};t.prototype.jumpToLabel=function(t,e){var i=this._labels[e];if(i>=0)t.currentFrameIndex=this.keyframe_firstframes[i]};t.prototype.gotoFrame=function(t,e,i){if(i===void 0){i=false}var r=t.currentFrameIndex;if(r==e)return;var s=t.constructedKeyFrameIndex;var n=this.keyframe_indices[e];var o=this.keyframe_firstframes[n];if(s+1==n){t.set_currentFrameIndex(e);this.constructNextFrame(t,!i,true);return}if(!i&&o==e)this.add_script_for_postcontruct(t,n,true);if(s==n)return;var a=this.keyframe_constructframes[n];var l=n>s;var h=a>s;var u=a;if(l&&!h)u=s+1;var p=t.getChildDepths();var c={};var f;var _;var d;var y;var b;if(l&&u==n){}for(f=t.numChildren-1;f>=0;f--){y=t._children[f];if(h){t.removeChild(y)}else if(l){c[y._depthID]=y._sessionID}}var m=[];var v=0;for(d=u;d<=n;d++){var g=this.frame_command_indices[d];var w=this.frame_recipe[d];var j;var P;if(w&2){j=this.command_index_stream[g];_=j+this.command_length_stream[g++];for(f=j;f<_;f++){b=this.remove_child_stream[f]-16383;delete p[b];delete c[b]}}if(w&4){j=this.command_index_stream[g];_=j+this.command_length_stream[g++];for(f=_-1;f>=j;f--){P=f*2;var x=t.getPotentialChildInstance(this.add_child_stream[P]);b=this.add_child_stream[P+1]-16383;p[b]=x;c[b]=f}}if(w&8)m[v++]=g}for(f=t.numChildren-1;f>=0;f--){y=t._children[f];b=y._depthID;if(c[b]==y._sessionID)delete c[b];else t.removeChildAt(f)}for(var C in c){y=p[C];y._sessionID=c[C];t.addChildAtDepth(y,parseInt(C))}var g;var O=m.length;for(d=0;d<O;d++){g=m[d];this.update_childs(t,this.command_index_stream[g],this.command_length_stream[g])}t.constructedKeyFrameIndex=n};t.prototype.constructNextFrame=function(t,e,i){if(e===void 0){e=true}if(i===void 0){i=false}var r=t.currentFrameIndex;var s=t.constructedKeyFrameIndex;var n=this.keyframe_indices[r];if(e&&this.keyframe_firstframes[n]==r)this.add_script_for_postcontruct(t,n,i);if(s!=n){t.constructedKeyFrameIndex=n;var o=this.frame_command_indices[n];var a=this.frame_recipe[n];if(a&1){for(var l=t.numChildren-1;l>=0;l--)t.removeChildAt(l)}else if(a&2){this.remove_childs_continous(t,this.command_index_stream[o],this.command_length_stream[o++])}if(a&4)this.add_childs_continous(t,this.command_index_stream[o],this.command_length_stream[o++]);if(a&8)this.update_childs(t,this.command_index_stream[o],this.command_length_stream[o++])}};t.prototype.remove_childs_continous=function(t,e,i){for(var r=0;r<i;r++)t.removeChildAtDepth(this.remove_child_stream[e+r]-16383)};t.prototype.add_childs_continous=function(t,e,i){var r;var s=e+i;for(var n=s-1;n>=e;n--){r=n*2;var o=t.getPotentialChildInstance(this.add_child_stream[r]);o._sessionID=n;t.addChildAtDepth(o,this.add_child_stream[r+1]-16383)}};t.prototype.update_childs=function(t,e,i){var n;
var o;var a;var l;var h;var u;var p=e+i;for(var c=e;c<p;c++){var f=t.getChildAtSessionID(this.update_child_stream[c]);if(f!=null){u=true;if(f.adapter&&f.adapter.isBlockedByScript())u=false;n=this.update_child_props_indices_stream[c];o=this.update_child_props_length_stream[c];a=n+o;for(var _=n;_<a;_++){h=this.property_type_stream[_];l=this.property_index_stream[_];switch(h){case 0:break;case 1:if(u){l*=6;var d=f._iMatrix3D;d.rawData[0]=this.properties_stream_f32_mtx_all[l++];d.rawData[1]=this.properties_stream_f32_mtx_all[l++];d.rawData[4]=this.properties_stream_f32_mtx_all[l++];d.rawData[5]=this.properties_stream_f32_mtx_all[l++];d.rawData[12]=this.properties_stream_f32_mtx_all[l++];d.rawData[13]=this.properties_stream_f32_mtx_all[l];f.x=d.rawData[12];f.y=d.rawData[13];f._elementsDirty=true;f.pInvalidateHierarchicalProperties(r.SCENE_TRANSFORM)}break;case 2:if(u){l*=8;var y=f._iColorTransform||(f._iColorTransform=new s);y.redMultiplier=this.properties_stream_f32_ct[l++];y.greenMultiplier=this.properties_stream_f32_ct[l++];y.blueMultiplier=this.properties_stream_f32_ct[l++];y.alphaMultiplier=this.properties_stream_f32_ct[l++];y.redOffset=this.properties_stream_f32_ct[l++];y.greenOffset=this.properties_stream_f32_ct[l++];y.blueOffset=this.properties_stream_f32_ct[l++];y.alphaOffset=this.properties_stream_f32_ct[l];f.pInvalidateHierarchicalProperties(r.COLOR_TRANSFORM)}break;case 3:var b;var m=new Array;var v=this.properties_stream_int[l++];for(var g=0;g<v;g++)if(b=t.getChildAtSessionID(this.properties_stream_int[l++]))m.push(b);f.masks=m;break;case 4:f.name=this.properties_stream_strings[l];t.adapter.registerScriptObject(f);break;case 5:f.name=this.properties_stream_strings[l];f.addButtonListeners();t.adapter.registerScriptObject(f);break;case 6:if(!f.adapter||!f.adapter.isVisibilityByScript())f.visible=Boolean(l);break;case 11:if(u){l*=4;var d=f._iMatrix3D;d.rawData[0]=this.properties_stream_f32_mtx_scale_rot[l++];d.rawData[1]=this.properties_stream_f32_mtx_scale_rot[l++];d.rawData[4]=this.properties_stream_f32_mtx_scale_rot[l++];d.rawData[5]=this.properties_stream_f32_mtx_scale_rot[l];f._elementsDirty=true;f.pInvalidateHierarchicalProperties(r.SCENE_TRANSFORM)}break;case 12:if(u){l*=2;f.x=this.properties_stream_f32_mtx_pos[l++];f.y=this.properties_stream_f32_mtx_pos[l]}break;case 200:f.maskMode=true;break;default:break}}}}};return t}();e.exports=o},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-display/lib/base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","awayjs-display/lib/managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager"}],"awayjs-display/lib/base/TouchPoint":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-display/lib/base/Transform":[function(t,e,i){var r=t("awayjs-core/lib/geom/Matrix3D");var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Vector3D");var o=function(){function t(t){this._position=new n;this._displayObject=t}Object.defineProperty(t.prototype,"backVector",{get:function(){var t=s.getForward(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"colorTransform",{get:function(){return this._displayObject._iColorTransform},set:function(t){this._displayObject._iColorTransform=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"concatenatedColorTransform",{get:function(){return this._concatenatedColorTransform},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"concatenatedMatrix",{get:function(){return this._concatenatedMatrix},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"downVector",{get:function(){var t=s.getUp(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"forwardVector",{get:function(){return s.getForward(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"leftVector",{get:function(){var t=s.getRight(this._displayObject._iMatrix3D);t.negate();return t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"matrix3D",{get:function(){return this._displayObject._iMatrix3D},set:function(t){this._displayObject._iMatrix3D=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"pixelBounds",{get:function(){return this._pixelBounds},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"position",{get:function(){return this._displayObject._iMatrix3D.position},set:function(t){this._displayObject.x=t.x;this._displayObject.y=t.y;this._displayObject.z=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rightVector",{get:function(){return s.getRight(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"rotation",{get:function(){return new n(this._displayObject.rotationX,this._displayObject.rotationY,this._displayObject.rotationZ)},set:function(t){this._displayObject.rotationX=t.x;this._displayObject.rotationY=t.y;this._displayObject.rotationZ=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scale",{get:function(){return new n(this._displayObject.scaleX,this._displayObject.scaleY,this._displayObject.scaleZ)},set:function(t){this._displayObject.scaleX=t.x;this._displayObject.scaleY=t.y;this._displayObject.scaleZ=t.z},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"upVector",{get:function(){return s.getUp(this._displayObject._iMatrix3D)},enumerable:true,configurable:true});t.prototype.getRelativeMatrix3D=function(t){return new r};t.prototype.moveForward=function(t){this._displayObject.translateLocal(n.Z_AXIS,t)};t.prototype.moveBackward=function(t){this._displayObject.translateLocal(n.Z_AXIS,-t)};t.prototype.moveLeft=function(t){this._displayObject.translateLocal(n.X_AXIS,-t)};t.prototype.moveRight=function(t){this._displayObject.translateLocal(n.X_AXIS,t)};t.prototype.moveUp=function(t){this._displayObject.translateLocal(n.Y_AXIS,t)};t.prototype.moveDown=function(t){this._displayObject.translateLocal(n.Y_AXIS,-t)};return t}();e.exports=o},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/base/TriangleSubGeometry":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float3Attributes");var o=t("awayjs-core/lib/attributes/Float2Attributes");var a=t("awayjs-display/lib/base/SubGeometryBase");var l=t("awayjs-display/lib/utils/SubGeometryUtils");var h=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this,e);this._numVertices=0;this._faceNormalsDirty=true;this._faceTangentsDirty=true;this._autoDeriveNormals=true;this._autoDeriveTangents=true;this._autoDeriveUVs=false;this._positions=this._concatenatedBuffer?this._concatenatedBuffer.getView(0)||new n(this._concatenatedBuffer):new n;this._numVertices=this._positions.count}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(t){if(this._useCondensedIndices==t)return;this._useCondensedIndices=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},set:function(t){if(this._jointsPerVertex==t)return;this._jointsPerVertex=t;if(this._jointIndices)this._jointIndices.dimensions=this._jointsPerVertex;if(this._jointWeights)this._jointWeights.dimensions=this._jointsPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveUVs",{get:function(){return this._autoDeriveUVs},set:function(t){if(this._autoDeriveUVs==t)return;this._autoDeriveUVs=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveNormals",{get:function(){return this._autoDeriveNormals},set:function(t){if(this._autoDeriveNormals==t)return;this._autoDeriveNormals=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"autoDeriveTangents",{get:function(){return this._autoDeriveTangents},set:function(t){if(this._autoDeriveTangents==t)return;this._autoDeriveTangents=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normals",{get:function(){if(!this._normals||this._verticesDirty[this._normals.id])this.setNormals(this._normals);return this._normals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tangents",{get:function(){if(!this._tangents||this._verticesDirty[this._tangents.id])this.setTangents(this._tangents);return this._tangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceNormals",{get:function(){if(this._faceNormalsDirty)this.updateFaceNormals();return this._faceNormals},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"faceTangents",{get:function(){if(this._faceTangentsDirty)this.updateFaceTangents();return this._faceTangents},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvs",{get:function(){if(!this._uvs||this._verticesDirty[this._uvs.id])this.setUVs(this._uvs);return this._uvs},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"secondaryUVs",{get:function(){return this._secondaryUVs},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointIndices",{get:function(){return this._jointIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"jointWeights",{get:function(){return this._jointWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"condensedIndexLookUp",{get:function(){return this._condensedIndexLookUp},enumerable:true,configurable:true});e.prototype.getBoundingPositions=function(){return this._positions.get(this._numVertices)};e.prototype.hitTestPoint=function(t,e,i){return true};e.prototype.setPositions=function(t,e){if(e===void 0){e=0}if(t==this._positions)return;if(t instanceof n){this.notifyVerticesDispose(this._positions);this._positions=t}else if(t){this._positions.set(t,e)}else{this.notifyVerticesDispose(this._positions);this._positions=new n(this._concatenatedBuffer)}this._numVertices=this._positions.count;if(this._autoDeriveNormals)this.notifyVerticesUpdate(this._normals);if(this._autoDeriveTangents)this.notifyVerticesUpdate(this._tangents);if(this._autoDeriveUVs)this.notifyVerticesUpdate(this._uvs);this.pInvalidateBounds();this.notifyVerticesUpdate(this._positions);this._verticesDirty[this._positions.id]=false};e.prototype.setNormals=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveNormals){if(t==this._normals)return;if(t instanceof n){this.notifyVerticesDispose(this._normals);this._normals=t}else if(t){if(!this._normals)this._normals=new n(this._concatenatedBuffer);this._normals.set(t,e)}else if(this._normals){this.notifyVerticesDispose(this._normals);this._normals=null;return}}else{if(this._faceNormalsDirty)this.updateFaceNormals();this._normals=l.generateNormals(this._pIndices,this._faceNormals,this._normals,this._concatenatedBuffer)}this.notifyVerticesUpdate(this._normals);this._verticesDirty[this._normals.id]=false};e.prototype.setTangents=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveTangents){if(t==this._tangents)return;if(t instanceof n){this.notifyVerticesDispose(this._tangents);this._tangents=t}else if(t){if(!this._tangents)this._tangents=new n(this._concatenatedBuffer);this._tangents.set(t,e)}else if(this._tangents){this.notifyVerticesDispose(this._tangents);this._tangents=null;return}}else{if(this._faceTangentsDirty)this.updateFaceTangents();if(this._faceNormalsDirty)this.updateFaceNormals();this._tangents=l.generateTangents(this._pIndices,this._faceTangents,this._faceNormals,this._tangents,this._concatenatedBuffer)}this.notifyVerticesUpdate(this._tangents);this._verticesDirty[this._tangents.id]=false};e.prototype.setUVs=function(t,e){if(e===void 0){e=0}if(!this._autoDeriveUVs){if(t==this._uvs)return;if(t instanceof o){this.notifyVerticesDispose(this._uvs);this._uvs=t}else if(t){if(!this._uvs)this._uvs=new o(this._concatenatedBuffer);this._uvs.set(t,e)}else if(this._uvs){this.notifyVerticesDispose(this._uvs);this._uvs=null;return}}else{this._uvs=l.generateUVs(this._pIndices,this._uvs,this._concatenatedBuffer,this._numVertices)}if(this._autoDeriveTangents)this.notifyVerticesUpdate(this._tangents);this.notifyVerticesUpdate(this._uvs);this._verticesDirty[this._uvs.id]=false};e.prototype.setSecondaryUVs=function(t,e){if(e===void 0){e=0}if(t==this._secondaryUVs)return;if(t instanceof o){this.notifyVerticesDispose(this._secondaryUVs);this._secondaryUVs=t}else if(t){if(!this._secondaryUVs)this._secondaryUVs=new o(this._concatenatedBuffer);this._secondaryUVs.set(t,e)}else if(this._secondaryUVs){this.notifyVerticesDispose(this._secondaryUVs);this._secondaryUVs=null;return}this.notifyVerticesUpdate(this._secondaryUVs);this._verticesDirty[this._secondaryUVs.id]=false};e.prototype.setJointIndices=function(t,e){if(e===void 0){e=0}if(t==this._jointIndices)return;if(t instanceof s){this.notifyVerticesDispose(this._jointIndices);this._jointIndices=t}else if(t){if(!this._jointIndices)this._jointIndices=new s(Float32Array,this._jointsPerVertex,this._concatenatedBuffer);if(this._useCondensedIndices){var i=0;var r;var n=0;var o=new Object;this._condensedIndexLookUp=new Array;while(i<t.length){r=t[i];if(o[r]==undefined){o[r]=n;this._condensedIndexLookUp[n++]=r}t[i++]=o[r]}}this._jointIndices.set(t,e)}else if(this._jointIndices){this.notifyVerticesDispose(this._jointIndices);this._jointIndices=null;return}this.notifyVerticesUpdate(this._jointIndices);this._verticesDirty[this._jointIndices.id]=false};e.prototype.setJointWeights=function(t,e){if(e===void 0){e=0}if(t==this._jointWeights)return;if(t instanceof s){this.notifyVerticesDispose(this._jointWeights);this._jointWeights=t}else if(t){if(!this._jointWeights)this._jointWeights=new s(Float32Array,this._jointsPerVertex,this._concatenatedBuffer);this._jointWeights.set(t,e)}else if(this._jointWeights){this.notifyVerticesDispose(this._jointWeights);this._jointWeights=null;return}this.notifyVerticesUpdate(this._jointWeights);this._verticesDirty[this._jointWeights.id]=false};e.prototype.dispose=function(){t.prototype.dispose.call(this);this._positions.dispose();this._positions=null;if(this._normals){this._normals.dispose();this._normals=null}if(this._tangents){this._tangents.dispose();this._tangents=null}if(this._uvs){this._uvs.dispose();this._uvs=null}if(this._secondaryUVs){this._secondaryUVs.dispose();this._secondaryUVs=null}if(this._jointIndices){this._jointIndices.dispose();this._jointIndices=null}if(this._jointWeights){this._jointWeights.dispose();this._jointWeights=null}if(this._faceNormals){this._faceNormals.dispose();this._faceNormals=null}if(this._faceTangents){this._faceTangents.dispose();this._faceTangents=null}};e.prototype.setIndices=function(e,i){if(i===void 0){i=0}t.prototype.setIndices.call(this,e,i);this._faceNormalsDirty=true;this._faceTangentsDirty=true;if(this._autoDeriveNormals)this.notifyVerticesUpdate(this._normals);if(this._autoDeriveTangents)this.notifyVerticesUpdate(this._tangents);if(this._autoDeriveUVs)this.notifyVerticesUpdate(this._uvs)};e.prototype.clone=function(){var t=new e(this._concatenatedBuffer?this._concatenatedBuffer.clone():null);t.autoDeriveNormals=false;t.autoDeriveTangents=false;t.autoDeriveUVs=false;if(this.indices)t.setIndices(this.indices.clone());if(this.normals)t.setNormals(this.normals.clone());if(this.uvs)t.setUVs(this.uvs.clone());if(this.tangents)t.setTangents(this.tangents.clone());if(this.secondaryUVs)t.setSecondaryUVs(this.secondaryUVs.clone());t.jointsPerVertex=this._jointsPerVertex;if(this.jointIndices)t.setJointIndices(this.jointIndices.clone());if(this.jointWeights)t.setJointWeights(this.jointWeights.clone());t.autoDeriveNormals=this._autoDeriveNormals;t.autoDeriveTangents=this._autoDeriveTangents;t.autoDeriveUVs=this._autoDeriveUVs;return t};e.prototype.scaleUV=function(t,e){if(t===void 0){t=1}if(e===void 0){e=1}l.scaleUVs(t,e,this.uvs,this.uvs.count)};e.prototype.scale=function(t){l.scale(t,this.positions,this._numVertices)};e.prototype.applyTransformation=function(t){l.applyTransformation(t,this.positions,this.normals,this.tangents,this._numVertices)};e.prototype.updateFaceTangents=function(){this._faceTangents=l.generateFaceTangents(this._pIndices,this._positions,this.uvs,this._faceTangents,this._pIndices.count);this._faceTangentsDirty=false};e.prototype.updateFaceNormals=function(){this._faceNormals=l.generateFaceNormals(this._pIndices,this._positions,this._faceNormals,this._pIndices.count);this._faceNormalsDirty=false};e.prototype._iTestCollision=function(t,e,i,r){return t.testTriangleCollision(this,e,i,r)};e.assetType="[asset TriangleSubGeometry]";return e}(a);e.exports=h},{"awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-display/lib/base/SubGeometryBase":"awayjs-display/lib/base/SubGeometryBase","awayjs-display/lib/utils/SubGeometryUtils":"awayjs-display/lib/utils/SubGeometryUtils"}],"awayjs-display/lib/base/TriangleSubMesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/base/TriangleSubGeometry");var n=t("awayjs-display/lib/base/SubMeshBase");var o=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=null}t.call(this);this._pParentMesh=i;this._subGeometry=e;this.material=r}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this)};e.assetType="[asset TriangleSubMesh]";e.assetClass=s;return e}(n);e.exports=o},{"awayjs-display/lib/base/SubMeshBase":"awayjs-display/lib/base/SubMeshBase","awayjs-display/lib/base/TriangleSubGeometry":"awayjs-display/lib/base/TriangleSubGeometry"}],"awayjs-display/lib/bounds/AxisAlignedBoundingBox":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("awayjs-display/lib/bounds/BoundingVolumeBase");var o=t("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var a=function(t){r(e,t);function e(e){t.call(this,e);this._x=0;this._y=0;this._z=0;this._width=0;this._height=0;this._depth=0;this._centerX=0;this._centerY=0;this._centerZ=0;this._halfExtentsX=0;this._halfExtentsY=0;this._halfExtentsZ=0}e.prototype.nullify=function(){this._x=this._y=this._z=0;this._width=this._height=this._depth=0;this._centerX=this._centerY=this._centerZ=0;this._halfExtentsX=this._halfExtentsY=this._halfExtentsZ=0};e.prototype.isInFrustum=function(t,e){if(this._pInvalidated)this._pUpdate();for(var i=0;i<e;++i){var r=t[i];var s=r.a;var n=r.b;var o=r.c;var a=s<0?-this._halfExtentsX:this._halfExtentsX;var l=n<0?-this._halfExtentsY:this._halfExtentsY;var h=o<0?-this._halfExtentsZ:this._halfExtentsZ;var u=s*(this._centerX+a)+n*(this._centerY+l)+o*(this._centerZ+h)-r.d;if(u<0)return false}return true};e.prototype.rayIntersection=function(t,e,i){if(this._pInvalidated)this._pUpdate();return this._box.rayIntersection(t,e,i)};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var n=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var o=e*this._halfExtentsX+i*this._halfExtentsY+r*this._halfExtentsZ;return n>o?s.FRONT:n<-o?s.BACK:s.INTERSECT};e.prototype._pUpdate=function(){t.prototype._pUpdate.call(this);this._box=this._pEntity.getBox();var e=this._pEntity.sceneTransform;var i=this._box.width/2;var r=this._box.height/2;var s=this._box.depth/2;var n=this._box.x+i;var o=this._box.y+r;var a=this._box.z+s;var l=e.rawData;var h=l[0],u=l[4],p=l[8],c=l[12];var f=l[1],_=l[5],d=l[9],y=l[13];var b=l[2],m=l[6],v=l[10],g=l[14];this._centerX=n*h+o*u+a*p+c;this._centerY=n*f+o*_+a*d+y;this._centerZ=n*b+o*m+a*v+g;this._halfExtentsX=Math.abs(i*h+r*u+s*p);this._halfExtentsY=Math.abs(i*f+r*_+s*d);this._halfExtentsZ=Math.abs(i*b+r*m+s*v);if(this._prefab){this._prefab.width=this._box.width;this._prefab.height=this._box.height;this._prefab.depth=this._box.depth;this._pBoundsPrimitive.transform.matrix3D=e}this._width=this._halfExtentsX*2;this._height=this._halfExtentsY*2;this._depth=this._halfExtentsZ*2;this._x=this._centerX-this._halfExtentsX;this._y=this._centerY-this._halfExtentsY;this._z=this._centerZ-this._halfExtentsZ};e.prototype._pCreateBoundsPrimitive=function(){this._prefab=new o;this._prefab.geometryType="lineSubGeometry";return this._prefab.getNewObject()};return e}(n);e.exports=a},{"awayjs-core/lib/geom/PlaneClassification":undefined,"awayjs-display/lib/bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","awayjs-display/lib/prefabs/PrimitiveCubePrefab":"awayjs-display/lib/prefabs/PrimitiveCubePrefab"}],"awayjs-display/lib/bounds/BoundingSphere":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("awayjs-display/lib/bounds/BoundingVolumeBase");var o=t("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var a=function(t){r(e,t);function e(e){t.call(this,e);this._radius=0;this._centerX=0;this._centerY=0;this._centerZ=0}e.prototype.nullify=function(){this._centerX=this._centerY=this._centerZ=0;this._radius=0};e.prototype.isInFrustum=function(t,e){if(this._pInvalidated)this._pUpdate();for(var i=0;i<e;++i){var r=t[i];var s=r.a<0?-this._radius:this._radius;var n=r.b<0?-this._radius:this._radius;var o=r.c<0?-this._radius:this._radius;var a=r.a*(this._centerX+s)+r.b*(this._centerY+n)+r.c*(this._centerZ+o)-r.d;if(a<0){return false}}return true};e.prototype.rayIntersection=function(t,e,i){if(this._pInvalidated)this._pUpdate();return this._sphere.rayIntersection(t,e,i)};e.prototype.classifyToPlane=function(t){var e=t.a;var i=t.b;var r=t.c;var n=e*this._centerX+i*this._centerY+r*this._centerZ-t.d;if(e<0)e=-e;if(i<0)i=-i;if(r<0)r=-r;var o=(e+i+r)*this._radius;return n>o?s.FRONT:n<-o?s.BACK:s.INTERSECT};e.prototype._pUpdate=function(){t.prototype._pUpdate.call(this);this._sphere=this._pEntity.getSphere();var e=this._pEntity.sceneTransform;var i=this._sphere.x;var r=this._sphere.y;var s=this._sphere.z;var n=this._sphere.radius;var o=e.rawData;var a=o[0],l=o[4],h=o[8],u=o[12];var p=o[1],c=o[5],f=o[9],_=o[13];var d=o[2],y=o[6],b=o[10],m=o[14];this._centerX=i*a+r*l+s*h+u;this._centerY=i*p+r*c+s*f+_;this._centerZ=i*d+r*y+s*b+m;var v=a+l+h;var g=p+c+f;var w=d+y+b;this._radius=n*Math.sqrt((v*v+g*g+w*w)/3);if(this._prefab){this._prefab.radius=n;this._pBoundsPrimitive.x=i;this._pBoundsPrimitive.y=r;this._pBoundsPrimitive.z=s;this._pBoundsPrimitive.transform.matrix3D=e}};e.prototype._pCreateBoundsPrimitive=function(){this._prefab=new o;this._prefab.geometryType="lineSubGeometry";return this._prefab.getNewObject()};return e}(n);e.exports=a},{"awayjs-core/lib/geom/PlaneClassification":undefined,"awayjs-display/lib/bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase","awayjs-display/lib/prefabs/PrimitiveSpherePrefab":"awayjs-display/lib/prefabs/PrimitiveSpherePrefab"}],"awayjs-display/lib/bounds/BoundingVolumeBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(t){this._pInvalidated=true;this._pEntity=t}Object.defineProperty(t.prototype,"boundsPrimitive",{get:function(){if(this._pBoundsPrimitive==null){this._pBoundsPrimitive=this._pCreateBoundsPrimitive();this._pUpdate()}return this._pBoundsPrimitive},enumerable:true,configurable:true});t.prototype.nullify=function(){throw new r};t.prototype.isInFrustum=function(t,e){throw new r};t.prototype.clone=function(){throw new r};t.prototype.rayIntersection=function(t,e,i){return-1};t.prototype.classifyToPlane=function(t){throw new r};t.prototype._pUpdate=function(){this._pInvalidated=false};t.prototype.invalidate=function(){this._pInvalidated=true};t.prototype._pCreateBoundsPrimitive=function(){throw new r};return t}();e.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/bounds/BoundsType":[function(t,e,i){var r=function(){function t(){}t.SPHERE="sphere";t.AXIS_ALIGNED_BOX="axisAlignedBox";t.NULL="null";return t}();e.exports=r},{}],"awayjs-display/lib/bounds/NullBounds":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/PlaneClassification");var n=t("awayjs-display/lib/bounds/BoundingVolumeBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=true}t.call(this,null);this._alwaysIn=e}e.prototype.clone=function(){return new e(this._alwaysIn)};e.prototype.isInFrustum=function(t,e){return this._alwaysIn};e.prototype.classifyToPlane=function(t){return s.INTERSECT};return e}(n);e.exports=o},{"awayjs-core/lib/geom/PlaneClassification":undefined,"awayjs-display/lib/bounds/BoundingVolumeBase":"awayjs-display/lib/bounds/BoundingVolumeBase"}],"awayjs-display/lib/containers/DisplayObjectContainer":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/errors/ArgumentError");var n=t("awayjs-core/lib/errors/Error");var o=t("awayjs-core/lib/errors/RangeError");var a=t("awayjs-display/lib/base/DisplayObject");var l=t("awayjs-display/lib/base/HierarchicalProperties");var h=function(t){r(e,t);function e(){t.call(this);this._containerNodes=new Array;this._mouseChildren=true;this._active_depths={};this._nextHighestDepth=0;this._children=new Array;this._pIsContainer=true}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mouseChildren",{get:function(){if(this._hierarchicalPropsDirty&l.MOUSE_ENABLED)this._updateMouseEnabled();return this._mouseChildren},set:function(t){if(this._mouseChildren==t)return;this._mouseChildren=t;this.pInvalidateHierarchicalProperties(l.MOUSE_ENABLED)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numChildren",{get:function(){return this._children.length},enumerable:true,configurable:true});e.prototype.addChild=function(t){return this.addChildAt(t,this._children.length)};e.prototype.addChildAtDepth=function(t,e,i){if(i===void 0){i=true}if(t==null)throw new n("Parameter child cannot be null.");if(t._pParent)t._pParent.removeChildAtInternal(t._pParent.getChildIndex(t));var r=this.getDepthIndexInternal(e);if(r!=-1){if(i){this.removeChildAt(r)}else{this.addChildAtDepth(this._children[r],e+1,false)}}if(this._nextHighestDepth<e+1)this._nextHighestDepth=e+1;this._active_depths[e]=t;this._children.push(t);t._depthID=e;t.iSetParent(this);this._pInvalidateBounds();return t};e.prototype.addChildAt=function(t,e){return this.addChildAtDepth(t,e<this._children.length?this._children[e]._depthID:this.getNextHighestDepth(),false)};e.prototype.addChildren=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e-0]=arguments[e]}var i=t.length;for(var r=0;r<i;r++)this.addChild(t[r])};e.prototype.clone=function(i){if(i===void 0){i=null}i=t.prototype.clone.call(this,i||new e);i.partition=this.partition;i.mouseEnabled=this.mouseEnabled;i.mouseChildren=this.mouseChildren;var r=this._children.length;for(var s=0;s<r;++s)i.addChild(this._children[s].clone());return i};e.prototype.contains=function(t){return this._children.indexOf(t)>=0};e.prototype.disposeWithChildren=function(){this.dispose();while(this.numChildren>0)this.getChildAt(0).dispose()};e.prototype.getChildAtDepth=function(t){return this._active_depths[t]};e.prototype.getChildDepths=function(){return this._active_depths};e.prototype.getChildAt=function(t){var e=this._children[t];if(e==null)throw new o("Index does not exist in the child list of the caller");return e};e.prototype.getChildByName=function(t){var e=this._children.length;for(var i=0;i<e;++i)if(this._children[i].name==t)return this._children[i];return null};e.prototype.getChildIndex=function(t){var e=this._children.indexOf(t);if(e==-1)throw new s("Child parameter is not a child of the caller");return e};e.prototype.getNextHighestDepth=function(){if(this._nextHighestDepthDirty)this._updateNextHighestDepth();return this._nextHighestDepth};e.prototype.getObjectsUnderPoint=function(t){return new Array};e.prototype.removeChild=function(t){if(t==null)throw new n("Parameter child cannot be null");this.removeChildAt(this.getChildIndex(t));return t};e.prototype.removeChildAtDepth=function(t){return this.removeChildAt(this.getDepthIndexInternal(t))};e.prototype.removeChildAt=function(t){var e=this.removeChildAtInternal(t);e.iSetParent(null);this._pInvalidateBounds();return e};e.prototype.removeChildren=function(t,e){if(t===void 0){t=0}if(e===void 0){e=2147483647}if(t<0)throw new o("beginIndex is out of range of the child list");if(e>this._children.length)throw new o("endIndex is out of range of the child list");for(var i=t;i<e;i++)this.removeChild(this._children[i])};e.prototype.setChildIndex=function(t,e){};e.prototype.swapChildren=function(t,e){this.swapChildrenAt(this.getChildIndex(t),this.getChildIndex(e))};e.prototype.swapChildrenAt=function(t,e){var i=this._children[e]._depthID;var r=this._children[t];this.addChildAtDepth(this._children[e],this._children[t]._depthID);this.addChildAtDepth(r,i)};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);var e;var i;var r,s,n;var o,a,l;var h;var u=this._children.length;if(u>0){for(var p=0;p<u;++p){h=this._children[p].getBox(this);if(p==0){o=h.width+(r=h.x);a=h.height+(s=h.y);l=h.depth+(n=h.z)}else{i=h.width+(e=h.x);if(e<r)r=e;if(i>o)o=i;i=h.height+(e=h.y);if(e<s)s=e;if(i>a)a=i;i=h.depth+(e=h.z);if(e<n)n=e;if(i>l)l=i}}this._pBoxBounds.width=o-(this._pBoxBounds.x=r);this._pBoxBounds.height=a-(this._pBoxBounds.y=s);this._pBoxBounds.depth=l-(this._pBoxBounds.z=n)}else{this._pBoxBounds.setEmpty()}};e.prototype.pInvalidateHierarchicalProperties=function(e){if(t.prototype.pInvalidateHierarchicalProperties.call(this,e))return true;var i=this._children.length;for(var r=0;r<i;++r)this._children[r].pInvalidateHierarchicalProperties(e);return false};e.prototype._iSetScene=function(e,i){t.prototype._iSetScene.call(this,e,i);var r=this._children.length;for(var s=0;s<r;++s)this._children[s]._iSetScene(e,i)};e.prototype.removeChildAtInternal=function(t){var e=this._children.splice(t,1)[0];if(this._nextHighestDepth==e._depthID+1)this._nextHighestDepthDirty=true;if(this._active_depths[e._depthID]==this)delete this._active_depths[e._depthID];e._depthID=-16384;return e};e.prototype.getDepthIndexInternal=function(t){if(!this._active_depths[t])return-1;return this._children.indexOf(this._active_depths[t])};e.prototype._updateNextHighestDepth=function(){this._nextHighestDepthDirty=false;this._nextHighestDepth=0;var t=this._children.length;for(var e=0;e<t;e++)if(this._nextHighestDepth<this._children[e]._depthID)this._nextHighestDepth=this._children[e]._depthID;
this._nextHighestDepth+=1};e.prototype.hitTestPoint=function(t,e,i,r){if(i===void 0){i=false}if(r===void 0){r=false}if(this._pImplicitMaskId!==-1&&!r)return;if(!this._pImplicitVisibility)return;var s=this.masks;if(s){var n=s.length;var o=false;for(var a=0;a<n;a++){if(s[a].hitTestPoint(t,e,i,true)){o=true;break}}if(!o)return false}return this._hitTestPointInternal(t,e,i,r)};e.prototype._iAddContainerNode=function(t){this._containerNodes.push(t);return t};e.prototype._iRemoveContainerNode=function(t){var e=this._containerNodes.indexOf(t);this._containerNodes.splice(e,1);return t};e.prototype._hitTestPointInternal=function(t,e,i,r){var s=this.numChildren;for(var n=0;n<s;n++)if(this._children[n].hitTestPoint(t,e,i,r))return true;return false};e.assetType="[asset DisplayObjectContainer]";return e}(a);e.exports=h},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/errors/RangeError":undefined,"awayjs-display/lib/base/DisplayObject":"awayjs-display/lib/base/DisplayObject","awayjs-display/lib/base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties"}],"awayjs-display/lib/containers/Loader":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetLibraryBundle");var n=t("awayjs-core/lib/library/LoaderSession");var o=t("awayjs-core/lib/events/AssetEvent");var a=t("awayjs-core/lib/events/IOErrorEvent");var l=t("awayjs-core/lib/events/LoaderEvent");var h=t("awayjs-core/lib/events/ParserEvent");var u=t("awayjs-display/lib/containers/DisplayObjectContainer");var p=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=true}if(i===void 0){i=null}t.call(this);this._useAssetLib=e;this._assetLibId=i;this._onResourceCompleteDelegate=function(t){return r.onResourceComplete(t)};this._onAssetCompleteDelegate=function(t){return r.onAssetComplete(t)};this._onTextureSizeErrorDelegate=function(t){return r.onTextureSizeError(t)};this._onLoadErrorDelegate=function(t){return r.onLoadError(t)};this._onParseErrorDelegate=function(t){return r.onParseError(t)}}Object.defineProperty(e.prototype,"content",{get:function(){return this._content},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"contentLoaderInfo",{get:function(){return this._contentLoaderInfo},enumerable:true,configurable:true});e.prototype.close=function(){if(!this._loaderSession)return;if(this._useAssetLib){var t;t=s.getInstance(this._assetLibId);t.disposeLoaderSession(this._loaderSession)}this._disposeLoaderSession()};e.prototype.load=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this._getLoaderSession().load(t,e,i,r)};e.prototype.loadData=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}this._getLoaderSession().loadData(t,"",e,i,r)};e.prototype._getLoaderSession=function(){if(this._useAssetLib){var t=s.getInstance(this._assetLibId);this._loaderSession=t.getLoaderSession()}else{this._loaderSession=new n}this._loaderSession.addEventListener(l.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);this._loaderSession.addEventListener(o.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);this._loaderSession.addEventListener(o.ASSET_COMPLETE,this._onAssetCompleteDelegate);this._loaderSession._iAddErrorHandler(this._onLoadErrorDelegate);this._loaderSession._iAddParseErrorHandler(this._onParseErrorDelegate);return this._loaderSession};e.prototype._disposeLoaderSession=function(){var t=this;this._loaderSessionGarbage=this._loaderSession;delete this._loaderSession;this._loaderSession=null;this._gcTimeoutIID=setTimeout(function(){t.loaderSessionGC()},100)};e.prototype.unload=function(){};e.enableParser=function(t){n.enableParser(t)};e.enableParsers=function(t){n.enableParsers(t)};e.prototype.loaderSessionGC=function(){this._loaderSessionGarbage.removeEventListener(l.RESOURCE_COMPLETE,this._onResourceCompleteDelegate);this._loaderSessionGarbage.removeEventListener(o.TEXTURE_SIZE_ERROR,this._onTextureSizeErrorDelegate);this._loaderSessionGarbage.removeEventListener(o.ASSET_COMPLETE,this._onAssetCompleteDelegate);if(!this._useAssetLib)this._loaderSessionGarbage.stop();delete this._loaderSessionGarbage;this._loaderSessionGarbage=null;clearTimeout(this._gcTimeoutIID);this._gcTimeoutIID=null};e.prototype.onAssetComplete=function(t){this.dispatchEvent(t)};e.prototype.onLoadError=function(t){if(this.hasEventListener(a.IO_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onParseError=function(t){if(this.hasEventListener(h.PARSE_ERROR)){this.dispatchEvent(t);return true}else{return false}};e.prototype.onTextureSizeError=function(t){this.dispatchEvent(t)};e.prototype.onResourceComplete=function(t){this._content=t.content;if(this._content)this.addChild(this._content);this.dispatchEvent(t);this._disposeLoaderSession()};return e}(u);e.exports=p},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/IOErrorEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/events/ParserEvent":undefined,"awayjs-core/lib/library/AssetLibraryBundle":undefined,"awayjs-core/lib/library/LoaderSession":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer"}],"awayjs-display/lib/containers/Scene":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/containers/DisplayObjectContainer");var n=t("awayjs-display/lib/partition/BasicPartition");var o=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._expandedPartitions=new Array;this._partitions=new Array;this._iCollectionMark=0;this.partition=e||new n;this._iIsRoot=true;this._pScene=this}e.prototype.traversePartitions=function(t){var e=0;var i=this._partitions.length;t.scene=this;this._iCollectionMark++;while(e<i)this._partitions[e++].traverse(t)};e.prototype._iRegisterPartition=function(t){this._expandedPartitions.push(t);if(this._partitions.indexOf(t)==-1)this._partitions.push(t)};e.prototype._iUnregisterPartition=function(t){this._expandedPartitions.splice(this._expandedPartitions.indexOf(t),1);if(this._expandedPartitions.indexOf(t)==-1)this._partitions.splice(this._partitions.indexOf(t),1)};return e}(s);e.exports=o},{"awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/partition/BasicPartition":"awayjs-display/lib/partition/BasicPartition"}],"awayjs-display/lib/containers/View":[function(t,e,i){var r=t("awayjs-core/lib/utils/getTimer");var s=t("awayjs-display/lib/base/TouchPoint");var n=t("awayjs-display/lib/containers/Scene");var o=t("awayjs-display/lib/pick/RaycastPicker");var a=t("awayjs-display/lib/entities/Camera");var l=t("awayjs-display/lib/events/CameraEvent");var h=t("awayjs-display/lib/events/DisplayObjectEvent");var u=t("awayjs-display/lib/events/RendererEvent");var p=t("awayjs-display/lib/managers/MouseManager");var c=function(){function t(t,e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}this._width=0;this._height=0;this._time=0;this._deltaTime=0;this._backgroundColor=0;this._backgroundAlpha=1;this._viewportDirty=true;this._scissorDirty=true;this._mousePicker=new o;this._pTouchPoints=new Array;this._onPartitionChangedDelegate=function(t){return r._onPartitionChanged(t)};this._onProjectionChangedDelegate=function(t){return r._onProjectionChanged(t)};this._onViewportUpdatedDelegate=function(t){return r._onViewportUpdated(t)};this._onScissorUpdatedDelegate=function(t){return r._onScissorUpdated(t)};this.scene=e||new n;this.camera=i||new a;this.renderer=t;document.body.style.margin="0px";this._htmlElement=document.createElement("div");this._htmlElement.style.position="absolute";document.body.appendChild(this._htmlElement);this._mouseManager=p.getInstance();this._mouseManager.registerView(this)}Object.defineProperty(t.prototype,"mouseX",{get:function(){return this._pMouseX},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mouseY",{get:function(){return this._pMouseY},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"touchPoints",{get:function(){return this._pTouchPoints},enumerable:true,configurable:true});t.prototype.getLocalMouseX=function(t){return t.inverseSceneTransform.transformVector(this.unproject(this._pMouseX,this._pMouseY,1e3)).x};t.prototype.getLocalMouseY=function(t){return t.inverseSceneTransform.transformVector(this.unproject(this._pMouseX,this._pMouseY,1e3)).y};t.prototype.getLocalTouchPoints=function(t){var e;var i;var r=new Array;var n=this._pTouchPoints.length;for(var o=0;o<n;o++){e=new s;i=t.inverseSceneTransform.transformVector(this.unproject(this._pTouchPoints[o].x,this._pTouchPoints[o].y,1e3));e.x=i.x;e.y=i.y;r.push(e)}return r};Object.defineProperty(t.prototype,"htmlElement",{get:function(){return this._htmlElement},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderer",{get:function(){return this._pRenderer},set:function(t){if(this._pRenderer==t)return;if(this._pRenderer){this._pRenderer.dispose();this._pRenderer.removeEventListener(u.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.removeEventListener(u.SCISSOR_UPDATED,this._onScissorUpdatedDelegate)}this._pRenderer=t;this._pRenderer.addEventListener(u.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pRenderer.addEventListener(u.SCISSOR_UPDATED,this._onScissorUpdatedDelegate);this._pEntityCollector=this._pRenderer._iCreateEntityCollector();if(this._pCamera)this._pEntityCollector.camera=this._pCamera;this._pRenderer._iBackgroundR=(this._backgroundColor>>16&255)/255;this._pRenderer._iBackgroundG=(this._backgroundColor>>8&255)/255;this._pRenderer._iBackgroundB=(this._backgroundColor&255)/255;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha;this._pRenderer.width=this._width;this._pRenderer.height=this._height;this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"shareContext",{get:function(){return this._shareContext},set:function(t){if(this._shareContext==t)return;this._shareContext=t;if(this._pRenderer)this._pRenderer.shareContext=this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){if(this._backgroundColor==t)return;this._backgroundColor=t;this._pRenderer._iBackgroundR=(t>>16&255)/255;this._pRenderer._iBackgroundG=(t>>8&255)/255;this._pRenderer._iBackgroundB=(t&255)/255},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._backgroundAlpha==t)return;this._pRenderer._iBackgroundAlpha=this._backgroundAlpha=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"camera",{get:function(){return this._pCamera},set:function(t){if(this._pCamera==t)return;if(this._pCamera)this._pCamera.removeEventListener(l.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._pCamera=t;if(this._pEntityCollector)this._pEntityCollector.camera=this._pCamera;if(this._pScene)this._pScene.partition._iRegisterEntity(this._pCamera);this._pCamera.addEventListener(l.PROJECTION_CHANGED,this._onProjectionChangedDelegate);this._scissorDirty=true;this._viewportDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scene",{get:function(){return this._pScene},set:function(t){if(this._pScene==t)return;if(this._pScene)this._pScene.removeEventListener(h.PARTITION_CHANGED,this._onPartitionChangedDelegate);this._pScene=t;this._pScene.addEventListener(h.PARTITION_CHANGED,this._onPartitionChangedDelegate);if(this._pCamera)this._pScene.partition._iRegisterEntity(this._pCamera)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"deltaTime",{get:function(){return this._deltaTime},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width==t)return;this._width=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.width=t;this._htmlElement.style.width=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(t){if(this._height==t)return;this._height=t;this._aspectRatio=this._width/this._height;this._pCamera.projection._iAspectRatio=this._aspectRatio;this._pRenderer.height=t;this._htmlElement.style.height=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"mousePicker",{get:function(){return this._mousePicker},set:function(t){if(this._mousePicker==t)return;if(t==null)this._mousePicker=new o;else this._mousePicker=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._pRenderer.x},set:function(t){if(this._pRenderer.x==t)return;this._pRenderer.x==t;this._htmlElement.style.left=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._pRenderer.y},set:function(t){if(this._pRenderer.y==t)return;this._pRenderer.y==t;this._htmlElement.style.top=t+"px"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return this._htmlElement.style.visibility=="visible"},set:function(t){this._htmlElement.style.visibility=t?"visible":"hidden"},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderedFacesCount",{get:function(){return 0},enumerable:true,configurable:true});t.prototype.render=function(){this.pUpdateTime();this._pCamera.projection._iAspectRatio=this._aspectRatio;if(this._scissorDirty){this._scissorDirty=false;this._pCamera.projection._iUpdateScissorRect(this._pRenderer.scissorRect.x,this._pRenderer.scissorRect.y,this._pRenderer.scissorRect.width,this._pRenderer.scissorRect.height)}if(this._viewportDirty){this._viewportDirty=false;this._pCamera.projection._iUpdateViewport(this._pRenderer.viewPort.x,this._pRenderer.viewPort.y,this._pRenderer.viewPort.width,this._pRenderer.viewPort.height)}if(!this._shareContext){if(this.forceMouseMove&&this._htmlElement==this._mouseManager._iActiveDiv&&!this._mouseManager._iUpdateDirty)this._mouseManager._iCollidingObject=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);this._mouseManager.fireMouseEvents(this.forceMouseMove)}this._pEntityCollector.clear();this._pScene.traversePartitions(this._pEntityCollector);this._pRenderer.render(this._pEntityCollector)};t.prototype.pUpdateTime=function(){var t=r();if(this._time==0)this._time=t;this._deltaTime=t-this._time;this._time=t};t.prototype.dispose=function(){this._pRenderer.dispose();this._mouseManager.unregisterView(this);this._mouseManager=null;this._pRenderer=null;this._pEntityCollector=null};Object.defineProperty(t.prototype,"iEntityCollector",{get:function(){return this._pEntityCollector},enumerable:true,configurable:true});t.prototype._onPartitionChanged=function(t){if(this._pCamera)this._pScene.partition._iRegisterEntity(this._pCamera)};t.prototype._onProjectionChanged=function(t){this._scissorDirty=true;this._viewportDirty=true};t.prototype._onViewportUpdated=function(t){this._viewportDirty=true};t.prototype._onScissorUpdated=function(t){this._scissorDirty=true};t.prototype.project=function(t){var e=this._pCamera.project(t);e.x=e.x*this._pRenderer.viewPort.width/2+this._width*this._pCamera.projection.originX;e.y=e.y*this._pRenderer.viewPort.height/2+this._height*this._pCamera.projection.originY;return e};t.prototype.unproject=function(t,e,i){return this._pCamera.unproject(2*(t-this._width*this._pCamera.projection.originX)/this._pRenderer.viewPort.width,2*(e-this._height*this._pCamera.projection.originY)/this._pRenderer.viewPort.height,i)};t.prototype.getRay=function(t,e,i){return this._pCamera.getRay((t*2-this._width)/this._width,(e*2-this._height)/this._height,i)};t.prototype.updateCollider=function(){if(!this._shareContext){if(this._htmlElement==this._mouseManager._iActiveDiv)this._mouseManager._iCollidingObject=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this)}else{var t=this.mousePicker.getViewCollision(this._pMouseX,this._pMouseY,this);if(this.layeredView||this._mouseManager._iCollidingObject==null||t.rayEntryDistance<this._mouseManager._iCollidingObject.rayEntryDistance)this._mouseManager._iCollidingObject=t}};return t}();e.exports=c},{"awayjs-core/lib/utils/getTimer":undefined,"awayjs-display/lib/base/TouchPoint":"awayjs-display/lib/base/TouchPoint","awayjs-display/lib/containers/Scene":"awayjs-display/lib/containers/Scene","awayjs-display/lib/entities/Camera":"awayjs-display/lib/entities/Camera","awayjs-display/lib/events/CameraEvent":"awayjs-display/lib/events/CameraEvent","awayjs-display/lib/events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent","awayjs-display/lib/events/RendererEvent":"awayjs-display/lib/events/RendererEvent","awayjs-display/lib/managers/MouseManager":"awayjs-display/lib/managers/MouseManager","awayjs-display/lib/pick/RaycastPicker":"awayjs-display/lib/pick/RaycastPicker"}],"awayjs-display/lib/controllers/ControllerBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(t){if(t===void 0){t=null}this._pAutoUpdate=true;this.targetObject=t}t.prototype.pNotifyUpdate=function(){if(this._pTargetObject)this._pTargetObject.invalidatePartition()};Object.defineProperty(t.prototype,"targetObject",{get:function(){return this._pTargetObject},set:function(t){if(this._pTargetObject==t)return;if(this._pTargetObject&&this._pAutoUpdate)this._pTargetObject._iController=null;this._pTargetObject=t;if(this._pTargetObject&&this._pAutoUpdate)this._pTargetObject._iController=this;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._pAutoUpdate},set:function(t){if(this._pAutoUpdate==t)return;this._pAutoUpdate=t;if(this._pTargetObject){if(this._pAutoUpdate)this._pTargetObject._iController=this;else this._pTargetObject._iController=null}},enumerable:true,configurable:true});t.prototype.update=function(t){if(t===void 0){t=true}throw new r};t.prototype.updateController=function(){if(this._pControllerDirty&&this._pAutoUpdate){this._pControllerDirty=false;this.pNotifyUpdate()}};return t}();e.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/controllers/FirstPersonController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/MathConsts");var n=t("awayjs-display/lib/controllers/ControllerBase");var o=function(t){r(e,t);function e(e,i,r,s,n,o,a){if(e===void 0){e=null}if(i===void 0){i=0}if(r===void 0){r=90}if(s===void 0){s=-90}if(n===void 0){n=90}if(o===void 0){o=8}if(a===void 0){a=false}t.call(this,e);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._walkIncrement=0;this._strafeIncrement=0;this._wrapPanAngle=false;this.fly=false;this.panAngle=i;this.tiltAngle=r;this.minTiltAngle=s;this.maxTiltAngle=n;this.steps=o;this.wrapPanAngle=a;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this._pControllerDirty=true;if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}this.targetObject.rotationX=this._iCurrentTiltAngle;this.targetObject.rotationY=this._iCurrentPanAngle;if(this._walkIncrement){if(this.fly){this.targetObject.transform.moveForward(this._walkIncrement)}else{this.targetObject.x+=this._walkIncrement*Math.sin(this._panAngle*s.DEGREES_TO_RADIANS);this.targetObject.z+=this._walkIncrement*Math.cos(this._panAngle*s.DEGREES_TO_RADIANS)}this._walkIncrement=0}if(this._strafeIncrement){this.targetObject.transform.moveRight(this._strafeIncrement);this._strafeIncrement=0}};e.prototype.incrementWalk=function(t){if(t==0)return;this._walkIncrement+=t;this.pNotifyUpdate()};e.prototype.incrementStrafe=function(t){if(t==0)return;this._strafeIncrement+=t;this.pNotifyUpdate()};return e}(n);e.exports=o},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-display/lib/controllers/ControllerBase":"awayjs-display/lib/controllers/ControllerBase"}],"awayjs-display/lib/controllers/FollowController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/controllers/HoverController");var n=function(t){r(e,t);function e(e,i,r,s){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=45}if(s===void 0){s=700}t.call(this,e,i,0,r,s)}e.prototype.update=function(e){if(e===void 0){e=true}if(!this.lookAtObject)return;this.panAngle=this._pLookAtObject.rotationY-180;t.prototype.update.call(this)};return e}(s);e.exports=n},{"awayjs-display/lib/controllers/HoverController":"awayjs-display/lib/controllers/HoverController"}],"awayjs-display/lib/controllers/HoverController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/MathConsts");var n=t("awayjs-core/lib/geom/Vector3D");var o=t("awayjs-display/lib/controllers/LookAtController");var a=function(t){r(e,t);function e(e,i,r,s,o,a,l,h,u,p,c,f){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=0}if(s===void 0){s=90}if(o===void 0){o=1e3}if(a===void 0){a=-90}if(l===void 0){l=90}if(h===void 0){h=null}if(u===void 0){u=null}if(p===void 0){p=8}if(c===void 0){c=2}if(f===void 0){f=false}t.call(this,e,i);this._iCurrentPanAngle=0;this._iCurrentTiltAngle=90;this._panAngle=0;this._tiltAngle=90;this._distance=1e3;this._minPanAngle=-Infinity;this._maxPanAngle=Infinity;this._minTiltAngle=-90;this._maxTiltAngle=90;this._steps=8;this._yFactor=2;this._wrapPanAngle=false;this._upAxis=new n;this.distance=o;this.panAngle=r;this.tiltAngle=s;this.minPanAngle=h!=null?h:-Infinity;this.maxPanAngle=u!=null?u:Infinity;this.minTiltAngle=a;this.maxTiltAngle=l;this.steps=p;this.yFactor=c;this.wrapPanAngle=f;this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}Object.defineProperty(e.prototype,"steps",{get:function(){return this._steps},set:function(t){t=t<1?1:t;if(this._steps==t)return;this._steps=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"panAngle",{get:function(){return this._panAngle},set:function(t){t=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,t));if(this._panAngle==t)return;this._panAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tiltAngle",{get:function(){return this._tiltAngle},set:function(t){t=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,t));if(this._tiltAngle==t)return;this._tiltAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){if(this._distance==t)return;this._distance=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minPanAngle",{get:function(){return this._minPanAngle},set:function(t){if(this._minPanAngle==t)return;this._minPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxPanAngle",{get:function(){return this._maxPanAngle},set:function(t){if(this._maxPanAngle==t)return;this._maxPanAngle=t;this.panAngle=Math.max(this._minPanAngle,Math.min(this._maxPanAngle,this._panAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"minTiltAngle",{get:function(){return this._minTiltAngle},set:function(t){if(this._minTiltAngle==t)return;this._minTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxTiltAngle",{get:function(){return this._maxTiltAngle},set:function(t){if(this._maxTiltAngle==t)return;this._maxTiltAngle=t;this.tiltAngle=Math.max(this._minTiltAngle,Math.min(this._maxTiltAngle,this._tiltAngle))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yFactor",{get:function(){return this._yFactor},set:function(t){if(this._yFactor==t)return;this._yFactor=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"wrapPanAngle",{get:function(){return this._wrapPanAngle},set:function(t){if(this._wrapPanAngle==t)return;this._wrapPanAngle=t;this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._tiltAngle!=this._iCurrentTiltAngle||this._panAngle!=this._iCurrentPanAngle){this._pControllerDirty=true;if(this._wrapPanAngle){if(this._panAngle<0){this._iCurrentPanAngle+=this._panAngle%360+360-this._panAngle;this._panAngle=this._panAngle%360+360}else{this._iCurrentPanAngle+=this._panAngle%360-this._panAngle;this._panAngle=this._panAngle%360}while(this._panAngle-this._iCurrentPanAngle<-180)this._iCurrentPanAngle-=360;while(this._panAngle-this._iCurrentPanAngle>180)this._iCurrentPanAngle+=360}if(t){this._iCurrentTiltAngle+=(this._tiltAngle-this._iCurrentTiltAngle)/(this.steps+1);this._iCurrentPanAngle+=(this._panAngle-this._iCurrentPanAngle)/(this.steps+1)}else{this._iCurrentPanAngle=this._panAngle;this._iCurrentTiltAngle=this._tiltAngle}if(Math.abs(this.tiltAngle-this._iCurrentTiltAngle)<.01&&Math.abs(this._panAngle-this._iCurrentPanAngle)<.01){this._iCurrentTiltAngle=this._tiltAngle;this._iCurrentPanAngle=this._panAngle}}var e=this.lookAtObject?this.lookAtObject.transform.position:this.lookAtPosition?this.lookAtPosition:this._pOrigin;this.targetObject.x=e.x+this.distance*Math.sin(this._iCurrentPanAngle*s.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS);this.targetObject.y=e.y+this.distance*Math.sin(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS)*this.yFactor;this.targetObject.z=e.z+this.distance*Math.cos(this._iCurrentPanAngle*s.DEGREES_TO_RADIANS)*Math.cos(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS);this._upAxis.x=-Math.sin(this._iCurrentPanAngle*s.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS);this._upAxis.y=Math.cos(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS);this._upAxis.z=-Math.cos(this._iCurrentPanAngle*s.DEGREES_TO_RADIANS)*Math.sin(this._iCurrentTiltAngle*s.DEGREES_TO_RADIANS);if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition,this._upAxis);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position,this._upAxis)}};return e}(o);e.exports=a},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/LookAtController":"awayjs-display/lib/controllers/LookAtController"}],"awayjs-display/lib/controllers/LookAtController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-display/lib/controllers/ControllerBase");var o=t("awayjs-display/lib/events/DisplayObjectEvent");var a=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=null}if(i===void 0){i=null}t.call(this,e);this._pOrigin=new s(0,0,0);this._onLookAtObjectChangedDelegate=function(t){return r.onLookAtObjectChanged(t)};if(i)this.lookAtObject=i;else this.lookAtPosition=new s}Object.defineProperty(e.prototype,"lookAtPosition",{get:function(){return this._pLookAtPosition},set:function(t){if(this._pLookAtObject){this._pLookAtObject.removeEventListener(o.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=null}this._pLookAtPosition=t;this.pNotifyUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lookAtObject",{get:function(){return this._pLookAtObject},set:function(t){if(this._pLookAtPosition)this._pLookAtPosition=null;if(this._pLookAtObject==t)return;if(this._pLookAtObject)this._pLookAtObject.removeEventListener(o.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this._pLookAtObject=t;if(this._pLookAtObject)this._pLookAtObject.addEventListener(o.SCENETRANSFORM_CHANGED,this._onLookAtObjectChangedDelegate);this.pNotifyUpdate()},enumerable:true,configurable:true});e.prototype.update=function(t){if(t===void 0){t=true}if(this._pTargetObject){if(this._pLookAtPosition)this._pTargetObject.lookAt(this._pLookAtPosition);else if(this._pLookAtObject)this._pTargetObject.lookAt(this._pLookAtObject.scene?this._pLookAtObject.scenePosition:this._pLookAtObject.transform.position)}};e.prototype.onLookAtObjectChanged=function(t){this.pNotifyUpdate()};return e}(n);e.exports=a},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/ControllerBase":"awayjs-display/lib/controllers/ControllerBase","awayjs-display/lib/events/DisplayObjectEvent":"awayjs-display/lib/events/DisplayObjectEvent"}],"awayjs-display/lib/controllers/SpringController":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];
function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-display/lib/controllers/LookAtController");var o=function(t){r(e,t);function e(e,i,r,n,o){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=1}if(n===void 0){n=40}if(o===void 0){o=4}t.call(this,e,i);this.positionOffset=new s(0,500,-1e3);this.stiffness=r;this.damping=o;this.mass=n;this._velocity=new s;this._dv=new s;this._stretch=new s;this._force=new s;this._acceleration=new s;this._desiredPosition=new s}e.prototype.update=function(e){if(e===void 0){e=true}var i;if(!this._pLookAtObject||!this._pTargetObject)return;this._pControllerDirty=true;i=this._pLookAtObject.transform.matrix3D.deltaTransformVector(this.positionOffset);this._desiredPosition.x=this._pLookAtObject.x+i.x;this._desiredPosition.y=this._pLookAtObject.y+i.y;this._desiredPosition.z=this._pLookAtObject.z+i.z;this._stretch=this._pTargetObject.transform.position.add(this._desiredPosition);this._stretch.scaleBy(-this.stiffness);this._dv.copyFrom(this._velocity);this._dv.scaleBy(this.damping);this._force.x=this._stretch.x-this._dv.x;this._force.y=this._stretch.y-this._dv.y;this._force.z=this._stretch.z-this._dv.z;this._acceleration.copyFrom(this._force);this._acceleration.scaleBy(1/this.mass);this._velocity.incrementBy(this._acceleration);this._pTargetObject.transform.position=this._pTargetObject.transform.position.add(this._velocity);t.prototype.update.call(this)};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/controllers/LookAtController":"awayjs-display/lib/controllers/LookAtController"}],"awayjs-display/lib/draw/CapsStyle":[function(t,e,i){var r=function(){function t(){}t.ROUND="round";t.NONE="none";t.SQUARE="square";return t}();e.exports=r},{}],"awayjs-display/lib/draw/GradientType":[function(t,e,i){var r=function(){function t(){}t.LINEAR="linear";t.RADIAL="radial";return t}();e.exports=r},{}],"awayjs-display/lib/draw/GraphicsPathWinding":[function(t,e,i){var r=function(){function t(){}t.EVEN_ODD="evenOdd";t.NON_ZERO="nonZero";return t}();e.exports=r},{}],"awayjs-display/lib/draw/Graphics":[function(t,e,i){var r=function(){function t(){}t.prototype.beginBitmapFill=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}};t.prototype.beginFill=function(t,e){if(e===void 0){e=1}};t.prototype.beginGradientFill=function(t,e,i,r,s,n,o,a){if(s===void 0){s=null}if(n===void 0){n="pad"}if(o===void 0){o="rgb"}if(a===void 0){a=0}};t.prototype.clear=function(){};t.prototype.copyFrom=function(t){};t.prototype.cubicCurveTo=function(t,e,i,r,s,n){};t.prototype.curveTo=function(t,e,i,r){};t.prototype.drawCircle=function(t,e,i){};t.prototype.drawEllipse=function(t,e,i,r){};t.prototype.drawGraphicsData=function(t){};t.prototype.drawPath=function(t,e,i){};t.prototype.drawRect=function(t,e,i,r){};t.prototype.drawRoundRect=function(t,e,i,r,s,n){if(n===void 0){n=NaN}};t.prototype.drawTriangles=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=null}};t.prototype.endFill=function(){};t.prototype.lineBitmapStyle=function(t,e,i,r){if(e===void 0){e=null}if(i===void 0){i=true}if(r===void 0){r=false}};t.prototype.lineGradientStyle=function(t,e,i,r,s,n,o,a){if(s===void 0){s=null}if(n===void 0){n=null}if(o===void 0){o=null}if(a===void 0){a=0}};t.prototype.lineStyle=function(t,e,i,r,s,n,o,a){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=1}if(r===void 0){r=false}if(s===void 0){s=null}if(n===void 0){n=null}if(o===void 0){o=null}if(a===void 0){a=3}};t.prototype.lineTo=function(t,e){};t.prototype.moveTo=function(t,e){};return t}();e.exports=r},{}],"awayjs-display/lib/draw/IGraphicsData":[function(t,e,i){},{}],"awayjs-display/lib/draw/InterpolationMethod":[function(t,e,i){var r=function(){function t(){}t.LINEAR_RGB="linearRGB";t.RGB="rgb";return t}();e.exports=r},{}],"awayjs-display/lib/draw/JointStyle":[function(t,e,i){var r=function(){function t(){}t.BEVEL="bevel";t.MITER="miter";t.ROUND="round";return t}();e.exports=r},{}],"awayjs-display/lib/draw/LineScaleMode":[function(t,e,i){var r=function(){function t(){}t.HORIZONTAL="horizontal";t.NONE="none";t.NORMAL="normal";t.VERTICAL="vertical";return t}();e.exports=r},{}],"awayjs-display/lib/draw/PixelSnapping":[function(t,e,i){var r=function(){function t(){}t.ALWAYS="always";t.AUTO="auto";t.NEVER="never";return t}();e.exports=r},{}],"awayjs-display/lib/draw/SpreadMethod":[function(t,e,i){var r=function(){function t(){}t.PAD="pad";t.REFLECT="reflect";t.REPEAT="repeat";return t}();e.exports=r},{}],"awayjs-display/lib/draw/TriangleCulling":[function(t,e,i){var r=function(){function t(){}t.NEGATIVE="negative";t.NONE="none";t.POSITIVE="positive";return t}();e.exports=r},{}],"awayjs-display/lib/entities/Billboard":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Rectangle");var n=t("awayjs-core/lib/geom/ColorTransform");var o=t("awayjs-display/lib/base/DisplayObject");var a=t("awayjs-display/lib/bounds/BoundsType");var l=t("awayjs-display/lib/events/MaterialEvent");var h=function(t){r(e,t);function e(e,i,r){var n=this;if(i===void 0){i="auto"}if(r===void 0){r=false}t.call(this);this._pIsEntity=true;this.onSizeChangedDelegate=function(t){return n.onSizeChanged(t)};this.material=e;this._billboardWidth=e.width;this._billboardHeight=e.height;this._billboardRect=this._material.frameRect||new s(0,0,this._billboardWidth,this._billboardHeight);this._boundsType=a.AXIS_ALIGNED_BOX;this._billboardWidth=e.width}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardRect",{get:function(){return this._billboardRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardHeight",{get:function(){return this._billboardHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"billboardWidth",{get:function(){return this._billboardWidth},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;if(this._material){this._material.iRemoveOwner(this);this._material.removeEventListener(l.SIZE_CHANGED,this.onSizeChangedDelegate)}this._material=t;if(this._material){this._material.iAddOwner(this);this._material.addEventListener(l.SIZE_CHANGED,this.onSizeChangedDelegate)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this.transform.colorTransform=t;this._applyColorTransform()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"parentColorTransform",{get:function(){return this._parentColorTransform},set:function(t){this._parentColorTransform=t;this._applyColorTransform()},enumerable:true,configurable:true});e.prototype._applyColorTransform=function(){this._colorTransform=new n;if(this._parentColorTransform&&this.transform.colorTransform){this._colorTransform.alphaMultiplier=this.transform.colorTransform.alphaMultiplier*this._parentColorTransform.alphaMultiplier;this._colorTransform.redMultiplier=this.transform.colorTransform.redMultiplier*this._parentColorTransform.redMultiplier;this._colorTransform.blueMultiplier=this.transform.colorTransform.blueMultiplier*this._parentColorTransform.blueMultiplier;this._colorTransform.greenMultiplier=this.transform.colorTransform.greenMultiplier*this._parentColorTransform.greenMultiplier;this._colorTransform.alphaOffset=this.transform.colorTransform.alphaOffset+this._parentColorTransform.alphaOffset;this._colorTransform.redOffset=this.transform.colorTransform.redOffset+this._parentColorTransform.redOffset;this._colorTransform.blueOffset=this.transform.colorTransform.blueOffset+this._parentColorTransform.blueOffset;this._colorTransform.greenOffset=this.transform.colorTransform.greenOffset+this._parentColorTransform.greenOffset}else if(this.transform.colorTransform){this._colorTransform.alphaMultiplier=this.transform.colorTransform.alphaMultiplier;this._colorTransform.redMultiplier=this.transform.colorTransform.redMultiplier;this._colorTransform.blueMultiplier=this.transform.colorTransform.blueMultiplier;this._colorTransform.greenMultiplier=this.transform.colorTransform.greenMultiplier;this._colorTransform.alphaOffset=this.transform.colorTransform.alphaOffset;this._colorTransform.redOffset=this.transform.colorTransform.redOffset;this._colorTransform.blueOffset=this.transform.colorTransform.blueOffset;this._colorTransform.greenOffset=this.transform.colorTransform.greenOffset}else if(this._parentColorTransform){this._colorTransform.alphaMultiplier=this._parentColorTransform.alphaMultiplier;this._colorTransform.redMultiplier=this._parentColorTransform.redMultiplier;this._colorTransform.blueMultiplier=this._parentColorTransform.blueMultiplier;this._colorTransform.greenMultiplier=this._parentColorTransform.greenMultiplier;this._colorTransform.alphaOffset=this._parentColorTransform.alphaOffset;this._colorTransform.redOffset=this._parentColorTransform.redOffset;this._colorTransform.blueOffset=this._parentColorTransform.blueOffset;this._colorTransform.greenOffset=this._parentColorTransform.greenOffset}};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.width=this._billboardRect.width;this._pBoxBounds.height=this._billboardRect.height};e.prototype.clone=function(){var t=new e(this.material);return t};e.prototype._iTestCollision=function(t,e){return this._pPickingCollider.testBillboardCollision(this,this.material,this._pPickingCollisionVO,t)};e.prototype.onSizeChanged=function(t){this._billboardWidth=this._material.width;this._billboardHeight=this._material.height;this._billboardRect=this._material.frameRect||new s(0,0,this._billboardWidth,this._billboardHeight);this._pInvalidateBounds();var e=this._pRenderables.length;for(var i=0;i<e;i++)this._pRenderables[i].invalidateGeometry()};e.prototype._applyRenderer=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();t._iApplyRenderableOwner(this)};e.assetType="[asset Billboard]";return e}(o);e.exports=h},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-display/lib/base/DisplayObject":"awayjs-display/lib/base/DisplayObject","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/events/MaterialEvent":"awayjs-display/lib/events/MaterialEvent"}],"awayjs-display/lib/entities/Camera":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Plane3D");var o=t("awayjs-core/lib/events/ProjectionEvent");var a=t("awayjs-core/lib/projections/PerspectiveProjection");var l=t("awayjs-display/lib/base/HierarchicalProperties");var h=t("awayjs-display/lib/bounds/BoundsType");var u=t("awayjs-display/lib/containers/DisplayObjectContainer");var p=t("awayjs-display/lib/events/CameraEvent");var c=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._viewProjection=new s;this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this._pIsEntity=true;this._onProjectionMatrixChangedDelegate=function(t){return i.onProjectionMatrixChanged(t)};this._projection=e||new a;this._projection.addEventListener(o.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._frustumPlanes=[];for(var r=0;r<6;++r)this._frustumPlanes[r]=new n;this.z=-1e3;this._boundsType=h.NULL}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.onProjectionMatrixChanged=function(t){this._viewProjectionDirty=true;this._frustumPlanesDirty=true;this.dispatchEvent(t)};Object.defineProperty(e.prototype,"frustumPlanes",{get:function(){if(this._frustumPlanesDirty)this.updateFrustum();return this._frustumPlanes},enumerable:true,configurable:true});e.prototype.updateFrustum=function(){var t,e,i;var r,s,n,o;var a,l,h,u;var p,c,f,_;var d,y,b,m;var v;var g=this.viewProjection.rawData;var w;r=g[0];s=g[4];n=g[8];o=g[12];a=g[1];l=g[5];h=g[9];u=g[13];p=g[2];c=g[6];f=g[10];_=g[14];d=g[3];y=g[7];b=g[11];m=g[15];v=this._frustumPlanes[0];t=d+r;e=y+s;i=b+n;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=-(m+o)*w;v=this._frustumPlanes[1];t=d-r;e=y-s;i=b-n;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=(o-m)*w;v=this._frustumPlanes[2];t=d+a;e=y+l;i=b+h;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=-(m+u)*w;v=this._frustumPlanes[3];t=d-a;e=y-l;i=b-h;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=(u-m)*w;v=this._frustumPlanes[4];t=p;e=c;i=f;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=-_*w;v=this._frustumPlanes[5];t=d-p;e=y-c;i=b-f;w=1/Math.sqrt(t*t+e*e+i*i);v.a=t*w;v.b=e*w;v.c=i*w;v.d=(_-m)*w;this._frustumPlanesDirty=false};e.prototype.pInvalidateHierarchicalProperties=function(e){if(t.prototype.pInvalidateHierarchicalProperties.call(this,e))return true;if(this._hierarchicalPropsDirty&l.SCENE_TRANSFORM){this._viewProjectionDirty=true;this._frustumPlanesDirty=true}return false};Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection},set:function(t){if(this._projection==t)return;if(!t)throw new Error("Projection cannot be null!");this._projection.removeEventListener(o.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this._projection=t;this._projection.addEventListener(o.MATRIX_CHANGED,this._onProjectionMatrixChangedDelegate);this.dispatchEvent(new p(p.PROJECTION_CHANGED,this))},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"viewProjection",{get:function(){if(this._viewProjectionDirty){this._viewProjection.copyFrom(this.inverseSceneTransform);this._viewProjection.append(this._projection.matrix);this._viewProjectionDirty=false}return this._viewProjection},enumerable:true,configurable:true});e.prototype.getRay=function(t,e,i){return this.sceneTransform.deltaTransformVector(this._projection.unproject(t,e,i))};e.prototype.project=function(t){return this._projection.project(this.inverseSceneTransform.transformVector(t))};e.prototype.unproject=function(t,e,i){return this.sceneTransform.transformVector(this._projection.unproject(t,e,i))};e.prototype._applyRenderer=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate()};e.assetType="[asset Camera]";return e}(u);e.exports=c},{"awayjs-core/lib/events/ProjectionEvent":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Plane3D":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-display/lib/base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/events/CameraEvent":"awayjs-display/lib/events/CameraEvent"}],"awayjs-display/lib/entities/DirectionalLight":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Matrix3D");var o=t("awayjs-core/lib/geom/Vector3D");var a=t("awayjs-display/lib/base/LightBase");var l=t("awayjs-display/lib/base/HierarchicalProperties");var h=t("awayjs-display/lib/bounds/BoundsType");var u=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var p=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=0}if(i===void 0){i=-1}if(r===void 0){r=1}t.call(this);this._pAabbPoints=new Array(24);this._pIsEntity=true;this.direction=new o(e,i,r);this._sceneDirection=new o;this._boundsType=h.NULL}Object.defineProperty(e.prototype,"sceneDirection",{get:function(){if(this._hierarchicalPropsDirty&l.SCENE_TRANSFORM)this.pUpdateSceneTransform();return this._sceneDirection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction=t;if(!this._tmpLookAt)this._tmpLookAt=new o;this._tmpLookAt.x=this.x+this._direction.x;this._tmpLookAt.y=this.y+this._direction.y;this._tmpLookAt.z=this.z+this._direction.z;this.lookAt(this._tmpLookAt)},enumerable:true,configurable:true});e.prototype.pUpdateSceneTransform=function(){t.prototype.pUpdateSceneTransform.call(this);this.sceneTransform.copyColumnTo(2,this._sceneDirection);this._sceneDirection.normalize()};e.prototype.pCreateShadowMapper=function(){return new u};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=s.RAW_DATA_CONTAINER;var o=new n;o.copyFrom(t.getRenderSceneTransform(e));o.append(this.inverseSceneTransform);if(!this._projAABBPoints)this._projAABBPoints=[];o.transformVectors(this._pAabbPoints,this._projAABBPoints);var a=Infinity,l=-Infinity;var h=Infinity,u=-Infinity;var p=Infinity,c=-Infinity;var f;for(var _=0;_<24;){f=this._projAABBPoints[_++];if(f<a)a=f;if(f>l)l=f;f=this._projAABBPoints[_++];if(f<h)h=f;if(f>u)u=f;f=this._projAABBPoints[_++];if(f<p)p=f;if(f>c)c=f}var d=1/(l-a);var y=1/(u-h);var b=1/(c-p);r[0]=2*d;r[5]=2*y;r[10]=b;r[12]=-(l+a)*d;r[13]=-(u+h)*y;r[14]=-p*b;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;r[15]=1;if(!i)i=new n;i.copyRawDataFrom(r);i.prepend(o);return i};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);var e=this._pBoxBounds.x;var i=this._pBoxBounds.y-this._pBoxBounds.height;var r=this._pBoxBounds.z;var s=this._pBoxBounds.x+this._pBoxBounds.width;var n=this._pBoxBounds.y;var o=this._pBoxBounds.z+this._pBoxBounds.depth;this._pAabbPoints[0]=e;this._pAabbPoints[1]=i;this._pAabbPoints[2]=r;this._pAabbPoints[3]=s;this._pAabbPoints[4]=i;this._pAabbPoints[5]=r;this._pAabbPoints[6]=e;this._pAabbPoints[7]=n;this._pAabbPoints[8]=r;this._pAabbPoints[9]=s;this._pAabbPoints[10]=n;this._pAabbPoints[11]=r;this._pAabbPoints[12]=e;this._pAabbPoints[13]=i;this._pAabbPoints[14]=o;this._pAabbPoints[15]=s;this._pAabbPoints[16]=i;this._pAabbPoints[17]=o;this._pAabbPoints[18]=e;this._pAabbPoints[19]=n;this._pAabbPoints[20]=o;this._pAabbPoints[21]=s;this._pAabbPoints[22]=n;this._pAabbPoints[23]=o};return e}(a);e.exports=p},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/HierarchicalProperties":"awayjs-display/lib/base/HierarchicalProperties","awayjs-display/lib/base/LightBase":"awayjs-display/lib/base/LightBase","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper"}],"awayjs-display/lib/entities/IEntity":[function(t,e,i){},{}],"awayjs-display/lib/entities/LightProbe":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/errors/Error");var n=t("awayjs-display/lib/base/LightBase");var o=t("awayjs-display/lib/bounds/BoundsType");var a=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this);this._pIsEntity=true;this._diffuseMap=e;this._specularMap=i;this._boundsType=o.NULL}Object.defineProperty(e.prototype,"diffuseMap",{get:function(){return this._diffuseMap},set:function(t){this._diffuseMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMap},set:function(t){this._specularMap=t},enumerable:true,configurable:true});e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}throw new s("Object projection matrices are not supported for LightProbe objects!")};return e}(n);e.exports=a},{"awayjs-core/lib/errors/Error":undefined,"awayjs-display/lib/base/LightBase":"awayjs-display/lib/base/LightBase","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType"}],"awayjs-display/lib/entities/LineSegment":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/base/DisplayObject");var n=t("awayjs-display/lib/bounds/BoundsType");var o=function(t){r(e,t);function e(e,i,r,s){if(s===void 0){s=1}t.call(this);this._pIsEntity=true;this.material=e;this._startPosition=i;this._endPosition=r;this._halfThickness=s*.5;this._boundsType=n.AXIS_ALIGNED_BOX}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPostion",{get:function(){return this._startPosition},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startPosition",{set:function(t){if(this._startPosition==t)return;this._startPosition=t;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"endPosition",{get:function(){return this._endPosition},set:function(t){if(this._endPosition==t)return;this._endPosition=t;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(this.material)this.material.iRemoveOwner(this);this._material=t;if(this.material)this.material.iAddOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"thickness",{get:function(){return this._halfThickness*2},set:function(t){if(this._halfThickness==t)return;this._halfThickness=t*.5;this.notifyRenderableUpdate()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this._startPosition=null;this._endPosition=null};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);this._pBoxBounds.x=Math.min(this._startPosition.x,this._endPosition.x);this._pBoxBounds.y=Math.min(this._startPosition.y,this._endPosition.y);this._pBoxBounds.z=Math.min(this._startPosition.z,this._endPosition.z);this._pBoxBounds.width=Math.abs(this._startPosition.x-this._endPosition.x);this._pBoxBounds.height=Math.abs(this._startPosition.y-this._endPosition.y);this._pBoxBounds.depth=Math.abs(this._startPosition.z-this._endPosition.z)};e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);this._pUpdateBoxBounds();var e=(this._endPosition.x-this._startPosition.x)/2;var i=(this._endPosition.y-this._startPosition.y)/2;var r=(this._endPosition.z-this._startPosition.z)/2;this._pSphereBounds.x=this._startPosition.x+e;this._pSphereBounds.y=this._startPosition.y+i;this._pSphereBounds.z=this._startPosition.z+r;this._pSphereBounds.radius=Math.sqrt(e*e+i*i+r*r)};e.prototype.notifyRenderableUpdate=function(){var t=this._pRenderables.length;for(var e=0;e<t;e++)this._pRenderables[e].invalidateGeometry()};e.prototype._applyRenderer=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();t._iApplyRenderableOwner(this)};e.assetType="[asset LineSegment]";return e}(s);e.exports=o},{"awayjs-display/lib/base/DisplayObject":"awayjs-display/lib/base/DisplayObject","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType"}],"awayjs-display/lib/entities/Mesh":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Point");var n=t("awayjs-display/lib/base/Geometry");var o=t("awayjs-display/lib/base/CurveSubGeometry");var a=t("awayjs-display/lib/events/GeometryEvent");var l=t("awayjs-display/lib/containers/DisplayObjectContainer");var h=t("awayjs-display/lib/pool/SubMeshPool");var u=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._castsShadows=true;this._shareAnimationGeometry=true;this._tempPoint=new s;this._pIsEntity=true;this._subMeshes=new Array;this._onGeometryBoundsInvalidDelegate=function(t){return r.onGeometryBoundsInvalid(t)};this._onSubGeometryAddedDelegate=function(t){return r.onSubGeometryAdded(t)};this._onSubGeometryRemovedDelegate=function(t){return r.onSubGeometryRemoved(t)};this.geometry=e||new n;this.material=i}Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},set:function(t){if(this._animator)this._animator.removeOwner(this);this._animator=t;var e=this._subMeshes.length;var i;for(var r=0;r<e;++r){i=this._subMeshes[r];if(i.material){i.material.iRemoveOwner(i);i.material.iAddOwner(i)}i._iInvalidateRenderableGeometry()}if(this._animator)this._animator.addOwner(this)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castsShadows",{get:function(){return this._castsShadows},set:function(t){this._castsShadows=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometry",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._geometry},set:function(t){var e;if(this._geometry){this._geometry.removeEventListener(a.BOUNDS_INVALID,this._onGeometryBoundsInvalidDelegate);this._geometry.removeEventListener(a.SUB_GEOMETRY_ADDED,this._onSubGeometryAddedDelegate);this._geometry.removeEventListener(a.SUB_GEOMETRY_REMOVED,this._onSubGeometryRemovedDelegate);for(e=0;e<this._subMeshes.length;++e)this._subMeshes[e].dispose();this._subMeshes.length=0}this._geometry=t;if(this._geometry){this._geometry.addEventListener(a.BOUNDS_INVALID,this._onGeometryBoundsInvalidDelegate);this._geometry.addEventListener(a.SUB_GEOMETRY_ADDED,this._onSubGeometryAddedDelegate);this._geometry.addEventListener(a.SUB_GEOMETRY_REMOVED,this._onSubGeometryRemovedDelegate);var i=this._geometry.subGeometries;for(e=0;e<i.length;++e)this.addSubMesh(i[e])}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;var e;var i=this._subMeshes.length;var r;for(e=0;e<i;e++)if(this._material&&(r=this._subMeshes[e]).material==this._material)this._material.iRemoveOwner(r);this._material=t;for(e=0;e<i;e++)if(this._material&&(r=this._subMeshes[e]).material==this._material)this._material.iAddOwner(r)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shareAnimationGeometry",{get:function(){return this._shareAnimationGeometry},set:function(t){this._shareAnimationGeometry=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subMeshes",{get:function(){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();return this._subMeshes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});e.prototype.bakeTransformations=function(){this.geometry.applyTransformation(this._iMatrix3D);this._iMatrix3D.identity()};e.prototype.dispose=function(){t.prototype.dispose.call(this);this.material=null;this.geometry=null};e.prototype.disposeWithAnimatorAndChildren=function(){this.disposeWithChildren();if(this._animator)this._animator.dispose()};e.prototype.clone=function(){var t=new e(null,null);this._iCopyToMesh(t);return t};e.prototype._iCopyToMesh=function(t){t.geometry=this._geometry;t.material=this._material;t._iMatrix3D=this._iMatrix3D;t.pivot=this.pivot;t.partition=this.partition;t.boundsType=this.boundsType;t.name=this.name;t.castsShadows=this.castsShadows;t.shareAnimationGeometry=this.shareAnimationGeometry;t.mouseEnabled=this.mouseEnabled;t.mouseChildren=this.mouseChildren;t.extra=this.extra;t.maskMode=this.maskMode;t.masks=this.masks?this.masks.concat():null;var e=this._subMeshes.length;for(var i=0;i<e;++i)t._subMeshes[i].material=this._subMeshes[i]._iGetExplicitMaterial();e=this.numChildren;for(i=0;i<e;++i)t.addChild(this._children[i].clone());if(this._animator)t.animator=this._animator.clone()};e.prototype.getSubMeshFromSubGeometry=function(t){return this._subMeshes[this._geometry.subGeometries.indexOf(t)]};e.prototype._pUpdateBoxBounds=function(){t.prototype._pUpdateBoxBounds.call(this);var e,i,r,s;var n=this._geometry.subGeometries;var a;var l;var h=n.length;var u,p,c;var f,_,d;var y,b;if(h>0){e=0;a=n[0];l=a.getBoundingPositions();if(this.numChildren){f=this._pBoxBounds.width+(u=this._pBoxBounds.x);_=this._pBoxBounds.height+(p=this._pBoxBounds.y);d=this._pBoxBounds.depth+(c=this._pBoxBounds.z);y=this._pBoxBounds.depth+(b=this._pBoxBounds.z)}else{u=f=l[e];p=_=l[e+1];if(a.isAsset(o)){c=d=0;b=y=0}else{b=y=l[e+2]}}for(i=0;i<h;i++){a=n[i];l=a.getBoundingPositions();s=l.length;for(e=0;e<s;e+=3){r=l[e];if(r<u)u=r;else if(r>f)f=r;r=l[e+1];if(r<p)p=r;else if(r>_)_=r;r=l[e+2];if(r<b)b=r;else if(r>y)y=r}if(!a.isAsset(o)){c=b;d=y}}this._pBoxBounds.width=f-(this._pBoxBounds.x=u);this._pBoxBounds.height=_-(this._pBoxBounds.y=p);this._pBoxBounds.depth=d-(this._pBoxBounds.z=c)}};e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);var e=this.getBox();var i=e.x+e.width/2;var r=e.y+e.height/2;var s=e.z+e.depth/2;var n,o,a,l;var h=this._geometry.subGeometries;var u;var p;var c=h.length;var f=0;var _;var d;var y;var b;if(c>0){n=0;u=h[0];p=u.getBoundingPositions();for(o=0;o<c;o++){u=h[o];p=u.getBoundingPositions();l=p.length;for(n=0;n<l;n+=3){d=p[n]-i;y=p[n+1]-r;b=p[n+2]-s;_=d*d+y*y+b*b;if(f<_)f=_}}}this._pSphereBounds.x=i;this._pSphereBounds.y=r;this._pSphereBounds.z=s;this._pSphereBounds.radius=Math.sqrt(f)};e.prototype.onGeometryBoundsInvalid=function(t){this._pInvalidateBounds()};e.prototype.onSubGeometryAdded=function(t){this.addSubMesh(t.subGeometry)};e.prototype.onSubGeometryRemoved=function(t){var e;var i=t.subGeometry;var r=this._subMeshes.length;var s;for(s=0;s<r;++s){e=this._subMeshes[s];if(e.subGeometry==i){e.dispose();this._subMeshes.splice(s,1);break}}--r;for(;s<r;++s)this._subMeshes[s]._iIndex=s};e.prototype.addSubMesh=function(t){var e=h.getClass(t);var i=new e(t,this,null);var r=this._subMeshes.length;i._iIndex=r;this._subMeshes[r]=i;this._pInvalidateBounds()};e.prototype._iTestCollision=function(t,e){this._pPickingCollisionVO.renderableOwner=null;var i;var r=this.subMeshes.length;for(var s=0;s<r;++s){i=this.subMeshes[s];if(i.subGeometry._iTestCollision(this._pPickingCollider,i.material,this._pPickingCollisionVO,t)){t=this._pPickingCollisionVO.rayEntryDistance;this._pPickingCollisionVO.renderableOwner=i;if(!e)return true}}return this._pPickingCollisionVO.renderableOwner!=null};e.prototype._applyRenderer=function(t){if(this._iSourcePrefab)this._iSourcePrefab._iValidate();var e=this._subMeshes.length;for(var i=0;i<e;i++)t._iApplyRenderableOwner(this._subMeshes[i])};e.prototype._iInvalidateRenderableGeometries=function(){var t=this._subMeshes.length;for(var e=0;e<t;++e)this._subMeshes[e]._iInvalidateRenderableGeometry()
};e.prototype._hitTestPointInternal=function(e,i,r,s){if(t.prototype._hitTestPointInternal.call(this,e,i,r,s))return true;this._tempPoint.setTo(e,i);var n=this.globalToLocal(this._tempPoint);if(this._geometry){if(this.getBox().contains(n.x,n.y,0)){if(!r)return true;var o=this._geometry.subGeometries;var a=o.length;for(var l=0;l<a;l++)if(o[l].hitTestPoint(n.x,n.y,0))return true}}return false};e.assetType="[asset Mesh]";return e}(l);e.exports=u},{"awayjs-core/lib/geom/Point":undefined,"awayjs-display/lib/base/CurveSubGeometry":"awayjs-display/lib/base/CurveSubGeometry","awayjs-display/lib/base/Geometry":"awayjs-display/lib/base/Geometry","awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/events/GeometryEvent":"awayjs-display/lib/events/GeometryEvent","awayjs-display/lib/pool/SubMeshPool":"awayjs-display/lib/pool/SubMeshPool"}],"awayjs-display/lib/entities/MovieClip":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=t("awayjs-display/lib/containers/DisplayObjectContainer");var o=t("awayjs-display/lib/events/MouseEvent");var a=t("awayjs-display/lib/base/Timeline");var l=t("awayjs-display/lib/managers/FrameScriptManager");var h=function(t){r(e,t);function e(e){var i=this;if(e===void 0){e=null}t.call(this);this._loop=true;this._active_session_ids={};this._potentialInstances={};this._currentFrameIndex=-1;this._constructedKeyFrameIndex=-1;this._isInit=true;this._isPlaying=true;this._isButton=false;this._time=0;this._enterFrame=new s(s.ENTER_FRAME);this.inheritColorTransform=true;this._onMouseOver=function(t){return i.currentFrameIndex=1};this._onMouseOut=function(t){return i.currentFrameIndex=0};this._onMouseDown=function(t){return i.currentFrameIndex=2};this._onMouseUp=function(t){return i.currentFrameIndex=i.currentFrameIndex==0?0:1};this._timeline=e||new a}Object.defineProperty(e.prototype,"adapter",{get:function(){return this._adapter},set:function(t){this._adapter=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isInit",{get:function(){return this._isInit},set:function(t){this._isInit=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"timeline",{get:function(){return this._timeline},set:function(t){this._timeline=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numFrames",{get:function(){return this._timeline.numFrames},enumerable:true,configurable:true});e.prototype.jumpToLabel=function(t){this._timeline.jumpToLabel(this,t)};Object.defineProperty(e.prototype,"currentFrameIndex",{get:function(){return this._currentFrameIndex},set:function(t){if(this._timeline.numFrames){t=Math.floor(t);var e=false;if(t<0)t=0;else if(t>=this._timeline.numFrames){t=this._timeline.numFrames-1;e=true}this._skipAdvance=true;this._timeline.gotoFrame(this,t,e);this._currentFrameIndex=t}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"constructedKeyFrameIndex",{get:function(){return this._constructedKeyFrameIndex},set:function(t){this._constructedKeyFrameIndex=t},enumerable:true,configurable:true});e.prototype.exit_frame=function(){this._skipAdvance=false;var t;for(var i=this.numChildren-1;i>=0;i--){t=this._children[i];if(t.isAsset(e))t.exit_frame()}};e.prototype.reset=function(){t.prototype.reset.call(this);this._time=0;if(this.adapter)this.adapter.freeFromScript();this._isPlaying=true;this._currentFrameIndex=-1;this._constructedKeyFrameIndex=-1;for(var e=this.numChildren-1;e>=0;e--)this.removeChildAt(e);this._skipAdvance=true;if(this._timeline.numFrames){this._currentFrameIndex=0;this._timeline.constructNextFrame(this,true,true)}};e.prototype.set_currentFrameIndex=function(t){this._skipAdvance=true;this._currentFrameIndex=t};e.prototype.addButtonListeners=function(){this._isButton=true;this.stop();this.addEventListener(o.MOUSE_OVER,this._onMouseOver);this.addEventListener(o.MOUSE_OUT,this._onMouseOut);this.addEventListener(o.MOUSE_DOWN,this._onMouseDown);this.addEventListener(o.MOUSE_UP,this._onMouseUp)};e.prototype.removeButtonListeners=function(){this.removeEventListener(o.MOUSE_OVER,this._onMouseOver);this.removeEventListener(o.MOUSE_OUT,this._onMouseOut);this.removeEventListener(o.MOUSE_DOWN,this._onMouseDown);this.removeEventListener(o.MOUSE_UP,this._onMouseUp)};e.prototype.getChildAtSessionID=function(t){return this._active_session_ids[t]};e.prototype.addChildAtDepth=function(e,i,r){if(r===void 0){r=true}e.inheritColorTransform=true;e.reset();t.prototype.addChildAtDepth.call(this,e,i,true);this._active_session_ids[e._sessionID]=e;return e};e.prototype.removeChildAtInternal=function(e){var i=t.prototype.removeChildAtInternal.call(this,e);if(i.adapter)i.adapter.freeFromScript();this.adapter.unregisterScriptObject(i);delete this._active_session_ids[i._sessionID];i._sessionID=-1;return i};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.play=function(){this._isPlaying=true};e.prototype.update=function(){this.advanceFrame();l.execute_queue();this.dispatchEvent(this._enterFrame);l.execute_queue();l.execute_intervals();l.execute_queue();this.exit_frame()};e.prototype.getPotentialChildInstance=function(t){if(!this._potentialInstances[t])this._potentialInstances[t]=this._timeline.getPotentialChildInstance(t);return this._potentialInstances[t]};e.prototype.stop=function(){this._isPlaying=false};e.prototype.clone=function(i){if(i===void 0){i=null}i=t.prototype.clone.call(this,i||new e(this._timeline));i._loop=this._loop;return i};e.prototype.iSetParent=function(e){t.prototype.iSetParent.call(this,e)};e.prototype.advanceFrame=function(t){if(t===void 0){t=false}if(this._timeline.numFrames){var e=this._currentFrameIndex;var i=this._isPlaying&&!this._skipAdvance||e==-1;if(i&&e==this._timeline.numFrames-1&&!this._loop)i=false;if(i&&e==0&&this._timeline.numFrames==1){this._currentFrameIndex=0;i=false}if(i){this._currentFrameIndex++;if(this._currentFrameIndex==this._timeline.numFrames){this.currentFrameIndex=0}else if(e!=this._currentFrameIndex){this._timeline.constructNextFrame(this)}}if(!t)this.advanceChildren()}this._skipAdvance=false};e.prototype.advanceChildren=function(){var t=this.numChildren;var i;for(var r=0;r<t;++r){i=this._children[r];if(i.isAsset(e))i.advanceFrame()}};e.prototype.logHierarchy=function(t){if(t===void 0){t=0}this.printHierarchyName(t,this);var i=this.numChildren;var r;for(var s=0;s<i;s++){r=this._children[s];if(r.isAsset(e))r.logHierarchy(t+1);else this.printHierarchyName(t+1,r)}};e.prototype.printHierarchyName=function(t,e){var i="";for(var r=0;r<t;++r)i+="--";i+=" "+e.name+" = "+e.id;console.log(i)};e.assetType="[asset MovieClip]";return e}(n);e.exports=h},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/base/Timeline":"awayjs-display/lib/base/Timeline","awayjs-display/lib/containers/DisplayObjectContainer":"awayjs-display/lib/containers/DisplayObjectContainer","awayjs-display/lib/events/MouseEvent":"awayjs-display/lib/events/MouseEvent","awayjs-display/lib/managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager"}],"awayjs-display/lib/entities/PointLight":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-core/lib/geom/Matrix3DUtils");var o=t("awayjs-core/lib/geom/Vector3D");var a=t("awayjs-display/lib/base/LightBase");var l=t("awayjs-display/lib/bounds/BoundsType");var h=t("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var u=function(t){r(e,t);function e(){t.call(this);this._pRadius=9e4;this._pFallOff=1e5;this._pIsEntity=true;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius);this._boundsType=l.SPHERE}e.prototype.pCreateShadowMapper=function(){return new h};Object.defineProperty(e.prototype,"radius",{get:function(){return this._pRadius},set:function(t){this._pRadius=t;if(this._pRadius<0){this._pRadius=0}else if(this._pRadius>this._pFallOff){this._pFallOff=this._pRadius;this._pInvalidateBounds()}this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius)},enumerable:true,configurable:true});e.prototype.iFallOffFactor=function(){return this._pFallOffFactor};Object.defineProperty(e.prototype,"fallOff",{get:function(){return this._pFallOff},set:function(t){this._pFallOff=t;if(this._pFallOff<0)this._pFallOff=0;if(this._pFallOff<this._pRadius)this._pRadius=this._pFallOff;this._pFallOffFactor=1/(this._pFallOff*this._pFallOff-this._pRadius*this._pRadius);this._pInvalidateBounds()},enumerable:true,configurable:true});e.prototype._pUpdateSphereBounds=function(){t.prototype._pUpdateSphereBounds.call(this);this._pSphereBounds.radius=this._pFallOff};e.prototype.iGetObjectProjectionMatrix=function(t,e,i){if(i===void 0){i=null}var r=n.RAW_DATA_CONTAINER;var a=new s;a.copyFrom(t.getRenderSceneTransform(e));a.append(this._pParent.inverseSceneTransform);this.lookAt(a.position);a.copyFrom(t.getRenderSceneTransform(e));a.append(this.inverseSceneTransform);var l=t.getBox();var h=a.deltaTransformVector(new o(l.left,l.bottom,l.front));var u=a.deltaTransformVector(new o(l.right,l.top,l.back));var p=h.x*h.x+h.y*h.y+h.z*h.z;var c=u.x*u.x+u.y*u.y+u.z*u.z;var f=Math.sqrt(p>c?p:c);var _;var d;var y=a.rawData[14];_=y-f;d=y+f;r[5]=r[0]=_/f;r[10]=d/(d-_);r[11]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[12]=r[13]=r[15]=0;r[14]=-_*r[10];if(!i)i=new s;i.copyRawDataFrom(r);i.prepend(a);return i};return e}(a);e.exports=u},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/LightBase":"awayjs-display/lib/base/LightBase","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper"}],"awayjs-display/lib/entities/Shape":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/base/DisplayObject");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"graphics",{get:function(){return this._graphics},enumerable:true,configurable:true});e.prototype.clone=function(){var t=new e;t.pivot=this.pivot;t._iMatrix3D=this._iMatrix3D;t.name=name;t.maskMode=this.maskMode;t.masks=this.masks?this.masks.concat():null;t._graphics=this._graphics;return t};return e}(s);e.exports=n},{"awayjs-display/lib/base/DisplayObject":"awayjs-display/lib/base/DisplayObject"}],"awayjs-display/lib/entities/Skybox":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/BlendMode");var n=t("awayjs-display/lib/base/DisplayObject");var o=t("awayjs-display/lib/bounds/BoundsType");var a=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._pAlphaThreshold=0;this._pBlendMode=s.NORMAL;this._renders=new Array;this._renderables=new Array;this._mipmap=false;this._smooth=true;this._pIsEntity=true;this._owners=new Array(this);this.cubeMap=e;this._boundsType=o.NULL}Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold},set:function(t){if(t<0)t=0;else if(t>1)t=1;if(this._pAlphaThreshold==t)return;this._pAlphaThreshold=t;this._pIinvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){if(this._mipmap==t)return;this._mipmap=t;this._pIinvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){if(this._smooth==t)return;this._smooth=t;this._pIinvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){if(this._pBlendMode==t)return;this._pBlendMode=t;this._pInvalidateRender()},enumerable:true,configurable:true});e.prototype._pInvalidateRender=function(){var t=this._renders.length;for(var e=0;e<t;e++)this._renders[e].invalidateRender()};e.prototype._pIinvalidatePasses=function(){var t=this._renders.length;for(var e=0;e<t;e++)this._renders[e].invalidatePasses()};Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uvTransform",{get:function(){return this._uvTransform},set:function(t){this._uvTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"cubeMap",{get:function(){return this._cubeMap},set:function(t){if(t&&this._cubeMap)this._pInvalidateRender();this._cubeMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castsShadows",{get:function(){return false},enumerable:true,configurable:true});e.prototype.dispose=function(){var t;var e;e=this._renders.length;for(t=0;t<e;t++)this._renders[t].dispose();this._renders=new Array;var e=this._renderables.length;for(var t=0;t<e;t++)this._renderables[t].dispose();this._renderables=new Array};e.prototype._applyRenderer=function(t){};e.prototype._iAddRender=function(t){this._renders.push(t);return t};e.prototype._iRemoveRender=function(t){this._renders.splice(this._renders.indexOf(t),1);return t};e.prototype._iAddRenderable=function(t){this._renderables.push(t);return t};e.prototype._iRemoveRenderable=function(t){var e=this._renderables.indexOf(t);this._renderables.splice(e,1);return t};e.assetType="[asset Skybox]";return e}(n);e.exports=a},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-display/lib/base/DisplayObject":"awayjs-display/lib/base/DisplayObject","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType"}],"awayjs-display/lib/entities/TextField":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/AttributesView");var n=t("awayjs-core/lib/attributes/Float2Attributes");var o=t("awayjs-core/lib/geom/ColorTransform");var a=t("awayjs-display/lib/text/TextFieldType");var l=t("awayjs-display/lib/entities/Mesh");var h=t("awayjs-display/lib/base/Geometry");var u=t("awayjs-display/lib/base/CurveSubGeometry");var p=function(t){r(e,t);function e(){t.call(this,new h);this._text="";this.type=a.STATIC}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomScrollV",{get:function(){return this._bottomScrollV},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"caretIndex",{get:function(){return this._caretIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:true,configurable:true});e.prototype.maxScrollH=function(){return this._maxScrollH};e.prototype.maxScrollV=function(){return this._maxScrollV};Object.defineProperty(e.prototype,"numLines",{get:function(){return this._numLines},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionBeginIndex",{get:function(){return this._selectionBeginIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"selectionEndIndex",{get:function(){return this._selectionEndIndex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=t.toString();if(this._text==t)return;this._text=t;this.reConstruct()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textFormat",{get:function(){return this._textFormat},set:function(t){if(this._textFormat==t)return;this._textFormat=t;this.reConstruct()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textColor",{get:function(){return this._textColor},set:function(t){this._textColor=t;if(!this._iColorTransform)this._iColorTransform=new o;this._iColorTransform.color=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textInteractionMode",{get:function(){return this._textInteractionMode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textWidth",{get:function(){return this._textWidth},set:function(t){this._textWidth=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textHeight",{get:function(){return this._textHeight},set:function(t){this._textHeight=t},enumerable:true,configurable:true});e.prototype.reConstruct=function(){if(this._textFormat==null)return;for(var t=this.geometry.subGeometries.length-1;t>=0;t--)this.geometry.removeSubGeometry(this.geometry.subGeometries[t]);if(this._text=="")return;var e=new Array;var i=this._textFormat.size/this._textFormat.font_table.get_font_em_size();var r=this._textFormat.font_table.offset_x;var o=this._textFormat.font_table.offset_y;var a=o;var l=null;var h=0;var p=0;var c=this.text.toString().split("\r");for(var f=0;f<c.length;f++){var _=c[f].split("\n");for(var d=0;d<_.length;d++){var y=0;var b=0;var m=[];var v=[];for(var t=0;t<_[d].length;t++){i=this._textFormat.size/this._textFormat.font_table.get_font_em_size();var g=this._textFormat.font_table.get_subgeo_for_char(_[d].charCodeAt(t).toString());if(g==null){if(this._textFormat.fallback_font_table){i=this._textFormat.size/this._textFormat.fallback_font_table.get_font_em_size();g=this._textFormat.fallback_font_table.get_subgeo_for_char(_[d].charCodeAt(t).toString())}}if(g!=null){var w=g.subgeom;if(w!=null){var j=0;if(l!=null){for(var p=0;p<l.kerningCharCodes.length;p++){if(l.kerningCharCodes[p]==this._text.charCodeAt(t)){j=l.kerningValues[p];break}}}y+=(g.char_width+j)*i+this._textFormat.letterSpacing}else{y+=this._textFormat.font_table.get_whitespace_width()*i}}else{y+=this._textFormat.font_table.get_whitespace_width()*i}v[b]=i;m[b++]=g}var P=r;if(this._textFormat.align=="center"){P=(this._textWidth-y)/2}else if(this._textFormat.align=="right"){P=this._textWidth-y-r}for(var t=0;t<_[d].length;t++){var g=m[t];i=v[t];if(g!=null){var w=g.subgeom;if(w!=null){var x=w.positions.get(w.numVertices);var C=w.curves.get(w.numVertices);for(var O=0;O<w.numVertices;O++){e[h++]=x[O*3]*i+P;e[h++]=x[O*3+1]*i+a;e[h++]=x[O*3+2];e[h++]=C[O*2];e[h++]=C[O*2+1];e[h++]=this._textFormat.uv_values[0];e[h++]=this._textFormat.uv_values[1]}var j=0;if(l!=null){for(var p=0;p<l.kerningCharCodes.length;p++){if(l.kerningCharCodes[p]==this._text.charCodeAt(t)){j=l.kerningValues[p];break}}}P+=(g.char_width+j)*i+this._textFormat.letterSpacing}else{P+=this._textFormat.font_table.get_whitespace_width()*i}}else{P+=this._textFormat.font_table.get_whitespace_width()*i}}a+=this._textFormat.font_table.get_font_em_size()*i}}var D=new s(Float32Array,7);D.set(e);var T=D.buffer;D.dispose();var E=new u(T);E.setUVs(new n(T));this.geometry.addSubGeometry(E);this.subMeshes[0].material=this._textFormat.material};e.prototype.appendText=function(t){this._text+=t};e.prototype.closeParagraph=function(){};e.prototype.getCharBoundaries=function(t){return this._charBoundaries};e.prototype.getCharIndexAtPoint=function(t,e){return this._charIndexAtPoint};e.prototype.getFirstCharInParagraph=function(t){return this._firstCharInParagraph};e.prototype.getImageReference=function(t){return this._imageReference};e.prototype.getLineIndexAtPoint=function(t,e){return this._lineIndexAtPoint};e.prototype.getLineIndexOfChar=function(t){return this._lineIndexOfChar};e.prototype.getLineLength=function(t){return this._lineLength};e.prototype.getLineMetrics=function(t){return this._lineMetrics};e.prototype.getLineOffset=function(t){return this._lineOffset};e.prototype.getLineText=function(t){return this._lineText};e.prototype.getParagraphLength=function(t){return this._paragraphLength};e.prototype.getTextFormat=function(t,e){if(t===void 0){t=-1}if(e===void 0){e=-1}return this._textFormat};e.prototype.replaceSelectedText=function(t){};e.prototype.replaceText=function(t,e,i){};e.prototype.setSelection=function(t,e){};e.prototype.setTextFormat=function(t,e,i){if(e===void 0){e=-1}if(i===void 0){i=-1}};e.isFontCompatible=function(t,e){return false};e.prototype.clone=function(){var t=new e;this._iCopyToTextField(t);return t};e.prototype._iCopyToTextField=function(t){t.geometry=new h;t._iMatrix3D=this._iMatrix3D;t.pivot=this.pivot;t.partition=this.partition;t.boundsType=this.boundsType;t.name=this.name;t.castsShadows=this.castsShadows;t.shareAnimationGeometry=this.shareAnimationGeometry;t.mouseEnabled=this.mouseEnabled;t.mouseChildren=this.mouseChildren;t.extra=this.extra;t.maskMode=this.maskMode;t.masks=this.masks?this.masks.concat():null;var e=this.numChildren;for(var i=0;i<e;++i)t.addChild(this._children[i].clone());t.textWidth=this.textWidth;t.textHeight=this.textHeight;t.textFormat=this._textFormat;t.text=this._text};e.assetType="[asset TextField]";return e}(l);e.exports=p},{"awayjs-core/lib/attributes/AttributesView":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-display/lib/base/CurveSubGeometry":"awayjs-display/lib/base/CurveSubGeometry","awayjs-display/lib/base/Geometry":"awayjs-display/lib/base/Geometry","awayjs-display/lib/entities/Mesh":"awayjs-display/lib/entities/Mesh","awayjs-display/lib/text/TextFieldType":"awayjs-display/lib/text/TextFieldType"}],"awayjs-display/lib/errors/CastError":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/errors/Error");var n=function(t){r(e,t);function e(e){t.call(this,e)}return e}(s);e.exports=n},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-display/lib/events/CameraEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._camera=i}Object.defineProperty(e.prototype,"camera",{get:function(){return this._camera},enumerable:true,configurable:true});e.PROJECTION_CHANGED="projectionChanged";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/DisplayObjectEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this.object=i}e.VISIBLITY_UPDATED="visiblityUpdated";e.SCENETRANSFORM_CHANGED="scenetransformChanged";e.SCENE_CHANGED="sceneChanged";e.POSITION_CHANGED="positionChanged";e.ROTATION_CHANGED="rotationChanged";e.SKEW_CHANGED="skewChanged";e.SCALE_CHANGED="scaleChanged";e.PARTITION_CHANGED="partitionChanged";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/GeometryEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){if(i===void 0){i=null}t.call(this,e);this._subGeometry=i}Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._subGeometry)};e.SUB_GEOMETRY_ADDED="subGeometryAdded";e.SUB_GEOMETRY_REMOVED="subGeometryRemoved";e.BOUNDS_INVALID="boundsInvalid";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/LightEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.clone=function(){return new e(this.type)};e.CASTS_SHADOW_CHANGE="castsShadowChange";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/MaterialEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.SIZE_CHANGED="sizeChanged";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/MouseEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e){t.call(this,e);this._iAllowedToPropagate=true}Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate;this._iAllowedToPropagate=true;return t},enumerable:true,configurable:true});e.prototype.stopPropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopPropagation()};e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopImmediatePropagation()};e.prototype.clone=function(){var t=new e(this.type);t.screenX=this.screenX;t.screenY=this.screenY;t.view=this.view;t.object=this.object;t.renderableOwner=this.renderableOwner;t.material=this.material;t.uv=this.uv;t.localPosition=this.localPosition;t.localNormal=this.localNormal;t.index=this.index;t.subGeometryIndex=this.subGeometryIndex;t.delta=this.delta;t.ctrlKey=this.ctrlKey;t.shiftKey=this.shiftKey;t._iParentEvent=this;t._iAllowedToPropagate=this._iAllowedToPropagate;return t};Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.object.sceneTransform.transformVector(this.localPosition)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.object.sceneTransform.deltaTransformVector(this.localNormal);t.normalize();return t},enumerable:true,configurable:true});e.MOUSE_OVER="mouseOver3d";e.MOUSE_OUT="mouseOut3d";e.MOUSE_UP="mouseUp3d";e.MOUSE_DOWN="mouseDown3d";e.MOUSE_MOVE="mouseMove3d";e.CLICK="click3d";e.DOUBLE_CLICK="doubleClick3d";e.MOUSE_WHEEL="mouseWheel3d";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/RenderableOwnerEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._renderOwner=i}Object.defineProperty(e.prototype,"renderOwner",{get:function(){return this._renderOwner},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._renderOwner)};e.RENDER_OWNER_UPDATED="renderOwnerUpdated";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/RendererEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e){t.call(this,e)}e.VIEWPORT_UPDATED="viewportUpdated";e.SCISSOR_UPDATED="scissorUpdated";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/ResizeEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=NaN}if(r===void 0){r=NaN}t.call(this,e);this._oldHeight=i;this._oldWidth=r}Object.defineProperty(e.prototype,"oldHeight",{get:function(){return this._oldHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"oldWidth",{get:function(){return this._oldWidth},enumerable:true,configurable:true});e.RESIZE="resize";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/SubGeometryEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e,i){t.call(this,e);this._attributesView=i}Object.defineProperty(e.prototype,"attributesView",{get:function(){return this._attributesView},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this.type,this._attributesView)};e.INDICES_UPDATED="indicesUpdated";e.INDICES_DISPOSED="indicesDisposed";e.VERTICES_UPDATED="verticesUpdated";e.VERTICES_DISPOSED="verticesDisposed";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/events/TouchEvent":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=function(t){r(e,t);function e(e){t.call(this,e);this._iAllowedToPropagate=true}Object.defineProperty(e.prototype,"bubbles",{get:function(){var t=this._iAllowedToPropagate;this._iAllowedToPropagate=true;return t},enumerable:true,configurable:true});e.prototype.stopPropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopPropagation()};e.prototype.stopImmediatePropagation=function(){this._iAllowedToPropagate=false;if(this._iParentEvent)this._iParentEvent.stopImmediatePropagation()};e.prototype.clone=function(){var t=new e(this.type);t.screenX=this.screenX;t.screenY=this.screenY;t.view=this.view;t.object=this.object;t.renderableOwner=this.renderableOwner;t.material=this.material;t.uv=this.uv;t.localPosition=this.localPosition;t.localNormal=this.localNormal;t.index=this.index;t.subGeometryIndex=this.subGeometryIndex;t.ctrlKey=this.ctrlKey;t.shiftKey=this.shiftKey;t._iParentEvent=this;return t};Object.defineProperty(e.prototype,"scenePosition",{get:function(){return this.object.sceneTransform.transformVector(this.localPosition)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sceneNormal",{get:function(){var t=this.object.sceneTransform.deltaTransformVector(this.localNormal);t.normalize();return t},enumerable:true,configurable:true});e.TOUCH_END="touchEnd3d";
e.TOUCH_BEGIN="touchBegin3d";e.TOUCH_MOVE="touchMove3d";e.TOUCH_OUT="touchOut3d";e.TOUCH_OVER="touchOver3d";return e}(s);e.exports=n},{"awayjs-core/lib/events/Event":undefined}],"awayjs-display/lib/factories/ITimelineSceneGraphFactory":[function(t,e,i){},{}],"awayjs-display/lib/managers/DefaultMaterialManager":[function(t,e,i){var r=t("awayjs-core/lib/data/BitmapImage2D");var s=t("awayjs-core/lib/data/BitmapImageCube");var n=t("awayjs-display/lib/base/LineSubMesh");var o=t("awayjs-display/lib/entities/Skybox");var a=t("awayjs-display/lib/materials/BasicMaterial");var l=t("awayjs-display/lib/textures/Single2DTexture");var h=t("awayjs-display/lib/textures/SingleCubeTexture");var u=function(){function t(){}t.getDefaultMaterial=function(e){if(e===void 0){e=null}if(e!=null&&e.isAsset(n)){if(!t._defaultColorMaterial)t.createDefaultColorMaterial();return t._defaultColorMaterial}if(e!=null&&e.isAsset(o)){if(!t._defaultCubeTextureMaterial)t.createDefaultCubeTextureMaterial();return t._defaultCubeTextureMaterial}if(!t._defaultTextureMaterial)t.createDefaultTextureMaterial();return t._defaultTextureMaterial};t.getDefaultTexture=function(e){if(e===void 0){e=null}if(e!=null&&e.isAsset(o)){if(!t._defaultCubeTexture)t.createDefaultCubeTexture();return t._defaultCubeTexture}if(!t._defaultTexture)t.createDefaultTexture();return t._defaultTexture};t.createDefaultTexture=function(){if(!t._defaultBitmapImage2D)t.createCheckeredBitmapImage2D();t._defaultTexture=new l(t._defaultBitmapImage2D);t._defaultTexture.name="defaultTexture"};t.createDefaultCubeTexture=function(){if(!t._defaultBitmapImageCube)t.createCheckeredBitmapImageCube();t._defaultCubeTexture=new h(t._defaultBitmapImageCube);t._defaultCubeTexture.name="defaultCubeTexture"};t.createCheckeredBitmapImageCube=function(){if(!t._defaultBitmapImage2D)t.createCheckeredBitmapImage2D();var e=new s(t._defaultBitmapImage2D.width);for(var i=0;i<6;i++)e.draw(i,t._defaultBitmapImage2D);t._defaultBitmapImageCube=e};t.createCheckeredBitmapImage2D=function(){var e=new r(8,8,false,0);var i,s;for(i=0;i<8;i++){for(s=0;s<8;s++){if(s&1^i&1){e.setPixel(i,s,16777215)}}}t._defaultBitmapImage2D=e};t.createDefaultTextureMaterial=function(){if(!t._defaultTexture)t.createDefaultTexture();t._defaultTextureMaterial=new a(t._defaultTexture);t._defaultTextureMaterial.mipmap=false;t._defaultTextureMaterial.smooth=false;t._defaultTextureMaterial.name="defaultTextureMaterial"};t.createDefaultCubeTextureMaterial=function(){if(!t._defaultCubeTexture)t.createDefaultCubeTexture();t._defaultCubeTextureMaterial=new a(t._defaultCubeTexture);t._defaultCubeTextureMaterial.mipmap=false;t._defaultCubeTextureMaterial.smooth=false;t._defaultCubeTextureMaterial.name="defaultCubeTextureMaterial"};t.createDefaultColorMaterial=function(){t._defaultColorMaterial=new a;t._defaultColorMaterial.name="defaultColorMaterial"};return t}();e.exports=u},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-display/lib/base/LineSubMesh":"awayjs-display/lib/base/LineSubMesh","awayjs-display/lib/entities/Skybox":"awayjs-display/lib/entities/Skybox","awayjs-display/lib/materials/BasicMaterial":"awayjs-display/lib/materials/BasicMaterial","awayjs-display/lib/textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-display/lib/textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture"}],"awayjs-display/lib/managers/FrameScriptManager":[function(t,e,i){var r=function(){function t(){}t.setInterval=function(t){this._intervalID++;this._active_intervals[this._intervalID]=t;return this._intervalID};t.clearInterval=function(t){delete this._active_intervals[t]};t.execute_intervals=function(){for(var t in this._active_intervals){this._active_intervals[t].call()}};t.add_script_to_queue=function(t,e){var i=this._queued_mcs_pass2.length;while(i--){this._queued_mcs.push(this._queued_mcs_pass2[i]);this._queued_scripts.push(this._queued_scripts_pass2[i])}this._queued_mcs_pass2=[];this._queued_scripts_pass2=[];this._queued_mcs.push(t);this._queued_scripts.push(e)};t.add_script_to_queue_pass2=function(t,e){this._queued_mcs_pass2.push(t);this._queued_scripts_pass2.push(e)};t.execute_queue=function(){if(this._queued_mcs.length==0&&this._queued_mcs_pass2.length==0)return;var t=this._queued_mcs_pass2.length;while(t--){this._queued_mcs.push(this._queued_mcs_pass2[t]);this._queued_scripts.push(this._queued_scripts_pass2[t])}this._queued_mcs_pass2=[];this._queued_scripts_pass2=[];var e;for(t=0;t<this._queued_mcs.length;t++){e=this._queued_mcs[t];if(e.scene!=null){var i=e.adapter?e.adapter:e;this._queued_scripts[t].call(i)}}this._queued_mcs=[];this._queued_scripts=[]};t._queued_mcs=[];t._queued_scripts=[];t._queued_mcs_pass2=[];t._queued_scripts_pass2=[];t._active_intervals=new Object;t._intervalID=0;return t}();e.exports=r},{}],"awayjs-display/lib/managers/MouseManager":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/events/MouseEvent");var n=t("awayjs-display/lib/managers/FrameScriptManager");var o=function(){function t(){var t=this;this._viewLookup=new Array;this._nullVector=new r;this._queuedEvents=new Array;this._mouseUp=new s(s.MOUSE_UP);this._mouseClick=new s(s.CLICK);this._mouseOut=new s(s.MOUSE_OUT);this._mouseDown=new s(s.MOUSE_DOWN);this._mouseMove=new s(s.MOUSE_MOVE);this._mouseOver=new s(s.MOUSE_OVER);this._mouseWheel=new s(s.MOUSE_WHEEL);this._mouseDoubleClick=new s(s.DOUBLE_CLICK);this.onClickDelegate=function(e){return t.onClick(e)};this.onDoubleClickDelegate=function(e){return t.onDoubleClick(e)};this.onMouseDownDelegate=function(e){return t.onMouseDown(e)};this.onMouseMoveDelegate=function(e){return t.onMouseMove(e)};this.onMouseUpDelegate=function(e){return t.onMouseUp(e)};this.onMouseWheelDelegate=function(e){return t.onMouseWheel(e)};this.onMouseOverDelegate=function(e){return t.onMouseOver(e)};this.onMouseOutDelegate=function(e){return t.onMouseOut(e)}}t.getInstance=function(){if(this._instance)return this._instance;return this._instance=new t};t.prototype.fireMouseEvents=function(t){if(this._iCollidingObject!=this._previousCollidingObject){if(this._previousCollidingObject)this.queueDispatch(this._mouseOut,this._mouseMoveEvent,this._previousCollidingObject);if(this._iCollidingObject)this.queueDispatch(this._mouseOver,this._mouseMoveEvent)}if(t&&this._iCollidingObject)this.queueDispatch(this._mouseMove,this._mouseMoveEvent);var e;var i;var r=this._queuedEvents.length;for(var s=0;s<r;++s){e=this._queuedEvents[s];i=e.object;while(i){if(i._iIsMouseEnabled())i.dispatchEvent(e);i=i.parent}n.execute_queue()}this._queuedEvents.length=0;this._previousCollidingObject=this._iCollidingObject;this._iUpdateDirty=false};t.prototype.registerView=function(t){t.htmlElement.addEventListener("click",this.onClickDelegate);t.htmlElement.addEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.addEventListener("touchstart",this.onMouseDownDelegate);t.htmlElement.addEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.addEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.addEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.addEventListener("touchend",this.onMouseUpDelegate);t.htmlElement.addEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.addEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.addEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.push(t)};t.prototype.unregisterView=function(t){t.htmlElement.removeEventListener("click",this.onClickDelegate);t.htmlElement.removeEventListener("dblclick",this.onDoubleClickDelegate);t.htmlElement.removeEventListener("touchstart",this.onMouseDownDelegate);t.htmlElement.removeEventListener("mousedown",this.onMouseDownDelegate);t.htmlElement.removeEventListener("mousemove",this.onMouseMoveDelegate);t.htmlElement.removeEventListener("touchend",this.onMouseUpDelegate);t.htmlElement.removeEventListener("mouseup",this.onMouseUpDelegate);t.htmlElement.removeEventListener("mousewheel",this.onMouseWheelDelegate);t.htmlElement.removeEventListener("mouseover",this.onMouseOverDelegate);t.htmlElement.removeEventListener("mouseout",this.onMouseOutDelegate);this._viewLookup.slice(this._viewLookup.indexOf(t),1)};t.prototype.queueDispatch=function(t,e,i){if(i===void 0){i=null}if(e){t.ctrlKey=e.ctrlKey;t.altKey=e.altKey;t.shiftKey=e.shiftKey;t.screenX=e.clientX;t.screenY=e.clientY}if(i==null)i=this._iCollidingObject;if(i){t.object=i.displayObject;t.renderableOwner=i.renderableOwner;t.uv=i.uv;t.localPosition=i.localPosition?i.localPosition.clone():null;t.localNormal=i.localNormal?i.localNormal.clone():null;t.index=i.index}else{t.uv=null;t.object=null;t.localPosition=this._nullVector;t.localNormal=this._nullVector;t.index=0;t.subGeometryIndex=0}this._queuedEvents.push(t)};t.prototype.onMouseMove=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseMove,this._mouseMoveEvent=t)};t.prototype.onMouseOut=function(t){this._iActiveDiv=null;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseOut,t)};t.prototype.onMouseOver=function(t){this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseOver,t)};t.prototype.onClick=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseClick,t)};t.prototype.onDoubleClick=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseDoubleClick,t)};t.prototype.onMouseDown=function(t){t.preventDefault();this._iActiveDiv=t.target;this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseDown,t)};t.prototype.onMouseUp=function(t){t.preventDefault();this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseUp,t)};t.prototype.onMouseWheel=function(t){this.updateColliders(t);if(this._iCollidingObject)this.queueDispatch(this._mouseWheel,t)};t.prototype.updateColliders=function(t){if(this._iUpdateDirty)return;var e;var i;var r=t.clientX!=null?t.clientX:t.changedTouches[0].clientX;var s=t.clientY!=null?t.clientY:t.changedTouches[0].clientY;var n=this._viewLookup.length;for(var o=0;o<n;o++){e=this._viewLookup[o];i=e.htmlElement.getBoundingClientRect();if(r<i.left||r>i.right||s<i.top||s>i.bottom){e._pMouseX=null;e._pMouseY=null}else{e._pMouseX=r+i.left;e._pMouseY=s+i.top;e.updateCollider();if(e.layeredView&&this._iCollidingObject)break}}this._iUpdateDirty=true};return t}();e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/events/MouseEvent":"awayjs-display/lib/events/MouseEvent","awayjs-display/lib/managers/FrameScriptManager":"awayjs-display/lib/managers/FrameScriptManager"}],"awayjs-display/lib/managers/TouchManager":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/events/TouchEvent");var n=function(){function t(){var e=this;this._updateDirty=true;this._nullVector=new r;this._queuedEvents=new Array;this._touchOut=new s(s.TOUCH_OUT);this._touchBegin=new s(s.TOUCH_BEGIN);this._touchMove=new s(s.TOUCH_MOVE);this._touchEnd=new s(s.TOUCH_END);this._touchOver=new s(s.TOUCH_OVER);this._touchPoints=new Array;this._touchPointFromId=new Object;t._iCollidingObjectFromTouchId=new Object;t._previousCollidingObjectFromTouchId=new Object;this.onTouchBeginDelegate=function(t){return e.onTouchBegin(t)};this.onTouchMoveDelegate=function(t){return e.onTouchMove(t)};this.onTouchEndDelegate=function(t){return e.onTouchEnd(t)}}t.getInstance=function(){if(this._instance)return this._instance;return this._instance=new t};t.prototype.updateCollider=function(t){};t.prototype.fireTouchEvents=function(e){var i;for(i=0;i<this._numTouchPoints;++i){this._touchPoint=this._touchPoints[i];this._iCollidingObject=t._iCollidingObjectFromTouchId[this._touchPoint.id];this._previousCollidingObject=t._previousCollidingObjectFromTouchId[this._touchPoint.id];if(this._iCollidingObject!=this._previousCollidingObject){if(this._previousCollidingObject)this.queueDispatch(this._touchOut,this._touchMoveEvent,this._previousCollidingObject,this._touchPoint);if(this._iCollidingObject)this.queueDispatch(this._touchOver,this._touchMoveEvent,this._iCollidingObject,this._touchPoint)}if(e&&this._iCollidingObject)this.queueDispatch(this._touchMove,this._touchMoveEvent,this._iCollidingObject,this._touchPoint)}var r;var s;var n=this._queuedEvents.length;for(i=0;i<n;++i){r=this._queuedEvents[i];s=r.object;while(s&&!s._iIsMouseEnabled())s=s.parent;if(s)s.dispatchEvent(r)}this._queuedEvents.length=0;this._updateDirty=false;for(i=0;i<this._numTouchPoints;++i){this._touchPoint=this._touchPoints[i];t._previousCollidingObjectFromTouchId[this._touchPoint.id]=t._iCollidingObjectFromTouchId[this._touchPoint.id]}};t.prototype.registerView=function(t){t.htmlElement.addEventListener("touchstart",this.onTouchBeginDelegate);t.htmlElement.addEventListener("touchmove",this.onTouchMoveDelegate);t.htmlElement.addEventListener("touchend",this.onTouchEndDelegate)};t.prototype.unregisterView=function(t){t.htmlElement.removeEventListener("touchstart",this.onTouchBeginDelegate);t.htmlElement.removeEventListener("touchmove",this.onTouchMoveDelegate);t.htmlElement.removeEventListener("touchend",this.onTouchEndDelegate)};t.prototype.queueDispatch=function(t,e,i,r){t.ctrlKey=e.ctrlKey;t.altKey=e.altKey;t.shiftKey=e.shiftKey;t.screenX=r.x;t.screenY=r.y;t.touchPointID=r.id;if(i){t.object=i.displayObject;t.renderableOwner=i.renderableOwner;t.uv=i.uv;t.localPosition=i.localPosition?i.localPosition.clone():null;t.localNormal=i.localNormal?i.localNormal.clone():null;t.index=i.index;t.subGeometryIndex=i.index}else{t.uv=null;t.object=null;t.localPosition=this._nullVector;t.localNormal=this._nullVector;t.index=0;t.subGeometryIndex=0}this._queuedEvents.push(t)};t.prototype.onTouchBegin=function(e){var i=new o;this._numTouchPoints++;this._touchPoints.push(i);this._touchPointFromId[i.id]=i;this._iCollidingObject=t._iCollidingObjectFromTouchId[i.id];if(this._iCollidingObject)this.queueDispatch(this._touchBegin,e,this._iCollidingObject,i);this._updateDirty=true};t.prototype.onTouchMove=function(t){};t.prototype.onTouchEnd=function(t){};return t}();var o=function(){function t(){}return t}();e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/events/TouchEvent":"awayjs-display/lib/events/TouchEvent"}],"awayjs-display/lib/materials/BasicMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/Image2D");var n=t("awayjs-display/lib/materials/MaterialBase");var o=t("awayjs-display/lib/textures/Single2DTexture");var a=t("awayjs-display/lib/textures/TextureBase");var l=function(t){r(e,t);function e(e,i,r,n){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=false}if(n===void 0){n=false}t.call(this);this._preserveAlpha=false;if(e instanceof s)e=new o(e);if(e instanceof a){this.texture=e;this.smooth=i==null?true:false;this.repeat=r;this.mipmap=n}else{this.color=e?Number(e):13421772;this.alpha=i==null?1:Number(i)}}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(t){if(this._preserveAlpha==t)return;this._preserveAlpha=t;this._pInvalidateRender()},enumerable:true,configurable:true});e.assetType="[materials BasicMaterial]";return e}(n);e.exports=l},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-display/lib/materials/MaterialBase":"awayjs-display/lib/materials/MaterialBase","awayjs-display/lib/textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture","awayjs-display/lib/textures/TextureBase":"awayjs-display/lib/textures/TextureBase"}],"awayjs-display/lib/materials/LightSources":[function(t,e,i){var r=function(){function t(){}t.LIGHTS=1;t.PROBES=2;t.ALL=3;return t}();e.exports=r},{}],"awayjs-display/lib/materials/MaterialBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/BlendMode");var n=t("awayjs-core/lib/geom/ColorTransform");var o=t("awayjs-core/lib/events/Event");var a=t("awayjs-core/lib/library/AssetBase");var l=t("awayjs-display/lib/events/MaterialEvent");var h=t("awayjs-display/lib/events/RenderableOwnerEvent");var u=t("awayjs-display/lib/textures/Single2DTexture");var p=function(t){r(e,t);function e(){var e=this;t.call(this);this._pUseColorTransform=false;this._alphaBlending=false;this._alpha=1;this._renders=new Array;this._pAlphaThreshold=0;this._pAnimateUVs=false;this._enableLightFallOff=true;this._specularLightSources=1;this._diffuseLightSources=3;this._iMaterialId=0;this._iBaseScreenPassIndex=0;this._bothSides=false;this._pBlendMode=s.NORMAL;this._mipmap=true;this._smooth=true;this._repeat=false;this._color=16777215;this._pHeight=1;this._pWidth=1;this._iMaterialId=Number(this.id);this._owners=new Array;this._onLightChangeDelegate=function(t){return e.onLightsChange(t)};this.alphaPremultiplied=false}Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(t>1)t=1;else if(t<0)t=0;if(this._alpha==t)return;this._alpha=t;if(this._colorTransform==null)this._colorTransform=new n;this._colorTransform.alphaMultiplier=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaBlending",{get:function(){return this._alphaBlending},set:function(t){if(this._alphaBlending==t)return;this._alphaBlending=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"frameRect",{get:function(){return this._frameRect},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._pHeight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animationSet",{get:function(){return this._animationSet},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._pLightPicker},set:function(t){if(this._pLightPicker==t)return;if(this._pLightPicker)this._pLightPicker.removeEventListener(o.CHANGE,this._onLightChangeDelegate);this._pLightPicker=t;if(this._pLightPicker)this._pLightPicker.addEventListener(o.CHANGE,this._onLightChangeDelegate);this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){if(this._mipmap==t)return;this._mipmap=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smooth",{get:function(){return this._smooth},set:function(t){if(this._smooth==t)return;this._smooth=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"repeat",{get:function(){return this._repeat},set:function(t){if(this._repeat==t)return;this._repeat=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){if(this._color==t)return;this._color=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._pTexture},set:function(t){if(this._pTexture==t)return;this._pTexture=t;this._pInvalidatePasses();if(this._pTexture.isAsset(u)){var e=this._pTexture;this._frameRect=e.sampler2D.frameRect;this._pHeight=e.sampler2D.rect.height;this._pWidth=e.sampler2D.rect.width}else{this._frameRect=null;this._pHeight=1;this._pWidth=1}this._pNotifySizeChanged()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animateUVs",{get:function(){return this._pAnimateUVs},set:function(t){if(this._pAnimateUVs==t)return;this._pAnimateUVs=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useColorTransform",{get:function(){return this._pUseColorTransform},set:function(t){if(this._pUseColorTransform==t)return;this._pUseColorTransform=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._enableLightFallOff},set:function(t){if(this._enableLightFallOff==t)return;this._enableLightFallOff=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._diffuseLightSources},set:function(t){if(this._diffuseLightSources==t)return;this._diffuseLightSources=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._specularLightSources},set:function(t){if(this._specularLightSources==t)return;this._specularLightSources=t;this._pInvalidatePasses()},enumerable:true,configurable:true});e.prototype.dispose=function(){var t;var e;e=this._renders.length;for(t=0;t<e;t++)this._renders[t].dispose();this._renders=new Array};Object.defineProperty(e.prototype,"bothSides",{get:function(){return this._bothSides},set:function(t){if(this._bothSides=t)return;this._bothSides=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._pBlendMode},set:function(t){if(this._pBlendMode==t)return;this._pBlendMode=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaPremultiplied",{get:function(){return this._alphaPremultiplied},set:function(t){if(this._alphaPremultiplied==t)return;this._alphaPremultiplied=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alphaThreshold",{get:function(){return this._pAlphaThreshold},set:function(t){if(t<0)t=0;else if(t>1)t=1;if(this._pAlphaThreshold==t)return;this._pAlphaThreshold=t;this._pInvalidatePasses()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._pWidth},enumerable:true,configurable:true});e.prototype.iAddOwner=function(t){this._owners.push(t);var e;var i=t.animator;if(i)e=i.animationSet;if(t.animator){if(this._animationSet&&e!=this._animationSet){throw new Error("A Material instance cannot be shared across material owners with different animation sets")}else{if(this._animationSet!=e){this._animationSet=e;this.invalidateAnimation()}}}t.dispatchEvent(new h(h.RENDER_OWNER_UPDATED,this))};e.prototype.iRemoveOwner=function(t){this._owners.splice(this._owners.indexOf(t),1);if(this._owners.length==0){this._animationSet=null;this.invalidateAnimation()}t.dispatchEvent(new h(h.RENDER_OWNER_UPDATED,this))};Object.defineProperty(e.prototype,"iOwners",{get:function(){return this._owners},enumerable:true,configurable:true});e.prototype._pInvalidatePasses=function(){var t=this._renders.length;for(var e=0;e<t;e++)this._renders[e].invalidatePasses()};e.prototype.invalidateAnimation=function(){var t=this._renders.length;for(var e=0;e<t;e++)this._renders[e].invalidateAnimation()};e.prototype._pInvalidateRender=function(){var t=this._renders.length;for(var e=0;e<t;e++)this._renders[e].invalidateRender()};e.prototype.onLightsChange=function(t){this._pInvalidateRender()};e.prototype._pNotifySizeChanged=function(){if(!this._sizeChanged)this._sizeChanged=new l(l.SIZE_CHANGED);this.dispatchEvent(this._sizeChanged)};e.prototype._iAddRender=function(t){this._renders.push(t);return t};e.prototype._iRemoveRender=function(t){this._renders.splice(this._renders.indexOf(t),1);return t};return e}(a);e.exports=p},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/events/MaterialEvent":"awayjs-display/lib/events/MaterialEvent","awayjs-display/lib/events/RenderableOwnerEvent":"awayjs-display/lib/events/RenderableOwnerEvent","awayjs-display/lib/textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture"}],"awayjs-display/lib/materials/lightpickers/LightPickerBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._pNumPointLights=0;this._pNumDirectionalLights=0;this._pNumCastingPointLights=0;this._pNumCastingDirectionalLights=0;this._pNumLightProbes=0}e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numDirectionalLights",{get:function(){return this._pNumDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numPointLights",{get:function(){return this._pNumPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingDirectionalLights",{get:function(){return this._pNumCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numCastingPointLights",{get:function(){return this._pNumCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numLightProbes",{get:function(){return this._pNumLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._pDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingPointLights",{get:function(){return this._pCastingPointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingDirectionalLights",{get:function(){return this._pCastingDirectionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._pLightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbeWeights",{get:function(){return this._pLightProbeWeights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"allPickedLights",{get:function(){return this._pAllPickedLights},enumerable:true,configurable:true});e.prototype.collectLights=function(t){this.updateProbeWeights(t)};e.prototype.updateProbeWeights=function(t){var e=t.sourceEntity.scenePosition;var i;var r=e.x,s=e.y,n=e.z;var o,a,l;var h,u=0;var p;for(p=0;p<this._pNumLightProbes;++p){i=this._pLightProbes[p].scenePosition;o=r-i.x;a=s-i.y;l=n-i.z;h=o*o+a*a+l*l;h=h>1e-5?1/h:5e7;this._pLightProbeWeights[p]=h;u+=h}u=1/u;for(p=0;p<this._pNumLightProbes;++p)this._pLightProbeWeights[p]*=u};e.assetType="[asset LightPicker]";return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/materials/lightpickers/StaticLightPicker":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/events/Event");var n=t("awayjs-display/lib/entities/DirectionalLight");var o=t("awayjs-display/lib/entities/LightProbe");var a=t("awayjs-display/lib/entities/PointLight");var l=t("awayjs-display/lib/events/LightEvent");var h=t("awayjs-display/lib/materials/lightpickers/LightPickerBase");var u=function(t){r(e,t);function e(e){var i=this;t.call(this);this._onCastShadowChangeDelegate=function(t){return i.onCastShadowChange(t)};this.lights=e}Object.defineProperty(e.prototype,"lights",{get:function(){return this._lights},set:function(t){var e=0;var i=0;var r=0;var h=0;var u=0;var p;if(this._lights)this.clearListeners();this._lights=t;this._pAllPickedLights=t;this._pPointLights=new Array;this._pCastingPointLights=new Array;this._pDirectionalLights=new Array;this._pCastingDirectionalLights=new Array;this._pLightProbes=new Array;var c=t.length;for(var f=0;f<c;++f){p=t[f];p.addEventListener(l.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate);if(p instanceof a){if(p.castsShadows)this._pCastingPointLights[r++]=p;else this._pPointLights[e++]=p}else if(p instanceof n){if(p.castsShadows)this._pCastingDirectionalLights[h++]=p;else this._pDirectionalLights[i++]=p}else if(p instanceof o){this._pLightProbes[u++]=p}}if(this._pNumDirectionalLights==i&&this._pNumPointLights==e&&this._pNumLightProbes==u&&this._pNumCastingPointLights==r&&this._pNumCastingDirectionalLights==h)return;this._pNumDirectionalLights=i;this._pNumCastingDirectionalLights=h;this._pNumPointLights=e;this._pNumCastingPointLights=r;this._pNumLightProbes=u;this._pLightProbeWeights=new Array(Math.ceil(u/4)*4);this.dispatchEvent(new s(s.CHANGE))},enumerable:true,configurable:true});e.prototype.clearListeners=function(){var t=this._lights.length;for(var e=0;e<t;++e)this._lights[e].removeEventListener(l.CASTS_SHADOW_CHANGE,this._onCastShadowChangeDelegate)};e.prototype.onCastShadowChange=function(t){var e=t.target;if(e instanceof a)this.updatePointCasting(e);else if(e instanceof n)this.updateDirectionalCasting(e);this.dispatchEvent(new s(s.CHANGE))};e.prototype.updateDirectionalCasting=function(t){var e=t;if(t.castsShadows){--this._pNumDirectionalLights;++this._pNumCastingDirectionalLights;this._pDirectionalLights.splice(this._pDirectionalLights.indexOf(e),1);this._pCastingDirectionalLights.push(t)}else{++this._pNumDirectionalLights;--this._pNumCastingDirectionalLights;this._pCastingDirectionalLights.splice(this._pCastingDirectionalLights.indexOf(e),1);this._pDirectionalLights.push(t)}};e.prototype.updatePointCasting=function(t){var e=t;if(t.castsShadows){--this._pNumPointLights;++this._pNumCastingPointLights;this._pPointLights.splice(this._pPointLights.indexOf(e),1);this._pCastingPointLights.push(t)}else{++this._pNumPointLights;--this._pNumCastingPointLights;this._pCastingPointLights.splice(this._pCastingPointLights.indexOf(e),1);this._pPointLights.push(t)}};return e}(h);e.exports=u},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/entities/DirectionalLight":"awayjs-display/lib/entities/DirectionalLight","awayjs-display/lib/entities/LightProbe":"awayjs-display/lib/entities/LightProbe","awayjs-display/lib/entities/PointLight":"awayjs-display/lib/entities/PointLight","awayjs-display/lib/events/LightEvent":"awayjs-display/lib/events/LightEvent","awayjs-display/lib/materials/lightpickers/LightPickerBase":"awayjs-display/lib/materials/lightpickers/LightPickerBase"}],"awayjs-display/lib/materials/shadowmappers/CascadeShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Matrix3DUtils");var n=t("awayjs-core/lib/geom/Rectangle");var o=t("awayjs-core/lib/events/Event");var a=t("awayjs-core/lib/events/EventDispatcher");var l=t("awayjs-core/lib/projections/FreeMatrixProjection");var h=t("awayjs-display/lib/entities/Camera");var u=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var p=function(t){r(e,t);function e(e){if(e===void 0){e=3}t.call(this);this._pScissorRectsInvalid=true;if(e<1||e>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=e;this._changeDispatcher=new a(this);this.init()}e.prototype.getSplitRatio=function(t){return this._splitRatios[t]};e.prototype.setSplitRatio=function(t,e){if(e<0)e=0;else if(e>1)e=1;if(t>=this._numCascades)throw new Error("index must be smaller than the number of cascades!");
this._splitRatios[t]=e};e.prototype.getDepthProjections=function(t){return this._depthCameras[t].viewProjection};e.prototype.init=function(){this._splitRatios=new Array(this._numCascades);this._nearPlaneDistances=new Array(this._numCascades);var t=1;for(var e=this._numCascades-1;e>=0;--e){this._splitRatios[e]=t;t*=.4}this._texOffsetsX=Array(-1,1,-1,1);this._texOffsetsY=Array(1,1,-1,-1);this._pScissorRects=new Array(4);this._depthLenses=new Array;this._depthCameras=new Array;for(e=0;e<this._numCascades;++e){this._depthLenses[e]=new l;this._depthCameras[e]=new h(this._depthLenses[e])}};e.prototype._pSetDepthMapSize=function(e){t.prototype._pSetDepthMapSize.call(this,e);this.invalidateScissorRects()};e.prototype.invalidateScissorRects=function(){this._pScissorRectsInvalid=true};Object.defineProperty(e.prototype,"numCascades",{get:function(){return this._numCascades},set:function(t){if(t==this._numCascades)return;if(t<1||t>4)throw new Error("numCascades must be an integer between 1 and 4");this._numCascades=t;this.invalidateScissorRects();this.init();this.dispatchEvent(new o(o.CHANGE))},enumerable:true,configurable:true});e.prototype.pDrawDepthMap=function(t,e,i){if(this._pScissorRectsInvalid)this.updateScissorRects();this._pCasterCollector.cullPlanes=this._pCullPlanes;this._pCasterCollector.camera=this._pOverallDepthCamera;this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRenderCascades(this._pCasterCollector,t.sampler2D.image2D,this._numCascades,this._pScissorRects,this._depthCameras)};e.prototype.updateScissorRects=function(){var t=this._pDepthMapSize*.5;this._pScissorRects[0]=new n(0,0,t,t);this._pScissorRects[1]=new n(t,0,t,t);this._pScissorRects[2]=new n(0,t,t,t);this._pScissorRects[3]=new n(t,t,t,t);this._pScissorRectsInvalid=false};e.prototype.pUpdateDepthProjection=function(t){var e;var i=t.projection;var r=i.near;var s=i.far-r;this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pMatrix.appendScale(.96,.96,1);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t);for(var n=0;n<this._numCascades;++n){e=this._depthLenses[n].matrix;this._nearPlaneDistances[n]=r+this._splitRatios[n]*s;this._depthCameras[n].transform.matrix3D=this._pOverallDepthCamera.transform.matrix3D;this.updateProjectionPartition(e,this._splitRatios[n],this._texOffsetsX[n],this._texOffsetsY[n]);this._depthLenses[n].matrix=e}};e.prototype.updateProjectionPartition=function(t,e,i,r){var n=s.RAW_DATA_CONTAINER;var o,a,l;var h,u,p;var c=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,_;var d=Number.NEGATIVE_INFINITY,y=Number.NEGATIVE_INFINITY,b=Number.NEGATIVE_INFINITY;var m=0;while(m<12){o=this._pLocalFrustum[m];a=this._pLocalFrustum[m+1];l=this._pLocalFrustum[m+2];h=o+(this._pLocalFrustum[m+12]-o)*e;u=a+(this._pLocalFrustum[m+13]-a)*e;p=l+(this._pLocalFrustum[m+14]-l)*e;if(o<c)c=o;if(o>d)d=o;if(a<f)f=a;if(a>y)y=a;if(l>b)b=l;if(h<c)c=h;if(h>d)d=h;if(u<f)f=u;if(u>y)y=u;if(p>b)b=p;m+=3}_=1;var v=d-c;var g=y-f;var w=1/(b-_);if(c<0)c-=this._pSnap;if(f<0)f-=this._pSnap;c=Math.floor(c/this._pSnap)*this._pSnap;f=Math.floor(f/this._pSnap)*this._pSnap;var j=2*this._pSnap;v=Math.floor(v/j+1)*j;g=Math.floor(g/j+1)*j;d=c+v;y=f+g;v=1/v;g=1/g;n[0]=2*v;n[5]=2*g;n[10]=w;n[12]=-(d+c)*v;n[13]=-(y+f)*g;n[14]=-_*w;n[15]=1;n[1]=n[2]=n[3]=n[4]=n[6]=n[7]=n[8]=n[9]=n[11]=0;t.copyRawDataFrom(n);t.appendScale(.96,.96,1);t.appendTranslation(i,r,0);t.appendScale(.5,.5,1)};e.prototype.addEventListener=function(t,e){this._changeDispatcher.addEventListener(t,e)};e.prototype.removeEventListener=function(t,e){this._changeDispatcher.removeEventListener(t,e)};e.prototype.dispatchEvent=function(t){return this._changeDispatcher.dispatchEvent(t)};e.prototype.hasEventListener=function(t){return this._changeDispatcher.hasEventListener(t)};Object.defineProperty(e.prototype,"_iNearPlaneDistances",{get:function(){return this._nearPlaneDistances},enumerable:true,configurable:true});return e}(u);e.exports=p},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined,"awayjs-display/lib/entities/Camera":"awayjs-display/lib/entities/Camera","awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper"}],"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/ImageCube");var n=t("awayjs-display/lib/entities/Camera");var o=t("awayjs-display/lib/materials/shadowmappers/ShadowMapperBase");var a=t("awayjs-display/lib/textures/SingleCubeTexture");var l=function(t){r(e,t);function e(){t.call(this);this._pDepthMapSize=512;this._needsRender=new Array;this.initCameras()}e.prototype.initCameras=function(){this._depthCameras=new Array;this._projections=new Array;this.addCamera(0,90,0);this.addCamera(0,-90,0);this.addCamera(-90,0,0);this.addCamera(90,0,0);this.addCamera(0,0,0);this.addCamera(0,180,0)};e.prototype.addCamera=function(t,e,i){var r=new n;r.rotationX=t;r.rotationY=e;r.rotationZ=i;r.projection.near=.01;var s=r.projection;s.fieldOfView=90;this._projections.push(s);r.projection._iAspectRatio=1;this._depthCameras.push(r)};e.prototype.pCreateDepthTexture=function(){return new a(new s(this._pDepthMapSize))};e.prototype.pUpdateDepthProjection=function(t){var e=this._pLight;var i=e._pFallOff;var r=this._pLight.scenePosition;for(var s=0;s<6;++s){this._projections[s].far=i;this._depthCameras[s].transform.position=r;this._needsRender[s]=true}};e.prototype.pDrawDepthMap=function(t,e,i){for(var r=0;r<6;++r){if(this._needsRender[r]){this._pCasterCollector.camera=this._depthCameras[r];this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRender(this._pCasterCollector,t.samplerCube.imageCube,null,r)}}};return e}(o);e.exports=l},{"awayjs-core/lib/data/ImageCube":undefined,"awayjs-display/lib/entities/Camera":"awayjs-display/lib/entities/Camera","awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase","awayjs-display/lib/textures/SingleCubeTexture":"awayjs-display/lib/textures/SingleCubeTexture"}],"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/Image2D");var n=t("awayjs-core/lib/geom/Matrix3D");var o=t("awayjs-core/lib/geom/Matrix3DUtils");var a=t("awayjs-core/lib/projections/FreeMatrixProjection");var l=t("awayjs-display/lib/entities/Camera");var h=t("awayjs-display/lib/materials/shadowmappers/ShadowMapperBase");var u=t("awayjs-display/lib/textures/Single2DTexture");var p=function(t){r(e,t);function e(){t.call(this);this._pLightOffset=1e4;this._pSnap=64;this._pCullPlanes=[];this._pOverallDepthProjection=new a;this._pOverallDepthCamera=new l(this._pOverallDepthProjection);this._pLocalFrustum=[];this._pMatrix=new n}Object.defineProperty(e.prototype,"snap",{get:function(){return this._pSnap},set:function(t){this._pSnap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightOffset",{get:function(){return this._pLightOffset},set:function(t){this._pLightOffset=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"iDepthProjection",{get:function(){return this._pOverallDepthCamera.viewProjection},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._pMaxZ-this._pMinZ},enumerable:true,configurable:true});e.prototype.iSetDepthMap=function(e){if(this._depthMap==e)return;t.prototype.iSetDepthMap.call(this,e);if(this._depthMap){this._explicitDepthMap=true;this._pDepthMapSize=e.width}else{this._explicitDepthMap=false}};e.prototype.pCreateDepthTexture=function(){return new u(new s(this._pDepthMapSize,this._pDepthMapSize))};e.prototype.pDrawDepthMap=function(t,e,i){this._pCasterCollector.camera=this._pOverallDepthCamera;this._pCasterCollector.cullPlanes=this._pCullPlanes;this._pCasterCollector.clear();e.traversePartitions(this._pCasterCollector);i._iRender(this._pCasterCollector,t.sampler2D.image2D)};e.prototype.pUpdateCullPlanes=function(t){var e=this._pOverallDepthCamera.frustumPlanes;var i=t.frustumPlanes;this._pCullPlanes.length=4;this._pCullPlanes[0]=e[0];this._pCullPlanes[1]=e[1];this._pCullPlanes[2]=e[2];this._pCullPlanes[3]=e[3];var r=this._pLight;var s=r.sceneDirection;var n=s.x;var o=s.y;var a=s.z;var l=4;for(var h=0;h<6;++h){var u=i[h];if(u.a*n+u.b*o+u.c*a<0)this._pCullPlanes[l++]=u}};e.prototype.pUpdateDepthProjection=function(t){this.pUpdateProjectionFromFrustumCorners(t,t.projection.frustumCorners,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix;this.pUpdateCullPlanes(t)};e.prototype.pUpdateProjectionFromFrustumCorners=function(t,e,i){var r=o.RAW_DATA_CONTAINER;var s;var n,a,l;var h,u;var p,c;var f;var _=this._pLight;s=_.sceneDirection;this._pOverallDepthCamera.transform.matrix3D=this._pLight.sceneTransform;n=Math.floor((t.x-s.x*this._pLightOffset)/this._pSnap)*this._pSnap;a=Math.floor((t.y-s.y*this._pLightOffset)/this._pSnap)*this._pSnap;l=Math.floor((t.z-s.z*this._pLightOffset)/this._pSnap)*this._pSnap;this._pOverallDepthCamera.x=n;this._pOverallDepthCamera.y=a;this._pOverallDepthCamera.z=l;this._pMatrix.copyFrom(this._pOverallDepthCamera.inverseSceneTransform);this._pMatrix.prepend(t.sceneTransform);this._pMatrix.transformVectors(e,this._pLocalFrustum);h=p=this._pLocalFrustum[0];u=c=this._pLocalFrustum[1];this._pMaxZ=this._pLocalFrustum[2];f=3;while(f<24){n=this._pLocalFrustum[f];a=this._pLocalFrustum[f+1];l=this._pLocalFrustum[f+2];if(n<h)h=n;if(n>p)p=n;if(a<u)u=a;if(a>c)c=a;if(l>this._pMaxZ)this._pMaxZ=l;f+=3}this._pMinZ=1;var d=p-h;var y=c-u;var b=1/(this._pMaxZ-this._pMinZ);if(h<0)h-=this._pSnap;if(u<0)u-=this._pSnap;h=Math.floor(h/this._pSnap)*this._pSnap;u=Math.floor(u/this._pSnap)*this._pSnap;var m=2*this._pSnap;d=Math.floor(d/m+2)*m;y=Math.floor(y/m+2)*m;p=h+d;c=u+y;d=1/d;y=1/y;r[0]=2*d;r[5]=2*y;r[10]=b;r[12]=-(p+h)*d;r[13]=-(c+u)*y;r[14]=-this._pMinZ*b;r[15]=1;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[8]=r[9]=r[11]=0;i.copyRawDataFrom(r)};return e}(h);e.exports=p},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/projections/FreeMatrixProjection":undefined,"awayjs-display/lib/entities/Camera":"awayjs-display/lib/entities/Camera","awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase","awayjs-display/lib/textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture"}],"awayjs-display/lib/materials/shadowmappers/NearDirectionalShadowMapper":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var n=function(t){r(e,t);function e(e){if(e===void 0){e=.5}t.call(this);this.coverageRatio=e}Object.defineProperty(e.prototype,"coverageRatio",{get:function(){return this._coverageRatio},set:function(t){if(t>1)t=1;else if(t<0)t=0;this._coverageRatio=t},enumerable:true,configurable:true});e.prototype.pUpdateDepthProjection=function(t){var e=t.projection.frustumCorners;for(var i=0;i<12;++i){var r=e[i];this._pLocalFrustum[i]=r;this._pLocalFrustum[i+12]=r+(e[i+12]-r)*this._coverageRatio}this.pUpdateProjectionFromFrustumCorners(t,this._pLocalFrustum,this._pMatrix);this._pOverallDepthProjection.matrix=this._pMatrix};return e}(s);e.exports=n},{"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper"}],"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=t("awayjs-display/lib/traverse/ShadowCasterCollector");var n=function(){function t(){this._pDepthMapSize=2048;this._autoUpdateShadows=true;this._pCasterCollector=this.pCreateCasterCollector()}t.prototype.pCreateCasterCollector=function(){return new s};Object.defineProperty(t.prototype,"autoUpdateShadows",{get:function(){return this._autoUpdateShadows},set:function(t){this._autoUpdateShadows=t},enumerable:true,configurable:true});t.prototype.updateShadows=function(){this._iShadowsInvalid=true};t.prototype.iSetDepthMap=function(t){if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=t};Object.defineProperty(t.prototype,"light",{get:function(){return this._pLight},set:function(t){this._pLight=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"depthMap",{get:function(){if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();return this._depthMap},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"depthMapSize",{get:function(){return this._pDepthMapSize},set:function(t){if(t==this._pDepthMapSize)return;this._pSetDepthMapSize(t)},enumerable:true,configurable:true});t.prototype.dispose=function(){this._pCasterCollector=null;if(this._depthMap&&!this._explicitDepthMap)this._depthMap.dispose();this._depthMap=null};t.prototype.pCreateDepthTexture=function(){throw new r};t.prototype.iRenderDepthMap=function(t,e){this._iShadowsInvalid=false;this.pUpdateDepthProjection(t.camera);if(!this._depthMap)this._depthMap=this.pCreateDepthTexture();this.pDrawDepthMap(this._depthMap,t.scene,e)};t.prototype.pUpdateDepthProjection=function(t){throw new r};t.prototype.pDrawDepthMap=function(t,e,i){throw new r};t.prototype._pSetDepthMapSize=function(t){this._pDepthMapSize=t;if(this._explicitDepthMap){throw Error("Cannot set depth map size for the current renderer.")}else if(this._depthMap){this._depthMap.dispose();this._depthMap=null}};return t}();e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/traverse/ShadowCasterCollector":"awayjs-display/lib/traverse/ShadowCasterCollector"}],"awayjs-display/lib/partition/BasicPartition":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/NodeBase");var n=t("awayjs-display/lib/partition/PartitionBase");var o=function(t){r(e,t);function e(){t.call(this);this._rootNode=new s}return e}(n);e.exports=o},{"awayjs-display/lib/partition/NodeBase":"awayjs-display/lib/partition/NodeBase","awayjs-display/lib/partition/PartitionBase":"awayjs-display/lib/partition/PartitionBase"}],"awayjs-display/lib/partition/CameraNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/EntityNode");var n=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r)}e.prototype.acceptTraverser=function(t){};return e}(s);e.exports=n},{"awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/ContainerNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/NodeBase");var n=function(t){r(e,t);function e(e,i,r){t.call(this);this.isContainerNode=true;this._childDepths=new Array;this._childMasks=new Array;this._numChildMasks=0;this._pool=e;this._container=i;this._partition=r}Object.defineProperty(e.prototype,"displayObject",{get:function(){return this._container},enumerable:true,configurable:true});e.prototype.acceptTraverser=function(t){if(this.numEntities==0)return;if(this._pEntityNode)this._pEntityNode.acceptTraverser(t);var e;for(e=0;e<this._numChildMasks;e++)this._childMasks[e].acceptTraverser(t);for(e=0;e<this._pNumChildNodes;e++)this._pChildNodes[e].acceptTraverser(t)};e.prototype.findParentForNode=function(t){if(!t.isContainerNode&&t.displayObject.isContainer)return this._pool.getItem(t.displayObject);return this._pool.getItem(t.displayObject.parent)};e.prototype.iAddNode=function(t){t.parent=this;if(!t.isContainerNode&&t.displayObject.isContainer){this._pEntityNode=t}else if(t.displayObject.maskMode){this._childMasks.push(t);this._numChildMasks=this._childMasks.length}else{var e=t.displayObject._depthID;var i=this._childDepths.length;var r=i;while(r--)if(this._childDepths[r]<e)break;r++;if(r<i){this._pChildNodes.splice(r,0,t);this._childDepths.splice(r,0,e)}else{this._pChildNodes.push(t);this._childDepths.push(e)}this._pNumChildNodes=this._childDepths.length}t._iUpdateImplicitDebugVisible(this.debugChildrenVisible);var s=t.numEntities;t=this;do{t.numEntities+=s}while((t=t.parent)!=null)};e.prototype.iRemoveNode=function(t){if(!t.isContainerNode&&t.displayObject.isContainer){this._pEntityNode=null}else if(t.displayObject.maskMode){this._childMasks.splice(this._childMasks.indexOf(t),1);this._numChildMasks=this._childMasks.length}else{var e=this._pChildNodes.indexOf(t);this._pChildNodes.splice(e,1);this._childDepths.splice(e,1);this._pNumChildNodes=this._childDepths.length}t._iUpdateImplicitDebugVisible(false);var i=t.numEntities;t=this;do{t.numEntities-=i}while((t=t.parent)!=null)};return e}(s);e.exports=n},{"awayjs-display/lib/partition/NodeBase":"awayjs-display/lib/partition/NodeBase"}],"awayjs-display/lib/partition/DirectionalLightNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/EntityNode");var n=t("awayjs-display/lib/entities/DirectionalLight");var o=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r);this._directionalLight=i}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyDirectionalLight(this._directionalLight)};e.prototype.isCastingShadow=function(){return false};e.assetClass=n;return e}(s);e.exports=o},{"awayjs-display/lib/entities/DirectionalLight":"awayjs-display/lib/entities/DirectionalLight","awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/EntityNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-display/lib/bounds/AxisAlignedBoundingBox");var o=t("awayjs-display/lib/bounds/BoundingSphere");var a=t("awayjs-display/lib/bounds/BoundsType");var l=t("awayjs-display/lib/bounds/NullBounds");var h=t("awayjs-display/lib/partition/NodeBase");var u=function(t){r(e,t);function e(e,i,r){t.call(this);this.isContainerNode=false;this._pool=e;this._entity=i;this._partition=r;this.numEntities=1;this.updateBounds();this.debugVisible=this._entity.debugVisible}Object.defineProperty(e.prototype,"displayObject",{get:function(){return this._entity},enumerable:true,configurable:true});e.prototype.isCastingShadow=function(){return this.displayObject.castsShadows};e.prototype.isInFrustum=function(t,e){if(!this._entity._iIsVisible())return false;return true};e.prototype.acceptTraverser=function(t){if(t.enterNode(this)){t.applyEntity(this._entity);if(this._pImplicitDebugVisible&&t.isEntityCollector)t.applyEntity(this._pDebugEntity)}};e.prototype.isIntersectingRay=function(t,e){if(!this._entity._iIsVisible())return false;var i=this._entity._iPickingCollisionVO;i.localRayPosition=this._entity.inverseSceneTransform.transformVector(t);i.localRayDirection=this._entity.inverseSceneTransform.deltaTransformVector(e);if(!i.localNormal)i.localNormal=new s;var r=this._bounds.rayIntersection(i.localRayPosition,i.localRayDirection,i.localNormal);if(r<0)return false;i.rayEntryDistance=r;i.rayPosition=t;i.rayDirection=e;i.rayOriginIsInsideBounds=r==0;return true};e.prototype._pCreateDebugEntity=function(){return this._bounds.boundsPrimitive};e.prototype.invalidatePartition=function(){this._bounds.invalidate()};e.prototype.updateBounds=function(){if(this._entity.boundsType==a.AXIS_ALIGNED_BOX)this._bounds=new n(this._entity);else if(this._entity.boundsType==a.SPHERE)this._bounds=new o(this._entity);else if(this._entity.boundsType==a.NULL)this._bounds=new l;this.updateDebugEntity()};return e}(h);e.exports=u},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/bounds/AxisAlignedBoundingBox":"awayjs-display/lib/bounds/AxisAlignedBoundingBox","awayjs-display/lib/bounds/BoundingSphere":"awayjs-display/lib/bounds/BoundingSphere","awayjs-display/lib/bounds/BoundsType":"awayjs-display/lib/bounds/BoundsType","awayjs-display/lib/bounds/NullBounds":"awayjs-display/lib/bounds/NullBounds","awayjs-display/lib/partition/NodeBase":"awayjs-display/lib/partition/NodeBase"}],"awayjs-display/lib/partition/IDisplayObjectNode":[function(t,e,i){},{}],"awayjs-display/lib/partition/INode":[function(t,e,i){},{}],"awayjs-display/lib/partition/LightProbeNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/EntityNode");var n=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r);this._lightProbe=i}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyLightProbe(this._lightProbe)};e.prototype.isCastingShadow=function(){return false};e.id="lightProbeNode";return e}(s);e.exports=n},{"awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/NodeBase":[function(t,e,i){var r=t("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function t(){this._pChildNodes=new Array;this._pNumChildNodes=0;this.numEntities=0}Object.defineProperty(t.prototype,"debugVisible",{get:function(){return this._explicitDebugVisible},set:function(t){if(this._explicitDebugVisible==t)return;this._explicitDebugVisible=t;this._iUpdateImplicitDebugVisible(this.parent?this.parent.debugChildrenVisible:false)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"debugChildrenVisible",{get:function(){return this._debugChildrenVisible},set:function(t){if(this._debugChildrenVisible==t)return;this._debugChildrenVisible=t;for(var e=0;e<this._pNumChildNodes;++e)this._pChildNodes[e]._iUpdateImplicitDebugVisible(this._debugChildrenVisible)},enumerable:true,configurable:true});t.prototype.isInFrustum=function(t,e){return true};t.prototype.isIntersectingRay=function(t,e){return true};t.prototype.isCastingShadow=function(){return true};t.prototype.findParentForNode=function(t){return this};t.prototype.acceptTraverser=function(t){if(this.numEntities==0&&!this._pImplicitDebugVisible)return;if(t.enterNode(this)){for(var e=0;e<this._pNumChildNodes;e++)this._pChildNodes[e].acceptTraverser(t);if(this._pImplicitDebugVisible&&t.isEntityCollector)t.applyEntity(this._pDebugEntity)}};t.prototype.applyDebugEntity=function(t){if(this._pDebugEntity==null)this._pDebugEntity=this._pCreateDebugEntity();t.applyEntity(this._pDebugEntity)};t.prototype.iAddNode=function(t){t.parent=this;this.numEntities+=t.numEntities;this._pChildNodes[this._pNumChildNodes++]=t;t._iUpdateImplicitDebugVisible(this.debugChildrenVisible);var e=t.numEntities;t=this;do{t.numEntities+=e}while((t=t.parent)!=null)};t.prototype.iRemoveNode=function(t){var e=this._pChildNodes.indexOf(t);this._pChildNodes[e]=this._pChildNodes[--this._pNumChildNodes];this._pChildNodes.pop();t._iUpdateImplicitDebugVisible(false);var i=t.numEntities;t=this;do{t.numEntities-=i}while((t=t.parent)!=null)};t.prototype._iUpdateImplicitDebugVisible=function(t){if(this._pImplicitDebugVisible==this._explicitDebugVisible||t)return;this._pImplicitDebugVisible=this._explicitDebugVisible||t;for(var e=0;e<this._pNumChildNodes;++e)this._pChildNodes[e]._iUpdateImplicitDebugVisible(this._debugChildrenVisible);if(this._pImplicitDebugVisible){this._pDebugEntity=this._pCreateDebugEntity()}else{this._pDebugEntity=null}};t.prototype.updateDebugEntity=function(){if(this._pImplicitDebugVisible){this._pDebugEntity=this._pCreateDebugEntity()}};t.prototype._pCreateDebugEntity=function(){throw new r};return t}();e.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-display/lib/partition/PartitionBase":[function(t,e,i){var r=t("awayjs-display/lib/pool/EntityNodePool");var s=function(){function t(){this._updatesMade=false;this._entityNodePool=new r(this)}t.prototype.traverse=function(t){if(this._updatesMade)this.updateEntities();this._rootNode.acceptTraverser(t)};t.prototype.iMarkForUpdate=function(t){var e=this._updateQueue;while(e){if(t==e)return;e=e._iUpdateQueueNext}t._iUpdateQueueNext=this._updateQueue;this._updateQueue=t;this._updatesMade=true};t.prototype.iRemoveEntity=function(t){var e;if(t.parent){t.parent.iRemoveNode(t);t.parent=null}if(t==this._updateQueue){this._updateQueue=t._iUpdateQueueNext}else{e=this._updateQueue;while(e&&e._iUpdateQueueNext!=t)e=e._iUpdateQueueNext;if(e)e._iUpdateQueueNext=t._iUpdateQueueNext}t._iUpdateQueueNext=null;if(!this._updateQueue)this._updatesMade=false};t.prototype.updateEntities=function(){var t=this._updateQueue;while(t){t.displayObject._iInternalUpdate();t=t._iUpdateQueueNext}t=this._updateQueue;var e;var i;this._updateQueue=null;this._updatesMade=false;do{e=this._rootNode.findParentForNode(t);if(t.parent!=e){if(t.parent)t.parent.iRemoveNode(t);e.iAddNode(t)}i=t._iUpdateQueueNext;t._iUpdateQueueNext=null}while((t=i)!=null)};t.prototype._iRegisterEntity=function(t){if(t.isEntity)this.iMarkForUpdate(this._entityNodePool.getItem(t))};t.prototype._iUnregisterEntity=function(t){if(t.isEntity)this.iRemoveEntity(this._entityNodePool.disposeItem(t))};return t}();e.exports=s},{"awayjs-display/lib/pool/EntityNodePool":"awayjs-display/lib/pool/EntityNodePool"}],"awayjs-display/lib/partition/PointLightNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/EntityNode");var n=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r);this._pointLight=i}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applyPointLight(this._pointLight)};e.prototype.isCastingShadow=function(){return false};e.id="pointLightNode";return e}(s);e.exports=n},{"awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/partition/SceneGraphPartition":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/PartitionBase");var n=t("awayjs-display/lib/pool/ContainerNodePool");var o=function(t){r(e,t);function e(e){t.call(this);this._containerNodePool=new n(this);this._rootNode=this._containerNodePool.getItem(e)}e.prototype.traverse=function(e){t.prototype.traverse.call(this,e)};e.prototype._iRegisterEntity=function(e){t.prototype._iRegisterEntity.call(this,e);if(e.isContainer)this.iMarkForUpdate(this._containerNodePool.getItem(e))};e.prototype._iUnregisterEntity=function(e){t.prototype._iUnregisterEntity.call(this,e);if(e.isContainer)this.iRemoveEntity(this._containerNodePool.disposeItem(e))};return e}(s);e.exports=o},{"awayjs-display/lib/partition/PartitionBase":"awayjs-display/lib/partition/PartitionBase","awayjs-display/lib/pool/ContainerNodePool":"awayjs-display/lib/pool/ContainerNodePool"}],"awayjs-display/lib/partition/SkyboxNode":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/partition/EntityNode");var n=function(t){r(e,t);function e(e,i,r){t.call(this,e,i,r);this._skyBox=i}e.prototype.acceptTraverser=function(t){if(t.enterNode(this))t.applySkybox(this._skyBox)};e.prototype.isInFrustum=function(t,e){if(!this._skyBox._iIsVisible)return false;return true};e.id="skyboxNode";return e}(s);e.exports=n},{"awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode"}],"awayjs-display/lib/pick/IPicker":[function(t,e,i){},{}],"awayjs-display/lib/pick/IPickingCollider":[function(t,e,i){},{}],"awayjs-display/lib/pick/JSPickingCollider":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-core/lib/geom/Point");var n=function(){function t(t){if(t===void 0){t=false}this._findClosestCollision=t}t.prototype.testBillboardCollision=function(t,e,i,r){i.renderableOwner=null;return false};t.prototype.testTriangleCollision=function(t,e,i,s){var n=i.localRayPosition;var o=i.localRayDirection;var a;var l,h,u;var p,c,f;var _,d,y;var b,m,v;var g,w,j,P;var x,C,O;var D,T,E;var A,S,M;var I,N,B;var R,L,V;var k,U,G,F;var H,W,z,X,q;var Y=t.indices.get(t.numElements);var Z=-1;var K=e.bothSides;var Q=t.positions.get(t.numVertices);var J=t.positions.dimensions;var $=t.uvs.get(t.numVertices);var te=t.uvs.dimensions;var ee=Y.length;for(var ie=0;ie<ee;ie+=3){l=Y[ie]*J;h=Y[ie+1]*J;u=Y[ie+2]*J;x=Q[l];C=Q[l+1];O=Q[l+2];D=Q[h];T=Q[h+1];E=Q[h+2];A=Q[u];S=Q[u+1];M=Q[u+2];I=D-x;N=T-C;B=E-O;R=A-x;L=S-C;V=M-O;_=N*V-B*L;d=B*R-I*V;y=I*L-N*R;k=1/Math.sqrt(_*_+d*d+y*y);_*=k;d*=k;y*=k;U=_*o.x+d*+o.y+y*o.z;if(!K&&U<0||K&&U!=0){G=-(_*x+d*C+y*O);F=-(_*n.x+d*n.y+y*n.z+G);a=F/U;b=n.x+a*o.x;m=n.y+a*o.y;v=n.z+a*o.z;H=I*R+N*L+B*V;W=I*I+N*N+B*B;z=R*R+L*L+V*V;p=b-x;c=m-C;f=v-O;X=p*I+c*N+f*B;q=p*R+c*L+f*V;g=1/(W*z-H*H);j=g*(z*X-H*q);P=g*(-H*X+W*q);if(j<0)continue;if(P<0)continue;w=1-j-P;if(!(w<0)&&a>0&&a<s){s=a;Z=ie/3;i.rayEntryDistance=a;i.localPosition=new r(b,m,v);i.localNormal=new r(_,d,y);i.uv=this._getCollisionUV(Y,$,ie,j,P,w,te);i.index=ie;if(!this._findClosestCollision)return true}}}if(Z>=0)return true;return false};t.prototype.testCurveCollision=function(t,e,i,s){var n=i.localRayPosition;var o=i.localRayDirection;var a=new r(0,0,-1,0);var l=new r;var h=a.x*n.x+a.y*n.y+a.z*n.z+a.w;l.x=n.x-a.x*h;l.y=n.y-a.y*h;l.z=n.z-a.z*h;var u=new r(a.x,a.y,a.z);var p=-n.dotProduct(u)/o.dotProduct(u);o.scaleBy(p);var c=n.add(o);var f=t.indices.get(t.numElements);var _=-1;var d=e.bothSides;var y=t.positions.get(t.numVertices);var b=t.positions.dimensions;var m=t.curves.get(t.numVertices);var v=t.curves.dimensions;var g=t.uvs.get(t.numVertices);var w=t.uvs.dimensions;var j=f.length;for(var P=0;P<j;P+=3){var x=f[P];var C=f[P+1]*b;var O=f[P+2]*b;var D=y[x*b];var T=y[x*b+1];var E=y[C];var A=y[C+1];var S=y[O];var M=y[O+1];var I=m[x*v];var N=y[x*b+2];var B=D-c.x;var R=T-c.y;var L=A-T;var V=-(E-D);var k=B*L+R*V;if(k>0)continue;B=E-c.x;R=A-c.y;L=M-A;V=-(S-E);k=B*L+R*V;if(k>0)continue;B=S-c.x;R=M-c.y;L=T-M;V=-(D-S);k=B*L+R*V;if(k>0)continue;if(I!=2){var U=E-D;var G=A-T;var F=S-D;var H=M-T;var W=c.x-D;var z=c.y-T;var X=U*H-F*G;var q=(W*H-F*z)/X;var Y=(U*z-W*G)/X;var Z=1-q-Y;var K=.5*q+Y;var Q=Y;var J=K*K-Q;if(J>0&&N==-1||J<0&&N==1)continue}if(h<s){s=h;_=P/3;i.rayEntryDistance=h;i.localPosition=c;i.localNormal=new r(0,0,1);i.uv=this._getCollisionUV(f,g,P,q,Y,Z,w);i.index=P;if(!this._findClosestCollision)return true}}if(_>=0)return true;return false};t.prototype.testLineCollision=function(t,e,i,r){return false};t.prototype._getCollisionUV=function(t,e,i,n,o,a,l){var h=new s;var u=t[i]*l;var p=new r(e[u],e[u+1]);u=t[i+1]*l;var c=new r(e[u],e[u+1]);u=t[i+2]*l;var f=new r(e[u],e[u+1]);h.x=a*p.x+n*c.x+o*f.x;h.y=a*p.y+n*c.y+o*f.y;return h};return t}();e.exports=n},{"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/pick/PickingCollisionVO":[function(t,e,i){var r=function(){function t(t){this.displayObject=t
}return t}();e.exports=r},{}],"awayjs-display/lib/pick/RaycastPicker":[function(t,e,i){var r=t("awayjs-core/lib/geom/Vector3D");var s=t("awayjs-display/lib/traverse/RaycastCollector");var n=function(){function t(t){if(t===void 0){t=false}this._ignoredEntities=[];this._onlyMouseEnabled=true;this._numEntities=0;this._raycastCollector=new s;this._findClosestCollision=t;this._entities=new Array}Object.defineProperty(t.prototype,"onlyMouseEnabled",{get:function(){return this._onlyMouseEnabled},set:function(t){this._onlyMouseEnabled=t},enumerable:true,configurable:true});t.prototype.getViewCollision=function(t,e,i){this._x=t;this._y=e;this._view=i;var r=i.unproject(t,e,0);var s=i.unproject(t,e,1).subtract(r);return this.getSceneCollision(r,s,i.scene)};t.prototype.getSceneCollision=function(t,e,i){this._raycastCollector.clear();this._raycastCollector.rayPosition=t;this._raycastCollector.rayDirection=e;i.traversePartitions(this._raycastCollector);this._numEntities=0;var r=this._raycastCollector.entityHead;var s;while(r){if(!this.isIgnored(s=r.entity))this._entities[this._numEntities++]=s;r=r.next}if(!this._numEntities)return null;return this.getPickingCollisionVO(this._raycastCollector)};t.prototype.setIgnoreList=function(t){this._ignoredEntities=t};t.prototype.isIgnored=function(t){if(this._onlyMouseEnabled&&!t._iIsMouseEnabled())return true;var e=this._ignoredEntities.length;for(var i=0;i<e;i++)if(this._ignoredEntities[i]==t)return true;return false};t.prototype.sortOnNearT=function(t,e){return t._iPickingCollisionVO.rayEntryDistance>e._iPickingCollisionVO.rayEntryDistance?1:-1};t.prototype.getPickingCollisionVO=function(t){this._entities.length=this._numEntities;this._entities=this._entities.sort(this.sortOnNearT);var e=Number.MAX_VALUE;var i;var r;var s;var n;for(n=0;n<this._numEntities;++n){s=this._entities[n];r=s._iPickingCollisionVO;if(s.pickingCollider){if((i==null||r.rayEntryDistance<i.rayEntryDistance)&&s._iTestCollision(e,this._findClosestCollision)){e=r.rayEntryDistance;i=r;if(!this._findClosestCollision){this.updateLocalPosition(r);return r}}}else if(i==null||r.rayEntryDistance<i.rayEntryDistance){if(!r.rayOriginIsInsideBounds&&this.getMasksCollision(s._iAssignedMasks())){this.updateLocalPosition(r);return r}}}return i};t.prototype.getMasksCollision=function(t){if(t!=null){var e=this._view.unproject(this._x,this._y,1e3);var i=t.length;var r;var s;var n;for(var o=0;o<i;o++){r=t[o];s=r.length;n=false;for(var a=0;a<s;a++){if(r[a].hitTestPoint(e.x,e.y,true,true)){n=true;break}}if(!n)return false}}return true};t.prototype.updateLocalPosition=function(t){var e=t.localPosition==null?t.localPosition=new r:t.localPosition;var i=t.localRayDirection;var s=t.localRayPosition;var n=t.rayEntryDistance;e.x=s.x+n*i.x;e.y=s.y+n*i.y;e.z=s.z+n*i.z};t.prototype.dispose=function(){};return t}();e.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/traverse/RaycastCollector":"awayjs-display/lib/traverse/RaycastCollector"}],"awayjs-display/lib/pool/ContainerNodePool":[function(t,e,i){var r=t("awayjs-display/lib/partition/ContainerNode");var s=function(){function t(t){this._containerNodePool=new Object;this._partition=t}t.prototype.getItem=function(t){return this._containerNodePool[t.id]||(this._containerNodePool[t.id]=t._iAddContainerNode(new r(this,t,this._partition)))};t.prototype.disposeItem=function(t){var e=this._containerNodePool[t.id];if(e){t._iRemoveContainerNode(e);delete this._containerNodePool[t.id]}return e};t._classPool=new Object;return t}();e.exports=s},{"awayjs-display/lib/partition/ContainerNode":"awayjs-display/lib/partition/ContainerNode"}],"awayjs-display/lib/pool/EntityListItemPool":[function(t,e,i){var r=t("awayjs-display/lib/pool/EntityListItem");var s=function(){function t(){this._index=0;this._poolSize=0;this._pool=new Array}t.prototype.getItem=function(){var t;if(this._index==this._poolSize){t=new r;this._pool[this._index++]=t;++this._poolSize}else{t=this._pool[this._index++]}return t};t.prototype.freeAll=function(){this._index=0};t.prototype.dispose=function(){this._pool.length=0};return t}();e.exports=s},{"awayjs-display/lib/pool/EntityListItem":"awayjs-display/lib/pool/EntityListItem"}],"awayjs-display/lib/pool/EntityListItem":[function(t,e,i){var r=function(){function t(){}return t}();e.exports=r},{}],"awayjs-display/lib/pool/EntityNodePool":[function(t,e,i){var r=t("awayjs-display/lib/entities/Camera");var s=t("awayjs-display/lib/entities/DirectionalLight");var n=t("awayjs-display/lib/entities/Mesh");var o=t("awayjs-display/lib/entities/MovieClip");var a=t("awayjs-display/lib/entities/Billboard");var l=t("awayjs-display/lib/entities/LineSegment");var h=t("awayjs-display/lib/entities/TextField");var u=t("awayjs-display/lib/entities/PointLight");var p=t("awayjs-display/lib/entities/LightProbe");var c=t("awayjs-display/lib/entities/Skybox");var f=t("awayjs-display/lib/partition/CameraNode");var _=t("awayjs-display/lib/partition/DirectionalLightNode");var d=t("awayjs-display/lib/partition/EntityNode");var y=t("awayjs-display/lib/partition/LightProbeNode");var b=t("awayjs-display/lib/partition/PointLightNode");var m=t("awayjs-display/lib/partition/SkyboxNode");var v=function(){function t(t){this._entityNodePool=new Object;this._partition=t}t.prototype.getItem=function(e){return this._entityNodePool[e.id]||(this._entityNodePool[e.id]=e._iAddEntityNode(new(t.getClass(e))(this,e,this._partition)))};t.prototype.disposeItem=function(t){var e=this._entityNodePool[t.id];if(e){t._iRemoveEntityNode(e);delete this._entityNodePool[t.id]}return e};t.registerClass=function(e,i){t._classPool[i.assetType]=e};t.getClass=function(e){return t._classPool[e.assetType]};t.addDefaults=function(){t.registerClass(f,r);t.registerClass(_,s);t.registerClass(d,n);t.registerClass(d,a);t.registerClass(d,l);t.registerClass(d,h);t.registerClass(d,o);t.registerClass(y,p);t.registerClass(b,u);t.registerClass(m,c)};t._classPool=new Object;t.main=t.addDefaults();return t}();e.exports=v},{"awayjs-display/lib/entities/Billboard":"awayjs-display/lib/entities/Billboard","awayjs-display/lib/entities/Camera":"awayjs-display/lib/entities/Camera","awayjs-display/lib/entities/DirectionalLight":"awayjs-display/lib/entities/DirectionalLight","awayjs-display/lib/entities/LightProbe":"awayjs-display/lib/entities/LightProbe","awayjs-display/lib/entities/LineSegment":"awayjs-display/lib/entities/LineSegment","awayjs-display/lib/entities/Mesh":"awayjs-display/lib/entities/Mesh","awayjs-display/lib/entities/MovieClip":"awayjs-display/lib/entities/MovieClip","awayjs-display/lib/entities/PointLight":"awayjs-display/lib/entities/PointLight","awayjs-display/lib/entities/Skybox":"awayjs-display/lib/entities/Skybox","awayjs-display/lib/entities/TextField":"awayjs-display/lib/entities/TextField","awayjs-display/lib/partition/CameraNode":"awayjs-display/lib/partition/CameraNode","awayjs-display/lib/partition/DirectionalLightNode":"awayjs-display/lib/partition/DirectionalLightNode","awayjs-display/lib/partition/EntityNode":"awayjs-display/lib/partition/EntityNode","awayjs-display/lib/partition/LightProbeNode":"awayjs-display/lib/partition/LightProbeNode","awayjs-display/lib/partition/PointLightNode":"awayjs-display/lib/partition/PointLightNode","awayjs-display/lib/partition/SkyboxNode":"awayjs-display/lib/partition/SkyboxNode"}],"awayjs-display/lib/pool/IEntityNodeClass":[function(t,e,i){},{}],"awayjs-display/lib/pool/IRenderable":[function(t,e,i){},{}],"awayjs-display/lib/pool/IRender":[function(t,e,i){},{}],"awayjs-display/lib/pool/ITextureVO":[function(t,e,i){},{}],"awayjs-display/lib/pool/SubMeshPool":[function(t,e,i){var r=t("awayjs-display/lib/base/LineSubMesh");var s=t("awayjs-display/lib/base/TriangleSubMesh");var n=t("awayjs-display/lib/base/CurveSubMesh");var o=function(){function t(){}t.registerClass=function(e){t.classPool[e.assetClass.assetType]=e};t.getClass=function(e){return t.classPool[e.assetType]};t.addDefaults=function(){t.registerClass(r);t.registerClass(s);t.registerClass(n)};t.classPool=new Object;t.main=t.addDefaults();return t}();e.exports=o},{"awayjs-display/lib/base/CurveSubMesh":"awayjs-display/lib/base/CurveSubMesh","awayjs-display/lib/base/LineSubMesh":"awayjs-display/lib/base/LineSubMesh","awayjs-display/lib/base/TriangleSubMesh":"awayjs-display/lib/base/TriangleSubMesh"}],"awayjs-display/lib/prefabs/PrefabBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=function(t){r(e,t);function e(){t.call(this);this._pObjects=new Array}e.prototype.getNewObject=function(){var t=this._pCreateObject();this._pObjects.push(t);return t};e.prototype._pCreateObject=function(){throw new n};e.prototype._iValidate=function(){};return e}(s);e.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s,n){if(e===void 0){e=50}if(i===void 0){i=100}if(r===void 0){r=16}if(s===void 0){s=15}if(n===void 0){n=true}t.call(this);this._numVertices=0;this._radius=e;this._height=i;this._segmentsW=r;this._segmentsH=s%2==0?s+1:s;this._yUp=n}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t%2==0?t+1:t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var s;var n;var o;var a;var l=0;var h=0;var u;var p,c,f,_;var d=0;if(e=="triangleSubGeometry"){var y=t;this._numVertices=(this._segmentsH+1)*(this._segmentsW+1);d=(this._segmentsH-1)*this._segmentsW*6;if(this._numVertices==y.numVertices){i=y.indices.get(y.numElements);r=y.positions.get(this._numVertices);s=y.normals.get(this._numVertices);n=y.tangents.get(this._numVertices)}else{i=new Uint16Array(d);r=new Float32Array(this._numVertices*3);s=new Float32Array(this._numVertices*3);n=new Float32Array(this._numVertices*3);this._pInvalidateUVs()}for(a=0;a<=this._segmentsH;++a){var b=Math.PI*a/this._segmentsH;var m=-this._radius*Math.cos(b);var v=this._radius*Math.sin(b);u=h;for(o=0;o<=this._segmentsW;++o){var g=2*Math.PI*o/this._segmentsW;var w=v*Math.cos(g);var j=a>this._segmentsH/2?this._height/2:-this._height/2;var P=v*Math.sin(g);var x=1/Math.sqrt(w*w+P*P+m*m);var C=Math.sqrt(P*P+w*w);if(this._yUp){f=0;_=C>.007?w/C:0;p=-m;c=P}else{f=C>.007?w/C:0;_=0;p=P;c=m}if(o==this._segmentsW){r[h]=r[u];r[h+1]=r[u+1];r[h+2]=r[u+2];s[h]=(s[u]+w*x)*.5;s[h+1]=(s[u+1]+p*x)*.5;s[h+2]=(s[u+2]+c*x)*.5;n[h]=(n[u]+(C>.007?-P/C:1))*.5;n[h+1]=(n[u+1]+f)*.5;n[h+2]=(n[u+2]+_)*.5}else{r[h]=w;r[h+1]=this._yUp?p-j:p;r[h+2]=this._yUp?c:c+j;s[h]=w*x;s[h+1]=p*x;s[h+2]=c*x;n[h]=C>.007?-P/C:1;n[h+1]=f;n[h+2]=_}if(o>0&&a>0){var O=(this._segmentsW+1)*a+o;var D=(this._segmentsW+1)*a+o-1;var T=(this._segmentsW+1)*(a-1)+o-1;var E=(this._segmentsW+1)*(a-1)+o;if(a==this._segmentsH){r[h]=r[u];r[h+1]=r[u+1];r[h+2]=r[u+2];i[l++]=O;i[l++]=T;i[l++]=E}else if(a==1){i[l++]=O;i[l++]=D;i[l++]=T}else{i[l++]=O;i[l++]=D;i[l++]=T;i[l++]=O;i[l++]=T;i[l++]=E}}h+=3}}y.setIndices(i);y.setPositions(r);y.setNormals(s);y.setTangents(n)}else if(e=="lineSubGeometry"){}};e.prototype._pBuildUVs=function(t,e){var i,r;var s;if(e=="triangleSubGeometry"){var n=t;if(n.uvs&&this._numVertices==n.numVertices){s=n.uvs.get(this._numVertices)}else{s=new Float32Array(this._numVertices*2)}var o=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){s[o++]=i/this._segmentsW*this._scaleU;s[o++]=r/this._segmentsH*this._scaleV}}n.setUVs(s)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveConePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var n=function(t){r(e,t);function e(e,i,r,s,n,o){if(e===void 0){e=50}if(i===void 0){i=100}if(r===void 0){r=16}if(s===void 0){s=1}if(n===void 0){n=true}if(o===void 0){o=true}t.call(this,0,e,i,r,s,false,n,true,o)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab"}],"awayjs-display/lib/prefabs/PrimitiveCubePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s,n,o,a){if(e===void 0){e=100}if(i===void 0){i=100}if(r===void 0){r=100}if(s===void 0){s=1}if(n===void 0){n=1}if(o===void 0){o=1}if(a===void 0){a=true}t.call(this);this._width=e;this._height=i;this._depth=r;this._segmentsW=s;this._segmentsH=n;this._segmentsD=o;this._tile6=a}Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tile6",{get:function(){return this._tile6},set:function(t){this._tile6=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsD",{get:function(){return this._segmentsD},set:function(t){this._segmentsD=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var s;var n;var o,a,l,h;var u,p,c=0;var f,_;var d,y,b;var m,v,g;var w;var j;var P;d=this._width/2;y=this._height/2;b=this._depth/2;if(e=="triangleSubGeometry"){var x=t;P=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;j=(this._segmentsW*this._segmentsH+this._segmentsW*this._segmentsD+this._segmentsH*this._segmentsD)*12;if(P==x.numVertices&&x.indices!=null){i=x.indices.get(x.numElements);r=x.positions.get(P);s=x.normals.get(P);n=x.tangents.get(P)}else{i=new Uint16Array(j);r=new Float32Array(P*3);s=new Float32Array(P*3);n=new Float32Array(P*3);this._pInvalidateUVs()}f=0;_=0;m=this._width/this._segmentsW;v=this._height/this._segmentsH;g=this._depth/this._segmentsD;for(u=0;u<=this._segmentsW;u++){w=-d+u*m;for(p=0;p<=this._segmentsH;p++){r[f]=w;r[f+1]=-y+p*v;r[f+2]=-b;s[f]=0;s[f+1]=0;s[f+2]=-1;n[f]=1;n[f+1]=0;n[f+2]=0;f+=3;r[f]=w;r[f+1]=-y+p*v;r[f+2]=b;s[f]=0;s[f+1]=0;s[f+2]=1;n[f]=-1;n[f+1]=0;n[f+2]=0;f+=3;if(u&&p){o=2*((u-1)*(this._segmentsH+1)+(p-1));a=2*(u*(this._segmentsH+1)+(p-1));l=o+2;h=a+2;i[_++]=o;i[_++]=l;i[_++]=h;i[_++]=o;i[_++]=h;i[_++]=a;i[_++]=a+1;i[_++]=h+1;i[_++]=l+1;i[_++]=a+1;i[_++]=l+1;i[_++]=o+1}}}c+=2*(this._segmentsW+1)*(this._segmentsH+1);for(u=0;u<=this._segmentsW;u++){w=-d+u*m;for(p=0;p<=this._segmentsD;p++){r[f]=w;r[f+1]=y;r[f+2]=-b+p*g;s[f]=0;s[f+1]=1;s[f+2]=0;n[f]=1;n[f+1]=0;n[f+2]=0;f+=3;r[f]=w;r[f+1]=-y;r[f+2]=-b+p*g;s[f]=0;s[f+1]=-1;s[f+2]=0;n[f]=1;n[f+1]=0;n[f+2]=0;f+=3;if(u&&p){o=c+2*((u-1)*(this._segmentsD+1)+(p-1));a=c+2*(u*(this._segmentsD+1)+(p-1));l=o+2;h=a+2;i[_++]=o;i[_++]=l;i[_++]=h;i[_++]=o;i[_++]=h;i[_++]=a;i[_++]=a+1;i[_++]=h+1;i[_++]=l+1;i[_++]=a+1;i[_++]=l+1;i[_++]=o+1}}}c+=2*(this._segmentsW+1)*(this._segmentsD+1);for(u=0;u<=this._segmentsD;u++){w=b-u*g;for(p=0;p<=this._segmentsH;p++){r[f]=-d;r[f+1]=-y+p*v;r[f+2]=w;s[f]=-1;s[f+1]=0;s[f+2]=0;n[f]=0;n[f+1]=0;n[f+2]=-1;f+=3;r[f]=d;r[f+1]=-y+p*v;r[f+2]=w;s[f]=1;s[f+1]=0;s[f+2]=0;n[f]=0;n[f+1]=0;n[f+2]=1;f+=3;if(u&&p){o=c+2*((u-1)*(this._segmentsH+1)+(p-1));a=c+2*(u*(this._segmentsH+1)+(p-1));l=o+2;h=a+2;i[_++]=o;i[_++]=l;i[_++]=h;i[_++]=o;i[_++]=h;i[_++]=a;i[_++]=a+1;i[_++]=h+1;i[_++]=l+1;i[_++]=a+1;i[_++]=l+1;i[_++]=o+1}}}x.setIndices(i);x.setPositions(r);x.setNormals(s);x.setTangents(n)}else if(e=="lineSubGeometry"){var C=t;var O=this._segmentsH*4+this._segmentsW*4+this._segmentsD*4;var r;var D;r=new Float32Array(O*6);D=new Float32Array(O);f=0;_=0;for(u=0;u<this._segmentsH;++u){r[f++]=-d;r[f++]=u*this._height/this._segmentsH-y;r[f++]=-b;r[f++]=d;r[f++]=u*this._height/this._segmentsH-y;r[f++]=-b;D[_++]=1;r[f++]=-d;r[f++]=y-u*this._height/this._segmentsH;r[f++]=b;r[f++]=d;r[f++]=y-u*this._height/this._segmentsH;r[f++]=b;D[_++]=1}for(u=0;u<this._segmentsW;++u){r[f++]=u*this._width/this._segmentsW-d;r[f++]=-y;r[f++]=-b;r[f++]=u*this._width/this._segmentsW-d;r[f++]=y;r[f++]=-b;D[_++]=1;r[f++]=d-u*this._width/this._segmentsW;r[f++]=-y;r[f++]=b;r[f++]=d-u*this._width/this._segmentsW;r[f++]=y;r[f++]=b;D[_++]=1}for(u=0;u<this._segmentsH;++u){r[f++]=-d;r[f++]=u*this._height/this._segmentsH-y;r[f++]=-b;r[f++]=-d;r[f++]=u*this._height/this._segmentsH-y;r[f++]=b;D[_++]=1;r[f++]=d;r[f++]=y-u*this._height/this._segmentsH;r[f++]=-b;r[f++]=d;r[f++]=y-u*this._height/this._segmentsH;r[f++]=b;D[_++]=1}for(u=0;u<this._segmentsD;++u){r[f++]=d;r[f++]=-y;r[f++]=u*this._depth/this._segmentsD-b;r[f++]=d;r[f++]=y;r[f++]=u*this._depth/this._segmentsD-b;D[_++]=1;r[f++]=-d;r[f++]=-y;r[f++]=b-u*this._depth/this._segmentsD;r[f++]=-d;r[f++]=y;r[f++]=b-u*this._depth/this._segmentsD;D[_++]=1}for(u=0;u<this._segmentsD;++u){r[f++]=-d;r[f++]=-y;r[f++]=b-u*this._depth/this._segmentsD;r[f++]=d;r[f++]=-y;r[f++]=b-u*this._depth/this._segmentsD;D[_++]=1;r[f++]=-d;r[f++]=y;r[f++]=u*this._depth/this._segmentsD-b;r[f++]=d;r[f++]=y;r[f++]=u*this._depth/this._segmentsD-b;D[_++]=1}for(u=0;u<this._segmentsW;++u){r[f++]=d-u*this._width/this._segmentsW;r[f++]=-y;r[f++]=-b;r[f++]=d-u*this._width/this._segmentsW;r[f++]=-y;r[f++]=b;D[_++]=1;r[f++]=u*this._width/this._segmentsW-d;r[f++]=y;r[f++]=-b;r[f++]=u*this._width/this._segmentsW-d;r[f++]=y;r[f++]=b;D[_++]=1}C.setPositions(r);C.setThickness(D)}};e.prototype._pBuildUVs=function(t,e){var i,r,s;var n;var o,a;var l,h;var u,p;var c,f;var _,d;var y;if(e=="triangleSubGeometry"){y=((this._segmentsW+1)*(this._segmentsH+1)+(this._segmentsW+1)*(this._segmentsD+1)+(this._segmentsH+1)*(this._segmentsD+1))*2;var b=t;if(y==b.numVertices&&b.uvs!=null){n=b.uvs.get(y)}else{n=new Float32Array(y*2)}if(this._tile6){o=l=1/3;a=h=1/2}else{o=a=1;l=h=0}s=0;u=1*l;p=1*h;c=2*l;f=0*h;_=o/this._segmentsW;d=a/this._segmentsH;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsH;r++){n[s++]=(u+i*_)*this._scaleU;n[s++]=(p+(a-r*d))*this._scaleV;n[s++]=(c+(o-i*_))*this._scaleU;n[s++]=(f+(a-r*d))*this._scaleV}}u=1*l;p=0*h;c=0*l;f=0*h;_=o/this._segmentsW;d=a/this._segmentsD;for(i=0;i<=this._segmentsW;i++){for(r=0;r<=this._segmentsD;r++){n[s++]=(u+i*_)*this._scaleU;n[s++]=(p+(a-r*d))*this._scaleV;n[s++]=(c+i*_)*this._scaleU;n[s++]=(f+r*d)*this._scaleV}}u=0*l;p=1*h;c=2*l;f=1*h;_=o/this._segmentsD;d=a/this._segmentsH;for(i=0;i<=this._segmentsD;i++){for(r=0;r<=this._segmentsH;r++){n[s++]=(u+i*_)*this._scaleU;n[s++]=(p+(a-r*d))*this._scaleV;n[s++]=(c+(o-i*_))*this._scaleU;n[s++]=(f+(a-r*d))*this._scaleV}}b.setUVs(n)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s,n,o,a,l,h){if(e===void 0){e=50}if(i===void 0){i=50}if(r===void 0){r=100}if(s===void 0){s=16}if(n===void 0){n=1}if(o===void 0){o=true}if(a===void 0){a=true}if(l===void 0){l=true}if(h===void 0){h=true}t.call(this);this._numVertices=0;this._topRadius=e;this._pBottomRadius=i;this._height=r;this._pSegmentsW=s;this._pSegmentsH=n;this._topClosed=o;this._bottomClosed=a;this._surfaceClosed=l;this._yUp=h}Object.defineProperty(e.prototype,"topRadius",{get:function(){return this._topRadius},set:function(t){this._topRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomRadius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});e.prototype.setSegmentsW=function(t){this._pSegmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});e.prototype.setSegmentsH=function(t){this._pSegmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()};Object.defineProperty(e.prototype,"topClosed",{get:function(){return this._topClosed},set:function(t){this._topClosed=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"bottomClosed",{get:function(){return this._bottomClosed},set:function(t){this._bottomClosed=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var s;var n;var o;var a;var l;var h;var u;var p;var c;var f;var _;var d;var y;var b;var m=0;var v;var g;var w=0;var j=0;var P=0;var x;var C;this._numVertices=0;var O=2*Math.PI/this._pSegmentsW;if(e=="triangleSubGeometry"){var D=t;if(this._surfaceClosed){this._numVertices+=(this._pSegmentsH+1)*(this._pSegmentsW+1);m+=this._pSegmentsH*this._pSegmentsW*6}if(this._topClosed){this._numVertices+=2*(this._pSegmentsW+1);m+=this._pSegmentsW*3}if(this._bottomClosed){this._numVertices+=2*(this._pSegmentsW+1);m+=this._pSegmentsW*3}if(this._numVertices==D.numVertices){i=D.indices.get(D.numElements);r=D.positions.get(this._numVertices);s=D.normals.get(this._numVertices);n=D.tangents.get(this._numVertices)}else{i=new Uint16Array(m);r=new Float32Array(this._numVertices*3);s=new Float32Array(this._numVertices*3);n=new Float32Array(this._numVertices*3);this._pInvalidateUVs()}p=0;c=0;if(this._topClosed&&this._topRadius>0){u=-.5*this._height;if(this._yUp){x=1;C=0;v=-u;g=0}else{x=0;C=-1;v=0;g=u}r[p]=0;r[p+1]=v;r[p+2]=g;s[p]=0;s[p+1]=x;s[p+2]=C;n[p]=1;n[p+1]=0;n[p+2]=0;p+=3;j+=1;for(o=0;o<=this._pSegmentsW;++o){_=o*O;l=this._topRadius*Math.cos(_);h=this._topRadius*Math.sin(_);if(this._yUp){v=-u;g=h}else{v=h;g=u}if(o==this._pSegmentsW){r[p]=r[w+3];r[p+1]=r[w+4];r[p+2]=r[w+5]}else{r[p]=l;r[p+1]=v;r[p+2]=g}s[p]=0;s[p+1]=x;s[p+2]=C;n[p]=1;n[p+1]=0;n[p+2]=0;p+=3;if(o>0){i[c++]=j-1;i[c++]=P;i[c++]=j}j+=1}}if(this._bottomClosed&&this._pBottomRadius>0){u=.5*this._height;w=j*3;P=j;if(this._yUp){x=-1;C=0;v=-u;g=0}else{x=0;C=1;v=0;g=u}if(o>0){r[p]=0;r[p+1]=v;r[p+2]=g;s[p]=0;s[p+1]=x;s[p+2]=C;n[p]=1;n[p+1]=0;n[p+2]=0;p+=3}j+=1;for(o=0;o<=this._pSegmentsW;++o){_=o*O;l=this._pBottomRadius*Math.cos(_);h=this._pBottomRadius*Math.sin(_);if(this._yUp){v=-u;g=h}else{v=h;g=u}if(o==this._pSegmentsW){r[p]=r[w+3];r[p+1]=r[w+4];r[p+2]=r[w+5]}else{r[p]=l;r[p+1]=v;r[p+2]=g}s[p]=0;s[p+1]=x;s[p+2]=C;n[p]=1;n[p+1]=0;n[p+2]=0;p+=3;if(o>0){i[c++]=j-1;i[c++]=j;i[c++]=P}j+=1}}d=this._pBottomRadius-this._topRadius;y=d/this._height;b=y==0?1:this._height/d;if(this._surfaceClosed){var T;var E;var A;var S;var M,I,N,B;for(a=0;a<=this._pSegmentsH;++a){f=this._topRadius-a/this._pSegmentsH*(this._topRadius-this._pBottomRadius);u=-(this._height/2)+a/this._pSegmentsH*this._height;w=j*3;for(o=0;o<=this._pSegmentsW;++o){_=o*O;l=f*Math.cos(_);h=f*Math.sin(_);M=b*Math.cos(_);I=b*Math.sin(_);if(this._yUp){x=0;C=-M;v=-u;g=h;N=y;B=I}else{x=-M;C=0;v=h;g=u;N=I;B=y}if(o==this._pSegmentsW){r[p]=r[w];r[p+1]=r[w+1];r[p+2]=r[w+2];s[p]=M;s[p+1]=y;s[p+2]=I;n[p]=I;n[p+1]=x;n[p+2]=C}else{r[p]=l;r[p+1]=v;r[p+2]=g;s[p]=M;s[p+1]=N;s[p+2]=B;n[p]=-I;n[p+1]=x;n[p+2]=C}p+=3;if(o>0&&a>0){T=j;E=j-1;A=E-this._pSegmentsW-1;S=T-this._pSegmentsW-1;i[c++]=T;i[c++]=E;i[c++]=A;i[c++]=T;i[c++]=A;i[c++]=S}j++}}}D.setIndices(i);D.setPositions(r);D.setNormals(s);D.setTangents(n)}else if(e=="lineSubGeometry"){var R=t;var L=this._pSegmentsH*this._pSegmentsW*2+this._pSegmentsW;var r=new Float32Array(L*6);var V=new Float32Array(L);p=0;c=0;var k=50;for(a=0;a<=this._pSegmentsH;++a){f=this._topRadius-a/this._pSegmentsH*(this._topRadius-this._pBottomRadius);u=-(this._height/2)+a/this._pSegmentsH*this._height;for(o=0;o<=this._pSegmentsW;++o){_=o*O;l=f*Math.cos(_);h=f*Math.sin(_);if(this._yUp){v=-u;g=h}else{v=h;g=u}if(o>0){r[p++]=l;r[p++]=v;r[p++]=g;V[c++]=1;if(a>0){var U=a==1?3-(6*(this._pSegmentsW-o)+12*o):3-this._pSegmentsW*12;r[p]=r[p++ +U];r[p]=r[p++ +U];r[p]=r[p++ +U];r[p++]=l;r[p++]=v;r[p++]=g;V[c++]=1}}if(o<this._pSegmentsW){r[p++]=l;r[p++]=v;r[p++]=g}}}R.setPositions(r);R.setThickness(V)}};e.prototype._pBuildUVs=function(t,e){var i;var r;var s;var n;var o;var a;if(e=="triangleSubGeometry"){var l=t;if(l.uvs&&this._numVertices==l.numVertices){a=l.uvs.get(this._numVertices)}else{a=new Float32Array(this._numVertices*2)}var h=2*Math.PI/this._pSegmentsW;var u=0;if(this._topClosed){a[u++]=.5*this._scaleU;a[u++]=.5*this._scaleV;for(i=0;i<=this._pSegmentsW;++i){o=i*h;s=.5+.5*-Math.cos(o);n=.5+.5*Math.sin(o);a[u++]=s*this._scaleU;a[u++]=n*this._scaleV}}if(this._bottomClosed){a[u++]=.5*this._scaleU;a[u++]=.5*this._scaleV;for(i=0;i<=this._pSegmentsW;++i){o=i*h;s=.5+.5*Math.cos(o);n=.5+.5*Math.sin(o);a[u++]=s*this._scaleU;a[u++]=n*this._scaleV}}if(this._surfaceClosed){for(r=0;r<=this._pSegmentsH;++r){for(i=0;i<=this._pSegmentsW;++i){a[u++]=i/this._pSegmentsW*this._scaleU;a[u++]=r/this._pSegmentsH*this._scaleV}}}l.setUVs(a)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitivePlanePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s,n,o){if(e===void 0){e=100}if(i===void 0){i=100}if(r===void 0){r=1}if(s===void 0){s=1}if(n===void 0){n=true}if(o===void 0){o=false}t.call(this);this._segmentsW=r;this._segmentsH=s;this._yUp=n;this._width=e;this._height=i;this._doubleSided=o}Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"doubleSided",{get:function(){return this._doubleSided},set:function(t){this._doubleSided=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r,s;var n;var o;var a=this._segmentsW+1;var l,h;var u;var p;if(e=="triangleSubGeometry"){var c=t;var f=(this._segmentsH+1)*a;var _;var d;var y;if(this._doubleSided)f*=2;n=this._segmentsH*this._segmentsW*6;if(this._doubleSided)n*=2;if(c.indices!=null&&n==c.indices.length){i=c.indices.get(c.numElements)}else{i=new Uint16Array(n);this._pInvalidateUVs()}if(f==c.numVertices){_=c.positions.get(f);d=c.normals.get(f);y=c.tangents.get(f)}else{_=new Float32Array(f*3);d=new Float32Array(f*3);y=new Float32Array(f*3);this._pInvalidateUVs()}h=0;l=0;for(p=0;p<=this._segmentsH;++p){for(u=0;u<=this._segmentsW;++u){r=(u/this._segmentsW-.5)*this._width;s=(p/this._segmentsH-.5)*this._height;_[l]=r;if(this._yUp){_[l+1]=0;_[l+2]=s}else{_[l+1]=s;_[l+2]=0}d[l]=0;if(this._yUp){d[l+1]=1;d[l+2]=0}else{d[l+1]=0;d[l+2]=-1}y[l]=1;y[l+1]=0;y[l+2]=0;l+=3;if(this._doubleSided){for(var b=l;b<l+3;++b){_[b]=_[b-3];d[b]=-d[b-3];y[b]=-y[b-3]}l+=3}if(u!=this._segmentsW&&p!=this._segmentsH){o=u+p*a;var m=this._doubleSided?2:1;i[h++]=o*m;i[h++]=(o+a)*m;i[h++]=(o+a+1)*m;i[h++]=o*m;i[h++]=(o+a+1)*m;i[h++]=(o+1)*m;if(this._doubleSided){i[h++]=(o+a+1)*m+1;i[h++]=(o+a)*m+1;i[h++]=o*m+1;i[h++]=(o+1)*m+1;i[h++]=(o+a+1)*m+1;i[h++]=o*m+1}}}}c.setIndices(i);c.setPositions(_);c.setNormals(d);c.setTangents(y)}else if(e=="lineSubGeometry"){var v=t;var g=this._segmentsH+1+a;var _;var w;var j=this._width/2;var P=this._height/2;_=new Float32Array(g*6);w=new Float32Array(g);h=0;l=0;for(p=0;p<=this._segmentsH;++p){_[l++]=-j;_[l++]=0;_[l++]=p*this._height-P;_[l++]=j;_[l++]=0;_[l++]=p*this._height-P;w[h++]=1}for(u=0;u<=this._segmentsW;++u){_[l++]=u*this._width-j;_[l++]=0;_[l++]=-P;_[l++]=u*this._width-j;_[l++]=0;_[l++]=P;w[h++]=1}v.setPositions(_);v.setThickness(w)}};e.prototype._pBuildUVs=function(t,e){var i;var r;if(e=="triangleSubGeometry"){r=(this._segmentsH+1)*(this._segmentsW+1);if(this._doubleSided)r*=2;var s=t;if(s.uvs&&r==s.numVertices){i=s.uvs.get(r)}else{i=new Float32Array(r*2);this._pInvalidateGeometry()}var n=0;for(var o=0;o<=this._segmentsH;++o){for(var a=0;a<=this._segmentsW;++a){i[n]=a/this._segmentsW*this._scaleU;i[n+1]=(1-o/this._segmentsH)*this._scaleV;
n+=2;if(this._doubleSided){i[n]=a/this._segmentsW*this._scaleU;i[n+1]=(1-o/this._segmentsH)*this._scaleV;n+=2}}}s.setUVs(i)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitivePolygonPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var n=function(t){r(e,t);function e(e,i,r){if(e===void 0){e=100}if(i===void 0){i=16}if(r===void 0){r=true}t.call(this,e,0,0,i,1,true,false,false,r)}Object.defineProperty(e.prototype,"radius",{get:function(){return this._pBottomRadius},set:function(t){this._pBottomRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sides",{get:function(){return this._pSegmentsW},set:function(t){this.setSegmentsW(t)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"subdivisions",{get:function(){return this._pSegmentsH},set:function(t){this.setSegmentsH(t)},enumerable:true,configurable:true});return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab"}],"awayjs-display/lib/prefabs/PrimitivePrefabBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/attributes/AttributesBuffer");var n=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-display/lib/base/Geometry");var a=t("awayjs-display/lib/base/TriangleSubGeometry");var l=t("awayjs-display/lib/base/LineSubGeometry");var h=t("awayjs-display/lib/entities/Mesh");var u=t("awayjs-display/lib/prefabs/PrefabBase");var p=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i="triangleSubGeometry"}t.call(this);this._geomDirty=true;this._uvDirty=true;this._scaleU=1;this._scaleV=1;this._geometryTypeDirty=true;this._geometry=new o;this._material=e;this._geometryType=i}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryType},set:function(t){if(this._geometryType==t)return;this._geometryType=t;this.invalidateGeometryType()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geometry",{get:function(){this._iValidate();return this._geometry},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){if(t==this._material)return;this._material=t;var e=this._pObjects.length;for(var i=0;i<e;i++)this._pObjects[i].material=this._material},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleU",{get:function(){return this._scaleU},set:function(t){if(this._scaleU=t)return;this._scaleU=t;this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scaleV",{get:function(){return this._scaleV},set:function(t){if(this._scaleV=t)return;this._scaleV=t;this._pInvalidateUVs()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){throw new n};e.prototype._pBuildUVs=function(t,e){throw new n};e.prototype.invalidateGeometryType=function(){this._geometryTypeDirty=true;this._geomDirty=true;this._uvDirty=true};e.prototype._pInvalidateGeometry=function(){this._geomDirty=true};e.prototype._pInvalidateUVs=function(){this._uvDirty=true};e.prototype.updateGeometryType=function(){if(this._subGeometry)this._geometry.removeSubGeometry(this._subGeometry);if(this._geometryType=="triangleSubGeometry"){var t=new a(new s);t.autoDeriveNormals=false;t.autoDeriveTangents=false;t.autoDeriveUVs=false;this._geometry.addSubGeometry(t);this._subGeometry=t}else if(this._geometryType=="lineSubGeometry"){this._geometry.addSubGeometry(this._subGeometry=new l(new s))}this._geometryTypeDirty=false};e.prototype.updateGeometry=function(){this._pBuildGeometry(this._subGeometry,this._geometryType);this._geomDirty=false};e.prototype.updateUVs=function(){this._pBuildUVs(this._subGeometry,this._geometryType);this._uvDirty=false};e.prototype._iValidate=function(){if(this._geometryTypeDirty)this.updateGeometryType();if(this._geomDirty)this.updateGeometry();if(this._uvDirty)this.updateUVs()};e.prototype._pCreateObject=function(){var t=new h(this._geometry,this._material);t._iSourcePrefab=this;return t};e.assetType="[asset PrimitivePrefab]";return e}(u);e.exports=p},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/base/Geometry":"awayjs-display/lib/base/Geometry","awayjs-display/lib/base/LineSubGeometry":"awayjs-display/lib/base/LineSubGeometry","awayjs-display/lib/base/TriangleSubGeometry":"awayjs-display/lib/base/TriangleSubGeometry","awayjs-display/lib/entities/Mesh":"awayjs-display/lib/entities/Mesh","awayjs-display/lib/prefabs/PrefabBase":"awayjs-display/lib/prefabs/PrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s){if(e===void 0){e=50}if(i===void 0){i=16}if(r===void 0){r=12}if(s===void 0){s=true}t.call(this);this._radius=e;this._segmentsW=i;this._segmentsH=r;this._yUp=s}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsW",{get:function(){return this._segmentsW},set:function(t){this._segmentsW=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsH",{get:function(){return this._segmentsH},set:function(t){this._segmentsH=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var s;var n;var o;var a;var l,h;var u;var p;var c;if(e=="triangleSubGeometry"){var f=t;c=(this._segmentsH+1)*(this._segmentsW+1);if(c==f.numVertices&&f.indices!=null){i=f.indices.get(f.numElements);r=f.positions.get(c);s=f.normals.get(c);n=f.tangents.get(c)}else{i=new Uint16Array((this._segmentsH-1)*this._segmentsW*6);r=new Float32Array(c*3);s=new Float32Array(c*3);n=new Float32Array(c*3);this._pInvalidateUVs()}l=0;h=0;var _;var d;var y;for(a=0;a<=this._segmentsH;++a){_=l;var b=Math.PI*a/this._segmentsH;var m=-this._radius*Math.cos(b);var v=this._radius*Math.sin(b);for(o=0;o<=this._segmentsW;++o){var g=2*Math.PI*o/this._segmentsW;var w=v*Math.cos(g);var j=v*Math.sin(g);var P=1/Math.sqrt(w*w+j*j+m*m);var x=Math.sqrt(j*j+w*w);if(this._yUp){d=0;y=x>.007?w/x:0;u=-m;p=j}else{d=x>.007?w/x:0;y=0;u=j;p=m}if(o==this._segmentsW){r[l]=r[_];r[l+1]=r[_+1];r[l+2]=r[_+2];s[l]=s[_]+w*P*.5;s[l+1]=s[_+1]+u*P*.5;s[l+2]=s[_+2]+p*P*.5;n[l]=x>.007?-j/x:1;n[l+1]=d;n[l+2]=y}else{r[l]=w;r[l+1]=u;r[l+2]=p;s[l]=w*P;s[l+1]=u*P;s[l+2]=p*P;n[l]=x>.007?-j/x:1;n[l+1]=d;n[l+2]=y}if(o>0&&a>0){var C=(this._segmentsW+1)*a+o;var O=(this._segmentsW+1)*a+o-1;var D=(this._segmentsW+1)*(a-1)+o-1;var T=(this._segmentsW+1)*(a-1)+o;if(a==this._segmentsH){r[l]=r[_];r[l+1]=r[_+1];r[l+2]=r[_+2];i[h++]=C;i[h++]=D;i[h++]=T}else if(a==1){i[h++]=C;i[h++]=O;i[h++]=D}else{i[h++]=C;i[h++]=O;i[h++]=D;i[h++]=C;i[h++]=D;i[h++]=T}}l+=3}}f.setIndices(i);f.setPositions(r);f.setNormals(s);f.setTangents(n)}else if(e=="lineSubGeometry"){var E=t;var A=this._segmentsH*this._segmentsW*2+this._segmentsW;var r=new Float32Array(A*6);var S=new Float32Array(A);l=0;h=0;for(a=0;a<=this._segmentsH;++a){var b=Math.PI*a/this._segmentsH;var m=-this._radius*Math.cos(b);var v=this._radius*Math.sin(b);for(o=0;o<=this._segmentsW;++o){var g=2*Math.PI*o/this._segmentsW;var w=v*Math.cos(g);var j=v*Math.sin(g);if(this._yUp){u=-m;p=j}else{u=j;p=m}if(o>0){r[l++]=w;r[l++]=u;r[l++]=p;S[h++]=1;if(a>0){var M=a==1?3-(6*(this._segmentsW-o)+12*o):3-this._segmentsW*12;r[l]=r[l++ +M];r[l]=r[l++ +M];r[l]=r[l++ +M];r[l++]=w;r[l++]=u;r[l++]=p;S[h++]=1}}if(o<this._segmentsW){r[l++]=w;r[l++]=u;r[l++]=p}}}E.setPositions(r);E.setThickness(S)}};e.prototype._pBuildUVs=function(t,e){var i,r;var s=(this._segmentsH+1)*(this._segmentsW+1);var n;if(e=="triangleSubGeometry"){s=(this._segmentsH+1)*(this._segmentsW+1);var o=t;if(s==o.numVertices&&o.uvs!=null){n=o.uvs.get(s)}else{n=new Float32Array(s*2)}var a=0;for(r=0;r<=this._segmentsH;++r){for(i=0;i<=this._segmentsW;++i){n[a++]=i/this._segmentsW*this._scaleU;n[a++]=r/this._segmentsH*this._scaleV}}o.setUVs(n)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/prefabs/PrimitivePrefabBase");var n=function(t){r(e,t);function e(e,i,r,s,n){if(e===void 0){e=50}if(i===void 0){i=50}if(r===void 0){r=16}if(s===void 0){s=8}if(n===void 0){n=true}t.call(this);this._numVertices=0;this._radius=e;this._tubeRadius=i;this._segmentsR=r;this._segmentsT=s;this._yUp=n}Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"tubeRadius",{get:function(){return this._tubeRadius},set:function(t){this._tubeRadius=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsR",{get:function(){return this._segmentsR},set:function(t){this._segmentsR=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"segmentsT",{get:function(){return this._segmentsT},set:function(t){this._segmentsT=t;this._pInvalidateGeometry();this._pInvalidateUVs()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"yUp",{get:function(){return this._yUp},set:function(t){this._yUp=t;this._pInvalidateGeometry()},enumerable:true,configurable:true});e.prototype._pBuildGeometry=function(t,e){var i;var r;var s;var n;var o,a;var l,h,u,p,c,f,_,d;var y;var b;var m=0;if(e=="triangleSubGeometry"){var v=t;this._numVertices=(this._segmentsT+1)*(this._segmentsR+1);m=this._segmentsT*this._segmentsR*6;if(this._numVertices==v.numVertices){i=v.indices.get(v.numElements);r=v.positions.get(this._numVertices);s=v.normals.get(this._numVertices);n=v.tangents.get(this._numVertices)}else{i=new Uint16Array(m);r=new Float32Array(this._numVertices*3);s=new Float32Array(this._numVertices*3);n=new Float32Array(this._numVertices*3);this._pInvalidateUVs()}y=0;b=0;var g=2*Math.PI/this._segmentsR;var w=2*Math.PI/this._segmentsT;var j,P;var x,C,O,D;var T=0;var E=0;var A,S,M,I,N;for(a=0;a<=this._segmentsT;++a){T=E*3;for(o=0;o<=this._segmentsR;++o){_=o*g;d=a*w;N=Math.cos(d);p=N*Math.cos(_);c=N*Math.sin(_);f=Math.sin(d);l=this._radius*Math.cos(_)+this._tubeRadius*p;h=this._radius*Math.sin(_)+this._tubeRadius*c;u=a==this._segmentsT?0:this._tubeRadius*f;if(this._yUp){O=-f;D=c;x=0;C=N?p/N:l/this._radius;j=-u;P=h}else{O=c;D=f;x=N?p/N:l/this._radius;C=0;j=h;P=u}if(o==this._segmentsR){r[y]=l;r[y+1]=r[T+1];r[y+2]=r[T+2]}else{r[y]=l;r[y+1]=j;r[y+2]=P}s[y]=p;s[y+1]=O;s[y+2]=D;n[y]=-(N?c/N:h/this._radius);n[y+1]=x;n[y+2]=C;y+=3;if(o>0&&a>0){A=E;S=E-1;M=S-this._segmentsR-1;I=A-this._segmentsR-1;i[b++]=A;i[b++]=S;i[b++]=M;i[b++]=A;i[b++]=M;i[b++]=I}E++}}v.setIndices(i);v.setPositions(r);v.setNormals(s);v.setTangents(n)}else if(e=="lineSubGeometry"){}};e.prototype._pBuildUVs=function(t,e){var i,r;var s;if(e=="triangleSubGeometry"){var n=t;if(n.uvs&&this._numVertices==n.numVertices){s=n.uvs.get(this._numVertices)}else{s=new Float32Array(this._numVertices*2)}var o=0;for(r=0;r<=this._segmentsT;++r){for(i=0;i<=this._segmentsR;++i){s[o++]=i/this._segmentsR*this._scaleU;s[o++]=r/this._segmentsT*this._scaleV}}n.setUVs(s)}else if(e=="lineSubGeometry"){}};return e}(s);e.exports=n},{"awayjs-display/lib/prefabs/PrimitivePrefabBase":"awayjs-display/lib/prefabs/PrimitivePrefabBase"}],"awayjs-display/lib/sort/IEntitySorter":[function(t,e,i){},{}],"awayjs-display/lib/sort/RenderableMergeSort":[function(t,e,i){var r=function(){function t(){}t.prototype.sortBlendedRenderables=function(t){var e;var i;var r;if(!t||!t.next){return t}r=t;i=t.next;while(i){i=i.next;if(i){r=r.next;i=i.next}}e=r.next;r.next=null;t=this.sortBlendedRenderables(t);e=this.sortBlendedRenderables(e);var s;var n;var o;if(!t)return e;if(!e)return t;while(t&&e){if(t.zIndex<e.zIndex){o=t;t=t.next}else{o=e;e=e.next}if(!s)s=o;else n.next=o;n=o}if(t)n.next=t;else if(e)n.next=e;return s};t.prototype.sortOpaqueRenderables=function(t){var e;var i,r;if(!t||!t.next){return t}r=t;i=t.next;while(i){i=i.next;if(i){r=r.next;i=i.next}}e=r.next;r.next=null;t=this.sortOpaqueRenderables(t);e=this.sortOpaqueRenderables(e);var s;var n;var o;var a=0;if(!t)return e;if(!e)return t;while(t&&e&&t!=null&&e!=null){var l=t.renderOrderId;var h=e.renderOrderId;if(l==h){var u=t.renderId;var p=e.renderId;if(u==p){if(t.zIndex<e.zIndex)a=1;else a=-1}else if(u>p){a=1}else{a=-1}}else if(l>h){a=1}else{a=-1}if(a<0){o=t;t=t.next}else{o=e;e=e.next}if(!s){s=o;n=o}else{n.next=o;n=o}}if(t)n.next=t;else if(e)n.next=e;return s};return t}();e.exports=r},{}],"awayjs-display/lib/sort/RenderableNullSort":[function(t,e,i){var r=function(){function t(){}t.prototype.sortBlendedRenderables=function(t){return t};t.prototype.sortOpaqueRenderables=function(t){return t};return t}();e.exports=r},{}],"awayjs-display/lib/text/AntiAliasType":[function(t,e,i){var r=function(){function t(){}t.ADVANCED="advanced";t.NORMAL="normal";return t}();e.exports=r},{}],"awayjs-display/lib/text/Font":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=t("awayjs-display/lib/text/TesselatedFontTable");var o=function(t){r(e,t);function e(){t.call(this);this._font_styles=new Array}Object.defineProperty(e.prototype,"font_styles",{get:function(){return this._font_styles},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.dispose=function(){};e.prototype.get_font_table=function(t){var e=this._font_styles.length;for(var i=0;i<e;++i){if(this._font_styles[i].name==t)return this._font_styles[i]}var r=new n;r.name=t;this._font_styles.push(r);return r};e.assetType="[asset Font]";return e}(s);e.exports=o},{"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/text/TesselatedFontTable":"awayjs-display/lib/text/TesselatedFontTable"}],"awayjs-display/lib/text/GridFitType":[function(t,e,i){var r=function(){function t(){}t.NONE="none";t.PIXEL="pixel";t.SUBPIXEL="subpixel";return t}();e.exports=r},{}],"awayjs-display/lib/text/TesselatedFontChar":[function(t,e,i){var r=function(){function t(t){this.kerningCharCodes=new Array;this.kerningValues=new Array;this.char_width=0;this.subgeom=t;if(this.subgeom!=null){var e=this.subgeom.positions.get(this.subgeom.numVertices);for(var i=0;i<e.length/3;i++){if(e[i*3]>this.char_width)this.char_width=e[i*3]}}}return t}();e.exports=r},{}],"awayjs-display/lib/text/TesselatedFontTable":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=t("awayjs-display/lib/text/TesselatedFontChar");var o=function(t){r(e,t);function e(){t.call(this);this._font_chars=new Array;this._font_chars_dic=new Object;this._offset_x=0;this._offset_y=0}e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"offset_x",{get:function(){return this._offset_x},set:function(t){this._offset_x=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"offset_y",{get:function(){return this._offset_y},set:function(t){this._offset_y=t},enumerable:true,configurable:true});e.prototype.get_font_chars=function(){return this._font_chars};e.prototype.get_font_em_size=function(){return this._font_em_size};e.prototype.set_whitespace_width=function(t){this._whitespace_width=t};e.prototype.get_whitespace_width=function(){return this._whitespace_width};e.prototype.set_font_em_size=function(t){this._font_em_size=t};e.prototype.get_subgeo_for_char=function(t){return this._font_chars_dic[t]};e.prototype.set_subgeo_for_char=function(t,e){var i=new n(e);e.name=t;this._font_chars.push(i);this._font_chars_dic[t]=i};return e}(s);e.exports=o},{"awayjs-core/lib/library/AssetBase":undefined,"awayjs-display/lib/text/TesselatedFontChar":"awayjs-display/lib/text/TesselatedFontChar"}],"awayjs-display/lib/text/TextFieldAutoSize":[function(t,e,i){var r=function(){function t(){}t.CENTER="center";t.LEFT="left";t.NONE="none";t.RIGHT="right";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFieldType":[function(t,e,i){var r=function(){function t(){}t.DYNAMIC="dynamic";t.INPUT="input";t.STATIC="input";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFormatAlign":[function(t,e,i){var r=function(){function t(){this.CENTER="center";this.JUSTIFY="justify";this.LEFT="left";this.RIGHT="right"}return t}();e.exports=r},{}],"awayjs-display/lib/text/TextFormat":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(e,i,r,s,n,o,a,l,h,u,p,c,f){if(e===void 0){e="Times New Roman"}if(i===void 0){i=12}if(r===void 0){r=0}if(s===void 0){s=false}if(n===void 0){n=false}if(o===void 0){o=false}if(a===void 0){a=""}if(l===void 0){l=""}if(h===void 0){h="left"}if(u===void 0){u=0}if(p===void 0){p=0}if(c===void 0){c=0}if(f===void 0){f=0}t.call(this);this.tabStops=new Array;this.font_name=e;this.size=i;this.bold=s;this.italic=n;this.underline=o;this.url=a;this.link_target=l;this.align=h;this.leftMargin=u;this.rightMargin=p;this.indent=c;this.leading=f}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.assetType="[asset TextFormat]";return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/text/TextInteractionMode":[function(t,e,i){var r=function(){function t(){}t.NORMAL="normal";t.SELECTION="selection";return t}();e.exports=r},{}],"awayjs-display/lib/text/TextLineMetrics":[function(t,e,i){var r=function(){function t(t,e,i,r,s,n){if(t===void 0){t=NaN}if(e===void 0){e=NaN}if(i===void 0){i=NaN}if(r===void 0){r=NaN}if(s===void 0){s=NaN}if(n===void 0){n=NaN}}return t}();e.exports=r},{}],"awayjs-display/lib/textures/Single2DTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/Sampler2D");var n=t("awayjs-core/lib/data/Image2D");var o=t("awayjs-core/lib/errors/Error");var a=t("awayjs-core/lib/utils/ImageUtils");var l=t("awayjs-display/lib/textures/TextureBase");var h=function(t){r(e,t);function e(e){t.call(this);if(e instanceof n)this.sampler2D=new s(e);else this.sampler2D=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"sampler2D",{get:function(){return this._sampler2D},set:function(t){if(this._sampler2D==t)return;if(!a.isImage2DValid(t.image2D))throw new o("Invalid sampler2DData: Width and height must be power of 2 and cannot exceed 2048");this._sampler2D=t;this._setSize(this._sampler2D.rect.width,this._sampler2D.rect.height);this.invalidateContent()},enumerable:true,configurable:true});e.assetType="[texture Single2DTexture]";return e}(l);e.exports=h},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-core/lib/data/Sampler2D":undefined,"awayjs-core/lib/errors/Error":undefined,"awayjs-core/lib/utils/ImageUtils":undefined,"awayjs-display/lib/textures/TextureBase":"awayjs-display/lib/textures/TextureBase"}],"awayjs-display/lib/textures/SingleCubeTexture":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/data/SamplerCube");var n=t("awayjs-core/lib/data/ImageCube");var o=t("awayjs-display/lib/textures/TextureBase");var a=function(t){r(e,t);function e(e){t.call(this);if(e instanceof n)this.samplerCube=new s(e);else this.samplerCube=e}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"samplerCube",{get:function(){return this._samplerCube},set:function(t){if(this._samplerCube==t)return;this._samplerCube=t;this.invalidateContent()},enumerable:true,configurable:true});e.assetType="[texture SingleCubeTexture]";return e}(o);e.exports=a},{"awayjs-core/lib/data/ImageCube":undefined,"awayjs-core/lib/data/SamplerCube":undefined,"awayjs-display/lib/textures/TextureBase":"awayjs-display/lib/textures/TextureBase"}],"awayjs-display/lib/textures/TextureBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/library/AssetBase");var n=function(t){r(e,t);function e(){t.call(this);this._textureVO=new Array;this._width=1;this._height=1}Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});e.prototype.invalidateContent=function(){var t=this._textureVO.length;for(var e=0;e<t;e++)this._textureVO[e].invalidate()};e.prototype.invalidateSize=function(){while(this._textureVO.length)this._textureVO[0].dispose()};e.prototype.dispose=function(){while(this._textureVO.length)this._textureVO[0].dispose()};e.prototype._iAddTextureVO=function(t){this._textureVO.push(t);return t};e.prototype._iRemoveTextureVO=function(t){this._textureVO.splice(this._textureVO.indexOf(t),1);return t};e.prototype._setSize=function(t,e){this._width=t;this._height=e};return e}(s);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-display/lib/traverse/CSSEntityCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/traverse/CollectorBase");var n=function(t){r(e,t);function e(){t.call(this)}return e}(s);e.exports=n},{"awayjs-display/lib/traverse/CollectorBase":"awayjs-display/lib/traverse/CollectorBase"}],"awayjs-display/lib/traverse/CollectorBase":[function(t,e,i){var r=t("awayjs-display/lib/pool/EntityListItemPool");var s=function(){function t(){this._numCullPlanes=0;this._pNumEntities=0;this._pNumInteractiveEntities=0;this._pEntityListItemPool=new r}Object.defineProperty(t.prototype,"camera",{get:function(){return this._pCamera},set:function(t){this._pCamera=t;this._cullPlanes=this._pCamera.frustumPlanes},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cullPlanes",{get:function(){return this._customCullPlanes},set:function(t){this._customCullPlanes=t},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"entityHead",{get:function(){return this._pEntityHead},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numEntities",{get:function(){return this._pNumEntities},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numInteractiveEntities",{get:function(){return this._pNumInteractiveEntities},enumerable:true,configurable:true});t.prototype.clear=function(){this._pNumEntities=this._pNumInteractiveEntities=0;this._cullPlanes=this._customCullPlanes?this._customCullPlanes:this._pCamera?this._pCamera.frustumPlanes:null;this._numCullPlanes=this._cullPlanes?this._cullPlanes.length:0;this._pEntityHead=null;this._pEntityListItemPool.freeAll()};t.prototype.enterNode=function(t){var e=this.scene._iCollectionMark!=t._iCollectionMark&&t.isInFrustum(this._cullPlanes,this._numCullPlanes);t._iCollectionMark=this.scene._iCollectionMark;return e};t.prototype.applyDirectionalLight=function(t){};t.prototype.applyEntity=function(t){this._pNumEntities++;if(t._iIsMouseEnabled())this._pNumInteractiveEntities++;var e=this._pEntityListItemPool.getItem();e.entity=t;e.next=this._pEntityHead;this._pEntityHead=e};t.prototype.applyLightProbe=function(t){};t.prototype.applyPointLight=function(t){};t.prototype.applySkybox=function(t){};return t}();e.exports=s},{"awayjs-display/lib/pool/EntityListItemPool":"awayjs-display/lib/pool/EntityListItemPool"}],"awayjs-display/lib/traverse/EntityCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/traverse/CollectorBase");var n=function(t){r(e,t);function e(){t.call(this);this._pNumLights=0;this._numDirectionalLights=0;this._numPointLights=0;this._numLightProbes=0;this._pLights=new Array;this._directionalLights=new Array;this._pointLights=new Array;this._lightProbes=new Array;this.isEntityCollector=true}Object.defineProperty(e.prototype,"directionalLights",{get:function(){return this._directionalLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightProbes",{get:function(){return this._lightProbes},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lights",{get:function(){return this._pLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"pointLights",{get:function(){return this._pointLights},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"skyBox",{get:function(){return this._pSkybox},enumerable:true,configurable:true});e.prototype.applyDirectionalLight=function(t){this._directionalLights[this._numDirectionalLights++]=t};e.prototype.applyLightProbe=function(t){this._lightProbes[this._numLightProbes++]=t};e.prototype.applyPointLight=function(t){this._pointLights[this._numPointLights++]=t};e.prototype.applySkybox=function(t){this._pSkybox=t};e.prototype.clear=function(){t.prototype.clear.call(this);this._pSkybox=null;if(this._pNumLights>0)this._pLights.length=this._pNumLights=0;if(this._numDirectionalLights>0)this._directionalLights.length=this._numDirectionalLights=0;if(this._numPointLights>0)this._pointLights.length=this._numPointLights=0;if(this._numLightProbes>0)this._lightProbes.length=this._numLightProbes=0};return e}(s);e.exports=n},{"awayjs-display/lib/traverse/CollectorBase":"awayjs-display/lib/traverse/CollectorBase"}],"awayjs-display/lib/traverse/RaycastCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-core/lib/geom/Vector3D");var n=t("awayjs-display/lib/traverse/CollectorBase");var o=function(t){r(e,t);function e(){t.call(this);this._rayPosition=new s;this._rayDirection=new s;this._iCollectionMark=0}Object.defineProperty(e.prototype,"rayPosition",{get:function(){return this._rayPosition},set:function(t){this._rayPosition=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"rayDirection",{get:function(){return this._rayDirection},set:function(t){this._rayDirection=t},enumerable:true,configurable:true});e.prototype.enterNode=function(t){return t.isIntersectingRay(this._rayPosition,this._rayDirection)};return e}(n);e.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/traverse/CollectorBase":"awayjs-display/lib/traverse/CollectorBase"}],"awayjs-display/lib/traverse/ShadowCasterCollector":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var s=t("awayjs-display/lib/traverse/CollectorBase");var n=function(t){r(e,t);function e(){t.call(this)}e.prototype.enterNode=function(e){var i=this.scene._iCollectionMark!=e._iCollectionMark&&e.isCastingShadow();if(!i){e._iCollectionMark=this.scene._iCollectionMark;return false}return t.prototype.enterNode.call(this,e)};return e}(s);e.exports=n},{"awayjs-display/lib/traverse/CollectorBase":"awayjs-display/lib/traverse/CollectorBase"}],"awayjs-display/lib/utils/Cast":[function(t,e,i){var r=t("awayjs-core/lib/data/Image2D");var s=t("awayjs-core/lib/data/Sampler2D");var n=t("awayjs-core/lib/utils/ByteArray");var o=t("awayjs-display/lib/errors/CastError");var a=t("awayjs-display/lib/textures/Single2DTexture");var l=function(){function t(){}t.string=function(t){if(typeof t=="function")t=new t;if(typeof t=="string")return t;return t};t.byteArray=function(t){if(typeof t=="function")t=new t;if(t instanceof n)return t;return t};t.isHex=function(t){var e=t.length;for(var i=0;i<e;++i){if(this._hexChars.indexOf(t.charAt(i))==-1)return false}return true};t.tryColor=function(t){if(typeof t=="number")return Math.floor(t);if(typeof t=="string"){if(t=="random")return Math.floor(Math.random()*16777216);if(this._colorNames==null){this._colorNames=new Object;this._colorNames["steelblue"]=4620980;this._colorNames["royalblue"]=267920;this._colorNames["cornflowerblue"]=6591981;this._colorNames["lightsteelblue"]=11584734;this._colorNames["mediumslateblue"]=8087790;this._colorNames["slateblue"]=6970061;this._colorNames["darkslateblue"]=4734347;this._colorNames["midnightblue"]=1644912;this._colorNames["navy"]=128;this._colorNames["darkblue"]=139;this._colorNames["mediumblue"]=205;this._colorNames["blue"]=255;this._colorNames["dodgerblue"]=2003199;this._colorNames["deepskyblue"]=49151;this._colorNames["lightskyblue"]=8900346;this._colorNames["skyblue"]=8900331;this._colorNames["lightblue"]=11393254;this._colorNames["powderblue"]=11591910;this._colorNames["azure"]=15794175;this._colorNames["lightcyan"]=14745599;this._colorNames["paleturquoise"]=11529966;this._colorNames["mediumturquoise"]=4772300;this._colorNames["lightseagreen"]=2142890;this._colorNames["darkcyan"]=35723;this._colorNames["teal"]=32896;this._colorNames["cadetblue"]=6266528;this._colorNames["darkturquoise"]=52945;this._colorNames["aqua"]=65535;this._colorNames["cyan"]=65535;this._colorNames["turquoise"]=4251856;this._colorNames["aquamarine"]=8388564;this._colorNames["mediumaquamarine"]=6737322;this._colorNames["darkseagreen"]=9419919;this._colorNames["mediumseagreen"]=3978097;this._colorNames["seagreen"]=3050327;this._colorNames["darkgreen"]=25600;this._colorNames["green"]=32768;this._colorNames["forestgreen"]=2263842;this._colorNames["limegreen"]=3329330;this._colorNames["lime"]=65280;this._colorNames["chartreuse"]=8388352;this._colorNames["lawngreen"]=8190976;this._colorNames["greenyellow"]=11403055;this._colorNames["yellowgreen"]=10145074;this._colorNames["palegreen"]=10025880;this._colorNames["lightgreen"]=9498256;
this._colorNames["springgreen"]=65407;this._colorNames["mediumspringgreen"]=64154;this._colorNames["darkolivegreen"]=5597999;this._colorNames["olivedrab"]=7048739;this._colorNames["olive"]=8421376;this._colorNames["darkkhaki"]=12433259;this._colorNames["darkgoldenrod"]=12092939;this._colorNames["goldenrod"]=14329120;this._colorNames["gold"]=16766720;this._colorNames["yellow"]=16776960;this._colorNames["khaki"]=15787660;this._colorNames["palegoldenrod"]=15657130;this._colorNames["blanchedalmond"]=16772045;this._colorNames["moccasin"]=16770229;this._colorNames["wheat"]=16113331;this._colorNames["navajowhite"]=16768685;this._colorNames["burlywood"]=14596231;this._colorNames["tan"]=13808780;this._colorNames["rosybrown"]=12357519;this._colorNames["sienna"]=10506797;this._colorNames["saddlebrown"]=9127187;this._colorNames["chocolate"]=13789470;this._colorNames["peru"]=13468991;this._colorNames["sandybrown"]=16032864;this._colorNames["darkred"]=9109504;this._colorNames["maroon"]=8388608;this._colorNames["brown"]=10824234;this._colorNames["firebrick"]=11674146;this._colorNames["indianred"]=13458524;this._colorNames["lightcoral"]=15761536;this._colorNames["salmon"]=16416882;this._colorNames["darksalmon"]=15308410;this._colorNames["lightsalmon"]=16752762;this._colorNames["coral"]=16744272;this._colorNames["tomato"]=16737095;this._colorNames["darkorange"]=16747520;this._colorNames["orange"]=16753920;this._colorNames["orangered"]=16729344;this._colorNames["crimson"]=14423100;this._colorNames["red"]=16711680;this._colorNames["deeppink"]=16716947;this._colorNames["fuchsia"]=16711935;this._colorNames["magenta"]=16711935;this._colorNames["hotpink"]=16738740;this._colorNames["lightpink"]=16758465;this._colorNames["pink"]=16761035;this._colorNames["palevioletred"]=14381203;this._colorNames["mediumvioletred"]=13047173;this._colorNames["purple"]=8388736;this._colorNames["darkmagenta"]=9109643;this._colorNames["mediumpurple"]=9662683;this._colorNames["blueviolet"]=9055202;this._colorNames["indigo"]=4915330;this._colorNames["darkviolet"]=9699539;this._colorNames["darkorchid"]=10040012;this._colorNames["mediumorchid"]=12211667;this._colorNames["orchid"]=14315734;this._colorNames["violet"]=15631086;this._colorNames["plum"]=14524637;this._colorNames["thistle"]=14204888;this._colorNames["lavender"]=15132410;this._colorNames["ghostwhite"]=16316671;this._colorNames["aliceblue"]=15792383;this._colorNames["mintcream"]=16121850;this._colorNames["honeydew"]=15794160;this._colorNames["lightgoldenrodyellow"]=16448210;this._colorNames["lemonchiffon"]=16775885;this._colorNames["cornsilk"]=16775388;this._colorNames["lightyellow"]=16777184;this._colorNames["ivory"]=16777200;this._colorNames["floralwhite"]=16775920;this._colorNames["linen"]=16445670;this._colorNames["oldlace"]=16643558;this._colorNames["antiquewhite"]=16444375;this._colorNames["bisque"]=16770244;this._colorNames["peachpuff"]=16767673;this._colorNames["papayawhip"]=16773077;this._colorNames["beige"]=16119260;this._colorNames["seashell"]=16774638;this._colorNames["lavenderblush"]=16773365;this._colorNames["mistyrose"]=16770273;this._colorNames["snow"]=16775930;this._colorNames["white"]=16777215;this._colorNames["whitesmoke"]=16119285;this._colorNames["gainsboro"]=14474460;this._colorNames["lightgrey"]=13882323;this._colorNames["silver"]=12632256;this._colorNames["darkgrey"]=11119017;this._colorNames["grey"]=8421504;this._colorNames["lightslategrey"]=7833753;this._colorNames["slategrey"]=7372944;this._colorNames["dimgrey"]=6908265;this._colorNames["darkslategrey"]=3100495;this._colorNames["black"]=0;this._colorNames["transparent"]=4278190080}if(this._colorNames[t]!=null)return this._colorNames[t];if(t.length==6&&this.isHex(t))return parseInt("0x"+t)}return null};t.color=function(t){var e=this.tryColor(t);if(e==null)throw new o("Can't cast to color: "+t);return e};t.tryClass=function(t){if(this._notClasses[t])return t;var e=this._classes[t];if(e!=null)return e;try{e=window[t];this._classes[t]=e;return e}catch(i){}this._notClasses[t]=true;return t};t.image2D=function(t){if(t==null)return null;if(typeof t=="string")t=this.tryClass(t);if(typeof t=="function"){try{t=new t}catch(e){t=new t(0,0)}}if(t instanceof r)return t;if(t instanceof a)t=t.sampler2D;if(t instanceof s)return t.image2D;throw new o("Can't cast to BitmapImage2D: "+t)};t.bitmapTexture=function(e){if(e==null)return null;if(typeof e=="string")e=this.tryClass(e);if(typeof e=="function"){try{e=new e}catch(i){e=new e(0,0)}}if(e instanceof a)return e;try{var r=t.image2D(e);return new a(r)}catch(i){}throw new o("Can't cast to Single2DTexture: "+e)};t._hexChars="0123456789abcdefABCDEF";t._notClasses=new Object;t._classes=new Object;return t}();e.exports=l},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-core/lib/data/Sampler2D":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/errors/CastError":"awayjs-display/lib/errors/CastError","awayjs-display/lib/textures/Single2DTexture":"awayjs-display/lib/textures/Single2DTexture"}],"awayjs-display/lib/utils/SubGeometryUtils":[function(t,e,i){var r=t("awayjs-core/lib/attributes/AttributesBuffer");var s=t("awayjs-core/lib/attributes/Float2Attributes");var n=t("awayjs-core/lib/attributes/Float3Attributes");var o=t("awayjs-core/lib/attributes/Float4Attributes");var a=t("awayjs-core/lib/attributes/Byte4Attributes");var l=t("awayjs-core/lib/geom/Vector3D");var h=function(){function t(){}t.generateFaceNormals=function(t,e,i,r,s){if(s===void 0){s=0}var n=t.get(r,s);var a=e.get(e.count);if(i==null)i=new o(r+s);else if(i.count<r+s)i.count=r+s;var l=t.dimensions;var h=e.dimensions;var u=i.get(r,s);r*=l;var p=0;var c=0;var f;var _,d,y;var b,m,v;var g,w,j;var P,x,C;var O,D,T;var E,A,S;var M;while(p<r){f=n[p++]*h;_=a[f];b=a[f+1];g=a[f+2];f=n[p++]*h;d=a[f];m=a[f+1];w=a[f+2];f=n[p++]*h;y=a[f];v=a[f+1];j=a[f+2];P=y-_;x=v-b;C=j-g;O=d-_;D=m-b;T=w-g;E=C*D-x*T;A=P*T-C*O;S=x*O-P*D;M=Math.sqrt(E*E+A*A+S*S);u[c++]=E;u[c++]=A;u[c++]=S;u[c++]=M}i.set(u,s);return i};t.generateNormals=function(t,e,i,r){var s=t.get(t.count);var o=e.get(e.count);if(i==null)i=new n(r);var a=t.dimensions;var l=i.dimensions;var h=i.get(i.count);var u=0;var p=i.count*l;while(u<p){h[u++]=0;h[u++]=0;h[u++]=0}u=0;p=t.count*a;var c;var f=0;var _=1;var d=2;while(u<p){c=s[u++]*l;h[c]+=o[f];h[c+1]+=o[_];h[c+2]+=o[d];c=s[u++]*l;h[c]+=o[f];h[c+1]+=o[_];h[c+2]+=o[d];c=s[u++]*l;h[c]+=o[f];h[c+1]+=o[_];h[c+2]+=o[d];f+=4;_+=4;d+=4}u=0;p=i.count*l;var y;var b;var m;var v;while(u<p){y=h[u];b=h[u+1];m=h[u+2];v=1/Math.sqrt(y*y+b*b+m*m);h[u++]=y*v;h[u++]=b*v;h[u++]=m*v}i.set(h);return i};t.generateFaceTangents=function(t,e,i,r,s,o,a){if(o===void 0){o=0}if(a===void 0){a=false}var l=t.get(s,o);var h=e.get(e.count);var u=i.get(i.count);if(r==null)r=new n(s+o);else if(r.count<s+o)r.count=s+o;var p=e.dimensions;var c=i.dimensions;var f=t.dimensions;var _=r.get(s,o);var d=0;var y;var b;var m;var v;var g;var w;var j;var P;var x,C,O;var D,T,E;var A,S,M;var I,N,B;s*=f;while(d<s){y=l[d];b=l[d+1];m=l[d+2];g=u[y*c+1];w=u[b*c+1]-g;j=u[m*c+1]-g;v=y*p;x=h[v];C=h[v+1];O=h[v+2];v=b*p;D=h[v]-x;T=h[v+1]-C;E=h[v+2]-O;v=m*p;A=h[v]-x;S=h[v+1]-C;M=h[v+2]-O;I=j*D-w*A;N=j*T-w*S;B=j*E-w*M;P=1/Math.sqrt(I*I+N*N+B*B);_[d++]=P*I;_[d++]=P*N;_[d++]=P*B}r.set(_,o);return r};t.generateTangents=function(t,e,i,r,s){var o=t.get(t.count);var a=e.get(e.count);var l=i.get(i.count);if(r==null)r=new n(s);var h=t.dimensions;var u=r.dimensions;var p=r.get(r.count);var c=0;var f=r.count*u;while(c<f){p[c++]=0;p[c++]=0;p[c++]=0}var _;var d;var y=0;var b=1;var m=2;var v=3;c=0;f=t.count*h;while(c<f){_=l[v];d=o[c++]*u;p[d++]+=a[y]*_;p[d++]+=a[b]*_;p[d]+=a[m]*_;d=o[c++]*u;p[d++]+=a[y]*_;p[d++]+=a[b]*_;p[d]+=a[m]*_;d=o[c++]*u;p[d++]+=a[y]*_;p[d++]+=a[b]*_;p[d]+=a[m]*_;y+=3;b+=3;m+=3;v+=4}c=0;f=r.count*u;var g;var w;var j;var P;while(c<f){g=p[c];w=p[c+1];j=p[c+2];P=1/Math.sqrt(g*g+w*w+j*j);p[c++]=g*P;p[c++]=w*P;p[c++]=j*P}r.set(p);return r};t.generateUVs=function(t,e,i,r,n){if(n===void 0){n=0}if(e==null)e=new s(i);var o=e.dimensions;var a=e.get(r,n);var l=0;var h=0;var u=r*o;while(l<u){a[l++]=h*.5;a[l++]=1-(h&1);if(++h==3)h=0}e.set(a,n);return e};t.generateColors=function(t,e,i,r,s){if(s===void 0){s=0}if(e==null)e=new a(i);var n=0;var o=new Uint8Array(r*4);while(n<r*4){if(n/4&1){o[n]=255;o[n+1]=255;o[n+2]=255;o[n+3]=255}else{o[n]=255;o[n+1]=255;o[n+2]=255;o[n+3]=255}n+=4}e.set(o,s);return e};t.scaleUVs=function(t,e,i,r,s){if(s===void 0){s=0}if(i.count<r+s)i.count=r+s;var n=i.dimensions;var o=i.get(r,s);var a=0;var l=0;var h=r*n;while(a<h){o[a++]*=t;o[a++]*=e}i.set(o,s)};t.scale=function(t,e,i,r){if(r===void 0){r=0}if(e.count<i+r)e.count=i+r;var s=e.dimensions;var n=e.get(i,r);var o=0;var a=0;var l=i*s;while(o<l){n[o++]*=t;n[o++]*=t;n[o++]*=t}e.set(n,r)};t.applyTransformation=function(t,e,i,r,s,n){if(n===void 0){n=0}var o=e.get(s,n);var a=e.dimensions;var h;var u;if(i){h=i.get(s,n);u=i.dimensions}var p;var c;if(r){p=r.get(s,n);c=r.dimensions}var f;var _;var d;var y=new l;var b;if(i||r){b=t.clone();b.invert();b.transpose()}var m=0;var v=0;var g=0;for(f=0;f<s;++f){_=m+1;d=m+2;y.x=o[m];y.y=o[_];y.z=o[d];y=t.transformVector(y);o[m]=y.x;o[_]=y.y;o[d]=y.z;m+=a;if(h){_=v+1;d=v+2;y.x=h[v];y.y=h[_];y.z=h[d];y=b.deltaTransformVector(y);y.normalize();h[v]=y.x;h[_]=y.y;h[d]=y.z;v+=u}if(p){_=g+1;d=g+2;y.x=p[g];y.y=p[_];y.z=p[d];y=b.deltaTransformVector(y);y.normalize();p[g]=y.x;p[_]=y.y;p[d]=y.z;g+=c}}e.set(o,n);if(i)i.set(h,n);if(r)r.set(p,n)};t.getSubIndices=function(e,i,s,n){if(n===void 0){n=0}var o=e.buffer;var a=e.length;s.length=0;if(a<t.LIMIT_INDICES&&i<t.LIMIT_VERTS)return o;var l;var h=e.get(e.count,n);var u=new Array;var p=t._indexSwap;p.length=a;for(l=0;l<a;l++)p[l]=-1;var c;var f;var _=0;var d=n*e.dimensions;l=0;while(l<a+d&&l+1<t.LIMIT_INDICES&&_+1<t.LIMIT_VERTS){c=h[l];if(p[c]>=0){f=p[c]}else{f=_++;p[c]=f;s[f]=c}u[l++]=f}o=new r(e.size*e.dimensions,u.length/e.dimensions);e=e.clone(o);e.set(u);return o};t.getSubVertices=function(t,e){if(!e.length)return t;var i=t.stride;var s=t.bufferView;var n=new Uint8Array(e.length*i);var o;var a;var l=0;var h=0;var u=e.length;for(l=0;l<u;l++){o=l*i;a=e[l]*i;for(h=0;h<i;h++)n[o+h]=s[a+h]}t=new r(i,u);t.bufferView=n;return t};t.LIMIT_VERTS=65535;t.LIMIT_INDICES=16777215;t._indexSwap=new Array;return t}();e.exports=h},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/attributes/Byte4Attributes":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/attributes/Float4Attributes":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-display/lib/vos/ISubGeometryVO":[function(t,e,i){},{}]},{},[]);


require=function e(t,a,r){function i(n,o){if(!a[n]){if(!t[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(s)return s(n,!0);var u=new Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}var g=a[n]={exports:{}};t[n][0].call(g.exports,function(e){var a=t[n][1][e];return i(a?a:e)},g,g.exports,e,t,a,r)}return a[n].exports}var s=typeof require=="function"&&require;for(var n=0;n<r.length;n++)i(r[n]);return i}({"awayjs-stagegl/lib/aglsl/AGALTokenizer":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/Description");var i=e("awayjs-stagegl/lib/aglsl/Header");var s=e("awayjs-stagegl/lib/aglsl/Mapping");var n=e("awayjs-stagegl/lib/aglsl/Token");var o=function(){function e(){}e.prototype.decribeAGALByteArray=function(e){var t=new i;if(e.readUnsignedByte()!=160){throw"Bad AGAL: Missing 0xa0 magic byte."}t.version=e.readUnsignedInt();if(t.version>=16){e.readUnsignedByte();t.version>>=1}if(e.readUnsignedByte()!=161){throw"Bad AGAL: Missing 0xa1 magic byte."}t.progid=e.readUnsignedByte();switch(t.progid){case 1:t.type="fragment";break;case 0:t.type="vertex";break;case 2:t.type="cpu";break;default:t.type="";break}var a=new r;var o=[];while(e.position<e.length){var l=new n;l.opcode=e.readUnsignedInt();var u=s.agal2glsllut[l.opcode];if(!u){throw"Opcode not valid or not implemented yet: "+l.opcode}if(u.matrixheight){a.hasmatrix=true}if(u.dest){l.dest.regnum=e.readUnsignedShort();l.dest.mask=e.readUnsignedByte();l.dest.regtype=e.readUnsignedByte();a.regwrite[l.dest.regtype][l.dest.regnum]|=l.dest.mask}else{l.dest=null;e.readUnsignedInt()}if(u.a){this.readReg(l.a,1,a,e)}else{l.a=null;e.readUnsignedInt();e.readUnsignedInt()}if(u.b){this.readReg(l.b,u.matrixheight|0,a,e)}else{l.b=null;e.readUnsignedInt();e.readUnsignedInt()}o.push(l)}a.header=t;a.tokens=o;return a};e.prototype.readReg=function(e,t,a,r){e.regnum=r.readUnsignedShort();e.indexoffset=r.readByte();e.swizzle=r.readUnsignedByte();e.regtype=r.readUnsignedByte();a.regread[e.regtype][e.regnum]=15;if(e.regtype==5){e.lodbiad=e.indexoffset;e.indexoffset=undefined;e.swizzle=undefined;e.readmode=r.readUnsignedByte();e.dim=e.readmode>>4;e.readmode&=15;e.special=r.readUnsignedByte();e.wrap=e.special>>4;e.special&=15;e.mipmap=r.readUnsignedByte();e.filter=e.mipmap>>4;e.mipmap&=15;a.samplers[e.regnum]=e}else{e.indexregtype=r.readUnsignedByte();e.indexselect=r.readUnsignedByte();e.indirectflag=r.readUnsignedByte()}if(e.indirectflag){a.hasindirect=true}if(!e.indirectflag&&t){for(var i=0;i<t;i++){a.regread[e.regtype][e.regnum+i]=a.regread[e.regtype][e.regnum]}}};return e}();t.exports=o},{"awayjs-stagegl/lib/aglsl/Description":"awayjs-stagegl/lib/aglsl/Description","awayjs-stagegl/lib/aglsl/Header":"awayjs-stagegl/lib/aglsl/Header","awayjs-stagegl/lib/aglsl/Mapping":"awayjs-stagegl/lib/aglsl/Mapping","awayjs-stagegl/lib/aglsl/Token":"awayjs-stagegl/lib/aglsl/Token"}],"awayjs-stagegl/lib/aglsl/AGLSLParser":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/Mapping");var i=e("awayjs-stagegl/lib/base/ContextStage3D");var s=function(){function e(){}e.prototype.parse=function(e){var t="";var a="";t+="precision highp float;\n";var s=e.header.type[0];if(e.header.type=="vertex"){t+="uniform float yflip;\n"}if(!e.hasindirect){for(var n=0;n<e.regread[1].length;n++){if(e.regread[1][n]){t+="uniform vec4 "+s+"c"+n+";\n"}}}else{t+="uniform vec4 "+s+"carrr["+i.maxvertexconstants+"];\n"}for(var n=0;n<e.regread[2].length||n<e.regwrite[2].length;n++){if(e.regread[2][n]||e.regwrite[2][n]){t+="vec4 "+s+"t"+n+";\n"}}for(var n=0;n<e.regread[0].length;n++){if(e.regread[0][n]){t+="attribute vec4 va"+n+";\n"}}for(var n=0;n<e.regread[4].length||n<e.regwrite[4].length;n++){if(e.regread[4][n]||e.regwrite[4][n]){t+="varying vec4 vi"+n+";\n"}}var o=["2D","Cube","3D",""];for(var n=0;n<e.samplers.length;n++){if(e.samplers[n]){t+="uniform sampler"+o[e.samplers[n].dim&3]+" fs"+n+";\n"}}if(e.header.type=="vertex"){t+="vec4 outpos;\n"}if(e.writedepth){t+="vec4 tmp_FragDepth;\n"}var l=false;a+="void main() {\n";for(var n=0;n<e.tokens.length;n++){var u=r.agal2glsllut[e.tokens[n].opcode];if(u.s.indexOf("dFdx")!=-1||u.s.indexOf("dFdy")!=-1)l=true;if(!u){throw"Opcode not valid or not implemented yet: "}var g=u.matrixheight||1;for(var f=0;f<g;f++){var c="  "+u.s;if(e.tokens[n].dest){if(u.matrixheight){if((e.tokens[n].dest.mask>>f&1)!=1){continue}var h=this.regtostring(e.tokens[n].dest.regtype,e.tokens[n].dest.regnum,e,s);var p="float";var d=["x","y","z","w"][f];h+="."+d}else{var h=this.regtostring(e.tokens[n].dest.regtype,e.tokens[n].dest.regnum,e,s);var p;var d;if(e.tokens[n].dest.mask!=15){var _=0;d="";if(e.tokens[n].dest.mask&1){_++;d+="x"}if(e.tokens[n].dest.mask&2){_++;d+="y"}if(e.tokens[n].dest.mask&4){_++;d+="z"}if(e.tokens[n].dest.mask&8){_++;d+="w"}h+="."+d;switch(_){case 1:p="float";break;case 2:p="vec2";break;case 3:p="vec3";break;default:throw"Unexpected destination mask"}}else{p="vec4";d="xyzw"}}c=c.replace("%dest",h);c=c.replace("%cast",p);c=c.replace("%dm",d)}var b=15;if(!u.ndwm&&u.dest&&e.tokens[n].dest){b=e.tokens[n].dest.mask}if(e.tokens[n].a){c=c.replace("%a",this.sourcetostring(e.tokens[n].a,0,b,u.scalar,e,s))}if(e.tokens[n].b){c=c.replace("%b",this.sourcetostring(e.tokens[n].b,f,b,u.scalar,e,s));if(e.tokens[n].b.regtype==5){var y=["2D","Cube","3D"][e.tokens[n].b.dim];var m=["vec2","vec3","vec3"][e.tokens[n].b.dim];c=c.replace("%texdim",y);c=c.replace("%texsize",m);var w="";c=c.replace("%lod",w)}}a+=c}}if(e.header.type=="vertex"){a+="  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n"}if(l&&e.header.type=="fragment"){t="#extension GL_OES_standard_derivatives : enable\n"+t}if(e.writedepth){a+="  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n"}a+="}\n";console.log(t+a);return t+a};e.prototype.regtostring=function(e,t,a,r){switch(e){case 0:return"va"+t;case 1:if(a.hasindirect&&a.header.type=="vertex"){return"vcarrr["+t+"]"}else{return r+"c"+t}case 2:return r+"t"+t;case 3:return a.header.type=="vertex"?"outpos":"gl_FragColor";case 4:return"vi"+t;case 5:return"fs"+t;case 6:return"tmp_FragDepth";default:throw"Unknown register type"}};e.prototype.sourcetostring=function(e,t,a,r,i,s){var n=["x","y","z","w"];var o;if(e.indirectflag){o="vcarrr[int("+this.regtostring(e.indexregtype,e.regnum,i,s)+"."+n[e.indexselect]+")";var l=t+e.indexoffset;if(l<0)o+=l.toString();if(l>0)o+="+"+l.toString();o+="]"}else{o=this.regtostring(e.regtype,e.regnum+t,i,s)}if(e.regtype==5){return o}if(r){return o+"."+n[e.swizzle>>0&3]}if(e.swizzle==228&&a==15){return o}o+=".";if(a&1)o+=n[e.swizzle>>0&3];if(a&2)o+=n[e.swizzle>>2&3];if(a&4)o+=n[e.swizzle>>4&3];if(a&8)o+=n[e.swizzle>>6&3];return o};return e}();t.exports=s},{"awayjs-stagegl/lib/aglsl/Mapping":"awayjs-stagegl/lib/aglsl/Mapping","awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D"}],"awayjs-stagegl/lib/aglsl/Description":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/Header");var i=function(){function e(){this.regread=[[],[],[],[],[],[],[]];this.regwrite=[[],[],[],[],[],[],[]];this.hasindirect=false;this.writedepth=false;this.hasmatrix=false;this.samplers=[];this.tokens=[];this.header=new r}return e}();t.exports=i},{"awayjs-stagegl/lib/aglsl/Header":"awayjs-stagegl/lib/aglsl/Header"}],"awayjs-stagegl/lib/aglsl/Destination":[function(e,t,a){var r=function(){function e(){this.mask=0;this.regnum=0;this.regtype=0;this.dim=0;this.indexoffset=0;this.swizzle=0;this.lodbiad=0;this.readmode=0;this.special=0;this.wrap=0;this.filter=0;this.indexregtype=0;this.indexselect=0;this.indirectflag=0}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/Header":[function(e,t,a){var r=function(){function e(){this.progid=0;this.version=0;this.type=""}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/Mapping":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/OpLUT");var i=function(){function e(e){}e.agal2glsllut=[new r("%dest = %cast(%a);\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(%a + %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a - %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a * %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(%a / %b);\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(1.0) / %a;\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(min(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(max(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(fract(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(sqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(inversesqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(pow(abs(%a),%b));\n",0,true,true,true,null,null,null,null,null,null),new r("%dest = %cast(log2(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(exp2(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(normalize(vec3( %a ) ));\n",0,true,true,false,null,null,true,null,null,null),new r("%dest = %cast(sin(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(cos(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(cross(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r("%dest = %cast(abs(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(%a * -1.0);\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(clamp(%a,0.0,1.0));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",null,true,true,true,3,3,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,4,true,null,null,null),new r("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,3,true,null,null,null),new r("%dest = %cast(dFdx(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(dFdy(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("if (float(%a)==float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)!=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)>=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("if (float(%a)<float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r("} else {;\n",0,false,false,false,null,null,null,null,null,null),new r("};\n",0,false,false,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r(null,null,null,null,false,null,null,null,null,null,null),new r("%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\n",null,true,true,true,null,null,null,null,true,null),new r("if ( float(%a)<0.0 ) discard;\n",null,false,true,false,null,null,null,true,null,null),new r("%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\n",null,true,true,true,null,null,true,null,true,true),new r("%dest = %cast(greaterThanEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(lessThan(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(sign(%a));\n",0,true,true,false,null,null,null,null,null,null),new r("%dest = %cast(equal(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r("%dest = %cast(notEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null)];return e}();t.exports=i},{"awayjs-stagegl/lib/aglsl/OpLUT":"awayjs-stagegl/lib/aglsl/OpLUT"}],"awayjs-stagegl/lib/aglsl/OpLUT":[function(e,t,a){var r=function(){function e(e,t,a,r,i,s,n,o,l,u,g){this.s=e;this.flags=t;this.dest=a;this.a=r;this.b=i;this.matrixwidth=s;this.matrixheight=n;this.ndwm=o;this.scalar=l;this.dm=u;this.lod=g}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/Sampler":[function(e,t,a){var r=function(){function e(){this.lodbias=0;this.dim=0;this.readmode=0;this.special=0;this.wrap=0;this.mipmap=0;this.filter=0}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/Token":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/Destination");var i=function(){function e(){this.dest=new r;this.opcode=0;this.a=new r;this.b=new r}return e}();t.exports=i},{"awayjs-stagegl/lib/aglsl/Destination":"awayjs-stagegl/lib/aglsl/Destination"}],"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/assembler/OpcodeMap");var i=e("awayjs-stagegl/lib/aglsl/assembler/Part");var s=e("awayjs-stagegl/lib/aglsl/assembler/RegMap");var n=e("awayjs-stagegl/lib/aglsl/assembler/SamplerMap");var o=function(){function e(){this.r={};this.cur=new i}e.prototype.assemble=function(e,t,a){if(t===void 0){t=null}if(a===void 0){a=null}if(!a){a=1}if(t){this.addHeader(t,a)}var r=e.replace(/[\f\n\r\v]+/g,"\n").split("\n");for(var i in r){this.processLine(r[i],i)}return this.r};e.prototype.processLine=function(e,t){var a=e.search("//");if(a!=-1){e=e.slice(0,a)}e=e.replace(/^\s+|\s+$/g,"");if(!(e.length>0)){return}var i=e.search(/<.*>/g);var s=null;if(i!=-1){s=e.slice(i).match(/([\w\.\-\+]+)/gi);e=e.slice(0,i)}var n=e.match(/([\w\.\+\[\]]+)/gi);if(!n||n.length<1){if(e.length>=3){console.log("Warning: bad line "+t+": "+e)}return}switch(n[0]){case"part":this.addHeader(n[1],Number(n[2]));break;case"endpart":if(!this.cur){throw"Unexpected endpart"}this.cur.data.position=0;this.cur=null;return;default:if(!this.cur){console.log("Warning: bad line "+t+": "+e+" (Outside of any part definition)");return}if(this.cur.name=="comment"){return}var o=r.map[n[0]];if(!o){throw"Bad opcode "+n[0]+" "+t+": "+e}this.emitOpcode(this.cur,o.opcode);var l=1;if(o.dest&&o.dest!="none"){if(!this.emitDest(this.cur,n[l++],o.dest)){throw"Bad destination register "+n[l-1]+" "+t+": "+e}}else{this.emitZeroDword(this.cur)}if(o.a&&o.a.format!="none"){if(!this.emitSource(this.cur,n[l++],o.a))throw"Bad source register "+n[l-1]+" "+t+": "+e}else{this.emitZeroQword(this.cur)}if(o.b&&o.b.format!="none"){if(o.b.format=="sampler"){if(!this.emitSampler(this.cur,n[l++],o.b,s)){throw"Bad sampler register "+n[l-1]+" "+t+": "+e}}else{if(!this.emitSource(this.cur,n[l++],o.b)){throw"Bad source register "+n[l-1]+" "+t+": "+e}}}else{this.emitZeroQword(this.cur)}break}};e.prototype.emitHeader=function(e){e.data.writeUnsignedByte(160);e.data.writeUnsignedInt(e.version);if(e.version>=16){e.data.writeUnsignedByte(0)}e.data.writeUnsignedByte(161);switch(e.name){case"fragment":e.data.writeUnsignedByte(1);break;case"vertex":e.data.writeUnsignedByte(0);break;case"cpu":e.data.writeUnsignedByte(2);break;default:e.data.writeUnsignedByte(255);break}};e.prototype.emitOpcode=function(e,t){e.data.writeUnsignedInt(t)};e.prototype.emitZeroDword=function(e){e.data.writeUnsignedInt(0)};e.prototype.emitZeroQword=function(e){e.data.writeUnsignedInt(0);e.data.writeUnsignedInt(0)};e.prototype.emitDest=function(e,t,a){var r=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!s.map[r[1]])return false;var i={num:r[2]?r[2]:0,code:s.map[r[1]].code,mask:this.stringToMask(r[3])};e.data.writeUnsignedShort(i.num);e.data.writeUnsignedByte(i.mask);e.data.writeUnsignedByte(i.code);return true};e.prototype.stringToMask=function(e){if(!e)return 15;var t=0;if(e.indexOf("x")!=-1)t|=1;if(e.indexOf("y")!=-1)t|=2;if(e.indexOf("z")!=-1)t|=4;if(e.indexOf("w")!=-1)t|=8;return t};e.prototype.stringToSwizzle=function(e){if(!e){return 228}var t={x:0,y:1,z:2,w:3};var a=0;if(e.charAt(0)!="."){throw"Missing . for swizzle"}if(e.length>1){a|=t[e.charAt(1)]}if(e.length>2){a|=t[e.charAt(2)]<<2}else{a|=(a&3)<<2}if(e.length>3){a|=t[e.charAt(3)]<<4}else{a|=(a&3<<2)<<2}if(e.length>4){a|=t[e.charAt(4)]<<6}else{a|=(a&3<<4)<<2}return a};e.prototype.emitSampler=function(e,t,a,r){var i=t.match(/fs(\d*)/i);if(!i||!i[1]){return false}e.data.writeUnsignedShort(parseInt(i[1]));e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0);var s=5;var o=0;for(var l=0;l<r.length;l++){var u=n.map[r[l].toLowerCase()];if(u){if((o>>u.shift&u.mask)!=0){console.log("Warning, duplicate sampler option")}o|=u.mask<<u.shift;s&=~(u.mask<<u.shift);s|=u.value<<u.shift}else{console.log("Warning, unknown sampler option: ",r[l])}}e.data.writeUnsignedInt(s);return true};e.prototype.emitSource=function(e,t,a){var r=t.match(/vc\[(v[tcai])(\d+)\.([xyzw])([\+\-]\d+)?\](\.[xyzw]{1,4})?/i);var i;if(r){if(!s.map[r[1]]){return false}var n={x:0,y:1,z:2,w:3};var o={num:r[2]|0,code:s.map[r[1]].code,swizzle:this.stringToSwizzle(r[5]),select:n[r[3]],offset:r[4]|0};e.data.writeUnsignedShort(o.num);e.data.writeByte(o.offset);e.data.writeUnsignedByte(o.swizzle);e.data.writeUnsignedByte(1);e.data.writeUnsignedByte(o.code);e.data.writeUnsignedByte(o.select);e.data.writeUnsignedByte(1<<7)}else{i=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!s.map[i[1]]){return false}var o={num:i[2]|0,code:s.map[i[1]].code,swizzle:this.stringToSwizzle(i[3])};e.data.writeUnsignedShort(o.num);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(o.swizzle);e.data.writeUnsignedByte(o.code);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0)}return true};e.prototype.addHeader=function(e,t){if(!t){t=1}if(this.r[e]==undefined){this.r[e]=new i(e,t);this.emitHeader(this.r[e])}else if(this.r[e].version!=t){throw"Multiple versions for part "+e}this.cur=this.r[e]};return e}();t.exports=o},{"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap","awayjs-stagegl/lib/aglsl/assembler/Part":"awayjs-stagegl/lib/aglsl/assembler/Part","awayjs-stagegl/lib/aglsl/assembler/RegMap":"awayjs-stagegl/lib/aglsl/assembler/RegMap","awayjs-stagegl/lib/aglsl/assembler/SamplerMap":"awayjs-stagegl/lib/aglsl/assembler/SamplerMap"}],"awayjs-stagegl/lib/aglsl/assembler/FS":[function(e,t,a){var r=function(){function e(){}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/assembler/Flags":[function(e,t,a){var r=function(){function e(){}return e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/assembler/Opcode");var i=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["mov"]=new r("vector","vector",4,"none",0,0,true,null,null,null);e._map["add"]=new r("vector","vector",4,"vector",4,1,true,null,null,null);e._map["sub"]=new r("vector","vector",4,"vector",4,2,true,null,null,null);e._map["mul"]=new r("vector","vector",4,"vector",4,3,true,null,null,null);e._map["div"]=new r("vector","vector",4,"vector",4,4,true,null,null,null);e._map["rcp"]=new r("vector","vector",4,"none",0,5,true,null,null,null);e._map["min"]=new r("vector","vector",4,"vector",4,6,true,null,null,null);e._map["max"]=new r("vector","vector",4,"vector",4,7,true,null,null,null);e._map["frc"]=new r("vector","vector",4,"none",0,8,true,null,null,null);e._map["sqt"]=new r("vector","vector",4,"none",0,9,true,null,null,null);e._map["rsq"]=new r("vector","vector",4,"none",0,10,true,null,null,null);e._map["pow"]=new r("vector","vector",4,"vector",4,11,true,null,null,null);e._map["log"]=new r("vector","vector",4,"none",0,12,true,null,null,null);e._map["exp"]=new r("vector","vector",4,"none",0,13,true,null,null,null);e._map["nrm"]=new r("vector","vector",4,"none",0,14,true,null,null,null);e._map["sin"]=new r("vector","vector",4,"none",0,15,true,null,null,null);e._map["cos"]=new r("vector","vector",4,"none",0,16,true,null,null,null);e._map["crs"]=new r("vector","vector",4,"vector",4,17,true,true,null,null);e._map["dp3"]=new r("vector","vector",4,"vector",4,18,true,true,null,null);e._map["dp4"]=new r("vector","vector",4,"vector",4,19,true,true,null,null);e._map["abs"]=new r("vector","vector",4,"none",0,20,true,null,null,null);e._map["neg"]=new r("vector","vector",4,"none",0,21,true,null,null,null);e._map["sat"]=new r("vector","vector",4,"none",0,22,true,null,null,null);e._map["ted"]=new r("vector","vector",4,"sampler",1,38,true,null,true,null);e._map["kil"]=new r("none","scalar",1,"none",0,39,true,null,true,null);e._map["tex"]=new r("vector","vector",4,"sampler",1,40,true,null,true,null);e._map["m33"]=new r("vector","matrix",3,"vector",3,23,true,null,null,true);e._map["m44"]=new r("vector","matrix",4,"vector",4,24,true,null,null,true);e._map["m43"]=new r("vector","matrix",3,"vector",4,25,true,null,null,true);e._map["ddx"]=new r("vector","vector",4,"none",0,26,true,null,true,null);e._map["ddy"]=new r("vector","vector",4,"none",0,27,true,null,true,null);e._map["sge"]=new r("vector","vector",4,"vector",4,41,true,null,null,null);e._map["slt"]=new r("vector","vector",4,"vector",4,42,true,null,null,null);e._map["sgn"]=new r("vector","vector",4,"vector",4,43,true,null,null,null);e._map["seq"]=new r("vector","vector",4,"vector",4,44,true,null,null,null);e._map["sne"]=new r("vector","vector",4,"vector",4,45,true,null,null,null)}return e._map},enumerable:true,configurable:true});return e}();t.exports=i},{"awayjs-stagegl/lib/aglsl/assembler/Opcode":"awayjs-stagegl/lib/aglsl/assembler/Opcode"}],"awayjs-stagegl/lib/aglsl/assembler/Opcode":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/assembler/Flags");var i=e("awayjs-stagegl/lib/aglsl/assembler/FS");var s=function(){function e(e,t,a,s,n,o,l,u,g,f){this.a=new i;this.b=new i;this.flags=new r;this.dest=e;this.a.format=t;this.a.size=a;this.b.format=s;this.b.size=n;this.opcode=o;this.flags.simple=l;this.flags.horizontal=u;this.flags.fragonly=g;this.flags.matrix=f}return e}();t.exports=s},{"awayjs-stagegl/lib/aglsl/assembler/FS":"awayjs-stagegl/lib/aglsl/assembler/FS","awayjs-stagegl/lib/aglsl/assembler/Flags":"awayjs-stagegl/lib/aglsl/assembler/Flags"}],"awayjs-stagegl/lib/aglsl/assembler/Part":[function(e,t,a){var r=e("awayjs-core/lib/utils/ByteArray");var i=function(){function e(e,t){if(e===void 0){e=null}if(t===void 0){t=null}this.name="";this.version=0;this.name=e;this.version=t;this.data=new r}return e}();t.exports=i},{"awayjs-core/lib/utils/ByteArray":undefined}],"awayjs-stagegl/lib/aglsl/assembler/RegMap":[function(e,t,a){var r=function(){function e(e,t){this.code=e;this.desc=t}return e}();var i=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["va"]=new r(0,"vertex attribute");e._map["fc"]=new r(1,"fragment constant");e._map["vc"]=new r(1,"vertex constant");e._map["ft"]=new r(2,"fragment temporary");e._map["vt"]=new r(2,"vertex temporary");e._map["vo"]=new r(3,"vertex output");e._map["op"]=new r(3,"vertex output");e._map["fd"]=new r(3,"fragment depth output");e._map["fo"]=new r(3,"fragment output");e._map["oc"]=new r(3,"fragment output");e._map["v"]=new r(4,"varying");e._map["vi"]=new r(4,"varying output");e._map["fi"]=new r(4,"varying input");e._map["fs"]=new r(5,"sampler")}return e._map},enumerable:true,configurable:true});return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/assembler/Sampler");var i=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["rgba"]=new r(8,15,0);e._map["rg"]=new r(8,15,5);e._map["r"]=new r(8,15,4);e._map["compressed"]=new r(8,15,1);e._map["compressed_alpha"]=new r(8,15,2);e._map["dxt1"]=new r(8,15,1);e._map["dxt5"]=new r(8,15,2);e._map["2d"]=new r(12,15,0);e._map["cube"]=new r(12,15,1);e._map["3d"]=new r(12,15,2);e._map["centroid"]=new r(16,1,1);e._map["ignoresampler"]=new r(16,4,4);e._map["clamp"]=new r(20,15,0);e._map["repeat"]=new r(20,15,1);e._map["wrap"]=new r(20,15,1);e._map["nomip"]=new r(24,15,0);e._map["mipnone"]=new r(24,15,0);e._map["mipnearest"]=new r(24,15,1);e._map["miplinear"]=new r(24,15,2);e._map["nearest"]=new r(28,15,0);e._map["linear"]=new r(28,15,1)}return e._map},enumerable:true,configurable:true});return e}();t.exports=i},{"awayjs-stagegl/lib/aglsl/assembler/Sampler":"awayjs-stagegl/lib/aglsl/assembler/Sampler"}],"awayjs-stagegl/lib/aglsl/assembler/Sampler":[function(e,t,a){var r=function(){function e(e,t,a){this.shift=e;this.mask=t;this.value=a}return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLBlendFactor":[function(e,t,a){var r=function(){function e(){}e.DESTINATION_ALPHA="destinationAlpha";e.DESTINATION_COLOR="destinationColor";e.ONE="one";e.ONE_MINUS_DESTINATION_ALPHA="oneMinusDestinationAlpha";e.ONE_MINUS_DESTINATION_COLOR="oneMinusDestinationColor";e.ONE_MINUS_SOURCE_ALPHA="oneMinusSourceAlpha";e.ONE_MINUS_SOURCE_COLOR="oneMinusSourceColor";e.SOURCE_ALPHA="sourceAlpha";e.SOURCE_COLOR="sourceColor";e.ZERO="zero";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLClearMask":[function(e,t,a){var r=function(){function e(){}e.COLOR=1;e.DEPTH=2;e.STENCIL=4;e.ALL=e.COLOR|e.DEPTH|e.STENCIL;return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLCompareMode":[function(e,t,a){var r=function(){function e(){}e.ALWAYS="always";e.EQUAL="equal";e.GREATER="greater";e.GREATER_EQUAL="greaterEqual";e.LESS="less";e.LESS_EQUAL="lessEqual";e.NEVER="never";e.NOT_EQUAL="notEqual";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLDrawMode":[function(e,t,a){var r=function(){function e(){}e.TRIANGLES="triangles";e.LINES="lines";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLMipFilter":[function(e,t,a){var r=function(){function e(){}e.MIPLINEAR="miplinear";e.MIPNEAREST="mipnearest";e.MIPNONE="mipnone";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLProfile":[function(e,t,a){var r=function(){function e(){}e.BASELINE="baseline";e.BASELINE_CONSTRAINED="baselineConstrained";e.BASELINE_EXTENDED="baselineExtended";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLProgramType":[function(e,t,a){var r=function(){function e(){}e.FRAGMENT=0;e.SAMPLER=1;e.VERTEX=2;return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLStencilAction":[function(e,t,a){var r=function(){function e(){}e.DECREMENT_SATURATE="decrementSaturate";e.DECREMENT_WRAP="decrementWrap";e.INCREMENT_SATURATE="incrementSaturate";e.INCREMENT_WRAP="incrementWrap";e.INVERT="invert";e.KEEP="keep";e.SET="set";e.ZERO="zero";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFilter":[function(e,t,a){var r=function(){function e(){}e.LINEAR="linear";e.NEAREST="nearest";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFormat":[function(e,t,a){var r=function(){function e(){}e.BGRA="bgra";e.BGRA_PACKED="bgraPacked4444";e.BGR_PACKED="bgrPacked565";e.COMPRESSED="compressed";e.COMPRESSED_ALPHA="compressedAlpha";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLTriangleFace":[function(e,t,a){var r=function(){function e(){}e.BACK="back";e.FRONT="front";e.FRONT_AND_BACK="frontAndBack";e.NONE="none";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":[function(e,t,a){var r=function(){function e(){}e.BYTES_4=0;e.FLOAT_1=1;e.FLOAT_2=2;e.FLOAT_3=3;e.FLOAT_4=4;return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextGLWrapMode":[function(e,t,a){var r=function(){function e(){}e.CLAMP="clamp";e.REPEAT="repeat";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextMode":[function(e,t,a){var r=function(){function e(){}e.AUTO="auto";e.WEBGL="webgl";e.FLASH="flash";e.NATIVE="native";e.SOFTWARE="software";return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ContextSoftware":[function(e,t,a){var r=e("awayjs-core/lib/data/BitmapImage2D");var i=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-core/lib/geom/Point");var n=e("awayjs-core/lib/geom/Vector3D");var o=e("awayjs-core/lib/geom/Rectangle");var l=e("awayjs-core/lib/utils/ColorUtils");var u=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var g=e("awayjs-stagegl/lib/base/ContextGLClearMask");var f=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var c=e("awayjs-stagegl/lib/base/ContextGLProgramType");var h=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var p=e("awayjs-stagegl/lib/base/IndexBufferSoftware");var d=e("awayjs-stagegl/lib/base/VertexBufferSoftware");var _=e("awayjs-stagegl/lib/base/TextureSoftware");var b=e("awayjs-stagegl/lib/base/ProgramSoftware");var y=function(){function e(e){this._backBufferRect=new o;this._backBufferWidth=100;this._backBufferHeight=100;this._zbuffer=[];this._cullingMode=h.BACK;this._blendSource=u.ONE;this._blendDestination=u.ZERO;this._colorMaskR=true;this._colorMaskG=true;this._colorMaskB=true;this._colorMaskA=true;this._writeDepth=true;this._depthCompareMode=f.LESS;this._screenMatrix=new i;this._bboxMin=new s;this._bboxMax=new s;this._clamp=new s;this._drawRect=new o;this._textures=[];this._vertexBuffers=[];this._vertexBufferOffsets=[];this._vertexBufferFormats=[];this._fragmentConstants=[];this._vertexConstants=[];this._canvas=e;this._context=this._canvas.getContext("2d");this._backBufferColor=new r(this._backBufferWidth,this._backBufferHeight,false,0,false);document.body.appendChild(this._backBufferColor.getCanvas())}Object.defineProperty(e.prototype,"container",{get:function(){return this._canvas},enumerable:true,configurable:true});e.prototype.clear=function(e,t,a,r,i,s,n){if(e===void 0){e=0}if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=1}if(i===void 0){i=1}if(s===void 0){s=0}if(n===void 0){n=g.ALL}if(n&g.COLOR){this._backBufferColor.fillRect(this._backBufferRect,l.ARGBtoFloat32(r,e,t,a))}if(n&g.DEPTH){this._zbuffer.length=0;var o=this._backBufferWidth*this._backBufferHeight;for(var u=0;u<o;u++){this._zbuffer[u]=1e7}}};e.prototype.configureBackBuffer=function(e,t,a,r){console.log("configureBackBuffer");this._backBufferWidth=e;this._backBufferHeight=t;this._backBufferRect.width=e;this._backBufferRect.height=t;this._backBufferColor._setSize(e,t);var i=this._screenMatrix.rawData;i[0]=this._backBufferWidth/2;i[1]=0;i[2]=0;i[3]=this._backBufferWidth/2;i[4]=0;i[5]=-this._backBufferHeight/2;i[6]=0;i[7]=this._backBufferHeight/2;i[8]=0;i[9]=0;i[10]=1;i[11]=0;i[12]=0;i[13]=0;i[14]=0;i[15]=0;this._screenMatrix.transpose()};e.prototype.createCubeTexture=function(e,t,a,r){return undefined};e.prototype.createIndexBuffer=function(e){return new p(e)};e.prototype.createProgram=function(){return new b};e.prototype.createTexture=function(e,t,a,r,i){return new _(e,t)};e.prototype.createVertexBuffer=function(e,t){return new d(e,t)};e.prototype.dispose=function(){};e.prototype.setBlendFactors=function(e,t){console.log("setBlendFactors sourceFactor: "+e+" destinationFactor: "+t);this._blendSource=e;this._blendDestination=t};e.prototype.setColorMask=function(e,t,a,r){this._colorMaskR=e;this._colorMaskG=t;this._colorMaskB=a;this._colorMaskA=r};e.prototype.setStencilActions=function(e,t,a,r,i,s){};e.prototype.setStencilReferenceValue=function(e,t,a){};e.prototype.setCulling=function(e,t){this._cullingMode=e};e.prototype.setDepthTest=function(e,t){this._writeDepth=e;this._depthCompareMode=t};e.prototype.setProgram=function(e){this._program=e};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,r){console.log("setProgramConstantsFromMatrix: programType"+e+" firstRegister: "+t+" matrix: "+a+" transposedMatrix: "+r);if(r){var i=a.clone();i.transpose();a=i}var s;if(e==c.VERTEX){s=this._vertexConstants}else if(e==c.FRAGMENT){s=this._fragmentConstants}var o=a.rawData;for(var l=t;l<t+4;l++){s[l]=new n(o[l*4],o[l*4+1],o[l*4+2],o[l*4+3])}};e.prototype.setProgramConstantsFromArray=function(e,t,a,r){console.log("setProgramConstantsFromArray: programType"+e+" firstRegister: "+t+" data: "+a+" numRegisters: "+r);var i;if(e==c.VERTEX){i=this._vertexConstants}else if(e==c.FRAGMENT){i=this._fragmentConstants}var s=0;for(var o=t;o<t+r;o++){i[o]=new n(a[s++],a[s++],a[s++],a[s++])}};e.prototype.setTextureAt=function(e,t){console.log("setTextureAt sample: "+e+" texture: "+t);
this._textures[e]=t};e.prototype.setVertexBufferAt=function(e,t,a,r){console.log("setVertexBufferAt index: "+e+" buffer: "+t+" bufferOffset: "+a+" format: "+r);this._vertexBuffers[e]=t;this._vertexBufferOffsets[e]=a;this._vertexBufferFormats[e]=r};e.prototype.present=function(){};e.prototype.drawToBitmapImage2D=function(e){};e.prototype.drawIndices=function(e,t,a,r){console.log("drawIndices mode: "+e+" firstIndex: "+a+" numIndices: "+r);if(!this._program){return}this._backBufferColor.lock();for(var i=a;i<r;i+=3){var s=t.data[t.startOffset+i];var n=t.data[t.startOffset+i+1];var o=t.data[t.startOffset+i+2];var l=this._program.vertex(this,s);var u=this._program.vertex(this,n);var g=this._program.vertex(this,o);this.triangle(l,u,g)}this._backBufferColor.unlock()};e.prototype.drawVertices=function(e,t,a){console.log("drawVertices")};e.prototype.setScissorRectangle=function(e){};e.prototype.setSamplerStateAt=function(e,t,a,r){};e.prototype.setRenderToTexture=function(e,t,a,r){};e.prototype.setRenderToBackBuffer=function(){};e.prototype.putPixel=function(e,t,a){this._drawRect.x=e;this._drawRect.y=t;this._drawRect.width=1;this._drawRect.height=1;var r=l.float32ColorToARGB(this._backBufferColor.getPixel32(e,t));var i=l.float32ColorToARGB(a);var s=this.applyBlendMode(r,this._blendDestination,r,i);var n=this.applyBlendMode(i,this._blendSource,r,i);var o=s[0]+n[0];var u=s[1]+n[1];var g=s[2]+n[2];var f=s[3]+n[3];o=Math.max(0,Math.min(o,255));u=Math.max(0,Math.min(u,255));g=Math.max(0,Math.min(g,255));f=Math.max(0,Math.min(f,255));this._backBufferColor.setPixel32(e,t,l.ARGBtoFloat32(o,u,g,f))};e.prototype.applyBlendMode=function(e,t,a,r){var i=[];i[0]=e[0];i[1]=e[1];i[2]=e[2];i[3]=e[3];if(t==u.DESTINATION_ALPHA){i[0]*=a[0];i[1]*=a[0];i[2]*=a[0];i[3]*=a[0]}else if(t==u.DESTINATION_COLOR){i[0]*=a[0];i[1]*=a[1];i[2]*=a[2];i[3]*=a[3]}else if(t==u.ZERO){i[0]=0;i[1]=0;i[2]=0;i[3]=0}else if(t==u.ONE_MINUS_DESTINATION_ALPHA){i[0]*=1-a[0];i[1]*=1-a[0];i[2]*=1-a[0];i[3]*=1-a[0]}else if(t==u.ONE_MINUS_DESTINATION_COLOR){i[0]*=1-a[0];i[1]*=1-a[1];i[2]*=1-a[2];i[3]*=1-a[3]}else if(t==u.ONE_MINUS_SOURCE_ALPHA){i[0]*=1-r[0];i[1]*=1-r[0];i[2]*=1-r[0];i[3]*=1-r[0]}else if(t==u.ONE_MINUS_SOURCE_COLOR){i[0]*=1-r[0];i[1]*=1-r[1];i[2]*=1-r[2];i[3]*=1-r[3]}else if(t==u.SOURCE_ALPHA){i[0]*=r[0];i[1]*=r[0];i[2]*=r[0];i[3]*=r[0]}else if(t==u.SOURCE_COLOR){i[0]*=r[0];i[1]*=r[1];i[2]*=r[2];i[3]*=r[3]}return i};e.prototype.drawRect=function(e,t,a){this._drawRect.x=e;this._drawRect.y=t;this._drawRect.width=5;this._drawRect.height=5;this._backBufferColor.fillRect(this._drawRect,a)};e.prototype.clamp=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=1}return Math.max(t,Math.min(e,a))};e.prototype.interpolate=function(e,t,a){return e+(t-e)*this.clamp(a)};e.prototype.triangle=function(e,t,a){var r=e.outputPosition[0];if(!r||r.w==0||isNaN(r.w)){console.error("wrong position");return}var i=t.outputPosition[0];var s=a.outputPosition[0];r.z=r.z*2-r.w;i.z=i.z*2-i.w;s.z=s.z*2-s.w;r.scaleBy(1/r.w);i.scaleBy(1/i.w);s.scaleBy(1/s.w);var o=new n(r.z,i.z,s.z);var u=new n(r.w,i.w,s.w);r=this._screenMatrix.transformVector(r);i=this._screenMatrix.transformVector(i);s=this._screenMatrix.transformVector(s);this._bboxMin.x=1e6;this._bboxMin.y=1e6;this._bboxMax.x=-1e6;this._bboxMax.y=-1e6;this._clamp.x=this._backBufferWidth-1;this._clamp.y=this._backBufferHeight-1;this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,r.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,r.y));this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,i.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,i.y));this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,s.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,s.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,r.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,r.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,i.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,i.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,s.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,s.y));this._bboxMin.x=Math.floor(this._bboxMin.x);this._bboxMin.y=Math.floor(this._bboxMin.y);this._bboxMax.x=Math.floor(this._bboxMax.x);this._bboxMax.y=Math.floor(this._bboxMax.y);for(var g=this._bboxMin.x;g<=this._bboxMax.x;g++){for(var c=this._bboxMin.y;c<=this._bboxMax.y;c++){var h=this.barycentric(r,i,s,g,c);var p=new n(h.x/u.x,h.y/u.y,h.z/u.z);var d=p.x+p.y+p.z;p.scaleBy(1/d);var _=g%this._backBufferWidth+c*this._backBufferWidth;var b=o.x*h.x+o.y*h.y+o.z*h.z;if(h.x<0||h.y<0||h.z<0){continue}var y=this._zbuffer[_];var m=false;switch(this._depthCompareMode){case f.ALWAYS:m=true;break;case f.EQUAL:m=b==y;break;case f.GREATER:m=b>y;break;case f.GREATER_EQUAL:m=b>=y;break;case f.LESS:m=b<y;break;case f.LESS_EQUAL:m=b<=y;break;case f.NEVER:m=false;break;case f.NOT_EQUAL:m=b!=y;break;default:}if(!m){continue}var w=this._program.fragment(this,p,e,t,a);if(w.discard){continue}if(this._writeDepth){this._zbuffer[_]=b}var v=w.outputColor[0];v.x=Math.max(0,Math.min(v.x,1));v.y=Math.max(0,Math.min(v.y,1));v.z=Math.max(0,Math.min(v.z,1));v.w=Math.max(0,Math.min(v.w,1));v.x*=255;v.y*=255;v.z*=255;v.w*=255;if(v){this.putPixel(g,c,l.ARGBtoFloat32(v.w,v.x,v.y,v.z))}else{this.putPixel(g,c,4294901760)}}}};e.prototype.barycentric=function(e,t,a,r,i){var s=new n;s.x=a.x-e.x;s.y=t.x-e.x;s.z=e.x-r;var o=new n;o.x=a.y-e.y;o.y=t.y-e.y;o.z=e.y-i;var l=s.crossProduct(o);if(l.z<.01){return new n(1-(l.x+l.y)/l.z,l.y/l.z,l.x/l.z)}return new n(-1,1,1)};e.MAX_SAMPLERS=8;return e}();var m=function(){function e(e,t,a){this.size=e;this.type=t;this.normalized=a}return e}();t.exports=y},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/utils/ColorUtils":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":"awayjs-stagegl/lib/base/ContextGLBlendFactor","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLCompareMode":"awayjs-stagegl/lib/base/ContextGLCompareMode","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/ContextGLTriangleFace":"awayjs-stagegl/lib/base/ContextGLTriangleFace","awayjs-stagegl/lib/base/IndexBufferSoftware":"awayjs-stagegl/lib/base/IndexBufferSoftware","awayjs-stagegl/lib/base/ProgramSoftware":"awayjs-stagegl/lib/base/ProgramSoftware","awayjs-stagegl/lib/base/TextureSoftware":"awayjs-stagegl/lib/base/TextureSoftware","awayjs-stagegl/lib/base/VertexBufferSoftware":"awayjs-stagegl/lib/base/VertexBufferSoftware"}],"awayjs-stagegl/lib/base/ContextStage3D":[function(e,t,a){var r=e("awayjs-core/lib/geom/Matrix3DUtils");var i=e("awayjs-stagegl/lib/aglsl/Sampler");var s=e("awayjs-stagegl/lib/base/ContextGLClearMask");var n=e("awayjs-stagegl/lib/base/ContextGLProgramType");var o=e("awayjs-stagegl/lib/base/CubeTextureFlash");var l=e("awayjs-stagegl/lib/base/IndexBufferFlash");var u=e("awayjs-stagegl/lib/base/OpCodes");var g=e("awayjs-stagegl/lib/base/ProgramFlash");var f=e("awayjs-stagegl/lib/base/TextureFlash");var c=e("awayjs-stagegl/lib/base/VertexBufferFlash");var h=function(){function e(t,a,r){this._cmdStream="";this._resources=new Array;var i="11.0.0";var s={id:t.id};var n={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"sameDomain",allowfullscreen:"true",wmode:"direct"};this._errorCheckingEnabled=false;this._iDriverInfo="Unknown";var o={salign:"tl",id:t.id,name:t["name"]};this._oldCanvas=t.cloneNode();this._oldParent=t.parentNode;var l=this;e.contexts[t.id]=this;function u(e){if(!e.success)return;l._container=e.ref;l._iCallback=a}}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"driverInfo",{get:function(){return this._iDriverInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"errorCheckingEnabled",{get:function(){return this._errorCheckingEnabled},set:function(e){if(this._errorCheckingEnabled==e)return;this._errorCheckingEnabled=e;this.addStream(String.fromCharCode(u.enableErrorChecking,e?u.trueValue:u.falseValue));this.execute()},enumerable:true,configurable:true});e.prototype._iAddResource=function(e){this._resources.push(e)};e.prototype._iRemoveResource=function(e){this._resources.splice(this._resources.indexOf(e))};e.prototype.createTexture=function(e,t,a,r,i){if(i===void 0){i=0}return new f(this,e,t,a,r)};e.prototype.createCubeTexture=function(e,t,a,r){if(r===void 0){r=0}return new o(this,e,t,a)};e.prototype.setTextureAt=function(t,a){if(a){this.addStream(String.fromCharCode(u.setTextureAt)+t+","+a.id+",")}else{this.addStream(String.fromCharCode(u.clearTextureAt)+t.toString()+",")}if(e.debug)this.execute()};e.prototype.setSamplerStateAt=function(e,t,a,r){};e.prototype.setStencilActions=function(t,a,r,i,s,n){if(t===void 0){t="frontAndBack"}if(a===void 0){a="always"}if(r===void 0){r="keep"}if(i===void 0){i="keep"}if(s===void 0){s="keep"}if(n===void 0){n="leftHanded"}this.addStream(String.fromCharCode(u.setStencilActions)+t+"$"+a+"$"+r+"$"+i+"$"+s+"$");if(e.debug)this.execute()};e.prototype.setStencilReferenceValue=function(t,a,r){if(a===void 0){a=255}if(r===void 0){r=255}this.addStream(String.fromCharCode(u.setStencilReferenceValue,t+u.intMask,a+u.intMask,r+u.intMask));if(e.debug)this.execute()};e.prototype.setCulling=function(t,a){if(a===void 0){a="leftHanded"}this.addStream(String.fromCharCode(u.setCulling)+t+"$");if(e.debug)this.execute()};e.prototype.drawIndices=function(t,a,r,i){if(r===void 0){r=0}if(i===void 0){i=-1}r=r||0;if(!i||i<0)i=a.numIndices;this.addStream(String.fromCharCode(u.drawTriangles,a.id+u.intMask)+r+","+i+",");if(e.debug)this.execute()};e.prototype.drawVertices=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=-1}};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,i){if(i===void 0){i=false}var s=a.rawData;if(i){var n=r.RAW_DATA_CONTAINER;n[0]=s[0];n[1]=s[4];n[2]=s[8];n[3]=s[12];n[4]=s[1];n[5]=s[5];n[6]=s[9];n[7]=s[13];n[8]=s[2];n[9]=s[6];n[10]=s[10];n[11]=s[14];n[12]=s[3];n[13]=s[7];n[14]=s[11];n[15]=s[15];this.setProgramConstantsFromArray(e,t,n,4)}else{this.setProgramConstantsFromArray(e,t,s,4)}};e.prototype.setProgramConstantsFromArray=function(t,a,r,i){if(i===void 0){i=-1}var s;var o=t==n.VERTEX?u.trueValue:u.falseValue;for(var l=0;l<i;l++){s=l*4;this.addStream(String.fromCharCode(u.setProgramConstant,o,a+l+u.intMask)+r[s]+","+r[s+1]+","+r[s+2]+","+r[s+3]+",");if(e.debug)this.execute()}};e.prototype.setProgram=function(t){this.addStream(String.fromCharCode(u.setProgram,t.id+u.intMask));if(e.debug)this.execute()};e.prototype.present=function(){this.addStream(String.fromCharCode(u.present));this.execute()};e.prototype.clear=function(t,a,r,i,n,o,l){if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=0}if(i===void 0){i=1}if(n===void 0){n=1}if(o===void 0){o=0}if(l===void 0){l=s.ALL}this.addStream(String.fromCharCode(u.clear)+t+","+a+","+r+","+i+","+n+","+o+","+l+",");if(e.debug)this.execute()};e.prototype.createProgram=function(){return new g(this)};e.prototype.createVertexBuffer=function(e,t){return new c(this,e,t)};e.prototype.createIndexBuffer=function(e){return new l(this,e)};e.prototype.configureBackBuffer=function(e,t,a,r){if(r===void 0){r=true}this._width=e;this._height=t;this.addStream(String.fromCharCode(u.configureBackBuffer)+e+","+t+",")};e.prototype.drawToBitmapImage2D=function(e){};e.prototype.setVertexBufferAt=function(t,a,r,i){if(r===void 0){r=0}if(i===void 0){i=null}if(a){this.addStream(String.fromCharCode(u.setVertexBufferAt,t+u.intMask)+a.id+","+r+","+i+"$")}else{this.addStream(String.fromCharCode(u.clearVertexBufferAt,t+u.intMask))}if(e.debug)this.execute()};e.prototype.setColorMask=function(t,a,r,i){this.addStream(String.fromCharCode(u.setColorMask,t?u.trueValue:u.falseValue,a?u.trueValue:u.falseValue,r?u.trueValue:u.falseValue,i?u.trueValue:u.falseValue));if(e.debug)this.execute()};e.prototype.setBlendFactors=function(t,a){this.addStream(String.fromCharCode(u.setBlendFactors)+t+"$"+a+"$");if(e.debug)this.execute()};e.prototype.setRenderToTexture=function(t,a,r,i){if(a===void 0){a=false}if(r===void 0){r=0}if(i===void 0){i=0}if(t===null||t===undefined){this.addStream(String.fromCharCode(u.clearRenderToTexture))}else{this.addStream(String.fromCharCode(u.setRenderToTexture,a?u.trueValue:u.falseValue)+t.id+","+(r||0)+",")}if(e.debug)this.execute()};e.prototype.setRenderToBackBuffer=function(){this.addStream(String.fromCharCode(u.clearRenderToTexture));if(e.debug)this.execute()};e.prototype.setScissorRectangle=function(t){if(t){this.addStream(String.fromCharCode(u.setScissorRect)+t.x+","+t.y+","+t.width+","+t.height+",")}else{this.addStream(String.fromCharCode(u.clearScissorRect))}if(e.debug)this.execute()};e.prototype.setDepthTest=function(t,a){this.addStream(String.fromCharCode(u.setDepthTest,t?u.trueValue:u.falseValue)+a+"$");if(e.debug)this.execute()};e.prototype.dispose=function(){if(this._container==null)return;console.log("Context3D dispose, releasing "+this._resources.length+" resources.");while(this._resources.length)this._resources[0].dispose();if(this._container){this.addStream(String.fromCharCode(u.disposeContext));this.execute();if(this._oldCanvas&&this._oldParent){this._oldParent.appendChild(this._oldCanvas);this._oldParent=null}this._container=null}this._oldCanvas=null};e.prototype.addStream=function(e){this._cmdStream+=e};e.prototype.execute=function(){if(e.logStream)console.log(this._cmdStream);var t=this._container["CallFunction"]('<invoke name="execStage3dOpStream" returntype="javascript"><arguments><string>'+this._cmdStream+"</string></arguments></invoke>");if(Number(t)<=-3)throw"Exec stream failed";this._cmdStream="";return Number(t)};e.contexts=new Object;e.maxvertexconstants=128;e.maxfragconstants=28;e.maxtemp=8;e.maxstreams=8;e.maxtextures=8;e.defaultsampler=new i;e.debug=false;e.logStream=false;return e}();function p(e,t){var a=h.contexts[e];if(a._iCallback){a._iDriverInfo=t;var r=window.setTimeout(function(){window.clearTimeout(r);try{a._iCallback(a)}catch(e){console.log("Callback failed during flash initialization with '"+e.toString()+"'")}},1)}}t.exports=h},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-stagegl/lib/aglsl/Sampler":"awayjs-stagegl/lib/aglsl/Sampler","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/CubeTextureFlash":"awayjs-stagegl/lib/base/CubeTextureFlash","awayjs-stagegl/lib/base/IndexBufferFlash":"awayjs-stagegl/lib/base/IndexBufferFlash","awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ProgramFlash":"awayjs-stagegl/lib/base/ProgramFlash","awayjs-stagegl/lib/base/TextureFlash":"awayjs-stagegl/lib/base/TextureFlash","awayjs-stagegl/lib/base/VertexBufferFlash":"awayjs-stagegl/lib/base/VertexBufferFlash"}],"awayjs-stagegl/lib/base/ContextWebGL":[function(e,t,a){var r=e("awayjs-core/lib/geom/Matrix3DUtils");var i=e("awayjs-core/lib/geom/Rectangle");var s=e("awayjs-core/lib/utils/ByteArray");var n=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var o=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var l=e("awayjs-stagegl/lib/base/ContextGLClearMask");var u=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var g=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var f=e("awayjs-stagegl/lib/base/ContextGLProgramType");var c=e("awayjs-stagegl/lib/base/ContextGLStencilAction");var h=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var p=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var d=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var _=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var b=e("awayjs-stagegl/lib/base/CubeTextureWebGL");var y=e("awayjs-stagegl/lib/base/IndexBufferWebGL");var m=e("awayjs-stagegl/lib/base/ProgramWebGL");var w=e("awayjs-stagegl/lib/base/TextureWebGL");var v=e("awayjs-stagegl/lib/base/SamplerState");var x=e("awayjs-stagegl/lib/base/VertexBufferWebGL");var T=function(){function e(t){this._blendFactorDictionary=new Object;this._drawModeDictionary=new Object;this._compareModeDictionary=new Object;this._stencilActionDictionary=new Object;this._textureIndexDictionary=new Array(8);this._textureTypeDictionary=new Object;this._wrapDictionary=new Object;this._filterDictionary=new Object;this._mipmapFilterDictionary=new Object;this._vertexBufferPropertiesDictionary=[];this._indexBufferList=new Array;this._vertexBufferList=new Array;this._textureList=new Array;this._programList=new Array;this._samplerStates=new Array(8);this._stencilReferenceValue=0;this._stencilReadMask=255;this._separateStencil=false;this._container=t;try{this._gl=t.getContext("experimental-webgl",{premultipliedAlpha:false,alpha:false,stencil:true});if(!this._gl)this._gl=t.getContext("webgl",{premultipliedAlpha:false,alpha:false,stencil:true})}catch(a){}if(this._gl){if(this._gl.getExtension("OES_standard_derivatives")){this._standardDerivatives=true}else{this._standardDerivatives=false}this._blendFactorDictionary[n.ONE]=this._gl.ONE;this._blendFactorDictionary[n.DESTINATION_ALPHA]=this._gl.DST_ALPHA;this._blendFactorDictionary[n.DESTINATION_COLOR]=this._gl.DST_COLOR;this._blendFactorDictionary[n.ONE]=this._gl.ONE;this._blendFactorDictionary[n.ONE_MINUS_DESTINATION_ALPHA]=this._gl.ONE_MINUS_DST_ALPHA;this._blendFactorDictionary[n.ONE_MINUS_DESTINATION_COLOR]=this._gl.ONE_MINUS_DST_COLOR;this._blendFactorDictionary[n.ONE_MINUS_SOURCE_ALPHA]=this._gl.ONE_MINUS_SRC_ALPHA;this._blendFactorDictionary[n.ONE_MINUS_SOURCE_COLOR]=this._gl.ONE_MINUS_SRC_COLOR;this._blendFactorDictionary[n.SOURCE_ALPHA]=this._gl.SRC_ALPHA;this._blendFactorDictionary[n.SOURCE_COLOR]=this._gl.SRC_COLOR;this._blendFactorDictionary[n.ZERO]=this._gl.ZERO;this._drawModeDictionary[o.LINES]=this._gl.LINES;this._drawModeDictionary[o.TRIANGLES]=this._gl.TRIANGLES;this._compareModeDictionary[u.ALWAYS]=this._gl.ALWAYS;this._compareModeDictionary[u.EQUAL]=this._gl.EQUAL;this._compareModeDictionary[u.GREATER]=this._gl.GREATER;this._compareModeDictionary[u.GREATER_EQUAL]=this._gl.GEQUAL;this._compareModeDictionary[u.LESS]=this._gl.LESS;this._compareModeDictionary[u.LESS_EQUAL]=this._gl.LEQUAL;this._compareModeDictionary[u.NEVER]=this._gl.NEVER;this._compareModeDictionary[u.NOT_EQUAL]=this._gl.NOTEQUAL;this._stencilActionDictionary[c.DECREMENT_SATURATE]=this._gl.DECR;this._stencilActionDictionary[c.DECREMENT_WRAP]=this._gl.DECR_WRAP;this._stencilActionDictionary[c.INCREMENT_SATURATE]=this._gl.INCR;this._stencilActionDictionary[c.INCREMENT_WRAP]=this._gl.INCR_WRAP;this._stencilActionDictionary[c.INVERT]=this._gl.INVERT;this._stencilActionDictionary[c.KEEP]=this._gl.KEEP;this._stencilActionDictionary[c.SET]=this._gl.REPLACE;this._stencilActionDictionary[c.ZERO]=this._gl.ZERO;this._textureIndexDictionary[0]=this._gl.TEXTURE0;this._textureIndexDictionary[1]=this._gl.TEXTURE1;this._textureIndexDictionary[2]=this._gl.TEXTURE2;this._textureIndexDictionary[3]=this._gl.TEXTURE3;this._textureIndexDictionary[4]=this._gl.TEXTURE4;this._textureIndexDictionary[5]=this._gl.TEXTURE5;this._textureIndexDictionary[6]=this._gl.TEXTURE6;this._textureIndexDictionary[7]=this._gl.TEXTURE7;this._textureTypeDictionary["texture2d"]=this._gl.TEXTURE_2D;this._textureTypeDictionary["textureCube"]=this._gl.TEXTURE_CUBE_MAP;this._wrapDictionary[_.REPEAT]=this._gl.REPEAT;this._wrapDictionary[_.CLAMP]=this._gl.CLAMP_TO_EDGE;this._filterDictionary[h.LINEAR]=this._gl.LINEAR;this._filterDictionary[h.NEAREST]=this._gl.NEAREST;this._mipmapFilterDictionary[h.LINEAR]=new Object;this._mipmapFilterDictionary[h.LINEAR][g.MIPNEAREST]=this._gl.LINEAR_MIPMAP_NEAREST;this._mipmapFilterDictionary[h.LINEAR][g.MIPLINEAR]=this._gl.LINEAR_MIPMAP_LINEAR;this._mipmapFilterDictionary[h.LINEAR][g.MIPNONE]=this._gl.LINEAR;this._mipmapFilterDictionary[h.NEAREST]=new Object;this._mipmapFilterDictionary[h.NEAREST][g.MIPNEAREST]=this._gl.NEAREST_MIPMAP_NEAREST;this._mipmapFilterDictionary[h.NEAREST][g.MIPLINEAR]=this._gl.NEAREST_MIPMAP_LINEAR;this._mipmapFilterDictionary[h.NEAREST][g.MIPNONE]=this._gl.NEAREST;this._vertexBufferPropertiesDictionary[d.FLOAT_1]=new S(1,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[d.FLOAT_2]=new S(2,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[d.FLOAT_3]=new S(3,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[d.FLOAT_4]=new S(4,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[d.BYTES_4]=new S(4,this._gl.UNSIGNED_BYTE,true);this._stencilCompareMode=this._gl.ALWAYS;this._stencilCompareModeBack=this._gl.ALWAYS;this._stencilCompareModeFront=this._gl.ALWAYS}else{alert("WebGL is not available.")}for(var r=0;r<e.MAX_SAMPLERS;++r){this._samplerStates[r]=new v;this._samplerStates[r].wrap=this._gl.REPEAT;this._samplerStates[r].filter=this._gl.LINEAR;this._samplerStates[r].mipfilter=this._gl.LINEAR}}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"standardDerivatives",{get:function(){return this._standardDerivatives},enumerable:true,configurable:true});e.prototype.gl=function(){return this._gl};e.prototype.clear=function(e,t,a,r,i,s,n){if(e===void 0){e=0}if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=1}if(i===void 0){i=1}if(s===void 0){s=0}if(n===void 0){n=l.ALL}if(!this._drawing){this.updateBlendStatus();this._drawing=true}var o=0;if(n&l.COLOR)o|=this._gl.COLOR_BUFFER_BIT;if(n&l.STENCIL)o|=this._gl.STENCIL_BUFFER_BIT;if(n&l.DEPTH)o|=this._gl.DEPTH_BUFFER_BIT;this._gl.clearColor(e,t,a,r);this._gl.clearDepth(i);this._gl.clearStencil(s);this._gl.clear(o)};e.prototype.configureBackBuffer=function(e,t,a,r){if(r===void 0){r=true}this._width=e;this._height=t;if(r){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport["width"]=e;this._gl.viewport["height"]=t;this._gl.viewport(0,0,e,t)};e.prototype.createCubeTexture=function(e,t,a,r){if(r===void 0){r=0}var i=new b(this._gl,e);this._textureList.push(i);return i};e.prototype.createIndexBuffer=function(e){var t=new y(this._gl,e);this._indexBufferList.push(t);return t};e.prototype.createProgram=function(){var e=new m(this._gl);this._programList.push(e);return e};e.prototype.createTexture=function(e,t,a,r,i){if(i===void 0){i=0}var s=new w(this._gl,e,t);this._textureList.push(s);return s};e.prototype.createVertexBuffer=function(e,t){var a=new x(this._gl,e,t);this._vertexBufferList.push(a);return a};e.prototype.dispose=function(){var e;for(e=0;e<this._indexBufferList.length;++e)this._indexBufferList[e].dispose();this._indexBufferList=null;for(e=0;e<this._vertexBufferList.length;++e)this._vertexBufferList[e].dispose();this._vertexBufferList=null;for(e=0;e<this._textureList.length;++e)this._textureList[e].dispose();this._textureList=null;for(e=0;e<this._programList.length;++e)this._programList[e].dispose();for(e=0;e<this._samplerStates.length;++e)this._samplerStates[e]=null;this._programList=null};e.prototype.drawToBitmapImage2D=function(e){var t=new ArrayBuffer(e.width*e.height*4);this._gl.readPixels(0,0,e.width,e.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,new Uint8Array(t));var a=new s;a.setArrayBuffer(t);e.setPixels(new i(0,0,e.width,e.height),a)};e.prototype.drawIndices=function(e,t,a,r){if(a===void 0){a=0}if(r===void 0){r=-1}if(!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t.glBuffer);this._gl.drawElements(this._drawModeDictionary[e],r==-1?t.numIndices:r,this._gl.UNSIGNED_SHORT,a*2)};e.prototype.drawVertices=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=-1}if(!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.drawArrays(this._drawModeDictionary[e],t,a)};e.prototype.present=function(){this._drawing=false};e.prototype.setBlendFactors=function(e,t){this._blendEnabled=true;this._blendSourceFactor=this._blendFactorDictionary[e];this._blendDestinationFactor=this._blendFactorDictionary[t];this.updateBlendStatus()};e.prototype.setColorMask=function(e,t,a,r){this._gl.colorMask(e,t,a,r)};e.prototype.setCulling=function(e,t){if(t===void 0){t="leftHanded"}if(e==p.NONE){this._gl.disable(this._gl.CULL_FACE)}else{this._gl.enable(this._gl.CULL_FACE);this._gl.cullFace(this.translateTriangleFace(e,t))}};e.prototype.setDepthTest=function(e,t){this._gl.depthFunc(this._compareModeDictionary[t]);this._gl.depthMask(e)};e.prototype.setStencilActions=function(e,t,a,r,i,s){if(e===void 0){e="frontAndBack"}if(t===void 0){t="always"}if(a===void 0){a="keep"}if(r===void 0){r="keep"}if(i===void 0){i="keep"}if(s===void 0){s="leftHanded"}this._separateStencil=e!="frontAndBack";var n=this._compareModeDictionary[t];var o=this._stencilActionDictionary[i];var l=this._stencilActionDictionary[r];var u=this._stencilActionDictionary[a];if(!this._separateStencil){this._stencilCompareMode=n;this._gl.stencilFunc(n,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOp(o,l,u)}else if(e=="back"){this._stencilCompareModeBack=n;this._gl.stencilFuncSeparate(this._gl.BACK,n,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOpSeparate(this._gl.BACK,o,l,u)}else if(e=="front"){this._stencilCompareModeFront=n;this._gl.stencilFuncSeparate(this._gl.FRONT,n,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOpSeparate(this._gl.FRONT,o,l,u)}};e.prototype.setStencilReferenceValue=function(e,t,a){this._stencilReferenceValue=e;this._stencilReadMask=t;if(this._separateStencil){this._gl.stencilFuncSeparate(this._gl.FRONT,this._stencilCompareModeFront,e,t);this._gl.stencilFuncSeparate(this._gl.BACK,this._stencilCompareModeBack,e,t)}else{this._gl.stencilFunc(this._stencilCompareMode,e,t)}this._gl.stencilMask(a)};e.prototype.setProgram=function(e){this._currentProgram=e;e.focusProgram()};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,i){if(i===void 0){i=false}var s=a.rawData;if(i){var n=r.RAW_DATA_CONTAINER;n[0]=s[0];n[1]=s[4];n[2]=s[8];n[3]=s[12];n[4]=s[1];n[5]=s[5];n[6]=s[9];n[7]=s[13];n[8]=s[2];n[9]=s[6];n[10]=s[10];n[11]=s[14];n[12]=s[3];n[13]=s[7];n[14]=s[11];n[15]=s[15];this.setProgramConstantsFromArray(e,t,n,4)}else{this.setProgramConstantsFromArray(e,t,s,4)}};e.prototype.setProgramConstantsFromArray=function(e,t,a,r){if(r===void 0){r=-1}var i;for(var s=0;s<r;s++){i=s*4;this._gl.uniform4f(this._currentProgram.getUniformLocation(e,t+s),a[i],a[i+1],a[i+2],a[i+3])}};e.prototype.setScissorRectangle=function(e){if(!e){this._gl.disable(this._gl.SCISSOR_TEST);return}this._gl.enable(this._gl.SCISSOR_TEST);this._gl.scissor(e.x,e.y,e.width,e.height)};e.prototype.setTextureAt=function(e,t){var a=this._samplerStates[e];if(this._activeTexture!=e&&(t||a.type)){this._activeTexture=e;this._gl.activeTexture(this._textureIndexDictionary[e])}if(!t){if(a.type){this._gl.bindTexture(a.type,null);a.type=null}return}var r=this._textureTypeDictionary[t.textureType];a.type=r;this._gl.bindTexture(r,t.glTexture);this._gl.uniform1i(this._currentProgram.getUniformLocation(f.SAMPLER,e),e);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_S,a.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_T,a.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_MAG_FILTER,a.filter);this._gl.texParameteri(r,this._gl.TEXTURE_MIN_FILTER,a.mipfilter)};e.prototype.setSamplerStateAt=function(t,a,r,i){if(0<=t&&t<e.MAX_SAMPLERS){this._samplerStates[t].wrap=this._wrapDictionary[a];this._samplerStates[t].filter=this._filterDictionary[r];this._samplerStates[t].mipfilter=this._mipmapFilterDictionary[r][i]}else{throw"Sampler is out of bounds."}};e.prototype.setVertexBufferAt=function(e,t,a,r){if(a===void 0){a=0}if(r===void 0){r=4}var i=this._currentProgram?this._currentProgram.getAttribLocation(e):-1;if(!t){if(i>-1)this._gl.disableVertexAttribArray(i);return}if(this._currentArrayBuffer!=t){this._currentArrayBuffer=t;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t?t.glBuffer:null)}var s=this._vertexBufferPropertiesDictionary[r];this._gl.enableVertexAttribArray(i);this._gl.vertexAttribPointer(i,s.size,s.type,s.normalized,t.dataPerVertex,a)};e.prototype.setRenderToTexture=function(e,t,a,r){if(t===void 0){t=false}if(a===void 0){a=0}if(r===void 0){r=0}var i=e;var s=i.frameBuffer;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,s);if(t){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport(0,0,i.width,i.height)};e.prototype.setRenderToBackBuffer=function(){this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)};e.prototype.updateBlendStatus=function(){if(this._blendEnabled){this._gl.enable(this._gl.BLEND);this._gl.blendEquation(this._gl.FUNC_ADD);this._gl.blendFunc(this._blendSourceFactor,this._blendDestinationFactor)}else{this._gl.disable(this._gl.BLEND)}};e.prototype.translateTriangleFace=function(e,t){switch(e){case p.BACK:return t=="leftHanded"?this._gl.FRONT:this._gl.BACK;break;case p.FRONT:return t=="leftHanded"?this._gl.BACK:this._gl.FRONT;break;case p.FRONT_AND_BACK:return this._gl.FRONT_AND_BACK;break;default:throw"Unknown ContextGLTriangleFace type."}};e.MAX_SAMPLERS=8;e._float4=new Float32Array(4);e.modulo=0;return e}();var S=function(){function e(e,t,a){this.size=e;this.type=t;this.normalized=a}return e}();t.exports=T},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":"awayjs-stagegl/lib/base/ContextGLBlendFactor","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLCompareMode":"awayjs-stagegl/lib/base/ContextGLCompareMode","awayjs-stagegl/lib/base/ContextGLDrawMode":"awayjs-stagegl/lib/base/ContextGLDrawMode","awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/ContextGLStencilAction":"awayjs-stagegl/lib/base/ContextGLStencilAction","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLTriangleFace":"awayjs-stagegl/lib/base/ContextGLTriangleFace","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/CubeTextureWebGL":"awayjs-stagegl/lib/base/CubeTextureWebGL","awayjs-stagegl/lib/base/IndexBufferWebGL":"awayjs-stagegl/lib/base/IndexBufferWebGL","awayjs-stagegl/lib/base/ProgramWebGL":"awayjs-stagegl/lib/base/ProgramWebGL","awayjs-stagegl/lib/base/SamplerState":"awayjs-stagegl/lib/base/SamplerState","awayjs-stagegl/lib/base/TextureWebGL":"awayjs-stagegl/lib/base/TextureWebGL","awayjs-stagegl/lib/base/VertexBufferWebGL":"awayjs-stagegl/lib/base/VertexBufferWebGL"}],"awayjs-stagegl/lib/base/CubeTextureFlash":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/utils/ByteArrayBase");var s=e("awayjs-stagegl/lib/base/OpCodes");var n=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var o=function(e){r(t,e);function t(t,a,r,i,n){if(n===void 0){n=false}e.call(this);this._context=t;this._size=a;this._context.addStream(String.fromCharCode(s.initCubeTexture,i?s.trueValue:s.falseValue)+a+","+n+","+r+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});
t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.disposeCubeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};t.prototype.uploadFromData=function(e,t,a){if(a===void 0){a=0}if(e instanceof HTMLImageElement){var r=document.createElement("canvas");var n=e.width;var o=e.height;r.width=n;r.height=o;var l=r.getContext("2d");l.drawImage(e,0,0);e=l.getImageData(0,0,n,o).data}var u=0;var g=i.internalGetBase64String(e.length,function(){return e[u++]},null);this._context.addStream(String.fromCharCode(s.uploadBytesCubeTexture)+this._pId+","+a+","+t+","+(this.size>>a)+","+g+"%");this._context.execute()};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}};return t}(n);t.exports=o},{"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/CubeTextureWebGL":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/base/TextureBaseWebGL");var s=function(e){r(t,e);function t(t,a){e.call(this,t);this._textureSelectorDictionary=new Array(6);this.textureType="textureCube";this._size=a;this._texture=this._gl.createTexture();this._textureSelectorDictionary[0]=t.TEXTURE_CUBE_MAP_POSITIVE_X;this._textureSelectorDictionary[1]=t.TEXTURE_CUBE_MAP_NEGATIVE_X;this._textureSelectorDictionary[2]=t.TEXTURE_CUBE_MAP_POSITIVE_Y;this._textureSelectorDictionary[3]=t.TEXTURE_CUBE_MAP_NEGATIVE_Y;this._textureSelectorDictionary[4]=t.TEXTURE_CUBE_MAP_POSITIVE_Z;this._textureSelectorDictionary[5]=t.TEXTURE_CUBE_MAP_NEGATIVE_Z}t.prototype.dispose=function(){this._gl.deleteTexture(this._texture)};t.prototype.uploadFromData=function(e,t,a){if(a===void 0){a=0}this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._texture);this._gl.texImage2D(this._textureSelectorDictionary[t],a,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}};Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._texture},enumerable:true,configurable:true});return t}(i);t.exports=s},{"awayjs-stagegl/lib/base/TextureBaseWebGL":"awayjs-stagegl/lib/base/TextureBaseWebGL"}],"awayjs-stagegl/lib/base/IContextGL":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/ICubeTexture":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/IIndexBuffer":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/IProgram":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/ITextureBase":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/ITexture":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/IVertexBuffer":[function(e,t,a){},{}],"awayjs-stagegl/lib/base/IndexBufferFlash":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/base/OpCodes");var s=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(e){r(t,e);function t(t,a){e.call(this);this._context=t;this._numIndices=a;this._context.addStream(String.fromCharCode(i.initIndexBuffer,a+i.intMask));this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.uploadFromArray=function(e,t,a){this._context.addStream(String.fromCharCode(i.uploadArrayIndexBuffer,this._pId+i.intMask)+e.join()+"#"+t+","+a+",");this._context.execute()};t.prototype.uploadFromByteArray=function(e,t,a){};t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(i.disposeIndexBuffer,this._pId+i.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});return t}(s);t.exports=n},{"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/IndexBufferSoftware":[function(e,t,a){var r=function(){function e(e){this._numIndices=e}e.prototype.uploadFromArray=function(e,t,a){this._startOffset=t*2;this._data=new Uint16Array(e)};e.prototype.uploadFromByteArray=function(e,t,a){this._startOffset=t*2;this._data=new Uint16Array(e)};e.prototype.dispose=function(){this._data.length=0};Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:true,configurable:true});return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/IndexBufferWebGL":[function(e,t,a){var r=function(){function e(e,t){this._gl=e;this._buffer=this._gl.createBuffer();this._numIndices=t}e.prototype.uploadFromArray=function(e,t,a){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,t*2,new Uint16Array(e));else this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this._gl.STATIC_DRAW)};e.prototype.uploadFromByteArray=function(e,t,a){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,t*2,e);else this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,e,this._gl.STATIC_DRAW)};e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/OpCodes":[function(e,t,a){var r=function(){function e(){}e.trueValue=32;e.falseValue=33;e.intMask=63;e.drawTriangles=41;e.setProgramConstant=42;e.setProgram=43;e.present=44;e.clear=45;e.initProgram=46;e.initVertexBuffer=47;e.initIndexBuffer=48;e.configureBackBuffer=49;e.uploadArrayIndexBuffer=50;e.uploadArrayVertexBuffer=51;e.uploadAGALBytesProgram=52;e.setVertexBufferAt=53;e.uploadBytesIndexBuffer=54;e.uploadBytesVertexBuffer=55;e.setColorMask=56;e.setDepthTest=57;e.disposeProgram=58;e.disposeContext=59;e.disposeVertexBuffer=61;e.disposeIndexBuffer=63;e.initTexture=64;e.setTextureAt=65;e.uploadBytesTexture=66;e.disposeTexture=67;e.setCulling=68;e.setScissorRect=69;e.clearScissorRect=70;e.setBlendFactors=71;e.setRenderToTexture=72;e.clearTextureAt=73;e.clearVertexBufferAt=74;e.setStencilActions=75;e.setStencilReferenceValue=76;e.initCubeTexture=77;e.disposeCubeTexture=78;e.uploadBytesCubeTexture=79;e.clearRenderToTexture=80;e.enableErrorChecking=81;return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ProgramFlash":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/base/ContextStage3D");var s=e("awayjs-stagegl/lib/base/OpCodes");var n=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var o=function(e){r(t,e);function t(t){e.call(this);this._context=t;this._context.addStream(String.fromCharCode(s.initProgram));this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.upload=function(e,t){this._context.addStream(String.fromCharCode(s.uploadAGALBytesProgram,this._pId+s.intMask)+e.readBase64String(e.length)+"%"+t.readBase64String(t.length)+"%");if(i.debug)this._context.execute()};t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.disposeProgram,this._pId+s.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return t}(n);t.exports=o},{"awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D","awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/ProgramSoftware":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/AGALTokenizer");var i=e("awayjs-stagegl/lib/base/ProgramVOSoftware");var s=e("awayjs-core/lib/geom/Matrix3D");var n=e("awayjs-core/lib/geom/Vector3D");var o=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var l=function(){function e(){}e.prototype.upload=function(t,a){this._vertexDescr=e._tokenizer.decribeAGALByteArray(t);this._fragmentDescr=e._tokenizer.decribeAGALByteArray(a)};e.prototype.dispose=function(){this._vertexDescr=null;this._fragmentDescr=null};e.prototype.vertex=function(t,a){var r=new i;var s;for(s=0;s<t._vertexBuffers.length;s++){var l=t._vertexBuffers[s];if(!l)continue;var u=new n(0,0,0,1);var g=t._vertexBufferOffsets[s]/4+a*l.attributesPerVertex;if(t._vertexBufferFormats[s]==o.FLOAT_1){u.x=l.data[g]}if(t._vertexBufferFormats[s]==o.FLOAT_2){u.x=l.data[g];u.y=l.data[g+1]}if(t._vertexBufferFormats[s]==o.FLOAT_3){u.x=l.data[g];u.y=l.data[g+1];u.z=l.data[g+2]}if(t._vertexBufferFormats[s]==o.FLOAT_4){u.x=l.data[g];u.y=l.data[g+1];u.z=l.data[g+2];u.w=l.data[g+3]}r.attributes[s]=u}var f=this._vertexDescr.tokens.length;for(var s=0;s<f;s++){var c=this._vertexDescr.tokens[s];e._opCodeFunc[c.opcode](r,this._vertexDescr,c.dest,c.a,c.b,t)}return r};e.prototype.fragment=function(t,a,r,s,o){var l=new i;for(var u=0;u<r.varying.length;u++){var g=r.varying[u];var f=s.varying[u];var c=o.varying[u];if(!g||!f||!c)continue;var h=l.varying[u]=new n(0,0,0,1);h.x=a.x*g.x+a.y*f.x+a.z*c.x;h.y=a.x*g.y+a.y*f.y+a.z*c.y;h.z=a.x*g.z+a.y*f.z+a.z*c.z;h.w=a.x*g.w+a.y*f.w+a.z*c.w}var p=this._fragmentDescr.tokens.length;for(var u=0;u<p;u++){var d=this._fragmentDescr.tokens[u];e._opCodeFunc[d.opcode](l,this._fragmentDescr,d.dest,d.a,d.b,t)}return l};e.getDestTarget=function(e,t,a){var r;if(a.regtype==2){r=e.temp}else if(a.regtype==3){if(t.header.type=="vertex"){r=e.outputPosition}else{r=e.outputColor}}else if(a.regtype==4){r=e.varying}var i=a.regnum;var s=r[i];if(!s){s=r[i]=new n(0,0,0,1)}return s};e.getSourceTargetType=function(e,t,a,r){var i;if(a.regtype==0){i=e.attributes}else if(a.regtype==1){if(t.header.type=="vertex"){i=r._vertexConstants}else{i=r._fragmentConstants}}else if(a.regtype==2){i=e.temp}else if(a.regtype==4){i=e.varying}return i};e.getSourceTargetByIndex=function(e,t){var a=e[t];if(!a){a=e[t]=new n(0,0,0,1)}return a};e.getSourceTarget=function(t,a,r,i){var s=e.getSourceTargetType(t,a,r,i);return e.getSourceTargetByIndex(s,r.regnum)};e.mov=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=l[u[i.swizzle>>0&3]]}if(r.mask&2){o.y=l[u[i.swizzle>>2&3]]}if(r.mask&4){o.z=l[u[i.swizzle>>4&3]]}if(r.mask&8){o.w=l[u[i.swizzle>>6&3]]}};e.m44=function(t,a,r,i,n,o){var l=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,i,o);var g=e.getSourceTargetType(t,a,n,o);var f=e.getSourceTargetByIndex(g,n.regnum);var c=e.getSourceTargetByIndex(g,n.regnum+1);var h=e.getSourceTargetByIndex(g,n.regnum+2);var p=e.getSourceTargetByIndex(g,n.regnum+3);var d=new s(new Float32Array([f.x,c.x,h.x,p.x,f.y,c.y,h.y,p.y,f.z,c.z,h.z,p.z,f.w,c.w,h.w,p.w]));var _=d.transformVector(u);if(r.mask&1){l.x=_.x}if(r.mask&2){l.y=_.y}if(r.mask&4){l.z=_.z}if(r.mask&8){l.w=_.w}};e.sample=function(e,t,a,r){if(r===void 0){r=0}if(r<e._textures.length&&e._textures[r]!=null){var i=e._textures[r];var s=Math.abs(t*i.width%i.width)>>0;var n=Math.abs(a*i.height%i.height)>>0;var o=(s+n*i.width)*4;var l=i.data[o]/255;var u=i.data[o+1]/255;var g=i.data[o+2]/255;var f=i.data[o+3]/255;return[f,l,u,g]}return[1,t,a,0]};e.tex=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];var g=l[u[i.swizzle>>0&3]];var f=l[u[i.swizzle>>2&3]];var c=e.sample(n,g,f,s.regnum);if(r.mask&1){o.x=c[1]}if(r.mask&2){o.y=c[2]}if(r.mask&4){o.z=c[3]}if(r.mask&8){o.w=c[0]}};e.add=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=l[g[i.swizzle>>0&3]]+u[g[s.swizzle>>0&3]]}if(r.mask&2){o.y=l[g[i.swizzle>>2&3]]+u[g[s.swizzle>>2&3]]}if(r.mask&4){o.z=l[g[i.swizzle>>4&3]]+u[g[s.swizzle>>4&3]]}if(r.mask&8){o.w=l[g[i.swizzle>>6&3]]+u[g[s.swizzle>>6&3]]}};e.sub=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=l[g[i.swizzle>>0&3]]-u[g[s.swizzle>>0&3]]}if(r.mask&2){o.y=l[g[i.swizzle>>2&3]]-u[g[s.swizzle>>2&3]]}if(r.mask&4){o.z=l[g[i.swizzle>>4&3]]-u[g[s.swizzle>>4&3]]}if(r.mask&8){o.w=l[g[i.swizzle>>6&3]]-u[g[s.swizzle>>6&3]]}};e.mul=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=l[g[i.swizzle>>0&3]]*u[g[s.swizzle>>0&3]]}if(r.mask&2){o.y=l[g[i.swizzle>>2&3]]*u[g[s.swizzle>>2&3]]}if(r.mask&4){o.z=l[g[i.swizzle>>4&3]]*u[g[s.swizzle>>4&3]]}if(r.mask&8){o.w=l[g[i.swizzle>>6&3]]*u[g[s.swizzle>>6&3]]}};e.div=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=l[g[i.swizzle>>0&3]]/u[g[s.swizzle>>0&3]]}if(r.mask&2){o.y=l[g[i.swizzle>>2&3]]/u[g[s.swizzle>>2&3]]}if(r.mask&4){o.z=l[g[i.swizzle>>4&3]]/u[g[s.swizzle>>4&3]]}if(r.mask&8){o.w=l[g[i.swizzle>>6&3]]/u[g[s.swizzle>>6&3]]}};e.rcp=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=1/l[u[i.swizzle>>0&3]]}if(r.mask&2){o.y=1/l[u[i.swizzle>>2&3]]}if(r.mask&4){o.z=1/l[u[i.swizzle>>4&3]]}if(r.mask&8){o.w=1/l[u[i.swizzle>>6&3]]}};e.min=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=Math.min(l[g[i.swizzle>>0&3]],u[g[s.swizzle>>0&3]])}if(r.mask&2){o.y=Math.min(l[g[i.swizzle>>2&3]],u[g[s.swizzle>>2&3]])}if(r.mask&4){o.z=Math.min(l[g[i.swizzle>>4&3]],u[g[s.swizzle>>4&3]])}if(r.mask&8){o.w=Math.min(l[g[i.swizzle>>6&3]],u[g[s.swizzle>>6&3]])}};e.max=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=Math.max(l[g[i.swizzle>>0&3]],u[g[s.swizzle>>0&3]])}if(r.mask&2){o.y=Math.max(l[g[i.swizzle>>2&3]],u[g[s.swizzle>>2&3]])}if(r.mask&4){o.z=Math.max(l[g[i.swizzle>>4&3]],u[g[s.swizzle>>4&3]])}if(r.mask&8){o.w=Math.max(l[g[i.swizzle>>6&3]],u[g[s.swizzle>>6&3]])}};e.frc=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=l[u[i.swizzle>>0&3]]-Math.floor(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=l[u[i.swizzle>>2&3]]-Math.floor(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=l[u[i.swizzle>>4&3]]-Math.floor(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=l[u[i.swizzle>>6&3]]-Math.floor(l[u[i.swizzle>>6&3]])}};e.sqt=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.sqrt(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=Math.sqrt(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=Math.sqrt(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=Math.sqrt(l[u[i.swizzle>>6&3]])}};e.rsq=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=1/Math.sqrt(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=1/Math.sqrt(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=1/Math.sqrt(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=1/Math.sqrt(l[u[i.swizzle>>6&3]])}};e.pow=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=e.getSourceTarget(t,a,s,n);var g=["x","y","z","w"];if(r.mask&1){o.x=Math.pow(l[g[i.swizzle>>0&3]],u[g[s.swizzle>>0&3]])}if(r.mask&2){o.y=Math.pow(l[g[i.swizzle>>2&3]],u[g[s.swizzle>>2&3]])}if(r.mask&4){o.z=Math.pow(l[g[i.swizzle>>4&3]],u[g[s.swizzle>>4&3]])}if(r.mask&8){o.w=Math.pow(l[g[i.swizzle>>6&3]],u[g[s.swizzle>>6&3]])}};e.log=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.log(l[u[i.swizzle>>0&3]])/Math.LN2}if(r.mask&2){o.y=Math.log(l[u[i.swizzle>>2&3]])/Math.LN2}if(r.mask&4){o.z=Math.log(l[u[i.swizzle>>4&3]])/Math.LN2}if(r.mask&8){o.w=Math.log(l[u[i.swizzle>>6&3]])/Math.LN2}};e.exp=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.exp(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=Math.exp(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=Math.exp(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=Math.exp(l[u[i.swizzle>>6&3]])}};e.nrm=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];var g=l[u[i.swizzle>>0&3]];var f=l[u[i.swizzle>>2&3]];var c=l[u[i.swizzle>>4&3]];var h=Math.sqrt(g*g+f*f+c*c);g/=h;f/=h;c/=h;if(r.mask&1){o.x=g}if(r.mask&2){o.y=f}if(r.mask&4){o.z=c}};e.sin=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.sin(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=Math.sin(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=Math.sin(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=Math.sin(l[u[i.swizzle>>6&3]])}};e.cos=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.cos(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=Math.cos(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=Math.cos(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=Math.cos(l[u[i.swizzle>>6&3]])}};e.crs=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=e.getSourceTarget(t,a,s,n);var p=h[l[s.swizzle>>0&3]];var d=h[l[s.swizzle>>2&3]];var _=h[l[s.swizzle>>4&3]];if(r.mask&1){o.x=f*_-c*d}if(r.mask&2){o.y=c*p-g*_}if(r.mask&4){o.z=g*d-f*p}};e.dp3=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=e.getSourceTarget(t,a,s,n);var p=h[l[s.swizzle>>0&3]];var d=h[l[s.swizzle>>2&3]];var _=h[l[s.swizzle>>4&3]];if(r.mask&1){o.x=g*p+f*d+c*_}if(r.mask&2){o.y=g*p+f*d+c*_}if(r.mask&4){o.z=g*p+f*d+c*_}if(r.mask&8){o.w=g*p+f*d+c*_}};e.dp4=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];var p=e.getSourceTarget(t,a,s,n);var d=p[l[s.swizzle>>0&3]];var _=p[l[s.swizzle>>2&3]];var b=p[l[s.swizzle>>4&3]];var y=p[l[s.swizzle>>6&3]];if(r.mask&1){o.x=g*d+f*_+c*b+h*y}if(r.mask&2){o.y=g*d+f*_+c*b+h*y}if(r.mask&4){o.z=g*d+f*_+c*b+h*y}if(r.mask&8){o.w=g*d+f*_+c*b+h*y}};e.abs=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.abs(l[u[i.swizzle>>0&3]])}if(r.mask&2){o.y=Math.abs(l[u[i.swizzle>>2&3]])}if(r.mask&4){o.z=Math.abs(l[u[i.swizzle>>4&3]])}if(r.mask&8){o.w=Math.abs(l[u[i.swizzle>>6&3]])}};e.neg=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=-l[u[i.swizzle>>0&3]]}if(r.mask&2){o.y=-l[u[i.swizzle>>2&3]]}if(r.mask&4){o.z=-l[u[i.swizzle>>4&3]]}if(r.mask&8){o.w=-l[u[i.swizzle>>6&3]]}};e.sat=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=e.getSourceTarget(t,a,i,n);var u=["x","y","z","w"];if(r.mask&1){o.x=Math.max(0,Math.min(1,l[u[i.swizzle>>0&3]]))}if(r.mask&2){o.y=Math.max(0,Math.min(1,l[u[i.swizzle>>2&3]]))}if(r.mask&4){o.z=Math.max(0,Math.min(1,l[u[i.swizzle>>4&3]]))}if(r.mask&8){o.w=Math.max(0,Math.min(1,l[u[i.swizzle>>6&3]]))}};e.m33=function(t,a,r,i,n,o){var l=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,i,o);var g=e.getSourceTargetType(t,a,n,o);var f=e.getSourceTargetByIndex(g,n.regnum);var c=e.getSourceTargetByIndex(g,n.regnum+1);var h=e.getSourceTargetByIndex(g,n.regnum+2);var p=new s(new Float32Array([f.x,c.x,h.x,0,f.y,c.y,h.y,0,f.z,c.z,h.z,0,0,0,0,0]));var d=p.transformVector(u);if(r.mask&1){l.x=d.x}if(r.mask&2){l.y=d.y}if(r.mask&4){l.z=d.z}};e.m34=function(t,a,r,i,n,o){var l=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,i,o);var g=e.getSourceTargetType(t,a,n,o);var f=e.getSourceTargetByIndex(g,n.regnum);var c=e.getSourceTargetByIndex(g,n.regnum+1);var h=e.getSourceTargetByIndex(g,n.regnum+2);var p=new s(new Float32Array([f.x,c.x,h.x,0,f.y,c.y,h.y,0,f.z,c.z,h.z,0,f.w,c.w,h.w,1]));var d=p.transformVector(u);if(r.mask&1){l.x=d.x}if(r.mask&2){l.y=d.y}if(r.mask&4){l.z=d.z}if(r.mask&8){l.w=d.w}};e.sge=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];var p=e.getSourceTarget(t,a,s,n);var d=p[l[s.swizzle>>0&3]];var _=p[l[s.swizzle>>2&3]];var b=p[l[s.swizzle>>4&3]];var y=p[l[s.swizzle>>6&3]];if(r.mask&1){o.x=g>=d?1:0}if(r.mask&2){o.y=f>=_?1:0}if(r.mask&4){o.z=c>=b?1:0}if(r.mask&8){o.w=h>=y?1:0}};e.slt=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];var p=e.getSourceTarget(t,a,s,n);var d=p[l[s.swizzle>>0&3]];var _=p[l[s.swizzle>>2&3]];var b=p[l[s.swizzle>>4&3]];var y=p[l[s.swizzle>>6&3]];if(r.mask&1){o.x=g<d?1:0}if(r.mask&2){o.y=f<_?1:0}if(r.mask&4){o.z=c<b?1:0}if(r.mask&8){o.w=h<y?1:0}};e.seq=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];var p=e.getSourceTarget(t,a,s,n);var d=p[l[s.swizzle>>0&3]];var _=p[l[s.swizzle>>2&3]];var b=p[l[s.swizzle>>4&3]];var y=p[l[s.swizzle>>6&3]];if(r.mask&1){o.x=g==d?1:0}if(r.mask&2){o.y=f==_?1:0}if(r.mask&4){o.z=c==b?1:0}if(r.mask&8){o.w=h==y?1:0}};e.sne=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];var p=e.getSourceTarget(t,a,s,n);var d=p[l[s.swizzle>>0&3]];var _=p[l[s.swizzle>>2&3]];var b=p[l[s.swizzle>>4&3]];var y=p[l[s.swizzle>>6&3]];if(r.mask&1){o.x=g!=d?1:0}if(r.mask&2){o.y=f!=_?1:0}if(r.mask&4){o.z=c!=b?1:0}if(r.mask&8){o.w=h!=y?1:0}};e.sgn=function(t,a,r,i,s,n){var o=e.getDestTarget(t,a,r);var l=["x","y","z","w"];var u=e.getSourceTarget(t,a,i,n);var g=u[l[i.swizzle>>0&3]];var f=u[l[i.swizzle>>2&3]];var c=u[l[i.swizzle>>4&3]];var h=u[l[i.swizzle>>6&3]];if(r.mask&1){o.x=1;if(g<0){o.x=-1}else if(g==0){o.x=0}}if(r.mask&2){o.y=1;if(f<0){o.y=-1}else if(f==0){o.y=0}}if(r.mask&4){o.z=1;if(c<0){o.z=-1}else if(c==0){o.z=0}}if(r.mask&8){o.w=1;if(h<0){o.w=-1}else if(h==0){o.w=0}}};e.kil=function(e,t,a,r,i,s){e.discard=true};e._tokenizer=new r;e._opCodeFunc=[e.mov,e.add,e.sub,e.mul,e.div,e.rcp,e.min,e.max,e.frc,e.sqt,e.rsq,e.pow,e.log,e.exp,e.nrm,e.sin,e.cos,e.crs,e.dp3,e.dp4,e.abs,e.neg,e.sat,e.m33,e.m44,e.m34,null,null,null,null,null,null,null,null,null,null,null,null,null,e.kil,e.tex,e.sge,e.slt,e.sgn,e.seq,e.sne];return e}();t.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-stagegl/lib/aglsl/AGALTokenizer":"awayjs-stagegl/lib/aglsl/AGALTokenizer","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ProgramVOSoftware":"awayjs-stagegl/lib/base/ProgramVOSoftware"}],"awayjs-stagegl/lib/base/ProgramVOSoftware":[function(e,t,a){var r=function(){function e(){this.outputPosition=[];this.outputColor=[];this.varying=[];this.temp=[];this.attributes=[];this.discard=false}return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/ProgramWebGL":[function(e,t,a){var r=e("awayjs-stagegl/lib/aglsl/AGALTokenizer");var i=e("awayjs-stagegl/lib/aglsl/AGLSLParser");var s=function(){function e(e){this._uniforms=[[],[],[]];this._attribs=[];this._gl=e;this._program=this._gl.createProgram()}e.prototype.upload=function(t,a){var r=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(t));var i=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(a));this._vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER);this._fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER);this._gl.shaderSource(this._vertexShader,r);this._gl.compileShader(this._vertexShader);if(!this._gl.getShaderParameter(this._vertexShader,this._gl.COMPILE_STATUS)){throw new Error(this._gl.getShaderInfoLog(this._vertexShader));return}this._gl.shaderSource(this._fragmentShader,i);this._gl.compileShader(this._fragmentShader);if(!this._gl.getShaderParameter(this._fragmentShader,this._gl.COMPILE_STATUS)){throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));return}this._gl.attachShader(this._program,this._vertexShader);this._gl.attachShader(this._program,this._fragmentShader);this._gl.linkProgram(this._program);if(!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS)){throw new Error(this._gl.getProgramInfoLog(this._program))}this._uniforms[0].length=0;this._uniforms[1].length=0;this._uniforms[2].length=0;this._attribs.length=0};e.prototype.getUniformLocation=function(t,a){if(this._uniforms[t][a]!=null)return this._uniforms[t][a];return this._uniforms[t][a]=this._gl.getUniformLocation(this._program,e._uniformLocationNameDictionary[t]+a)};e.prototype.getAttribLocation=function(e){if(this._attribs[e]!=null)return this._attribs[e];return this._attribs[e]=this._gl.getAttribLocation(this._program,"va"+e)};e.prototype.dispose=function(){this._gl.deleteProgram(this._program)};e.prototype.focusProgram=function(){this._gl.useProgram(this._program)};Object.defineProperty(e.prototype,"glProgram",{get:function(){return this._program},enumerable:true,configurable:true});e._tokenizer=new r;e._aglslParser=new i;e._uniformLocationNameDictionary=["fc","fs","vc"];return e}();t.exports=s},{"awayjs-stagegl/lib/aglsl/AGALTokenizer":"awayjs-stagegl/lib/aglsl/AGALTokenizer","awayjs-stagegl/lib/aglsl/AGLSLParser":"awayjs-stagegl/lib/aglsl/AGLSLParser"}],"awayjs-stagegl/lib/base/ResourceBaseFlash":[function(e,t,a){var r=function(){function e(){}Object.defineProperty(e.prototype,"id",{get:function(){return this._pId},enumerable:true,configurable:true});e.prototype.dispose=function(){};return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/SamplerState":[function(e,t,a){var r=function(){function e(){}return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/Stage":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/geom/Rectangle");var s=e("awayjs-core/lib/events/Event");var n=e("awayjs-core/lib/events/EventDispatcher");var o=e("awayjs-core/lib/utils/CSS");var l=e("awayjs-stagegl/lib/base/ContextMode");var u=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var g=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var f=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var c=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var h=e("awayjs-stagegl/lib/base/ContextStage3D");var p=e("awayjs-stagegl/lib/base/ContextWebGL");var d=e("awayjs-stagegl/lib/base/ContextSoftware");var _=e("awayjs-stagegl/lib/events/StageEvent");var b=e("awayjs-stagegl/lib/pool/ImageObjectPool");var y=e("awayjs-stagegl/lib/pool/ProgramDataPool");var m=e("awayjs-stagegl/lib/vos/AttributesBufferVOPool");var w=function(e){r(t,e);function t(t,a,r,s,n){if(s===void 0){s=false}if(n===void 0){n="baseline"}e.call(this);this._programData=new Array;this._x=0;this._y=0;this._stageIndex=-1;this._antiAlias=0;this._renderTarget=null;this._renderSurfaceSelector=0;this._initialised=false;this._bufferFormatDictionary=new Array(5);this._imageObjectPool=new b(this);this._attributesBufferVOPool=new m(this);this._programDataPool=new y(this);this._container=t;this._stageIndex=a;this._stageManager=r;this._viewPort=new i;this._enableDepthAndStencil=true;o.setElementX(this._container,0);o.setElementY(this._container,0);this._bufferFormatDictionary[1]=new Array(5);this._bufferFormatDictionary[1][4]=f.BYTES_4;this._bufferFormatDictionary[4]=new Array(5);this._bufferFormatDictionary[4][1]=f.FLOAT_1;this._bufferFormatDictionary[4][2]=f.FLOAT_2;this._bufferFormatDictionary[4][3]=f.FLOAT_3;this._bufferFormatDictionary[4][4]=f.FLOAT_4;this.visible=true}t.prototype.getProgramData=function(e,t){return this._programDataPool.getItem(e,t)};t.prototype.setRenderTarget=function(e,t,a){if(t===void 0){t=false}if(a===void 0){a=0}if(this._renderTarget===e&&a==this._renderSurfaceSelector&&this._enableDepthAndStencil==t)return;this._renderTarget=e;this._renderSurfaceSelector=a;this._enableDepthAndStencil=t;if(e){this._context.setRenderToTexture(this.getImageObject(e).getTexture(this._context),t,this._antiAlias,a)}else{this._context.setRenderToBackBuffer();this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)}};t.prototype.getImageObject=function(e){return this._imageObjectPool.getItem(e)};t.prototype.getAttributesBufferVO=function(e){return this._attributesBufferVOPool.getItem(e)};t.prototype.requestContext=function(e,t,a){var r=this;if(e===void 0){e=false}if(t===void 0){t="baseline"}if(a===void 0){a="auto"}if(this._usesSoftwareRendering!=null)this._usesSoftwareRendering=e;this._profile=t;try{if(a==l.FLASH)new h(this._container,function(e){return r._callback(e)});else if(a==l.SOFTWARE)this._context=new d(this._container);else this._context=new p(this._container)}catch(i){try{if(a==l.AUTO)new h(this._container,function(e){return r._callback(e)});else this.dispatchEvent(new s(s.ERROR))}catch(i){this.dispatchEvent(new s(s.ERROR))}}if(this._context)this._callback(this._context)};Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){if(this._width==e)return;o.setElementWidth(this._container,e);this._width=this._viewPort.width=e;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){if(this._height==e)return;o.setElementHeight(this._container,e);this._height=this._viewPort.height=e;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){if(this._x==e)return;o.setElementX(this._container,e);this._x=this._viewPort.x=e;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){if(this._y==e)return;o.setElementY(this._container,e);this._y=this._viewPort.y=e;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return o.getElementVisibility(this._container)},set:function(e){o.setElementVisibility(this._container,e)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:true,configurable:true});t.prototype.notifyViewportUpdated=function(){if(this._viewportDirty)return;
this._viewportDirty=true;this._viewportUpdated=new _(_.VIEWPORT_UPDATED);this.dispatchEvent(this._viewportUpdated)};t.prototype.notifyEnterFrame=function(){if(!this._enterFrame)this._enterFrame=new s(s.ENTER_FRAME);this.dispatchEvent(this._enterFrame)};t.prototype.notifyExitFrame=function(){if(!this._exitFrame)this._exitFrame=new s(s.EXIT_FRAME);this.dispatchEvent(this._exitFrame)};Object.defineProperty(t.prototype,"profile",{get:function(){return this._profile},enumerable:true,configurable:true});t.prototype.dispose=function(){this._stageManager.iRemoveStage(this);this.freeContext();this._stageManager=null;this._stageIndex=-1};t.prototype.configureBackBuffer=function(e,t,a,r){this.width=e;this.height=t;this._antiAlias=a;this._enableDepthAndStencil=r;if(this._context)this._context.configureBackBuffer(e,t,a,r)};Object.defineProperty(t.prototype,"enableDepthAndStencil",{get:function(){return this._enableDepthAndStencil},set:function(e){this._enableDepthAndStencil=e;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderTarget",{get:function(){return this._renderTarget},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderSurfaceSelector",{get:function(){return this._renderSurfaceSelector},enumerable:true,configurable:true});t.prototype.clear=function(){if(!this._context)return;if(this._backBufferDirty){this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this._backBufferDirty=false}this._context.clear((this._color&4278190080)>>>24,(this._color&16711680)>>>16,(this._color&65280)>>>8,this._color&255);this._bufferClear=true};t.prototype.addEventListener=function(t,a){e.prototype.addEventListener.call(this,t,a)};t.prototype.removeEventListener=function(t,a){e.prototype.removeEventListener.call(this,t,a)};Object.defineProperty(t.prototype,"scissorRect",{get:function(){return this._scissorRect},set:function(e){this._scissorRect=e;this._context.setScissorRectangle(this._scissorRect)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"stageIndex",{get:function(){return this._stageIndex},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"usesSoftwareRendering",{get:function(){return this._usesSoftwareRendering},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(e){this._antiAlias=e;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"viewPort",{get:function(){this._viewportDirty=false;return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bufferClear",{get:function(){return this._bufferClear},set:function(e){this._bufferClear=e},enumerable:true,configurable:true});t.prototype.registerProgram=function(e){var t=0;while(this._programData[t]!=null)t++;this._programData[t]=e;e.id=t};t.prototype.unRegisterProgram=function(e){this._programData[e.id]=null;e.id=-1};t.prototype.freeContext=function(){if(this._context){this._context.dispose();this.dispatchEvent(new _(_.CONTEXT_DISPOSED))}this._context=null;this._initialised=false};t.prototype.onEnterFrame=function(e){if(!this._context)return;this.clear();this.notifyEnterFrame();if(!this._context)this._context.present();this.notifyExitFrame()};t.prototype.recoverFromDisposal=function(){if(!this._context)return false;return true};t.prototype._callback=function(e){this._context=e;this._container=this._context.container;if(this._width&&this._height)this._context.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this.dispatchEvent(new _(this._initialised?_.CONTEXT_RECREATED:_.CONTEXT_CREATED));this._initialised=true};t.prototype.setVertexBuffer=function(e,t,a,r,i){this._context.setVertexBufferAt(e,t,i,this._bufferFormatDictionary[a][r])};t.prototype.setSamplerState=function(e,t,a,r){var i=t?c.REPEAT:c.CLAMP;var s=a?g.LINEAR:g.NEAREST;var n=r?u.MIPLINEAR:u.MIPNONE;this._context.setSamplerStateAt(e,i,s,n)};return t}(n);t.exports=w},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/CSS":undefined,"awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/ContextMode":"awayjs-stagegl/lib/base/ContextMode","awayjs-stagegl/lib/base/ContextSoftware":"awayjs-stagegl/lib/base/ContextSoftware","awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D","awayjs-stagegl/lib/base/ContextWebGL":"awayjs-stagegl/lib/base/ContextWebGL","awayjs-stagegl/lib/events/StageEvent":"awayjs-stagegl/lib/events/StageEvent","awayjs-stagegl/lib/pool/ImageObjectPool":"awayjs-stagegl/lib/pool/ImageObjectPool","awayjs-stagegl/lib/pool/ProgramDataPool":"awayjs-stagegl/lib/pool/ProgramDataPool","awayjs-stagegl/lib/vos/AttributesBufferVOPool":"awayjs-stagegl/lib/vos/AttributesBufferVOPool"}],"awayjs-stagegl/lib/base/TextureBaseWebGL":[function(e,t,a){var r=e("awayjs-core/lib/errors/AbstractMethodError");var i=function(){function e(e){this.textureType="";this._gl=e}e.prototype.dispose=function(){throw"Abstract method must be overridden."};Object.defineProperty(e.prototype,"glTexture",{get:function(){throw new r},enumerable:true,configurable:true});return e}();t.exports=i},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-stagegl/lib/base/TextureFlash":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/utils/ByteArrayBase");var s=e("awayjs-stagegl/lib/base/OpCodes");var n=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var o=function(e){r(t,e);function t(t,a,r,i,n,o){if(o===void 0){o=false}e.call(this);this._context=t;this._width=a;this._height=r;this._context.addStream(String.fromCharCode(s.initTexture,n?s.trueValue:s.falseValue)+a+","+r+","+o+","+i+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.disposeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};t.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}if(e instanceof HTMLImageElement){var a=document.createElement("canvas");var r=e.width;var n=e.height;a.width=r;a.height=n;var o=a.getContext("2d");o.drawImage(e,0,0);e=o.getImageData(0,0,r,n).data}var l=0;var u=i.internalGetBase64String(e.length,function(){return e[l++]},null);this._context.addStream(String.fromCharCode(s.uploadBytesTexture)+this._pId+","+t+","+(this._width>>t)+","+(this._height>>t)+","+u+"%");this._context.execute()};return t}(n);t.exports=o},{"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/TextureSoftware":[function(e,t,a){var r=function(){function e(e,t){this.textureType="texture2d";this._width=e;this._height=t}e.prototype.dispose=function(){this._data=null};Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});e.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}if(t==0){console.log("uploadFromData: "+e+" miplevel: "+t);this._data=new Uint8Array(e.data);this._mipLevel=t}};Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/TextureWebGL":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/base/TextureBaseWebGL");var s=function(e){r(t,e);function t(t,a,r){e.call(this,t);this.textureType="texture2d";this._width=a;this._height=r;this._glTexture=this._gl.createTexture()}t.prototype.dispose=function(){this._gl.deleteTexture(this._glTexture)};Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"frameBuffer",{get:function(){if(!this._frameBuffer){this._frameBuffer=this._gl.createFramebuffer();this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._frameBuffer);this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null);var e=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,e);this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._width,this._height);this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._glTexture,0);this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,e);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return this._frameBuffer},enumerable:true,configurable:true});t.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,t,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);this._gl.bindTexture(this._gl.TEXTURE_2D,null)};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}var r=this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")};Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:true,configurable:true});t.prototype.generateMipmaps=function(){};return t}(i);t.exports=s},{"awayjs-stagegl/lib/base/TextureBaseWebGL":"awayjs-stagegl/lib/base/TextureBaseWebGL"}],"awayjs-stagegl/lib/base/VertexBufferFlash":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/base/OpCodes");var s=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(e){r(t,e);function t(t,a,r){e.call(this);this._context=t;this._numVertices=a;this._dataPerVertex=r;this._context.addStream(String.fromCharCode(i.initVertexBuffer,r+i.intMask)+a.toString()+",");this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.uploadFromArray=function(e,t,a){this._context.addStream(String.fromCharCode(i.uploadArrayVertexBuffer,this._pId+i.intMask)+e.join()+"#"+[t,a].join()+",");this._context.execute()};t.prototype.uploadFromByteArray=function(e,t,a){};Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(i.disposeVertexBuffer,this._pId+i.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return t}(s);t.exports=n},{"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/VertexBufferSoftware":[function(e,t,a){var r=function(){function e(e,t){this._numVertices=e;this._dataPerVertex=t}e.prototype.uploadFromArray=function(e,t,a){this._dataOffset=t*this._dataPerVertex;this._data=new Float32Array(e)};e.prototype.uploadFromByteArray=function(e,t,a){this._dataOffset=t*this._dataPerVertex;this._data=new Float32Array(e)};Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"attributesPerVertex",{get:function(){return this._dataPerVertex/4},enumerable:true,configurable:true});e.prototype.dispose=function(){this._data.length=0};Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataOffset",{get:function(){return this._dataOffset},enumerable:true,configurable:true});return e}();t.exports=r},{}],"awayjs-stagegl/lib/base/VertexBufferWebGL":[function(e,t,a){var r=function(){function e(e,t,a){this._gl=e;this._buffer=this._gl.createBuffer();this._numVertices=t;this._dataPerVertex=a}e.prototype.uploadFromArray=function(e,t,a){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t*this._dataPerVertex,new Float32Array(e));else this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW)};e.prototype.uploadFromByteArray=function(e,t,a){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t*this._dataPerVertex,e);else this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STATIC_DRAW)};Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};return e}();t.exports=r},{}],"awayjs-stagegl/lib/events/StageEvent":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/events/Event");var s=function(e){r(t,e);function t(t){e.call(this,t)}t.CONTEXT_CREATED="contextCreated";t.CONTEXT_DISPOSED="contextDisposed";t.CONTEXT_RECREATED="contextRecreated";t.VIEWPORT_UPDATED="viewportUpdated";return t}(i);t.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-stagegl/lib/managers/StageManager":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/events/EventDispatcher");var s=e("awayjs-core/lib/errors/ArgumentError");var n=e("awayjs-stagegl/lib/base/Stage");var o=e("awayjs-stagegl/lib/events/StageEvent");var l=function(e){r(t,e);function t(){var a=this;e.call(this);this._stages=new Array(t.STAGE_MAX_QUANTITY);this._onContextCreatedDelegate=function(e){return a.onContextCreated(e)}}t.getInstance=function(){if(this._instance==null)this._instance=new t;return this._instance};t.prototype.getStageAt=function(e,a,r,i){if(a===void 0){a=false}if(r===void 0){r="baseline"}if(i===void 0){i="auto"}if(e<0||e>=t.STAGE_MAX_QUANTITY)throw new s("Index is out of bounds [0.."+t.STAGE_MAX_QUANTITY+"]");if(!this._stages[e]){t._numStages++;var l=document.createElement("canvas");l.id="stage"+e;document.body.appendChild(l);var u=this._stages[e]=new n(l,e,this,a,r);u.addEventListener(o.CONTEXT_CREATED,this._onContextCreatedDelegate);u.requestContext(a,r,i)}return u};t.prototype.iRemoveStage=function(e){t._numStages--;e.removeEventListener(o.CONTEXT_CREATED,this._onContextCreatedDelegate);this._stages[e.stageIndex]=null};t.prototype.getFreeStage=function(e,t,a){if(e===void 0){e=false}if(t===void 0){t="baseline"}if(a===void 0){a="auto"}var r=0;var i=this._stages.length;while(r<i){if(!this._stages[r])return this.getStageAt(r,e,t,a);++r}return null};Object.defineProperty(t.prototype,"hasFreeStage",{get:function(){return t._numStages<t.STAGE_MAX_QUANTITY?true:false},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsFree",{get:function(){return t.STAGE_MAX_QUANTITY-t._numStages},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsUsed",{get:function(){return t._numStages},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsTotal",{get:function(){return this._stages.length},enumerable:true,configurable:true});t.prototype.onContextCreated=function(e){};t.STAGE_MAX_QUANTITY=8;t._numStages=0;return t}(i);t.exports=l},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-stagegl/lib/base/Stage":"awayjs-stagegl/lib/base/Stage","awayjs-stagegl/lib/events/StageEvent":"awayjs-stagegl/lib/events/StageEvent"}],"awayjs-stagegl/lib/pool/BitmapImage2DObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/data/BitmapImage2D");var s=e("awayjs-core/lib/utils/MipmapGenerator");var n=e("awayjs-stagegl/lib/pool/Image2DObject");var o=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.activate=function(t,a,r,i){e.prototype.activate.call(this,t,a,r,i);if(!this._mipmap&&i){this._mipmap=true;this._invalid=true}if(this._invalid){this._invalid=false;if(i){var n=this._mipmapData||(this._mipmapData=new Array);s._generateMipMaps(this._image.getCanvas(),n,true);var o=n.length;for(var l=0;l<o;l++)this._texture.uploadFromData(n[l].getImageData(),l)}else{this._texture.uploadFromData(this._image.getImageData(),0)}}};t.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this._mipmapData.length;for(var a=0;a<t;a++)s._freeMipMapHolder(this._mipmapData[a])};t.prototype.getTexture=function(t){if(!this._texture){this._invalid=true;return e.prototype.getTexture.call(this,t)}return this._texture};t.assetClass=i;return t}(n);t.exports=o},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/utils/MipmapGenerator":undefined,"awayjs-stagegl/lib/pool/Image2DObject":"awayjs-stagegl/lib/pool/Image2DObject"}],"awayjs-stagegl/lib/pool/BitmapImageCubeObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/data/BitmapImageCube");var s=e("awayjs-core/lib/utils/MipmapGenerator");var n=e("awayjs-stagegl/lib/pool/ImageCubeObject");var o=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r);this._mipmapDataArray=new Array(6)}t.prototype.activate=function(t,a,r,i){e.prototype.activate.call(this,t,a,r,i);if(!this._mipmap&&i){this._mipmap=true;this._invalid=true}if(this._invalid){this._invalid=false;for(var n=0;n<6;++n){if(i){var o=this._mipmapDataArray[n]||(this._mipmapDataArray[n]=new Array);s._generateMipMaps(this._image.getCanvas(n),o,true);var l=o.length;for(var u=0;u<l;u++)this._texture.uploadFromData(o[u].getImageData(),n,u)}else{this._texture.uploadFromData(this._image.getImageData(n),n,0)}}}};t.prototype.dispose=function(){e.prototype.dispose.call(this);for(var t=0;t<6;t++){var a=this._mipmapDataArray[t];var r=a.length;for(var i=0;i<r;t++)s._freeMipMapHolder(a[i])}};t.prototype.getTexture=function(t){if(!this._texture){this._invalid=true;return e.prototype.getTexture.call(this,t)}return this._texture};t.assetClass=i;return t}(n);t.exports=o},{"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/utils/MipmapGenerator":undefined,"awayjs-stagegl/lib/pool/ImageCubeObject":"awayjs-stagegl/lib/pool/ImageCubeObject"}],"awayjs-stagegl/lib/pool/IImageObjectClass":[function(e,t,a){},{}],"awayjs-stagegl/lib/pool/Image2DObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/pool/ImageObjectBase");var s=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var n=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.getTexture=function(e){return this._texture||(this._texture=e.createTexture(this._image.width,this._image.height,s.BGRA,true))};return t}(i);t.exports=n},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":"awayjs-stagegl/lib/base/ContextGLTextureFormat","awayjs-stagegl/lib/pool/ImageObjectBase":"awayjs-stagegl/lib/pool/ImageObjectBase"}],"awayjs-stagegl/lib/pool/ImageCubeObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-stagegl/lib/pool/ImageObjectBase");var s=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var n=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.getTexture=function(e){return this._texture||(this._texture=e.createCubeTexture(this._image.size,s.BGRA,false))};return t}(i);t.exports=n},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":"awayjs-stagegl/lib/base/ContextGLTextureFormat","awayjs-stagegl/lib/pool/ImageObjectBase":"awayjs-stagegl/lib/pool/ImageObjectBase"}],"awayjs-stagegl/lib/pool/ImageObjectBase":[function(e,t,a){var r=e("awayjs-core/lib/errors/AbstractMethodError");var i=function(){function e(e,t,a){this._pool=e;this._image=t;this._stage=a;this.invalidate()}e.prototype.dispose=function(){this._pool.disposeItem(this._image);this._texture.dispose();this._texture=null};e.prototype.invalidate=function(){this._invalid=true};e.prototype.activate=function(e,t,a,r){this._stage.setSamplerState(e,t,a,r);this._stage.context.setTextureAt(e,this.getTexture(this._stage.context))};e.prototype.getTexture=function(e){throw new r};return e}();t.exports=i},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-stagegl/lib/pool/ImageObjectPool":[function(e,t,a){var r=e("awayjs-stagegl/lib/pool/BitmapImage2DObject");var i=e("awayjs-stagegl/lib/pool/BitmapImageCubeObject");var s=e("awayjs-stagegl/lib/pool/RenderImage2DObject");var n=e("awayjs-stagegl/lib/pool/RenderImageCubeObject");var o=e("awayjs-stagegl/lib/pool/SpecularImage2DObject");var l=function(){function e(e){this._pool=new Object;this._stage=e}e.prototype.getItem=function(t){var a=this._pool[t.id]||(this._pool[t.id]=t._iAddImageObject(new(e.getClass(t))(this,t,this._stage)));return a};e.prototype.disposeItem=function(e){e._iRemoveImageObject(this._pool[e.id]);this._pool[e.id]=null};e.registerClass=function(t){e.classPool[t.assetClass.assetType]=t};e.getClass=function(t){return e.classPool[t.assetType]};e.addDefaults=function(){e.registerClass(s);e.registerClass(n);e.registerClass(r);e.registerClass(i);e.registerClass(o)};e.classPool=new Object;e.main=e.addDefaults();return e}();t.exports=l},{"awayjs-stagegl/lib/pool/BitmapImage2DObject":"awayjs-stagegl/lib/pool/BitmapImage2DObject","awayjs-stagegl/lib/pool/BitmapImageCubeObject":"awayjs-stagegl/lib/pool/BitmapImageCubeObject","awayjs-stagegl/lib/pool/RenderImage2DObject":"awayjs-stagegl/lib/pool/RenderImage2DObject","awayjs-stagegl/lib/pool/RenderImageCubeObject":"awayjs-stagegl/lib/pool/RenderImageCubeObject","awayjs-stagegl/lib/pool/SpecularImage2DObject":"awayjs-stagegl/lib/pool/SpecularImage2DObject"}],"awayjs-stagegl/lib/pool/ProgramDataPool":[function(e,t,a){var r=e("awayjs-stagegl/lib/pool/ProgramData");var i=function(){function e(e){this._pool=new Object;this._stage=e}e.prototype.getItem=function(e,t){var a=e+t;return this._pool[a]||(this._pool[a]=new r(this,this._stage,e,t))};e.prototype.disposeItem=function(e){this._pool[e]=null};return e}();t.exports=i},{"awayjs-stagegl/lib/pool/ProgramData":"awayjs-stagegl/lib/pool/ProgramData"}],"awayjs-stagegl/lib/pool/ProgramData":[function(e,t,a){var r=function(){function e(e,t,a,r){this.usages=0;this._pool=e;this.stage=t;this.vertexString=a;this.fragmentString=r;this.stage.registerProgram(this)}e.prototype.dispose=function(){this.usages--;if(!this.usages){this._pool.disposeItem(this.vertexString+this.fragmentString);this.stage.unRegisterProgram(this);if(this.program)this.program.dispose()}this.program=null};e.PROGRAMDATA_ID_COUNT=0;return e}();t.exports=r},{}],"awayjs-stagegl/lib/pool/RenderImage2DObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/data/Image2D");var s=e("awayjs-stagegl/lib/pool/Image2DObject");var n=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.activate=function(t,a,r,i){e.prototype.activate.call(this,t,a,r,false)};t.assetClass=i;return t}(s);t.exports=n},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-stagegl/lib/pool/Image2DObject":"awayjs-stagegl/lib/pool/Image2DObject"}],"awayjs-stagegl/lib/pool/RenderImageCubeObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/data/ImageCube");var s=e("awayjs-stagegl/lib/pool/ImageCubeObject");var n=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.activate=function(t,a,r,i){e.prototype.activate.call(this,t,a,r,false)};t.assetClass=i;return t}(s);t.exports=n},{"awayjs-core/lib/data/ImageCube":undefined,"awayjs-stagegl/lib/pool/ImageCubeObject":"awayjs-stagegl/lib/pool/ImageCubeObject"}],"awayjs-stagegl/lib/pool/SpecularImage2DObject":[function(e,t,a){var r=this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}r.prototype=t.prototype;e.prototype=new r};var i=e("awayjs-core/lib/data/SpecularImage2D");var s=e("awayjs-core/lib/utils/MipmapGenerator");var n=e("awayjs-stagegl/lib/pool/Image2DObject");var o=function(e){r(t,e);function t(t,a,r){e.call(this,t,a,r)}t.prototype.activate=function(t,a,r,i){e.prototype.activate.call(this,t,a,r,i);if(!this._mipmap&&i){this._mipmap=true;this._invalid=true}if(this._invalid){this._invalid=false;if(i){var n=this._mipmapData||(this._mipmapData=new Array);s._generateMipMaps(this._image.getCanvas(),n);var o=n.length;for(var l=0;l<o;l++)this._texture.uploadFromData(n[l].getImageData(),l)}else{this._texture.uploadFromData(this._image.getImageData(),0)}}};t.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this._mipmapData.length;for(var a=0;a<t;a++)s._freeMipMapHolder(this._mipmapData[a])};t.prototype.getTexture=function(t){if(!this._texture){this._invalid=true;return e.prototype.getTexture.call(this,t)}return this._texture};t.assetClass=i;return t}(n);t.exports=o},{"awayjs-core/lib/data/SpecularImage2D":undefined,"awayjs-core/lib/utils/MipmapGenerator":undefined,"awayjs-stagegl/lib/pool/Image2DObject":"awayjs-stagegl/lib/pool/Image2DObject"}],"awayjs-stagegl/lib/vos/AttributesBufferVOPool":[function(e,t,a){var r=e("awayjs-stagegl/lib/vos/AttributesBufferVO");var i=function(){function e(e){this._pool=new Object;this._stage=e}e.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddAttributesBufferVO(new(e.getClass(t))(this,t,this._stage)))};e.prototype.disposeItem=function(e){e._iRemoveAttributesBufferVO(this._pool[e.id]);this._pool[e.id]=null};e.registerClass=function(t){e.classPool[t.assetClass.assetType]=t};e.getClass=function(t){return e.classPool[t.assetType]};e.addDefaults=function(){e.registerClass(r)};e.classPool=new Object;e.main=e.addDefaults();return e}();t.exports=i},{"awayjs-stagegl/lib/vos/AttributesBufferVO":"awayjs-stagegl/lib/vos/AttributesBufferVO"}],"awayjs-stagegl/lib/vos/AttributesBufferVO":[function(e,t,a){var r=e("awayjs-core/lib/attributes/AttributesBuffer");var i=function(){function e(e,t,a){this._pool=e;this._attributesBuffer=t;this._stage=a}e.prototype.dispose=function(){this._pool.disposeItem(this._attributesBuffer);if(this._indexBuffer){this._indexBuffer.dispose();this._indexBuffer=null}if(this._vertexBuffer){this._vertexBuffer.dispose();this._vertexBuffer=null}};e.prototype.invalidate=function(){this._invalid=true};e.prototype.activate=function(e,t,a,r){this._stage.setVertexBuffer(e,this._getVertexBuffer(),t,a,r)};e.prototype.draw=function(e,t,a){this._stage.context.drawIndices(e,this._getIndexBuffer(),t,a)};e.prototype._getIndexBuffer=function(){if(!this._indexBuffer){this._invalid=true;this._indexBuffer=this._stage.context.createIndexBuffer(this._attributesBuffer.count*this._attributesBuffer.stride/2)}if(this._invalid){this._invalid=false;this._indexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.length)}return this._indexBuffer};e.prototype._getVertexBuffer=function(){if(!this._vertexBuffer){this._invalid=true;this._vertexBuffer=this._stage.context.createVertexBuffer(this._attributesBuffer.count,this._attributesBuffer.stride)}if(this._invalid){this._invalid=false;this._vertexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.count)}return this._vertexBuffer};e.assetClass=r;return e}();t.exports=i},{"awayjs-core/lib/attributes/AttributesBuffer":undefined}],"awayjs-stagegl/lib/vos/IAttributesBufferVOClass":[function(e,t,a){},{}]},{},[]);


require=function e(t,r,i){function a(n,o){if(!r[n]){if(!t[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(s)return s(n,!0);var h=new Error("Cannot find module '"+n+"'");throw h.code="MODULE_NOT_FOUND",h}var d=r[n]={exports:{}};t[n][0].call(d.exports,function(e){var r=t[n][1][e];return a(r?r:e)},d,d.exports,e,t,r,i)}return r[n].exports}var s=typeof require=="function"&&require;for(var n=0;n<i.length;n++)a(i[n]);return a}({"awayjs-renderergl/lib/DefaultRenderer":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/data/BitmapImage2D");var s=e("awayjs-core/lib/geom/Matrix3D");var n=e("awayjs-core/lib/geom/Vector3D");var o=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var l=e("awayjs-stagegl/lib/base/ContextGLClearMask");var h=e("awayjs-renderergl/lib/RendererBase");var d=e("awayjs-renderergl/lib/DepthRenderer");var p=e("awayjs-renderergl/lib/DistanceRenderer");var u=e("awayjs-renderergl/lib/Filter3DRenderer");var c=e("awayjs-renderergl/lib/renderables/RenderablePool");var g=e("awayjs-renderergl/lib/managers/RTTBufferManager");var f=function(e){i(t,e);function t(t,r,i,a){if(t===void 0){t=null}if(r===void 0){r=false}if(i===void 0){i="baseline"}if(a===void 0){a="auto"}e.call(this,t,r,i,a);this._skyboxProjection=new s;this._pRenderablePool=new c(this._pStage);if(t)this._shareContext=true;this._pRttBufferManager=g.getInstance(this._pStage);this._pDepthRenderer=new d(this._pStage);this._pDistanceRenderer=new p(this._pStage);if(this._width==0)this.width=window.innerWidth;else this._pRttBufferManager.viewWidth=this._width;if(this._height==0)this.height=window.innerHeight;else this._pRttBufferManager.viewHeight=this._height}Object.defineProperty(t.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(e){if(this._antiAlias==e)return;this._antiAlias=e;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"depthPrepass",{get:function(){return this._depthPrepass},set:function(e){this._depthPrepass=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"filters3d",{get:function(){return this._pFilter3DRenderer?this._pFilter3DRenderer.filters:null},set:function(e){if(e&&e.length==0)e=null;if(this._pFilter3DRenderer&&!e){this._pFilter3DRenderer.dispose();this._pFilter3DRenderer=null}else if(!this._pFilter3DRenderer&&e){this._pFilter3DRenderer=new u(this._pStage);this._pFilter3DRenderer.filters=e}if(this._pFilter3DRenderer){this._pFilter3DRenderer.filters=e;this._pRequireDepthRender=this._pFilter3DRenderer.requireDepthRender}else{this._pRequireDepthRender=false;if(this._pDepthRender){this._pDepthRender.dispose();this._pDepthRender=null}}},enumerable:true,configurable:true});t.prototype.render=function(t){e.prototype.render.call(this,t);if(!this._pStage.recoverFromDisposal()){this._pBackBufferInvalid=true;return}if(this._pBackBufferInvalid)this.pUpdateBackBuffer();if(this._shareContext&&this._pContext)this._pContext.clear(0,0,0,1,1,0,l.DEPTH);if(this._pFilter3DRenderer){this.textureRatioX=this._pRttBufferManager.textureRatioX;this.textureRatioY=this._pRttBufferManager.textureRatioY}else{this.textureRatioX=1;this.textureRatioY=1}if(this._pRequireDepthRender)this.pRenderSceneDepthToTexture(t);if(this._depthPrepass)this.pRenderDepthPrepass(t);if(this._pFilter3DRenderer&&this._pContext){}else{if(this._shareContext)this._iRender(t,null,this._pScissorRect);else this._iRender(t)}e.prototype.render.call(this,t);if(!this._shareContext&&this._pContext)this._pContext.present();this._pStage.bufferClear=false};t.prototype.pExecuteRender=function(t,r,i,a){if(r===void 0){r=null}if(i===void 0){i=null}if(a===void 0){a=0}this.updateLights(t);e.prototype.pExecuteRender.call(this,t,r,i,a)};t.prototype.updateLights=function(e){var t=e.directionalLights;var r=e.pointLights;var i,a;var s;var n;i=t.length;for(a=0;a<i;++a){s=t[a];n=s.shadowMapper;if(s.castsShadows&&(n.autoUpdateShadows||n._iShadowsInvalid))n.iRenderDepthMap(e,this._pDepthRenderer)}i=r.length;for(a=0;a<i;++a){s=r[a];n=s.shadowMapper;if(s.castsShadows&&(n.autoUpdateShadows||n._iShadowsInvalid))n.iRenderDepthMap(e,this._pDistanceRenderer)}};t.prototype.pDraw=function(t){if(t.skyBox){this._pContext.setDepthTest(false,o.ALWAYS);this.drawSkybox(t)}e.prototype.pDraw.call(this,t)};t.prototype.drawSkybox=function(e){var t=this._pRenderablePool.getItem(e.skyBox);var r=e.camera;this.updateSkyboxProjection(r);var i=this._pRenderablePool.getRenderPool(t.renderableOwner).getItem(t.renderOwner);var a=i.passes[0];this.activatePass(t,a,r);t._iRender(a,r,this._skyboxProjection);this.deactivatePass(t,a)};t.prototype.updateSkyboxProjection=function(e){var t=new n;this._skyboxProjection.copyFrom(this._pRttViewProjectionMatrix);this._skyboxProjection.copyRowTo(2,t);var r=e.scenePosition;var i=t.x;var a=t.y;var s=t.z;var o=-(t.x*r.x+t.y*r.y+t.z*r.z+Math.sqrt(i*i+a*a+s*s));var l=i>=0?1:-1;var h=a>=0?1:-1;var d=new n(l,h,1,1);var p=this._skyboxProjection.clone();p.invert();var u=p.transformVector(d);this._skyboxProjection.copyRowTo(3,d);var c=(u.x*d.x+u.y*d.y+u.z*d.z+u.w*d.w)/(i*u.x+a*u.y+s*u.z+o*u.w);this._skyboxProjection.copyRowFrom(2,new n(i*c,a*c,s*c,o*c))};t.prototype.dispose=function(){if(!this._shareContext)this._pStage.dispose();this._pRttBufferManager.dispose();this._pRttBufferManager=null;this._pDepthRenderer.dispose();this._pDistanceRenderer.dispose();this._pDepthRenderer=null;this._pDistanceRenderer=null;this._pDepthRender=null;e.prototype.dispose.call(this)};t.prototype.pRenderDepthPrepass=function(e){this._pDepthRenderer.disableColor=true;if(this._pFilter3DRenderer){}else{this._pDepthRenderer.textureRatioX=1;this._pDepthRenderer.textureRatioY=1;this._pDepthRenderer._iRender(e)}this._pDepthRenderer.disableColor=false};t.prototype.pRenderSceneDepthToTexture=function(e){if(this._pDepthTextureInvalid||!this._pDepthRender)this.initDepthTexture(this._pStage.context);this._pDepthRenderer.textureRatioX=this._pRttBufferManager.textureRatioX;this._pDepthRenderer.textureRatioY=this._pRttBufferManager.textureRatioY;this._pDepthRenderer._iRender(e,this._pDepthRender)};t.prototype.pUpdateBackBuffer=function(){if(this._pStage.context&&!this._shareContext){if(this._width&&this._height){this._pStage.configureBackBuffer(this._width,this._height,this._antiAlias,true);this._pBackBufferInvalid=false}}};t.prototype.initDepthTexture=function(e){this._pDepthTextureInvalid=false;if(this._pDepthRender)this._pDepthRender.dispose();this._pDepthRender=new a(this._pRttBufferManager.textureWidth,this._pRttBufferManager.textureHeight)};return t}(h);t.exports=f},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/DepthRenderer":"awayjs-renderergl/lib/DepthRenderer","awayjs-renderergl/lib/DistanceRenderer":"awayjs-renderergl/lib/DistanceRenderer","awayjs-renderergl/lib/Filter3DRenderer":"awayjs-renderergl/lib/Filter3DRenderer","awayjs-renderergl/lib/RendererBase":"awayjs-renderergl/lib/RendererBase","awayjs-renderergl/lib/managers/RTTBufferManager":"awayjs-renderergl/lib/managers/RTTBufferManager","awayjs-renderergl/lib/renderables/RenderablePool":"awayjs-renderergl/lib/renderables/RenderablePool","awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined}],"awayjs-renderergl/lib/DepthRenderer":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/RendererBase");var s=e("awayjs-renderergl/lib/render/DepthRender");var n=e("awayjs-renderergl/lib/renderables/RenderablePool");var o=function(e){i(t,e);function t(t){if(t===void 0){t=null}e.call(this,t);this._pRenderablePool=new n(this._pStage,s);this._iBackgroundR=1;this._iBackgroundG=1;this._iBackgroundB=1}return t}(a);t.exports=o},{"awayjs-renderergl/lib/RendererBase":"awayjs-renderergl/lib/RendererBase","awayjs-renderergl/lib/render/DepthRender":"awayjs-renderergl/lib/render/DepthRender","awayjs-renderergl/lib/renderables/RenderablePool":"awayjs-renderergl/lib/renderables/RenderablePool"}],"awayjs-renderergl/lib/DistanceRenderer":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/RendererBase");var s=e("awayjs-renderergl/lib/render/DistanceRender");var n=e("awayjs-renderergl/lib/renderables/RenderablePool");var o=function(e){i(t,e);function t(t){if(t===void 0){t=null}e.call(this,t);this._pRenderablePool=new n(this._pStage,s);this._iBackgroundR=1;this._iBackgroundG=1;this._iBackgroundB=1}return t}(a);t.exports=o},{"awayjs-renderergl/lib/RendererBase":"awayjs-renderergl/lib/RendererBase","awayjs-renderergl/lib/render/DistanceRender":"awayjs-renderergl/lib/render/DistanceRender","awayjs-renderergl/lib/renderables/RenderablePool":"awayjs-renderergl/lib/renderables/RenderablePool"}],"awayjs-renderergl/lib/Filter3DRenderer":[function(e,t,r){var i=e("awayjs-core/lib/events/Event");var a=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var s=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var n=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=e("awayjs-renderergl/lib/managers/RTTBufferManager");var l=function(){function e(e){var t=this;this._filterSizesInvalid=true;this._onRTTResizeDelegate=function(e){return t.onRTTResize(e)};this._stage=e;this._rttManager=o.getInstance(e);this._rttManager.addEventListener(i.RESIZE,this._onRTTResizeDelegate)}e.prototype.onRTTResize=function(e){this._filterSizesInvalid=true};Object.defineProperty(e.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});e.prototype.getMainInputTexture=function(e){if(this._filterTasksInvalid){this.updateFilterTasks(e)}return this._mainInputTexture};Object.defineProperty(e.prototype,"filters",{get:function(){return this._filters},set:function(e){this._filters=e;this._filterTasksInvalid=true;this._requireDepthRender=false;if(!this._filters){return}for(var t=0;t<this._filters.length;++t){var r=this._filters[t];var i=r.requireDepthRender==null?false:r.requireDepthRender;this._requireDepthRender=this._requireDepthRender||i}this._filterSizesInvalid=true},enumerable:true,configurable:true});e.prototype.updateFilterTasks=function(e){var t;if(this._filterSizesInvalid){this.updateFilterSizes()}if(!this._filters){this._tasks=null;return}this._tasks=new Array;t=this._filters.length-1;var r;for(var i=0;i<=t;++i){r=this._filters[i];r.setRenderTargets(i==t?null:this._filters[i+1].getMainInputTexture(e),e);this._tasks=this._tasks.concat(r.tasks)}this._mainInputTexture=this._filters[0].getMainInputTexture(e)};e.prototype.render=function(e,t,r){var i;var o;var l;var h=e.context;var d=this._rttManager.indexBuffer;var p=this._rttManager.renderToTextureVertexBuffer;if(!this._filters){return}if(this._filterSizesInvalid){this.updateFilterSizes()}if(this._filterTasksInvalid){this.updateFilterTasks(e)}i=this._filters.length;for(o=0;o<i;++o){this._filters[o].update(e,t)}i=this._tasks.length;if(i>1){h.setVertexBufferAt(0,p,0,n.FLOAT_2);h.setVertexBufferAt(1,p,2,n.FLOAT_2)}for(o=0;o<i;++o){l=this._tasks[o];if(!l.target){e.scissorRect=null;p=this._rttManager.renderToScreenVertexBuffer;h.setVertexBufferAt(0,p,0,n.FLOAT_2);h.setVertexBufferAt(1,p,2,n.FLOAT_2)}h.setTextureAt(0,l.getMainInputTexture(e));h.setProgram(l.getProgram(e));h.clear(0,0,0,0);l.activate(e,t,r);h.setBlendFactors(s.ONE,s.ZERO);h.drawIndices(a.TRIANGLES,d,0,2);l.deactivate(e)}h.setTextureAt(0,null);h.setVertexBufferAt(0,null);h.setVertexBufferAt(1,null)};e.prototype.updateFilterSizes=function(){for(var e=0;e<this._filters.length;++e){this._filters[e].textureWidth=this._rttManager.textureWidth;this._filters[e].textureHeight=this._rttManager.textureHeight}this._filterSizesInvalid=true};e.prototype.dispose=function(){this._rttManager.removeEventListener(i.RESIZE,this._onRTTResizeDelegate);this._rttManager=null;this._stage=null};return e}();t.exports=l},{"awayjs-core/lib/events/Event":undefined,"awayjs-renderergl/lib/managers/RTTBufferManager":"awayjs-renderergl/lib/managers/RTTBufferManager","awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLDrawMode":undefined,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/RendererBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-core/lib/geom/Point");var n=e("awayjs-core/lib/geom/Rectangle");var o=e("awayjs-core/lib/events/EventDispatcher");var l=e("awayjs-display/lib/sort/RenderableMergeSort");var h=e("awayjs-display/lib/events/RendererEvent");var d=e("awayjs-display/lib/traverse/EntityCollector");var p=e("awayjs-display/lib/managers/DefaultMaterialManager");var u=e("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var c=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var g=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var f=e("awayjs-stagegl/lib/events/StageEvent");var _=e("awayjs-stagegl/lib/managers/StageManager");var m=function(e){i(t,e);function t(t,r,i,o){var h=this;if(t===void 0){t=null}if(r===void 0){r=false}if(i===void 0){i="baseline"}if(o===void 0){o="auto"}e.call(this);this._activeMasksConfig=new Array;this._registeredMasks=new Array;this._numUsedStreams=0;this._numUsedTextures=0;this._viewPort=new n;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this._depthPrepass=false;this._backgroundR=0;this._backgroundG=0;this._backgroundB=0;this._backgroundAlpha=1;this.textureRatioX=1;this.textureRatioY=1;this._pRttViewProjectionMatrix=new a;this._localPos=new s;this._globalPos=new s;this._pScissorRect=new n;this._pNumElements=0;this._disableColor=false;this._renderBlended=true;this._onViewportUpdatedDelegate=function(e){return h.onViewportUpdated(e)};this._onContextUpdateDelegate=function(e){return h.onContextUpdate(e)};this.renderableSorter=new l;this._pStage=t||_.getInstance().getFreeStage(r,i,o);this._pStage.addEventListener(f.CONTEXT_CREATED,this._onContextUpdateDelegate);this._pStage.addEventListener(f.CONTEXT_RECREATED,this._onContextUpdateDelegate);this._pStage.addEventListener(f.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);if(this._pStage.context)this._pContext=this._pStage.context}Object.defineProperty(t.prototype,"renderBlended",{get:function(){return this._renderBlended},set:function(e){this._renderBlended=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"disableColor",{get:function(){return this._disableColor},set:function(e){this._disableColor=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numElements",{get:function(){return this._pNumElements},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"viewPort",{get:function(){return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scissorRect",{get:function(){return this._pScissorRect},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._localPos.x},set:function(e){if(this.x==e)return;this._globalPos.x=this._localPos.x=e;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._localPos.y},set:function(e){if(this.y==e)return;this._globalPos.y=this._localPos.y=e;this.updateGlobalPos()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){if(this._width==e)return;this._width=e;this._pScissorRect.width=e;if(this._pRttBufferManager)this._pRttBufferManager.viewWidth=e;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this.notifyScissorUpdate()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){if(this._height==e)return;this._height=e;this._pScissorRect.height=e;if(this._pRttBufferManager)this._pRttBufferManager.viewHeight=e;this._pBackBufferInvalid=true;this._pDepthTextureInvalid=true;this.notifyScissorUpdate()},enumerable:true,configurable:true});t.prototype.activatePass=function(e,t,r){for(var i=t.shader.numUsedStreams;i<this._numUsedStreams;i++)this._pContext.setVertexBufferAt(i,null);for(var i=t.shader.numUsedTextures;i<this._numUsedTextures;i++)this._pContext.setTextureAt(i,null);var a=t.shader.programData;if(!a.program){a.program=this._pContext.createProgram();var s=(new u).assemble("part vertex 1\n"+a.vertexString+"endpart")["vertex"].data;var n=(new u).assemble("part fragment 1\n"+a.fragmentString+"endpart")["fragment"].data;a.program.upload(s,n)}this._pContext.setProgram(a.program);e._iActivate(t,r)};t.prototype.deactivatePass=function(e,t){e._iDeactivate(t);this._numUsedStreams=t.shader.numUsedStreams;this._numUsedTextures=t.shader.numUsedTextures};t.prototype._iCreateEntityCollector=function(){return new d};Object.defineProperty(t.prototype,"_iBackgroundR",{get:function(){return this._backgroundR},set:function(e){if(this._backgroundR==e)return;this._backgroundR=e;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"_iBackgroundG",{get:function(){return this._backgroundG},set:function(e){if(this._backgroundG==e)return;this._backgroundG=e;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"_iBackgroundB",{get:function(){return this._backgroundB},set:function(e){if(this._backgroundB==e)return;this._backgroundB=e;this._pBackBufferInvalid=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"context",{get:function(){return this._pContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"stage",{get:function(){return this._pStage},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"shareContext",{get:function(){return this._shareContext},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderablePool",{get:function(){return this._pRenderablePool},enumerable:true,configurable:true});t.prototype.dispose=function(){this._pRenderablePool.dispose();this._pStage.removeEventListener(f.CONTEXT_CREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(f.CONTEXT_RECREATED,this._onContextUpdateDelegate);this._pStage.removeEventListener(f.VIEWPORT_UPDATED,this._onViewportUpdatedDelegate);this._pStage=null;this._pContext=null};t.prototype.render=function(e){this._viewportDirty=false;this._scissorDirty=false};t.prototype._iRender=function(e,t,r,i){if(t===void 0){t=null}if(r===void 0){r=null}if(i===void 0){i=0}if(!this._pStage||!this._pContext)return;this._pRttViewProjectionMatrix.copyFrom(e.camera.viewProjection);this._pRttViewProjectionMatrix.appendScale(this.textureRatioX,this.textureRatioY,1);this.pExecuteRender(e,t,r,i);for(var a=0;a<8;++a){this._pContext.setVertexBufferAt(a,null);this._pContext.setTextureAt(a,null)}};t.prototype._iRenderCascades=function(e,t,r,i,a){this._applyCollector(e);this._pStage.setRenderTarget(t,true,0);this._pContext.clear(1,1,1,1,1,0);this._pContext.setBlendFactors(c.ONE,c.ZERO);this._pContext.setDepthTest(true,g.LESS);var s=this._pOpaqueRenderableHead;var n=true;for(var o=r-1;o>=0;--o){this._pStage.scissorRect=i[o];n=false}this._pContext.setDepthTest(false,g.LESS_EQUAL);this._pStage.scissorRect=null};t.prototype._applyCollector=function(e){this._pBlendedRenderableHead=null;this._pOpaqueRenderableHead=null;this._pNumElements=0;var t=e.entityHead;this._pCamera=e.camera;this._iEntryPoint=this._pCamera.scenePosition;this._pCameraForward=this._pCamera.transform.forwardVector;while(t){t.entity._applyRenderer(this);t=t.next}if(this.renderableSorter){this._pOpaqueRenderableHead=this.renderableSorter.sortOpaqueRenderables(this._pOpaqueRenderableHead);this._pBlendedRenderableHead=this.renderableSorter.sortBlendedRenderables(this._pBlendedRenderableHead)}};t.prototype.pExecuteRender=function(e,t,r,i){if(t===void 0){t=null}if(r===void 0){r=null}if(i===void 0){i=0}this._pStage.setRenderTarget(t,true,i);if((t||!this._shareContext)&&!this._depthPrepass)this._pContext.clear(this._backgroundR,this._backgroundG,this._backgroundB,this._backgroundAlpha,1,0);this._pStage.scissorRect=r;this._applyCollector(e);this._pContext.setBlendFactors(c.ONE,c.ZERO);this.pDraw(e);if(!this._shareContext){if(this._snapshotRequired&&this._snapshotBitmapImage2D){this._pContext.drawToBitmapImage2D(this._snapshotBitmapImage2D);this._snapshotRequired=false}}this._pStage.scissorRect=null};t.prototype.queueSnapshot=function(e){this._snapshotRequired=true;this._snapshotBitmapImage2D=e};t.prototype.pDraw=function(e){this._pContext.setDepthTest(true,g.LESS_EQUAL);if(this._disableColor)this._pContext.setColorMask(false,false,false,false);this.drawRenderables(this._pOpaqueRenderableHead,e);if(this._renderBlended)this.drawRenderables(this._pBlendedRenderableHead,e);if(this._disableColor)this._pContext.setColorMask(true,true,true,true)};t.prototype.drawRenderables=function(e,t){var r;var i;var a;var s;var n;var o;var l=t.camera;this._pContext.setStencilActions("frontAndBack","always","keep","keep","keep");this._registeredMasks.length=0;var h=this._pContext["_gl"];h.disable(h.STENCIL_TEST);this._maskConfig=0;while(e){s=e.render;n=s.passes;if(this._disableColor&&s._renderOwner.alphaThreshold!=0){a=e;do{a=a.next}while(a&&a.render==s)}else{if(this._activeMasksDirty||this._checkMasksConfig(e.masksConfig)){this._activeMasksConfig=e.masksConfig;if(!this._activeMasksConfig.length){h.disable(h.STENCIL_TEST);h.stencilFunc(h.ALWAYS,0,255);h.stencilOp(h.KEEP,h.KEEP,h.KEEP)}else{this._renderMasks(e.sourceEntity._iAssignedMasks())}this._activeMasksDirty=false}i=n.length;for(r=0;r<i;r++){a=e;o=n[r];this.activatePass(e,o,l);do{if(a.maskId!==-1){if(r==0)this._registerMask(a)}else{a._iRender(o,l,this._pRttViewProjectionMatrix)}a=a.next}while(a&&a.render==s&&!(this._activeMasksDirty=this._checkMasksConfig(a.masksConfig)));this.deactivatePass(e,o)}}e=a}};t.prototype.onContextUpdate=function(e){this._pContext=this._pStage.context};Object.defineProperty(t.prototype,"_iBackgroundAlpha",{get:function(){return this._backgroundAlpha},set:function(e){if(this._backgroundAlpha==e)return;this._backgroundAlpha=e;this._pBackBufferInvalid=true},enumerable:true,configurable:true});t.prototype.notifyScissorUpdate=function(){if(this._scissorDirty)return;this._scissorDirty=true;if(!this._scissorUpdated)this._scissorUpdated=new h(h.SCISSOR_UPDATED);this.dispatchEvent(this._scissorUpdated)};t.prototype.notifyViewportUpdate=function(){if(this._viewportDirty)return;this._viewportDirty=true;if(!this._viewPortUpdated)this._viewPortUpdated=new h(h.VIEWPORT_UPDATED);this.dispatchEvent(this._viewPortUpdated)};t.prototype.onViewportUpdated=function(e){this._viewPort=this._pStage.viewPort;if(this._shareContext){this._pScissorRect.x=this._globalPos.x-this._pStage.x;this._pScissorRect.y=this._globalPos.y-this._pStage.y;this.notifyScissorUpdate()}this.notifyViewportUpdate()};t.prototype.updateGlobalPos=function(){if(this._shareContext){this._pScissorRect.x=this._globalPos.x-this._viewPort.x;this._pScissorRect.y=this._globalPos.y-this._viewPort.y}else{this._pScissorRect.x=0;this._pScissorRect.y=0;this._viewPort.x=this._globalPos.x;this._viewPort.y=this._globalPos.y}this.notifyScissorUpdate()};t.prototype._iApplyRenderableOwner=function(e){var t=this._pRenderablePool.getItem(e);var r=this._pRenderablePool.getRenderPool(e).getItem(t.renderOwner||p.getDefaultMaterial(e));t.render=r;t.renderId=r.renderId;t.renderOrderId=r.renderOrderId;t.cascaded=false;var i=t.sourceEntity;var a=i.scenePosition;a=this._iEntryPoint.subtract(a);t.zIndex=i.zOffset+a.dotProduct(this._pCameraForward);t.maskId=i._iAssignedMaskId();t.masksConfig=i._iMasksConfig();t.renderSceneTransform=t.sourceEntity.getRenderSceneTransform(this._pCamera);if(r.requiresBlending){t.next=this._pBlendedRenderableHead;this._pBlendedRenderableHead=t}else{t.next=this._pOpaqueRenderableHead;this._pOpaqueRenderableHead=t}this._pNumElements+=t.subGeometryVO.subGeometry.numElements};t.prototype._registerMask=function(e){this._registeredMasks.push(e)};t.prototype._renderMasks=function(e){var t=this._pContext["_gl"];this._pContext.setColorMask(false,false,false,false);t.enable(t.STENCIL_TEST);this._maskConfig++;t.stencilFunc(t.ALWAYS,this._maskConfig,255);t.stencilOp(t.REPLACE,t.REPLACE,t.REPLACE);var r=e.length;var i=this._registeredMasks.length;var a;var s;var n;var o;for(var l=0;l<r;++l){if(l!=0){t.stencilFunc(t.EQUAL,this._maskConfig,255);t.stencilOp(t.KEEP,t.INCR,t.INCR);this._maskConfig++}s=e[l];n=s.length;for(var h=0;h<n;++h){o=s[h];for(var d=0;d<i;++d){a=this._registeredMasks[d];if(a.maskId==o.id){this._drawMask(a)}}}}t.stencilFunc(t.EQUAL,this._maskConfig,255);t.stencilOp(t.KEEP,t.KEEP,t.KEEP);this._pContext.setColorMask(true,true,true,true)};t.prototype._drawMask=function(e){var t=e.render;var r=t.passes;var i=r.length;var a=r[i-1];this.activatePass(e,a,this._pCamera);e._iRender(a,this._pCamera,this._pRttViewProjectionMatrix);this.deactivatePass(e,a)};t.prototype._checkMasksConfig=function(e){if(this._activeMasksConfig.length!=e.length)return true;var t=e.length;var r;var i;var a;var s;for(var n=0;n<t;n++){i=e[n];r=i.length;s=this._activeMasksConfig[n];a=s.length;if(a!=r)return true;for(var o=0;o<r;o++){if(s[o]!=i[o])return true}}return false};return t}(o);t.exports=m},{"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-display/lib/events/RendererEvent":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/sort/RenderableMergeSort":undefined,"awayjs-display/lib/traverse/EntityCollector":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/events/StageEvent":undefined,"awayjs-stagegl/lib/managers/StageManager":undefined}],"awayjs-renderergl/lib/animators/AnimationSetBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/library/AssetBase");var s=e("awayjs-core/lib/errors/AbstractMethodError");var n=e("awayjs-renderergl/lib/errors/AnimationSetError");var o=function(e){i(t,e);function t(){e.call(this);this._animations=new Array;this._animationNames=new Array;this._animationDictionary=new Object}t.prototype._pFindTempReg=function(e,t){if(t===void 0){t=null}var r=0;var i;while(true){i="vt"+r;if(e.indexOf(i)==-1&&t!=i)return i;++r}return null};Object.defineProperty(t.prototype,"usesCPU",{get:function(){return this._usesCPU},enumerable:true,configurable:true});t.prototype.resetGPUCompatibility=function(){this._usesCPU=false};t.prototype.cancelGPUCompatibility=function(){this._usesCPU=true};t.prototype.getAGALVertexCode=function(e){throw new s};t.prototype.activate=function(e,t){throw new s};t.prototype.deactivate=function(e,t){throw new s};t.prototype.getAGALFragmentCode=function(e,t){throw new s};t.prototype.getAGALUVCode=function(e){throw new s};t.prototype.doneAGALCode=function(e){throw new s};Object.defineProperty(t.prototype,"assetType",{get:function(){return t.assetType},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:true,configurable:true});t.prototype.hasAnimation=function(e){return this._animationDictionary[e]!=null};t.prototype.getAnimation=function(e){return this._animationDictionary[e]};t.prototype.addAnimation=function(e){if(this._animationDictionary[e.name])throw new n("root node name '"+e.name+"' already exists in the set");this._animationDictionary[e.name]=e;this._animations.push(e);this._animationNames.push(e.name)};t.prototype.dispose=function(){};t.assetType="[asset AnimationSet]";return t}(a);t.exports=o},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined,"awayjs-renderergl/lib/errors/AnimationSetError":"awayjs-renderergl/lib/errors/AnimationSetError"}],"awayjs-renderergl/lib/animators/AnimatorBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/library/AssetBase");var s=e("awayjs-core/lib/errors/AbstractMethodError");var n=e("awayjs-core/lib/utils/RequestAnimationFrame");var o=e("awayjs-core/lib/utils/getTimer");var l=e("awayjs-renderergl/lib/events/AnimatorEvent");var h=function(e){i(t,e);function t(t){e.call(this);this._autoUpdate=true;this._time=0;this._playbackSpeed=1;this._pOwners=new Array;this._pAbsoluteTime=0;this._animationStates=new Object;this.updatePosition=true;this._pAnimationSet=t;this._broadcaster=new n(this.onEnterFrame,this)}t.prototype.getAnimationState=function(e){var t=e.stateClass;var r=e.id;if(this._animationStates[r]==null)this._animationStates[r]=new t(this,e);return this._animationStates[r]};t.prototype.getAnimationStateByName=function(e){return this.getAnimationState(this._pAnimationSet.getAnimation(e))};Object.defineProperty(t.prototype,"absoluteTime",{get:function(){return this._pAbsoluteTime},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationSet",{get:function(){return this._pAnimationSet},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"activeState",{get:function(){return this._pActiveState},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"activeAnimation",{get:function(){return this._pAnimationSet.getAnimation(this._pActiveAnimationName)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"activeAnimationName",{get:function(){return this._pActiveAnimationName},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){if(this._autoUpdate==e)return;this._autoUpdate=e;if(this._autoUpdate)this.start();else this.stop()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(e){if(this._time==e)return;this.update(e)},enumerable:true,configurable:true});t.prototype.phase=function(e){this._pActiveState.phase(e)};Object.defineProperty(t.prototype,"playbackSpeed",{get:function(){return this._playbackSpeed},set:function(e){this._playbackSpeed=e},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,t,r,i,a,n){throw new s};t.prototype.start=function(){if(this._isPlaying||!this._autoUpdate)return;this._time=this._pAbsoluteTime=o();this._isPlaying=true;this._broadcaster.start();if(!this.hasEventListener(l.START))return;if(this._startEvent==null)this._startEvent=new l(l.START,this);this.dispatchEvent(this._startEvent)};t.prototype.stop=function(){if(!this._isPlaying)return;this._isPlaying=false;this._broadcaster.stop();if(!this.hasEventListener(l.STOP))return;if(this._stopEvent==null)this._stopEvent=new l(l.STOP,this);this.dispatchEvent(this._stopEvent)};t.prototype.update=function(e){var t=(e-this._time)*this.playbackSpeed;this._pUpdateDeltaTime(t);this._time=e};t.prototype.reset=function(e,t){if(t===void 0){t=0}this.getAnimationState(this._pAnimationSet.getAnimation(e)).offset(t+this._pAbsoluteTime)
};t.prototype.addOwner=function(e){this._pOwners.push(e)};t.prototype.removeOwner=function(e){this._pOwners.splice(this._pOwners.indexOf(e),1)};t.prototype._pUpdateDeltaTime=function(e){this._pAbsoluteTime+=e;this._pActiveState.update(this._pAbsoluteTime);if(this.updatePosition)this.applyPositionDelta()};t.prototype.onEnterFrame=function(e){if(e===void 0){e=null}this.update(o())};t.prototype.applyPositionDelta=function(){var e=this._pActiveState.positionDelta;var t=e.length;var r;if(t>0){r=this._pOwners.length;for(var i=0;i<r;++i)this._pOwners[i].translateLocal(e,t)}};t.prototype.dispatchCycleEvent=function(){if(this.hasEventListener(l.CYCLE_COMPLETE)){if(this._cycleEvent==null)this._cycleEvent=new l(l.CYCLE_COMPLETE,this);this.dispatchEvent(this._cycleEvent)}};t.prototype.clone=function(){throw new s};t.prototype.dispose=function(){};t.prototype.testGPUCompatibility=function(e){throw new s};Object.defineProperty(t.prototype,"assetType",{get:function(){return t.assetType},enumerable:true,configurable:true});t.prototype.getRenderableSubGeometry=function(e,t){return t};t.assetType="[asset Animator]";return t}(a);t.exports=h},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AssetBase":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-core/lib/utils/getTimer":undefined,"awayjs-renderergl/lib/events/AnimatorEvent":"awayjs-renderergl/lib/events/AnimatorEvent"}],"awayjs-renderergl/lib/animators/ParticleAnimationSet":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/AnimationSetBase");var s=e("awayjs-renderergl/lib/animators/data/AnimationRegisterCache");var n=e("awayjs-renderergl/lib/animators/data/AnimationSubGeometry");var o=e("awayjs-renderergl/lib/animators/data/ParticleAnimationData");var l=e("awayjs-renderergl/lib/animators/data/ParticleProperties");var h=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var d=e("awayjs-renderergl/lib/animators/nodes/ParticleTimeNode");var p=function(e){i(t,e);function t(t,r,i){if(t===void 0){t=false}if(r===void 0){r=false}if(i===void 0){i=false}e.call(this);this._animationSubGeometries=new Object;this._particleNodes=new Array;this._localDynamicNodes=new Array;this._localStaticNodes=new Array;this._totalLenOfOneVertex=0;this.addAnimation(this._timeNode=new d(t,r,i))}Object.defineProperty(t.prototype,"particleNodes",{get:function(){return this._particleNodes},enumerable:true,configurable:true});t.prototype.addAnimation=function(t){var r;var i=t;i._iProcessAnimationSetting(this);if(i.mode==h.LOCAL_STATIC){i._iDataOffset=this._totalLenOfOneVertex;this._totalLenOfOneVertex+=i.dataLength;this._localStaticNodes.push(i)}else if(i.mode==h.LOCAL_DYNAMIC)this._localDynamicNodes.push(i);for(r=this._particleNodes.length-1;r>=0;r--){if(this._particleNodes[r].priority<=i.priority)break}this._particleNodes.splice(r+1,0,i);e.prototype.addAnimation.call(this,t)};t.prototype.activate=function(e,t){};t.prototype.deactivate=function(e,t){};t.prototype.getAGALVertexCode=function(e){this._iAnimationRegisterCache=e.animationRegisterCache;if(this._iAnimationRegisterCache==null)this._iAnimationRegisterCache=e.animationRegisterCache=new s(e.profile);this._iAnimationRegisterCache.vertexConstantOffset=e.numUsedVertexConstants;this._iAnimationRegisterCache.vertexAttributesOffset=e.numUsedStreams;this._iAnimationRegisterCache.varyingsOffset=e.numUsedVaryings;this._iAnimationRegisterCache.fragmentConstantOffset=e.numUsedFragmentConstants;this._iAnimationRegisterCache.hasUVNode=this.hasUVNode;this._iAnimationRegisterCache.needVelocity=this.needVelocity;this._iAnimationRegisterCache.hasBillboard=this.hasBillboard;this._iAnimationRegisterCache.sourceRegisters=e.animatableAttributes;this._iAnimationRegisterCache.targetRegisters=e.animationTargetRegisters;this._iAnimationRegisterCache.needFragmentAnimation=e.usesFragmentAnimation;this._iAnimationRegisterCache.needUVAnimation=!e.usesUVTransform;this._iAnimationRegisterCache.hasColorAddNode=this.hasColorAddNode;this._iAnimationRegisterCache.hasColorMulNode=this.hasColorMulNode;this._iAnimationRegisterCache.reset();var r="";r+=this._iAnimationRegisterCache.getInitCode();var i;var a;for(a=0;a<this._particleNodes.length;a++){i=this._particleNodes[a];if(i.priority<t.POST_PRIORITY)r+=i.getAGALVertexCode(e,this._iAnimationRegisterCache)}r+=this._iAnimationRegisterCache.getCombinationCode();for(a=0;a<this._particleNodes.length;a++){i=this._particleNodes[a];if(i.priority>=t.POST_PRIORITY&&i.priority<t.COLOR_PRIORITY)r+=i.getAGALVertexCode(e,this._iAnimationRegisterCache)}r+=this._iAnimationRegisterCache.initColorRegisters();for(a=0;a<this._particleNodes.length;a++){i=this._particleNodes[a];if(i.priority>=t.COLOR_PRIORITY)r+=i.getAGALVertexCode(e,this._iAnimationRegisterCache)}r+=this._iAnimationRegisterCache.getColorPassCode();return r};t.prototype.getAGALUVCode=function(e){var t="";if(this.hasUVNode){this._iAnimationRegisterCache.setUVSourceAndTarget(e.uvSource,e.uvTarget);t+="mov "+this._iAnimationRegisterCache.uvTarget+".xy,"+this._iAnimationRegisterCache.uvAttribute.toString()+"\n";var r;for(var i=0;i<this._particleNodes.length;i++)r=this._particleNodes[i];t+=r.getAGALUVCode(e,this._iAnimationRegisterCache);t+="mov "+this._iAnimationRegisterCache.uvVar.toString()+","+this._iAnimationRegisterCache.uvTarget+".xy\n"}else t+="mov "+e.uvTarget+","+e.uvSource+"\n";return t};t.prototype.getAGALFragmentCode=function(e,t){return this._iAnimationRegisterCache.getColorCombinationCode(t)};t.prototype.doneAGALCode=function(e){this._iAnimationRegisterCache.setDataLength();this._iAnimationRegisterCache.setVertexConst(this._iAnimationRegisterCache.vertexZeroConst.index,0,1,2,0)};Object.defineProperty(t.prototype,"usesCPU",{get:function(){return false},enumerable:true,configurable:true});t.prototype.cancelGPUCompatibility=function(){};t.prototype.dispose=function(){for(var t in this._animationSubGeometries)this._animationSubGeometries[t].dispose();e.prototype.dispose.call(this)};t.prototype.getAnimationSubGeometry=function(e){var t=e.parentMesh;var r=t.shareAnimationGeometry?this._animationSubGeometries[e.subGeometry.id]:this._animationSubGeometries[e.id];if(r)return r;this._iGenerateAnimationSubGeometries(t);return t.shareAnimationGeometry?this._animationSubGeometries[e.subGeometry.id]:this._animationSubGeometries[e.id]};t.prototype._iGenerateAnimationSubGeometries=function(e){if(this.initParticleFunc==null)throw new Error("no initParticleFunc set");var t=e.geometry;if(!t)throw new Error("Particle animation can only be performed on a ParticleGeometry object");var r,i,a;var s;var h=false;var d;var p;var u;for(r=0;r<e.subMeshes.length;r++){p=e.subMeshes[r];d=p.subGeometry;if(e.shareAnimationGeometry){s=this._animationSubGeometries[d.id];if(s)continue}s=new n;if(e.shareAnimationGeometry)this._animationSubGeometries[d.id]=s;else this._animationSubGeometries[p.id]=s;h=true;s.createVertexData(d.numVertices,this._totalLenOfOneVertex)}if(!h)return;var c=t.particles;var g=c.length;var f=t.numParticles;var _=new l;var m;var y;var v;var b;var x;var w;var C;var P;var S;var D;var j;_.total=f;_.startTime=0;_.duration=1e3;_.delay=.1;r=0;i=0;while(r<f){_.index=r;this.initParticleFunc.call(this.initParticleScope,_);for(a=0;a<this._localStaticNodes.length;a++)this._localStaticNodes[a]._iGeneratePropertyOfOneParticle(_);while(i<g&&(m=c[i]).particleIndex==r){for(a=0;a<e.subMeshes.length;a++){p=e.subMeshes[a];if(p.subGeometry==m.subGeometry){s=e.shareAnimationGeometry?this._animationSubGeometries[p.subGeometry.id]:this._animationSubGeometries[p.id];break}}C=m.numVertices;P=s.vertexData;S=C*this._totalLenOfOneVertex;D=s.numProcessedVertices*this._totalLenOfOneVertex;for(a=0;a<this._localStaticNodes.length;a++){u=this._localStaticNodes[a];w=u.oneData;y=u.dataLength;v=D+u._iDataOffset;for(b=0;b<S;b+=this._totalLenOfOneVertex){j=v+b;for(x=0;x<y;x++)P[j+x]=w[x]}}if(this._localDynamicNodes.length)s.animationParticles.push(new o(r,_.startTime,_.duration,_.delay,m));s.numProcessedVertices+=C;i++}r++}};t.POST_PRIORITY=9;t.COLOR_PRIORITY=18;return t}(a);t.exports=p},{"awayjs-renderergl/lib/animators/AnimationSetBase":"awayjs-renderergl/lib/animators/AnimationSetBase","awayjs-renderergl/lib/animators/data/AnimationRegisterCache":"awayjs-renderergl/lib/animators/data/AnimationRegisterCache","awayjs-renderergl/lib/animators/data/AnimationSubGeometry":"awayjs-renderergl/lib/animators/data/AnimationSubGeometry","awayjs-renderergl/lib/animators/data/ParticleAnimationData":"awayjs-renderergl/lib/animators/data/ParticleAnimationData","awayjs-renderergl/lib/animators/data/ParticleProperties":"awayjs-renderergl/lib/animators/data/ParticleProperties","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleTimeNode":"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode"}],"awayjs-renderergl/lib/animators/ParticleAnimator":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLProgramType");var s=e("awayjs-renderergl/lib/animators/AnimatorBase");var n=e("awayjs-renderergl/lib/animators/data/AnimationSubGeometry");var o=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var l=function(e){i(t,e);function t(t){e.call(this,t);this._animationParticleStates=new Array;this._animatorParticleStates=new Array;this._timeParticleStates=new Array;this._totalLenOfOneVertex=0;this._animatorSubGeometries=new Object;this._particleAnimationSet=t;var r;var i;for(var a=0;a<this._particleAnimationSet.particleNodes.length;a++){i=this._particleAnimationSet.particleNodes[a];r=this.getAnimationState(i);if(i.mode==o.LOCAL_DYNAMIC){this._animatorParticleStates.push(r);i._iDataOffset=this._totalLenOfOneVertex;this._totalLenOfOneVertex+=i.dataLength}else{this._animationParticleStates.push(r)}if(r.needUpdateTime)this._timeParticleStates.push(r)}}t.prototype.clone=function(){return new t(this._particleAnimationSet)};t.prototype.setRenderState=function(e,t,r,i,s,n){var o=this._particleAnimationSet._iAnimationRegisterCache;var l=t.subMesh;var h;var d;if(!l)throw new Error("Must be subMesh");var p=this._particleAnimationSet.getAnimationSubGeometry(l);for(d=0;d<this._animationParticleStates.length;d++)this._animationParticleStates[d].setRenderState(r,t,p,o,i);var u=this.getAnimatorSubGeometry(l);for(d=0;d<this._animatorParticleStates.length;d++)this._animatorParticleStates[d].setRenderState(r,t,u,o,i);r.context.setProgramConstantsFromArray(a.VERTEX,o.vertexConstantOffset,o.vertexConstantData,o.numVertexConstant);if(o.numFragmentConstant>0)r.context.setProgramConstantsFromArray(a.FRAGMENT,o.fragmentConstantOffset,o.fragmentConstantData,o.numFragmentConstant)};t.prototype.testGPUCompatibility=function(e){};t.prototype.start=function(){e.prototype.start.call(this);for(var t=0;t<this._timeParticleStates.length;t++)this._timeParticleStates[t].offset(this._pAbsoluteTime)};t.prototype._pUpdateDeltaTime=function(e){this._pAbsoluteTime+=e;for(var t=0;t<this._timeParticleStates.length;t++)this._timeParticleStates[t].update(this._pAbsoluteTime)};t.prototype.resetTime=function(e){if(e===void 0){e=0}for(var t=0;t<this._timeParticleStates.length;t++)this._timeParticleStates[t].offset(this._pAbsoluteTime+e);this.update(this.time)};t.prototype.dispose=function(){for(var e in this._animatorSubGeometries)this._animatorSubGeometries[e].dispose()};t.prototype.getAnimatorSubGeometry=function(e){if(!this._animatorParticleStates.length)return;var t=e.subGeometry;var r=this._animatorSubGeometries[t.id]=new n;r.createVertexData(t.numVertices,this._totalLenOfOneVertex);r.animationParticles=this._particleAnimationSet.getAnimationSubGeometry(e).animationParticles};return t}(s);t.exports=l},{"awayjs-renderergl/lib/animators/AnimatorBase":"awayjs-renderergl/lib/animators/AnimatorBase","awayjs-renderergl/lib/animators/data/AnimationSubGeometry":"awayjs-renderergl/lib/animators/data/AnimationSubGeometry","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/animators/SkeletonAnimationSet":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/AnimationSetBase");var s=function(e){i(t,e);function t(t){if(t===void 0){t=4}e.call(this);this._jointsPerVertex=t}Object.defineProperty(t.prototype,"jointsPerVertex",{get:function(){return this._jointsPerVertex},enumerable:true,configurable:true});t.prototype.getAGALVertexCode=function(e){var t=e.animatableAttributes.length;var r=e.numUsedVertexConstants;var i=r+1;var a=r+2;var s="va"+e.numUsedStreams;var n="va"+(e.numUsedStreams+1);var o=[s+".x",s+".y",s+".z",s+".w"];var l=[n+".x",n+".y",n+".z",n+".w"];var h=this._pFindTempReg(e.animationTargetRegisters);var d=this._pFindTempReg(e.animationTargetRegisters,h);var p="dp4";var u="";for(var c=0;c<t;++c){var g=e.animatableAttributes[c];for(var f=0;f<this._jointsPerVertex;++f){u+=p+" "+h+".x, "+g+", vc["+o[f]+"+"+r+"]\n"+p+" "+h+".y, "+g+", vc["+o[f]+"+"+i+"]\n"+p+" "+h+".z, "+g+", vc["+o[f]+"+"+a+"]\n"+"mov "+h+".w, "+g+".w\n"+"mul "+h+", "+h+", "+l[f]+"\n";if(f==0)u+="mov "+d+", "+h+"\n";else u+="add "+d+", "+d+", "+h+"\n"}p="dp3";u+="mov "+e.animationTargetRegisters[c]+", "+d+"\n"}return u};t.prototype.activate=function(e,t){};t.prototype.deactivate=function(e,t){};t.prototype.getAGALFragmentCode=function(e,t){return""};t.prototype.getAGALUVCode=function(e){return"mov "+e.uvTarget+","+e.uvSource+"\n"};t.prototype.doneAGALCode=function(e){};return t}(a);t.exports=s},{"awayjs-renderergl/lib/animators/AnimationSetBase":"awayjs-renderergl/lib/animators/AnimationSetBase"}],"awayjs-renderergl/lib/animators/SkeletonAnimator":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/events/SubGeometryEvent");var s=e("awayjs-stagegl/lib/base/ContextGLProgramType");var n=e("awayjs-renderergl/lib/animators/AnimatorBase");var o=e("awayjs-renderergl/lib/animators/data/JointPose");var l=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var h=e("awayjs-renderergl/lib/events/AnimationStateEvent");var d=function(e){i(t,e);function t(t,r,i){var a=this;if(i===void 0){i=false}e.call(this,t);this._globalPose=new l;this._morphedSubGeometry=new Object;this._morphedSubGeometryDirty=new Object;this._skeleton=r;this._forceCPU=i;this._jointsPerVertex=t.jointsPerVertex;this._numJoints=this._skeleton.numJoints;this._globalMatrices=new Float32Array(this._numJoints*12);var s=0;for(var n=0;n<this._numJoints;++n){this._globalMatrices[s++]=1;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=1;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=0;this._globalMatrices[s++]=1;this._globalMatrices[s++]=0}this._onTransitionCompleteDelegate=function(e){return a.onTransitionComplete(e)};this._onIndicesUpdateDelegate=function(e){return a.onIndicesUpdate(e)};this._onVerticesUpdateDelegate=function(e){return a.onVerticesUpdate(e)}}Object.defineProperty(t.prototype,"globalMatrices",{get:function(){if(this._globalPropertiesDirty)this.updateGlobalProperties();return this._globalMatrices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"globalPose",{get:function(){if(this._globalPropertiesDirty)this.updateGlobalProperties();return this._globalPose},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"skeleton",{get:function(){return this._skeleton},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"forceCPU",{get:function(){return this._forceCPU},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"useCondensedIndices",{get:function(){return this._useCondensedIndices},set:function(e){this._useCondensedIndices=e},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this._pAnimationSet,this._skeleton,this._forceCPU)};t.prototype.play=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=NaN}if(this._pActiveAnimationName==e)return;this._pActiveAnimationName=e;if(!this._pAnimationSet.hasAnimation(e))throw new Error("Animation root node "+e+" not found!");if(t&&this._pActiveNode){this._pActiveNode=t.getAnimationNode(this,this._pActiveNode,this._pAnimationSet.getAnimation(e),this._pAbsoluteTime);this._pActiveNode.addEventListener(h.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate)}else this._pActiveNode=this._pAnimationSet.getAnimation(e);this._pActiveState=this.getAnimationState(this._pActiveNode);if(this.updatePosition){this._pActiveState.update(this._pAbsoluteTime);this._pActiveState.positionDelta}this._activeSkeletonState=this._pActiveState;this.start();if(!isNaN(r))this.reset(e,r)};t.prototype.setRenderState=function(e,t,r,i,a,n){if(this._globalPropertiesDirty)this.updateGlobalProperties();var o=t.subMesh.subGeometry;o.useCondensedIndices=this._useCondensedIndices;if(this._useCondensedIndices){this.updateCondensedMatrices(o.condensedIndexLookUp);r.context.setProgramConstantsFromArray(s.VERTEX,a,this._condensedMatrices,this._condensedMatrices.length/4)}else{if(this._pAnimationSet.usesCPU){if(this._morphedSubGeometryDirty[o.id])this.morphSubGeometry(t,o);return}r.context.setProgramConstantsFromArray(s.VERTEX,a,this._globalMatrices,this._numJoints*3)}e.jointIndexIndex=n++;e.jointWeightIndex=n++};t.prototype.testGPUCompatibility=function(e){if(!this._useCondensedIndices&&(this._forceCPU||this._jointsPerVertex>4||e.numUsedVertexConstants+this._numJoints*3>128))this._pAnimationSet.cancelGPUCompatibility()};t.prototype._pUpdateDeltaTime=function(t){e.prototype._pUpdateDeltaTime.call(this,t);this._globalPropertiesDirty=true;if(this._pAnimationSet.usesCPU)for(var r in this._morphedSubGeometryDirty)this._morphedSubGeometryDirty[r]=true};t.prototype.updateCondensedMatrices=function(e){var t=0,r=0;var i=e.length;var a;this._condensedMatrices=new Float32Array(i*12);for(var s=0;s<i;s++){a=e[s]*12;r=12;while(r--)this._condensedMatrices[t++]=this._globalMatrices[a++]}};t.prototype.updateGlobalProperties=function(){this._globalPropertiesDirty=false;this.localToGlobalPose(this._activeSkeletonState.getSkeletonPose(this._skeleton),this._globalPose,this._skeleton);var e=0;var t=this._globalPose.jointPoses;var r;var i,a,s,n;var o,l,h;var d,p,u;var c,g,f;var _,m,y;var v,b,x;var w,C,P,S;var D,j,R,T;var O,A,V,I;var F=this._skeleton.joints;var M;var N;var L;var E;for(var B=0;B<this._numJoints;++B){M=t[B];N=M.orientation;L=M.translation;i=N.x;a=N.y;s=N.z;n=N.w;o=(E=2*i)*a;l=E*s;h=E*n;d=(E=2*a)*s;p=E*n;u=2*s*n;d=2*a*s;p=2*a*n;u=2*s*n;i*=i;a*=a;s*=s;n*=n;c=(E=i-a)-s+n;g=o-u;f=l+p;_=o+u;m=-E-s+n;y=d-h;v=l-p;b=d+h;x=-i-a+s+n;r=F[B].inverseBindPose;w=r[0];C=r[4];P=r[8];S=r[12];D=r[1];j=r[5];R=r[9];T=r[13];O=r[2];A=r[6];V=r[10];I=r[14];this._globalMatrices[e]=c*w+g*D+f*O;this._globalMatrices[e+1]=c*C+g*j+f*A;this._globalMatrices[e+2]=c*P+g*R+f*V;this._globalMatrices[e+3]=c*S+g*T+f*I+L.x;this._globalMatrices[e+4]=_*w+m*D+y*O;this._globalMatrices[e+5]=_*C+m*j+y*A;this._globalMatrices[e+6]=_*P+m*R+y*V;this._globalMatrices[e+7]=_*S+m*T+y*I+L.y;this._globalMatrices[e+8]=v*w+b*D+x*O;this._globalMatrices[e+9]=v*C+b*j+x*A;this._globalMatrices[e+10]=v*P+b*R+x*V;this._globalMatrices[e+11]=v*S+b*T+x*I+L.z;e=e+12}};t.prototype.getRenderableSubGeometry=function(e,t){this._morphedSubGeometryDirty[t.id]=true;if(!this._pAnimationSet.usesCPU)return t;var r;if(!(r=this._morphedSubGeometry[t.id])){r=this._morphedSubGeometry[t.id]=t.clone();r.autoDeriveNormals=false;r.autoDeriveTangents=false;r.autoDeriveUVs=false;t.addEventListener(a.INDICES_UPDATED,this._onIndicesUpdateDelegate);t.addEventListener(a.VERTICES_UPDATED,this._onVerticesUpdateDelegate)}return r};t.prototype.morphSubGeometry=function(e,t){this._morphedSubGeometryDirty[t.id]=false;var r=t.numVertices;var i=t.positions.get(r);var a=t.normals.get(r);var s=t.tangents.get(r);var n=t.jointIndices.get(r);var o=t.jointWeights.get(r);var l=this._morphedSubGeometry[t.id];var h=l.positions.get(r);var d=l.normals.get(r);var p=l.tangents.get(r);var u=0;var c=0;var g;var f,_,m;var y,v,b;var x,w,C;var P=i.length;var S;var D,j,R;var T,O,A;var V,I,F;var M,N,L,E;var B,z,G,U;var k,X,W,H;while(u<P){D=i[u];j=i[u+1];R=i[u+2];T=a[u];O=a[u+1];A=a[u+2];V=s[u];I=s[u+1];F=s[u+2];f=0;_=0;m=0;y=0;v=0;b=0;x=0;w=0;C=0;g=0;while(g<this._jointsPerVertex){S=o[c];if(S>0){var q=n[c++]<<2;M=this._globalMatrices[q];N=this._globalMatrices[q+1];L=this._globalMatrices[q+2];E=this._globalMatrices[q+3];B=this._globalMatrices[q+4];z=this._globalMatrices[q+5];G=this._globalMatrices[q+6];U=this._globalMatrices[q+7];k=this._globalMatrices[q+8];X=this._globalMatrices[q+9];W=this._globalMatrices[q+10];H=this._globalMatrices[q+11];f+=S*(M*D+N*j+L*R+E);_+=S*(B*D+z*j+G*R+U);m+=S*(k*D+X*j+W*R+H);y+=S*(M*T+N*O+L*A);v+=S*(B*T+z*O+G*A);b+=S*(k*T+X*O+W*A);x+=S*(M*V+N*I+L*F);w+=S*(B*V+z*I+G*F);C+=S*(k*V+X*I+W*F);++g}else{c+=this._jointsPerVertex-g;g=this._jointsPerVertex}}h[u]=f;h[u+1]=_;h[u+2]=m;d[u]=y;d[u+1]=v;d[u+2]=b;p[u]=x;p[u+1]=w;p[u+2]=C;u+=3}l.setPositions(h);l.setNormals(d);l.setTangents(p)};t.prototype.localToGlobalPose=function(e,t,r){var i=t.jointPoses;var a;var s=r.joints;var n=e.numJointPoses;var l=e.jointPoses;var h;var d;var p;var u;var c;var g;var f;var _;var m,y,v,b;var x,w,C,P;var S,D,j;if(i.length!=n)i.length=n;for(var R=0;R<n;++R){a=i[R];if(a==null)a=i[R]=new o;d=s[R];h=d.parentIndex;u=l[R];_=a.orientation;f=a.translation;if(h<0){g=u.translation;c=u.orientation;_.x=c.x;_.y=c.y;_.z=c.z;_.w=c.w;f.x=g.x;f.y=g.y;f.z=g.z}else{p=i[h];c=p.orientation;g=u.translation;x=c.x;w=c.y;C=c.z;P=c.w;S=g.x;D=g.y;j=g.z;b=-x*S-w*D-C*j;m=P*S+w*j-C*D;y=P*D-x*j+C*S;v=P*j+x*D-w*S;g=p.translation;f.x=-b*x+m*P-y*C+v*w+g.x;f.y=-b*w+m*C+y*P-v*x+g.y;f.z=-b*C-m*w+y*x+v*P+g.z;m=c.x;y=c.y;v=c.z;b=c.w;c=u.orientation;x=c.x;w=c.y;C=c.z;P=c.w;_.w=b*P-m*x-y*w-v*C;_.x=b*x+m*P+y*C-v*w;_.y=b*w-m*C+y*P+v*x;_.z=b*C+m*w-y*x+v*P}}};t.prototype.onTransitionComplete=function(e){if(e.type==h.TRANSITION_COMPLETE){e.animationNode.removeEventListener(h.TRANSITION_COMPLETE,this._onTransitionCompleteDelegate);if(this._pActiveState==e.animationState){this._pActiveNode=this._pAnimationSet.getAnimation(this._pActiveAnimationName);this._pActiveState=this.getAnimationState(this._pActiveNode);this._activeSkeletonState=this._pActiveState}}};t.prototype.onIndicesUpdate=function(e){var t=e.target;this._morphedSubGeometry[t.id].setIndices(t.indices)};t.prototype.onVerticesUpdate=function(e){var t=e.target;var r=this._morphedSubGeometry[t.id];switch(e.attributesView){case t.uvs:r.setUVs(t.uvs.get(t.numVertices));break;case t.secondaryUVs:r.setSecondaryUVs(t.secondaryUVs.get(t.numVertices));break}};return t}(n);t.exports=d},{"awayjs-display/lib/events/SubGeometryEvent":undefined,"awayjs-renderergl/lib/animators/AnimatorBase":"awayjs-renderergl/lib/animators/AnimatorBase","awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/events/AnimationStateEvent":"awayjs-renderergl/lib/events/AnimationStateEvent","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/animators/VertexAnimationSet":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/AnimationSetBase");var s=e("awayjs-renderergl/lib/animators/data/VertexAnimationMode");var n=function(e){i(t,e);function t(t,r){if(t===void 0){t=2}if(r===void 0){r="absolute"}e.call(this);this._numPoses=t;this._blendMode=r}Object.defineProperty(t.prototype,"numPoses",{get:function(){return this._numPoses},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},enumerable:true,configurable:true});t.prototype.getAGALVertexCode=function(e){if(this._blendMode==s.ABSOLUTE)return this.getAbsoluteAGALCode(e);else return this.getAdditiveAGALCode(e)};t.prototype.activate=function(e,t){};t.prototype.deactivate=function(e,t){};t.prototype.getAGALFragmentCode=function(e,t){return""};t.prototype.getAGALUVCode=function(e){return"mov "+e.uvTarget+","+e.uvSource+"\n"};t.prototype.doneAGALCode=function(e){};t.prototype.getAbsoluteAGALCode=function(e){var t="";var r=this._pFindTempReg(e.animationTargetRegisters);var i=this._pFindTempReg(e.animationTargetRegisters,r);var a=new Array("x","y","z","w");var s=e.animatableAttributes.length;var n="vc"+e.numUsedVertexConstants;if(s>2)s=2;var o=e.numUsedStreams;for(var l=0;l<s;++l){t+="mul "+r+", "+e.animatableAttributes[l]+", "+n+"."+a[0]+"\n";for(var h=1;h<this._numPoses;++h){t+="mul "+i+", va"+o+", "+n+"."+a[h]+"\n";if(h<this._numPoses-1)t+="add "+r+", "+r+", "+i+"\n";++o}t+="add "+e.animationTargetRegisters[l]+", "+r+", "+i+"\n"}if(e.tangentDependencies>0||e.outputsNormals){t+="dp3 "+r+".x, "+e.animatableAttributes[2]+", "+e.animationTargetRegisters[1]+"\n"+"mul "+r+", "+e.animationTargetRegisters[1]+", "+r+".x\n"+"sub "+e.animationTargetRegisters[2]+", "+e.animationTargetRegisters[2]+", "+r+"\n"}return t};t.prototype.getAdditiveAGALCode=function(e){var t="";var r=e.animatableAttributes.length;var i=["x","y","z","w"];var a=this._pFindTempReg(e.animationTargetRegisters);var s;var n=e.numUsedStreams;if(r>2)r=2;t+="mov  "+e.animationTargetRegisters[0]+", "+e.animatableAttributes[0]+"\n";if(e.normalDependencies>0)t+="mov "+e.animationTargetRegisters[1]+", "+e.animatableAttributes[1]+"\n";for(var o=0;o<r;++o){for(var l=0;l<this._numPoses;++l){t+="mul "+a+", va"+(n+s)+", vc"+e.numUsedVertexConstants+"."+i[l]+"\n"+"add "+e.animationTargetRegisters[o]+", "+e.animationTargetRegisters[o]+", "+a+"\n";s++}}if(e.tangentDependencies>0||e.outputsNormals){t+="dp3 "+a+".x, "+e.animatableAttributes[2]+", "+e.animationTargetRegisters[1]+"\n"+"mul "+a+", "+e.animationTargetRegisters[1]+", "+a+".x\n"+"sub "+e.animationTargetRegisters[2]+", "+e.animatableAttributes[2]+", "+a+"\n"}return t};return t}(a);t.exports=n},{"awayjs-renderergl/lib/animators/AnimationSetBase":"awayjs-renderergl/lib/animators/AnimationSetBase","awayjs-renderergl/lib/animators/data/VertexAnimationMode":"awayjs-renderergl/lib/animators/data/VertexAnimationMode"}],"awayjs-renderergl/lib/animators/VertexAnimator":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLProgramType");var s=e("awayjs-renderergl/lib/animators/AnimatorBase");var n=e("awayjs-renderergl/lib/animators/data/VertexAnimationMode");var o=e("awayjs-renderergl/lib/vos/SubGeometryVOPool");var l=function(e){i(t,e);function t(t){e.call(this,t);this._poses=new Array;this._weights=new Float32Array([1,0,0,0]);this._vertexAnimationSet=t;this._numPoses=t.numPoses;this._blendMode=t.blendMode;this._subGeometryVOPool=o.getPool()}t.prototype.clone=function(){return new t(this._vertexAnimationSet)};t.prototype.play=function(e,t,r){if(t===void 0){t=null}if(r===void 0){r=NaN}if(this._pActiveAnimationName==e)return;this._pActiveAnimationName=e;if(!this._pAnimationSet.hasAnimation(e))throw new Error("Animation root node "+e+" not found!");this._pActiveNode=this._pAnimationSet.getAnimation(e);this._pActiveState=this.getAnimationState(this._pActiveNode);if(this.updatePosition){this._pActiveState.update(this._pAbsoluteTime);this._pActiveState.positionDelta}this._activeVertexState=this._pActiveState;this.start();if(!isNaN(r))this.reset(e,r)};t.prototype._pUpdateDeltaTime=function(t){e.prototype._pUpdateDeltaTime.call(this,t);var r=false;if(this._poses[0]!=this._activeVertexState.currentGeometry){this._poses[0]=this._activeVertexState.currentGeometry;r=true}if(this._poses[1]!=this._activeVertexState.nextGeometry){this._poses[1]=this._activeVertexState.nextGeometry;r=true}this._weights[0]=1-(this._weights[1]=this._activeVertexState.blendWeight);if(r){var i;var a=this._pOwners.length;for(var s=0;s<a;s++){i=this._pOwners[s];i._iInvalidateRenderableGeometries()}}};t.prototype.setRenderState=function(e,t,r,i,s,o){var l=t.subMesh;var h=l.subGeometry;if(!this._poses.length){this.setNullPose(e,h,r,s,o);return}var d;var p=this._numPoses;r.context.setProgramConstantsFromArray(a.VERTEX,s,this._weights,1);if(this._blendMode==n.ABSOLUTE)d=1;else d=0;var u;for(;d<p;++d){h=this._poses[d].subGeometries[l._iIndex]||l.subGeometry;u=this._subGeometryVOPool.getItem(h);u._indexMappings=this._subGeometryVOPool.getItem(l.subGeometry).indexMappings;u.activateVertexBufferVO(o++,h.positions,r);if(e.normalDependencies>0)u.activateVertexBufferVO(o++,h.normals,r)}};t.prototype.setNullPose=function(e,t,r,i,s){r.context.setProgramConstantsFromArray(a.VERTEX,i,this._weights,1);var o=this._subGeometryVOPool.getItem(t);if(this._blendMode==n.ABSOLUTE){var l=this._numPoses;for(var h=1;h<l;++h){o.activateVertexBufferVO(s++,t.positions,r);if(e.normalDependencies>0)o.activateVertexBufferVO(s++,t.normals,r)}}};t.prototype.testGPUCompatibility=function(e){};t.prototype.getRenderableSubGeometry=function(e,t){if(this._blendMode==n.ABSOLUTE&&this._poses.length)return this._poses[0].subGeometries[e.subMesh._iIndex]||t;return t};return t}(s);t.exports=l},{"awayjs-renderergl/lib/animators/AnimatorBase":"awayjs-renderergl/lib/animators/AnimatorBase","awayjs-renderergl/lib/animators/data/VertexAnimationMode":"awayjs-renderergl/lib/animators/data/VertexAnimationMode","awayjs-renderergl/lib/vos/SubGeometryVOPool":"awayjs-renderergl/lib/vos/SubGeometryVOPool","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/animators/data/AnimationRegisterCache":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterCache");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=function(e){i(t,e);function t(t){e.call(this,t);this.indexDictionary=new Object}t.prototype.reset=function(){e.prototype.reset.call(this);this.rotationRegisters=new Array;this.positionAttribute=this.getRegisterFromString(this.sourceRegisters[0]);this.scaleAndRotateTarget=this.getRegisterFromString(this.targetRegisters[0]);this.addVertexTempUsages(this.scaleAndRotateTarget,1);for(var t=1;t<this.targetRegisters.length;t++){this.rotationRegisters.push(this.getRegisterFromString(this.targetRegisters[t]));this.addVertexTempUsages(this.rotationRegisters[t-1],1)}this.scaleAndRotateTarget=new s(this.scaleAndRotateTarget.regName,this.scaleAndRotateTarget.index);this.vertexZeroConst=this.getFreeVertexConstant();this.vertexZeroConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,0);this.vertexOneConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,1);this.vertexTwoConst=new s(this.vertexZeroConst.regName,this.vertexZeroConst.index,2);this.positionTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.positionTarget,1);this.positionTarget=new s(this.positionTarget.regName,this.positionTarget.index);if(this.needVelocity){this.velocityTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.velocityTarget,1);
this.velocityTarget=new s(this.velocityTarget.regName,this.velocityTarget.index);this.vertexTime=new s(this.velocityTarget.regName,this.velocityTarget.index,3);this.vertexLife=new s(this.positionTarget.regName,this.positionTarget.index,3)}else{var r=this.getFreeVertexVectorTemp();this.addVertexTempUsages(r,1);this.vertexTime=new s(r.regName,r.index,0);this.vertexLife=new s(r.regName,r.index,1)}};t.prototype.setUVSourceAndTarget=function(e,t){this.uvVar=this.getRegisterFromString(t);this.uvAttribute=this.getRegisterFromString(e);this.uvTarget=new s(this.positionTarget.regName,this.positionTarget.index)};t.prototype.setRegisterIndex=function(e,t,r){var i=this.indexDictionary[e.id];if(i==null)i=this.indexDictionary[e.id]=new Array(8);i[t]=r};t.prototype.getRegisterIndex=function(e,t){return this.indexDictionary[e.id][t]};t.prototype.getInitCode=function(){var e=this.sourceRegisters.length;var t="";for(var r=0;r<e;r++)t+="mov "+this.targetRegisters[r]+","+this.sourceRegisters[r]+"\n";t+="mov "+this.positionTarget+".xyz,"+this.vertexZeroConst.toString()+"\n";if(this.needVelocity)t+="mov "+this.velocityTarget+".xyz,"+this.vertexZeroConst.toString()+"\n";return t};t.prototype.getCombinationCode=function(){return"add "+this.scaleAndRotateTarget+".xyz,"+this.scaleAndRotateTarget+".xyz,"+this.positionTarget+".xyz\n"};t.prototype.initColorRegisters=function(){var e="";if(this.hasColorMulNode){this.colorMulTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.colorMulTarget,1);this.colorMulVary=this.getFreeVarying();e+="mov "+this.colorMulTarget+","+this.vertexOneConst+"\n"}if(this.hasColorAddNode){this.colorAddTarget=this.getFreeVertexVectorTemp();this.addVertexTempUsages(this.colorAddTarget,1);this.colorAddVary=this.getFreeVarying();e+="mov "+this.colorAddTarget+","+this.vertexZeroConst+"\n"}return e};t.prototype.getColorPassCode=function(){var e="";if(this.needFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)){if(this.hasColorMulNode)e+="mov "+this.colorMulVary+","+this.colorMulTarget+"\n";if(this.hasColorAddNode)e+="mov "+this.colorAddVary+","+this.colorAddTarget+"\n"}return e};t.prototype.getColorCombinationCode=function(e){var t="";if(this.needFragmentAnimation&&(this.hasColorAddNode||this.hasColorMulNode)){var r=this.getRegisterFromString(e);this.addFragmentTempUsages(r,1);if(this.hasColorMulNode)t+="mul "+r+","+r+","+this.colorMulVary+"\n";if(this.hasColorAddNode)t+="add "+r+","+r+","+this.colorAddVary+"\n"}return t};t.prototype.getRegisterFromString=function(e){var t=e.split(/(\d+)/);return new s(t[0],parseInt(t[1]))};Object.defineProperty(t.prototype,"numVertexConstant",{get:function(){return this._numVertexConstant},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numFragmentConstant",{get:function(){return this._numFragmentConstant},enumerable:true,configurable:true});t.prototype.setDataLength=function(){this._numVertexConstant=this.numUsedVertexConstants-this.vertexConstantOffset;this._numFragmentConstant=this.numUsedFragmentConstants-this.fragmentConstantOffset;this.vertexConstantData=new Float32Array(this._numVertexConstant*4);this.fragmentConstantData=new Float32Array(this._numFragmentConstant*4)};t.prototype.setVertexConst=function(e,t,r,i,a){if(t===void 0){t=0}if(r===void 0){r=0}if(i===void 0){i=0}if(a===void 0){a=0}var s=(e-this.vertexConstantOffset)*4;this.vertexConstantData[s++]=t;this.vertexConstantData[s++]=r;this.vertexConstantData[s++]=i;this.vertexConstantData[s]=a};t.prototype.setVertexConstFromArray=function(e,t){var r=(e-this.vertexConstantOffset)*4;for(var i=0;i<t.length;i++)this.vertexConstantData[r++]=t[i]};t.prototype.setVertexConstFromMatrix=function(e,t){var r=t.rawData;var i=(e-this.vertexConstantOffset)*4;this.vertexConstantData[i++]=r[0];this.vertexConstantData[i++]=r[4];this.vertexConstantData[i++]=r[8];this.vertexConstantData[i++]=r[12];this.vertexConstantData[i++]=r[1];this.vertexConstantData[i++]=r[5];this.vertexConstantData[i++]=r[9];this.vertexConstantData[i++]=r[13];this.vertexConstantData[i++]=r[2];this.vertexConstantData[i++]=r[6];this.vertexConstantData[i++]=r[10];this.vertexConstantData[i++]=r[14];this.vertexConstantData[i++]=r[3];this.vertexConstantData[i++]=r[7];this.vertexConstantData[i++]=r[11];this.vertexConstantData[i]=r[15]};t.prototype.setFragmentConst=function(e,t,r,i,a){if(t===void 0){t=0}if(r===void 0){r=0}if(i===void 0){i=0}if(a===void 0){a=0}var s=(e-this.fragmentConstantOffset)*4;this.fragmentConstantData[s++]=t;this.fragmentConstantData[s++]=r;this.fragmentConstantData[s++]=i;this.fragmentConstantData[s]=a};return t}(a);t.exports=n},{"awayjs-renderergl/lib/shaders/ShaderRegisterCache":"awayjs-renderergl/lib/shaders/ShaderRegisterCache","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/data/AnimationSubGeometry":[function(e,t,r){var i=function(){function e(){this._pVertexBuffer=new Array(8);this._pBufferContext=new Array(8);this._pBufferDirty=new Array(8);this.numProcessedVertices=0;this.previousTime=Number.NEGATIVE_INFINITY;this.animationParticles=new Array;for(var t=0;t<8;t++)this._pBufferDirty[t]=true;this._iUniqueId=e.SUBGEOM_ID_COUNT++}e.prototype.createVertexData=function(e,t){this._numVertices=e;this._totalLenOfOneVertex=t;this._pVertexData=new Array(e*t)};e.prototype.activateVertexBuffer=function(e,t,r,i){var a=r.stageIndex;var s=r.context;var n=this._pVertexBuffer[a];if(!n||this._pBufferContext[a]!=s){n=this._pVertexBuffer[a]=s.createVertexBuffer(this._numVertices,this._totalLenOfOneVertex*4);this._pBufferContext[a]=s;this._pBufferDirty[a]=true}if(this._pBufferDirty[a]){n.uploadFromArray(this._pVertexData,0,this._numVertices);this._pBufferDirty[a]=false}s.setVertexBufferAt(e,n,t*4,i)};e.prototype.dispose=function(){while(this._pVertexBuffer.length){var e=this._pVertexBuffer.pop();if(e)e.dispose()}};e.prototype.invalidateBuffer=function(){for(var e=0;e<8;e++)this._pBufferDirty[e]=true};Object.defineProperty(e.prototype,"vertexData",{get:function(){return this._pVertexData},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"totalLenOfOneVertex",{get:function(){return this._totalLenOfOneVertex},enumerable:true,configurable:true});e.SUBGEOM_ID_COUNT=0;return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/ColorSegmentPoint":[function(e,t,r){var i=function(){function e(e,t){if(e<=0||e>=1)throw new Error("life exceeds range (0,1)");this._life=e;this._color=t}Object.defineProperty(e.prototype,"color",{get:function(){return this._color},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"life",{get:function(){return this._life},enumerable:true,configurable:true});return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/JointPose":[function(e,t,r){var i=e("awayjs-core/lib/geom/Matrix3D");var a=e("awayjs-core/lib/geom/Quaternion");var s=e("awayjs-core/lib/geom/Vector3D");var n=function(){function e(){this.orientation=new a;this.translation=new s}e.prototype.toMatrix3D=function(e){if(e===void 0){e=null}if(e==null)e=new i;this.orientation.toMatrix3D(e);e.appendTranslation(this.translation.x,this.translation.y,this.translation.z);return e};e.prototype.copyFrom=function(e){var t=e.orientation;var r=e.translation;this.orientation.x=t.x;this.orientation.y=t.y;this.orientation.z=t.z;this.orientation.w=t.w;this.translation.x=r.x;this.translation.y=r.y;this.translation.z=r.z};return e}();t.exports=n},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-renderergl/lib/animators/data/ParticleAnimationData":[function(e,t,r){var i=function(){function e(e,t,r,i,a){this.index=e;this.startTime=t;this.totalTime=r+i;this.duration=r;this.delay=i;this.startVertexIndex=a.startVertexIndex;this.numVertices=a.numVertices}return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/ParticleData":[function(e,t,r){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":[function(e,t,r){var i=function(){function e(){}e.GLOBAL=0;e.LOCAL_STATIC=1;e.LOCAL_DYNAMIC=2;return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/ParticleProperties":[function(e,t,r){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/SkeletonJoint":[function(e,t,r){var i=function(){function e(){this.parentIndex=-1}return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/data/SkeletonPose":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/library/AssetBase");var s=e("awayjs-renderergl/lib/animators/data/JointPose");var n=function(e){i(t,e);function t(){e.call(this);this.jointPoses=new Array}Object.defineProperty(t.prototype,"numJointPoses",{get:function(){return this.jointPoses.length},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"assetType",{get:function(){return t.assetType},enumerable:true,configurable:true});t.prototype.jointPoseFromName=function(e){var t=this.jointPoseIndexFromName(e);if(t!=-1)return this.jointPoses[t];else return null};t.prototype.jointPoseIndexFromName=function(e){var t;var r;for(var i;i<this.jointPoses.length;i++){r=this.jointPoses[i];if(r.name==e)return t;t++}return-1};t.prototype.clone=function(){var e=new t;var r=this.jointPoses.length;for(var i=0;i<r;i++){var a=new s;var n=this.jointPoses[i];a.name=n.name;a.copyFrom(n);e.jointPoses[i]=a}return e};t.prototype.dispose=function(){this.jointPoses.length=0};t.assetType="[asset SkeletonPose]";return t}(a);t.exports=n},{"awayjs-core/lib/library/AssetBase":undefined,"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose"}],"awayjs-renderergl/lib/animators/data/Skeleton":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/library/AssetBase");var s=function(e){i(t,e);function t(){e.call(this);this.joints=new Array}Object.defineProperty(t.prototype,"numJoints",{get:function(){return this.joints.length},enumerable:true,configurable:true});t.prototype.jointFromName=function(e){var t=this.jointIndexFromName(e);if(t!=-1)return this.joints[t];else return null};t.prototype.jointIndexFromName=function(e){var t;var r;for(var i;i<this.joints.length;i++){r=this.joints[i];if(r.name==e)return t;t++}return-1};t.prototype.dispose=function(){this.joints.length=0};Object.defineProperty(t.prototype,"assetType",{get:function(){return t.assetType},enumerable:true,configurable:true});t.assetType="[asset Skeleton]";return t}(a);t.exports=s},{"awayjs-core/lib/library/AssetBase":undefined}],"awayjs-renderergl/lib/animators/data/VertexAnimationMode":[function(e,t,r){var i=function(){function e(){}e.ADDITIVE="additive";e.ABSOLUTE="absolute";return e}();t.exports=i},{}],"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var n=function(e){i(t,e);function t(){e.call(this);this._pLooping=true;this._pTotalDuration=0;this._pStitchDirty=true;this._pStitchFinalFrame=false;this._pNumFrames=0;this._pDurations=new Array;this._pTotalDelta=new a;this.fixedFrameRate=true}Object.defineProperty(t.prototype,"looping",{get:function(){return this._pLooping},set:function(e){if(this._pLooping==e)return;this._pLooping=e;this._pStitchDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"stitchFinalFrame",{get:function(){return this._pStitchFinalFrame},set:function(e){if(this._pStitchFinalFrame==e)return;this._pStitchFinalFrame=e;this._pStitchDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"totalDuration",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pTotalDuration},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"totalDelta",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pTotalDelta},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lastFrame",{get:function(){if(this._pStitchDirty)this._pUpdateStitch();return this._pLastFrame},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"durations",{get:function(){return this._pDurations},enumerable:true,configurable:true});t.prototype._pUpdateStitch=function(){this._pStitchDirty=false;this._pLastFrame=this._pStitchFinalFrame?this._pNumFrames:this._pNumFrames-1;this._pTotalDuration=0;this._pTotalDelta.x=0;this._pTotalDelta.y=0;this._pTotalDelta.z=0};return t}(s);t.exports=n},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleAccelerationNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=e("awayjs-renderergl/lib/animators/states/ParticleAccelerationState");var l=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticleAcceleration",t,3);this._pStateClass=o;this._acceleration=r||new a}t.prototype.pGetAGALVertexCode=function(e,t){var r=this._pMode==s.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,o.ACCELERATION_INDEX,r.index);var i=t.getFreeVertexVectorTemp();t.addVertexTempUsages(i,1);var a="mul "+i+","+t.vertexTime+","+r+"\n";if(t.needVelocity){var n=t.getFreeVertexVectorTemp();a+="mul "+n+","+i+","+t.vertexTwoConst+"\n";a+="add "+t.velocityTarget+".xyz,"+n+".xyz,"+t.velocityTarget+".xyz\n"}t.removeVertexTempUsage(i);a+="mul "+i+","+i+","+t.vertexTime+"\n";a+="add "+t.positionTarget+".xyz,"+i+","+t.positionTarget+".xyz\n";return a};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.ACCELERATION_VECTOR3D];if(!r)throw new Error("there is no "+t.ACCELERATION_VECTOR3D+" in param!");this._pOneData[0]=r.x/2;this._pOneData[1]=r.y/2;this._pOneData[2]=r.z/2};t.ACCELERATION_VECTOR3D="AccelerationVector3D";return t}(n);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleAccelerationState":"awayjs-renderergl/lib/animators/states/ParticleAccelerationState"}],"awayjs-renderergl/lib/animators/nodes/ParticleBezierCurveNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleBezierCurveState");var h=function(e){i(t,e);function t(t,r,i){if(r===void 0){r=null}if(i===void 0){i=null}e.call(this,"ParticleBezierCurve",t,6);this._pStateClass=l;this._iControlPoint=r||new a;this._iEndPoint=i||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.BEZIER_CONTROL_INDEX,r.index);var i=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.BEZIER_END_INDEX,i.index);var a=t.getFreeVertexVectorTemp();var o=new s(a.regName,a.index,0);var h=new s(a.regName,a.index,1);var d=new s(a.regName,a.index,2);t.addVertexTempUsages(a,1);var p=t.getFreeVertexVectorTemp();var u=new s(p.regName,p.index);t.removeVertexTempUsage(a);var c="";c+="sub "+o+","+t.vertexOneConst+","+t.vertexLife+"\n";c+="mul "+h+","+t.vertexLife+","+t.vertexLife+"\n";c+="mul "+d+","+t.vertexLife+","+o+"\n";c+="mul "+d+","+d+","+t.vertexTwoConst+"\n";c+="mul "+u+".xyz,"+d+","+r+"\n";c+="add "+t.positionTarget+".xyz,"+u+".xyz,"+t.positionTarget+".xyz\n";c+="mul "+u+".xyz,"+h+","+i+"\n";c+="add "+t.positionTarget+".xyz,"+u+".xyz,"+t.positionTarget+".xyz\n";if(t.needVelocity){c+="mul "+h+","+t.vertexLife+","+t.vertexTwoConst+"\n";c+="sub "+d+","+t.vertexOneConst+","+h+"\n";c+="mul "+d+","+t.vertexTwoConst+","+d+"\n";c+="mul "+u+".xyz,"+r+","+d+"\n";c+="add "+t.velocityTarget+".xyz,"+u+".xyz,"+t.velocityTarget+".xyz\n";c+="mul "+u+".xyz,"+i+","+h+"\n";c+="add "+t.velocityTarget+".xyz,"+u+".xyz,"+t.velocityTarget+".xyz\n"}return c};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.BEZIER_CONTROL_VECTOR3D];if(!r)throw new Error("there is no "+t.BEZIER_CONTROL_VECTOR3D+" in param!");var i=e[t.BEZIER_END_VECTOR3D];if(!i)throw new Error("there is no "+t.BEZIER_END_VECTOR3D+" in param!");this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z;this._pOneData[3]=i.x;this._pOneData[4]=i.y;this._pOneData[5]=i.z};t.BEZIER_CONTROL_VECTOR3D="BezierControlVector3D";t.BEZIER_END_VECTOR3D="BezierEndVector3D";return t}(o);t.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleBezierCurveState":"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleBillboardNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=e("awayjs-renderergl/lib/animators/states/ParticleBillboardState");var o=function(e){i(t,e);function t(t){if(t===void 0){t=null}e.call(this,"ParticleBillboard",a.GLOBAL,0,4);this._pStateClass=n;this._iBillboardAxis=t}t.prototype.getAGALVertexCode=function(e,t){var r=t.getFreeVertexConstant();t.setRegisterIndex(this,n.MATRIX_INDEX,r.index);t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();var i=t.getFreeVertexVectorTemp();var a="m33 "+i+".xyz,"+t.scaleAndRotateTarget+","+r+"\n"+"mov "+t.scaleAndRotateTarget+".xyz,"+i+"\n";var s;for(var o=0;o<t.rotationRegisters.length;o++){s=t.rotationRegisters[o];a+="m33 "+i+".xyz,"+s+","+r+"\n"+"mov "+s+".xyz,"+s+"\n"}return a};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iProcessAnimationSetting=function(e){e.hasBillboard=true};return t}(s);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleBillboardState":"awayjs-renderergl/lib/animators/states/ParticleBillboardState"}],"awayjs-renderergl/lib/animators/nodes/ParticleColorNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/ColorTransform");var s=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleColorState");var h=function(e){i(t,e);function t(t,r,i,n,o,h,d,p,u){if(r===void 0){r=true}if(i===void 0){i=true}if(n===void 0){n=false}if(o===void 0){o=false}if(h===void 0){h=null}if(d===void 0){d=null}if(p===void 0){p=1}if(u===void 0){u=0}e.call(this,"ParticleColor",t,r&&i?16:8,s.COLOR_PRIORITY);this._pStateClass=l;this._iUsesMultiplier=r;this._iUsesOffset=i;this._iUsesCycle=n;this._iUsesPhase=o;this._iStartColor=h||new a;this._iEndColor=d||new a;this._iCycleDuration=p;this._iCyclePhase=u}t.prototype.getAGALVertexCode=function(e,t){var r="";if(t.needFragmentAnimation){var i=t.getFreeVertexVectorTemp();if(this._iUsesCycle){var a=t.getFreeVertexConstant();t.setRegisterIndex(this,l.CYCLE_INDEX,a.index);t.addVertexTempUsages(i,1);var s=t.getFreeVertexSingleTemp();t.removeVertexTempUsage(i);r+="mul "+s+","+t.vertexTime+","+a+".x\n";if(this._iUsesPhase)r+="add "+s+","+s+","+a+".y\n";r+="sin "+s+","+s+"\n"}if(this._iUsesMultiplier){var o=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();var h=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.START_MULTIPLIER_INDEX,o.index);t.setRegisterIndex(this,l.DELTA_MULTIPLIER_INDEX,h.index);r+="mul "+i+","+h+","+(this._iUsesCycle?s:t.vertexLife)+"\n";r+="add "+i+","+i+","+o+"\n";r+="mul "+t.colorMulTarget+","+i+","+t.colorMulTarget+"\n"}if(this._iUsesOffset){var d=this._pMode==n.LOCAL_STATIC?t.getFreeVertexAttribute():t.getFreeVertexConstant();var p=this._pMode==n.LOCAL_STATIC?t.getFreeVertexAttribute():t.getFreeVertexConstant();t.setRegisterIndex(this,l.START_OFFSET_INDEX,d.index);t.setRegisterIndex(this,l.DELTA_OFFSET_INDEX,p.index);r+="mul "+i+","+p+","+(this._iUsesCycle?s:t.vertexLife)+"\n";r+="add "+i+","+i+","+d+"\n";r+="add "+t.colorAddTarget+","+i+","+t.colorAddTarget+"\n"}}return r};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iProcessAnimationSetting=function(e){if(this._iUsesMultiplier)e.hasColorMulNode=true;if(this._iUsesOffset)e.hasColorAddNode=true};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.COLOR_START_COLORTRANSFORM];if(!r)throw new Error("there is no "+t.COLOR_START_COLORTRANSFORM+" in param!");var i=e[t.COLOR_END_COLORTRANSFORM];if(!i)throw new Error("there is no "+t.COLOR_END_COLORTRANSFORM+" in param!");var a=0;if(!this._iUsesCycle){if(this._iUsesMultiplier){this._pOneData[a++]=r.redMultiplier;this._pOneData[a++]=r.greenMultiplier;this._pOneData[a++]=r.blueMultiplier;this._pOneData[a++]=r.alphaMultiplier;this._pOneData[a++]=i.redMultiplier-r.redMultiplier;this._pOneData[a++]=i.greenMultiplier-r.greenMultiplier;this._pOneData[a++]=i.blueMultiplier-r.blueMultiplier;this._pOneData[a++]=i.alphaMultiplier-r.alphaMultiplier}if(this._iUsesOffset){this._pOneData[a++]=r.redOffset/255;this._pOneData[a++]=r.greenOffset/255;this._pOneData[a++]=r.blueOffset/255;this._pOneData[a++]=r.alphaOffset/255;this._pOneData[a++]=(i.redOffset-r.redOffset)/255;this._pOneData[a++]=(i.greenOffset-r.greenOffset)/255;this._pOneData[a++]=(i.blueOffset-r.blueOffset)/255;this._pOneData[a++]=(i.alphaOffset-r.alphaOffset)/255}}else{if(this._iUsesMultiplier){this._pOneData[a++]=(r.redMultiplier+i.redMultiplier)/2;this._pOneData[a++]=(r.greenMultiplier+i.greenMultiplier)/2;this._pOneData[a++]=(r.blueMultiplier+i.blueMultiplier)/2;this._pOneData[a++]=(r.alphaMultiplier+i.alphaMultiplier)/2;this._pOneData[a++]=(r.redMultiplier-i.redMultiplier)/2;this._pOneData[a++]=(r.greenMultiplier-i.greenMultiplier)/2;this._pOneData[a++]=(r.blueMultiplier-i.blueMultiplier)/2;this._pOneData[a++]=(r.alphaMultiplier-i.alphaMultiplier)/2}if(this._iUsesOffset){this._pOneData[a++]=(r.redOffset+i.redOffset)/(255*2);this._pOneData[a++]=(r.greenOffset+i.greenOffset)/(255*2);this._pOneData[a++]=(r.blueOffset+i.blueOffset)/(255*2);this._pOneData[a++]=(r.alphaOffset+i.alphaOffset)/(255*2);this._pOneData[a++]=(r.redOffset-i.redOffset)/(255*2);this._pOneData[a++]=(r.greenOffset-i.greenOffset)/(255*2);this._pOneData[a++]=(r.blueOffset-i.blueOffset)/(255*2);this._pOneData[a++]=(r.alphaOffset-i.alphaOffset)/(255*2)}}};t.COLOR_START_COLORTRANSFORM="ColorStartColorTransform";t.COLOR_END_COLORTRANSFORM="ColorEndColorTransform";return t}(o);t.exports=h},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleColorState":"awayjs-renderergl/lib/animators/states/ParticleColorState"}],"awayjs-renderergl/lib/animators/nodes/ParticleFollowNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=e("awayjs-renderergl/lib/animators/states/ParticleFollowState");var l=function(e){i(t,e);function t(t,r,i){if(t===void 0){t=true}if(r===void 0){r=true}if(i===void 0){i=false}e.call(this,"ParticleFollow",s.LOCAL_DYNAMIC,t&&r?6:3,a.POST_PRIORITY);this._pStateClass=o;this._iUsesPosition=t;this._iUsesRotation=r;this._iSmooth=i}t.prototype.getAGALVertexCode=function(e,t){var r="";if(this._iUsesRotation){var i=t.getFreeVertexAttribute();t.setRegisterIndex(this,o.FOLLOW_ROTATION_INDEX,i.index);var a=t.getFreeVertexVectorTemp();t.addVertexTempUsages(a,1);var s=t.getFreeVertexVectorTemp();t.addVertexTempUsages(s,1);var n=t.getFreeVertexVectorTemp();var l;if(t.hasBillboard){t.addVertexTempUsages(n,1);l=t.getFreeVertexVectorTemp()}t.removeVertexTempUsage(a);t.removeVertexTempUsage(s);if(t.hasBillboard)t.removeVertexTempUsage(n);var h=t.rotationRegisters.length;var d;r+="mov "+a+","+t.vertexZeroConst+"\n";r+="mov "+a+".x,"+t.vertexOneConst+"\n";r+="mov "+n+","+t.vertexZeroConst+"\n";r+="sin "+n+".y,"+i+".x\n";r+="cos "+n+".z,"+i+".x\n";r+="mov "+s+".x,"+t.vertexZeroConst+"\n";r+="mov "+s+".y,"+n+".z\n";r+="neg "+s+".z,"+n+".y\n";if(t.hasBillboard)r+="m33 "+l+".xyz,"+t.positionTarget+".xyz,"+a+"\n";else{r+="m33 "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+a+"\n";for(d=0;d<h;d++)r+="m33 "+t.rotationRegisters[d]+".xyz,"+t.rotationRegisters[d]+","+a+"\n"}r+="mov "+a+","+t.vertexZeroConst+"\n";r+="cos "+a+".x,"+i+".y\n";r+="sin "+a+".z,"+i+".y\n";r+="mov "+s+","+t.vertexZeroConst+"\n";r+="mov "+s+".y,"+t.vertexOneConst+"\n";r+="mov "+n+","+t.vertexZeroConst+"\n";r+="neg "+n+".x,"+a+".z\n";r+="mov "+n+".z,"+a+".x\n";if(t.hasBillboard)r+="m33 "+l+".xyz,"+l+".xyz,"+a+"\n";else{r+="m33 "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+a+"\n";for(d=0;d<h;d++)r+="m33 "+t.rotationRegisters[d]+".xyz,"+t.rotationRegisters[d]+","+a+"\n"}r+="mov "+s+","+t.vertexZeroConst+"\n";r+="sin "+s+".x,"+i+".z\n";r+="cos "+s+".y,"+i+".z\n";r+="mov "+a+","+t.vertexZeroConst+"\n";r+="mov "+a+".x,"+s+".y\n";r+="neg "+a+".y,"+s+".x\n";r+="mov "+n+","+t.vertexZeroConst+"\n";r+="mov "+n+".z,"+t.vertexOneConst+"\n";if(t.hasBillboard){r+="m33 "+l+".xyz,"+l+".xyz,"+a+"\n";r+="sub "+l+".xyz,"+l+".xyz,"+t.positionTarget+".xyz\n";r+="add "+t.scaleAndRotateTarget+".xyz,"+l+".xyz,"+t.scaleAndRotateTarget+".xyz\n"}else{r+="m33 "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+a+"\n";for(d=0;d<h;d++)r+="m33 "+t.rotationRegisters[d]+".xyz,"+t.rotationRegisters[d]+","+a+"\n"}}if(this._iUsesPosition){var p=t.getFreeVertexAttribute();t.setRegisterIndex(this,o.FOLLOW_POSITION_INDEX,p.index);r+="add "+t.scaleAndRotateTarget+".xyz,"+p+","+t.scaleAndRotateTarget+".xyz\n"}return r};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};return t}(n);t.exports=l},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleFollowState":"awayjs-renderergl/lib/animators/states/ParticleFollowState"}],"awayjs-renderergl/lib/animators/nodes/ParticleInitialColorNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/ColorTransform");var s=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleInitialColorState");var h=function(e){i(t,e);function t(t,r,i,n){if(r===void 0){r=true}if(i===void 0){i=false}if(n===void 0){n=null}e.call(this,"ParticleInitialColor",t,r&&i?8:4,s.COLOR_PRIORITY);this._pStateClass=l;this._iUsesMultiplier=r;this._iUsesOffset=i;this._iInitialColor=n||new a}t.prototype.getAGALVertexCode=function(e,t){var r="";if(t.needFragmentAnimation){if(this._iUsesMultiplier){var i=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.MULTIPLIER_INDEX,i.index);r+="mul "+t.colorMulTarget+","+i+","+t.colorMulTarget+"\n"}if(this._iUsesOffset){var a=this._pMode==n.LOCAL_STATIC?t.getFreeVertexAttribute():t.getFreeVertexConstant();t.setRegisterIndex(this,l.OFFSET_INDEX,a.index);r+="add "+t.colorAddTarget+","+a+","+t.colorAddTarget+"\n"}}return r};t.prototype._iProcessAnimationSetting=function(e){if(this._iUsesMultiplier)e.hasColorMulNode=true;if(this._iUsesOffset)e.hasColorAddNode=true};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.COLOR_INITIAL_COLORTRANSFORM];if(!r)throw new Error("there is no "+t.COLOR_INITIAL_COLORTRANSFORM+" in param!");var i=0;if(this._iUsesMultiplier){this._pOneData[i++]=r.redMultiplier;this._pOneData[i++]=r.greenMultiplier;this._pOneData[i++]=r.blueMultiplier;this._pOneData[i++]=r.alphaMultiplier}if(this._iUsesOffset){this._pOneData[i++]=r.redOffset/255;this._pOneData[i++]=r.greenOffset/255;this._pOneData[i++]=r.blueOffset/255;this._pOneData[i++]=r.alphaOffset/255}};t.COLOR_INITIAL_COLORTRANSFORM="ColorInitialColorTransform";return t}(o);t.exports=h},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleInitialColorState":"awayjs-renderergl/lib/animators/states/ParticleInitialColorState"}],"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];
function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=function(e){i(t,e);function t(r,i,a,s){if(s===void 0){s=1}e.call(this);this._pDataLength=3;r=r+t.MODES[i];this.name=r;this._pMode=i;this._priority=s;this._pDataLength=a;this._pOneData=new Array(this._pDataLength)}Object.defineProperty(t.prototype,"mode",{get:function(){return this._pMode},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"priority",{get:function(){return this._priority},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataLength",{get:function(){return this._pDataLength},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"oneData",{get:function(){return this._pOneData},enumerable:true,configurable:true});t.prototype.getAGALVertexCode=function(e,t){return""};t.prototype.getAGALFragmentCode=function(e,t){return""};t.prototype.getAGALUVCode=function(e,t){return""};t.prototype._iGeneratePropertyOfOneParticle=function(e){};t.prototype._iProcessAnimationSetting=function(e){};t.GLOBAL="Global";t.LOCAL_STATIC="LocalStatic";t.LOCAL_DYNAMIC="LocalDynamic";t.MODES={0:t.GLOBAL,1:t.LOCAL_STATIC,2:t.LOCAL_DYNAMIC};return t}(a);t.exports=s},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined}],"awayjs-renderergl/lib/animators/nodes/ParticleOrbitNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleOrbitState");var h=function(e){i(t,e);function t(t,r,i,s,n,o,h,d){if(r===void 0){r=true}if(i===void 0){i=false}if(s===void 0){s=false}if(n===void 0){n=100}if(o===void 0){o=1}if(h===void 0){h=0}if(d===void 0){d=null}var p=3;if(s)p++;e.call(this,"ParticleOrbit",t,p);this._pStateClass=l;this._iUsesEulers=r;this._iUsesCycle=i;this._iUsesPhase=s;this._iRadius=n;this._iCycleDuration=o;this._iCyclePhase=h;this._iEulers=d||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.ORBIT_INDEX,r.index);var i=t.getFreeVertexConstant();t.setRegisterIndex(this,l.EULERS_INDEX,i.index);t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();var a=t.getFreeVertexVectorTemp();t.addVertexTempUsages(a,1);var o=new s(a.regName,a.index);var h=t.getFreeVertexVectorTemp();var d=new s(h.regName,h.index,0);var p=new s(h.regName,h.index,1);var u=new s(h.regName,h.index,2);t.removeVertexTempUsage(a);var c="";if(this._iUsesCycle){c+="mul "+u+","+t.vertexTime+","+r+".y\n";if(this._iUsesPhase)c+="add "+u+","+u+","+r+".w\n"}else c+="mul "+u+","+t.vertexLife+","+r+".y\n";c+="cos "+d+","+u+"\n";c+="sin "+p+","+u+"\n";c+="mul "+o+".x,"+d+","+r+".x\n";c+="mul "+o+".y,"+p+","+r+".x\n";c+="mov "+o+".wz"+t.vertexZeroConst+"\n";if(this._iUsesEulers)c+="m44 "+o+","+o+","+i+"\n";c+="add "+t.positionTarget+".xyz,"+o+".xyz,"+t.positionTarget+".xyz\n";if(t.needVelocity){c+="neg "+o+".x,"+p+"\n";c+="mov "+o+".y,"+d+"\n";c+="mov "+o+".zw,"+t.vertexZeroConst+"\n";if(this._iUsesEulers)c+="m44 "+o+","+o+","+i+"\n";c+="mul "+o+","+o+","+r+".z\n";c+="div "+o+","+o+","+r+".y\n";if(!this._iUsesCycle)c+="div "+o+","+o+","+t.vertexLife+"\n";c+="add "+t.velocityTarget+".xyz,"+t.velocityTarget+".xyz,"+o+".xyz\n"}return c};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.ORBIT_VECTOR3D];if(!r)throw new Error("there is no "+t.ORBIT_VECTOR3D+" in param!");this._pOneData[0]=r.x;if(this._iUsesCycle&&r.y<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[1]=Math.PI*2/(!this._iUsesCycle?1:r.y);this._pOneData[2]=r.x*Math.PI*2;if(this._iUsesPhase)this._pOneData[3]=r.z*Math.PI/180};t.ORBIT_VECTOR3D="OrbitVector3D";return t}(o);t.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleOrbitState":"awayjs-renderergl/lib/animators/states/ParticleOrbitState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleOscillatorNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleOscillatorState");var h=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticleOscillator",t,4);this._pStateClass=l;this._iOscillator=r||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.OSCILLATOR_INDEX,r.index);var i=t.getFreeVertexVectorTemp();var a=new s(i.regName,i.index,0);var o=new s(i.regName,i.index,1);var h=new s(i.regName,i.index,2);t.addVertexTempUsages(i,1);var d=t.getFreeVertexVectorTemp();var p=new s(d.regName,d.index);t.removeVertexTempUsage(i);var u="";u+="mul "+a+","+t.vertexTime+","+r+".w\n";u+="sin "+o+","+a+"\n";u+="mul "+p+".xyz,"+o+","+r+".xyz\n";u+="add "+t.positionTarget+".xyz,"+p+".xyz,"+t.positionTarget+".xyz\n";if(t.needVelocity){u+="cos "+h+","+a+"\n";u+="mul "+p+".xyz,"+h+","+r+".xyz\n";u+="add "+t.velocityTarget+".xyz,"+p+".xyz,"+t.velocityTarget+".xyz\n"}return u};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.OSCILLATOR_VECTOR3D];if(!r)throw new Error("there is no "+t.OSCILLATOR_VECTOR3D+" in param!");this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z;if(r.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=Math.PI*2/r.w};t.OSCILLATOR_VECTOR3D="OscillatorVector3D";return t}(o);t.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleOscillatorState":"awayjs-renderergl/lib/animators/states/ParticleOscillatorState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticlePositionNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=e("awayjs-renderergl/lib/animators/states/ParticlePositionState");var l=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticlePosition",t,3);this._pStateClass=o;this._iPosition=r||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==s.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,o.POSITION_INDEX,r.index);return"add "+t.positionTarget+".xyz,"+r+".xyz,"+t.positionTarget+".xyz\n"};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.POSITION_VECTOR3D];if(!r)throw new Error("there is no "+t.POSITION_VECTOR3D+" in param!");this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z};t.POSITION_VECTOR3D="PositionVector3D";return t}(n);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticlePositionState":"awayjs-renderergl/lib/animators/states/ParticlePositionState"}],"awayjs-renderergl/lib/animators/nodes/ParticleRotateToHeadingNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=e("awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState");var l=function(e){i(t,e);function t(){e.call(this,"ParticleRotateToHeading",s.GLOBAL,0,3);this._pStateClass=o}t.prototype.getAGALVertexCode=function(e,t){var r="";var i=t.rotationRegisters.length;var s;if(t.hasBillboard){var n=t.getFreeVertexVectorTemp();t.addVertexTempUsages(n,1);var l=t.getFreeVertexVectorTemp();t.addVertexTempUsages(l,1);var h=t.getFreeVertexVectorTemp();var d=t.getFreeVertexConstant();t.setRegisterIndex(this,o.MATRIX_INDEX,d.index);t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.removeVertexTempUsage(n);t.removeVertexTempUsage(l);r+="m33 "+n+".xyz,"+t.velocityTarget+".xyz,"+d+"\n";r+="mov "+h+","+t.vertexZeroConst+"\n";r+="mov "+h+".xy,"+n+".xy\n";r+="nrm "+h+".xyz,"+h+".xyz\n";r+="mov "+l+","+t.vertexZeroConst+"\n";r+="mov "+l+".x,"+h+".y\n";r+="mov "+l+".y,"+h+".x\n";r+="mov "+n+","+t.vertexZeroConst+"\n";r+="mov "+n+".x,"+h+".x\n";r+="neg "+n+".y,"+h+".y\n";r+="mov "+h+","+t.vertexZeroConst+"\n";r+="mov "+h+".z,"+t.vertexOneConst+"\n";r+="m33 "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+n+"\n";for(s=0;s<i;s++)r+="m33 "+t.rotationRegisters[s]+".xyz,"+t.rotationRegisters[s]+","+n+"\n"}else{var p=t.getFreeVertexVectorTemp();t.addVertexTempUsages(p,1);var u=t.getFreeVertexVectorTemp();t.addVertexTempUsages(u,1);var c=t.getFreeVertexVectorTemp();t.addVertexTempUsages(c,1);var g=t.getFreeVertexVectorTemp();var f=new a(c.regName,c.index,3);var _=new a(g.regName,g.index,3);var m=new a(p.regName,p.index,3);var y=_;t.removeVertexTempUsage(p);t.removeVertexTempUsage(u);t.removeVertexTempUsage(c);r+="mov "+u+".x,"+t.vertexOneConst+"\n";r+="mov "+u+".yz,"+t.vertexZeroConst+"\n";r+="nrm "+p+".xyz,"+t.velocityTarget+".xyz\n";r+="dp3 "+m+","+p+".xyz,"+u+".xyz\n";r+="crs "+p+".xyz,"+u+".xyz,"+p+".xyz\n";r+="nrm "+p+".xyz,"+p+".xyz\n";r+="dp3 "+c+".x,"+p+".xyz,"+p+".xyz\n";r+="sge "+c+".x,"+t.vertexZeroConst+","+c+".x\n";r+="add "+p+".z,"+c+".x,"+p+".z\n";r+="add "+y+","+m+","+t.vertexOneConst+"\n";r+="div "+y+","+y+","+t.vertexTwoConst+"\n";r+="sqt "+f+","+y+"\n";r+="sub "+y+","+t.vertexOneConst+","+m+"\n";r+="div "+y+","+y+","+t.vertexTwoConst+"\n";r+="sqt "+_+","+y+"\n";r+="mul "+c+".xyz,"+_+","+p+".xyz\n";r+="mul "+g+".xyz,"+_+","+p+".xyz\n";r+="neg "+g+".xyz,"+g+".xyz\n";r+="crs "+p+".xyz,"+c+".xyz,"+t.scaleAndRotateTarget+".xyz\n";r+="mul "+u+".xyz,"+f+","+t.scaleAndRotateTarget+".xyz\n";r+="add "+p+".xyz,"+p+".xyz,"+u+".xyz\n";r+="dp3 "+u+".w,"+c+".xyz,"+t.scaleAndRotateTarget+".xyz\n";r+="neg "+p+".w,"+u+".w\n";r+="crs "+c+".xyz,"+p+".xyz,"+g+".xyz\n";r+="mul "+u+".xyzw,"+p+".xyzw,"+f+"\n";r+="add "+c+".xyz,"+c+".xyz,"+u+".xyz\n";r+="mul "+u+".xyz,"+p+".w,"+g+".xyz\n";r+="add "+t.scaleAndRotateTarget+".xyz,"+c+".xyz,"+u+".xyz\n";for(s=0;s<i;s++){r+="mov "+u+".x,"+t.vertexOneConst+"\n";r+="mov "+u+".yz,"+t.vertexZeroConst+"\n";r+="nrm "+p+".xyz,"+t.velocityTarget+".xyz\n";r+="dp3 "+m+","+p+".xyz,"+u+".xyz\n";r+="crs "+p+".xyz,"+u+".xyz,"+p+".xyz\n";r+="nrm "+p+".xyz,"+p+".xyz\n";r+="dp3 "+c+".x,"+p+".xyz,"+p+".xyz\n";r+="sge "+c+".x,"+t.vertexZeroConst+","+c+".x\n";r+="add "+p+".z,"+c+".x,"+p+".z\n";r+="add "+y+","+m+","+t.vertexOneConst+"\n";r+="div "+y+","+y+","+t.vertexTwoConst+"\n";r+="sqt "+f+","+y+"\n";r+="sub "+y+","+t.vertexOneConst+","+m+"\n";r+="div "+y+","+y+","+t.vertexTwoConst+"\n";r+="sqt "+_+","+y+"\n";r+="mul "+c+".xyz,"+_+","+p+".xyz\n";r+="mul "+g+".xyz,"+_+","+p+".xyz\n";r+="neg "+g+".xyz,"+g+".xyz\n";r+="crs "+p+".xyz,"+c+".xyz,"+t.rotationRegisters[s]+".xyz\n";r+="mul "+u+".xyz,"+f+","+t.rotationRegisters[s]+".xyz\n";r+="add "+p+".xyz,"+p+".xyz,"+u+".xyz\n";r+="dp3 "+u+".w,"+c+".xyz,"+t.rotationRegisters[s]+".xyz\n";r+="neg "+p+".w,"+u+".w\n";r+="crs "+c+".xyz,"+p+".xyz,"+g+".xyz\n";r+="mul "+u+".xyzw,"+p+".xyzw,"+f+"\n";r+="add "+c+".xyz,"+c+".xyz,"+u+".xyz\n";r+="mul "+u+".xyz,"+p+".w,"+g+".xyz\n";r+="add "+t.rotationRegisters[s]+".xyz,"+c+".xyz,"+u+".xyz\n"}}return r};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iProcessAnimationSetting=function(e){e.needVelocity=true};return t}(n);t.exports=l},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState":"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleRotateToPositionNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState");var h=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticleRotateToPosition",t,3,3);this._pStateClass=l;this._iPosition=r||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.POSITION_INDEX,r.index);var i="";var a=t.rotationRegisters.length;var o;if(t.hasBillboard){var h=t.getFreeVertexVectorTemp();t.addVertexTempUsages(h,1);var d=t.getFreeVertexVectorTemp();t.addVertexTempUsages(d,1);var p=t.getFreeVertexVectorTemp();var u=t.getFreeVertexConstant();t.setRegisterIndex(this,l.MATRIX_INDEX,u.index);t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.removeVertexTempUsage(h);t.removeVertexTempUsage(d);i+="sub "+h+".xyz,"+r+".xyz,"+t.positionTarget+".xyz\n";i+="m33 "+h+".xyz,"+h+".xyz,"+u+"\n";i+="mov "+p+","+t.vertexZeroConst+"\n";i+="mov "+p+".xy,"+h+".xy\n";i+="nrm "+p+".xyz,"+p+".xyz\n";i+="mov "+d+","+t.vertexZeroConst+"\n";i+="mov "+d+".x,"+p+".y\n";i+="mov "+d+".y,"+p+".x\n";i+="mov "+h+","+t.vertexZeroConst+"\n";i+="mov "+h+".x,"+p+".x\n";i+="neg "+h+".y,"+p+".y\n";i+="mov "+p+","+t.vertexZeroConst+"\n";i+="mov "+p+".z,"+t.vertexOneConst+"\n";i+="m33 "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+h+"\n";for(o=0;o<a;o++)i+="m33 "+t.rotationRegisters[o]+".xyz,"+t.rotationRegisters[o]+","+h+"\n"}else{var c=t.getFreeVertexVectorTemp();t.addVertexTempUsages(c,1);var g=t.getFreeVertexVectorTemp();t.addVertexTempUsages(g,1);var f=new s(g.regName,g.index,0);var _=new s(g.regName,g.index,1);var m=new s(g.regName,g.index,2);var y=new s(g.regName,g.index,3);var v=t.getFreeVertexVectorTemp();t.addVertexTempUsages(v,1);t.removeVertexTempUsage(c);t.removeVertexTempUsage(g);t.removeVertexTempUsage(v);i+="sub "+c+".xyz,"+r+".xyz,"+t.positionTarget+".xyz\n";i+="nrm "+c+".xyz,"+c+".xyz\n";i+="mov "+_+","+c+".y\n";i+="mul "+f+","+_+","+_+"\n";i+="sub "+f+","+t.vertexOneConst+","+f+"\n";i+="sqt "+f+","+f+"\n";i+="mul "+v+".x,"+f+","+t.scaleAndRotateTarget+".y\n";i+="mul "+v+".y,"+_+","+t.scaleAndRotateTarget+".z\n";i+="mul "+v+".z,"+_+","+t.scaleAndRotateTarget+".y\n";i+="mul "+v+".w,"+f+","+t.scaleAndRotateTarget+".z\n";i+="sub "+t.scaleAndRotateTarget+".y,"+v+".x,"+v+".y\n";i+="add "+t.scaleAndRotateTarget+".z,"+v+".z,"+v+".w\n";i+="abs "+v+".y,"+c+".y\n";i+="sge "+v+".z,"+v+".y,"+t.vertexOneConst+"\n";i+="mul "+v+".x,"+v+".y,"+c+".y\n";i+="mov "+c+".y,"+t.vertexZeroConst+"\n";i+="dp3 "+_+","+c+".xyz,"+c+".xyz\n";i+="sge "+y+","+t.vertexZeroConst+","+_+"\n";i+="mov "+c+".y,"+t.vertexZeroConst+"\n";i+="nrm "+c+".xyz,"+c+".xyz\n";i+="sub "+_+","+t.vertexOneConst+","+y+"\n";i+="mul "+_+","+_+","+c+".x\n";i+="mov "+f+","+c+".z\n";i+="neg "+f+","+f+"\n";i+="sub "+m+","+t.vertexOneConst+","+f+"\n";i+="mul "+m+","+v+".x,"+y+"\n";i+="add "+f+","+f+","+m+"\n";i+="mul "+v+".x,"+f+","+t.scaleAndRotateTarget+".x\n";i+="mul "+v+".y,"+_+","+t.scaleAndRotateTarget+".z\n";i+="mul "+v+".z,"+_+","+t.scaleAndRotateTarget+".x\n";i+="mul "+v+".w,"+f+","+t.scaleAndRotateTarget+".z\n";i+="sub "+t.scaleAndRotateTarget+".x,"+v+".x,"+v+".y\n";i+="add "+t.scaleAndRotateTarget+".z,"+v+".z,"+v+".w\n";for(o=0;o<a;o++){i+="sub "+c+".xyz,"+r+".xyz,"+t.positionTarget+".xyz\n";i+="nrm "+c+".xyz,"+c+".xyz\n";i+="mov "+_+","+c+".y\n";i+="mul "+f+","+_+","+_+"\n";i+="sub "+f+","+t.vertexOneConst+","+f+"\n";i+="sqt "+f+","+f+"\n";i+="mul "+v+".x,"+f+","+t.rotationRegisters[o]+".y\n";i+="mul "+v+".y,"+_+","+t.rotationRegisters[o]+".z\n";i+="mul "+v+".z,"+_+","+t.rotationRegisters[o]+".y\n";i+="mul "+v+".w,"+f+","+t.rotationRegisters[o]+".z\n";i+="sub "+t.rotationRegisters[o]+".y,"+v+".x,"+v+".y\n";i+="add "+t.rotationRegisters[o]+".z,"+v+".z,"+v+".w\n";i+="abs "+v+".y,"+c+".y\n";i+="sge "+v+".z,"+v+".y,"+t.vertexOneConst+"\n";i+="mul "+v+".x,"+v+".y,"+c+".y\n";i+="mov "+c+".y,"+t.vertexZeroConst+"\n";i+="dp3 "+_+","+c+".xyz,"+c+".xyz\n";i+="sge "+y+","+t.vertexZeroConst+","+_+"\n";i+="mov "+c+".y,"+t.vertexZeroConst+"\n";i+="nrm "+c+".xyz,"+c+".xyz\n";i+="sub "+_+","+t.vertexOneConst+","+y+"\n";i+="mul "+_+","+_+","+c+".x\n";i+="mov "+f+","+c+".z\n";i+="neg "+f+","+f+"\n";i+="sub "+m+","+t.vertexOneConst+","+f+"\n";i+="mul "+m+","+v+".x,"+y+"\n";i+="add "+f+","+f+","+m+"\n";i+="mul "+v+".x,"+f+","+t.rotationRegisters[o]+".x\n";i+="mul "+v+".y,"+_+","+t.rotationRegisters[o]+".z\n";i+="mul "+v+".z,"+_+","+t.rotationRegisters[o]+".x\n";i+="mul "+v+".w,"+f+","+t.rotationRegisters[o]+".z\n";i+="sub "+t.rotationRegisters[o]+".x,"+v+".x,"+v+".y\n";i+="add "+t.rotationRegisters[o]+".z,"+v+".z,"+v+".w\n"}}return i};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.POSITION_VECTOR3D];if(!r)throw new Error("there is no "+t.POSITION_VECTOR3D+" in param!");this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z};t.POSITION_VECTOR3D="RotateToPositionVector3D";return t}(o);t.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState":"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleRotationalVelocityNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState");var h=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticleRotationalVelocity",t,4);this._pStateClass=l;this._iRotationalVelocity=r||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.ROTATIONALVELOCITY_INDEX,r.index);var i=t.getFreeVertexVectorTemp();t.addVertexTempUsages(i,1);var a=t.getFreeVertexVectorTemp();t.addVertexTempUsages(a,1);var o=t.getFreeVertexVectorTemp();t.addVertexTempUsages(o,1);var h=new s(o.regName,o.index);var d=t.getFreeVertexVectorTemp();d=new s(d.regName,d.index);var p=new s(h.regName,h.index,3);var u=new s(d.regName,d.index,3);t.removeVertexTempUsage(i);t.removeVertexTempUsage(a);t.removeVertexTempUsage(o);var c="";c+="mov "+i+".xyz,"+r+".xyz\n";c+="mov "+i+".w,"+t.vertexZeroConst+"\n";c+="mul "+p+","+t.vertexTime+","+r+".w\n";c+="sin "+u+","+p+"\n";c+="cos "+p+","+p+"\n";c+="mul "+h+".xyz,"+u+","+i+".xyz\n";c+="mul "+d+".xyz,"+u+","+i+".xyz\n";c+="neg "+d+".xyz,"+d+".xyz\n";c+="crs "+i+".xyz,"+h+".xyz,"+t.scaleAndRotateTarget+".xyz\n";c+="mul "+a+".xyz,"+p+","+t.scaleAndRotateTarget+".xyz\n";c+="add "+i+".xyz,"+i+".xyz,"+a+".xyz\n";c+="dp3 "+a+".w,"+h+".xyz,"+t.scaleAndRotateTarget+".xyz\n";c+="neg "+i+".w,"+a+".w\n";c+="crs "+h+".xyz,"+i+".xyz,"+d+".xyz\n";c+="mul "+a+".xyzw,"+i+".xyzw,"+p+"\n";c+="add "+h+".xyz,"+h+".xyz,"+a+".xyz\n";c+="mul "+a+".xyz,"+i+".w,"+d+".xyz\n";c+="add "+t.scaleAndRotateTarget+".xyz,"+h+".xyz,"+a+".xyz\n";var g=t.rotationRegisters.length;for(var f=0;f<g;f++){c+="mov "+i+".xyz,"+r+".xyz\n";c+="mov "+i+".w,"+t.vertexZeroConst+"\n";c+="mul "+p+","+t.vertexTime+","+r+".w\n";c+="sin "+u+","+p+"\n";c+="cos "+p+","+p+"\n";c+="mul "+h+".xyz,"+u+","+i+".xyz\n";c+="mul "+d+".xyz,"+u+","+i+".xyz\n";c+="neg "+d+".xyz,"+d+".xyz\n";c+="crs "+i+".xyz,"+h+".xyz,"+t.rotationRegisters[f]+".xyz\n";c+="mul "+a+".xyz,"+p+","+t.rotationRegisters[f]+"\n";c+="add "+i+".xyz,"+i+".xyz,"+a+".xyz\n";c+="dp3 "+a+".w,"+h+".xyz,"+t.rotationRegisters[f]+"\n";c+="neg "+i+".w,"+a+".w\n";c+="crs "+h+".xyz,"+i+".xyz,"+d+".xyz\n";c+="mul "+a+".xyzw,"+i+".xyzw,"+p+"\n";c+="add "+h+".xyz,"+h+".xyz,"+a+".xyz\n";c+="mul "+a+".xyz,"+i+".w,"+d+".xyz\n";c+="add "+t.rotationRegisters[f]+","+h+".xyz,"+a+".xyz\n"}return c};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.ROTATIONALVELOCITY_VECTOR3D];if(!r)throw new Error("there is no "+t.ROTATIONALVELOCITY_VECTOR3D+" in param!");if(r.length<=0)r.z=1;else r.normalize();this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z;if(r.w<=0)throw new Error("the cycle duration must greater than zero");this._pOneData[3]=Math.PI/r.w};t.ROTATIONALVELOCITY_VECTOR3D="RotationalVelocityVector3D";return t}(o);t.exports=h},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState":"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleScaleNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=e("awayjs-renderergl/lib/animators/states/ParticleScaleState");var o=function(e){i(t,e);function t(t,r,i,a,s,o,l){if(a===void 0){a=1}if(s===void 0){s=1}if(o===void 0){o=1}if(l===void 0){l=0}e.call(this,"ParticleScale",t,r&&i?4:r||i?3:2,3);this._pStateClass=n;this._iUsesCycle=r;this._iUsesPhase=i;this._iMinScale=a;this._iMaxScale=s;this._iCycleDuration=o;this._iCyclePhase=l}t.prototype.getAGALVertexCode=function(e,t){var r="";var i=t.getFreeVertexSingleTemp();var s=this._pMode==a.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,n.SCALE_INDEX,s.index);if(this._iUsesCycle){r+="mul "+i+","+t.vertexTime+","+s+".z\n";if(this._iUsesPhase)r+="add "+i+","+i+","+s+".w\n";r+="sin "+i+","+i+"\n"}r+="mul "+i+","+s+".y,"+(this._iUsesCycle?i:t.vertexLife)+"\n";r+="add "+i+","+s+".x,"+i+"\n";r+="mul "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+i+"\n";return r};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.SCALE_VECTOR3D];if(!r)throw new Error("there is no "+t.SCALE_VECTOR3D+" in param!");if(this._iUsesCycle){this._pOneData[0]=(r.x+r.y)/2;this._pOneData[1]=Math.abs(r.x-r.y)/2;if(r.z<=0)throw new Error("the cycle duration must be greater than zero");this._pOneData[2]=Math.PI*2/r.z;if(this._iUsesPhase)this._pOneData[3]=r.w*Math.PI/180}else{this._pOneData[0]=r.x;this._pOneData[1]=r.y-r.x}};t.SCALE_VECTOR3D="ScaleVector3D";return t}(s);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleScaleState":"awayjs-renderergl/lib/animators/states/ParticleScaleState"}],"awayjs-renderergl/lib/animators/nodes/ParticleSegmentedColorNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var s=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState");var h=function(e){i(t,e);function t(t,r,i,a,o,h){e.call(this,"ParticleSegmentedColor",n.GLOBAL,0,s.COLOR_PRIORITY);this._pStateClass=l;if(i>4)throw new Error("the numSegmentPoint must be less or equal 4");this._iUsesMultiplier=t;this._iUsesOffset=r;this._iNumSegmentPoint=i;this._iStartColor=a;this._iEndColor=o;this._iSegmentPoints=h}t.prototype._iProcessAnimationSetting=function(e){if(this._iUsesMultiplier)e.hasColorMulNode=true;if(this._iUsesOffset)e.hasColorAddNode=true};t.prototype.getAGALVertexCode=function(e,t){var r="";if(t.needFragmentAnimation){var i;if(this._iUsesMultiplier){i=t.getFreeVertexVectorTemp();t.addVertexTempUsages(i,1)}var s=t.getFreeVertexVectorTemp();t.addVertexTempUsages(s,1);var n=t.getFreeVertexVectorTemp();var o=new a(n.regName,n.index,0);var h=new a(n.regName,n.index,1);if(this._iUsesMultiplier)t.removeVertexTempUsage(i);t.removeVertexTempUsage(s);var d=t.getFreeVertexConstant();t.setRegisterIndex(this,l.TIME_DATA_INDEX,d.index);var p;var u;var c;if(this._iUsesMultiplier){u=t.getFreeVertexConstant();t.setRegisterIndex(this,l.START_MULTIPLIER_INDEX,u.index);c=new Array;for(p=0;p<this._iNumSegmentPoint+1;p++)c.push(t.getFreeVertexConstant())}var g;var f;if(this._iUsesOffset){g=t.getFreeVertexConstant();t.setRegisterIndex(this,l.START_OFFSET_INDEX,g.index);f=new Array;for(p=0;p<this._iNumSegmentPoint+1;p++)f.push(t.getFreeVertexConstant())}if(this._iUsesMultiplier)r+="mov "+i+","+u+"\n";if(this._iUsesOffset)r+="add "+t.colorAddTarget+","+t.colorAddTarget+","+g+"\n";for(p=0;p<this._iNumSegmentPoint;p++){switch(p){case 0:r+="min "+h+","+t.vertexLife+","+d+".x\n";break;case 1:r+="sub "+o+","+t.vertexLife+","+d+".x\n";r+="max "+h+","+o+","+t.vertexZeroConst+"\n";r+="min "+h+","+h+","+d+".y\n";break;case 2:r+="sub "+o+","+o+","+d+".y\n";r+="max "+h+","+o+","+t.vertexZeroConst+"\n";r+="min "+h+","+h+","+d+".z\n";break;case 3:r+="sub "+o+","+o+","+d+".z\n";r+="max "+h+","+o+","+t.vertexZeroConst+"\n";r+="min "+h+","+h+","+d+".w\n";break}if(this._iUsesMultiplier){r+="mul "+s+","+h+","+c[p]+"\n";r+="add "+i+","+i+","+s+"\n"}if(this._iUsesOffset){r+="mul "+s+","+h+","+f[p]+"\n";r+="add "+t.colorAddTarget+","+t.colorAddTarget+","+s+"\n"}}if(this._iNumSegmentPoint==0)h=t.vertexLife;else{switch(this._iNumSegmentPoint){case 1:r+="sub "+o+","+t.vertexLife+","+d+".x\n";break;case 2:r+="sub "+o+","+o+","+d+".y\n";break;case 3:r+="sub "+o+","+o+","+d+".z\n";break;case 4:r+="sub "+o+","+o+","+d+".w\n";break}r+="max "+h+","+o+","+t.vertexZeroConst+"\n"}if(this._iUsesMultiplier){r+="mul "+s+","+h+","+c[this._iNumSegmentPoint]+"\n";r+="add "+i+","+i+","+s+"\n";r+="mul "+t.colorMulTarget+","+t.colorMulTarget+","+i+"\n"}if(this._iUsesOffset){r+="mul "+s+","+h+","+f[this._iNumSegmentPoint]+"\n";r+="add "+t.colorAddTarget+","+t.colorAddTarget+","+s+"\n"}}return r};return t}(o);t.exports=h},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState":"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleSpriteSheetNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var s=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var l=e("awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState");var h=function(e){i(t,e);function t(t,r,i,a,n,o,h,d){if(a===void 0){a=1}if(n===void 0){n=1}if(o===void 0){o=1}if(h===void 0){h=0}if(d===void 0){d=Number.MAX_VALUE}e.call(this,"ParticleSpriteSheet",t,r?i?3:2:1,s.POST_PRIORITY+1);this._pStateClass=l;this._iUsesCycle=r;this._iUsesPhase=i;this._iNumColumns=a;this._iNumRows=n;this._iCyclePhase=h;this._iCycleDuration=o;this._iTotalFrames=Math.min(d,a*n)}Object.defineProperty(t.prototype,"numColumns",{get:function(){return this._iNumColumns},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numRows",{get:function(){return this._iNumRows},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"totalFrames",{get:function(){return this._iTotalFrames},enumerable:true,configurable:true});t.prototype.getAGALUVCode=function(e,t){var r=t.getFreeVertexConstant();var i=this._pMode==n.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,l.UV_INDEX_0,r.index);t.setRegisterIndex(this,l.UV_INDEX_1,i.index);var s=new a(r.regName,r.index,0);var o=new a(r.regName,r.index,1);var h=new a(r.regName,r.index,2);var d=new a(i.regName,i.index,0);var p=new a(i.regName,i.index,1);
var u=new a(i.regName,i.index,2);var c=t.getFreeVertexVectorTemp();var g=new a(c.regName,c.index,0);var f=new a(c.regName,c.index,1);c=new a(c.regName,c.index,2);var _=new a(c.regName,c.index,3);var m=new a(t.uvTarget.regName,t.uvTarget.index,0);var y=new a(t.uvTarget.regName,t.uvTarget.index,1);var v="";v+="mul "+m+","+m+","+o+"\n";if(this._iNumRows>1)v+="mul "+y+","+y+","+h+"\n";if(this._iUsesCycle){if(this._iUsesPhase)v+="add "+g+","+t.vertexTime+","+u+"\n";else v+="mov "+g+","+t.vertexTime+"\n";v+="div "+g+","+g+","+p+"\n";v+="frc "+g+","+g+"\n";v+="mul "+g+","+g+","+p+"\n";v+="mul "+c+","+g+","+d+"\n"}else v+="mul "+c.toString()+","+t.vertexLife+","+s+"\n";if(this._iNumRows>1){v+="frc "+_+","+c+"\n";v+="sub "+f+","+c+","+_+"\n";v+="mul "+f+","+f+","+h+"\n";v+="add "+y+","+y+","+f+"\n"}v+="div "+_+","+c+","+o+"\n";v+="frc "+c+","+_+"\n";v+="sub "+_+","+_+","+c+"\n";v+="mul "+c+","+_+","+o+"\n";if(this._iNumRows>1)v+="frc "+c+","+c+"\n";v+="add "+m+","+m+","+c+"\n";return v};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iProcessAnimationSetting=function(e){e.hasUVNode=true};t.prototype._iGeneratePropertyOfOneParticle=function(e){if(this._iUsesCycle){var r=e[t.UV_VECTOR3D];if(!r)throw new Error("there is no "+t.UV_VECTOR3D+" in param!");if(r.x<=0)throw new Error("the cycle duration must be greater than zero");var i=this._iTotalFrames/this._iNumColumns;this._pOneData[0]=i/r.x;this._pOneData[1]=r.x;if(this._iUsesPhase)this._pOneData[2]=r.y}};t.UV_VECTOR3D="UVVector3D";return t}(o);t.exports=h},{"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState":"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleTimeNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var s=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var n=e("awayjs-renderergl/lib/animators/states/ParticleTimeState");var o=function(e){i(t,e);function t(t,r,i){if(t===void 0){t=false}if(r===void 0){r=false}if(i===void 0){i=false}this._pStateClass=n;this._iUsesDuration=t;this._iUsesLooping=r;this._iUsesDelay=i;e.call(this,"ParticleTime",a.LOCAL_STATIC,4,0)}t.prototype.getAGALVertexCode=function(e,t){var r=t.getFreeVertexAttribute();t.setRegisterIndex(this,n.TIME_STREAM_INDEX,r.index);var i=t.getFreeVertexConstant();t.setRegisterIndex(this,n.TIME_CONSTANT_INDEX,i.index);var a="";a+="sub "+t.vertexTime+","+i+","+r+".x\n";var s=t.getFreeVertexSingleTemp();a+="sge "+s+","+t.vertexTime+","+t.vertexZeroConst+"\n";a+="mul "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+s+"\n";if(this._iUsesDuration){if(this._iUsesLooping){var o=t.getFreeVertexSingleTemp();if(this._iUsesDelay){a+="div "+o+","+t.vertexTime+","+r+".z\n";a+="frc "+o+","+o+"\n";a+="mul "+t.vertexTime+","+o+","+r+".z\n";a+="slt "+o+","+t.vertexTime+","+r+".y\n";a+="mul "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+o+"\n"}else{a+="mul "+o+","+t.vertexTime+","+r+".w\n";a+="frc "+o+","+o+"\n";a+="mul "+t.vertexTime+","+o+","+r+".y\n"}}else{var l=t.getFreeVertexSingleTemp();a+="sge "+l+","+r+".y,"+t.vertexTime+"\n";a+="mul "+t.scaleAndRotateTarget+".xyz,"+t.scaleAndRotateTarget+".xyz,"+l+"\n"}}a+="mul "+t.vertexLife+","+t.vertexTime+","+r+".w\n";return a};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){this._pOneData[0]=e.startTime;this._pOneData[1]=e.duration;this._pOneData[2]=e.delay+e.duration;this._pOneData[3]=1/e.duration};return t}(s);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleTimeState":"awayjs-renderergl/lib/animators/states/ParticleTimeState"}],"awayjs-renderergl/lib/animators/nodes/ParticleUVNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var n=e("awayjs-renderergl/lib/animators/ParticleAnimationSet");var o=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var l=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var h=e("awayjs-renderergl/lib/animators/states/ParticleUVState");var d=function(e){i(t,e);function t(t,r,i,a){if(r===void 0){r=1}if(i===void 0){i=1}if(a===void 0){a="x"}e.call(this,"ParticleUV",o.GLOBAL,4,n.POST_PRIORITY+1);this._pStateClass=h;this._cycle=r;this._scale=i;this._axis=a;this.updateUVData()}Object.defineProperty(t.prototype,"cycle",{get:function(){return this._cycle},set:function(e){this._cycle=e;this.updateUVData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(e){this._scale=e;this.updateUVData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"axis",{get:function(){return this._axis},set:function(e){this._axis=e},enumerable:true,configurable:true});t.prototype.getAGALUVCode=function(e,t){var r="";var i=t.getFreeVertexConstant();t.setRegisterIndex(this,h.UV_INDEX,i.index);var a=this._axis=="x"?0:this._axis=="y"?1:2;var n=new s(t.uvTarget.regName,t.uvTarget.index,a);var o=t.getFreeVertexSingleTemp();if(this._scale!=1)r+="mul "+n+","+n+","+i+".y\n";r+="mul "+o+","+t.vertexTime+","+i+".x\n";r+="sin "+o+","+o+"\n";r+="add "+n+","+n+","+o+"\n";return r};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype.updateUVData=function(){this._iUvData=new a(Math.PI*2/this._cycle,this._scale,0,0)};t.prototype._iProcessAnimationSetting=function(e){e.hasUVNode=true};t.U_AXIS="x";t.V_AXIS="y";return t}(l);t.exports=d},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/ParticleAnimationSet":"awayjs-renderergl/lib/animators/ParticleAnimationSet","awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleUVState":"awayjs-renderergl/lib/animators/states/ParticleUVState","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/animators/nodes/ParticleVelocityNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/nodes/ParticleNodeBase");var o=e("awayjs-renderergl/lib/animators/states/ParticleVelocityState");var l=function(e){i(t,e);function t(t,r){if(r===void 0){r=null}e.call(this,"ParticleVelocity",t,3);this._pStateClass=o;this._iVelocity=r||new a}t.prototype.getAGALVertexCode=function(e,t){var r=this._pMode==s.GLOBAL?t.getFreeVertexConstant():t.getFreeVertexAttribute();t.setRegisterIndex(this,o.VELOCITY_INDEX,r.index);var i=t.getFreeVertexVectorTemp();var a="";a+="mul "+i+","+t.vertexTime+","+r+"\n";a+="add "+t.positionTarget+".xyz,"+i+","+t.positionTarget+".xyz\n";if(t.needVelocity)a+="add "+t.velocityTarget+".xyz,"+r+".xyz,"+t.velocityTarget+".xyz\n";return a};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._iGeneratePropertyOfOneParticle=function(e){var r=e[t.VELOCITY_VECTOR3D];if(!r)throw new Error("there is no "+t.VELOCITY_VECTOR3D+" in param!");this._pOneData[0]=r.x;this._pOneData[1]=r.y;this._pOneData[2]=r.z};t.VELOCITY_VECTOR3D="VelocityVector3D";return t}(n);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/nodes/ParticleNodeBase":"awayjs-renderergl/lib/animators/nodes/ParticleNodeBase","awayjs-renderergl/lib/animators/states/ParticleVelocityState":"awayjs-renderergl/lib/animators/states/ParticleVelocityState"}],"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=e("awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState");var n=function(e){i(t,e);function t(){e.call(this);this._pStateClass=s}t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};return t}(a);t.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState"}],"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase");var s=e("awayjs-renderergl/lib/animators/states/SkeletonClipState");var n=function(e){i(t,e);function t(){e.call(this);this._frames=new Array;this.highQuality=false;this._pStateClass=s}Object.defineProperty(t.prototype,"frames",{get:function(){return this._frames},enumerable:true,configurable:true});t.prototype.addFrame=function(e,t){this._frames.push(e);this._pDurations.push(t);this._pNumFrames=this._pDurations.length;this._pStitchDirty=true};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};t.prototype._pUpdateStitch=function(){e.prototype._pUpdateStitch.call(this);var t=this._pNumFrames-1;var r,i,a;while(t--){this._pTotalDuration+=this._pDurations[t];r=this._frames[t].jointPoses[0].translation;i=this._frames[t+1].jointPoses[0].translation;a=i.subtract(r);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}if(this._pStitchFinalFrame||!this._pLooping){this._pTotalDuration+=this._pDurations[this._pNumFrames-1];r=this._frames[0].jointPoses[0].translation;i=this._frames[1].jointPoses[0].translation;a=i.subtract(r);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}};return t}(a);t.exports=n},{"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase","awayjs-renderergl/lib/animators/states/SkeletonClipState":"awayjs-renderergl/lib/animators/states/SkeletonClipState"}],"awayjs-renderergl/lib/animators/nodes/SkeletonDifferenceNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=e("awayjs-renderergl/lib/animators/states/SkeletonDifferenceState");var n=function(e){i(t,e);function t(){e.call(this);this._pStateClass=s}t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};return t}(a);t.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState":"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState"}],"awayjs-renderergl/lib/animators/nodes/SkeletonDirectionalNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=e("awayjs-renderergl/lib/animators/states/SkeletonDirectionalState");var n=function(e){i(t,e);function t(){e.call(this);this._pStateClass=s}t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};return t}(a);t.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState":"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState"}],"awayjs-renderergl/lib/animators/nodes/SkeletonNaryLERPNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var s=e("awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState");var n=function(e){i(t,e);function t(){e.call(this);this._iInputs=new Array;this._pStateClass=s}Object.defineProperty(t.prototype,"numInputs",{get:function(){return this._numInputs},enumerable:true,configurable:true});t.prototype.getInputIndex=function(e){return this._iInputs.indexOf(e)};t.prototype.getInputAt=function(e){return this._iInputs[e]};t.prototype.addInput=function(e){this._iInputs[this._numInputs++]=e};t.prototype.getAnimationState=function(e){return e.getAnimationState(this)};return t}(a);t.exports=n},{"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState":"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState"}],"awayjs-renderergl/lib/animators/nodes/VertexClipNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase");var n=e("awayjs-renderergl/lib/animators/states/VertexClipState");var o=function(e){i(t,e);function t(){e.call(this);this._frames=new Array;this._translations=new Array;this._pStateClass=n}Object.defineProperty(t.prototype,"frames",{get:function(){return this._frames},enumerable:true,configurable:true});t.prototype.addFrame=function(e,t,r){if(r===void 0){r=null}this._frames.push(e);this._pDurations.push(t);this._translations.push(r||new a);this._pNumFrames=this._pDurations.length;this._pStitchDirty=true};t.prototype._pUpdateStitch=function(){e.prototype._pUpdateStitch.call(this);var t=this._pNumFrames-1;var r,i,a;while(t--){this._pTotalDuration+=this._pDurations[t];r=this._translations[t];i=this._translations[t+1];a=i.subtract(r);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}if(this._pNumFrames>1&&(this._pStitchFinalFrame||!this._pLooping)){this._pTotalDuration+=this._pDurations[this._pNumFrames-1];r=this._translations[0];i=this._translations[1];a=i.subtract(r);this._pTotalDelta.x+=a.x;this._pTotalDelta.y+=a.y;this._pTotalDelta.z+=a.z}};return t}(s);t.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase":"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase","awayjs-renderergl/lib/animators/states/VertexClipState":"awayjs-renderergl/lib/animators/states/VertexClipState"}],"awayjs-renderergl/lib/animators/states/AnimationClipState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var s=e("awayjs-renderergl/lib/events/AnimationStateEvent");var n=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._pFramesDirty=true;this._animationClipNode=r}Object.defineProperty(t.prototype,"blendWeight",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pBlendWeight},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"currentFrame",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pCurrentFrame},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"nextFrame",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._pNextFrame},enumerable:true,configurable:true});t.prototype.update=function(e){if(!this._animationClipNode.looping){if(e>this._pStartTime+this._animationClipNode.totalDuration)e=this._pStartTime+this._animationClipNode.totalDuration;else if(e<this._pStartTime)e=this._pStartTime}if(this._pTime==e-this._pStartTime)return;this._pUpdateTime(e)};t.prototype.phase=function(e){var t=e*this._animationClipNode.totalDuration+this._pStartTime;if(this._pTime==t-this._pStartTime)return;this._pUpdateTime(t)};t.prototype._pUpdateTime=function(t){this._pFramesDirty=true;this._pTimeDir=t-this._pStartTime>this._pTime?1:-1;e.prototype._pUpdateTime.call(this,t)};t.prototype._pUpdateFrames=function(){this._pFramesDirty=false;var e=this._animationClipNode.looping;var t=this._animationClipNode.totalDuration;var r=this._animationClipNode.lastFrame;var i=this._pTime;if(e&&(i>=t||i<0)){i%=t;if(i<0)i+=t}if(!e&&i>=t){this.notifyPlaybackComplete();this._pCurrentFrame=r;this._pNextFrame=r;this._pBlendWeight=0}else if(!e&&i<=0){this._pCurrentFrame=0;this._pNextFrame=0;this._pBlendWeight=0}else if(this._animationClipNode.fixedFrameRate){var a=i/t*r;this._pCurrentFrame=Math.floor(a);this._pBlendWeight=a-this._pCurrentFrame;this._pNextFrame=this._pCurrentFrame+1}else{this._pCurrentFrame=0;this._pNextFrame=0;var s=0,n;var o=this._animationClipNode.durations;do{n=s;s+=o[this._pNextFrame];this._pCurrentFrame=this._pNextFrame++}while(i>s);if(this._pCurrentFrame==r){this._pCurrentFrame=0;this._pNextFrame=1}this._pBlendWeight=(i-n)/o[this._pCurrentFrame]}};t.prototype.notifyPlaybackComplete=function(){if(this._animationStatePlaybackComplete==null)this._animationStatePlaybackComplete=new s(s.PLAYBACK_COMPLETE,this._pAnimator,this,this._animationClipNode);this._animationClipNode.dispatchEvent(this._animationStatePlaybackComplete)};return t}(a);t.exports=n},{"awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase","awayjs-renderergl/lib/events/AnimationStateEvent":"awayjs-renderergl/lib/events/AnimationStateEvent"}],"awayjs-renderergl/lib/animators/states/AnimationStateBase":[function(e,t,r){var i=e("awayjs-core/lib/geom/Vector3D");var a=function(){function e(e,t){this._pRootDelta=new i;this._pPositionDeltaDirty=true;this._pStartTime=0;this._pAnimator=e;this._pAnimationNode=t}Object.defineProperty(e.prototype,"positionDelta",{get:function(){if(this._pPositionDeltaDirty){this._pUpdatePositionDelta()}return this._pRootDelta},enumerable:true,configurable:true});e.prototype.offset=function(e){this._pStartTime=e;this._pPositionDeltaDirty=true};e.prototype.update=function(e){if(this._pTime==e-this._pStartTime){return}this._pUpdateTime(e)};e.prototype.phase=function(e){};e.prototype._pUpdateTime=function(e){this._pTime=e-this._pStartTime;this._pPositionDeltaDirty=true};e.prototype._pUpdatePositionDelta=function(){};return e}();t.exports=a},{"awayjs-core/lib/geom/Vector3D":undefined}],"awayjs-renderergl/lib/animators/states/IAnimationState":[function(e,t,r){},{}],"awayjs-renderergl/lib/animators/states/ISkeletonAnimationState":[function(e,t,r){},{}],"awayjs-renderergl/lib/animators/states/IVertexAnimationState":[function(e,t,r){},{}],"awayjs-renderergl/lib/animators/states/ParticleAccelerationState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleAccelerationNode=r;this._acceleration=this._particleAccelerationNode._acceleration;this.updateAccelerationData()}Object.defineProperty(t.prototype,"acceleration",{get:function(){return this._acceleration},set:function(e){this._acceleration.x=e.x;this._acceleration.y=e.y;this._acceleration.z=e.z;this.updateAccelerationData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){var l=a.getRegisterIndex(this._pAnimationNode,t.ACCELERATION_INDEX);if(this._particleAccelerationNode.mode==n.LOCAL_STATIC)i.activateVertexBuffer(l,this._particleAccelerationNode._iDataOffset,e,s.FLOAT_3);else a.setVertexConst(l,this._halfAcceleration.x,this._halfAcceleration.y,this._halfAcceleration.z)};t.prototype.updateAccelerationData=function(){if(this._particleAccelerationNode.mode==n.GLOBAL)this._halfAcceleration=new a(this._acceleration.x/2,this._acceleration.y/2,this._acceleration.z/2)};t.ACCELERATION_INDEX=0;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleBezierCurveState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleBezierCurveNode=r;this._controlPoint=this._particleBezierCurveNode._iControlPoint;this._endPoint=this._particleBezierCurveNode._iEndPoint}Object.defineProperty(t.prototype,"controlPoint",{get:function(){return this._controlPoint},set:function(e){this._controlPoint=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"endPoint",{get:function(){return this._endPoint},set:function(e){this._endPoint=e},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,n,o){var l=n.getRegisterIndex(this._pAnimationNode,t.BEZIER_CONTROL_INDEX);var h=n.getRegisterIndex(this._pAnimationNode,t.BEZIER_END_INDEX);if(this._particleBezierCurveNode.mode==s.LOCAL_STATIC){i.activateVertexBuffer(l,this._particleBezierCurveNode._iDataOffset,e,a.FLOAT_3);i.activateVertexBuffer(h,this._particleBezierCurveNode._iDataOffset+3,e,a.FLOAT_3)}else{n.setVertexConst(l,this._controlPoint.x,this._controlPoint.y,this._controlPoint.z);n.setVertexConst(h,this._endPoint.x,this._endPoint.y,this._endPoint.z)}};t.BEZIER_CONTROL_INDEX=0;t.BEZIER_END_INDEX=1;return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleBillboardState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/MathConsts");var s=e("awayjs-core/lib/geom/Matrix3D");var n=e("awayjs-core/lib/geom/Orientation3D");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._matrix=new s;this._billboardAxis=r._iBillboardAxis}t.prototype.setRenderState=function(e,r,i,s,o){var l;if(this._billboardAxis){var h=r.sourceEntity.sceneTransform.position;var d=o.sceneTransform.position.subtract(h);var p=d.crossProduct(this._billboardAxis);p.normalize();d=this.billboardAxis.crossProduct(p);d.normalize();this._matrix.copyFrom(r.sourceEntity.sceneTransform);l=this._matrix.decompose(n.AXIS_ANGLE);this._matrix.copyColumnFrom(0,p);this._matrix.copyColumnFrom(1,this.billboardAxis);this._matrix.copyColumnFrom(2,d);this._matrix.copyColumnFrom(3,h);this._matrix.appendRotation(-l[1].w*a.RADIANS_TO_DEGREES,l[1])}else{this._matrix.copyFrom(r.sourceEntity.sceneTransform);this._matrix.append(o.inverseSceneTransform);l=this._matrix.decompose(n.AXIS_ANGLE);this._matrix.identity();this._matrix.appendRotation(-l[1].w*a.RADIANS_TO_DEGREES,l[1])}s.setVertexConstFromMatrix(s.getRegisterIndex(this._pAnimationNode,t.MATRIX_INDEX),this._matrix)};Object.defineProperty(t.prototype,"billboardAxis",{get:function(){return this.billboardAxis},set:function(e){this.billboardAxis=e?e.clone():null;if(this.billboardAxis)this.billboardAxis.normalize()},enumerable:true,configurable:true});t.MATRIX_INDEX=0;return t}(o);t.exports=l},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Orientation3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase"}],"awayjs-renderergl/lib/animators/states/ParticleColorState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleColorNode=r;this._usesMultiplier=this._particleColorNode._iUsesMultiplier;this._usesOffset=this._particleColorNode._iUsesOffset;this._usesCycle=this._particleColorNode._iUsesCycle;this._usesPhase=this._particleColorNode._iUsesPhase;this._startColor=this._particleColorNode._iStartColor;this._endColor=this._particleColorNode._iEndColor;this._cycleDuration=this._particleColorNode._iCycleDuration;this._cyclePhase=this._particleColorNode._iCyclePhase;this.updateColorData()}Object.defineProperty(t.prototype,"startColor",{get:function(){return this._startColor},set:function(e){this._startColor=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"endColor",{get:function(){return this._endColor},set:function(e){this._endColor=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(e){this._cycleDuration=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(e){this._cyclePhase=e;this.updateColorData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){if(a.needFragmentAnimation){var l=this._particleColorNode._iDataOffset;if(this._usesCycle)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.CYCLE_INDEX),this._cycleData.x,this._cycleData.y,this._cycleData.z,this._cycleData.w);if(this._usesMultiplier){if(this._particleColorNode.mode==n.LOCAL_STATIC){i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.START_MULTIPLIER_INDEX),l,e,s.FLOAT_4);l+=4;i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.DELTA_MULTIPLIER_INDEX),l,e,s.FLOAT_4);l+=4}else{a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.START_MULTIPLIER_INDEX),this._startMultiplierData.x,this._startMultiplierData.y,this._startMultiplierData.z,this._startMultiplierData.w);a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.DELTA_MULTIPLIER_INDEX),this._deltaMultiplierData.x,this._deltaMultiplierData.y,this._deltaMultiplierData.z,this._deltaMultiplierData.w)}}if(this._usesOffset){if(this._particleColorNode.mode==n.LOCAL_STATIC){i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.START_OFFSET_INDEX),l,e,s.FLOAT_4);l+=4;i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.DELTA_OFFSET_INDEX),l,e,s.FLOAT_4);l+=4}else{a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.START_OFFSET_INDEX),this._startOffsetData.x,this._startOffsetData.y,this._startOffsetData.z,this._startOffsetData.w);a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.DELTA_OFFSET_INDEX),this._deltaOffsetData.x,this._deltaOffsetData.y,this._deltaOffsetData.z,this._deltaOffsetData.w)}}}};t.prototype.updateColorData=function(){if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._cycleData=new a(Math.PI*2/this._cycleDuration,this._cyclePhase*Math.PI/180,0,0)}if(this._particleColorNode.mode==n.GLOBAL){if(this._usesCycle){if(this._usesMultiplier){this._startMultiplierData=new a((this._startColor.redMultiplier+this._endColor.redMultiplier)/2,(this._startColor.greenMultiplier+this._endColor.greenMultiplier)/2,(this._startColor.blueMultiplier+this._endColor.blueMultiplier)/2,(this._startColor.alphaMultiplier+this._endColor.alphaMultiplier)/2);this._deltaMultiplierData=new a((this._endColor.redMultiplier-this._startColor.redMultiplier)/2,(this._endColor.greenMultiplier-this._startColor.greenMultiplier)/2,(this._endColor.blueMultiplier-this._startColor.blueMultiplier)/2,(this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)/2)}if(this._usesOffset){this._startOffsetData=new a((this._startColor.redOffset+this._endColor.redOffset)/(255*2),(this._startColor.greenOffset+this._endColor.greenOffset)/(255*2),(this._startColor.blueOffset+this._endColor.blueOffset)/(255*2),(this._startColor.alphaOffset+this._endColor.alphaOffset)/(255*2));this._deltaOffsetData=new a((this._endColor.redOffset-this._startColor.redOffset)/(255*2),(this._endColor.greenOffset-this._startColor.greenOffset)/(255*2),(this._endColor.blueOffset-this._startColor.blueOffset)/(255*2),(this._endColor.alphaOffset-this._startColor.alphaOffset)/(255*2))}}else{if(this._usesMultiplier){this._startMultiplierData=new a(this._startColor.redMultiplier,this._startColor.greenMultiplier,this._startColor.blueMultiplier,this._startColor.alphaMultiplier);this._deltaMultiplierData=new a(this._endColor.redMultiplier-this._startColor.redMultiplier,this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._endColor.alphaMultiplier-this._startColor.alphaMultiplier)}if(this._usesOffset){this._startOffsetData=new a(this._startColor.redOffset/255,this._startColor.greenOffset/255,this._startColor.blueOffset/255,this._startColor.alphaOffset/255);this._deltaOffsetData=new a((this._endColor.redOffset-this._startColor.redOffset)/255,(this._endColor.greenOffset-this._startColor.greenOffset)/255,(this._endColor.blueOffset-this._startColor.blueOffset)/255,(this._endColor.alphaOffset-this._startColor.alphaOffset)/255)}}}};t.START_MULTIPLIER_INDEX=0;t.DELTA_MULTIPLIER_INDEX=1;t.START_OFFSET_INDEX=2;t.DELTA_OFFSET_INDEX=3;t.CYCLE_INDEX=4;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleFollowState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];
function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/MathConsts");var s=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r,true);this._targetPos=new s;this._targetEuler=new s;this._temp=new s;this._particleFollowNode=r;this._smooth=r._iSmooth}Object.defineProperty(t.prototype,"followTarget",{get:function(){return this._followTarget},set:function(e){this._followTarget=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"smooth",{get:function(){return this._smooth},set:function(e){this._smooth=e},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,s,o){if(this._followTarget){if(this._particleFollowNode._iUsesPosition){this._targetPos.x=this._followTarget.transform.position.x/r.sourceEntity.scaleX;this._targetPos.y=this._followTarget.transform.position.y/r.sourceEntity.scaleY;this._targetPos.z=this._followTarget.transform.position.z/r.sourceEntity.scaleZ}if(this._particleFollowNode._iUsesRotation){this._targetEuler.x=this._followTarget.rotationX;this._targetEuler.y=this._followTarget.rotationY;this._targetEuler.z=this._followTarget.rotationZ;this._targetEuler.scaleBy(a.DEGREES_TO_RADIANS)}}if(!this._prePos)this._prePos=this._targetPos.clone();if(!this._preEuler)this._preEuler=this._targetEuler.clone();var l=this._pTime/1e3;var h=i.previousTime;var d=l-h;var p=h!=l;if(this._particleFollowNode._iUsesPosition&&this._particleFollowNode._iUsesRotation){if(p)this.processPositionAndRotation(l,d,i);i.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,t.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,e,n.FLOAT_3);i.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,t.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset+3,e,n.FLOAT_3)}else if(this._particleFollowNode._iUsesPosition){if(p)this.processPosition(l,d,i);i.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,t.FOLLOW_POSITION_INDEX),this._particleFollowNode._iDataOffset,e,n.FLOAT_3)}else if(this._particleFollowNode._iUsesRotation){if(p)this.precessRotation(l,d,i);i.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,t.FOLLOW_ROTATION_INDEX),this._particleFollowNode._iDataOffset,e,n.FLOAT_3)}this._prePos.copyFrom(this._targetPos);this._targetEuler.copyFrom(this._targetEuler);i.previousTime=l};t.prototype.processPosition=function(e,t,r){var i=r.animationParticles;var a=r.vertexData;var s=false;var n=i.length;var o;var l;if(this._smooth){l=this._prePos.subtract(this._targetPos);l.scaleBy(1/t)}else o=this._targetPos;for(var h=0;h<n;h++){var d=(e-i[h].startTime)/i[h].totalTime;var p=(d-Math.floor(d))*i[h].totalTime;if(p-t<=0){var u=i[h].startVertexIndex*r.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(l);this._temp.scaleBy(p);o=this._targetPos.add(this._temp)}if(a[u]!=o.x||a[u+1]!=o.y||a[u+2]!=o.z){s=true;for(var c=0;c<i[h].numVertices;c++){a[u++]=o.x;a[u++]=o.y;a[u++]=o.z}}}}if(s)r.invalidateBuffer()};t.prototype.precessRotation=function(e,t,r){var i=r.animationParticles;var a=r.vertexData;var s=false;var n=i.length;var o;var l;if(this._smooth){l=this._preEuler.subtract(this._targetEuler);l.scaleBy(1/t)}else o=this._targetEuler;for(var h=0;h<n;h++){var d=(e-i[h].startTime)/i[h].totalTime;var p=(d-Math.floor(d))*i[h].totalTime;if(p-t<=0){var u=i[h].startVertexIndex*r.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(l);this._temp.scaleBy(p);o=this._targetEuler.add(this._temp)}if(a[u]!=o.x||a[u+1]!=o.y||a[u+2]!=o.z){s=true;for(var c=0;c<i[h].numVertices;c++){a[u++]=o.x;a[u++]=o.y;a[u++]=o.z}}}}if(s)r.invalidateBuffer()};t.prototype.processPositionAndRotation=function(e,t,r){var i=r.animationParticles;var a=r.vertexData;var s=false;var n=i.length;var o;var l;var h;var d;if(this._smooth){h=this._prePos.subtract(this._targetPos);h.scaleBy(1/t);d=this._preEuler.subtract(this._targetEuler);d.scaleBy(1/t)}else{o=this._targetPos;l=this._targetEuler}for(var p=0;p<n;p++){var u=(e-i[p].startTime)/i[p].totalTime;var c=(u-Math.floor(u))*i[p].totalTime;if(c-t<=0){var g=i[p].startVertexIndex*r.totalLenOfOneVertex+this._particleFollowNode._iDataOffset;if(this._smooth){this._temp.copyFrom(h);this._temp.scaleBy(c);o=this._targetPos.add(this._temp);this._temp.copyFrom(d);this._temp.scaleBy(c);l=this._targetEuler.add(this._temp)}if(a[g]!=o.x||a[g+1]!=o.y||a[g+2]!=o.z||a[g+3]!=l.x||a[g+4]!=l.y||a[g+5]!=l.z){s=true;for(var f=0;f<i[p].numVertices;f++){a[g++]=o.x;a[g++]=o.y;a[g++]=o.z;a[g++]=l.x;a[g++]=l.y;a[g++]=l.z}}}}if(s)r.invalidateBuffer()};t.FOLLOW_POSITION_INDEX=0;t.FOLLOW_ROTATION_INDEX=1;return t}(o);t.exports=l},{"awayjs-core/lib/geom/MathConsts":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleInitialColorState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleInitialColorNode=r;this._usesMultiplier=r._iUsesMultiplier;this._usesOffset=r._iUsesOffset;this._initialColor=r._iInitialColor;this.updateColorData()}Object.defineProperty(t.prototype,"initialColor",{get:function(){return this._initialColor},set:function(e){this._initialColor=e},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){r=r;o=o;if(a.needFragmentAnimation){if(this._particleInitialColorNode.mode==n.LOCAL_STATIC){var l=this._particleInitialColorNode._iDataOffset;if(this._usesMultiplier){i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.MULTIPLIER_INDEX),l,e,s.FLOAT_4);l+=4}if(this._usesOffset)i.activateVertexBuffer(a.getRegisterIndex(this._pAnimationNode,t.OFFSET_INDEX),l,e,s.FLOAT_4)}else{if(this._usesMultiplier)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.MULTIPLIER_INDEX),this._multiplierData.x,this._multiplierData.y,this._multiplierData.z,this._multiplierData.w);if(this._usesOffset)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.OFFSET_INDEX),this._offsetData.x,this._offsetData.y,this._offsetData.z,this._offsetData.w)}}};t.prototype.updateColorData=function(){if(this._particleInitialColorNode.mode==n.GLOBAL){if(this._usesMultiplier)this._multiplierData=new a(this._initialColor.redMultiplier,this._initialColor.greenMultiplier,this._initialColor.blueMultiplier,this._initialColor.alphaMultiplier);if(this._usesOffset)this._offsetData=new a(this._initialColor.redOffset/255,this._initialColor.greenOffset/255,this._initialColor.blueOffset/255,this._initialColor.alphaOffset/255)}};t.MULTIPLIER_INDEX=0;t.OFFSET_INDEX=1;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleOrbitState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var l=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var h=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleOrbitNode=r;this._usesEulers=this._particleOrbitNode._iUsesEulers;this._usesCycle=this._particleOrbitNode._iUsesCycle;this._usesPhase=this._particleOrbitNode._iUsesPhase;this._eulers=this._particleOrbitNode._iEulers;this._radius=this._particleOrbitNode._iRadius;this._cycleDuration=this._particleOrbitNode._iCycleDuration;this._cyclePhase=this._particleOrbitNode._iCyclePhase;this.updateOrbitData()}Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(e){this._radius=e;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(e){this._cycleDuration=e;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(e){this._cyclePhase=e;this.updateOrbitData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"eulers",{get:function(){return this._eulers},set:function(e){this._eulers=e;this.updateOrbitData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,s){var l=a.getRegisterIndex(this._pAnimationNode,t.ORBIT_INDEX);if(this._particleOrbitNode.mode==o.LOCAL_STATIC){if(this._usesPhase)i.activateVertexBuffer(l,this._particleOrbitNode._iDataOffset,e,n.FLOAT_4);else i.activateVertexBuffer(l,this._particleOrbitNode._iDataOffset,e,n.FLOAT_3)}else a.setVertexConst(l,this._orbitData.x,this._orbitData.y,this._orbitData.z,this._orbitData.w);if(this._usesEulers)a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,t.EULERS_INDEX),this._eulersMatrix)};t.prototype.updateOrbitData=function(){if(this._usesEulers){this._eulersMatrix=new a;this._eulersMatrix.appendRotation(this._eulers.x,s.X_AXIS);this._eulersMatrix.appendRotation(this._eulers.y,s.Y_AXIS);this._eulersMatrix.appendRotation(this._eulers.z,s.Z_AXIS)}if(this._particleOrbitNode.mode==o.GLOBAL){this._orbitData=new s(this._radius,0,this._radius*Math.PI*2,this._cyclePhase*Math.PI/180);if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._orbitData.y=Math.PI*2/this._cycleDuration}else this._orbitData.y=Math.PI*2}};t.ORBIT_INDEX=0;t.EULERS_INDEX=1;return t}(l);t.exports=h},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleOscillatorState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleOscillatorNode=r;this._oscillator=this._particleOscillatorNode._iOscillator;this.updateOscillatorData()}Object.defineProperty(t.prototype,"oscillator",{get:function(){return this._oscillator},set:function(e){this._oscillator=e;this.updateOscillatorData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){var l=a.getRegisterIndex(this._pAnimationNode,t.OSCILLATOR_INDEX);if(this._particleOscillatorNode.mode==n.LOCAL_STATIC)i.activateVertexBuffer(l,this._particleOscillatorNode._iDataOffset,e,s.FLOAT_4);else a.setVertexConst(l,this._oscillatorData.x,this._oscillatorData.y,this._oscillatorData.z,this._oscillatorData.w)};t.prototype.updateOscillatorData=function(){if(this._particleOscillatorNode.mode==n.GLOBAL){if(this._oscillator.w<=0)throw new Error("the cycle duration must greater than zero");if(this._oscillatorData==null)this._oscillatorData=new a;this._oscillatorData.x=this._oscillator.x;this._oscillatorData.y=this._oscillator.y;this._oscillatorData.z=this._oscillator.z;this._oscillatorData.w=Math.PI*2/this._oscillator.w}};t.OSCILLATOR_INDEX=0;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticlePositionState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particlePositionNode=r;this._position=this._particlePositionNode._iPosition}Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e},enumerable:true,configurable:true});t.prototype.getPositions=function(){return this._pDynamicProperties};t.prototype.setPositions=function(e){this._pDynamicProperties=e;this._pDynamicPropertiesDirty=new Object};t.prototype.setRenderState=function(e,r,i,n,o){if(this._particlePositionNode.mode==s.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[i._iUniqueId])this._pUpdateDynamicProperties(i);var l=n.getRegisterIndex(this._pAnimationNode,t.POSITION_INDEX);if(this._particlePositionNode.mode==s.GLOBAL)n.setVertexConst(l,this._position.x,this._position.y,this._position.z);else i.activateVertexBuffer(l,this._particlePositionNode._iDataOffset,e,a.FLOAT_3)};t.POSITION_INDEX=0;return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleRotateToHeadingState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var n=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._matrix=new a}t.prototype.setRenderState=function(e,r,i,a,s){if(a.hasBillboard){this._matrix.copyFrom(r.sourceEntity.sceneTransform);this._matrix.append(s.inverseSceneTransform);a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,t.MATRIX_INDEX),this._matrix)}};t.MATRIX_INDEX=0;return t}(s);t.exports=n},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase"}],"awayjs-renderergl/lib/animators/states/ParticleRotateToPositionState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._matrix=new a;this._particleRotateToPositionNode=r;this._position=this._particleRotateToPositionNode._iPosition}Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(e){this._position=e},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){var l=a.getRegisterIndex(this._pAnimationNode,t.POSITION_INDEX);if(a.hasBillboard){this._matrix.copyFrom(r.sourceEntity.sceneTransform);this._matrix.append(o.inverseSceneTransform);a.setVertexConstFromMatrix(a.getRegisterIndex(this._pAnimationNode,t.MATRIX_INDEX),this._matrix)}if(this._particleRotateToPositionNode.mode==n.GLOBAL){this._offset=r.sourceEntity.inverseSceneTransform.transformVector(this._position);a.setVertexConst(l,this._offset.x,this._offset.y,this._offset.z)}else i.activateVertexBuffer(l,this._particleRotateToPositionNode._iDataOffset,e,s.FLOAT_3)};t.MATRIX_INDEX=0;t.POSITION_INDEX=1;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleRotationalVelocityState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleRotationalVelocityNode=r;this._rotationalVelocity=this._particleRotationalVelocityNode._iRotationalVelocity;this.updateRotationalVelocityData()}Object.defineProperty(t.prototype,"rotationalVelocity",{get:function(){return this._rotationalVelocity},set:function(e){this._rotationalVelocity=e;this.updateRotationalVelocityData()},enumerable:true,configurable:true});t.prototype.getRotationalVelocities=function(){return this._pDynamicProperties};t.prototype.setRotationalVelocities=function(e){this._pDynamicProperties=e;this._pDynamicPropertiesDirty=new Object};t.prototype.setRenderState=function(e,r,i,a,o){if(this._particleRotationalVelocityNode.mode==n.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[i._iUniqueId])this._pUpdateDynamicProperties(i);var l=a.getRegisterIndex(this._pAnimationNode,t.ROTATIONALVELOCITY_INDEX);if(this._particleRotationalVelocityNode.mode==n.GLOBAL)a.setVertexConst(l,this._rotationalVelocityData.x,this._rotationalVelocityData.y,this._rotationalVelocityData.z,this._rotationalVelocityData.w);else i.activateVertexBuffer(l,this._particleRotationalVelocityNode._iDataOffset,e,s.FLOAT_4)};t.prototype.updateRotationalVelocityData=function(){if(this._particleRotationalVelocityNode.mode==n.GLOBAL){if(this._rotationalVelocity.w<=0)throw new Error("the cycle duration must greater than zero");var e=this._rotationalVelocity.clone();if(e.length<=0)e.z=1;else e.normalize();this._rotationalVelocityData=new a(e.x,e.y,e.z,Math.PI/e.w)}};t.ROTATIONALVELOCITY_INDEX=0;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleScaleState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var n=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var o=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleScaleNode=r;this._usesCycle=this._particleScaleNode._iUsesCycle;this._usesPhase=this._particleScaleNode._iUsesPhase;this._minScale=this._particleScaleNode._iMinScale;this._maxScale=this._particleScaleNode._iMaxScale;this._cycleDuration=this._particleScaleNode._iCycleDuration;this._cyclePhase=this._particleScaleNode._iCyclePhase;this.updateScaleData()}Object.defineProperty(t.prototype,"minScale",{get:function(){return this._minScale},set:function(e){this._minScale=e;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"maxScale",{get:function(){return this._maxScale},set:function(e){this._maxScale=e;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(e){this._cycleDuration=e;this.updateScaleData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(e){this._cyclePhase=e;this.updateScaleData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,o){var l=a.getRegisterIndex(this._pAnimationNode,t.SCALE_INDEX);if(this._particleScaleNode.mode==n.LOCAL_STATIC){if(this._usesCycle){if(this._usesPhase)i.activateVertexBuffer(l,this._particleScaleNode._iDataOffset,e,s.FLOAT_4);else i.activateVertexBuffer(l,this._particleScaleNode._iDataOffset,e,s.FLOAT_3)}else i.activateVertexBuffer(l,this._particleScaleNode._iDataOffset,e,s.FLOAT_2)}else a.setVertexConst(l,this._scaleData.x,this._scaleData.y,this._scaleData.z,this._scaleData.w)};t.prototype.updateScaleData=function(){if(this._particleScaleNode.mode==n.GLOBAL){if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._scaleData=new a((this._minScale+this._maxScale)/2,Math.abs(this._minScale-this._maxScale)/2,Math.PI*2/this._cycleDuration,this._cyclePhase*Math.PI/180)}else this._scaleData=new a(this._minScale,this._maxScale-this._minScale,0,0)}};t.SCALE_INDEX=0;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleSegmentedColorState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var s=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._usesMultiplier=r._iUsesMultiplier;this._usesOffset=r._iUsesOffset;this._startColor=r._iStartColor;this._endColor=r._iEndColor;this._segmentPoints=r._iSegmentPoints;this._numSegmentPoint=r._iNumSegmentPoint;this.updateColorData()}Object.defineProperty(t.prototype,"startColor",{get:function(){return this._startColor},set:function(e){this._startColor=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"endColor",{get:function(){return this._endColor},set:function(e){this._endColor=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSegmentPoint",{get:function(){return this._numSegmentPoint},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"segmentPoints",{get:function(){return this._segmentPoints},set:function(e){this._segmentPoints=e;this.updateColorData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"usesMultiplier",{get:function(){return this._usesMultiplier},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"usesOffset",{get:function(){return this._usesOffset},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,a,s){if(a.needFragmentAnimation){if(this._numSegmentPoint>0)a.setVertexConst(a.getRegisterIndex(this._pAnimationNode,t.TIME_DATA_INDEX),this._timeLifeData[0],this._timeLifeData[1],this._timeLifeData[2],this._timeLifeData[3]);if(this._usesMultiplier)a.setVertexConstFromArray(a.getRegisterIndex(this._pAnimationNode,t.START_MULTIPLIER_INDEX),this._multiplierData);if(this._usesOffset)a.setVertexConstFromArray(a.getRegisterIndex(this._pAnimationNode,t.START_OFFSET_INDEX),this._offsetData)}};t.prototype.updateColorData=function(){this._timeLifeData=new Array;this._multiplierData=new Array;this._offsetData=new Array;var e;for(e=0;e<this._numSegmentPoint;e++){if(e==0)this._timeLifeData.push(this._segmentPoints[e].life);else this._timeLifeData.push(this._segmentPoints[e].life-this._segmentPoints[e-1].life)}if(this._numSegmentPoint==0)this._timeLifeData.push(1);else this._timeLifeData.push(1-this._segmentPoints[e-1].life);if(this._usesMultiplier){this._multiplierData.push(this._startColor.redMultiplier,this._startColor.greenMultiplier,this._startColor.blueMultiplier,this._startColor.alphaMultiplier);for(e=0;e<this._numSegmentPoint;e++){if(e==0)this._multiplierData.push((this._segmentPoints[e].color.redMultiplier-this._startColor.redMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.greenMultiplier-this._startColor.greenMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.blueMultiplier-this._startColor.blueMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.alphaMultiplier-this._startColor.alphaMultiplier)/this._timeLifeData[e]);else this._multiplierData.push((this._segmentPoints[e].color.redMultiplier-this._segmentPoints[e-1].color.redMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.greenMultiplier-this._segmentPoints[e-1].color.greenMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.blueMultiplier-this._segmentPoints[e-1].color.blueMultiplier)/this._timeLifeData[e],(this._segmentPoints[e].color.alphaMultiplier-this._segmentPoints[e-1].color.alphaMultiplier)/this._timeLifeData[e])}if(this._numSegmentPoint==0)this._multiplierData.push(this._endColor.redMultiplier-this._startColor.redMultiplier,this._endColor.greenMultiplier-this._startColor.greenMultiplier,this._endColor.blueMultiplier-this._startColor.blueMultiplier,this._endColor.alphaMultiplier-this._startColor.alphaMultiplier);else this._multiplierData.push((this._endColor.redMultiplier-this._segmentPoints[e-1].color.redMultiplier)/this._timeLifeData[e],(this._endColor.greenMultiplier-this._segmentPoints[e-1].color.greenMultiplier)/this._timeLifeData[e],(this._endColor.blueMultiplier-this._segmentPoints[e-1].color.blueMultiplier)/this._timeLifeData[e],(this._endColor.alphaMultiplier-this._segmentPoints[e-1].color.alphaMultiplier)/this._timeLifeData[e])}if(this._usesOffset){this._offsetData.push(this._startColor.redOffset/255,this._startColor.greenOffset/255,this._startColor.blueOffset/255,this._startColor.alphaOffset/255);for(e=0;e<this._numSegmentPoint;e++){if(e==0)this._offsetData.push((this._segmentPoints[e].color.redOffset-this._startColor.redOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.greenOffset-this._startColor.greenOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.blueOffset-this._startColor.blueOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.alphaOffset-this._startColor.alphaOffset)/this._timeLifeData[e]/255);else this._offsetData.push((this._segmentPoints[e].color.redOffset-this._segmentPoints[e-1].color.redOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.greenOffset-this._segmentPoints[e-1].color.greenOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.blueOffset-this._segmentPoints[e-1].color.blueOffset)/this._timeLifeData[e]/255,(this._segmentPoints[e].color.alphaOffset-this._segmentPoints[e-1].color.alphaOffset)/this._timeLifeData[e]/255)}if(this._numSegmentPoint==0)this._offsetData.push((this._endColor.redOffset-this._startColor.redOffset)/255,(this._endColor.greenOffset-this._startColor.greenOffset)/255,(this._endColor.blueOffset-this._startColor.blueOffset)/255,(this._endColor.alphaOffset-this._startColor.alphaOffset)/255);else this._offsetData.push((this._endColor.redOffset-this._segmentPoints[e-1].color.redOffset)/this._timeLifeData[e]/255,(this._endColor.greenOffset-this._segmentPoints[e-1].color.greenOffset)/this._timeLifeData[e]/255,(this._endColor.blueOffset-this._segmentPoints[e-1].color.blueOffset)/this._timeLifeData[e]/255,(this._endColor.alphaOffset-this._segmentPoints[e-1].color.alphaOffset)/this._timeLifeData[e]/255)}this._timeLifeData.length=4};t.START_MULTIPLIER_INDEX=0;t.START_OFFSET_INDEX=1;t.TIME_DATA_INDEX=2;return t}(a);t.exports=s},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase"}],"awayjs-renderergl/lib/animators/states/ParticleSpriteSheetState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleSpriteSheetNode=r;this._usesCycle=this._particleSpriteSheetNode._iUsesCycle;this._usesPhase=this._particleSpriteSheetNode._iUsesCycle;this._totalFrames=this._particleSpriteSheetNode._iTotalFrames;this._numColumns=this._particleSpriteSheetNode._iNumColumns;this._numRows=this._particleSpriteSheetNode._iNumRows;this._cycleDuration=this._particleSpriteSheetNode._iCycleDuration;this._cyclePhase=this._particleSpriteSheetNode._iCyclePhase;this.updateSpriteSheetData()}Object.defineProperty(t.prototype,"cyclePhase",{get:function(){return this._cyclePhase},set:function(e){this._cyclePhase=e;this.updateSpriteSheetData()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"cycleDuration",{get:function(){return this._cycleDuration},set:function(e){this._cycleDuration=e;this.updateSpriteSheetData()},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,r,i,n,o){if(n.needUVAnimation){n.setVertexConst(n.getRegisterIndex(this._pAnimationNode,t.UV_INDEX_0),this._spriteSheetData[0],this._spriteSheetData[1],this._spriteSheetData[2],this._spriteSheetData[3]);if(this._usesCycle){var l=n.getRegisterIndex(this._pAnimationNode,t.UV_INDEX_1);if(this._particleSpriteSheetNode.mode==s.LOCAL_STATIC){if(this._usesPhase)i.activateVertexBuffer(l,this._particleSpriteSheetNode._iDataOffset,e,a.FLOAT_3);else i.activateVertexBuffer(l,this._particleSpriteSheetNode._iDataOffset,e,a.FLOAT_2)}else n.setVertexConst(l,this._spriteSheetData[4],this._spriteSheetData[5])}}};t.prototype.updateSpriteSheetData=function(){this._spriteSheetData=new Array(8);var e=this._totalFrames/this._numColumns;this._spriteSheetData[0]=e;this._spriteSheetData[1]=1/this._numColumns;this._spriteSheetData[2]=1/this._numRows;if(this._usesCycle){if(this._cycleDuration<=0)throw new Error("the cycle duration must be greater than zero");this._spriteSheetData[4]=e/this._cycleDuration;this._spriteSheetData[5]=this._cycleDuration;if(this._usesPhase)this._spriteSheetData[6]=this._cyclePhase}};t.UV_INDEX_0=0;t.UV_INDEX_1=1;return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleStateBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];
function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var s=function(e){i(t,e);function t(t,r,i){if(i===void 0){i=false}e.call(this,t,r);this._pDynamicProperties=new Array;this._pDynamicPropertiesDirty=new Object;this._particleNode=r;this._pNeedUpdateTime=i}Object.defineProperty(t.prototype,"needUpdateTime",{get:function(){return this._pNeedUpdateTime},enumerable:true,configurable:true});t.prototype.setRenderState=function(e,t,r,i,a){};t.prototype._pUpdateDynamicProperties=function(e){this._pDynamicPropertiesDirty[e._iUniqueId]=true;var t=e.animationParticles;var r=e.vertexData;var i=e.totalLenOfOneVertex;var a=this._particleNode.dataLength;var s=this._particleNode._iDataOffset;var n;var o;var l;var h;var d;var p=this._pDynamicProperties.length;var u=0;var c=0;var g=0;while(u<p){while(c<p&&(d=t[c]).index==u){h=this._pDynamicProperties[u];n=d.numVertices*i;o=d.startVertexIndex*i+s;for(g=0;g<n;g+=i){l=o+g;for(g=0;g<n;g+=i){l=o+g;r[l++]=h.x;r[l++]=h.y;r[l++]=h.z;if(a==4)r[l++]=h.w}}c++}u++}e.invalidateBuffer()};return t}(a);t.exports=s},{"awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase"}],"awayjs-renderergl/lib/animators/states/ParticleTimeState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var n=function(e){i(t,e);function t(t,r){e.call(this,t,r,true);this._particleTimeNode=r}t.prototype.setRenderState=function(e,r,i,s,n){i.activateVertexBuffer(s.getRegisterIndex(this._pAnimationNode,t.TIME_STREAM_INDEX),this._particleTimeNode._iDataOffset,e,a.FLOAT_4);var o=this._pTime/1e3;s.setVertexConst(s.getRegisterIndex(this._pAnimationNode,t.TIME_CONSTANT_INDEX),o,o,o,o)};t.TIME_STREAM_INDEX=0;t.TIME_CONSTANT_INDEX=1;return t}(s);t.exports=n},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/ParticleUVState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var s=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleUVNode=r}t.prototype.setRenderState=function(e,r,i,a,s){if(a.needUVAnimation){var n=a.getRegisterIndex(this._pAnimationNode,t.UV_INDEX);var o=this._particleUVNode._iUvData;a.setVertexConst(n,o.x,o.y)}};t.UV_INDEX=0;return t}(a);t.exports=s},{"awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase"}],"awayjs-renderergl/lib/animators/states/ParticleVelocityState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var s=e("awayjs-renderergl/lib/animators/data/ParticlePropertiesMode");var n=e("awayjs-renderergl/lib/animators/states/ParticleStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._particleVelocityNode=r;this._velocity=this._particleVelocityNode._iVelocity}Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},set:function(e){this._velocity=e},enumerable:true,configurable:true});t.prototype.getVelocities=function(){return this._pDynamicProperties};t.prototype.setVelocities=function(e){this._pDynamicProperties=e;this._pDynamicPropertiesDirty=new Object};t.prototype.setRenderState=function(e,r,i,n,o){if(this._particleVelocityNode.mode==s.LOCAL_DYNAMIC&&!this._pDynamicPropertiesDirty[i._iUniqueId])this._pUpdateDynamicProperties(i);var l=n.getRegisterIndex(this._pAnimationNode,t.VELOCITY_INDEX);if(this._particleVelocityNode.mode==s.GLOBAL)n.setVertexConst(l,this._velocity.x,this._velocity.y,this._velocity.z);else i.activateVertexBuffer(l,this._particleVelocityNode._iDataOffset,e,a.FLOAT_3)};t.VELOCITY_INDEX=0;return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode":"awayjs-renderergl/lib/animators/data/ParticlePropertiesMode","awayjs-renderergl/lib/animators/states/ParticleStateBase":"awayjs-renderergl/lib/animators/states/ParticleStateBase","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":undefined}],"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/JointPose");var s=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._blendWeight=0;this._skeletonPose=new s;this._skeletonPoseDirty=true;this._skeletonAnimationNode=r;this._inputA=t.getAnimationState(this._skeletonAnimationNode.inputA);this._inputB=t.getAnimationState(this._skeletonAnimationNode.inputB)}Object.defineProperty(t.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(e){this._blendWeight=e;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true},enumerable:true,configurable:true});t.prototype.phase=function(e){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._inputA.phase(e);this._inputB.phase(e)};t.prototype._pUpdateTime=function(t){this._skeletonPoseDirty=true;this._inputA.update(t);this._inputB.update(t);e.prototype._pUpdateTime.call(this,t)};t.prototype.getSkeletonPose=function(e){if(this._skeletonPoseDirty)this.updateSkeletonPose(e);return this._skeletonPose};t.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var e=this._inputA.positionDelta;var t=this._inputB.positionDelta;this._pRootDelta.x=e.x+this._blendWeight*(t.x-e.x);this._pRootDelta.y=e.y+this._blendWeight*(t.y-e.y);this._pRootDelta.z=e.z+this._blendWeight*(t.z-e.z)};t.prototype.updateSkeletonPose=function(e){this._skeletonPoseDirty=false;var t;var r=this._skeletonPose.jointPoses;var i=this._inputA.getSkeletonPose(e).jointPoses;var s=this._inputB.getSkeletonPose(e).jointPoses;var n,o;var l,h;var d;var p=e.numJoints;if(r.length!=p)r.length=p;for(var u=0;u<p;++u){t=r[u];if(t==null)t=r[u]=new a;n=i[u];o=s[u];l=n.translation;h=o.translation;t.orientation.lerp(n.orientation,o.orientation,this._blendWeight);d=t.translation;d.x=l.x+this._blendWeight*(h.x-l.x);d.y=l.y+this._blendWeight*(h.y-l.y);d.z=l.z+this._blendWeight*(h.z-l.z)}};return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase"}],"awayjs-renderergl/lib/animators/states/SkeletonClipState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Vector3D");var s=e("awayjs-renderergl/lib/animators/data/JointPose");var n=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var o=e("awayjs-renderergl/lib/animators/states/AnimationClipState");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._rootPos=new a;this._skeletonPose=new n;this._skeletonPoseDirty=true;this._skeletonClipNode=r;this._frames=this._skeletonClipNode.frames}Object.defineProperty(t.prototype,"currentPose",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._currentPose},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"nextPose",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._nextPose},enumerable:true,configurable:true});t.prototype.getSkeletonPose=function(e){if(this._skeletonPoseDirty)this.updateSkeletonPose(e);return this._skeletonPose};t.prototype._pUpdateTime=function(t){this._skeletonPoseDirty=true;e.prototype._pUpdateTime.call(this,t)};t.prototype._pUpdateFrames=function(){e.prototype._pUpdateFrames.call(this);this._currentPose=this._frames[this._pCurrentFrame];if(this._skeletonClipNode.looping&&this._pNextFrame>=this._skeletonClipNode.lastFrame){this._nextPose=this._frames[0];this._pAnimator.dispatchCycleEvent()}else this._nextPose=this._frames[this._pNextFrame]};t.prototype.updateSkeletonPose=function(e){this._skeletonPoseDirty=false;if(!this._skeletonClipNode.totalDuration)return;if(this._pFramesDirty)this._pUpdateFrames();var t=this._currentPose.jointPoses;var r=this._nextPose.jointPoses;var i=e.numJoints;var a,n;var o,l;var h=this._skeletonPose.jointPoses;var d;var p;if(h.length!=i)h.length=i;if(i!=t.length||i!=r.length)throw new Error("joint counts don't match!");for(var u=0;u<i;++u){d=h[u];if(d==null)d=h[u]=new s;o=t[u];l=r[u];a=o.translation;n=l.translation;if(this._skeletonClipNode.highQuality)d.orientation.slerp(o.orientation,l.orientation,this._pBlendWeight);else d.orientation.lerp(o.orientation,l.orientation,this._pBlendWeight);if(u>0){p=d.translation;p.x=a.x+this._pBlendWeight*(n.x-a.x);p.y=a.y+this._pBlendWeight*(n.y-a.y);p.z=a.z+this._pBlendWeight*(n.z-a.z)}}};t.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;if(this._pFramesDirty)this._pUpdateFrames();var e,t,r;var i=this._skeletonClipNode.totalDelta;if(this._pTimeDir>0&&this._pNextFrame<this._pOldFrame||this._pTimeDir<0&&this._pNextFrame>this._pOldFrame){this._rootPos.x-=i.x*this._pTimeDir;this._rootPos.y-=i.y*this._pTimeDir;this._rootPos.z-=i.z*this._pTimeDir}var a=this._rootPos.x;var s=this._rootPos.y;var n=this._rootPos.z;if(this._skeletonClipNode.stitchFinalFrame&&this._pNextFrame==this._skeletonClipNode.lastFrame){e=this._frames[0].jointPoses[0].translation;t=this._frames[1].jointPoses[0].translation;r=this._currentPose.jointPoses[0].translation;this._rootPos.x=r.x+e.x+this._pBlendWeight*(t.x-e.x);this._rootPos.y=r.y+e.y+this._pBlendWeight*(t.y-e.y);this._rootPos.z=r.z+e.z+this._pBlendWeight*(t.z-e.z)}else{e=this._currentPose.jointPoses[0].translation;t=this._frames[this._pNextFrame].jointPoses[0].translation;this._rootPos.x=e.x+this._pBlendWeight*(t.x-e.x);this._rootPos.y=e.y+this._pBlendWeight*(t.y-e.y);this._rootPos.z=e.z+this._pBlendWeight*(t.z-e.z)}this._pRootDelta.x=this._rootPos.x-a;this._pRootDelta.y=this._rootPos.y-s;this._pRootDelta.z=this._rootPos.z-n;this._pOldFrame=this._pNextFrame};return t}(o);t.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/animators/states/AnimationClipState":"awayjs-renderergl/lib/animators/states/AnimationClipState"}],"awayjs-renderergl/lib/animators/states/SkeletonDifferenceState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Quaternion");var s=e("awayjs-renderergl/lib/animators/data/JointPose");var n=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var o=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var l=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._blendWeight=0;this._skeletonPose=new n;this._skeletonPoseDirty=true;this._skeletonAnimationNode=r;this._baseInput=t.getAnimationState(this._skeletonAnimationNode.baseInput);this._differenceInput=t.getAnimationState(this._skeletonAnimationNode.differenceInput)}Object.defineProperty(t.prototype,"blendWeight",{get:function(){return this._blendWeight},set:function(e){this._blendWeight=e;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true},enumerable:true,configurable:true});t.prototype.phase=function(e){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._baseInput.phase(e);this._baseInput.phase(e)};t.prototype._pUpdateTime=function(t){this._skeletonPoseDirty=true;this._baseInput.update(t);this._differenceInput.update(t);e.prototype._pUpdateTime.call(this,t)};t.prototype.getSkeletonPose=function(e){if(this._skeletonPoseDirty)this.updateSkeletonPose(e);return this._skeletonPose};t.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var e=this._baseInput.positionDelta;var t=this._differenceInput.positionDelta;this.positionDelta.x=e.x+this._blendWeight*t.x;this.positionDelta.y=e.y+this._blendWeight*t.y;this.positionDelta.z=e.z+this._blendWeight*t.z};t.prototype.updateSkeletonPose=function(e){this._skeletonPoseDirty=false;var r;var i=this._skeletonPose.jointPoses;var a=this._baseInput.getSkeletonPose(e).jointPoses;var n=this._differenceInput.getSkeletonPose(e).jointPoses;var o,l;var h,d;var p;var u=e.numJoints;if(i.length!=u)i.length=u;for(var c=0;c<u;++c){r=i[c];if(r==null)r=i[c]=new s;o=a[c];l=n[c];h=o.translation;d=l.translation;t._tempQuat.multiply(l.orientation,o.orientation);r.orientation.lerp(o.orientation,t._tempQuat,this._blendWeight);p=r.translation;p.x=h.x+this._blendWeight*d.x;p.y=h.y+this._blendWeight*d.y;p.z=h.z+this._blendWeight*d.z}};t._tempQuat=new a;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase"}],"awayjs-renderergl/lib/animators/states/SkeletonDirectionalState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/JointPose");var s=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._skeletonPose=new s;this._skeletonPoseDirty=true;this._blendWeight=0;this._direction=0;this._blendDirty=true;this._skeletonAnimationNode=r;this._forward=t.getAnimationState(this._skeletonAnimationNode.forward);this._backward=t.getAnimationState(this._skeletonAnimationNode.backward);this._left=t.getAnimationState(this._skeletonAnimationNode.left);this._right=t.getAnimationState(this._skeletonAnimationNode.right)}Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){if(this._direction==e)return;this._direction=e;this._blendDirty=true;this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true},enumerable:true,configurable:true});t.prototype.phase=function(e){if(this._blendDirty)this.updateBlend();this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;this._inputA.phase(e);this._inputB.phase(e)};t.prototype._pUdateTime=function(t){if(this._blendDirty)this.updateBlend();this._skeletonPoseDirty=true;this._inputA.update(t);this._inputB.update(t);e.prototype._pUpdateTime.call(this,t)};t.prototype.getSkeletonPose=function(e){if(this._skeletonPoseDirty)this.updateSkeletonPose(e);return this._skeletonPose};t.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;if(this._blendDirty)this.updateBlend();var e=this._inputA.positionDelta;var t=this._inputB.positionDelta;this.positionDelta.x=e.x+this._blendWeight*(t.x-e.x);this.positionDelta.y=e.y+this._blendWeight*(t.y-e.y);this.positionDelta.z=e.z+this._blendWeight*(t.z-e.z)};t.prototype.updateSkeletonPose=function(e){this._skeletonPoseDirty=false;if(this._blendDirty)this.updateBlend();var t;var r=this._skeletonPose.jointPoses;var i=this._inputA.getSkeletonPose(e).jointPoses;var s=this._inputB.getSkeletonPose(e).jointPoses;var n,o;var l,h;var d;var p=e.numJoints;if(r.length!=p)r.length=p;for(var u=0;u<p;++u){t=r[u];if(t==null)t=r[u]=new a;n=i[u];o=s[u];l=n.translation;h=o.translation;t.orientation.lerp(n.orientation,o.orientation,this._blendWeight);d=t.translation;d.x=l.x+this._blendWeight*(h.x-l.x);d.y=l.y+this._blendWeight*(h.y-l.y);d.z=l.z+this._blendWeight*(h.z-l.z)}};t.prototype.updateBlend=function(){this._blendDirty=false;if(this._direction<0||this._direction>360){this._direction%=360;if(this._direction<0)this._direction+=360}if(this._direction<90){this._inputA=this._forward;this._inputB=this._right;this._blendWeight=this._direction/90}else if(this._direction<180){this._inputA=this._right;this._inputB=this._backward;this._blendWeight=(this._direction-90)/90}else if(this._direction<270){this._inputA=this._backward;this._inputB=this._left;this._blendWeight=(this._direction-180)/90}else{this._inputA=this._left;this._inputB=this._forward;this._blendWeight=(this._direction-270)/90}};return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase"}],"awayjs-renderergl/lib/animators/states/SkeletonNaryLERPState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/data/JointPose");var s=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=e("awayjs-renderergl/lib/animators/states/AnimationStateBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._skeletonPose=new s;this._skeletonPoseDirty=true;this._blendWeights=new Array;this._inputs=new Array;this._skeletonAnimationNode=r;var i=this._skeletonAnimationNode.numInputs;while(i--)this._inputs[i]=t.getAnimationState(this._skeletonAnimationNode._iInputs[i])}t.prototype.phase=function(e){this._skeletonPoseDirty=true;this._pPositionDeltaDirty=true;for(var t=0;t<this._skeletonAnimationNode.numInputs;++t){if(this._blendWeights[t])this._inputs[t].update(e)}};t.prototype._pUdateTime=function(t){for(var r=0;r<this._skeletonAnimationNode.numInputs;++r){if(this._blendWeights[r])this._inputs[r].update(t)}e.prototype._pUpdateTime.call(this,t)};t.prototype.getSkeletonPose=function(e){if(this._skeletonPoseDirty)this.updateSkeletonPose(e);return this._skeletonPose};t.prototype.getBlendWeightAt=function(e){return this._blendWeights[e]};t.prototype.setBlendWeightAt=function(e,t){this._blendWeights[e]=t;this._pPositionDeltaDirty=true;this._skeletonPoseDirty=true};t.prototype._pUpdatePositionDelta=function(){this._pPositionDeltaDirty=false;var e;var t;this.positionDelta.x=0;this.positionDelta.y=0;this.positionDelta.z=0;for(var r=0;r<this._skeletonAnimationNode.numInputs;++r){t=this._blendWeights[r];if(t){e=this._inputs[r].positionDelta;this.positionDelta.x+=t*e.x;this.positionDelta.y+=t*e.y;this.positionDelta.z+=t*e.z}}};t.prototype.updateSkeletonPose=function(e){this._skeletonPoseDirty=false;var t;var r=this._skeletonPose.jointPoses;var i;var s,n;var o,l;var h,d;var p;var u;var c,g,f,_;var m,y,v,b;var x=e.numJoints;if(r.length!=x)r.length=x;for(var w=0;w<this._skeletonAnimationNode.numInputs;++w){t=this._blendWeights[w];if(!t)continue;i=this._inputs[w].getSkeletonPose(e).jointPoses;if(!p){p=i;for(u=0;u<x;++u){s=r[u];if(s==null)s=r[u]=new a;n=i[u];d=n.orientation;l=n.translation;h=s.orientation;h.x=t*d.x;h.y=t*d.y;h.z=t*d.z;h.w=t*d.w;o=s.translation;o.x=t*l.x;o.y=t*l.y;o.z=t*l.z}}else{for(u=0;u<e.numJoints;++u){s=r[u];n=i[u];d=p[u].orientation;g=d.x;f=d.y;_=d.z;c=d.w;d=n.orientation;l=n.translation;y=d.x;v=d.y;b=d.z;m=d.w;if(g*y+f*v+_*b+c*m<0){y=-y;v=-v;b=-b;m=-m}h=s.orientation;h.x+=t*y;h.y+=t*v;h.z+=t*b;h.w+=t*m;o=s.translation;o.x+=t*l.x;o.y+=t*l.y;o.z+=t*l.z}}}for(u=0;u<e.numJoints;++u)r[u].orientation.normalize()};return t}(n);t.exports=o},{"awayjs-renderergl/lib/animators/data/JointPose":"awayjs-renderergl/lib/animators/data/JointPose","awayjs-renderergl/lib/animators/data/SkeletonPose":"awayjs-renderergl/lib/animators/data/SkeletonPose","awayjs-renderergl/lib/animators/states/AnimationStateBase":"awayjs-renderergl/lib/animators/states/AnimationStateBase"}],"awayjs-renderergl/lib/animators/states/VertexClipState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/AnimationClipState");var s=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._vertexClipNode=r;this._frames=this._vertexClipNode.frames}Object.defineProperty(t.prototype,"currentGeometry",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._currentGeometry},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"nextGeometry",{get:function(){if(this._pFramesDirty)this._pUpdateFrames();return this._nextGeometry},enumerable:true,configurable:true});t.prototype._pUpdateFrames=function(){e.prototype._pUpdateFrames.call(this);this._currentGeometry=this._frames[this._pCurrentFrame];if(this._vertexClipNode.looping&&this._pNextFrame>=this._vertexClipNode.lastFrame){this._nextGeometry=this._frames[0];this._pAnimator.dispatchCycleEvent()}else this._nextGeometry=this._frames[this._pNextFrame]};t.prototype._pUpdatePositionDelta=function(){};return t}(a);t.exports=s},{"awayjs-renderergl/lib/animators/states/AnimationClipState":"awayjs-renderergl/lib/animators/states/AnimationClipState"}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode");var s=e("awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState");var n=function(e){i(t,e);function t(){e.call(this);this._pStateClass=s}return t}(a);t.exports=n},{"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode":"awayjs-renderergl/lib/animators/nodes/SkeletonBinaryLERPNode","awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState":"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState"}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionState":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState");var s=e("awayjs-renderergl/lib/events/AnimationStateEvent");var n=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._crossfadeTransitionNode=r}t.prototype._pUpdateTime=function(t){this.blendWeight=Math.abs(t-this._crossfadeTransitionNode.startBlend)/(1e3*this._crossfadeTransitionNode.blendSpeed);if(this.blendWeight>=1){this.blendWeight=1;if(this._animationStateTransitionComplete==null)this._animationStateTransitionComplete=new s(s.TRANSITION_COMPLETE,this._pAnimator,this,this._crossfadeTransitionNode);this._crossfadeTransitionNode.dispatchEvent(this._animationStateTransitionComplete)}e.prototype._pUpdateTime.call(this,t)};return t}(a);t.exports=n},{"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState":"awayjs-renderergl/lib/animators/states/SkeletonBinaryLERPState","awayjs-renderergl/lib/events/AnimationStateEvent":"awayjs-renderergl/lib/events/AnimationStateEvent"}],"awayjs-renderergl/lib/animators/transitions/CrossfadeTransition":[function(e,t,r){var i=e("awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode");var a=function(){function e(e){this.blendSpeed=.5;this.blendSpeed=e}e.prototype.getAnimationNode=function(e,t,r,a){var s=new i;s.inputA=t;s.inputB=r;s.blendSpeed=this.blendSpeed;s.startBlend=a;return s};return e}();t.exports=a},{"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode":"awayjs-renderergl/lib/animators/transitions/CrossfadeTransitionNode"}],"awayjs-renderergl/lib/animators/transitions/IAnimationTransition":[function(e,t,r){},{}],"awayjs-renderergl/lib/base/ParticleGeometry":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/base/Geometry");var s=function(e){i(t,e);function t(){e.apply(this,arguments)}return t}(a);t.exports=s},{"awayjs-display/lib/base/Geometry":undefined}],"awayjs-renderergl/lib/errors/AnimationSetError":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/errors/Error");var s=function(e){i(t,e);function t(t){e.call(this,t)}return t}(a);t.exports=s},{"awayjs-core/lib/errors/Error":undefined}],"awayjs-renderergl/lib/events/AnimationStateEvent":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=function(e){i(t,e);function t(t,r,i,a){e.call(this,t);this._animator=r;this._animationState=i;this._animationNode=a}Object.defineProperty(t.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationState",{get:function(){return this._animationState},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationNode",{get:function(){return this._animationNode},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.type,this._animator,this._animationState,this._animationNode)};t.PLAYBACK_COMPLETE="playbackComplete";t.TRANSITION_COMPLETE="transitionComplete";return t}(a);t.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-renderergl/lib/events/AnimatorEvent":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=function(e){i(t,e);function t(t,r){e.call(this,t);this._animator=r}Object.defineProperty(t.prototype,"animator",{get:function(){return this._animator},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.type,this._animator)};t.START="start";t.STOP="stop";t.CYCLE_COMPLETE="cycle_complete";return t}(a);t.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-renderergl/lib/events/ShadingMethodEvent":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=function(e){i(t,e);function t(t){e.call(this,t)}t.SHADER_INVALIDATED="ShaderInvalidated";return t}(a);t.exports=s},{"awayjs-core/lib/events/Event":undefined}],"awayjs-renderergl/lib/filters/Filter3DBase":[function(e,t,r){var i=function(){function e(){this._tasks=new Array}Object.defineProperty(e.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});e.prototype.pAddTask=function(e){this._tasks.push(e);if(this._requireDepthRender==null)this._requireDepthRender=e.requireDepthRender};Object.defineProperty(e.prototype,"tasks",{get:function(){return this._tasks},enumerable:true,configurable:true});e.prototype.getMainInputTexture=function(e){return this._tasks[0].getMainInputTexture(e)};Object.defineProperty(e.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(e){this._textureWidth=e;for(var t=0;t<this._tasks.length;++t)this._tasks[t].textureWidth=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(e){this._textureHeight=e;for(var t=0;t<this._tasks.length;++t)this._tasks[t].textureHeight=e},enumerable:true,configurable:true});e.prototype.setRenderTargets=function(e,t){this._tasks[this._tasks.length-1].target=e};e.prototype.dispose=function(){for(var e=0;e<this._tasks.length;++e)this._tasks[e].dispose()};e.prototype.update=function(e,t){};return e}();t.exports=i},{}],"awayjs-renderergl/lib/filters/tasks/Filter3DTaskBase":[function(e,t,r){var i=e("awayjs-core/lib/errors/AbstractMethodError");var a=e("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var s=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var n=function(){function e(e){if(e===void 0){e=false}this._scaledTextureWidth=-1;this._scaledTextureHeight=-1;this._textureWidth=-1;this._textureHeight=-1;this._textureDimensionsInvalid=true;this._program3DInvalid=true;this._textureScale=0;this._requireDepthRender=e}Object.defineProperty(e.prototype,"textureScale",{get:function(){return this._textureScale},set:function(e){if(this._textureScale==e)return;this._textureScale=e;this._scaledTextureWidth=this._textureWidth>>this._textureScale;this._scaledTextureHeight=this._textureHeight>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(e){this._target=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureWidth",{get:function(){return this._textureWidth},set:function(e){if(this._textureWidth==e)return;this._textureWidth=e;this._scaledTextureWidth=this._textureWidth>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"textureHeight",{get:function(){return this._textureHeight},set:function(e){if(this._textureHeight==e)return;this._textureHeight=e;this._scaledTextureHeight=this._textureHeight>>this._textureScale;this._textureDimensionsInvalid=true},enumerable:true,configurable:true});e.prototype.getMainInputTexture=function(e){if(this._textureDimensionsInvalid)this.pUpdateTextures(e);return this._mainInputTexture};e.prototype.dispose=function(){if(this._mainInputTexture)this._mainInputTexture.dispose();if(this._program3D)this._program3D.dispose()};e.prototype.pInvalidateProgram=function(){this._program3DInvalid=true};e.prototype.pUpdateProgram=function(e){if(this._program3D)this._program3D.dispose();this._program3D=e.context.createProgram();var t=(new a).assemble("part vertex 1\n"+this.pGetVertexCode()+"endpart")["vertex"].data;var r=(new a).assemble("part fragment 1\n"+this.pGetFragmentCode()+"endpart")["fragment"].data;this._program3D.upload(t,r);this._program3DInvalid=false};e.prototype.pGetVertexCode=function(){return"mov op, va0\n"+"mov v0, va1\n"};e.prototype.pGetFragmentCode=function(){throw new i;return null};e.prototype.pUpdateTextures=function(e){if(this._mainInputTexture)this._mainInputTexture.dispose();this._mainInputTexture=e.context.createTexture(this._scaledTextureWidth,this._scaledTextureHeight,s.BGRA,true);this._textureDimensionsInvalid=false};e.prototype.getProgram=function(e){if(this._program3DInvalid)this.pUpdateProgram(e);return this._program3D};e.prototype.activate=function(e,t,r){};e.prototype.deactivate=function(e){};Object.defineProperty(e.prototype,"requireDepthRender",{get:function(){return this._requireDepthRender},enumerable:true,configurable:true});return e}();t.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLTextureFormat":undefined}],"awayjs-renderergl/lib/managers/RTTBufferManager":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];
function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Rectangle");var s=e("awayjs-core/lib/events/Event");var n=e("awayjs-core/lib/events/EventDispatcher");var o=e("awayjs-core/lib/utils/ImageUtils");var l=function(e){i(t,e);function t(t){e.call(this);this._viewWidth=-1;this._viewHeight=-1;this._textureWidth=-1;this._textureHeight=-1;this._buffersInvalid=true;this._renderToTextureRect=new a;this._stage=t}t.getInstance=function(e){if(!e)throw new Error("stage key cannot be null!");if(t._instances==null)t._instances=new Array;var r=t.getRTTBufferManagerFromStage(e);if(r==null){r=new t(e);var i=new h;i.stage3d=e;i.rttbfm=r;t._instances.push(i)}return r};t.getRTTBufferManagerFromStage=function(e){var r=t._instances.length;var i;for(var a=0;a<r;a++){i=t._instances[a];if(i.stage3d===e)return i.rttbfm}return null};t.deleteRTTBufferManager=function(e){var r=t._instances.length;var i;for(var a=0;a<r;a++){i=t._instances[a];if(i.stage3d===e){t._instances.splice(a,1);return}}};Object.defineProperty(t.prototype,"textureRatioX",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._textureRatioX},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureRatioY",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._textureRatioY},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"viewWidth",{get:function(){return this._viewWidth},set:function(e){if(e==this._viewWidth)return;this._viewWidth=e;this._buffersInvalid=true;this._textureWidth=o.getBestPowerOf2(this._viewWidth);if(this._textureWidth>this._viewWidth){this._renderToTextureRect.x=Math.floor((this._textureWidth-this._viewWidth)*.5);this._renderToTextureRect.width=this._viewWidth}else{this._renderToTextureRect.x=0;this._renderToTextureRect.width=this._textureWidth}this.dispatchEvent(new s(s.RESIZE))},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"viewHeight",{get:function(){return this._viewHeight},set:function(e){if(e==this._viewHeight)return;this._viewHeight=e;this._buffersInvalid=true;this._textureHeight=o.getBestPowerOf2(this._viewHeight);if(this._textureHeight>this._viewHeight){this._renderToTextureRect.y=Math.floor((this._textureHeight-this._viewHeight)*.5);this._renderToTextureRect.height=this._viewHeight}else{this._renderToTextureRect.y=0;this._renderToTextureRect.height=this._textureHeight}this.dispatchEvent(new s(s.RESIZE))},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderToTextureVertexBuffer",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToTextureVertexBuffer},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderToScreenVertexBuffer",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToScreenVertexBuffer},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderToTextureRect",{get:function(){if(this._buffersInvalid)this.updateRTTBuffers();return this._renderToTextureRect},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureWidth",{get:function(){return this._textureWidth},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"textureHeight",{get:function(){return this._textureHeight},enumerable:true,configurable:true});t.prototype.dispose=function(){t.deleteRTTBufferManager(this._stage);if(this._indexBuffer){this._indexBuffer.dispose();this._renderToScreenVertexBuffer.dispose();this._renderToTextureVertexBuffer.dispose();this._renderToScreenVertexBuffer=null;this._renderToTextureVertexBuffer=null;this._indexBuffer=null}};t.prototype.updateRTTBuffers=function(){var e=this._stage.context;var t;var r;var i;var a;if(this._renderToTextureVertexBuffer==null)this._renderToTextureVertexBuffer=e.createVertexBuffer(4,5);if(this._renderToScreenVertexBuffer==null)this._renderToScreenVertexBuffer=e.createVertexBuffer(4,5);if(!this._indexBuffer){this._indexBuffer=e.createIndexBuffer(6);this._indexBuffer.uploadFromArray([2,1,0,3,2,0],0,6)}this._textureRatioX=i=Math.min(this._viewWidth/this._textureWidth,1);this._textureRatioY=a=Math.min(this._viewHeight/this._textureHeight,1);var s=(1-i)*.5;var n=(i+1)*.5;var o=(a+1)*.5;var l=(1-a)*.5;t=[-i,-a,s,o,0,i,-a,n,o,1,i,a,n,l,2,-i,a,s,l,3];r=[-1,-1,s,o,0,1,-1,n,o,1,1,1,n,l,2,-1,1,s,l,3];this._renderToTextureVertexBuffer.uploadFromArray(t,0,4);this._renderToScreenVertexBuffer.uploadFromArray(r,0,4);this._buffersInvalid=false};return t}(n);var h=function(){function e(){}return e}();t.exports=l},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/ImageUtils":undefined}],"awayjs-renderergl/lib/pick/ShaderPicker":[function(e,t,r){var i=e("awayjs-core/lib/utils/Debug");var a=e("awayjs-core/lib/data/BitmapImage2D");var s=e("awayjs-core/lib/geom/Matrix3DUtils");var n=e("awayjs-core/lib/geom/Point");var o=e("awayjs-core/lib/geom/Rectangle");var l=e("awayjs-core/lib/geom/Vector3D");var h=e("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");var d=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var p=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var u=e("awayjs-stagegl/lib/base/ContextGLClearMask");var c=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var g=e("awayjs-stagegl/lib/base/ContextGLProgramType");var f=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var _=function(){function e(e){if(e===void 0){e=false}this._onlyMouseEnabled=true;this._interactives=new Array;this._localHitPosition=new l;this._hitUV=new n;this._localHitNormal=new l;this._rayPos=new l;this._rayDir=new l;this._shaderPickingDetails=e;this._id=new Float32Array(4);this._viewportData=new Float32Array(4);this._boundOffsetScale=new Float32Array(8);this._boundOffsetScale[3]=0;this._boundOffsetScale[7]=1}Object.defineProperty(e.prototype,"onlyMouseEnabled",{get:function(){return this._onlyMouseEnabled},set:function(e){this._onlyMouseEnabled=e},enumerable:true,configurable:true});e.prototype.getViewCollision=function(e,t,r){var i=r.iEntityCollector;this._stage=r.renderer.stage;if(!this._stage)return null;this._context=this._stage.context;this._viewportData[0]=r.width;this._viewportData[1]=r.height;this._viewportData[2]=-(this._projX=2*e/r.width-1);this._viewportData[3]=this._projY=2*t/r.height-1;this._potentialFound=false;this._blendedRenderableHead=null;this._opaqueRenderableHead=null;this.pDraw(i,null);this._context.setVertexBufferAt(0,null);if(!this._context||!this._potentialFound)return null;if(!this._bitmapImage2D)this._bitmapImage2D=new a(1,1,false,0);this._context.drawToBitmapImage2D(this._bitmapImage2D);this._hitColor=this._bitmapImage2D.getPixel(0,0);if(!this._hitColor){this._context.present();return null}this._hitRenderable=this._interactives[this._hitColor-1];this._hitEntity=this._hitRenderable.sourceEntity;if(this._onlyMouseEnabled&&!this._hitEntity._iIsMouseEnabled())return null;var s=this._hitEntity._iPickingCollisionVO;if(this._shaderPickingDetails){this.getHitDetails(r.camera);s.localPosition=this._localHitPosition;s.localNormal=this._localHitNormal;s.uv=this._hitUV;s.index=this._faceIndex}else{s.localPosition=null;s.localNormal=null;s.uv=null;s.index=0}return s};e.prototype.getSceneCollision=function(e,t,r){return null};e.prototype.pDraw=function(t,r){var i=t.camera;this._context.clear(0,0,0,1);this._stage.scissorRect=e.MOUSE_SCISSOR_RECT;this._interactives.length=this._interactiveId=0;if(!this._objectProgram)this.initObjectProgram();this._context.setBlendFactors(p.ONE,p.ZERO);this._context.setDepthTest(true,c.LESS);this._context.setProgram(this._objectProgram);this._context.setProgramConstantsFromArray(g.VERTEX,4,this._viewportData,1)};e.prototype.drawRenderables=function(e,t){var r=s.CALCULATION_MATRIX;var i=t.viewProjection;while(e){if(!e.sourceEntity.scene||!e.sourceEntity._iIsMouseEnabled()){e=e.next;continue}this._potentialFound=true;this._context.setCulling(e.renderOwner.bothSides?f.NONE:f.BACK,t.projection.coordinateSystem);this._interactives[this._interactiveId++]=e;this._id[1]=(this._interactiveId>>8)/255;this._id[2]=(this._interactiveId&255)/255;r.copyFrom(e.sourceEntity.getRenderSceneTransform(t));r.append(i);this._context.setProgramConstantsFromMatrix(g.VERTEX,0,r,true);this._context.setProgramConstantsFromArray(g.FRAGMENT,0,this._id,1);var a=this._hitRenderable.subGeometryVO;a.activateVertexBufferVO(0,a.subGeometry.positions,this._stage);a.getIndexBufferVO(this._stage).draw(d.TRIANGLES,0,a.numIndices);e=e.next}};e.prototype.updateRay=function(e){this._rayPos=e.scenePosition;this._rayDir=e.getRay(this._projX,this._projY,1);this._rayDir.normalize()};e.prototype.initObjectProgram=function(){var e;var t;this._objectProgram=this._context.createProgram();e="m44 vt0, va0, vc0			\n"+"mul vt1.xy, vt0.w, vc4.zw	\n"+"add vt0.xy, vt0.xy, vt1.xy	\n"+"mul vt0.xy, vt0.xy, vc4.xy	\n"+"mov op, vt0	\n";t="mov oc, fc0";i.throwPIR("ShaderPicker","initTriangleProgram","Dependency: initObjectProgram")};e.prototype.initTriangleProgram=function(){var e;var t;this._triangleProgram=this._context.createProgram();e="add vt0, va0, vc5 			\n"+"mul vt0, vt0, vc6 			\n"+"mov v0, vt0				\n"+"m44 vt0, va0, vc0			\n"+"mul vt1.xy, vt0.w, vc4.zw	\n"+"add vt0.xy, vt0.xy, vt1.xy	\n"+"mul vt0.xy, vt0.xy, vc4.xy	\n"+"mov op, vt0	\n";t="mov oc, v0";var r=(new h).assemble("part vertex 1\n"+e+"endpart")["vertex"].data;var i=(new h).assemble("part fragment 1\n"+t+"endpart")["fragment"].data;this._triangleProgram.upload(r,i)};e.prototype.getHitDetails=function(e){this.getApproximatePosition(e);this.getPreciseDetails(e)};e.prototype.getApproximatePosition=function(t){var r=this._hitRenderable.sourceEntity.getBox();var i;var a,n,o;var l,h,p;var c=s.CALCULATION_MATRIX;c.copyFrom(this._hitRenderable.sourceEntity.getRenderSceneTransform(t));c.append(t.viewProjection);if(!this._triangleProgram){this.initTriangleProgram()}this._boundOffsetScale[4]=1/(a=r.width);this._boundOffsetScale[5]=1/(n=r.height);this._boundOffsetScale[6]=1/(o=r.depth);this._boundOffsetScale[0]=l=-r.x;this._boundOffsetScale[1]=h=-r.y;this._boundOffsetScale[2]=p=-r.z;this._context.setProgram(this._triangleProgram);this._context.clear(0,0,0,0,1,0,u.DEPTH);this._context.setScissorRectangle(e.MOUSE_SCISSOR_RECT);this._context.setProgramConstantsFromMatrix(g.VERTEX,0,c,true);this._context.setProgramConstantsFromArray(g.VERTEX,5,this._boundOffsetScale,2);var f=this._hitRenderable.subGeometryVO;f.activateVertexBufferVO(0,f.subGeometry.positions,this._stage);f.getIndexBufferVO(this._stage).draw(d.TRIANGLES,0,f.numIndices);this._context.drawToBitmapImage2D(this._bitmapImage2D);i=this._bitmapImage2D.getPixel(0,0);this._localHitPosition.x=(i>>16&255)*a/255-l;this._localHitPosition.y=(i>>8&255)*n/255-h;this._localHitPosition.z=(i&255)*o/255-p};e.prototype.getPreciseDetails=function(e){var t=it.length;var r,i,a;var s,n,o;var l,h,d;var p=0,u=1,c=2;var g,f,_;var m,y,v;var b,x,w;var C,P,S;var D,j,R;var T,O,A,V;var I,F,M,N,L;var E,B,z;var G=this._localHitPosition.x,U=this._localHitPosition.y,k=this._localHitPosition.z;var X,W;var H,q,Z;var Y,J,Q;var K,$,et;var tt;var rt=this._hitRenderable._pGetSubGeometry();var it=rt.indices.get(rt.numElements);var at=rt.positions.get(rt.numVertices);var st=rt.positions.dimensions;var nt=rt.uvs.get(rt.numVertices);var ot=rt.uvs.dimensions;var lt=rt.normals.get(rt.numVertices);var ht=rt.normals.dimensions;this.updateRay(e);while(p<t){g=it[p]*st;f=it[u]*st;_=it[c]*st;r=at[g];i=at[g+1];a=at[g+2];s=at[f];n=at[f+1];o=at[f+2];l=at[_];h=at[_+1];d=at[_+2];if(!(G<r&&G<s&&G<l||U<i&&U<n&&U<h||k<a&&k<o&&k<d||G>r&&G>s&&G>l||U>i&&U>n&&U>h||k>a&&k>o&&k>d)){m=l-r;y=h-i;v=d-a;b=s-r;x=n-i;w=o-a;C=G-r;P=U-i;S=k-a;I=m*m+y*y+v*v;F=m*b+y*x+v*w;M=m*C+y*P+v*S;N=b*b+x*x+w*w;L=b*C+x*P+w*S;z=1/(I*N-F*F);E=(N*M-F*L)*z;B=(I*L-F*M)*z;if(E>=0&&B>=0&&E+B<=1){D=it[p]*ht;j=it[u]*ht;R=it[c]*ht;T=it[D]+it[j]+it[R];O=it[D+1]+it[j+1]+it[R+1];A=it[D+2]+it[j+2]+it[R+2];V=Math.sqrt(T*T+O*O+A*A);T/=V;O/=V;A/=V;this.getPrecisePosition(this._hitRenderable.sourceEntity.inverseSceneTransform,T,O,A,r,i,a);C=this._localHitPosition.x-r;P=this._localHitPosition.y-i;S=this._localHitPosition.z-a;Y=s-r;J=n-i;Q=o-a;K=l-r;$=h-i;et=d-a;this._localHitNormal.x=J*et-Q*$;this._localHitNormal.y=Q*K-Y*et;this._localHitNormal.z=Y*$-J*K;tt=1/Math.sqrt(this._localHitNormal.x*this._localHitNormal.x+this._localHitNormal.y*this._localHitNormal.y+this._localHitNormal.z*this._localHitNormal.z);this._localHitNormal.x*=tt;this._localHitNormal.y*=tt;this._localHitNormal.z*=tt;M=m*C+y*P+v*S;L=b*C+x*P+w*S;E=(N*M-F*L)*z;B=(I*L-F*M)*z;H=it[p]*ot;q=it[u]*ot;Z=it[c]*ot;X=nt[H];W=nt[H+1];this._hitUV.x=X+B*(nt[q]-X)+E*(nt[Z]-X);this._hitUV.y=W+B*(nt[q+1]-W)+E*(nt[Z+1]-W);this._faceIndex=p;return}}p+=3;u+=3;c+=3}};e.prototype.getPrecisePosition=function(e,t,r,i,a,n,o){var l,h,d;var p,u,c;var g;var f=s.RAW_DATA_CONTAINER;var _=this._rayPos.x,m=this._rayPos.y,y=this._rayPos.z;p=this._rayDir.x;u=this._rayDir.y;c=this._rayDir.z;e.copyRawDataTo(f);l=f[0]*p+f[4]*u+f[8]*c;h=f[1]*p+f[5]*u+f[9]*c;d=f[2]*p+f[6]*u+f[10]*c;p=f[0]*_+f[4]*m+f[8]*y+f[12];u=f[1]*_+f[5]*m+f[9]*y+f[13];c=f[2]*_+f[6]*m+f[10]*y+f[14];g=((a-p)*t+(n-u)*r+(o-c)*i)/(l*t+h*r+d*i);this._localHitPosition.x=p+l*g;this._localHitPosition.y=u+h*g;this._localHitPosition.z=c+d*g};e.prototype.dispose=function(){this._bitmapImage2D.dispose();if(this._triangleProgram)this._triangleProgram.dispose();if(this._objectProgram)this._objectProgram.dispose();this._triangleProgram=null;this._objectProgram=null;this._bitmapImage2D=null;this._hitRenderable=null;this._hitEntity=null};e.MOUSE_SCISSOR_RECT=new o(0,0,1,1);return e}();t.exports=_},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/utils/Debug":undefined,"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/base/ContextGLDrawMode":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined,"awayjs-stagegl/lib/base/ContextGLTriangleFace":undefined}],"awayjs-renderergl/lib/render/BasicMaterialRender":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/data/BlendMode");var s=e("awayjs-renderergl/lib/render/passes/BasicMaterialPass");var n=e("awayjs-renderergl/lib/render/RenderBase");var o=function(e){i(t,e);function t(t,r,i,a){e.call(this,t,r,i,a);this._material=r;this._pAddPass(this._pass=new s(this,r,i,this._stage))}t.prototype._pUpdateRender=function(){e.prototype._pUpdateRender.call(this);this._pRequiresBlending=this._material.blendMode!=a.NORMAL||this._material.alphaBlending||this._material.colorTransform&&this._material.colorTransform.alphaMultiplier<1;this._pass.preserveAlpha=this._material.preserveAlpha;this._pass.shader.setBlendMode(this._renderOwner.blendMode==a.NORMAL&&this._pRequiresBlending?a.LAYER:this._material.blendMode)};return t}(n);t.exports=o},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-renderergl/lib/render/RenderBase":"awayjs-renderergl/lib/render/RenderBase","awayjs-renderergl/lib/render/passes/BasicMaterialPass":"awayjs-renderergl/lib/render/passes/BasicMaterialPass"}],"awayjs-renderergl/lib/render/DepthRender":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/render/RenderPassBase");var s=e("awayjs-renderergl/lib/shaders/ShaderBase");var n=function(e){i(t,e);function t(t,r,i,a){e.call(this,t,r,i,a);this._shader=new s(i,this,this._stage);this._pAddPass(this)}t.prototype._iIncludeDependencies=function(t){e.prototype._iIncludeDependencies.call(this,t);t.projectionDependencies++;if(t.alphaThreshold>0)t.uvDependencies++};t.prototype._iInitConstantData=function(t){e.prototype._iInitConstantData.call(this,t);var r=this._fragmentConstantsIndex;var i=t.fragmentConstantData;i[r]=1;i[r+1]=255;i[r+2]=65025;i[r+3]=16581375;i[r+4]=1/255;i[r+5]=1/255;i[r+6]=1/255;i[r+7]=0};t.prototype._iGetFragmentCode=function(e,t,r){var i="";var a=r.shadedTarget;var s=t.getFreeFragmentConstant();var n=t.getFreeFragmentConstant();this._fragmentConstantsIndex=s.index*4;var o=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(o,1);var l=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(l,1);i+="div "+o+", "+r.projectionFragment+", "+r.projectionFragment+".w\n"+"mul "+o+", "+s+", "+o+".z\n"+"frc "+o+", "+o+"\n"+"mul "+l+", "+o+".yzww, "+n+"\n";if(e.texture&&e.alphaThreshold>0){e.texture._iInitRegisters(e,t);var h=t.getFreeFragmentVectorTemp();i+=e.texture._iGetFragmentCode(e,h,t,r.uvVarying);var d=t.getFreeFragmentConstant();i+="sub "+h+".w, "+h+".w, "+d+".x\n"+"kil "+h+".w\n"}i+="sub "+a+", "+o+", "+l+"\n";t.removeFragmentTempUsage(o);t.removeFragmentTempUsage(l);return i};t.prototype._iActivate=function(t){e.prototype._iActivate.call(this,t);if(this._shader.texture&&this._shader.alphaThreshold>0){this._shader.texture.activate(this._shader);this._shader.fragmentConstantData[this._fragmentConstantsIndex+8]=this._shader.alphaThreshold}};return t}(a);t.exports=n},{"awayjs-renderergl/lib/render/RenderPassBase":"awayjs-renderergl/lib/render/RenderPassBase","awayjs-renderergl/lib/shaders/ShaderBase":"awayjs-renderergl/lib/shaders/ShaderBase"}],"awayjs-renderergl/lib/render/DistanceRender":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/render/RenderPassBase");var s=e("awayjs-renderergl/lib/shaders/ShaderBase");var n=function(e){i(t,e);function t(t,r,i,a){e.call(this,t,r,i,a);this._shader=new s(i,this,this._stage);this._pAddPass(this)}t.prototype._iInitConstantData=function(t){e.prototype._iInitConstantData.call(this,t);var r=this._fragmentConstantsIndex;var i=t.fragmentConstantData;i[r+4]=1/255;i[r+5]=1/255;i[r+6]=1/255;i[r+7]=0};t.prototype._iIncludeDependencies=function(t){e.prototype._iIncludeDependencies.call(this,t);t.projectionDependencies++;t.viewDirDependencies++;if(t.alphaThreshold>0)t.uvDependencies++;if(t.viewDirDependencies>0)t.globalPosDependencies++};t.prototype._iGetFragmentCode=function(e,t,r){var i;var a=r.shadedTarget;var s=t.getFreeFragmentConstant();var n=t.getFreeFragmentConstant();this._fragmentConstantsIndex=s.index*4;var o=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(o,1);var l=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(l,1);i="dp3 "+o+".z, "+r.viewDirVarying+".xyz, "+r.viewDirVarying+".xyz\n"+"mul "+o+", "+s+", "+o+".z\n"+"frc "+o+", "+o+"\n"+"mul "+l+", "+o+".yzww, "+n+"\n";if(e.alphaThreshold>0){e.texture._iInitRegisters(e,t);var h=t.getFreeFragmentVectorTemp();i+=e.texture._iGetFragmentCode(e,h,t,r.uvVarying);var d=t.getFreeFragmentConstant();i+="sub "+h+".w, "+h+".w, "+d+".x\n"+"kil "+h+".w\n"}i+="sub "+a+", "+o+", "+l+"\n";return i};t.prototype._iActivate=function(t){e.prototype._iActivate.call(this,t);var r=t.projection.far;r=1/(2*r*r);var i=this._fragmentConstantsIndex;var a=this._shader.fragmentConstantData;a[i]=1*r;a[i+1]=255*r;a[i+2]=65025*r;a[i+3]=16581375*r;if(this._shader.alphaThreshold>0){this._shader.texture.activate(this._shader);a[i+8]=this._shader.alphaThreshold}};return t}(a);t.exports=n},{"awayjs-renderergl/lib/render/RenderPassBase":"awayjs-renderergl/lib/render/RenderPassBase","awayjs-renderergl/lib/shaders/ShaderBase":"awayjs-renderergl/lib/shaders/ShaderBase"}],"awayjs-renderergl/lib/render/IRenderClass":[function(e,t,r){},{}],"awayjs-renderergl/lib/render/RenderBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=e("awayjs-core/lib/events/EventDispatcher");var n=e("awayjs-display/lib/materials/MaterialBase");var o=function(e){i(t,e);function t(t,r,i,a){var s=this;e.call(this);this._forceSeparateMVP=false;this._invalidAnimation=true;this._invalidRender=true;this._passes=new Array;this._pRequiresBlending=false;this._pool=t;this.renderId=r.id;this._renderOwner=r;this._renderableClass=i;this._stage=a;this._onPassChangeDelegate=function(e){return s.onPassChange(e)}}Object.defineProperty(t.prototype,"requiresBlending",{get:function(){return this._pRequiresBlending},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderOrderId",{get:function(){if(this._invalidAnimation)this._updateAnimation();return this._renderOrderId},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"passes",{get:function(){if(this._invalidAnimation)this._updateAnimation();return this._passes},enumerable:true,configurable:true});t.prototype._iIncludeDependencies=function(e){this._renderableClass._iIncludeDependencies(e);e.alphaThreshold=this._renderOwner.alphaThreshold;e.useMipmapping=this._renderOwner.mipmap;e.useSmoothTextures=this._renderOwner.smooth;if(this._renderOwner instanceof n){var t=this._renderOwner;e.useAlphaPremultiplied=t.alphaPremultiplied;e.useBothSides=t.bothSides;e.repeatTextures=t.repeat;e.usesUVTransform=t.animateUVs;e.usesColorTransform=t.useColorTransform;if(t.texture)e.texture=e.getTextureVO(t.texture);e.color=t.color}};t.prototype.dispose=function(){this._pClearPasses();var e=this._passes.length;for(var t=0;t<e;t++)this._passes[t].dispose();this._passes=null;this._pool.disposeItem(this._renderOwner)};t.prototype.invalidateRender=function(){this._invalidRender=true;this._invalidAnimation=true};t.prototype.invalidatePasses=function(){var e=this._passes.length;for(var t=0;t<e;t++)this._passes[t].invalidatePass();this._invalidAnimation=true};t.prototype.invalidateAnimation=function(){this._invalidAnimation=true};t.prototype._updateAnimation=function(){if(this._invalidRender)this._pUpdateRender();this._invalidAnimation=false;var e=this._getEnabledGPUAnimation();var t=0;var r=1;var i;var a=this._passes.length;for(var s=0;s<a;s++){i=this._passes[s].shader;if(i.usesAnimation!=e){i.usesAnimation=e;i.invalidateProgram()}t+=i.programData.id*r;r*=1e3}this._renderOrderId=t};t.prototype._pUpdateRender=function(){this._invalidRender=false};t.prototype._pRemovePass=function(e){e.removeEventListener(a.CHANGE,this._onPassChangeDelegate);this._passes.splice(this._passes.indexOf(e),1)};t.prototype._pClearPasses=function(){var e=this._passes.length;for(var t=0;t<e;++t)this._passes[t].removeEventListener(a.CHANGE,this._onPassChangeDelegate);this._passes.length=0};t.prototype._pAddPass=function(e){this._passes.push(e);e.addEventListener(a.CHANGE,this._onPassChangeDelegate)};t.prototype.onPassChange=function(e){this.invalidateAnimation()};t.prototype._getEnabledGPUAnimation=function(){if(this._renderOwner.animationSet){this._renderOwner.animationSet.resetGPUCompatibility();var e=this._renderOwner.iOwners;var t=e.length;var r=this._passes.length;for(var i=0;i<r;i++)for(var a=0;a<t;a++)if(e[a].animator)e[a].animator.testGPUCompatibility(this._passes[i].shader);return!this._renderOwner.animationSet.usesCPU}return false};return t}(s);t.exports=o},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-display/lib/materials/MaterialBase":undefined}],"awayjs-renderergl/lib/render/RenderPassBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=e("awayjs-renderergl/lib/render/RenderBase");var n=function(e){i(t,e);function t(){e.apply(this,arguments)}Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationSet",{get:function(){return this._renderOwner.animationSet},enumerable:true,configurable:true});t.prototype.dispose=function(){e.prototype.dispose.call(this);this._shader.dispose();this._shader=null};t.prototype._iRender=function(e,t,r){this._shader._iRender(e,t,r)};t.prototype._iActivate=function(e){this._shader._iActivate(e)};t.prototype._iDeactivate=function(){this._shader._iDeactivate()};t.prototype.invalidatePass=function(){this._shader.invalidateShader();this.dispatchEvent(new a(a.CHANGE))};t.prototype._iInitConstantData=function(e){};t.prototype._iGetPreLightingVertexCode=function(e,t,r){return""};t.prototype._iGetPreLightingFragmentCode=function(e,t,r){return""};t.prototype._iGetVertexCode=function(e,t,r){return""};t.prototype._iGetFragmentCode=function(e,t,r){return""};t.prototype._iGetNormalVertexCode=function(e,t,r){return""};t.prototype._iGetNormalFragmentCode=function(e,t,r){return""};return t}(s);t.exports=n},{"awayjs-core/lib/events/Event":undefined,"awayjs-renderergl/lib/render/RenderBase":"awayjs-renderergl/lib/render/RenderBase"}],"awayjs-renderergl/lib/render/RenderPool":[function(e,t,r){var i=e("awayjs-display/lib/materials/BasicMaterial");var a=e("awayjs-display/lib/entities/Skybox");var s=e("awayjs-renderergl/lib/render/BasicMaterialRender");var n=e("awayjs-renderergl/lib/render/SkyboxRender");var o=function(){function e(e,t,r){if(r===void 0){r=null}this._pool=new Object;this._renderableClass=e;this._stage=t;this._renderClass=r}e.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddRender(new(this._renderClass||e.getClass(t))(this,t,this._renderableClass,this._stage)))};e.prototype.disposeItem=function(e){e._iRemoveRender(this._pool[e.id]);this._pool[e.id]=null};e.registerClass=function(t,r){e._classPool[r.assetType]=t};e.getClass=function(t){return e._classPool[t.assetType]};e.addDefaults=function(){e.registerClass(s,i);e.registerClass(n,a)};e._classPool=new Object;e.main=e.addDefaults();return e}();t.exports=o},{"awayjs-display/lib/entities/Skybox":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-renderergl/lib/render/BasicMaterialRender":"awayjs-renderergl/lib/render/BasicMaterialRender","awayjs-renderergl/lib/render/SkyboxRender":"awayjs-renderergl/lib/render/SkyboxRender"}],"awayjs-renderergl/lib/render/SkyboxRender":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/data/BlendMode");var s=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var n=e("awayjs-renderergl/lib/render/RenderPassBase");var o=e("awayjs-renderergl/lib/shaders/ShaderBase");var l=function(e){i(t,e);function t(t,r,i,a){e.call(this,t,r,i,a);this._skybox=r;this._shader=new o(i,this,this._stage);this._cubeTexture=this._shader.getTextureVO(this._skybox.cubeMap);this._pAddPass(this)}t.prototype._pUpdateRender=function(){e.prototype._pUpdateRender.call(this);this._pRequiresBlending=this._renderOwner.blendMode!=a.NORMAL;this.shader.setBlendMode(this._renderOwner.blendMode==a.NORMAL&&this._pRequiresBlending?a.LAYER:this._renderOwner.blendMode)};t.prototype._iIncludeDependencies=function(t){e.prototype._iIncludeDependencies.call(this,t);t.usesLocalPosFragment=true};t.prototype._iGetFragmentCode=function(e,t,r){this._cubeTexture._iInitRegisters(e,t);return this._cubeTexture._iGetFragmentCode(e,r.shadedTarget,t,r.localPositionVarying)};t.prototype._iActivate=function(t){e.prototype._iActivate.call(this,t);var r=this._stage.context;r.setDepthTest(false,s.LESS);this._cubeTexture.activate(this._shader)};return t}(n);t.exports=l},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-renderergl/lib/render/RenderPassBase":"awayjs-renderergl/lib/render/RenderPassBase","awayjs-renderergl/lib/shaders/ShaderBase":"awayjs-renderergl/lib/shaders/ShaderBase","awayjs-stagegl/lib/base/ContextGLCompareMode":undefined}],"awayjs-renderergl/lib/render/passes/BasicMaterialPass":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/ShaderBase");var s=e("awayjs-renderergl/lib/render/passes/PassBase");var n=function(e){i(t,e);function t(t,r,i,s){e.call(this,t,r,i,s);this._diffuseR=1;this._diffuseG=1;this._diffuseB=1;this._diffuseA=1;this._shader=new a(i,this,this._stage)}t.prototype._iIncludeDependencies=function(t){e.prototype._iIncludeDependencies.call(this,t);if(t.texture!=null)t.uvDependencies++};t.prototype._iGetFragmentCode=function(e,t,r){var i="";var a;if(this.preserveAlpha){a=t.getFreeFragmentSingleTemp();t.addFragmentTempUsages(a,1);i+="mov "+a+", "+r.shadedTarget+".w\n"}var s=r.shadedTarget;if(e.texture!=null){e.texture._iInitRegisters(e,t);i+=e.texture._iGetFragmentCode(e,s,t,r.uvVarying);if(e.alphaThreshold>0){var n=t.getFreeFragmentConstant();this._fragmentConstantsIndex=n.index*4;i+="sub "+s+".w, "+s+".w, "+n+".x\n"+"kil "+s+".w\n"+"add "+s+".w, "+s+".w, "+n+".x\n"}}else if(e.colorBufferIndex!=-1){i+="mov "+s+", "+r.colorVarying+"\n"}else{var o=t.getFreeFragmentConstant();this._fragmentConstantsIndex=o.index*4;i+="mov "+s+", "+o+"\n"}if(this.preserveAlpha){i+="mul "+r.shadedTarget+".w, "+r.shadedTarget+".w, "+a+"\n";t.removeFragmentTempUsage(a)}return i};t.prototype._iActivate=function(t){e.prototype._iActivate.call(this,t);if(this._shader.texture!=null){this._shader.texture.activate(this._shader);if(this._shader.alphaThreshold>0)this._shader.fragmentConstantData[this._fragmentConstantsIndex]=this._shader.alphaThreshold}else if(this._shader.colorBufferIndex==-1){var r=this._fragmentConstantsIndex;var i=this._shader.fragmentConstantData;i[r]=this._diffuseR;i[r+1]=this._diffuseG;i[r+2]=this._diffuseB;i[r+3]=this._diffuseA}};return t}(s);t.exports=n},{"awayjs-renderergl/lib/render/passes/PassBase":"awayjs-renderergl/lib/render/passes/PassBase","awayjs-renderergl/lib/shaders/ShaderBase":"awayjs-renderergl/lib/shaders/ShaderBase"}],"awayjs-renderergl/lib/render/passes/ILightingPass":[function(e,t,r){},{}],"awayjs-renderergl/lib/render/passes/IPass":[function(e,t,r){},{}],"awayjs-renderergl/lib/render/passes/PassBase":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/events/Event");var s=e("awayjs-core/lib/events/EventDispatcher");var n=function(e){i(t,e);function t(t,r,i,a){e.call(this);this._preserveAlpha=true;this._forceSeparateMVP=false;this._render=t;this._renderOwner=r;this._renderableClass=i;this._stage=a}Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationSet",{get:function(){return this._renderOwner.animationSet},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"preserveAlpha",{get:function(){return this._preserveAlpha},set:function(e){if(this._preserveAlpha==e)return;this._preserveAlpha=e;this.invalidatePass()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"forceSeparateMVP",{get:function(){return this._forceSeparateMVP},set:function(e){if(this._forceSeparateMVP==e)return;this._forceSeparateMVP=e;this.invalidatePass()},enumerable:true,configurable:true});t.prototype.dispose=function(){this._shader.dispose();this._shader=null};t.prototype._iRender=function(e,t,r){this._shader._iRender(e,t,r)};t.prototype._iActivate=function(e){this._shader._iActivate(e)};t.prototype._iDeactivate=function(){this._shader._iDeactivate()
};t.prototype.invalidatePass=function(){this._shader.invalidateShader();this.dispatchEvent(new a(a.CHANGE))};t.prototype._iIncludeDependencies=function(e){this._render._iIncludeDependencies(e);if(this._forceSeparateMVP)e.globalPosDependencies++};t.prototype._iInitConstantData=function(e){};t.prototype._iGetPreLightingVertexCode=function(e,t,r){return""};t.prototype._iGetPreLightingFragmentCode=function(e,t,r){return""};t.prototype._iGetVertexCode=function(e,t,r){return""};t.prototype._iGetFragmentCode=function(e,t,r){return""};t.prototype._iGetNormalVertexCode=function(e,t,r){return""};t.prototype._iGetNormalFragmentCode=function(e,t,r){return""};return t}(s);t.exports=n},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-renderergl/lib/renderables/BillboardRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/attributes/AttributesBuffer");var s=e("awayjs-core/lib/geom/Matrix3DUtils");var n=e("awayjs-display/lib/base/TriangleSubGeometry");var o=e("awayjs-display/lib/entities/Billboard");var l=e("awayjs-stagegl/lib/base/ContextGLProgramType");var h=e("awayjs-renderergl/lib/renderables/RenderableBase");var d=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,r,r.material,i);this._billboard=r}t.prototype._pGetSubGeometry=function(){var e=this._billboard.material;var r=this._billboard.billboardRect;var i=t._materialGeometry[e.id];if(!i){i=t._materialGeometry[e.id]=new n(new a(11,4));i.autoDeriveNormals=false;i.autoDeriveTangents=false;i.setIndices(Array(0,1,2,0,2,3));i.setPositions(Array(-r.x,e.height-r.y,0,e.width-r.x,e.height-r.y,0,e.width-r.x,-r.y,0,-r.x,-r.y,0));i.setNormals(Array(1,0,0,1,0,0,1,0,0,1,0,0));i.setTangents(Array(0,0,-1,0,0,-1,0,0,-1,0,0,-1));i.setUVs(Array(0,0,1,0,1,1,0,1))}else{i.setPositions(Array(-r.x,e.height-r.y,0,e.width-r.x,e.height-r.y,0,e.width-r.x,-r.y,0,-r.x,-r.y,0))}return i};t._iIncludeDependencies=function(e){};t._iGetVertexCode=function(e,t,r){var i="";var a=e.globalPosDependencies>0?r.globalPositionVertex:r.localPosition;var s=t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();e.viewMatrixIndex=s.index*4;if(e.projectionDependencies>0){r.projectionFragment=t.getFreeVarying();var n=t.getFreeVertexVectorTemp();i+="m44 "+n+", "+a+", "+s+"\n"+"mov "+r.projectionFragment+", "+n+"\n"+"mov op, "+n+"\n"}else{i+="m44 op, "+a+", "+s+"\n"}return i};t._iGetFragmentCode=function(e,t,r){return""};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var a=t.shader;if(a.sceneMatrixIndex>=0){this.sourceEntity.getRenderSceneTransform(r).copyRawDataTo(a.vertexConstantData,a.sceneMatrixIndex,true);i.copyRawDataTo(a.vertexConstantData,a.viewMatrixIndex,true)}else{var n=s.CALCULATION_MATRIX;n.copyFrom(this.sourceEntity.getRenderSceneTransform(r));n.append(i);n.copyRawDataTo(a.vertexConstantData,a.viewMatrixIndex,true)}var o=this._stage.context;o.setProgramConstantsFromArray(l.VERTEX,0,a.vertexConstantData,a.numUsedVertexConstants);o.setProgramConstantsFromArray(l.FRAGMENT,0,a.fragmentConstantData,a.numUsedFragmentConstants)};t.assetClass=o;t._materialGeometry=new Object;t.vertexAttributesOffset=1;return t}(h);t.exports=d},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/entities/Billboard":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/renderables/CurveSubMeshRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3DUtils");var s=e("awayjs-display/lib/base/CurveSubMesh");var n=e("awayjs-stagegl/lib/base/ContextGLProgramType");var o=e("awayjs-renderergl/lib/renderables/RenderableBase");var l=function(e){i(t,e);function t(t,r,i){e.call(this,t,r.parentMesh,r,r.material,i);this._constants=new Float32Array([0,1,1,.5]);this.subMesh=r}t.prototype._pGetSubGeometry=function(){return this.subMesh.animator?this.subMesh.animator.getRenderableSubGeometry(this,this.subMesh.subGeometry):this.subMesh.subGeometry};t._iIncludeDependencies=function(e){e.usesLocalPosFragment=true};t._iGetVertexCode=function(e,t,r){var i="";var a=e.globalPosDependencies>0?r.globalPositionVertex:r.localPosition;var s=t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();e.viewMatrixIndex=s.index*4;if(e.projectionDependencies>0){r.projectionFragment=t.getFreeVarying();var n=t.getFreeVertexVectorTemp();i+="m44 "+n+", "+a+".xyw, "+s+"\n"+"mov "+r.projectionFragment+", "+n+"\n"+"mov v2 va1 \n"+"mov op, "+n+"\n"}else{i+="mov v2 va1 \n";i+="m44 op, "+a+".xyw, "+s+"\n"}return i};t._iGetFragmentCode=function(e,t,r){var i=e._stage.context.standardDerivatives;var a=r.localPositionVarying;var s=r.shadedTarget;var n="v2";var o="v2.x";var l="v2.y";var h=a+".z";var d=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(d,1);var p=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(p,1);var u=t.getFreeFragmentVectorTemp();t.addFragmentTempUsages(u,1);var c=d+".x";var g=d+".y";var f=d+".z";var _=d+".w";var m=p+".x";var y=p+".y";var v=p+".z";var b="fc2.z";var x="fc2.x";var w="fc2.y";var C="\n";var P=new Array;P.push("mul",c,o,o,C);P.push("sub",c,c,l,C);P.push("mul",c,c,h,C);P.push("kil",c,C);var S=false;if(S&&i){P.push("ddx",g,c,C);P.push("ddy",f,c,C);P.push("mul",g,g,g,C);P.push("mul",f,f,f,C);P.push("add",_,g,f,C);P.push("sqt",_,_,C);P.push("mul",_,_,b,C);P.push("div",c,c,_,C);P.push("max",c,c,x,C);P.push("min",c,c,w,C);P.push("mov",s+".w",c,C)}P.push("mov",s+".w",w,C);return P.join(" ")};t.prototype._iActivate=function(t,r){e.prototype._iActivate.call(this,t,r);var i=this._stage.context;i.setProgramConstantsFromArray(n.FRAGMENT,2,this._constants,1)};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var s=t.shader;if(s.sceneMatrixIndex>=0){this.sourceEntity.getRenderSceneTransform(r).copyRawDataTo(s.vertexConstantData,s.sceneMatrixIndex,true);i.copyRawDataTo(s.vertexConstantData,s.viewMatrixIndex,true)}else{var o=a.CALCULATION_MATRIX;o.copyFrom(this.sourceEntity.getRenderSceneTransform(r));o.append(i);o.copyRawDataTo(s.vertexConstantData,s.viewMatrixIndex,true)}var l=this._stage.context;l.setProgramConstantsFromArray(n.VERTEX,0,s.vertexConstantData,s.numUsedVertexConstants);l.setProgramConstantsFromArray(n.FRAGMENT,0,s.fragmentConstantData,s.numUsedFragmentConstants)};t.assetClass=s;t.vertexAttributesOffset=2;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/CurveSubMesh":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/renderables/IRenderableClass":[function(e,t,r){},{}],"awayjs-renderergl/lib/renderables/LineSegmentRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-display/lib/base/LineSubGeometry");var n=e("awayjs-display/lib/entities/LineSegment");var o=e("awayjs-stagegl/lib/base/ContextGLProgramType");var l=e("awayjs-renderergl/lib/renderables/RenderableBase");var h=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,r,r.material,i);this._constants=new Float32Array([0,0,0,0]);this._thickness=1.25;this._lineSegment=r;this._calcMatrix=new a;this._constants[1]=1/255}t.prototype._pGetSubGeometry=function(){var e=t._lineGeometry[this._lineSegment.id]||(t._lineGeometry[this._lineSegment.id]=new s);var r=this._lineSegment.startPostion;var i=this._lineSegment.endPosition;var a;var n;a=new Float32Array(6);n=new Float32Array(1);a[0]=r.x;a[1]=r.y;a[2]=r.z;a[3]=i.x;a[4]=i.y;a[5]=i.z;n[0]=this._lineSegment.thickness;e.setPositions(a);e.setThickness(n);return e};t._iIncludeDependencies=function(e){e.colorDependencies++};t._iGetVertexCode=function(e,t,r){return"m44 vt0, va0, vc8			\n"+"m44 vt1, va1, vc8			\n"+"sub vt2, vt1, vt0 			\n"+"slt vt5.x, vt0.z, vc7.z			\n"+"sub vt5.y, vc5.x, vt5.x			\n"+"add vt4.x, vt0.z, vc7.z			\n"+"sub vt4.y, vt0.z, vt1.z			\n"+"seq vt4.z, vt4.y vc6.x			\n"+"add vt4.y, vt4.y, vt4.z			\n"+"div vt4.z, vt4.x, vt4.y			\n"+"mul vt4.xyz, vt4.zzz, vt2.xyz	\n"+"add vt3.xyz, vt0.xyz, vt4.xyz	\n"+"mov vt3.w, vc5.x			\n"+"mul vt0, vt0, vt5.yyyy			\n"+"mul vt3, vt3, vt5.xxxx			\n"+"add vt0, vt0, vt3				\n"+"sub vt2, vt1, vt0 			\n"+"nrm vt2.xyz, vt2.xyz			\n"+"nrm vt5.xyz, vt0.xyz			\n"+"mov vt5.w, vc5.x				\n"+"crs vt3.xyz, vt2, vt5			\n"+"nrm vt3.xyz, vt3.xyz			\n"+"mul vt3.xyz, vt3.xyz, va2.xxx	\n"+"mov vt3.w, vc5.x			\n"+"dp3 vt4.x, vt0, vc6			\n"+"mul vt4.x, vt4.x, vc7.x			\n"+"mul vt3.xyz, vt3.xyz, vt4.xxx	\n"+"add vt0.xyz, vt0.xyz, vt3.xyz	\n"+"m44 op, vt0, vc0			\n"};t._iGetFragmentCode=function(e,t,r){return""};t.prototype._iActivate=function(r,i){e.prototype._iActivate.call(this,r,i);this._constants[0]=this._thickness/(this._stage.scissorRect?Math.min(this._stage.scissorRect.width,this._stage.scissorRect.height):Math.min(this._stage.width,this._stage.height));this._constants[2]=i.projection.near;var a=this._stage.context;a.setProgramConstantsFromArray(o.VERTEX,5,t.pONE_VECTOR,1);a.setProgramConstantsFromArray(o.VERTEX,6,t.pFRONT_VECTOR,1);a.setProgramConstantsFromArray(o.VERTEX,7,this._constants,1);a.setProgramConstantsFromMatrix(o.VERTEX,0,i.projection.matrix,true)};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var a=this._stage.context;this._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);this._calcMatrix.append(r.inverseSceneTransform);a.setProgramConstantsFromMatrix(o.VERTEX,8,this._calcMatrix,true)};t.prototype._pGetOverflowRenderable=function(e){return new t(this._pool,this.renderableOwner,this._stage)};t.assetClass=n;t._lineGeometry=new Object;t.pONE_VECTOR=new Float32Array([1,1,1,1]);t.pFRONT_VECTOR=new Float32Array([0,0,-1,0]);t.vertexAttributesOffset=3;return t}(l);t.exports=h},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/base/LineSubGeometry":undefined,"awayjs-display/lib/entities/LineSegment":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/renderables/LineSubMeshRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=e("awayjs-display/lib/base/LineSubMesh");var n=e("awayjs-stagegl/lib/base/ContextGLProgramType");var o=e("awayjs-renderergl/lib/renderables/RenderableBase");var l=function(e){i(t,e);function t(t,r,i){e.call(this,t,r.parentMesh,r,r.material,i);this._constants=new Float32Array([0,0,0,0]);this._thickness=1.25;this.subMesh=r;this._calcMatrix=new a;this._constants[1]=1/255}t.prototype._pGetSubGeometry=function(){return this.subMesh.subGeometry};t._iIncludeDependencies=function(e){e.colorDependencies++};t._iGetVertexCode=function(e,t,r){return"m44 vt0, va0, vc8			\n"+"m44 vt1, va1, vc8			\n"+"sub vt2, vt1, vt0 			\n"+"slt vt5.x, vt0.z, vc7.z			\n"+"sub vt5.y, vc5.x, vt5.x			\n"+"add vt4.x, vt0.z, vc7.z			\n"+"sub vt4.y, vt0.z, vt1.z			\n"+"seq vt4.z, vt4.y vc6.x			\n"+"add vt4.y, vt4.y, vt4.z			\n"+"div vt4.z, vt4.x, vt4.y			\n"+"mul vt4.xyz, vt4.zzz, vt2.xyz	\n"+"add vt3.xyz, vt0.xyz, vt4.xyz	\n"+"mov vt3.w, vc5.x			\n"+"mul vt0, vt0, vt5.yyyy			\n"+"mul vt3, vt3, vt5.xxxx			\n"+"add vt0, vt0, vt3				\n"+"sub vt2, vt1, vt0 			\n"+"nrm vt2.xyz, vt2.xyz			\n"+"nrm vt5.xyz, vt0.xyz			\n"+"mov vt5.w, vc5.x				\n"+"crs vt3.xyz, vt2, vt5			\n"+"nrm vt3.xyz, vt3.xyz			\n"+"mul vt3.xyz, vt3.xyz, va2.xxx	\n"+"mov vt3.w, vc5.x			\n"+"dp3 vt4.x, vt0, vc6			\n"+"mul vt4.x, vt4.x, vc7.x			\n"+"mul vt3.xyz, vt3.xyz, vt4.xxx	\n"+"add vt0.xyz, vt0.xyz, vt3.xyz	\n"+"m44 op, vt0, vc0			\n"};t._iGetFragmentCode=function(e,t,r){return""};t.prototype._iActivate=function(r,i){e.prototype._iActivate.call(this,r,i);this._constants[0]=this._thickness/(this._stage.scissorRect?Math.min(this._stage.scissorRect.width,this._stage.scissorRect.height):Math.min(this._stage.width,this._stage.height));this._constants[2]=i.projection.near;var a=this._stage.context;a.setProgramConstantsFromArray(n.VERTEX,5,t.pONE_VECTOR,1);a.setProgramConstantsFromArray(n.VERTEX,6,t.pFRONT_VECTOR,1);a.setProgramConstantsFromArray(n.VERTEX,7,this._constants,1);a.setProgramConstantsFromMatrix(n.VERTEX,0,i.projection.matrix,true)};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var a=this._stage.context;this._calcMatrix.copyFrom(this.sourceEntity.sceneTransform);this._calcMatrix.append(r.inverseSceneTransform);a.setProgramConstantsFromMatrix(n.VERTEX,8,this._calcMatrix,true)};t.assetClass=s;t.pONE_VECTOR=new Float32Array([1,1,1,1]);t.pFRONT_VECTOR=new Float32Array([0,0,-1,0]);t.vertexAttributesOffset=3;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/base/LineSubMesh":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/renderables/RenderableBase":[function(e,t,r){var i=e("awayjs-core/lib/errors/AbstractMethodError");var a=e("awayjs-display/lib/events/RenderableOwnerEvent");var s=e("awayjs-renderergl/lib/vos/SubGeometryVOPool");var n=function(){function e(e,t,r,i,n){var o=this;this._geometryDirty=true;this._onRenderOwnerUpdatedDelegate=function(e){return o._onRenderOwnerUpdated(e)};this._pool=e;this._stage=n;this._subGeometryVOPool=s.getPool();this.sourceEntity=t;this.renderableOwner=r;this.renderableOwner.addEventListener(a.RENDER_OWNER_UPDATED,this._onRenderOwnerUpdatedDelegate);this.renderOwner=i}Object.defineProperty(e.prototype,"subGeometryVO",{get:function(){if(this._geometryDirty)this._updateGeometry();return this._subGeometryVO},enumerable:true,configurable:true});e.prototype.dispose=function(){this._pool.disposeItem(this.renderableOwner)};e.prototype.invalidateGeometry=function(){this._geometryDirty=true};e.prototype._pGetSubGeometry=function(){throw new i};e.prototype._iActivate=function(e,t){e._iActivate(t)};e.prototype._iRender=function(e,t,r){this._setRenderState(e,t,r);if(this._geometryDirty)this._updateGeometry();this._subGeometryVO._iRender(e.shader,this._stage)};e.prototype._setRenderState=function(e,t,r){e._iRender(this,t,r)};e.prototype._iDeactivate=function(e){e._iDeactivate()};e.prototype._updateGeometry=function(){this._subGeometryVO=this._subGeometryVOPool.getItem(this._pGetSubGeometry());this._geometryDirty=false};e.prototype._onRenderOwnerUpdated=function(e){this.renderOwner=e.renderOwner};return e}();t.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/events/RenderableOwnerEvent":undefined,"awayjs-renderergl/lib/vos/SubGeometryVOPool":"awayjs-renderergl/lib/vos/SubGeometryVOPool"}],"awayjs-renderergl/lib/renderables/RenderablePool":[function(e,t,r){var i=e("awayjs-renderergl/lib/render/RenderPool");var a=e("awayjs-renderergl/lib/renderables/BillboardRenderable");var s=e("awayjs-renderergl/lib/renderables/LineSegmentRenderable");var n=e("awayjs-renderergl/lib/renderables/LineSubMeshRenderable");var o=e("awayjs-renderergl/lib/renderables/CurveSubMeshRenderable");var l=e("awayjs-renderergl/lib/renderables/SkyboxRenderable");var h=e("awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable");var d=function(){function e(t,r){if(r===void 0){r=null}this._pool=new Object;this._objectPools=new Object;this._stage=t;for(var a in e._classPool)this._objectPools[a]=new i(e._classPool[a],this._stage,r)}e.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddRenderable(new(e.getClass(t))(this,t,this._stage)))};e.prototype.disposeItem=function(e){e._iRemoveRenderable(this._pool[e.id]);this._pool[e.id]=null};e.prototype.getRenderPool=function(e){return this._objectPools[e.assetType]};e.registerClass=function(t){e._classPool[t.assetClass.assetType]=t};e.getClass=function(t){return e._classPool[t.assetType]};e.prototype.dispose=function(){for(var e in this._pool)this._pool[e].dispose();this._pool=null};e.addDefaults=function(){e.registerClass(a);e.registerClass(s);e.registerClass(n);e.registerClass(h);e.registerClass(o);e.registerClass(l)};e._classPool=new Object;e.main=e.addDefaults();return e}();t.exports=d},{"awayjs-renderergl/lib/render/RenderPool":"awayjs-renderergl/lib/render/RenderPool","awayjs-renderergl/lib/renderables/BillboardRenderable":"awayjs-renderergl/lib/renderables/BillboardRenderable","awayjs-renderergl/lib/renderables/CurveSubMeshRenderable":"awayjs-renderergl/lib/renderables/CurveSubMeshRenderable","awayjs-renderergl/lib/renderables/LineSegmentRenderable":"awayjs-renderergl/lib/renderables/LineSegmentRenderable","awayjs-renderergl/lib/renderables/LineSubMeshRenderable":"awayjs-renderergl/lib/renderables/LineSubMeshRenderable","awayjs-renderergl/lib/renderables/SkyboxRenderable":"awayjs-renderergl/lib/renderables/SkyboxRenderable","awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable":"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable"}],"awayjs-renderergl/lib/renderables/SkyboxRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/attributes/AttributesBuffer");var s=e("awayjs-display/lib/base/TriangleSubGeometry");var n=e("awayjs-display/lib/entities/Skybox");var o=e("awayjs-stagegl/lib/base/ContextGLProgramType");var l=e("awayjs-renderergl/lib/renderables/RenderableBase");var h=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,r,r,i);this._vertexArray=new Float32Array([0,0,0,0,1,1,1,1])}t.prototype._pGetSubGeometry=function(){var e=t._geometry;if(!e){e=t._geometry=new s(new a(11,4));e.autoDeriveNormals=false;e.autoDeriveTangents=false;e.setIndices(Array(0,1,2,2,3,0,6,5,4,4,7,6,2,6,7,7,3,2,4,5,1,1,0,4,4,0,3,3,7,4,2,1,5,5,6,2));e.setPositions(Array(-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1))}return e};t._iIncludeDependencies=function(e){};t._iGetVertexCode=function(e,t,r){return"mul vt0, va0, vc5\n"+"add vt0, vt0, vc4\n"+"m44 op, vt0, vc0\n"};t._iGetFragmentCode=function(e,t,r){return""};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var a=this._stage.context;var s=r.scenePosition;this._vertexArray[0]=s.x;this._vertexArray[1]=s.y;this._vertexArray[2]=s.z;this._vertexArray[4]=this._vertexArray[5]=this._vertexArray[6]=r.projection.far/Math.sqrt(3);a.setProgramConstantsFromMatrix(o.VERTEX,0,i,true);a.setProgramConstantsFromArray(o.VERTEX,4,this._vertexArray,2)};t.assetClass=n;t.vertexAttributesOffset=1;return t}(l);t.exports=h},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/entities/Skybox":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/renderables/TriangleSubMeshRenderable":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3DUtils");var s=e("awayjs-display/lib/base/TriangleSubMesh");var n=e("awayjs-stagegl/lib/base/ContextGLProgramType");var o=e("awayjs-renderergl/lib/renderables/RenderableBase");var l=function(e){i(t,e);function t(t,r,i){e.call(this,t,r.parentMesh,r,r.material,i);this.subMesh=r}t.prototype._pGetSubGeometry=function(){return this.subMesh.animator?this.subMesh.animator.getRenderableSubGeometry(this,this.subMesh.subGeometry):this.subMesh.subGeometry};t._iIncludeDependencies=function(e){};t._iGetVertexCode=function(e,t,r){var i="";var a=e.globalPosDependencies>0?r.globalPositionVertex:r.localPosition;var s=t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();e.viewMatrixIndex=s.index*4;if(e.projectionDependencies>0){r.projectionFragment=t.getFreeVarying();var n=t.getFreeVertexVectorTemp();i+="m44 "+n+", "+a+", "+s+"\n"+"mov "+r.projectionFragment+", "+n+"\n"+"mov op, "+n+"\n"}else{i+="m44 op, "+a+", "+s+"\n"}return i};t._iGetFragmentCode=function(e,t,r){return""};t.prototype._setRenderState=function(t,r,i){e.prototype._setRenderState.call(this,t,r,i);var s=t.shader;if(s.sceneMatrixIndex>=0){this.sourceEntity.getRenderSceneTransform(r).copyRawDataTo(s.vertexConstantData,s.sceneMatrixIndex,true);i.copyRawDataTo(s.vertexConstantData,s.viewMatrixIndex,true)}else{var o=a.CALCULATION_MATRIX;o.copyFrom(this.sourceEntity.getRenderSceneTransform(r));o.append(i);o.copyRawDataTo(s.vertexConstantData,s.viewMatrixIndex,true)}var l=this._stage.context;l.setProgramConstantsFromArray(n.VERTEX,0,s.vertexConstantData,s.numUsedVertexConstants);l.setProgramConstantsFromArray(n.FRAGMENT,0,s.fragmentConstantData,s.numUsedFragmentConstants)};t.assetClass=s;t.vertexAttributesOffset=1;return t}(o);t.exports=l},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/TriangleSubMesh":undefined,"awayjs-renderergl/lib/renderables/RenderableBase":"awayjs-renderergl/lib/renderables/RenderableBase","awayjs-stagegl/lib/base/ContextGLProgramType":undefined}],"awayjs-renderergl/lib/shaders/LightingShader":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/materials/LightSources");var s=e("awayjs-stagegl/lib/base/ContextGLProfile");var n=e("awayjs-renderergl/lib/shaders/ShaderBase");var o=e("awayjs-renderergl/lib/shaders/compilers/LightingCompiler");var l=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,i);this._includeCasters=true;this._lightingPass=r}t.prototype._iIncludeDependencies=function(){this.numPointLights=this._lightingPass.numPointLights;this.numDirectionalLights=this._lightingPass.numDirectionalLights;this.numLightProbes=this._lightingPass.numLightProbes;var t=this._lightingPass.numPointLights+this._lightingPass.numDirectionalLights;var r=this._lightingPass.numLightProbes;var i=this._lightingPass._iUsesDiffuse(this)?this._lightingPass.diffuseLightSources:0;var n=this._lightingPass._iUsesSpecular(this)?this._lightingPass.specularLightSources:0;var o=i|n;this.usesLightFallOff=this._lightingPass.enableLightFallOff&&this.profile!=s.BASELINE_CONSTRAINED;this.usesCommonData=this.usesLightFallOff;this.numLights=t+r;this.usesLights=t>0&&(o&a.LIGHTS)!=0;this.usesProbes=r>0&&(o&a.PROBES)!=0;this.usesLightsForSpecular=t>0&&(n&a.LIGHTS)!=0;this.usesProbesForSpecular=r>0&&(n&a.PROBES)!=0;this.usesLightsForDiffuse=t>0&&(i&a.LIGHTS)!=0;this.usesProbesForDiffuse=r>0&&(i&a.PROBES)!=0;this.usesShadows=this._lightingPass._iUsesShadows(this);e.prototype._iIncludeDependencies.call(this)};t.prototype.createCompiler=function(e,t){return new o(e,t,this)};t.prototype._iRender=function(t,r,i){e.prototype._iRender.call(this,t,r,i);if(this._lightingPass.lightPicker)this._lightingPass.lightPicker.collectLights(t);if(this.usesLights)this.updateLights();if(this.usesProbes)this.updateProbes()};t.prototype.updateLights=function(){var e;var t;var r=0;var i=0;var a;var s;var n=0;var o=this.usesShadows?2:1;var l;var h;this.ambientR=this.ambientG=this.ambientB=0;l=this.lightVertexConstantIndex;i=this.lightFragmentConstantIndex;var d=0;var p=this._lightingPass.lightPicker.directionalLights;h=this._lightingPass.directionalLightsOffset;a=this._lightingPass.lightPicker.directionalLights.length;if(h>a){d=1;h-=a}for(;d<o;++d){if(d)p=this._lightingPass.lightPicker.castingDirectionalLights;a=p.length;if(a>this.numDirectionalLights)a=this.numDirectionalLights;for(r=0;r<a;++r){e=p[h+r];s=e.sceneDirection;this.ambientR+=e._iAmbientR;this.ambientG+=e._iAmbientG;this.ambientB+=e._iAmbientB;if(this.usesTangentSpace){var u=-s.x;var c=-s.y;var g=-s.z;this.vertexConstantData[l++]=this._pInverseSceneMatrix[0]*u+this._pInverseSceneMatrix[4]*c+this._pInverseSceneMatrix[8]*g;this.vertexConstantData[l++]=this._pInverseSceneMatrix[1]*u+this._pInverseSceneMatrix[5]*c+this._pInverseSceneMatrix[9]*g;this.vertexConstantData[l++]=this._pInverseSceneMatrix[2]*u+this._pInverseSceneMatrix[6]*c+this._pInverseSceneMatrix[10]*g;this.vertexConstantData[l++]=1}else{this.fragmentConstantData[i++]=-s.x;this.fragmentConstantData[i++]=-s.y;this.fragmentConstantData[i++]=-s.z;this.fragmentConstantData[i++]=1}this.fragmentConstantData[i++]=e._iDiffuseR;this.fragmentConstantData[i++]=e._iDiffuseG;this.fragmentConstantData[i++]=e._iDiffuseB;this.fragmentConstantData[i++]=1;this.fragmentConstantData[i++]=e._iSpecularR;this.fragmentConstantData[i++]=e._iSpecularG;this.fragmentConstantData[i++]=e._iSpecularB;this.fragmentConstantData[i++]=1;if(++n==this.numDirectionalLights){r=a;d=o}}}if(this.numDirectionalLights>n){r=i+(this.numDirectionalLights-n)*12;while(i<r)this.fragmentConstantData[i++]=0}n=0;var f=this._lightingPass.lightPicker.pointLights;h=this._lightingPass.pointLightsOffset;a=this._lightingPass.lightPicker.pointLights.length;if(h>a){d=1;h-=a}else{d=0}for(;d<o;++d){if(d)f=this._lightingPass.lightPicker.castingPointLights;a=f.length;for(r=0;r<a;++r){t=f[h+r];s=t.scenePosition;this.ambientR+=t._iAmbientR;this.ambientG+=t._iAmbientG;this.ambientB+=t._iAmbientB;if(this.usesTangentSpace){u=s.x;c=s.y;g=s.z;this.vertexConstantData[l++]=this._pInverseSceneMatrix[0]*u+this._pInverseSceneMatrix[4]*c+this._pInverseSceneMatrix[8]*g+this._pInverseSceneMatrix[12];this.vertexConstantData[l++]=this._pInverseSceneMatrix[1]*u+this._pInverseSceneMatrix[5]*c+this._pInverseSceneMatrix[9]*g+this._pInverseSceneMatrix[13];this.vertexConstantData[l++]=this._pInverseSceneMatrix[2]*u+this._pInverseSceneMatrix[6]*c+this._pInverseSceneMatrix[10]*g+this._pInverseSceneMatrix[14];this.vertexConstantData[l++]=1}else if(!this.usesGlobalPosFragment){this.vertexConstantData[l++]=s.x;this.vertexConstantData[l++]=s.y;this.vertexConstantData[l++]=s.z;this.vertexConstantData[l++]=1}else{this.fragmentConstantData[i++]=s.x;this.fragmentConstantData[i++]=s.y;this.fragmentConstantData[i++]=s.z;this.fragmentConstantData[i++]=1}this.fragmentConstantData[i++]=t._iDiffuseR;this.fragmentConstantData[i++]=t._iDiffuseG;this.fragmentConstantData[i++]=t._iDiffuseB;var _=t._pRadius;this.fragmentConstantData[i++]=_*_;this.fragmentConstantData[i++]=t._iSpecularR;this.fragmentConstantData[i++]=t._iSpecularG;this.fragmentConstantData[i++]=t._iSpecularB;this.fragmentConstantData[i++]=t._pFallOffFactor;if(++n==this.numPointLights){r=a;d=o}}}if(this.numPointLights>n){r=i+(n-this.numPointLights)*12;for(;i<r;++i)this.fragmentConstantData[i]=0}};t.prototype.updateProbes=function(){var e;var t=this._lightingPass.lightPicker.lightProbes;var r=this._lightingPass.lightPicker.lightProbeWeights;var i=t.length-this._lightingPass.lightProbesOffset;var a=this.usesProbesForDiffuse;var s=this.usesProbesForSpecular;if(!(a||s))return;if(i>this.numLightProbes)i=this.numLightProbes;for(var n=0;n<i;++n){e=t[this._lightingPass.lightProbesOffset+n];if(a)this._stage.getImageObject(e.diffuseMap).activate(this.lightProbeDiffuseIndices[n],false,this.useSmoothTextures,this.useMipmapping);if(s)this._stage.getImageObject(e.specularMap).activate(this.lightProbeSpecularIndices[n],false,this.useSmoothTextures,this.useMipmapping)}for(n=0;n<i;++n)this.fragmentConstantData[this.probeWeightsIndex+n]=r[this._lightingPass.lightProbesOffset+n]};return t}(n);t.exports=l},{"awayjs-display/lib/materials/LightSources":undefined,"awayjs-renderergl/lib/shaders/ShaderBase":"awayjs-renderergl/lib/shaders/ShaderBase","awayjs-renderergl/lib/shaders/compilers/LightingCompiler":"awayjs-renderergl/lib/shaders/compilers/LightingCompiler","awayjs-stagegl/lib/base/ContextGLProfile":undefined}],"awayjs-renderergl/lib/shaders/RegisterPool":[function(e,t,r){var i=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var a=function(){function e(e,t,r){if(r===void 0){r=true}this._regName=e;this._regCount=t;this._persistent=r;this.initRegisters(e,t)}e.prototype.requestFreeVectorReg=function(){for(var e=0;e<this._regCount;++e){if(!this.isRegisterUsed(e)){if(this._persistent)this._usedVectorCount[e]++;return this._vectorRegisters[e]}}throw new Error("Register overflow!")};e.prototype.requestFreeRegComponent=function(){for(var e=0;e<this._regCount;++e){if(this._usedVectorCount[e]>0)continue;for(var t=0;t<4;++t){if(this._usedSingleCount[t][e]==0){if(this._persistent)this._usedSingleCount[t][e]++;return this._registerComponents[t][e]}}}throw new Error("Register overflow!")};e.prototype.addUsage=function(e,t){if(e._component>-1)this._usedSingleCount[e._component][e.index]+=t;else this._usedVectorCount[e.index]+=t};e.prototype.removeUsage=function(e){if(e._component>-1){if(--this._usedSingleCount[e._component][e.index]<0)throw new Error("More usages removed than exist!")}else{if(--this._usedVectorCount[e.index]<0)throw new Error("More usages removed than exist!")}};e.prototype.dispose=function(){this._vectorRegisters=null;this._registerComponents=null;this._usedSingleCount=null;this._usedVectorCount=null};e.prototype.hasRegisteredRegs=function(){for(var e=0;e<this._regCount;++e)if(this.isRegisterUsed(e))return true;return false};e.prototype.initRegisters=function(t,r){var i=e._initPool(t,r);this._vectorRegisters=e._regPool[i];this._registerComponents=e._regCompsPool[i];this._usedVectorCount=this._initArray(Array(r),0);this._usedSingleCount=new Array(4);this._usedSingleCount[0]=this._initArray(new Array(r),0);this._usedSingleCount[1]=this._initArray(new Array(r),0);this._usedSingleCount[2]=this._initArray(new Array(r),0);this._usedSingleCount[3]=this._initArray(new Array(r),0)};e._initPool=function(t,r){var a=t+r;if(e._regPool[a]!=undefined)return a;var s=new Array(r);e._regPool[a]=s;var n=[[],[],[],[]];e._regCompsPool[a]=n;for(var o=0;o<r;++o){s[o]=new i(t,o);for(var l=0;l<4;++l)n[l][o]=new i(t,o,l)}return a};e.prototype.isRegisterUsed=function(e){if(this._usedVectorCount[e]>0)return true;for(var t=0;t<4;++t)if(this._usedSingleCount[t][e]>0)return true;return false};e.prototype._initArray=function(e,t){var r=e.length;for(var i=0;i<r;i++)e[i]=t;return e};e._regPool=new Object;e._regCompsPool=new Object;return e}();t.exports=a},{"awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/shaders/ShaderBase":[function(e,t,r){var i=e("awayjs-core/lib/data/BlendMode");var a=e("awayjs-core/lib/errors/ArgumentError");var s=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var n=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var o=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var l=e("awayjs-renderergl/lib/shaders/compilers/CompilerBase");var h=e("awayjs-renderergl/lib/vos/TextureVOPool");var d=function(){function e(e,t,r){this._blendFactorSource=s.ONE;this._blendFactorDest=s.ZERO;this._invalidShader=true;this._invalidProgram=true;this._animationVertexCode="";this._animationFragmentCode="";this.usesBlending=false;this.depthCompareMode=n.LESS_EQUAL;this.writeDepth=true;this._defaultCulling=o.BACK;this._pInverseSceneMatrix=new Float32Array(16);
this.ambientR=255;this.ambientG=255;this.ambientB=255;this.usesGlobalPosFragment=false;this.usesLocalPosFragment=false;this._renderableClass=e;this._pass=t;this._stage=r;this.profile=this._stage.profile;this._textureVOPool=new h(this._stage)}Object.defineProperty(e.prototype,"programData",{get:function(){if(this._invalidProgram)this._updateProgram();return this._programData},enumerable:true,configurable:true});e.prototype.getTextureVO=function(e){return this._textureVOPool.getItem(e)};e.prototype._iIncludeDependencies=function(){this._pass._iIncludeDependencies(this)};e.prototype.createCompiler=function(e,t){return new l(e,t,this)};e.prototype.reset=function(){this.projectionDependencies=0;this.normalDependencies=0;this.colorDependencies=0;this.viewDirDependencies=0;this.uvDependencies=0;this.secondaryUVDependencies=0;this.globalPosDependencies=0;this.tangentDependencies=0;this.usesCommonData=false;this.usesGlobalPosFragment=false;this.usesLocalPosFragment=false;this.usesFragmentAnimation=false;this.usesTangentSpace=false;this.outputsNormals=false;this.outputsTangentNormals=false};e.prototype.pInitRegisterIndices=function(){this.commonsDataIndex=-1;this.cameraPositionIndex=-1;this.uvBufferIndex=-1;this.uvTransformIndex=-1;this.colorTransformIndex=-1;this.secondaryUVBufferIndex=-1;this.normalBufferIndex=-1;this.colorBufferIndex=-1;this.tangentBufferIndex=-1;this.sceneMatrixIndex=-1;this.sceneNormalMatrixIndex=-1;this.jointIndexIndex=-1;this.jointWeightIndex=-1};e.prototype.initConstantData=function(e,t,r,i,a){this.numUsedVertexConstants=e.numUsedVertexConstants;this.numUsedFragmentConstants=e.numUsedFragmentConstants;this.numUsedStreams=e.numUsedStreams;this.numUsedTextures=e.numUsedTextures;this.numUsedVaryings=e.numUsedVaryings;this.numUsedFragmentConstants=e.numUsedFragmentConstants;this.animatableAttributes=t;this.animationTargetRegisters=r;this.uvSource=i;this.uvTarget=a;this.vertexConstantData=new Float32Array(this.numUsedVertexConstants*4);this.fragmentConstantData=new Float32Array(this.numUsedFragmentConstants*4);if(this.commonsDataIndex>=0){this.fragmentConstantData[this.commonsDataIndex]=.5;this.fragmentConstantData[this.commonsDataIndex+1]=0;this.fragmentConstantData[this.commonsDataIndex+2]=1/255;this.fragmentConstantData[this.commonsDataIndex+3]=1}if(this.uvTransformIndex>=0){this.vertexConstantData[this.uvTransformIndex]=1;this.vertexConstantData[this.uvTransformIndex+1]=0;this.vertexConstantData[this.uvTransformIndex+2]=0;this.vertexConstantData[this.uvTransformIndex+3]=0;this.vertexConstantData[this.uvTransformIndex+4]=0;this.vertexConstantData[this.uvTransformIndex+5]=1;this.vertexConstantData[this.uvTransformIndex+6]=0;this.vertexConstantData[this.uvTransformIndex+7]=0}if(this.colorTransformIndex>=0){this.fragmentConstantData[this.colorTransformIndex]=1;this.fragmentConstantData[this.colorTransformIndex+1]=1;this.fragmentConstantData[this.colorTransformIndex+2]=1;this.fragmentConstantData[this.colorTransformIndex+3]=1;this.fragmentConstantData[this.colorTransformIndex+4]=0;this.fragmentConstantData[this.colorTransformIndex+5]=0;this.fragmentConstantData[this.colorTransformIndex+6]=0;this.fragmentConstantData[this.colorTransformIndex+7]=0}if(this.cameraPositionIndex>=0)this.vertexConstantData[this.cameraPositionIndex+3]=1};e.prototype.setBlendMode=function(e){switch(e){case i.NORMAL:this._blendFactorSource=s.ONE;this._blendFactorDest=s.ZERO;this.usesBlending=false;break;case i.LAYER:this._blendFactorSource=s.SOURCE_ALPHA;this._blendFactorDest=s.ONE_MINUS_SOURCE_ALPHA;this.usesBlending=true;break;case i.MULTIPLY:this._blendFactorSource=s.ZERO;this._blendFactorDest=s.SOURCE_COLOR;this.usesBlending=true;break;case i.ADD:this._blendFactorSource=s.SOURCE_ALPHA;this._blendFactorDest=s.ONE;this.usesBlending=true;break;case i.ALPHA:this._blendFactorSource=s.ZERO;this._blendFactorDest=s.SOURCE_ALPHA;this.usesBlending=true;break;default:throw new a("Unsupported blend mode!")}};e.prototype._iActivate=function(e){if(this.usesAnimation)this._pass.animationSet.activate(this,this._stage);this._stage.context.setCulling(this.useBothSides?o.NONE:this._defaultCulling,e.projection.coordinateSystem);if(!this.usesTangentSpace&&this.cameraPositionIndex>=0){var t=e.scenePosition;this.vertexConstantData[this.cameraPositionIndex]=t.x;this.vertexConstantData[this.cameraPositionIndex+1]=t.y;this.vertexConstantData[this.cameraPositionIndex+2]=t.z}this._stage.context.setDepthTest(this.writeDepth&&!this.usesBlending,this.depthCompareMode);if(this.usesBlending)this._stage.context.setBlendFactors(this._blendFactorSource,this._blendFactorDest)};e.prototype._iDeactivate=function(){if(this.usesAnimation)this._pass.animationSet.deactivate(this,this._stage);this._stage.context.setDepthTest(true,n.LESS_EQUAL)};e.prototype._iRender=function(e,t,r){if(e.renderableOwner.animator)e.renderableOwner.animator.setRenderState(this,e,this._stage,t,this.numUsedVertexConstants,this.numUsedStreams);if(this.usesUVTransform){var i=e.renderableOwner.uvTransform.matrix;if(i){this.vertexConstantData[this.uvTransformIndex]=i.a;this.vertexConstantData[this.uvTransformIndex+1]=i.b;this.vertexConstantData[this.uvTransformIndex+3]=i.tx;this.vertexConstantData[this.uvTransformIndex+4]=i.c;this.vertexConstantData[this.uvTransformIndex+5]=i.d;this.vertexConstantData[this.uvTransformIndex+7]=i.ty}else{this.vertexConstantData[this.uvTransformIndex]=1;this.vertexConstantData[this.uvTransformIndex+1]=0;this.vertexConstantData[this.uvTransformIndex+3]=0;this.vertexConstantData[this.uvTransformIndex+4]=0;this.vertexConstantData[this.uvTransformIndex+5]=1;this.vertexConstantData[this.uvTransformIndex+7]=0}}if(this.usesColorTransform){var a=e.sourceEntity._iAssignedColorTransform();if(a){this.fragmentConstantData[this.colorTransformIndex]=a.redMultiplier;this.fragmentConstantData[this.colorTransformIndex+1]=a.greenMultiplier;this.fragmentConstantData[this.colorTransformIndex+2]=a.blueMultiplier;this.fragmentConstantData[this.colorTransformIndex+3]=a.alphaMultiplier;this.fragmentConstantData[this.colorTransformIndex+4]=a.redOffset/255;this.fragmentConstantData[this.colorTransformIndex+5]=a.greenOffset/255;this.fragmentConstantData[this.colorTransformIndex+6]=a.blueOffset/255;this.fragmentConstantData[this.colorTransformIndex+7]=a.alphaOffset/255}else{this.fragmentConstantData[this.colorTransformIndex]=1;this.fragmentConstantData[this.colorTransformIndex+1]=1;this.fragmentConstantData[this.colorTransformIndex+2]=1;this.fragmentConstantData[this.colorTransformIndex+3]=1;this.fragmentConstantData[this.colorTransformIndex+4]=0;this.fragmentConstantData[this.colorTransformIndex+5]=0;this.fragmentConstantData[this.colorTransformIndex+6]=0;this.fragmentConstantData[this.colorTransformIndex+7]=0}}if(this.sceneNormalMatrixIndex>=0)e.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData,this.sceneNormalMatrixIndex,false);if(this.usesTangentSpace&&this.cameraPositionIndex>=0){e.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);var s=t.scenePosition;var n=s.x;var o=s.y;var l=s.z;this.vertexConstantData[this.cameraPositionIndex]=this._pInverseSceneMatrix[0]*n+this._pInverseSceneMatrix[4]*o+this._pInverseSceneMatrix[8]*l+this._pInverseSceneMatrix[12];this.vertexConstantData[this.cameraPositionIndex+1]=this._pInverseSceneMatrix[1]*n+this._pInverseSceneMatrix[5]*o+this._pInverseSceneMatrix[9]*l+this._pInverseSceneMatrix[13];this.vertexConstantData[this.cameraPositionIndex+2]=this._pInverseSceneMatrix[2]*n+this._pInverseSceneMatrix[6]*o+this._pInverseSceneMatrix[10]*l+this._pInverseSceneMatrix[14]}};e.prototype.invalidateProgram=function(){this._invalidProgram=true};e.prototype.invalidateShader=function(){this._invalidShader=true;this._invalidProgram=true};e.prototype.dispose=function(){this._programData.dispose();this._programData=null};e.prototype._updateProgram=function(){this._invalidProgram=false;var e;if(this._invalidShader){this._invalidShader=false;e=this.createCompiler(this._renderableClass,this._pass);e.compile()}this._calcAnimationCode(e.shadedTarget);var t=this._stage.getProgramData(this._animationVertexCode+e.vertexCode,e.fragmentCode+this._animationFragmentCode+e.postAnimationFragmentCode);if(this._programData!=t){if(this._programData)this._programData.dispose();this._programData=t;t.usages++}};e.prototype._calcAnimationCode=function(e){this._animationVertexCode="";this._animationFragmentCode="";if(this.usesAnimation){var t=this._pass.animationSet;this._animationVertexCode+=t.getAGALVertexCode(this);if(this.uvDependencies>0&&!this.usesUVTransform)this._animationVertexCode+=t.getAGALUVCode(this);if(this.usesFragmentAnimation)this._animationFragmentCode+=t.getAGALFragmentCode(this,e);t.doneAGALCode(this)}else{var r=this.animatableAttributes.length;for(var i=0;i<r;++i)this._animationVertexCode+="mov "+this.animationTargetRegisters[i]+", "+this.animatableAttributes[i]+"\n";if(this.uvDependencies>0&&!this.usesUVTransform)this._animationVertexCode+="mov "+this.uvTarget+","+this.uvSource+"\n"}};return e}();t.exports=d},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-renderergl/lib/shaders/compilers/CompilerBase":"awayjs-renderergl/lib/shaders/compilers/CompilerBase","awayjs-renderergl/lib/vos/TextureVOPool":"awayjs-renderergl/lib/vos/TextureVOPool","awayjs-stagegl/lib/base/ContextGLBlendFactor":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined,"awayjs-stagegl/lib/base/ContextGLTriangleFace":undefined}],"awayjs-renderergl/lib/shaders/ShaderRegisterCache":[function(e,t,r){var i=e("awayjs-renderergl/lib/shaders/RegisterPool");var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterElement");var s=function(){function e(e){this._numUsedVertexConstants=0;this._numUsedFragmentConstants=0;this._numUsedStreams=0;this._numUsedTextures=0;this._numUsedVaryings=0;this._profile=e}e.prototype.reset=function(){this._fragmentTempCache=new i("ft",8,false);this._vertexTempCache=new i("vt",8,false);this._varyingCache=new i("v",8);this._textureCache=new i("fs",8);this._vertexAttributesCache=new i("va",8);this._fragmentConstantsCache=new i("fc",28);this._vertexConstantsCache=new i("vc",128);this._fragmentOutputRegister=new a("oc",-1);this._vertexOutputRegister=new a("op",-1);this._numUsedVertexConstants=0;this._numUsedStreams=0;this._numUsedTextures=0;this._numUsedVaryings=0;this._numUsedFragmentConstants=0;var e;for(e=0;e<this._vertexAttributesOffset;++e)this.getFreeVertexAttribute();for(e=0;e<this._vertexConstantOffset;++e)this.getFreeVertexConstant();for(e=0;e<this._varyingsOffset;++e)this.getFreeVarying();for(e=0;e<this._fragmentConstantOffset;++e)this.getFreeFragmentConstant()};e.prototype.dispose=function(){this._fragmentTempCache.dispose();this._vertexTempCache.dispose();this._varyingCache.dispose();this._fragmentConstantsCache.dispose();this._vertexAttributesCache.dispose();this._fragmentTempCache=null;this._vertexTempCache=null;this._varyingCache=null;this._fragmentConstantsCache=null;this._vertexAttributesCache=null;this._fragmentOutputRegister=null;this._vertexOutputRegister=null};e.prototype.addFragmentTempUsages=function(e,t){this._fragmentTempCache.addUsage(e,t)};e.prototype.removeFragmentTempUsage=function(e){this._fragmentTempCache.removeUsage(e)};e.prototype.addVertexTempUsages=function(e,t){this._vertexTempCache.addUsage(e,t)};e.prototype.removeVertexTempUsage=function(e){this._vertexTempCache.removeUsage(e)};e.prototype.getFreeFragmentVectorTemp=function(){return this._fragmentTempCache.requestFreeVectorReg()};e.prototype.getFreeFragmentSingleTemp=function(){return this._fragmentTempCache.requestFreeRegComponent()};e.prototype.getFreeVarying=function(){++this._numUsedVaryings;return this._varyingCache.requestFreeVectorReg()};e.prototype.getFreeFragmentConstant=function(){++this._numUsedFragmentConstants;return this._fragmentConstantsCache.requestFreeVectorReg()};e.prototype.getFreeVertexConstant=function(){++this._numUsedVertexConstants;return this._vertexConstantsCache.requestFreeVectorReg()};e.prototype.getFreeVertexVectorTemp=function(){return this._vertexTempCache.requestFreeVectorReg()};e.prototype.getFreeVertexSingleTemp=function(){return this._vertexTempCache.requestFreeRegComponent()};e.prototype.getFreeVertexAttribute=function(){++this._numUsedStreams;return this._vertexAttributesCache.requestFreeVectorReg()};e.prototype.getFreeTextureReg=function(){++this._numUsedTextures;return this._textureCache.requestFreeVectorReg()};Object.defineProperty(e.prototype,"vertexConstantOffset",{get:function(){return this._vertexConstantOffset},set:function(e){this._vertexConstantOffset=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"vertexAttributesOffset",{get:function(){return this._vertexAttributesOffset},set:function(e){this._vertexAttributesOffset=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"varyingsOffset",{get:function(){return this._varyingsOffset},set:function(e){this._varyingsOffset=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fragmentConstantOffset",{get:function(){return this._fragmentConstantOffset},set:function(e){this._fragmentConstantOffset=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fragmentOutputRegister",{get:function(){return this._fragmentOutputRegister},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numUsedVertexConstants",{get:function(){return this._numUsedVertexConstants},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numUsedFragmentConstants",{get:function(){return this._numUsedFragmentConstants},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numUsedStreams",{get:function(){return this._numUsedStreams},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numUsedTextures",{get:function(){return this._numUsedTextures},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numUsedVaryings",{get:function(){return this._numUsedVaryings},enumerable:true,configurable:true});return e}();t.exports=s},{"awayjs-renderergl/lib/shaders/RegisterPool":"awayjs-renderergl/lib/shaders/RegisterPool","awayjs-renderergl/lib/shaders/ShaderRegisterElement":"awayjs-renderergl/lib/shaders/ShaderRegisterElement"}],"awayjs-renderergl/lib/shaders/ShaderRegisterData":[function(e,t,r){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-renderergl/lib/shaders/ShaderRegisterElement":[function(e,t,r){var i=function(){function e(t,r,i){if(i===void 0){i=-1}this._component=i;this._regName=t;this._index=r;this._toStr=this._regName;if(this._index>=0)this._toStr+=this._index;if(i>-1)this._toStr+="."+e.COMPONENTS[i]}e.prototype.toString=function(){return this._toStr};Object.defineProperty(e.prototype,"regName",{get:function(){return this._regName},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:true,configurable:true});e.COMPONENTS=["x","y","z","w"];return e}();t.exports=i},{}],"awayjs-renderergl/lib/shaders/compilers/CompilerBase":[function(e,t,r){var i=e("awayjs-renderergl/lib/shaders/ShaderRegisterCache");var a=e("awayjs-renderergl/lib/shaders/ShaderRegisterData");var s=function(){function e(e,t,r){this._pVertexCode="";this._pFragmentCode="";this._pPostAnimationFragmentCode="";this._pRenderableClass=e;this._pRenderPass=t;this._pShader=r;this._pSharedRegisters=new a;this._pRegisterCache=new i(r.profile);this._pRegisterCache.vertexAttributesOffset=e.vertexAttributesOffset;this._pRegisterCache.reset()}e.prototype.compile=function(){this._pShader.reset();this._pShader._iIncludeDependencies();this.pInitRegisterIndices();this.pCompileDependencies();this._pVertexCode+=this._pRenderPass._iGetVertexCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);this._pPostAnimationFragmentCode+=this._pRenderPass._iGetFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);console.log("uses ct:",this._pShader.usesColorTransform);if(this._pShader.usesColorTransform){this.compileColorTransformCode()}else{this._pShader.colorTransformIndex=-1}this._pPostAnimationFragmentCode+="mov "+this._pRegisterCache.fragmentOutputRegister+", "+this._pSharedRegisters.shadedTarget+"\n";this._pRegisterCache.removeFragmentTempUsage(this._pSharedRegisters.shadedTarget);this._pShader.initConstantData(this._pRegisterCache,this._pAnimatableAttributes,this._pAnimationTargetRegisters,this._uvSource,this._uvTarget);this._pRenderPass._iInitConstantData(this._pShader)};e.prototype.compileColorTransformCode=function(){var e=this._pRegisterCache.getFreeFragmentConstant();var t=this._pRegisterCache.getFreeFragmentConstant();this._pShader.colorTransformIndex=e.index*4;this._pPostAnimationFragmentCode+="mul "+this._pSharedRegisters.shadedTarget+", "+this._pSharedRegisters.shadedTarget+", "+e+"\n";this._pPostAnimationFragmentCode+="add "+this._pSharedRegisters.shadedTarget+", "+this._pSharedRegisters.shadedTarget+", "+t+"\n"};e.prototype.pCompileDependencies=function(){this._pSharedRegisters.shadedTarget=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadedTarget,1);if(this._pShader.globalPosDependencies>0)this.compileGlobalPositionCode();if(this._pShader.usesLocalPosFragment)this.compileLocalPositionCode();if(this._pShader.uvDependencies>0)this.compileUVCode();if(this._pShader.secondaryUVDependencies>0)this.compileSecondaryUVCode();if(this._pShader.normalDependencies>0)this.compileNormalCode();if(this._pShader.viewDirDependencies>0)this.compileViewDirCode();this._pVertexCode+=this._pRenderableClass._iGetVertexCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pRenderableClass._iGetFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);this._pVertexCode+=this._pRenderPass._iGetPreLightingVertexCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pRenderPass._iGetPreLightingFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters)};e.prototype.compileGlobalPositionCode=function(){this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.globalPositionVertex=this._pRegisterCache.getFreeVertexVectorTemp(),this._pShader.globalPosDependencies);var e=this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pShader.sceneMatrixIndex=e.index*4;this._pVertexCode+="m44 "+this._pSharedRegisters.globalPositionVertex+", "+this._pSharedRegisters.localPosition+", "+e+"\n";if(this._pShader.usesGlobalPosFragment){this._pSharedRegisters.globalPositionVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.globalPositionVarying+", "+this._pSharedRegisters.globalPositionVertex+"\n"}};e.prototype.compileLocalPositionCode=function(){this._pSharedRegisters.localPositionVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.localPositionVarying+", "+this._pSharedRegisters.localPosition+"\n"};e.prototype.compileUVCode=function(){var e=this._pRegisterCache.getFreeVertexAttribute();this._pShader.uvBufferIndex=e.index;var t=this._pSharedRegisters.uvVarying=this._pRegisterCache.getFreeVarying();if(this._pShader.usesUVTransform){var r=this._pRegisterCache.getFreeVertexConstant();var i=this._pRegisterCache.getFreeVertexConstant();this._pShader.uvTransformIndex=r.index*4;this._pVertexCode+="dp4 "+t+".x, "+e+", "+r+"\n"+"dp4 "+t+".y, "+e+", "+i+"\n"+"mov "+t+".zw, "+e+".zw \n"}else{this._pShader.uvTransformIndex=-1;this._uvTarget=t.toString();this._uvSource=e.toString()}};e.prototype.compileSecondaryUVCode=function(){var e=this._pRegisterCache.getFreeVertexAttribute();this._pShader.secondaryUVBufferIndex=e.index;this._pSharedRegisters.secondaryUVVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.secondaryUVVarying+", "+e+"\n"};e.prototype.compileViewDirCode=function(){var e=this._pRegisterCache.getFreeVertexConstant();this._pSharedRegisters.viewDirVarying=this._pRegisterCache.getFreeVarying();this._pSharedRegisters.viewDirFragment=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.viewDirFragment,this._pShader.viewDirDependencies);this._pShader.cameraPositionIndex=e.index*4;if(this._pShader.usesTangentSpace){var t=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="sub "+t+", "+e+", "+this._pSharedRegisters.localPosition+"\n"+"m33 "+this._pSharedRegisters.viewDirVarying+".xyz, "+t+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+this._pSharedRegisters.viewDirVarying+".w, "+this._pSharedRegisters.localPosition+".w\n"}else{this._pVertexCode+="sub "+this._pSharedRegisters.viewDirVarying+", "+e+", "+this._pSharedRegisters.globalPositionVertex+"\n";this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.globalPositionVertex)}this._pFragmentCode+="nrm "+this._pSharedRegisters.viewDirFragment+".xyz, "+this._pSharedRegisters.viewDirVarying+"\n"+"mov "+this._pSharedRegisters.viewDirFragment+".w,   "+this._pSharedRegisters.viewDirVarying+".w\n"};e.prototype.compileNormalCode=function(){this._pSharedRegisters.normalFragment=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.normalFragment,this._pShader.normalDependencies);if(this._pShader.outputsNormals&&!this._pShader.outputsTangentNormals){this._pVertexCode+=this._pRenderPass._iGetNormalVertexCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._pRenderPass._iGetNormalFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters);return}var e;if(!this._pShader.outputsNormals||!this._pShader.usesTangentSpace){e=new Array(3);e[0]=this._pRegisterCache.getFreeVertexConstant();e[1]=this._pRegisterCache.getFreeVertexConstant();e[2]=this._pRegisterCache.getFreeVertexConstant();this._pRegisterCache.getFreeVertexConstant();this._pShader.sceneNormalMatrixIndex=e[0].index*4;this._pSharedRegisters.normalVarying=this._pRegisterCache.getFreeVarying()}if(this._pShader.outputsNormals){if(this._pShader.usesTangentSpace){this._pVertexCode+="nrm "+this._pSharedRegisters.animatedNormal+".xyz, "+this._pSharedRegisters.animatedNormal+"\n"+"nrm "+this._pSharedRegisters.animatedTangent+".xyz, "+this._pSharedRegisters.animatedTangent+"\n"+"crs "+this._pSharedRegisters.bitangent+".xyz, "+this._pSharedRegisters.animatedNormal+", "+this._pSharedRegisters.animatedTangent+"\n";this._pFragmentCode+=this._pRenderPass._iGetNormalFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters)}else{this._pSharedRegisters.tangentVarying=this._pRegisterCache.getFreeVarying();this._pSharedRegisters.bitangentVarying=this._pRegisterCache.getFreeVarying();var t=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="m33 "+t+".xyz, "+this._pSharedRegisters.animatedNormal+", "+e[0]+"\n"+"nrm "+this._pSharedRegisters.animatedNormal+".xyz, "+t+"\n"+"m33 "+t+".xyz, "+this._pSharedRegisters.animatedTangent+", "+e[0]+"\n"+"nrm "+this._pSharedRegisters.animatedTangent+".xyz, "+t+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".x, "+this._pSharedRegisters.animatedTangent+".x  \n"+"mov "+this._pSharedRegisters.tangentVarying+".z, "+this._pSharedRegisters.animatedNormal+".x  \n"+"mov "+this._pSharedRegisters.tangentVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".x, "+this._pSharedRegisters.animatedTangent+".y  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".z, "+this._pSharedRegisters.animatedNormal+".y  \n"+"mov "+this._pSharedRegisters.bitangentVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"mov "+this._pSharedRegisters.normalVarying+".x, "+this._pSharedRegisters.animatedTangent+".z  \n"+"mov "+this._pSharedRegisters.normalVarying+".z, "+this._pSharedRegisters.animatedNormal+".z  \n"+"mov "+this._pSharedRegisters.normalVarying+".w, "+this._pSharedRegisters.normalInput+".w  \n"+"crs "+t+".xyz, "+this._pSharedRegisters.animatedNormal+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".y, "+t+".x    \n"+"mov "+this._pSharedRegisters.bitangentVarying+".y, "+t+".y  \n"+"mov "+this._pSharedRegisters.normalVarying+".y, "+t+".z    \n";this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedTangent);var r;var i;var a;r=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(r,1);i=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(i,1);a=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(a,1);this._pFragmentCode+="nrm "+r+".xyz, "+this._pSharedRegisters.tangentVarying+"\n"+"mov "+r+".w, "+this._pSharedRegisters.tangentVarying+".w	\n"+"nrm "+i+".xyz, "+this._pSharedRegisters.bitangentVarying+"\n"+"nrm "+a+".xyz, "+this._pSharedRegisters.normalVarying+"\n";this._pFragmentCode+=this._pRenderPass._iGetNormalFragmentCode(this._pShader,this._pRegisterCache,this._pSharedRegisters)+"m33 "+this._pSharedRegisters.normalFragment+".xyz, "+this._pSharedRegisters.normalFragment+", "+r+"\n"+"mov "+this._pSharedRegisters.normalFragment+".w, "+this._pSharedRegisters.normalVarying+".w\n";this._pRegisterCache.removeFragmentTempUsage(i);this._pRegisterCache.removeFragmentTempUsage(r);this._pRegisterCache.removeFragmentTempUsage(a)}}else{this._pVertexCode+="m33 "+this._pSharedRegisters.normalVarying+".xyz, "+this._pSharedRegisters.animatedNormal+", "+e[0]+"\n"+"mov "+this._pSharedRegisters.normalVarying+".w, "+this._pSharedRegisters.animatedNormal+".w\n";this._pFragmentCode+="nrm "+this._pSharedRegisters.normalFragment+".xyz, "+this._pSharedRegisters.normalVarying+"\n"+"mov "+this._pSharedRegisters.normalFragment+".w, "+this._pSharedRegisters.normalVarying+".w\n";if(this._pShader.tangentDependencies>0){this._pSharedRegisters.tangentVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="m33 "+this._pSharedRegisters.tangentVarying+".xyz, "+this._pSharedRegisters.animatedTangent+", "+e[0]+"\n"+"mov "+this._pSharedRegisters.tangentVarying+".w, "+this._pSharedRegisters.animatedTangent+".w\n"}}if(!this._pShader.usesTangentSpace)this._pRegisterCache.removeVertexTempUsage(this._pSharedRegisters.animatedNormal)};e.prototype.pInitRegisterIndices=function(){this._pShader.pInitRegisterIndices();this._pAnimatableAttributes=new Array("va0");this._pAnimationTargetRegisters=new Array("vt0");this._pVertexCode="";this._pFragmentCode="";this._pPostAnimationFragmentCode="";this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.localPosition=this._pRegisterCache.getFreeVertexVectorTemp(),1);if(this._pShader.usesCommonData||this._pShader.normalDependencies>0){this._pSharedRegisters.commons=this._pRegisterCache.getFreeFragmentConstant();this._pShader.commonsDataIndex=this._pSharedRegisters.commons.index*4}if(this._pShader.tangentDependencies>0||this._pShader.outputsNormals){this._pSharedRegisters.tangentInput=this._pRegisterCache.getFreeVertexAttribute();this._pShader.tangentBufferIndex=this._pSharedRegisters.tangentInput.index;this._pSharedRegisters.animatedTangent=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedTangent,1);if(this._pShader.usesTangentSpace){this._pSharedRegisters.bitangent=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.bitangent,1)}this._pAnimatableAttributes.push(this._pSharedRegisters.tangentInput.toString());this._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedTangent.toString())}if(this._pShader.normalDependencies>0){this._pSharedRegisters.normalInput=this._pRegisterCache.getFreeVertexAttribute();this._pShader.normalBufferIndex=this._pSharedRegisters.normalInput.index;this._pSharedRegisters.animatedNormal=this._pRegisterCache.getFreeVertexVectorTemp();this._pRegisterCache.addVertexTempUsages(this._pSharedRegisters.animatedNormal,1);this._pAnimatableAttributes.push(this._pSharedRegisters.normalInput.toString());this._pAnimationTargetRegisters.push(this._pSharedRegisters.animatedNormal.toString())}if(this._pShader.colorDependencies>0){this._pSharedRegisters.colorInput=this._pRegisterCache.getFreeVertexAttribute();this._pShader.colorBufferIndex=this._pSharedRegisters.colorInput.index;this._pSharedRegisters.colorVarying=this._pRegisterCache.getFreeVarying();this._pVertexCode+="mov "+this._pSharedRegisters.colorVarying+", "+this._pSharedRegisters.colorInput+"\n"}};e.prototype.dispose=function(){this._pRegisterCache.dispose();this._pRegisterCache=null;this._pSharedRegisters=null};Object.defineProperty(e.prototype,"vertexCode",{get:function(){return this._pVertexCode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fragmentCode",{get:function(){return this._pFragmentCode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"postAnimationFragmentCode",{get:function(){return this._pPostAnimationFragmentCode},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shadedTarget",{get:function(){return this._pSharedRegisters.shadedTarget.toString()},enumerable:true,configurable:true});return e}();t.exports=s},{"awayjs-renderergl/lib/shaders/ShaderRegisterCache":"awayjs-renderergl/lib/shaders/ShaderRegisterCache","awayjs-renderergl/lib/shaders/ShaderRegisterData":"awayjs-renderergl/lib/shaders/ShaderRegisterData"}],"awayjs-renderergl/lib/shaders/compilers/LightingCompiler":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/shaders/compilers/CompilerBase");var s=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,i);this._shaderLightingObject=i;this._lightingPass=r}t.prototype.pCompileDependencies=function(){e.prototype.pCompileDependencies.call(this);if(this._shaderLightingObject.usesShadows)this.pCompileShadowCode();if(this._shaderLightingObject.usesLights){this.initLightRegisters();this.compileLightCode()}if(this._shaderLightingObject.usesProbes)this.compileLightProbeCode();this._pVertexCode+=this._lightingPass._iGetPostLightingVertexCode(this._shaderLightingObject,this._pRegisterCache,this._pSharedRegisters);this._pFragmentCode+=this._lightingPass._iGetPostLightingFragmentCode(this._shaderLightingObject,this._pRegisterCache,this._pSharedRegisters)};t.prototype.pCompileShadowCode=function(){if(this._shaderLightingObject.normalDependencies>0){this._pSharedRegisters.shadowTarget=this._pSharedRegisters.normalFragment}else{this._pSharedRegisters.shadowTarget=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(this._pSharedRegisters.shadowTarget,1)}};t.prototype.initLightRegisters=function(){var e,t;if(this._dirLightVertexConstants){t=this._dirLightVertexConstants.length;for(e=0;e<t;++e){this._dirLightVertexConstants[e]=this._pRegisterCache.getFreeVertexConstant();if(this._shaderLightingObject.lightVertexConstantIndex==-1)this._shaderLightingObject.lightVertexConstantIndex=this._dirLightVertexConstants[e].index*4}}if(this._pointLightVertexConstants){t=this._pointLightVertexConstants.length;for(e=0;e<t;++e){this._pointLightVertexConstants[e]=this._pRegisterCache.getFreeVertexConstant();if(this._shaderLightingObject.lightVertexConstantIndex==-1)this._shaderLightingObject.lightVertexConstantIndex=this._pointLightVertexConstants[e].index*4}}t=this._dirLightFragmentConstants.length;for(e=0;e<t;++e){this._dirLightFragmentConstants[e]=this._pRegisterCache.getFreeFragmentConstant();if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=this._dirLightFragmentConstants[e].index*4
}t=this._pointLightFragmentConstants.length;for(e=0;e<t;++e){this._pointLightFragmentConstants[e]=this._pRegisterCache.getFreeFragmentConstant();if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=this._pointLightFragmentConstants[e].index*4}};t.prototype.compileLightCode=function(){var e;var t;var r;var i;var a=0;var s=0;var n=this._shaderLightingObject.usesLightsForSpecular;var o=this._shaderLightingObject.usesLightsForDiffuse;for(var l=0;l<this._shaderLightingObject.numDirectionalLights;++l){if(this._shaderLightingObject.usesTangentSpace){i=this._dirLightVertexConstants[a++];var h=this._pRegisterCache.getFreeVarying();this._pVertexCode+="m33 "+h+".xyz, "+i+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+h+".w, "+i+".w\n";i=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addVertexTempUsages(i,1);this._pFragmentCode+="nrm "+i+".xyz, "+h+"\n"+"mov "+i+".w, "+h+".w\n"}else{i=this._dirLightFragmentConstants[s++]}e=this._dirLightFragmentConstants[s++];t=this._dirLightFragmentConstants[s++];if(o)this._pFragmentCode+=this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject,i,e,this._pRegisterCache,this._pSharedRegisters);if(n)this._pFragmentCode+=this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject,i,t,this._pRegisterCache,this._pSharedRegisters);if(this._shaderLightingObject.usesTangentSpace)this._pRegisterCache.removeVertexTempUsage(i)}a=0;s=0;for(var l=0;l<this._shaderLightingObject.numPointLights;++l){if(this._shaderLightingObject.usesTangentSpace||!this._shaderLightingObject.usesGlobalPosFragment)r=this._pointLightVertexConstants[a++];else r=this._pointLightFragmentConstants[s++];e=this._pointLightFragmentConstants[s++];t=this._pointLightFragmentConstants[s++];i=this._pRegisterCache.getFreeFragmentVectorTemp();this._pRegisterCache.addFragmentTempUsages(i,1);var h;if(this._shaderLightingObject.usesTangentSpace){h=this._pRegisterCache.getFreeVarying();var d=this._pRegisterCache.getFreeVertexVectorTemp();this._pVertexCode+="sub "+d+", "+r+", "+this._pSharedRegisters.localPosition+"\n"+"m33 "+h+".xyz, "+d+", "+this._pSharedRegisters.animatedTangent+"\n"+"mov "+h+".w, "+this._pSharedRegisters.localPosition+".w\n"}else if(!this._shaderLightingObject.usesGlobalPosFragment){h=this._pRegisterCache.getFreeVarying();this._pVertexCode+="sub "+h+", "+r+", "+this._pSharedRegisters.globalPositionVertex+"\n"}else{h=i;this._pFragmentCode+="sub "+i+", "+r+", "+this._pSharedRegisters.globalPositionVarying+"\n"}if(this._shaderLightingObject.usesLightFallOff){this._pFragmentCode+="dp3 "+i+".w, "+h+", "+h+"\n"+"sub "+i+".w, "+i+".w, "+e+".w\n"+"mul "+i+".w, "+i+".w, "+t+".w\n"+"sat "+i+".w, "+i+".w\n"+"sub "+i+".w, "+this._pSharedRegisters.commons+".w, "+i+".w\n"+"nrm "+i+".xyz, "+h+"\n"}else{this._pFragmentCode+="nrm "+i+".xyz, "+h+"\n"+"mov "+i+".w, "+h+".w\n"}if(this._shaderLightingObject.lightFragmentConstantIndex==-1)this._shaderLightingObject.lightFragmentConstantIndex=r.index*4;if(o)this._pFragmentCode+=this._lightingPass._iGetPerLightDiffuseFragmentCode(this._shaderLightingObject,i,e,this._pRegisterCache,this._pSharedRegisters);if(n)this._pFragmentCode+=this._lightingPass._iGetPerLightSpecularFragmentCode(this._shaderLightingObject,i,t,this._pRegisterCache,this._pSharedRegisters);this._pRegisterCache.removeFragmentTempUsage(i)}};t.prototype.compileLightProbeCode=function(){var e;var t=[".x",".y",".z",".w"];var r=new Array;var i;var a;var s=this._shaderLightingObject.usesProbesForSpecular;var n=this._shaderLightingObject.usesProbesForDiffuse;if(n)this._shaderLightingObject.lightProbeDiffuseIndices=new Array;if(s)this._shaderLightingObject.lightProbeSpecularIndices=new Array;for(i=0;i<this._pNumProbeRegisters;++i){r[i]=this._pRegisterCache.getFreeFragmentConstant();if(i==0)this._shaderLightingObject.probeWeightsIndex=r[i].index*4}for(i=0;i<this._shaderLightingObject.numLightProbes;++i){e=r[Math.floor(i/4)].toString()+t[i%4];if(n){a=this._pRegisterCache.getFreeTextureReg();this._shaderLightingObject.lightProbeDiffuseIndices[i]=a.index;this._pFragmentCode+=this._lightingPass._iGetPerProbeDiffuseFragmentCode(this._shaderLightingObject,a,e,this._pRegisterCache,this._pSharedRegisters)}if(s){a=this._pRegisterCache.getFreeTextureReg();this._shaderLightingObject.lightProbeSpecularIndices[i]=a.index;this._pFragmentCode+=this._lightingPass._iGetPerProbeSpecularFragmentCode(this._shaderLightingObject,a,e,this._pRegisterCache,this._pSharedRegisters)}}};t.prototype.pInitRegisterIndices=function(){e.prototype.pInitRegisterIndices.call(this);this._shaderLightingObject.lightVertexConstantIndex=-1;this._shaderLightingObject.lightFragmentConstantIndex=-1;this._shaderLightingObject.probeWeightsIndex=-1;this._pNumProbeRegisters=Math.ceil(this._shaderLightingObject.numLightProbes/4);if(this._shaderLightingObject.usesTangentSpace||!this._shaderLightingObject.usesGlobalPosFragment){this._pointLightVertexConstants=new Array(this._shaderLightingObject.numPointLights);this._pointLightFragmentConstants=new Array(this._shaderLightingObject.numPointLights*2)}else{this._pointLightFragmentConstants=new Array(this._shaderLightingObject.numPointLights*3)}if(this._shaderLightingObject.usesTangentSpace){this._dirLightVertexConstants=new Array(this._shaderLightingObject.numDirectionalLights);this._dirLightFragmentConstants=new Array(this._shaderLightingObject.numDirectionalLights*2)}else{this._dirLightFragmentConstants=new Array(this._shaderLightingObject.numDirectionalLights*3)}};return t}(a);t.exports=s},{"awayjs-renderergl/lib/shaders/compilers/CompilerBase":"awayjs-renderergl/lib/shaders/compilers/CompilerBase"}],"awayjs-renderergl/lib/tools/commands/Merge":[function(e,t,r){var i=e("awayjs-core/lib/attributes/AttributesBuffer");var a=e("awayjs-core/lib/geom/Matrix3DUtils");var s=e("awayjs-display/lib/base/Geometry");var n=e("awayjs-display/lib/base/TriangleSubGeometry");var o=e("awayjs-display/lib/entities/Mesh");var l=function(){function e(e,t,r){if(e===void 0){e=false}if(t===void 0){t=false}if(r===void 0){r=false}this._keepMaterial=e;this._disposeSources=t;this._objectSpace=r}Object.defineProperty(e.prototype,"disposeSources",{get:function(){return this._disposeSources},set:function(e){this._disposeSources=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"keepMaterial",{get:function(){return this._keepMaterial},set:function(e){this._keepMaterial=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"objectSpace",{get:function(){return this._objectSpace},set:function(e){this._objectSpace=e},enumerable:true,configurable:true});e.prototype.applyToContainer=function(e,t){this.reset();this.parseContainer(e,t);this.collect(e,false);this.merge(e,this._disposeSources)};e.prototype.applyToMeshes=function(e,t){this.reset();if(!t.length)return;for(var r=0;r<t.length;r++)if(t[r]!=e)this.collect(t[r],this._disposeSources);this.collect(e,false);this.merge(e,this._disposeSources)};e.prototype.apply=function(e,t){this.reset();this.collect(t,this._disposeSources);this.collect(e,false);this.merge(e,this._disposeSources)};e.prototype.reset=function(){this._toDispose=new Array;this._geomVOs=new Array};e.prototype.merge=function(e,t){var r;var a;var o;var l;var h;o=e.geometry;l=e.geometry=new s;a=e.subMeshes.length;h=this._geomVOs.length>1;for(r=0;r<this._geomVOs.length;r++){var d;var p;var u=new n(new i);u.autoDeriveNormals=false;u.autoDeriveTangents=false;p=this._geomVOs[r];u.setIndices(p.indices);u.setPositions(p.vertices);u.setNormals(p.normals);u.setTangents(p.tangents);u.setUVs(p.uvs);l.addSubGeometry(u);if(this._keepMaterial&&h)e.subMeshes[a].material=p.material}if(this._keepMaterial&&!h&&this._geomVOs.length)e.material=this._geomVOs[0].material;if(t){var c;var g=this._toDispose.length;for(var r;r<g;r++){c=this._toDispose[r];c.geometry.dispose();c.dispose()}o.dispose()}this._toDispose=null};e.prototype.collect=function(e,t){if(e.geometry){var r;var i=e.geometry.subGeometries;var s;for(r=0;r<i.length;r++){var n;var o;var l,h,d,p,u;var c;var g;var f;var _;var m;var y;var v,b,x,w,C;g=i[r];b=g.positions.get(g.numVertices);x=g.normals.get(g.numVertices);w=g.tangents.get(g.numVertices);C=g.uvs.get(g.numVertices);f=this.getSubGeomData(e.subMeshes[r].material||e.material);_=this._objectSpace?f.vertices:new Array;m=this._objectSpace?f.normals:new Array;y=this._objectSpace?f.tangents:new Array;h=_.length;d=m.length;p=y.length;u=f.uvs.length;o=g.numVertices;for(n=0;n<o;n++){s=n*3;_[h++]=b[s];_[h++]=b[s+1];_[h++]=b[s+2];m[d++]=x[s];m[d++]=x[s+1];m[d++]=x[s+2];y[p++]=w[s];y[p++]=w[s+1];y[p++]=w[s+2];f.uvs[u++]=C[n*2];f.uvs[u++]=C[n*2+1]}c=!this._objectSpace?f.vertices.length/3:0;l=f.indices.length;o=g.numElements;v=g.indices.get(o);for(n=0;n<o;n++){s=n*3;f.indices[l++]=v[s]+c;f.indices[l++]=v[s+1]+c;f.indices[l++]=v[s+2]+c}if(!this._objectSpace){e.sceneTransform.transformVectors(_,_);a.deltaTransformVectors(e.sceneTransform,m,m);a.deltaTransformVectors(e.sceneTransform,y,y);h=f.vertices.length;d=f.normals.length;p=f.tangents.length;o=_.length;for(n=0;n<o;n++){f.vertices[h++]=_[n];f.normals[d++]=m[n];f.tangents[p++]=y[n]}}}if(t)this._toDispose.push(e)}};e.prototype.getSubGeomData=function(e){var t;if(this._keepMaterial){var r;var i;i=this._geomVOs.length;for(r=0;r<i;r++){if(this._geomVOs[r].material==e){t=this._geomVOs[r];break}}}else if(this._geomVOs.length){t=this._geomVOs[0]}if(!t){t=new h;t.vertices=new Array;t.normals=new Array;t.tangents=new Array;t.uvs=new Array;t.indices=new Array;t.material=e;this._geomVOs.push(t)}return t};e.prototype.parseContainer=function(e,t){var r;var i;if(t instanceof o&&t!=e)this.collect(t,this._disposeSources);for(i=0;i<t.numChildren;++i){r=t.getChildAt(i);this.parseContainer(e,r)}};return e}();var h=function(){function e(){}return e}();t.exports=l},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/entities/Mesh":undefined}],"awayjs-renderergl/lib/tools/data/ParticleGeometryTransform":[function(e,t,r){var i=function(){function e(){}Object.defineProperty(e.prototype,"vertexTransform",{get:function(){return this._defaultVertexTransform},set:function(e){this._defaultVertexTransform=e;this._defaultInvVertexTransform=e.clone();this._defaultInvVertexTransform.invert();this._defaultInvVertexTransform.transpose()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"UVTransform",{get:function(){return this._defaultUVTransform},set:function(e){this._defaultUVTransform=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"invVertexTransform",{get:function(){return this._defaultInvVertexTransform},enumerable:true,configurable:true});return e}();t.exports=i},{}],"awayjs-renderergl/lib/utils/ParticleGeometryHelper":[function(e,t,r){var i=e("awayjs-core/lib/attributes/AttributesBuffer");var a=e("awayjs-core/lib/geom/Point");var s=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-display/lib/base/TriangleSubGeometry");var o=e("awayjs-renderergl/lib/animators/data/ParticleData");var l=e("awayjs-renderergl/lib/base/ParticleGeometry");var h=function(){function e(){}e.generateGeometry=function(t,r){if(r===void 0){r=null}var h=new Array;var d=new Array;var p=new Array;var u=new Array;var c=new Array;var g=new Array;var f=new Array;var _=new Array;var m=t.length;var y;var v;var b;var x;var w;var C;var P;var S;var D;var j;var R;var T;var O=new Array;var A=new s;var V=new s;var I=new s;var F=new a;for(R=0;R<m;R++){y=t[R].subGeometries;b=y.length;for(var M=0;M<b;M++){if(O.length<=M){O.push(_.length);h.push(new Array);d.push(new Array);p.push(new Array);u.push(new Array);c.push(new Array);_.push(new n(new i));g.push(0)}v=y[M];if(v.numVertices+g[O[M]]>e.MAX_VERTEX){O[M]=_.length;h.push(new Array);d.push(new Array);p.push(new Array);u.push(new Array);c.push(new Array);_.push(new n(new i));g.push(0)}T=O[M];x=h[T];w=d[T];C=p[T];P=u[T];S=c[T];D=g[T];j=_[T];var N=new o;N.numVertices=v.numVertices;N.startVertexIndex=D;N.particleIndex=R;N.subGeometry=j;f.push(N);g[T]+=v.numVertices;var L;var E;var B=v;var z;var G;var U;var k;var X;if(B){E=B.numVertices;G=B.positions.get(E);U=B.normals.get(E);k=B.tangents.get(E);X=B.uvs.get(E);if(r){var W=r[R];var H=W.vertexTransform;var q=W.invVertexTransform;var Z=W.UVTransform;for(L=0;L<E;L++){z=L*3;A.x=G[z];A.y=G[z+1];A.z=G[z+2];V.x=U[z];V.y=U[z+1];V.z=U[z+2];I.x=k[z];I.y=k[z+1];I.z=k[z+2];F.x=X[L*2];F.y=X[L*2+1];if(H){A=H.transformVector(A);V=q.deltaTransformVector(V);I=q.deltaTransformVector(V)}if(Z)F=Z.transformPoint(F);w.push(A.x,A.y,A.z);C.push(V.x,V.y,V.z);P.push(I.x,I.y,I.z);S.push(F.x,F.y)}}else{for(L=0;L<E;L++){z=L*3;w.push(G[z],G[z+1],G[z+2]);C.push(U[z],U[z+1],U[z+2]);P.push(k[z],k[z+1],k[z+2]);S.push(X[L*2],X[L*2+1])}}}else{}E=v.numElements;var Y=v.indices.get(E);for(L=0;L<E;L++){z=L*3;x.push(Y[z]+D,Y[z+1]+D,Y[z+2]+D)}}}var J=new l;J.particles=f;J.numParticles=m;m=_.length;for(R=0;R<m;R++){j=_[R];j.autoDeriveNormals=false;j.autoDeriveTangents=false;j.setIndices(h[R]);j.setPositions(d[R]);j.setNormals(p[R]);j.setTangents(u[R]);j.setUVs(c[R]);J.addSubGeometry(j)}return J};e.MAX_VERTEX=65535;return e}();t.exports=h},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-renderergl/lib/animators/data/ParticleData":"awayjs-renderergl/lib/animators/data/ParticleData","awayjs-renderergl/lib/base/ParticleGeometry":"awayjs-renderergl/lib/base/ParticleGeometry"}],"awayjs-renderergl/lib/utils/PerspectiveMatrix3D":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-core/lib/geom/Matrix3D");var s=function(e){i(t,e);function t(t){if(t===void 0){t=null}e.call(this,t)}t.prototype.perspectiveFieldOfViewLH=function(e,t,r,i){var a=1/Math.tan(e/2);var s=a/t;this.rawData[0]=s;this.rawData[1]=0;this.rawData[2]=0;this.rawData[3]=0;this.rawData[4]=0;this.rawData[5]=a;this.rawData[6]=0;this.rawData[7]=0;this.rawData[8]=0;this.rawData[9]=0;this.rawData[10]=i/(i-r);this.rawData[11]=1;this.rawData[12]=0;this.rawData[13]=0;this.rawData[14]=r*i/(r-i);this.rawData[15]=0};return t}(a);t.exports=s},{"awayjs-core/lib/geom/Matrix3D":undefined}],"awayjs-renderergl/lib/vos/CurveSubGeometryVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var s=e("awayjs-display/lib/base/CurveSubGeometry");var n=e("awayjs-renderergl/lib/vos/SubGeometryVOBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._curveSubGeometry=r;this.invalidateVertices(this._curveSubGeometry.positions);this.invalidateVertices(this._curveSubGeometry.curves);this.invalidateVertices(this._curveSubGeometry.uvs)}t.prototype._render=function(t,r){if(t.uvBufferIndex>=0)this.activateVertexBufferVO(t.uvBufferIndex,this._curveSubGeometry.uvs,r);this.activateVertexBufferVO(0,this._curveSubGeometry.positions,r);this.activateVertexBufferVO(1,this._curveSubGeometry.curves,r);e.prototype._render.call(this,t,r)};t.prototype._drawElements=function(e,t,r){this.getIndexBufferVO(r).draw(a.TRIANGLES,e,t)};t.prototype._drawArrays=function(e,t,r){r.context.drawVertices(a.TRIANGLES,e,t)};t.prototype._pGetOverflowSubGeometry=function(){return new t(this._pool,this._curveSubGeometry)};t.assetClass=s;return t}(n);t.exports=o},{"awayjs-display/lib/base/CurveSubGeometry":undefined,"awayjs-renderergl/lib/vos/SubGeometryVOBase":"awayjs-renderergl/lib/vos/SubGeometryVOBase","awayjs-stagegl/lib/base/ContextGLDrawMode":undefined}],"awayjs-renderergl/lib/vos/ISubGeometryVOClass":[function(e,t,r){},{}],"awayjs-renderergl/lib/vos/ITextureVOClass":[function(e,t,r){},{}],"awayjs-renderergl/lib/vos/LineSubGeometryVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var s=e("awayjs-display/lib/base/LineSubGeometry");var n=e("awayjs-renderergl/lib/vos/SubGeometryVOBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._lineSubGeometry=r;this.invalidateVertices(this._lineSubGeometry.positions);this.invalidateVertices(this._lineSubGeometry.thickness);this.invalidateVertices(this._lineSubGeometry.colors)}t.prototype._render=function(t,r){if(t.colorBufferIndex>=0)this.activateVertexBufferVO(t.colorBufferIndex,this._lineSubGeometry.colors,r);this.activateVertexBufferVO(0,this._lineSubGeometry.positions,r,3);this.activateVertexBufferVO(1,this._lineSubGeometry.positions,r,3,12);this.activateVertexBufferVO(2,this._lineSubGeometry.thickness,r);e.prototype._render.call(this,t,r)};t.prototype._drawElements=function(e,t,r){this.getIndexBufferVO(r).draw(a.TRIANGLES,0,t)};t.prototype._drawArrays=function(e,t,r){r.context.drawVertices(a.TRIANGLES,e,t)};t.prototype._pGetOverflowSubGeometry=function(){return new t(this._pool,this._lineSubGeometry)};t.assetClass=s;return t}(n);t.exports=o},{"awayjs-display/lib/base/LineSubGeometry":undefined,"awayjs-renderergl/lib/vos/SubGeometryVOBase":"awayjs-renderergl/lib/vos/SubGeometryVOBase","awayjs-stagegl/lib/base/ContextGLDrawMode":undefined}],"awayjs-renderergl/lib/vos/Sampler2DVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/vos/SamplerVOBase");var s=function(e){i(t,e);function t(t){e.call(this,t)}t.prototype.initProperties=function(e,t){this.sampler2D=e;this.samplerReg=t.getFreeTextureReg();this.samplerIndex=this.samplerReg.index;if(this.sampler2D.imageRect){this.fragmentReg=t.getFreeFragmentConstant();this.fragmentIndex=this.fragmentReg.index*4}};t.prototype.getFragmentCode=function(e,t,r,i){var a="";var s=e.repeatTextures?"wrap":"clamp";var n=this.getFormatString(this.sampler2D);var o=e.useSmoothTextures?e.useMipmapping?"linear,miplinear":"linear":e.useMipmapping?"nearest,mipnearest":"nearest";var l;if(this.sampler2D.imageRect){l=r.getFreeFragmentVectorTemp();a+="mul "+l+", "+i+", "+this.fragmentReg+".xy\n";a+="add "+l+", "+l+", "+this.fragmentReg+".zw\n"}else{l=i}a+="tex "+t+", "+l+", "+this.samplerReg+" <2d,"+o+","+n+s+">\n";return a};t.prototype.activate=function(e){this._stage.getImageObject(this.sampler2D.image2D).activate(this.samplerIndex,this.sampler2D.repeat||e.repeatTextures,this.sampler2D.smooth||e.useSmoothTextures,this.sampler2D.mipmap||e.useMipmapping);if(this.sampler2D.imageRect){var t=this.fragmentIndex;var r=e.fragmentConstantData;r[t]=this.sampler2D.scaleX;r[t+1]=this.sampler2D.scaleY;r[t+2]=this.sampler2D.offsetX;r[t+3]=this.sampler2D.offsetY}};return t}(a);t.exports=s},{"awayjs-renderergl/lib/vos/SamplerVOBase":"awayjs-renderergl/lib/vos/SamplerVOBase"}],"awayjs-renderergl/lib/vos/SamplerCubeVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-renderergl/lib/vos/SamplerVOBase");var s=function(e){i(t,e);function t(t){e.call(this,t)}t.prototype.initProperties=function(e,t){this.samplerCube=e;this.samplerReg=t.getFreeTextureReg();this.samplerIndex=this.samplerReg.index};t.prototype.getFragmentCode=function(e,t,r,i){var a;var s=this.getFormatString(this.samplerCube);var a=e.useSmoothTextures?e.useMipmapping?"linear,miplinear":"linear":e.useMipmapping?"nearest,mipnearest":"nearest";return"tex "+t+", "+i+", "+this.samplerReg+" <cube,"+s+a+">\n"};t.prototype.activate=function(e){this._stage.getImageObject(this.samplerCube.imageCube).activate(this.samplerIndex,false,this.samplerCube.smooth||e.useSmoothTextures,this.samplerCube.mipmap||e.useMipmapping)};return t}(a);t.exports=s},{"awayjs-renderergl/lib/vos/SamplerVOBase":"awayjs-renderergl/lib/vos/SamplerVOBase"}],"awayjs-renderergl/lib/vos/SamplerVOBase":[function(e,t,r){var i=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var a=function(){function e(e){this._stage=e}e.prototype.getFormatString=function(e){switch(e.format){case i.COMPRESSED:return"dxt1,";break;case i.COMPRESSED_ALPHA:return"dxt5,";break;default:return""}};return e}();t.exports=a},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":undefined}],"awayjs-renderergl/lib/vos/Single2DTextureVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/textures/Single2DTexture");var s=e("awayjs-renderergl/lib/vos/TextureVOBase");var n=e("awayjs-renderergl/lib/vos/Sampler2DVO");var o=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,i);this._single2DTexture=r;this._sampler2DVO=new n(i)}t.prototype._iInitRegisters=function(e,t){this._sampler2DVO.initProperties(this._single2DTexture.sampler2D,t)};t.prototype._iGetFragmentCode=function(e,t,r,i){return this._sampler2DVO.getFragmentCode(e,t,r,i)};t.prototype.activate=function(e){this._sampler2DVO.activate(e)};t.assetClass=a;return t}(s);t.exports=o},{"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-renderergl/lib/vos/Sampler2DVO":"awayjs-renderergl/lib/vos/Sampler2DVO","awayjs-renderergl/lib/vos/TextureVOBase":"awayjs-renderergl/lib/vos/TextureVOBase"}],"awayjs-renderergl/lib/vos/SingleCubeTextureVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-display/lib/textures/SingleCubeTexture");var s=e("awayjs-renderergl/lib/vos/TextureVOBase");var n=e("awayjs-renderergl/lib/vos/SamplerCubeVO");var o=function(e){i(t,e);function t(t,r,i){e.call(this,t,r,i);this._singleCubeTexture=r;this._samplerCubeVO=new n(i)}t.prototype._iIncludeDependencies=function(e,t){if(t===void 0){t=true}if(t)e.usesLocalPosFragment=true};t.prototype._iInitRegisters=function(e,t){this._samplerCubeVO.initProperties(this._singleCubeTexture.samplerCube,t)};t.prototype._iGetFragmentCode=function(e,t,r,i){return this._samplerCubeVO.getFragmentCode(e,t,r,i)};t.prototype.activate=function(e){this._samplerCubeVO.activate(e)};t.assetClass=a;return t}(s);t.exports=o},{"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-renderergl/lib/vos/SamplerCubeVO":"awayjs-renderergl/lib/vos/SamplerCubeVO","awayjs-renderergl/lib/vos/TextureVOBase":"awayjs-renderergl/lib/vos/TextureVOBase"}],"awayjs-renderergl/lib/vos/SubGeometryVOBase":[function(e,t,r){var i=e("awayjs-core/lib/errors/AbstractMethodError");var a=e("awayjs-display/lib/events/SubGeometryEvent");var s=e("awayjs-display/lib/utils/SubGeometryUtils");var n=function(){function e(e,t){var r=this;this._vertices=new Object;this._verticesDirty=new Object;this._indexMappings=Array();this._pool=e;this._subGeometry=t;this._onIndicesUpdatedDelegate=function(e){return r._onIndicesUpdated(e)};this._onIndicesDisposedDelegate=function(e){return r._onIndicesDisposed(e)};this._onVerticesUpdatedDelegate=function(e){return r._onVerticesUpdated(e)};this._onVerticesDisposedDelegate=function(e){return r._onVerticesDisposed(e)};this._subGeometry.addEventListener(a.INDICES_DISPOSED,this._onIndicesDisposedDelegate);this._subGeometry.addEventListener(a.INDICES_UPDATED,this._onIndicesUpdatedDelegate);this._subGeometry.addEventListener(a.VERTICES_DISPOSED,this._onVerticesDisposedDelegate);this._subGeometry.addEventListener(a.VERTICES_UPDATED,this._onVerticesUpdatedDelegate);this.invalidateIndices()}Object.defineProperty(e.prototype,"subGeometry",{get:function(){return this._subGeometry},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"indexMappings",{get:function(){if(this._indicesDirty)this._updateIndices();return this._indexMappings},enumerable:true,configurable:true});e.prototype.getIndexBufferVO=function(e){if(this._indicesDirty)this._updateIndices();return e.getAttributesBufferVO(this._indices)};e.prototype.getVertexBufferVO=function(e,t){var r=e.buffer.id;if(this._indicesDirty)this._updateIndices();if(this._verticesDirty[r])this._updateVertices(e);return t.getAttributesBufferVO(this._vertices[r])};e.prototype.activateVertexBufferVO=function(e,t,r,i,a){if(i===void 0){i=0}if(a===void 0){a=0}this.getVertexBufferVO(t,r).activate(e,t.size,i||t.dimensions,t.offset+a)};e.prototype.invalidateIndices=function(){if(!this._subGeometry.indices)return;this._indicesDirty=true};e.prototype.disposeIndices=function(){if(this._indices){this._indices.dispose();this._indices=null}};e.prototype.invalidateVertices=function(e){if(!e)return;var t=e.buffer.id;this._verticesDirty[t]=true};e.prototype.disposeVertices=function(e){if(!e)return;var t=e.buffer.id;this._vertices[t].dispose();this._vertices[t]=null};e.prototype.dispose=function(){this._pool.disposeItem(this._subGeometry);this.disposeIndices();if(this._overflow){this._overflow.dispose();this._overflow=null}};e.prototype.invalidate=function(){this.invalid=true};e.prototype._iGetFragmentCode=function(e,t,r,a){if(a===void 0){a=null}throw new i};e.prototype._iRender=function(e,t){if(this._indicesDirty)this._updateIndices();this._render(e,t);if(this._overflow)this._overflow._iRender(e,t)};e.prototype._render=function(e,t){if(this._indices)this._drawElements(0,this._numIndices,t);else this._drawArrays(0,this._numVertices,t)};e.prototype._drawElements=function(e,t,r){throw new i};e.prototype._drawArrays=function(e,t,r){throw new i};e.prototype._updateIndices=function(e){if(e===void 0){e=0}this._indices=s.getSubIndices(this._subGeometry.indices,this._subGeometry.numVertices,this._indexMappings,e);this._numIndices=this._indices.count*this._subGeometry.indices.dimensions;e+=this._numIndices;if(e<this._subGeometry.indices.count*this._subGeometry.indices.dimensions){if(!this._overflow)this._overflow=this._pGetOverflowSubGeometry();this._overflow._updateIndices(e)}else if(this._overflow){this._overflow.dispose();this._overflow=null}this._indicesDirty=false;if(this._indexMappings.length)for(var t in this._verticesDirty)this._verticesDirty[t]=true};e.prototype._updateVertices=function(e){this._numVertices=e.count;var t=e.buffer.id;this._vertices[t]=s.getSubVertices(e.buffer,this._indexMappings);this._verticesDirty[t]=false};e.prototype._onIndicesUpdated=function(e){this.invalidateIndices()};e.prototype._onIndicesDisposed=function(e){this.disposeIndices()};e.prototype._onVerticesUpdated=function(e){this.invalidateVertices(e.attributesView)};e.prototype._onVerticesDisposed=function(e){this.disposeVertices(e.attributesView)};e.prototype._pGetOverflowSubGeometry=function(){throw new i};return e}();t.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/events/SubGeometryEvent":undefined,"awayjs-display/lib/utils/SubGeometryUtils":undefined}],"awayjs-renderergl/lib/vos/SubGeometryVOPool":[function(e,t,r){var i=e("awayjs-renderergl/lib/vos/TriangleSubGeometryVO");var a=e("awayjs-renderergl/lib/vos/LineSubGeometryVO");var s=e("awayjs-renderergl/lib/vos/CurveSubGeometryVO");var n=function(){function e(){this._pool=new Object}e.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddSubGeometryVO(new(e.getClass(t))(this,t)))};e.prototype.disposeItem=function(e){e._iRemoveSubGeometryVO(this._pool[e.id]);this._pool[e.id]=null};e.getPool=function(){return e._pool||(e._pool=new e)};e.registerClass=function(t){e.classPool[t.assetClass.assetType]=t};e.getClass=function(t){return e.classPool[t.assetType]};e.addDefaults=function(){e.registerClass(s);e.registerClass(a);e.registerClass(i)};e.classPool=new Object;e.main=e.addDefaults();return e}();t.exports=n},{"awayjs-renderergl/lib/vos/CurveSubGeometryVO":"awayjs-renderergl/lib/vos/CurveSubGeometryVO","awayjs-renderergl/lib/vos/LineSubGeometryVO":"awayjs-renderergl/lib/vos/LineSubGeometryVO","awayjs-renderergl/lib/vos/TriangleSubGeometryVO":"awayjs-renderergl/lib/vos/TriangleSubGeometryVO"}],"awayjs-renderergl/lib/vos/TextureVOBase":[function(e,t,r){var i=e("awayjs-core/lib/errors/AbstractMethodError");var a=function(){function e(e,t,r){this._pool=e;this._texture=t;this._stage=r}e.prototype._iInitRegisters=function(e,t){};e.prototype.dispose=function(){this._pool.disposeItem(this._texture)};e.prototype.invalidate=function(){this.invalid=true};e.prototype._iGetFragmentCode=function(e,t,r,a){if(a===void 0){a=null}throw new i};e.prototype.activate=function(e){throw new i};return e}();t.exports=a},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-renderergl/lib/vos/TextureVOPool":[function(e,t,r){var i=e("awayjs-renderergl/lib/vos/Single2DTextureVO");var a=e("awayjs-renderergl/lib/vos/SingleCubeTextureVO");var s=function(){function e(e){this._pool=new Object;this._stage=e}e.prototype.getItem=function(t){return this._pool[t.id]||(this._pool[t.id]=t._iAddTextureVO(new(e.getClass(t))(this,t,this._stage)))};e.prototype.disposeItem=function(e){e._iRemoveTextureVO(this._pool[e.id]);this._pool[e.id]=null};e.prototype.dispose=function(){for(var e in this._pool)this._pool[e].dispose()};e.registerClass=function(t){e.classPool[t.assetClass.assetType]=t};e.getClass=function(t){return e.classPool[t.assetType]};e.addDefaults=function(){e.registerClass(i);e.registerClass(a)};e.classPool=new Object;e.main=e.addDefaults();return e}();t.exports=s},{"awayjs-renderergl/lib/vos/Single2DTextureVO":"awayjs-renderergl/lib/vos/Single2DTextureVO","awayjs-renderergl/lib/vos/SingleCubeTextureVO":"awayjs-renderergl/lib/vos/SingleCubeTextureVO"}],"awayjs-renderergl/lib/vos/TriangleSubGeometryVO":[function(e,t,r){var i=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function i(){this.constructor=e}i.prototype=t.prototype;e.prototype=new i};var a=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var s=e("awayjs-display/lib/base/TriangleSubGeometry");var n=e("awayjs-renderergl/lib/vos/SubGeometryVOBase");var o=function(e){i(t,e);function t(t,r){e.call(this,t,r);this._triangleSubGeometry=r;this.invalidateVertices(this._triangleSubGeometry.positions);this.invalidateVertices(this._triangleSubGeometry.normals);this.invalidateVertices(this._triangleSubGeometry.tangents);this.invalidateVertices(this._triangleSubGeometry.uvs);this.invalidateVertices(this._triangleSubGeometry.secondaryUVs);this.invalidateVertices(this._triangleSubGeometry.jointIndices);this.invalidateVertices(this._triangleSubGeometry.jointWeights)}t.prototype._render=function(t,r){if(t.uvBufferIndex>=0)this.activateVertexBufferVO(t.uvBufferIndex,this._triangleSubGeometry.uvs,r);if(t.secondaryUVBufferIndex>=0)this.activateVertexBufferVO(t.secondaryUVBufferIndex,this._triangleSubGeometry.secondaryUVs,r);if(t.normalBufferIndex>=0)this.activateVertexBufferVO(t.normalBufferIndex,this._triangleSubGeometry.normals,r);if(t.tangentBufferIndex>=0)this.activateVertexBufferVO(t.tangentBufferIndex,this._triangleSubGeometry.tangents,r);if(t.jointIndexIndex>=0)this.activateVertexBufferVO(t.jointIndexIndex,this._triangleSubGeometry.jointIndices,r);if(t.jointWeightIndex>=0)this.activateVertexBufferVO(t.jointIndexIndex,this._triangleSubGeometry.jointWeights,r);this.activateVertexBufferVO(0,this._triangleSubGeometry.positions,r);e.prototype._render.call(this,t,r)};t.prototype._drawElements=function(e,t,r){this.getIndexBufferVO(r).draw(a.TRIANGLES,0,t)};t.prototype._drawArrays=function(e,t,r){r.context.drawVertices(a.TRIANGLES,e,t)};t.prototype._pGetOverflowSubGeometry=function(){return new t(this._pool,this._triangleSubGeometry)
};t.assetClass=s;return t}(n);t.exports=o},{"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-renderergl/lib/vos/SubGeometryVOBase":"awayjs-renderergl/lib/vos/SubGeometryVOBase","awayjs-stagegl/lib/base/ContextGLDrawMode":undefined}]},{},[]);


require=function t(e,i,r){function a(n,s){if(!i[n]){if(!e[n]){var h=typeof require=="function"&&require;if(!s&&h)return h(n,!0);if(o)return o(n,!0);var d=new Error("Cannot find module '"+n+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[n]={exports:{}};e[n][0].call(u.exports,function(t){var i=e[n][1][t];return a(i?i:t)},u,u.exports,t,e,i,r)}return i[n].exports}var o=typeof require=="function"&&require;for(var n=0;n<r.length;n++)a(r[n]);return a}({"awayjs-methodmaterials/lib/MethodMaterialMode":[function(t,e,i){var r=function(){function t(){}t.SINGLE_PASS="singlePass";t.MULTI_PASS="multiPass";return t}();e.exports=r},{}],"awayjs-methodmaterials/lib/MethodMaterial":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/Image2D");var o=t("awayjs-display/lib/materials/MaterialBase");var n=t("awayjs-display/lib/textures/Single2DTexture");var s=t("awayjs-display/lib/textures/TextureBase");var h=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var d=t("awayjs-renderergl/lib/render/RenderPool");var u=t("awayjs-methodmaterials/lib/MethodMaterialMode");var p=t("awayjs-methodmaterials/lib/methods/AmbientBasicMethod");var l=t("awayjs-methodmaterials/lib/methods/DiffuseBasicMethod");var m=t("awayjs-methodmaterials/lib/methods/NormalBasicMethod");var c=t("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var f=t("awayjs-methodmaterials/lib/render/MethodMaterialRender");var g=function(t){r(e,t);function e(e,i,r,o){if(e===void 0){e=null}if(i===void 0){i=null}if(r===void 0){r=false}if(o===void 0){o=true}t.call(this);this._effectMethods=new Array;this._ambientMethod=new p;this._diffuseMethod=new l;this._normalMethod=new m;this._specularMethod=new c;this._depthCompareMode=h.LESS_EQUAL;this._mode=u.SINGLE_PASS;if(e instanceof a)e=new n(e);if(e instanceof s){this.texture=e;this.smooth=i==null?true:false;this.repeat=r;this.mipmap=o}else{this.color=e==null?16777215:Number(e);this.alpha=i==null?1:Number(i)}}e.addRenderable=function(){d.registerClass(f,e)};Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){if(this._mode==t)return;this._mode=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"depthCompareMode",{get:function(){return this._depthCompareMode},set:function(t){if(this._depthCompareMode==t)return;this._depthCompareMode=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseTexture",{get:function(){return this._diffuseMethod.texture},set:function(t){this._diffuseMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._ambientMethod},set:function(t){if(this._ambientMethod==t)return;if(t&&this._ambientMethod)t.copyFrom(this._ambientMethod);this._ambientMethod=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._shadowMethod},set:function(t){if(this._shadowMethod==t)return;if(t&&this._shadowMethod)t.copyFrom(this._shadowMethod);this._shadowMethod=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._diffuseMethod},set:function(t){if(this._diffuseMethod==t)return;if(t&&this._diffuseMethod)t.copyFrom(this._diffuseMethod);this._diffuseMethod=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._specularMethod},set:function(t){if(this._specularMethod==t)return;if(t&&this._specularMethod)t.copyFrom(this._specularMethod);this._specularMethod=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._normalMethod},set:function(t){if(this._normalMethod==t)return;if(t&&this._normalMethod)t.copyFrom(this._normalMethod);this._normalMethod=t;this._pInvalidateRender()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._effectMethods.length},enumerable:true,configurable:true});e.prototype.addEffectMethod=function(t){this._effectMethods.push(t);this._pInvalidateRender()};e.prototype.getEffectMethodAt=function(t){return this._effectMethods[t]};e.prototype.addEffectMethodAt=function(t,e){this._effectMethods.splice(e,0,t);this._pInvalidateRender()};e.prototype.removeEffectMethod=function(t){this._effectMethods.splice(this._effectMethods.indexOf(t),1);this._pInvalidateRender()};Object.defineProperty(e.prototype,"normalMap",{get:function(){return this._normalMethod.normalMap},set:function(t){this._normalMethod.normalMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMethod.texture},set:function(t){this._specularMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"gloss",{get:function(){return this._specularMethod.gloss},set:function(t){this._specularMethod.gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambientMethod.ambient},set:function(t){this._ambientMethod.ambient=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._specularMethod.specular},set:function(t){this._specularMethod.specular=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._diffuseMethod.ambientColor},set:function(t){this._diffuseMethod.ambientColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this._diffuseMethod.diffuseColor},set:function(t){this._diffuseMethod.diffuseColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularColor",{get:function(){return this._specularMethod.specularColor},set:function(t){this._specularMethod.specularColor=t},enumerable:true,configurable:true});e.assetType="[materials MethodMaterial]";e.register=e.addRenderable();return e}(o);e.exports=g},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-display/lib/materials/MaterialBase":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/TextureBase":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":"awayjs-methodmaterials/lib/MethodMaterialMode","awayjs-methodmaterials/lib/methods/AmbientBasicMethod":"awayjs-methodmaterials/lib/methods/AmbientBasicMethod","awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod","awayjs-methodmaterials/lib/methods/NormalBasicMethod":"awayjs-methodmaterials/lib/methods/NormalBasicMethod","awayjs-methodmaterials/lib/methods/SpecularBasicMethod":"awayjs-methodmaterials/lib/methods/SpecularBasicMethod","awayjs-methodmaterials/lib/render/MethodMaterialRender":"awayjs-methodmaterials/lib/render/MethodMaterialRender","awayjs-renderergl/lib/render/RenderPool":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined}],"awayjs-methodmaterials/lib/data/MethodVO":[function(t,e,i){var r=function(){function t(t){this.useMethod=true;this.method=t}t.prototype.reset=function(){this.method.iReset();this.vertexConstantsIndex=-1;this.secondaryVertexConstantsIndex=-1;this.fragmentConstantsIndex=-1;this.secondaryFragmentConstantsIndex=-1;this.needsProjection=false;this.needsView=false;this.needsNormals=false;this.needsTangents=false;this.needsGlobalVertexPos=false;this.needsGlobalFragmentPos=false};return t}();e.exports=r},{}],"awayjs-methodmaterials/lib/methods/AmbientBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._alpha=1;this._colorR=1;this._colorG=1;this._colorB=1;this._ambient=1}e.prototype.iInitVO=function(t,e){if(t.texture)t.uvDependencies++};e.prototype.iInitConstants=function(t,e){if(!t.texture){this._color=t.color;this.updateColor()}};Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(this._ambient==t)return;this._ambient=t;this.updateColor()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(this._alpha==t)return;this._alpha=t;this.updateColor()},enumerable:true,configurable:true});e.prototype.copyFrom=function(t){var e=t;var i=e};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";if(t.texture){t.texture._iInitRegisters(t,r);o+=t.texture._iGetFragmentCode(t,i,r,a.uvVarying);if(t.alphaThreshold>0){var n=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;o+="sub "+i+".w, "+i+".w, "+n+".x\n"+"kil "+i+".w\n"+"add "+i+".w, "+i+".w, "+n+".x\n"}}else{var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=s.index*4;o+="mov "+i+", "+s+"\n"}return o};e.prototype.iActivate=function(t,e,i){if(t.texture){t.texture.activate(t);if(t.alphaThreshold>0)t.fragmentConstantData[e.fragmentConstantsIndex]=t.alphaThreshold}else{var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._colorR;a[r+1]=this._colorG;a[r+2]=this._colorB;a[r+3]=this._alpha}};e.prototype.updateColor=function(){this._colorR=(this._color>>16&255)/255*this._ambient;this._colorG=(this._color>>8&255)/255*this._ambient;this._colorB=(this._color&255)/255*this._ambient};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/AmbientBasicMethod");var o=function(t){r(e,t);function e(){t.call(this)}e.prototype.iInitVO=function(t,e){e.needsNormals=true};e.prototype.iGetFragmentCode=function(t,e,i,r,a){t.texture._iInitRegisters(t,r);return t.texture._iGetFragmentCode(t,i,r,a.normalFragment)};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/AmbientBasicMethod":"awayjs-methodmaterials/lib/methods/AmbientBasicMethod"}],"awayjs-methodmaterials/lib/methods/CurveBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(){t.call(this);this._color=16777215;this._alpha=1;this._colorR=1;this._colorG=1;this._colorB=1;this._ambient=1}e.prototype.iInitVO=function(t,e){if(t.texture)t.uvDependencies++};e.prototype.iInitConstants=function(t,e){if(!t.texture){this._color=t.color;this.updateColor()}};Object.defineProperty(e.prototype,"ambient",{get:function(){return this._ambient},set:function(t){if(this._ambient==t)return;this._ambient=t;this.updateColor()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(this._alpha==t)return;this._alpha=t;this.updateColor()},enumerable:true,configurable:true});e.prototype.copyFrom=function(t){var e=t;var i=e};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";var n;if(t.texture){t.texture._iInitRegisters(t,r);o+=t.texture._iGetFragmentCode(t,i,r,a.uvVarying);if(t.alphaThreshold>0){var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=s.index*4;o+="sub "+i+".w, "+i+".w, "+s+".x\n"+"kil "+i+".w\n"+"add "+i+".w, "+i+".w, "+s+".x\n"}}else{n=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;o+="mov "+i+", "+n+"\n"}o="mov "+i+", "+a.uvVarying+"\n";return o};e.prototype.iActivate=function(t,e,i){if(t.texture){t.texture.activate(t);if(t.alphaThreshold>0)t.fragmentConstantData[e.fragmentConstantsIndex]=t.alphaThreshold}else{var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._colorR;a[r+1]=this._colorG;a[r+2]=this._colorB;a[r+3]=this._alpha}};e.prototype.updateColor=function(){this._colorR=(this._color>>16&255)/255*this._ambient;this._colorG=(this._color>>8&255)/255*this._ambient;this._colorB=(this._color&255)/255*this._ambient};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/LightingMethodBase");var o=function(t){r(e,t);function e(){t.call(this);this._multiply=true;this._diffuseColor=16777215;this._ambientColor=16777215;this._diffuseR=1;this._diffuseG=1;this._diffuseB=1;this._ambientR=1;this._ambientG=1;this._ambientB=1}e.prototype.iIsUsed=function(t){if(!t.numLights)return false;return true};Object.defineProperty(e.prototype,"multiply",{get:function(){return this._multiply},set:function(t){if(this._multiply==t)return;this._multiply=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){if(this._texture){e.textureVO=t.getTextureVO(this._texture);t.uvDependencies++}else if(e.textureVO){e.textureVO.dispose();e.textureVO=null}if(t.numLights>0){t.usesCommonData=true;e.needsNormals=true}};Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this._diffuseColor},set:function(t){if(this._diffuseColor==t)return;this._diffuseColor=t;this.updateDiffuse()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this._ambientColor},set:function(t){if(this._ambientColor==t)return;this._ambientColor=t;this.updateAmbient()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(this._texture==t)return;this._texture=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.dispose=function(){this._texture=null};e.prototype.copyFrom=function(t){var e=t;this.texture=e.texture;this.multiply=e.multiply;this.diffuseColor=e.diffuseColor;this.ambientColor=e.ambientColor};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pTotalLightColorReg=null};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){var a="";this._pIsFirstLight=true;i.addFragmentTempUsages(this._pTotalLightColorReg=i.getFreeFragmentVectorTemp(),1);return a};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}n+="dp3 "+s+".x, "+i+", "+o.normalFragment+"\n"+"max "+s+".w, "+s+".x, "+o.commons+".y\n";if(t.usesLightFallOff)n+="mul "+s+".w, "+s+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);n+="mul "+s+", "+s+".w, "+r+"\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+s+"\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}n+="tex "+s+", "+o.normalFragment+", "+i+" <cube,linear,miplinear>\n"+"mul "+s+".xyz, "+s+".xyz, "+r+"\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+s+"\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var o="";var n;var s;if(a.shadowTarget)o+=this.pApplyShadow(t,e,r,a);r.addFragmentTempUsages(n=r.getFreeFragmentVectorTemp(),1);var h=r.getFreeFragmentConstant();e.fragmentConstantsIndex=h.index*4;if(this._texture){e.textureVO._iInitRegisters(t,r);o+=e.textureVO._iGetFragmentCode(t,n,r,a.uvVarying)}else{var d=r.getFreeFragmentConstant();o+="mov "+n+", "+d+"\n"}o+="sat "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+"\n"+"mul "+n+".xyz, "+n+", "+this._pTotalLightColorReg+"\n";if(this._multiply){o+="add "+n+".xyz, "+n+", "+h+"\n"+"mul "+i+".xyz, "+i+", "+n+"\n"}else{o+="mul "+i+".xyz, "+i+", "+h+"\n"+"mul "+this._pTotalLightColorReg+".xyz, "+i+", "+this._pTotalLightColorReg+"\n"+"sub "+i+".xyz, "+i+", "+this._pTotalLightColorReg+"\n"+"add "+i+".xyz, "+i+", "+n+"\n"}r.removeFragmentTempUsage(this._pTotalLightColorReg);r.removeFragmentTempUsage(n);return o};e.prototype.pApplyShadow=function(t,e,i,r){return"mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+r.shadowTarget+".w\n"};e.prototype.iActivate=function(t,e,i){if(this._texture){e.textureVO.activate(t)}else{var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r+4]=this._diffuseR;a[r+5]=this._diffuseG;a[r+6]=this._diffuseB;a[r+7]=1}};e.prototype.updateDiffuse=function(){this._diffuseR=(this._diffuseColor>>16&255)/255;this._diffuseG=(this._diffuseColor>>8&255)/255;this._diffuseB=(this._diffuseColor&255)/255};e.prototype.updateAmbient=function(){this._ambientR=(this._ambientColor>>16&255)/255;this._ambientG=(this._ambientColor>>8&255)/255;this._ambientB=(this._ambientColor&255)/255};e.prototype.iSetRenderState=function(t,e,i,r,a){if(t.numLights>0){var o=e.fragmentConstantsIndex;var n=t.fragmentConstantData;n[o]=t.ambientR*this._ambientR;n[o+1]=t.ambientG*this._ambientG;n[o+2]=t.ambientB*this._ambientB;n[o+3]=1}};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/LightingMethodBase":"awayjs-methodmaterials/lib/methods/LightingMethodBase"}],"awayjs-methodmaterials/lib/methods/DiffuseCelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod");var o=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=3}if(i===void 0){i=null}t.call(this,null,i);this._smoothness=.1;this.baseMethod._iModulateMethod=function(t,e,i,a,o){return r.clampDiffuse(t,e,i,a,o)};this._levels=e}e.prototype.iInitConstants=function(e,i){var r=e.fragmentConstantData;var a=i.secondaryFragmentConstantsIndex;t.prototype.iInitConstants.call(this,e,i);r[a+1]=1;r[a+2]=0};Object.defineProperty(e.prototype,"levels",{get:function(){return this._levels},set:function(t){this._levels=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var o=i.secondaryFragmentConstantsIndex;a[o]=this._levels;a[o+3]=this._smoothness};e.prototype.clampDiffuse=function(t,e,i,r,a){return"mul "+i+".w, "+i+".w, "+this._dataReg+".x\n"+"frc "+i+".z, "+i+".w\n"+"sub "+i+".y, "+i+".w, "+i+".z\n"+"mov "+i+".x, "+this._dataReg+".x\n"+"sub "+i+".x, "+i+".x, "+this._dataReg+".y\n"+"rcp "+i+".x,"+i+".x\n"+"mul "+i+".w, "+i+".y, "+i+".x\n"+"sub "+i+".y, "+i+".w, "+i+".x\n"+"div "+i+".z, "+i+".z, "+this._dataReg+".w\n"+"sat "+i+".z, "+i+".z\n"+"mul "+i+".w, "+i+".w, "+i+".z\n"+"sub "+i+".z, "+this._dataReg+".y, "+i+".z\n"+"mul "+i+".y, "+i+".y, "+i+".z\n"+"add "+i+".w, "+i+".w, "+i+".y\n"+"sat "+i+".w, "+i+".w\n"};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod":"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod"}],"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var o=t("awayjs-methodmaterials/lib/methods/DiffuseBasicMethod");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this.pBaseMethod=i||new o;this.pBaseMethod._iModulateMethod=e;this.pBaseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this.pBaseMethod},set:function(t){if(this.pBaseMethod==t)return;this.pBaseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.pBaseMethod=t;this.pBaseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){this.pBaseMethod.iInitVO(t,e)};e.prototype.iInitConstants=function(t,e){this.pBaseMethod.iInitConstants(t,e)};e.prototype.dispose=function(){this.pBaseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.pBaseMethod.dispose()};Object.defineProperty(e.prototype,"texture",{get:function(){return this.pBaseMethod.texture},set:function(t){this.pBaseMethod.texture=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseColor",{get:function(){return this.pBaseMethod.diffuseColor},set:function(t){this.pBaseMethod.diffuseColor=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientColor",{get:function(){return this.pBaseMethod.ambientColor},set:function(t){this.pBaseMethod.ambientColor=t},enumerable:true,configurable:true});e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return this.pBaseMethod.iGetFragmentPreLightingCode(t,e,i,r)};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n=this.pBaseMethod.iGetFragmentCodePerLight(t,e,i,r,a,o);this._pTotalLightColorReg=this.pBaseMethod._pTotalLightColorReg;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,o){var n=this.pBaseMethod.iGetFragmentCodePerProbe(t,e,i,r,a,o);this._pTotalLightColorReg=this.pBaseMethod._pTotalLightColorReg;return n};e.prototype.iActivate=function(t,e,i){this.pBaseMethod.iActivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){this.pBaseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iDeactivate=function(t,e,i){this.pBaseMethod.iDeactivate(t,e,i)};e.prototype.iGetVertexCode=function(t,e,i,r){return this.pBaseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return this.pBaseMethod.iGetFragmentPostLightingCode(t,e,i,r,a)};e.prototype.iReset=function(){this.pBaseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this.pBaseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(o);e.exports=n},{"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod","awayjs-renderergl/lib/events/ShadingMethodEvent":undefined}],"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseBasicMethod");var o=function(t){r(e,t);function e(){t.call(this)}e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=e.fragmentConstantsIndex;i[r]=1;i[r+1]=1/255;i[r+2]=1/65025;i[r+3]=1/16581375};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var o="";var n;var s;if(!this._texture)throw new Error("DiffuseDepthMethod requires texture!");if(t.numLights>0){if(a.shadowTarget)o+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+a.shadowTarget+".w\n";o+="add "+i+".xyz, "+this._pTotalLightColorReg+".xyz, "+i+".xyz\n"+"sat "+i+".xyz, "+i+".xyz\n";r.removeFragmentTempUsage(this._pTotalLightColorReg);r.addFragmentTempUsages(n=r.getFreeFragmentVectorTemp(),1)}else{n=i}s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=s.index*4;e.textureVO._iInitRegisters(t,r);o+=e.textureVO._iGetFragmentCode(t,n,r,a.uvVarying)+"dp4 "+n+".x, "+n+", "+s+"\n"+"mov "+n+".yz, "+n+".xx			\n"+"mov "+n+".w, "+s+".x\n"+"sub "+n+".xyz, "+s+".xxx, "+n+".xyz\n";if(t.numLights==0)return o;o+="mul "+i+".xyz, "+n+".xyz, "+i+".xyz\n"+"mov "+i+".w, "+n+".w\n";if(t.numLights>0)r.removeFragmentTempUsage(n);return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod"}],"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseBasicMethod");var o=function(t){r(e,t);function e(e){t.call(this);this._gradient=e}e.prototype.iInitVO=function(e,i){t.prototype.iInitVO.call(this,e,i);i.secondaryTextureVO=e.getTextureVO(this._gradient)};Object.defineProperty(e.prototype,"gradient",{get:function(){return this._gradient},set:function(t){if(this._gradient==t)return;this._gradient=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this)};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){var o=t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a);this._pIsFirstLight=true;if(e.numLights>0)i.secondaryTextureVO._iInitRegisters(e,r);return o};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight)s=this._pTotalLightColorReg;else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}n+="dp3 "+s+".w, "+i+".xyz, "+o.normalFragment+".xyz\n"+"mul "+s+".w, "+s+".w, "+o.commons+".x\n"+"add "+s+".w, "+s+".w, "+o.commons+".x\n"+"mul "+s+".xyz, "+s+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);n+=e.secondaryTextureVO._iGetFragmentCode(t,s,a,s)+"mul "+s+".xyz, "+s+".xyz, "+r+".xyz\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+s+".xyz\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.pApplyShadow=function(t,e,i,r){var a=i.getFreeFragmentVectorTemp();return"mov "+a+", "+r.shadowTarget+".wwww\n"+e.secondaryTextureVO._iGetFragmentCode(t,a,i,r.uvVarying)+"mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+a+"\n"};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);i.secondaryTextureVO.activate(e)};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod"}],"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod");var o=function(t){r(e,t);function e(e,i,r,a){if(i===void 0){i="multiply"}if(r===void 0){r=false}if(a===void 0){a=null}t.call(this,null,a);this._useSecondaryUV=r;this._lightMap=e;this.blendMode=i}e.prototype.iInitVO=function(t,e){e.secondaryTextureVO=t.getTextureVO(this._lightMap);if(this._useSecondaryUV)t.secondaryUVDependencies++;else t.uvDependencies++};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");if(this._blendMode==t)return;this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightMap",{get:function(){return this._lightMap},set:function(t){if(this._lightMap==t)return;this._lightMap=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){if(this._useSecondaryUV==t)return;this._useSecondaryUV=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iGetFragmentPostLightingCode=function(i,r,a,o,n){var s;var h=o.getFreeFragmentVectorTemp();r.secondaryTextureVO._iInitRegisters(i,o);s=r.secondaryTextureVO._iGetFragmentCode(i,h,o,this._useSecondaryUV?n.secondaryUVVarying:n.uvVarying);switch(this._blendMode){case e.MULTIPLY:s+="mul "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+", "+h+"\n";break;case e.ADD:s+="add "+this._pTotalLightColorReg+", "+this._pTotalLightColorReg+", "+h+"\n";break}s+=t.prototype.iGetFragmentPostLightingCode.call(this,i,r,a,o,n);return s};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);i.secondaryTextureVO.activate(e)};e.MULTIPLY="multiply";e.ADD="add";return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod":"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod"}],"awayjs-methodmaterials/lib/methods/DiffuseSubSurfaceMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod");var o=function(t){r(e,t);function e(e,i,r){var a=this;if(e===void 0){e=512}if(i===void 0){i=15}if(r===void 0){r=null}t.call(this,null,r);this._translucency=1;this._scatterColor=16777215;this._scatterR=1;this._scatterG=1;this._scatterB=1;this.pBaseMethod._iModulateMethod=function(t,e,i,r,o){return a.scatterLight(t,e,i,r,o)};this._scattering=.2;this._translucency=1}e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);var r=e.vertexConstantData;var a=i.secondaryVertexConstantsIndex;r[a]=.5;r[a+1]=-.5;r[a+2]=0;r[a+3]=1;r=e.fragmentConstantData;a=i.secondaryFragmentConstantsIndex;r[a+3]=1;r[a+4]=1;r[a+5]=1/255;r[a+6]=1/65025;r[a+7]=1/16581375;r[a+10]=.5;r[a+11]=-.1};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._lightProjVarying=null;this._propReg=null;this._lightColorReg=null;this._colorReg=null;this._decReg=null;this._targetReg=null};Object.defineProperty(e.prototype,"scattering",{get:function(){return this._scattering},set:function(t){this._scattering=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"translucency",{get:function(){return this._translucency},set:function(t){this._translucency=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"scatterColor",{get:function(){return this._scatterColor},set:function(t){this._scatterColor=t;this._scatterR=(t>>16&255)/255;this._scatterG=(t>>8&255)/255;this._scatterB=(t&255)/255},enumerable:true,configurable:true});e.prototype.iGetVertexCode=function(e,i,r,a){var o=t.prototype.iGetVertexCode.call(this,e,i,r,a);var n;var s;var h=r.getFreeVertexVectorTemp();s=r.getFreeVertexConstant();i.secondaryVertexConstantsIndex=s.index*4;this._lightProjVarying=r.getFreeVarying();n=r.getFreeVertexConstant();
r.getFreeVertexConstant();r.getFreeVertexConstant();r.getFreeVertexConstant();o+="m44 "+h+", vt0, "+n+"\n"+"div "+h+".xyz, "+h+".xyz, "+h+".w\n"+"mul "+h+".xy, "+h+".xy, "+s+".xy\n"+"add "+h+".xy, "+h+".xy, "+s+".xx\n"+"mov "+this._lightProjVarying+".xyz, "+h+".xyz\n"+"mov "+this._lightProjVarying+".w, va0.w\n";return o};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._colorReg=r.getFreeFragmentConstant();this._decReg=r.getFreeFragmentConstant();this._propReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._colorReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.iGetFragmentCodePerLight=function(e,i,r,a,o,n){this._pIsFirstLight=true;this._lightColorReg=a;return t.prototype.iGetFragmentCodePerLight.call(this,e,i,r,a,o,n)};e.prototype.iGetFragmentPostLightingCode=function(e,i,r,a,o){var n=t.prototype.iGetFragmentPostLightingCode.call(this,e,i,r,a,o);var s=a.getFreeFragmentVectorTemp();n+="mul "+s+".xyz, "+this._lightColorReg+".xyz, "+this._targetReg+".w\n"+"mul "+s+".xyz, "+s+".xyz, "+this._colorReg+".xyz\n"+"add "+r+".xyz, "+r+".xyz, "+s+".xyz\n";if(this._targetReg!=o.viewDirFragment)a.removeFragmentTempUsage(r);return n};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var o=e.fragmentConstantData;o[a]=this._scatterR;o[a+1]=this._scatterG;o[a+2]=this._scatterB;o[a+8]=this._scattering;o[a+9]=this._translucency};e.prototype.iSetRenderState=function(t,e,i,r,a){e.secondaryTextureVO=t.getTextureVO(this._depthPass._iGetDepthMap(i));e.secondaryTextureVO.activate(t);this._depthPass._iGetProjection(i).copyRawDataTo(t.vertexConstantData,e.secondaryVertexConstantsIndex+4,true)};e.prototype.scatterLight=function(t,e,i,r,a){if(!this._pIsFirstLight)return"";this._pIsFirstLight=false;var o="";if(a.viewDirFragment)this._targetReg=a.viewDirFragment;else r.addFragmentTempUsages(this._targetReg=r.getFreeFragmentVectorTemp(),1);var n=r.getFreeFragmentVectorTemp();o+=e.secondaryTextureVO._iGetFragmentCode(t,n,r,this._lightProjVarying)+"dp4 "+i+".z, "+n+", "+this._decReg+"\n";o+="sub "+i+".z, "+this._lightProjVarying+".z, "+i+".z\n"+"sub "+i+".z, "+this._propReg+".x, "+i+".z\n"+"mul "+i+".z, "+this._propReg+".y, "+i+".z\n"+"sat "+i+".z, "+i+".z\n"+"neg "+i+".y, "+i+".x\n"+"mul "+i+".y, "+i+".y, "+this._propReg+".z\n"+"add "+i+".y, "+i+".y, "+this._propReg+".z\n"+"mul "+this._targetReg+".w, "+i+".z, "+i+".y\n"+"sub "+i+".y, "+this._colorReg+".w, "+this._targetReg+".w\n"+"mul "+i+".w, "+i+".w, "+i+".y\n";return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod":"awayjs-methodmaterials/lib/methods/DiffuseCompositeMethod"}],"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/DiffuseBasicMethod");var o=function(t){r(e,t);function e(e){if(e===void 0){e=.5}t.call(this);this.wrapFactor=e}e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._wrapDataRegister=null};Object.defineProperty(e.prototype,"wrapFactor",{get:function(){return this._wrapFactor},set:function(t){this._wrapFactor=t;this._wrapFactor=1/(t+1)},enumerable:true,configurable:true});e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){var o=t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a);this._pIsFirstLight=true;this._wrapDataRegister=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._wrapDataRegister.index*4;return o};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}n+="dp3 "+s+".x, "+i+".xyz, "+o.normalFragment+".xyz\n"+"add "+s+".y, "+s+".x, "+this._wrapDataRegister+".x\n"+"mul "+s+".y, "+s+".y, "+this._wrapDataRegister+".y\n"+"sat "+s+".w, "+s+".y\n"+"mul "+s+".xz, "+s+".w, "+i+".wz\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,i,a,o);n+="mul "+s+", "+s+".x, "+r+"\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+s+".xyz\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var o=e.fragmentConstantData;o[a]=this._wrapFactor;o[a+1]=1/(this._wrapFactor+1)};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod":"awayjs-methodmaterials/lib/methods/DiffuseBasicMethod"}],"awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=false}t.call(this);this._texture=e;this._useSecondaryUV=i}e.prototype.iInitVO=function(t,e){e.textureVO=t.getTextureVO(this._texture);if(this._useSecondaryUV)t.secondaryUVDependencies++;else t.uvDependencies++};Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){if(this._useSecondaryUV==t)return;this._useSecondaryUV=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(this._texture==t)return;this._texture=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentVectorTemp();return e.textureVO._iGetFragmentCode(t,o,r,this._useSecondaryUV?a.secondaryUVVarying:a.uvVarying)+"mul "+i+", "+i+", "+o+".x\n"};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);i.textureVO.activate(e)};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e){t.call(this);if(e.length!=20)throw new Error("Matrix length must be 20!");this._matrix=e}Object.defineProperty(e.prototype,"colorMatrix",{get:function(){return this._matrix},set:function(t){this._matrix=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentConstant();r.getFreeFragmentConstant();r.getFreeFragmentConstant();r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;var h=r.getFreeFragmentVectorTemp();o+="m44 "+h+", "+i+", "+n+"\n"+"add "+i+", "+h+", "+s+"\n";return o};e.prototype.iActivate=function(t,e,i){var r=this._matrix;var a=e.fragmentConstantsIndex;var o=t.fragmentConstantData;o[a]=r[0];o[a+1]=r[1];o[a+2]=r[2];o[a+3]=r[3];o[a+4]=r[5];o[a+5]=r[6];o[a+6]=r[7];o[a+7]=r[8];o[a+8]=r[10];o[a+9]=r[11];o[a+10]=r[12];o[a+11]=r[13];o[a+12]=r[15];o[a+13]=r[16];o[a+14]=r[17];o[a+15]=r[18];o[a+16]=r[4];o[a+17]=r[9];o[a+18]=r[14];o[a+19]=r[19]};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this._colorTransform},set:function(t){this._colorTransform=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;o+="mul "+i+", "+i+", "+n+"\n"+"add "+i+", "+i+", "+s+"\n";return o};e.prototype.iActivate=function(t,e,i){var r=1/255;var a=e.fragmentConstantsIndex;var o=t.fragmentConstantData;o[a]=this._colorTransform.redMultiplier;o[a+1]=this._colorTransform.greenMultiplier;o[a+2]=this._colorTransform.blueMultiplier;o[a+3]=this._colorTransform.alphaMultiplier;o[a+4]=this._colorTransform.redOffset*r;o[a+5]=this._colorTransform.greenOffset*r;o[a+6]=this._colorTransform.blueOffset*r;o[a+7]=this._colorTransform.alphaOffset*r};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=1}t.call(this);this._envMap=e;this._alpha=i}Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(t==this._mask)return;this._mask=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true;e.textureVO=t.getTextureVO(this._envMap);if(this._mask!=null){e.secondaryTextureVO=t.getTextureVO(this._mask);t.uvDependencies++}};Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){if(this._envMap==t)return;this._envMap=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.dispose=function(){};Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){t.fragmentConstantData[e.fragmentConstantsIndex]=this._alpha;e.textureVO.activate(t);if(this._mask)e.secondaryTextureVO.activate(t)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();var n="";e.fragmentConstantsIndex=o.index*4;var s=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(s,1);var h=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(h,1);e.textureVO._iInitRegisters(t,r);n+="dp3 "+s+".w, "+a.viewDirFragment+".xyz, "+a.normalFragment+".xyz\n"+"add "+s+".w, "+s+".w, "+s+".w\n"+"mul "+s+".xyz, "+a.normalFragment+".xyz, "+s+".w\n"+"sub "+s+".xyz, "+s+".xyz, "+a.viewDirFragment+".xyz\n"+e.textureVO._iGetFragmentCode(t,s,r,s)+"sub "+h+".w, "+s+".w, fc0.x\n"+"kil "+h+".w\n"+"sub "+s+", "+s+", "+i+"\n";if(this._mask){e.secondaryTextureVO._iInitRegisters(t,r);n+=e.secondaryTextureVO._iGetFragmentCode(t,h,r,a.uvVarying)+"mul "+s+", "+h+", "+s+"\n"}n+="mul "+s+", "+s+", "+o+".x\n"+"add "+i+", "+i+", "+s+"\n";r.removeFragmentTempUsage(s);r.removeFragmentTempUsage(h);return n};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectFogMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i,r){if(r===void 0){r=8421504}t.call(this);this._minDistance=0;this._maxDistance=1e3;this.minDistance=e;this.maxDistance=i;this.fogColor=r}e.prototype.iInitVO=function(t,e){e.needsProjection=true};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=e.fragmentConstantsIndex;i[r+3]=1;i[r+6]=0;i[r+7]=0};Object.defineProperty(e.prototype,"minDistance",{get:function(){return this._minDistance},set:function(t){this._minDistance=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"maxDistance",{get:function(){return this._maxDistance},set:function(t){this._maxDistance=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fogColor",{get:function(){return this._fogColor},set:function(t){this._fogColor=t;this._fogR=(t>>16&255)/255;this._fogG=(t>>8&255)/255;this._fogB=(t&255)/255},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;r[a]=this._fogR;r[a+1]=this._fogG;r[a+2]=this._fogB;r[a+4]=this._minDistance;r[a+5]=1/(this._maxDistance-this._minDistance)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(s,1);var h=r.getFreeFragmentVectorTemp();var d="";e.fragmentConstantsIndex=o.index*4;d+="sub "+h+".w, "+a.projectionFragment+".z, "+n+".x\n"+"mul "+h+".w, "+h+".w, "+n+".y\n"+"sat "+h+".w, "+h+".w\n"+"sub "+s+", "+o+", "+i+"\n"+"mul "+s+", "+s+", "+h+".w\n"+"add "+i+", "+i+", "+s+"\n";r.removeFragmentTempUsage(s);return d};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i){if(i===void 0){i=1}t.call(this);this._fresnelPower=5;this._normalReflectance=0;this._envMap=e;this._alpha=i}e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true;e.textureVO=t.getTextureVO(this._envMap);if(this._mask!=null){e.secondaryTextureVO=t.getTextureVO(this._mask);t.uvDependencies++}};e.prototype.iInitConstants=function(t,e){t.fragmentConstantData[e.fragmentConstantsIndex+3]=1};Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask==t)return;this._mask=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){this._envMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;r[a]=this._alpha;r[a+1]=this._normalReflectance;r[a+2]=this._fresnelPower;e.textureVO.activate(t);if(this._mask)e.secondaryTextureVO.activate(t)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();var n="";var s=a.viewDirFragment;var h=a.normalFragment;e.fragmentConstantsIndex=o.index*4;var d=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(d,1);var u=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(u,1);e.textureVO._iInitRegisters(t,r);n+="dp3 "+d+".w, "+s+".xyz, "+h+".xyz\n"+"add "+d+".w, "+d+".w, "+d+".w\n"+"mul "+d+".xyz, "+h+".xyz, "+d+".w\n"+"sub "+d+".xyz, "+d+".xyz, "+s+".xyz\n"+e.textureVO._iGetFragmentCode(t,d,r,d)+"sub "+u+".w, "+d+".w, fc0.x\n"+"kil "+u+".w\n"+"sub "+d+", "+d+", "+i+"\n";n+="dp3 "+s+".w, "+s+".xyz, "+h+".xyz\n"+"sub "+s+".w, "+o+".w, "+s+".w\n"+"pow "+s+".w, "+s+".w, "+o+".z\n"+"sub "+h+".w, "+o+".w, "+s+".w\n"+"mul "+h+".w, "+o+".y, "+h+".w\n"+"add "+s+".w, "+s+".w, "+h+".w\n"+"mul "+s+".w, "+o+".x, "+s+".w\n";if(this._mask){e.secondaryTextureVO._iInitRegisters(t,r);n+=e.secondaryTextureVO._iGetFragmentCode(t,u,r,a.uvVarying)+"mul "+s+".w, "+u+".x, "+s+".w\n"}n+="mul "+d+", "+d+", "+s+".w\n"+"add "+i+", "+i+", "+d+"\n";r.removeFragmentTempUsage(d);r.removeFragmentTempUsage(u);return n};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectLightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(i,r,a){if(r===void 0){r="multiply"}if(a===void 0){a=false}t.call(this);if(r!=e.ADD&&r!=e.MULTIPLY)throw new Error("Unknown blendmode!");this._lightMap=i;this._blendMode=r;this._useSecondaryUV=a}e.prototype.iInitVO=function(t,e){e.textureVO=t.getTextureVO(this._lightMap);if(this._useSecondaryUV)t.secondaryUVDependencies++;else t.uvDependencies++};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(this._blendMode==t)return;if(t!=e.ADD&&t!=e.MULTIPLY)throw new Error("Unknown blendmode!");this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightMap",{get:function(){return this._lightMap},set:function(t){if(this._lightMap==t)return;this._lightMap=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"useSecondaryUV",{get:function(){return this._useSecondaryUV},set:function(t){if(this._useSecondaryUV==t)return;this._useSecondaryUV=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,i,r,a,o){var n;var s=a.getFreeFragmentVectorTemp();n=i.secondaryTextureVO._iGetFragmentCode(t,s,a,this._useSecondaryUV?o.secondaryUVVarying:o.uvVarying);switch(this._blendMode){case e.MULTIPLY:n+="mul "+r+", "+r+", "+s+"\n";break;case e.ADD:n+="add "+r+", "+r+", "+s+"\n";break}return n};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);i.textureVO.activate(e)};e.MULTIPLY="multiply";e.ADD="add";return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,o){throw new a;return""};e.assetType="[asset EffectMethod]";return e}(o);e.exports=n},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectRefractionEnvMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i,r,a,o){if(i===void 0){i=.1}if(r===void 0){r=0}if(a===void 0){a=0}if(o===void 0){o=0}t.call(this);this._dispersionR=0;this._dispersionG=0;this._dispersionB=0;this._alpha=1;this._envMap=e;this._dispersionR=r;this._dispersionG=a;this._dispersionB=o;this._useDispersion=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);this._refractionIndex=i}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i+4]=1;r[i+5]=0;r[i+7]=1};e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true;e.textureVO=t.getTextureVO(this._envMap)};Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){this._envMap=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"refractionIndex",{get:function(){return this._refractionIndex},set:function(t){this._refractionIndex=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionR",{get:function(){return this._dispersionR},set:function(t){this._dispersionR=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionG",{get:function(){return this._dispersionG},set:function(t){this._dispersionG=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dispersionB",{get:function(){return this._dispersionB},set:function(t){this._dispersionB=t;var e=!(this._dispersionR==this._dispersionB&&this._dispersionR==this._dispersionG);if(this._useDispersion!=e){this.iInvalidateShaderProgram();this._useDispersion=e}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._dispersionR+this._refractionIndex;if(this._useDispersion){a[r+1]=this._dispersionG+this._refractionIndex;a[r+2]=this._dispersionB+this._refractionIndex}a[r+3]=this._alpha;e.textureVO.activate(t)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();var n=r.getFreeFragmentConstant();var s="";var h;var d;var u;e.fragmentConstantsIndex=o.index*4;h=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(h,1);d=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(d,1);u=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(u,1);var p=a.viewDirFragment;var l=a.normalFragment;e.textureVO._iInitRegisters(t,r);s+="neg "+p+".xyz, "+p+".xyz\n";s+="dp3 "+u+".x, "+p+".xyz, "+l+".xyz\n"+"mul "+u+".w, "+u+".x, "+u+".x\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"mul "+u+".w, "+o+".x, "+u+".w\n"+"mul "+u+".w, "+o+".x, "+u+".w\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"sqt "+u+".y, "+u+".w\n"+"mul "+u+".x, "+o+".x, "+u+".x\n"+"add "+u+".x, "+u+".x, "+u+".y\n"+"mul "+u+".xyz, "+u+".x, "+l+".xyz\n"+"mul "+h+", "+o+".x, "+p+"\n"+"sub "+h+".xyz, "+h+".xyz, "+u+".xyz\n"+"nrm "+h+".xyz, "+h+".xyz\n"+e.textureVO._iGetFragmentCode(t,d,r,h)+"sub "+d+".w, "+d+".w, fc0.x	\n"+"kil "+d+".w\n";if(this._useDispersion){s+="dp3 "+u+".x, "+p+".xyz, "+l+".xyz\n"+"mul "+u+".w, "+u+".x, "+u+".x\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"mul "+u+".w, "+o+".y, "+u+".w\n"+"mul "+u+".w, "+o+".y, "+u+".w\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"sqt "+u+".y, "+u+".w\n"+"mul "+u+".x, "+o+".y, "+u+".x\n"+"add "+u+".x, "+u+".x, "+u+".y\n"+"mul "+u+".xyz, "+u+".x, "+l+".xyz\n"+"mul "+h+", "+o+".y, "+p+"\n"+"sub "+h+".xyz, "+h+".xyz, "+u+".xyz\n"+"nrm "+h+".xyz, "+h+".xyz\n"+e.textureVO._iGetFragmentCode(t,u,r,h)+"mov "+d+".y, "+u+".y\n";s+="dp3 "+u+".x, "+p+".xyz, "+l+".xyz\n"+"mul "+u+".w, "+u+".x, "+u+".x\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"mul "+u+".w, "+o+".z, "+u+".w\n"+"mul "+u+".w, "+o+".z, "+u+".w\n"+"sub "+u+".w, "+n+".x, "+u+".w\n"+"sqt "+u+".y, "+u+".w\n"+"mul "+u+".x, "+o+".z, "+u+".x\n"+"add "+u+".x, "+u+".x, "+u+".y\n"+"mul "+u+".xyz, "+u+".x, "+l+".xyz\n"+"mul "+h+", "+o+".z, "+p+"\n"+"sub "+h+".xyz, "+h+".xyz, "+u+".xyz\n"+"nrm "+h+".xyz, "+h+".xyz\n"+e.textureVO._iGetFragmentCode(t,u,r,h)+"mov "+d+".z, "+u+".z\n"}s+="sub "+d+".xyz, "+d+".xyz, "+i+".xyz\n"+"mul "+d+".xyz, "+d+".xyz, "+o+".w\n"+"add "+i+".xyz, "+i+".xyz, "+d+".xyz\n";r.removeFragmentTempUsage(u);r.removeFragmentTempUsage(h);r.removeFragmentTempUsage(d);s+="neg "+p+".xyz, "+p+".xyz\n";return s};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/EffectRimLightMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/EffectMethodBase");var o=function(t){r(e,t);function e(e,i,r,a){if(e===void 0){e=16777215}if(i===void 0){i=.4}if(r===void 0){r=2}if(a===void 0){a="mix"}t.call(this);this._blendMode=a;this._strength=i;this._power=r;this.color=e}e.prototype.iInitConstants=function(t,e){t.fragmentConstantData[e.fragmentConstantsIndex+3]=1};e.prototype.iInitVO=function(t,e){e.needsNormals=true;e.needsView=true};Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){if(this._blendMode==t)return;this._blendMode=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color=t;this._colorR=(t>>16&255)/255;this._colorG=(t>>8&255)/255;this._colorB=(t&255)/255},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(t){this._strength=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"power",{get:function(){return this._power},set:function(t){this._power=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._colorR;a[r+1]=this._colorG;a[r+2]=this._colorB;a[r+4]=this._strength;a[r+5]=this._power};e.prototype.iGetFragmentCode=function(t,i,r,a,o){var n=a.getFreeFragmentConstant();var s=a.getFreeFragmentConstant();var h=a.getFreeFragmentVectorTemp();var d="";i.fragmentConstantsIndex=n.index*4;d+="dp3 "+h+".x, "+o.viewDirFragment+".xyz, "+o.normalFragment+".xyz\n"+"sat "+h+".x, "+h+".x\n"+"sub "+h+".x, "+n+".w, "+h+".x\n"+"pow "+h+".x, "+h+".x, "+s+".y\n"+"mul "+h+".x, "+h+".x, "+s+".x\n"+"sub "+h+".x, "+n+".w, "+h+".x\n"+"mul "+r+".xyz, "+r+".xyz, "+h+".x\n"+"sub "+h+".w, "+n+".w, "+h+".x\n";if(this._blendMode==e.ADD){d+="mul "+h+".xyz, "+h+".w, "+n+".xyz\n"+"add "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}else if(this._blendMode==e.MULTIPLY){d+="mul "+h+".xyz, "+h+".w, "+n+".xyz\n"+"mul "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}else{d+="sub "+h+".xyz, "+n+".xyz, "+r+".xyz\n"+"mul "+h+".xyz, "+h+".xyz, "+h+".w\n"+"add "+r+".xyz, "+r+".xyz, "+h+".xyz\n"}return d};e.ADD="add";e.MULTIPLY="multiply";e.MIX="mix";return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/EffectMethodBase":"awayjs-methodmaterials/lib/methods/EffectMethodBase"}],"awayjs-methodmaterials/lib/methods/LightingMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(){t.call(this)}e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return""};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){return""};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,o){return""};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return""};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/NormalBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(e){if(e===void 0){e=null}t.call(this);this._normalMap=e}e.prototype.iIsUsed=function(t){if(this._normalMap&&t.normalDependencies)return true;return false};e.prototype.iInitVO=function(t,e){if(this._normalMap){e.textureVO=t.getTextureVO(this._normalMap);t.uvDependencies++}};e.prototype.iOutputsTangentNormals=function(){return true};e.prototype.copyFrom=function(t){var e=t;var i=t;if(i.normalMap!=null)this.normalMap=i.normalMap};Object.defineProperty(e.prototype,"normalMap",{get:function(){return this._normalMap},set:function(t){if(this._normalMap==t)return;this._normalMap=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._normalMap)this._normalMap=null};e.prototype.iActivate=function(t,e,i){if(this._normalMap)e.textureVO.activate(t)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";if(this._normalMap){e.textureVO._iInitRegisters(t,r);o+=e.textureVO._iGetFragmentCode(t,i,r,a.uvVarying)}o+="sub "+i+".xyz, "+i+".xyz, "+a.commons+".xxx\n"+"nrm "+i+".xyz, "+i+"\n";return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/NormalHeightMapMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/NormalBasicMethod");var o=function(t){r(e,t);function e(e,i,r,a){t.call(this);this.normalMap=e;this._worldXYRatio=i/r;this._worldXZRatio=a/r}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i]=1/this.normalMap.width;r[i+1]=1/this.normalMap.height;r[i+2]=0;r[i+3]=1;r[i+4]=this._worldXYRatio;r[i+5]=this._worldXZRatio};Object.defineProperty(e.prototype,"tangentSpace",{get:function(){return false},enumerable:true,configurable:true});e.prototype.copyFrom=function(e){t.prototype.copyFrom.call(this,e);this._worldXYRatio=e._worldXYRatio;this._worldXZRatio=e._worldXZRatio};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(n,1);var s=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();e.fragmentConstantsIndex=s.index*4;o+=e.textureVO._iGetFragmentCode(t,i,r,a.uvVarying)+"add "+n+", "+a.uvVarying+", "+s+".xzzz\n"+e.textureVO._iGetFragmentCode(t,n,r,n)+"sub "+i+".x, "+i+".x, "+n+".x\n"+"add "+n+", "+a.uvVarying+", "+s+".zyzz\n"+e.textureVO._iGetFragmentCode(t,n,r,n)+"sub "+i+".z, "+i+".z, "+n+".x\n"+"mov "+i+".y, "+s+".w\n"+"mul "+i+".xz, "+i+".xz, "+h+".xy\n"+"nrm "+i+".xyz, "+i+".xyz\n";r.removeFragmentTempUsage(n);return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/NormalBasicMethod":"awayjs-methodmaterials/lib/methods/NormalBasicMethod"}],"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/NormalBasicMethod");var o=function(t){r(e,t);function e(e,i){if(e===void 0){e=null}if(i===void 0){i=null}t.call(this,e);this._water1OffsetX=0;this._water1OffsetY=0;this._water2OffsetX=0;this._water2OffsetY=0;this._secondaryNormalMap=i}e.prototype.iInitConstants=function(t,e){var i=e.fragmentConstantsIndex;var r=t.fragmentConstantData;r[i]=.5;r[i+1]=0;r[i+2]=0;r[i+3]=1};e.prototype.iInitVO=function(e,i){t.prototype.iInitVO.call(this,e,i);if(this._secondaryNormalMap){i.secondaryTextureVO=e.getTextureVO(this._secondaryNormalMap);e.uvDependencies++}};Object.defineProperty(e.prototype,"water1OffsetX",{get:function(){return this._water1OffsetX
},set:function(t){this._water1OffsetX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water1OffsetY",{get:function(){return this._water1OffsetY},set:function(t){this._water1OffsetY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water2OffsetX",{get:function(){return this._water2OffsetX},set:function(t){this._water2OffsetX=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"water2OffsetY",{get:function(){return this._water2OffsetY},set:function(t){this._water2OffsetY=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"secondaryNormalMap",{get:function(){return this._secondaryNormalMap},set:function(t){if(this._secondaryNormalMap==t)return;this._secondaryNormalMap=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);this._secondaryNormalMap=null};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var o=i.fragmentConstantsIndex;a[o+4]=this._water1OffsetX;a[o+5]=this._water1OffsetY;a[o+6]=this._water2OffsetX;a[o+7]=this._water2OffsetY;if(this._secondaryNormalMap)i.secondaryTextureVO.activate(e)};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(n,1);var s=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();e.fragmentConstantsIndex=s.index*4;o+="add "+n+", "+a.uvVarying+", "+h+".xyxy\n";if(this.normalMap){e.textureVO._iInitRegisters(t,r);o+=e.textureVO._iGetFragmentCode(t,i,r,n)}o+="add "+n+", "+a.uvVarying+", "+h+".zwzw\n";if(this._secondaryNormalMap){e.secondaryTextureVO._iInitRegisters(t,r);o+=e.secondaryTextureVO._iGetFragmentCode(t,n,r,n)}o+="add "+i+", "+i+", "+n+"		\n"+"mul "+i+", "+i+", "+s+".x	\n"+"sub "+i+".xyz, "+i+".xyz, "+a.commons+".xxx	\n"+"nrm "+i+".xyz, "+i+".xyz							\n";return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/NormalBasicMethod":"awayjs-methodmaterials/lib/methods/NormalBasicMethod"}],"awayjs-methodmaterials/lib/methods/ShadingMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/library/AssetBase");var o=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var n=function(t){r(e,t);function e(){t.call(this)}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});e.prototype.iIsUsed=function(t){return true};e.prototype.iInitVO=function(t,e){};e.prototype.iInitConstants=function(t,e){};e.prototype.iUsesTangentSpace=function(){return true};e.prototype.dispose=function(){};e.prototype.iReset=function(){this.iCleanCompilationData()};e.prototype.iCleanCompilationData=function(){};e.prototype.iGetVertexCode=function(t,e,i,r){return""};e.prototype.iGetFragmentCode=function(t,e,i,r,a){return null};e.prototype.iActivate=function(t,e,i){};e.prototype.iSetRenderState=function(t,e,i,r,a){};e.prototype.iDeactivate=function(t,e,i){};e.prototype.iInvalidateShaderProgram=function(){this.dispatchEvent(new o(o.SHADER_INVALIDATED))};e.prototype.copyFrom=function(t){};e.assetType="[asset ShadingMethod]";return e}(a);e.exports=n},{"awayjs-core/lib/library/AssetBase":undefined,"awayjs-renderergl/lib/events/ShadingMethodEvent":undefined}],"awayjs-methodmaterials/lib/methods/ShadowCascadeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var o=t("awayjs-display/lib/entities/DirectionalLight");var n=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var s=t("awayjs-methodmaterials/lib/data/MethodVO");var h=t("awayjs-methodmaterials/lib/methods/ShadowMapMethodBase");var d=function(t){r(e,t);function e(e){var i=this;t.call(this,e.castingLight);this._baseMethod=e;if(!(this._pCastingLight instanceof o))throw new Error("ShadowCascadeMethod is only compatible with DirectionalLight");this._cascadeShadowMapper=this._pCastingLight.shadowMapper;if(!this._cascadeShadowMapper)throw new Error("ShadowCascadeMethod requires a light that has a CascadeShadowMapper instance assigned to shadowMapper.");this._cascadeShadowMapper.addEventListener(a.CHANGE,function(t){return i.onCascadeChange(t)});this._baseMethod.addEventListener(n.SHADER_INVALIDATED,function(t){return i.onShaderInvalidated(t)})}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){var e=this;if(this._baseMethod==t)return;this._baseMethod.removeEventListener(n.SHADER_INVALIDATED,function(t){return e.onShaderInvalidated(t)});this._baseMethod=t;this._baseMethod.addEventListener(n.SHADER_INVALIDATED,function(t){return e.onShaderInvalidated(t)});this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(t,e){var i=new s(this._baseMethod);this._baseMethod.iInitVO(t,i);e.needsGlobalVertexPos=true;e.needsProjection=true;e.textureVO=t.getTextureVO(this._pCastingLight.shadowMapper.depthMap)};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=t.vertexConstantData;var a=e.fragmentConstantsIndex;i[a]=1;i[a+1]=1/255;i[a+2]=1/65025;i[a+3]=1/16581375;i[a+6]=.5;i[a+7]=-.5;a=e.vertexConstantsIndex;r[a]=.5;r[a+1]=-.5;r[a+2]=0};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._cascadeProjections=null;this._depthMapCoordVaryings=null};e.prototype.iGetVertexCode=function(t,e,i,r){var a="";var o=i.getFreeVertexConstant();this.initProjectionsRegs(i);e.vertexConstantsIndex=o.index*4;var n=i.getFreeVertexVectorTemp();for(var s=0;s<this._cascadeShadowMapper.numCascades;++s){a+="m44 "+n+", "+r.globalPositionVertex+", "+this._cascadeProjections[s]+"\n"+"add "+this._depthMapCoordVaryings[s]+", "+n+", "+o+".zzwz\n"}return a};e.prototype.initProjectionsRegs=function(t){this._cascadeProjections=new Array(this._cascadeShadowMapper.numCascades);this._depthMapCoordVaryings=new Array(this._cascadeShadowMapper.numCascades);for(var e=0;e<this._cascadeShadowMapper.numCascades;++e){this._depthMapCoordVaryings[e]=t.getFreeVarying();this._cascadeProjections[e]=t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant();t.getFreeVertexConstant()}};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=this._cascadeShadowMapper.numCascades;var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();var d=Array(h+".x",h+".y",h+".z",h+".w");var u;e.fragmentConstantsIndex=n.index*4;var p=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(p,1);var l=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(l,1);u="mov "+l+", "+this._depthMapCoordVaryings[o-1]+"\n";for(var m=o-2;m>=0;--m){var c=this._depthMapCoordVaryings[m];u+="slt "+p+".z, "+a.projectionFragment+".z, "+d[m]+"\n";var f=r.getFreeFragmentVectorTemp();u+="sub "+f+", "+c+", "+l+"\n"+"mul "+f+", "+f+", "+p+".z\n"+"add "+l+", "+l+", "+f+"\n"}r.removeFragmentTempUsage(p);u+="div "+l+", "+l+", "+l+".w\n"+"mul "+l+".xy, "+l+".xy, "+s+".zw\n"+"add "+l+".xy, "+l+".xy, "+s+".zz\n";u+=this._baseMethod._iGetCascadeFragmentCode(t,e,n,l,i,r,a)+"add "+i+".w, "+i+".w, "+s+".y\n";r.removeFragmentTempUsage(l);return u};e.prototype.iActivate=function(t,e,i){e.textureVO.activate(t);var r=t.vertexConstantData;var a=e.vertexConstantsIndex;t.vertexConstantData[e.vertexConstantsIndex+3]=-1/(this._cascadeShadowMapper.depth*this._pEpsilon);var o=this._cascadeShadowMapper.numCascades;a+=4;for(var n=0;n<o;++n){this._cascadeShadowMapper.getDepthProjections(n).copyRawDataTo(r,a,true);a+=16}var s=t.fragmentConstantData;var h=e.fragmentConstantsIndex;s[h+5]=1-this._pAlpha;var d=this._cascadeShadowMapper._iNearPlaneDistances;h+=8;for(var u=0;u<o;++u)s[h+u]=d[u];this._baseMethod.iActivateForCascade(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){};e.prototype.onCascadeChange=function(t){this.iInvalidateShaderProgram()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(h);e.exports=d},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-methodmaterials/lib/data/MethodVO":"awayjs-methodmaterials/lib/data/MethodVO","awayjs-methodmaterials/lib/methods/ShadowMapMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase","awayjs-renderergl/lib/events/ShadingMethodEvent":undefined}],"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/BitmapImage2D");var o=t("awayjs-display/lib/textures/Single2DTexture");var n=t("awayjs-methodmaterials/lib/methods/ShadowMethodBase");var s=function(t){r(e,t);function e(i,r,a){if(r===void 0){r=4}if(a===void 0){a=1}t.call(this,i);this._depthMapSize=this._pCastingLight.shadowMapper.depthMapSize;this.numSamples=r;this.range=a;++e._grainUsages;if(!e._grainTexture)this.initGrainTexture()}Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){if(t<1)t=1;else if(t>24)t=24;if(this._numSamples==t)return;this._numSamples=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitVO=function(i,r){t.prototype.iInitVO.call(this,i,r);r.needsProjection=true;r.secondaryTextureVO=i.getTextureVO(e._grainTexture)};e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);var r=e.fragmentConstantData;var a=i.fragmentConstantsIndex;r[a+8]=1/this._numSamples};Object.defineProperty(e.prototype,"range",{get:function(){return this._range*2},set:function(t){this._range=t/2},enumerable:true,configurable:true});e.prototype.initGrainTexture=function(){e._grainBitmapImage2D=new a(64,64,false);var t=new Array;var i=4096;var r=1/(this._depthMapSize*this._range);var n,s;for(var h=0;h<i;++h){n=2*(Math.random()-.5);s=2*(Math.random()-.5);if(n<0)n-=r;else n+=r;if(s<0)s-=r;else s+=r;if(n>1)n=1;else if(n<-1)n=-1;if(s>1)s=1;else if(s<-1)s=-1;t[h]=Math.floor((n*.5+.5)*255)<<16|Math.floor((s*.5+.5)*255)<<8}e._grainBitmapImage2D.setArray(e._grainBitmapImage2D.rect,t);e._grainTexture=new o(e._grainBitmapImage2D)};e.prototype.dispose=function(){if(--e._grainUsages==0){e._grainTexture.dispose();e._grainBitmapImage2D.dispose();e._grainTexture=null}};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var o=i.fragmentConstantsIndex;a[o+9]=(r.width-1)/63;a[o+10]=(r.height-1)/63;a[o+11]=2*this._range/this._depthMapSize;i.secondaryTextureVO.activate(e)};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=o.index*4;return this.getSampleCode(t,e,s,o,i,r,a)};e.prototype.getSampleCode=function(t,e,i,r,a,o,n){var s="";var h=this._numSamples;var d=o.getFreeFragmentVectorTemp();o.addFragmentTempUsages(d,1);var u=o.getFreeFragmentVectorTemp();o.addFragmentTempUsages(u,1);var p=n.projectionFragment;e.textureVO._iInitRegisters(t,o);e.secondaryTextureVO._iInitRegisters(t,o);s+="div "+d+", "+p+", "+p+".w\n"+"mul "+d+".xy, "+d+".xy, "+i+".yz\n";while(h>0){if(h==this._numSamples){s+=e.secondaryTextureVO._iGetFragmentCode(t,d,o,d)}else{s+="mov "+u+", "+d+".zwxy \n"+e.secondaryTextureVO._iGetFragmentCode(t,d,o,u)}s+="sub "+d+".zw, "+d+".xy, fc0.xx\n"+"mul "+d+".zw, "+d+".zw, "+i+".w\n";if(h==this._numSamples){s+="add "+d+".xy, "+d+".zw, "+this._pDepthMapCoordReg+".xy\n"+e.textureVO._iGetFragmentCode(t,u,o,d)+"dp4 "+u+".z, "+u+", "+r+"\n"+"slt "+a+".w, "+this._pDepthMapCoordReg+".z, "+u+".z\n"}else{s+=this.addSample(t,e,d,r,a,o)}if(h>4)s+="add "+d+".xy, "+d+".xy, "+d+".zw\n"+this.addSample(t,e,d,r,a,o);if(h>1)s+="sub "+d+".xy, "+this._pDepthMapCoordReg+".xy, "+d+".zw\n"+this.addSample(t,e,d,r,a,o);if(h>5)s+="sub "+d+".xy, "+d+".xy, "+d+".zw\n"+this.addSample(t,e,d,r,a,o);if(h>2){s+="neg "+d+".w, "+d+".w\n";s+="add "+d+".xy, "+d+".wz, "+this._pDepthMapCoordReg+".xy\n"+this.addSample(t,e,d,r,a,o)}if(h>6)s+="add "+d+".xy, "+d+".xy, "+d+".wz\n"+this.addSample(t,e,d,r,a,o);if(h>3)s+="sub "+d+".xy, "+this._pDepthMapCoordReg+".xy, "+d+".wz\n"+this.addSample(t,e,d,r,a,o);if(h>7)s+="sub "+d+".xy, "+d+".xy, "+d+".wz\n"+this.addSample(t,e,d,r,a,o);h-=8}o.removeFragmentTempUsage(u);o.removeFragmentTempUsage(d);s+="mul "+a+".w, "+a+".w, "+i+".x\n";return s};e.prototype.addSample=function(t,e,i,r,a,o){var n=o.getFreeFragmentVectorTemp();return e.textureVO._iGetFragmentCode(t,n,o,i)+"dp4 "+n+".z, "+n+", "+r+"\n"+"slt "+n+".z, "+this._pDepthMapCoordReg+".z, "+n+".z\n"+"add "+a+".w, "+a+".w, "+n+".z\n"};e.prototype.iActivateForCascade=function(t,e,i){var r=t.fragmentConstantData;var a=e.secondaryFragmentConstantsIndex;r[a]=1/this._numSamples;r[a+1]=(i.width-1)/63;r[a+2]=(i.height-1)/63;r[a+3]=2*this._range/this._depthMapSize;e.secondaryTextureVO.activate(t)};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,o,n){this._pDepthMapCoordReg=r;var s=o.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=s.index*4;return this.getSampleCode(t,e,s,i,a,o,n)};return e}(n);e.exports=s},{"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/methods/ShadowMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMethodBase"}],"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadowMethodBase");var o=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);var r=e.fragmentConstantData;var a=i.fragmentConstantsIndex;r[a+8]=.5;var o=this.castingLight.shadowMapper.depthMapSize;r[a+9]=o;r[a+10]=1/o};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentConstant();r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();e.fragmentConstantsIndex=n.index*4;var h=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(h,1);var d=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(d,1);e.textureVO._iInitRegisters(t,r);o+="mov "+d+", "+this._pDepthMapCoordReg+"\n"+e.textureVO._iGetFragmentCode(t,h,r,this._pDepthMapCoordReg)+"dp4 "+h+".z, "+h+", "+n+"\n"+"slt "+d+".z, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"add "+d+".x, "+this._pDepthMapCoordReg+".x, "+s+".z\n"+e.textureVO._iGetFragmentCode(t,h,r,d)+"dp4 "+h+".z, "+h+", "+n+"\n"+"slt "+d+".w, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".x, "+s+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+d+".w, "+d+".w, "+d+".z\n"+"mul "+d+".w, "+d+".w, "+h+".x\n"+"add "+i+".w, "+d+".z, "+d+".w\n"+"mov "+d+".x, "+this._pDepthMapCoordReg+".x\n"+"add "+d+".y, "+this._pDepthMapCoordReg+".y, "+s+".z\n"+e.textureVO._iGetFragmentCode(t,h,r,d)+"dp4 "+h+".z, "+h+", "+n+"\n"+"slt "+d+".z, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"add "+d+".x, "+this._pDepthMapCoordReg+".x, "+s+".z\n"+e.textureVO._iGetFragmentCode(t,h,r,d)+"dp4 "+h+".z, "+h+", "+n+"\n"+"slt "+d+".w, "+this._pDepthMapCoordReg+".z, "+h+".z\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".x, "+s+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+d+".w, "+d+".w, "+d+".z\n"+"mul "+d+".w, "+d+".w, "+h+".x\n"+"add "+d+".w, "+d+".z, "+d+".w\n"+"mul "+h+".x, "+this._pDepthMapCoordReg+".y, "+s+".y\n"+"frc "+h+".x, "+h+".x\n"+"sub "+d+".w, "+d+".w, "+i+".w\n"+"mul "+d+".w, "+d+".w, "+h+".x\n"+"add "+i+".w, "+i+".w, "+d+".w\n";r.removeFragmentTempUsage(h);r.removeFragmentTempUsage(d);return o};e.prototype.iActivateForCascade=function(t,e,i){var r=this.castingLight.shadowMapper.depthMapSize;var a=e.secondaryFragmentConstantsIndex;var o=t.fragmentConstantData;o[a]=r;o[a+1]=1/r};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,o,n){var s;var h=o.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=h.index*4;var d=o.getFreeFragmentVectorTemp();o.addFragmentTempUsages(d,1);var u=o.getFreeFragmentVectorTemp();o.addFragmentTempUsages(u,1);e.textureVO._iInitRegisters(t,o);s=e.textureVO._iGetFragmentCode(t,d,o,r)+"dp4 "+d+".z, "+d+", "+i+"\n"+"slt "+u+".x, "+r+".z, "+d+".z\n"+"add "+r+".x, "+r+".x, "+h+".y\n"+e.textureVO._iGetFragmentCode(t,d,o,r)+"dp4 "+d+".z, "+d+", "+i+"\n"+"slt "+u+".z, "+r+".z, "+d+".z\n"+"add "+r+".y, "+r+".y, "+h+".y\n"+e.textureVO._iGetFragmentCode(t,d,o,r)+"dp4 "+d+".z, "+d+", "+i+"\n"+"slt "+u+".w, "+r+".z, "+d+".z\n"+"sub "+r+".x, "+r+".x, "+h+".y\n"+e.textureVO._iGetFragmentCode(t,d,o,r)+"dp4 "+d+".z, "+d+", "+i+"\n"+"slt "+u+".y, "+r+".z, "+d+".z\n"+"mul "+d+".xy, "+r+".xy, "+h+".x\n"+"frc "+d+".xy, "+d+".xy\n"+"sub "+r+", "+u+".xyzw, "+u+".zwxy\n"+"mul "+r+", "+r+", "+d+".x\n"+"add "+u+".xy, "+u+".xy, "+r+".zw\n"+"sub "+u+".y, "+u+".y, "+u+".x\n"+"mul "+u+".y, "+u+".y, "+d+".y\n"+"add "+a+".w, "+u+".x, "+u+".y\n";o.removeFragmentTempUsage(d);o.removeFragmentTempUsage(u);return s};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadowMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMethodBase"}],"awayjs-methodmaterials/lib/methods/ShadowHardMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadowMethodBase");var o=function(t){r(e,t);function e(e){t.call(this,e)}e.prototype._pGetPlanarFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentConstant();r.getFreeFragmentConstant();var s=r.getFreeFragmentVectorTemp();e.fragmentConstantsIndex=n.index*4;e.textureVO._iInitRegisters(t,r);o+=e.textureVO._iGetFragmentCode(t,s,r,this._pDepthMapCoordReg)+"dp4 "+s+".z, "+s+", "+n+"\n"+"slt "+i+".w, "+this._pDepthMapCoordReg+".z, "+s+".z\n";return o};e.prototype._pGetPointFragmentCode=function(t,e,i,r,a){var o="";var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentConstant();var h=r.getFreeFragmentConstant();var d=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(d,1);var u=r.getFreeFragmentVectorTemp();r.addFragmentTempUsages(u,1);e.fragmentConstantsIndex=n.index*4;e.textureVO._iInitRegisters(t,r);o+="sub "+u+", "+a.globalPositionVarying+", "+h+"\n"+"dp3 "+u+".w, "+u+".xyz, "+u+".xyz\n"+"mul "+u+".w, "+u+".w, "+h+".w\n"+"nrm "+u+".xyz, "+u+".xyz\n"+e.textureVO._iGetFragmentCode(t,d,r,u)+"dp4 "+d+".z, "+d+", "+n+"\n"+"add "+i+".w, "+u+".w, "+s+".x\n"+"slt "+i+".w, "+i+".w, "+d+".z\n";r.removeFragmentTempUsage(u);r.removeFragmentTempUsage(d);return o};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,o,n){var s=o.getFreeFragmentVectorTemp();return e.textureVO._iGetFragmentCode(t,s,o,r)+"dp4 "+s+".z, "+s+", "+i+"\n"+"slt "+a+".w, "+r+".z, "+s+".z\n"};e.prototype.iActivateForCascade=function(t,e,i){};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadowMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMethodBase"}],"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/ShadingMethodBase");var o=function(t){r(e,t);function e(e){t.call(this);this._pEpsilon=.02;this._pAlpha=1;this._pCastingLight=e;e.castsShadows=true;this._pShadowMapper=e.shadowMapper}Object.defineProperty(e.prototype,"assetType",{get:function(){return e.assetType},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"alpha",{get:function(){return this._pAlpha},set:function(t){this._pAlpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"castingLight",{get:function(){return this._pCastingLight},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"epsilon",{get:function(){return this._pEpsilon},set:function(t){this._pEpsilon=t},enumerable:true,configurable:true});e.assetType="[asset ShadowMapMethod]";return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/ShadingMethodBase":"awayjs-methodmaterials/lib/methods/ShadingMethodBase"}],"awayjs-methodmaterials/lib/methods/ShadowMethodBase":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/errors/AbstractMethodError");var o=t("awayjs-display/lib/entities/PointLight");var n=t("awayjs-methodmaterials/lib/methods/ShadowMapMethodBase");var s=function(t){r(e,t);function e(e){this._pUsePoint=e instanceof o;t.call(this,e)}e.prototype.iInitVO=function(t,e){e.needsView=true;e.needsGlobalVertexPos=true;e.needsGlobalFragmentPos=this._pUsePoint;e.needsNormals=t.numLights>0;e.textureVO=t.getTextureVO(this._pCastingLight.shadowMapper.depthMap)};e.prototype.iInitConstants=function(t,e){var i=t.fragmentConstantData;var r=t.vertexConstantData;var a=e.fragmentConstantsIndex;i[a]=1;i[a+1]=1/255;i[a+2]=1/65025;i[a+3]=1/16581375;i[a+6]=0;i[a+7]=1;if(this._pUsePoint){i[a+8]=0;i[a+9]=0;i[a+10]=0;i[a+11]=1}a=e.vertexConstantsIndex;if(a!=-1){r[a]=.5;r[a+1]=.5;r[a+2]=0;r[a+3]=1}};Object.defineProperty(e.prototype,"_iDepthMapCoordReg",{get:function(){return this._pDepthMapCoordReg},set:function(t){this._pDepthMapCoordReg=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pDepthMapCoordReg=null};e.prototype.iGetVertexCode=function(t,e,i,r){return this._pUsePoint?this._pGetPointVertexCode(e,i,r):this.pGetPlanarVertexCode(e,i,r)};e.prototype._pGetPointVertexCode=function(t,e,i){t.vertexConstantsIndex=-1;return""};e.prototype.pGetPlanarVertexCode=function(t,e,i){var r="";var a=e.getFreeVertexVectorTemp();var o=e.getFreeVertexConstant();var n=e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();e.getFreeVertexConstant();this._pDepthMapCoordReg=e.getFreeVarying();t.vertexConstantsIndex=o.index*4;r+="m44 "+a+", "+i.globalPositionVertex+", "+n+"\n"+"div "+a+", "+a+", "+a+".w\n"+"mul "+a+".xy, "+a+".xy, "+o+".xy\n"+"add "+this._pDepthMapCoordReg+", "+a+", "+o+".xxwz\n";return r};e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=this._pUsePoint?this._pGetPointFragmentCode(t,e,i,r,a):this._pGetPlanarFragmentCode(t,e,i,r,a);o+="add "+i+".w, "+i+".w, fc"+(e.fragmentConstantsIndex/4+1)+".y\n"+"sat "+i+".w, "+i+".w\n";return o};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r,o){throw new a;return""};e.prototype._pGetPointFragmentCode=function(t,e,i,r,o){throw new a;return""};e.prototype.iSetRenderState=function(t,e,i,r,a){if(!this._pUsePoint)this._pShadowMapper.iDepthProjection.copyRawDataTo(t.vertexConstantData,e.vertexConstantsIndex+4,true)};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,o,n){throw new Error("This shadow method is incompatible with cascade shadows")};e.prototype.iActivate=function(t,e,i){var r=t.fragmentConstantData;var a=e.fragmentConstantsIndex;if(this._pUsePoint)r[a+4]=-Math.pow(1/(this._pCastingLight.fallOff*this._pEpsilon),2);else t.vertexConstantData[e.vertexConstantsIndex+3]=-1/(this._pShadowMapper.depth*this._pEpsilon);r[a+5]=1-this._pAlpha;if(this._pUsePoint){var o=this._pCastingLight.scenePosition;r[a+8]=o.x;r[a+9]=o.y;r[a+10]=o.z;var n=this._pCastingLight.fallOff;r[a+11]=1/(2*n*n)}e.textureVO.activate(t)};e.prototype.iActivateForCascade=function(t,e,i){throw new Error("This shadow method is incompatible with cascade shadows")};return e}(n);e.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase"}],"awayjs-methodmaterials/lib/methods/ShadowNearMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var o=t("awayjs-methodmaterials/lib/methods/ShadowMethodBase");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=.1}t.call(this,e.castingLight);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this._baseMethod=e;this._fadeRatio=i;this._nearShadowMapper=this._pCastingLight.shadowMapper;if(!this._nearShadowMapper)throw new Error("ShadowNearMethod requires a light that has a NearDirectionalShadowMapper instance assigned to shadowMapper.");this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){if(this._baseMethod==t)return;this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod=t;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);this._baseMethod.iInitConstants(e,i);var r=e.fragmentConstantData;var a=i.secondaryFragmentConstantsIndex;r[a+2]=0;r[a+3]=1};e.prototype.iInitVO=function(t,e){this._baseMethod.iInitVO(t,e);e.needsProjection=true};e.prototype.dispose=function(){this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)};Object.defineProperty(e.prototype,"alpha",{get:function(){return this._baseMethod.alpha},set:function(t){this._baseMethod.alpha=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"epsilon",{get:function(){return this._baseMethod.epsilon},set:function(t){this._baseMethod.epsilon=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fadeRatio",{get:function(){return this._fadeRatio},set:function(t){this._fadeRatio=t},enumerable:true,configurable:true});e.prototype.iGetFragmentCode=function(t,e,i,r,a){var o=this._baseMethod.iGetFragmentCode(t,e,i,r,a);var n=r.getFreeFragmentConstant();var s=r.getFreeFragmentSingleTemp();e.secondaryFragmentConstantsIndex=n.index*4;o+="abs "+s+", "+a.projectionFragment+".w\n"+"sub "+s+", "+s+", "+n+".x\n"+"mul "+s+", "+s+", "+n+".y\n"+"sat "+s+", "+s+"\n"+"sub "+s+", "+n+".w,"+s+"\n"+"sub "+i+".w, "+n+".w,"+i+".w\n"+"mul "+i+".w, "+i+".w, "+s+"\n"+"sub "+i+".w, "+n+".w,"+i+".w\n";return o};e.prototype.iActivate=function(t,e,i){this._baseMethod.iActivate(t,e,i)};e.prototype.iDeactivate=function(t,e,i){this._baseMethod.iDeactivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){var o=a.projection.near;var n=a.projection.far-o;var s=this._nearShadowMapper.coverageRatio;var h=s*(1-this._fadeRatio);s=o+s*n;h=o+h*n;var d=t.fragmentConstantData;var u=e.secondaryFragmentConstantsIndex;d[u]=h;d[u+1]=1/(s-h);this._baseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iGetVertexCode=function(t,e,i,r){return this._baseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iReset=function(){this._baseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._baseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(o);e.exports=n},{"awayjs-methodmaterials/lib/methods/ShadowMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMethodBase","awayjs-renderergl/lib/events/ShadingMethodEvent":undefined}],"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/geom/PoissonLookup");var o=t("awayjs-methodmaterials/lib/methods/ShadowMethodBase");var n=function(t){r(e,t);function e(e,i,r){if(i===void 0){i=5}if(r===void 0){r=1}t.call(this,e);this._range=1;this.numSamples=i;this.range=r}Object.defineProperty(e.prototype,"numSamples",{get:function(){return this._numSamples},set:function(t){this._numSamples=t;if(this._numSamples<1)this._numSamples=1;else if(this._numSamples>32)this._numSamples=32;this._offsets=a.getDistribution(this._numSamples);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"range",{get:function(){return this._range},set:function(t){this._range=t},enumerable:true,configurable:true});e.prototype.iInitConstants=function(e,i){t.prototype.iInitConstants.call(this,e,i);e.fragmentConstantData[i.fragmentConstantsIndex+8]=1/this._numSamples;e.fragmentConstantData[i.fragmentConstantsIndex+9]=0};e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=.5*this._range/this._pCastingLight.shadowMapper.depthMapSize;var o=e.fragmentConstantData;var n=i.fragmentConstantsIndex+10;var s=this._numSamples<<1;for(var h=0;h<s;++h)o[n+h]=this._offsets[h]*a};e.prototype._pGetPlanarFragmentCode=function(t,e,i,r,a){var o=r.getFreeFragmentConstant();r.getFreeFragmentConstant();var n=r.getFreeFragmentConstant();e.fragmentConstantsIndex=o.index*4;e.textureVO._iInitRegisters(t,r);return this.getSampleCode(t,e,o,i,r,n)};e.prototype.addSample=function(t,e,i,r,a,o){var n=a.getFreeFragmentVectorTemp();return e.textureVO._iGetFragmentCode(t,n,a,o)+"dp4 "+n+".z, "+n+", "+i+"\n"+"slt "+o+".w, "+this._pDepthMapCoordReg+".z, "+n+".z\n"+"add "+r+".w, "+r+".w, "+o+".w\n"};e.prototype.iActivateForCascade=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=this._range/this._pCastingLight.shadowMapper.depthMapSize;var o=e.fragmentConstantData;var n=i.secondaryFragmentConstantsIndex;var s=this._numSamples<<1;o[n]=1/this._numSamples;o[n+1]=0;n+=2;for(var h=0;h<s;++h)o[n+h]=this._offsets[h]*a;if(s%4==0){o[n+s]=0;o[n+s+1]=0}};e.prototype._iGetCascadeFragmentCode=function(t,e,i,r,a,o,n){this._pDepthMapCoordReg=r;var s=o.getFreeFragmentConstant();e.secondaryFragmentConstantsIndex=s.index*4;return this.getSampleCode(t,e,i,a,o,s)};e.prototype.getSampleCode=function(t,e,i,r,a,o){var n;var s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1);var h=new Array(o+".zw");var d=this._numSamples>>1;for(var u=0;u<d;++u){var p=a.getFreeFragmentConstant();h.push(p+".xy");h.push(p+".zw")}for(u=0;u<this._numSamples;++u){if(u==0){var l=a.getFreeFragmentVectorTemp();n="add "+s+", "+this._pDepthMapCoordReg+", "+o+".zwyy\n"+e.textureVO._iGetFragmentCode(t,l,a,s)+"dp4 "+l+".z, "+l+", "+i+"\n"+"slt "+r+".w, "+this._pDepthMapCoordReg+".z, "+l+".z\n"}else{n+="add "+s+".xy, "+this._pDepthMapCoordReg+".xy, "+h[u]+"\n"+this.addSample(t,e,i,r,a,s)}}a.removeFragmentTempUsage(s);n+="mul "+r+".w, "+r+".w, "+o+".x\n";return n};return e}(o);e.exports=n},{"awayjs-core/lib/geom/PoissonLookup":undefined,"awayjs-methodmaterials/lib/methods/ShadowMethodBase":"awayjs-methodmaterials/lib/methods/ShadowMethodBase"}],"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var o=function(t){r(e,t);function e(){t.call(this)}e.prototype.iInitVO=function(t,e){e.needsTangents=true;e.needsView=true};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight)s=this._pTotalLightColorReg;else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}n+="nrm "+s+".xyz, "+o.tangentVarying+".xyz\n"+"dp3 "+s+".w, "+s+".xyz, "+i+".xyz\n"+"dp3 "+s+".z, "+s+".xyz, "+o.viewDirFragment+".xyz\n";n+="sin "+s+".x, "+s+".w\n"+"sin "+s+".y, "+s+".z\n"+"mul "+s+".x, "+s+".x, "+s+".y\n"+"cos "+s+".z, "+s+".z\n"+"cos "+s+".w, "+s+".w\n"+"mul "+s+".w, "+s+".w, "+s+".z\n"+"sub "+s+".w, "+s+".x, "+s+".w\n";
if(this.texture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+s+".w, "+s+".w, "+this._pSpecularTexData+".w\n"}else n+="pow "+s+".w, "+s+".w, "+this._pSpecularDataRegister+".w\n";n+="mul "+s+".w, "+s+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);n+="mul "+s+".xyz, "+r+".xyz, "+s+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+s+".xyz\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":"awayjs-methodmaterials/lib/methods/SpecularBasicMethod"}],"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/LightingMethodBase");var o=function(t){r(e,t);function e(){t.call(this);this._gloss=50;this._specular=1;this._specularColor=16777215;this._iSpecularR=1;this._iSpecularG=1;this._iSpecularB=1}e.prototype.iIsUsed=function(t){if(!t.numLights)return false;return true};e.prototype.iInitVO=function(t,e){e.needsNormals=t.numLights>0;e.needsView=t.numLights>0;if(this._texture){e.textureVO=t.getTextureVO(this._texture);t.uvDependencies++}else if(e.textureVO){e.textureVO.dispose();e.textureVO=null}};Object.defineProperty(e.prototype,"gloss",{get:function(){return this._gloss},set:function(t){this._gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._specular},set:function(t){if(t==this._specular)return;this._specular=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularColor",{get:function(){return this._specularColor},set:function(t){if(this._specularColor==t)return;if(this._specularColor==0||t==0)this.iInvalidateShaderProgram();this._specularColor=t;this.updateSpecular()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){if(this._texture==t)return;this._texture=t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});e.prototype.copyFrom=function(t){var e=t;var i=t;var r=i;this.texture=r.texture;this.specular=r.specular;this.specularColor=r.specularColor;this.gloss=r.gloss};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._pTotalLightColorReg=null;this._pSpecularTexData=null;this._pSpecularDataRegister=null};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){var a="";this._pIsFirstLight=true;this._pSpecularDataRegister=i.getFreeFragmentConstant();e.fragmentConstantsIndex=this._pSpecularDataRegister.index*4;if(this._texture){this._pSpecularTexData=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(this._pSpecularTexData,1);e.textureVO._iInitRegisters(t,i);a+=e.textureVO._iGetFragmentCode(t,this._pSpecularTexData,i,r.uvVarying)}this._pTotalLightColorReg=i.getFreeFragmentVectorTemp();i.addFragmentTempUsages(this._pTotalLightColorReg,1);return a};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}var h=o.viewDirFragment;var d=o.normalFragment;n+="add "+s+", "+i+", "+h+"\n"+"nrm "+s+".xyz, "+s+"\n"+"dp3 "+s+".w, "+d+", "+s+"\n"+"sat "+s+".w, "+s+".w\n";if(this._texture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+s+".w, "+s+".w, "+this._pSpecularTexData+".w\n"}else{n+="pow "+s+".w, "+s+".w, "+this._pSpecularDataRegister+".w\n"}if(t.usesLightFallOff)n+="mul "+s+".w, "+s+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);n+="mul "+s+".xyz, "+r+", "+s+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+s+"\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}var h=o.normalFragment;var d=o.viewDirFragment;n+="dp3 "+s+".w, "+h+", "+d+"\n"+"add "+s+".w, "+s+".w, "+s+".w\n"+"mul "+s+", "+s+".w, "+h+"\n"+"sub "+s+", "+s+", "+d+"\n"+"tex "+s+", "+s+", "+i+" <cube,"+(t.useSmoothTextures?"linear":"nearest")+",miplinear>\n"+"mul "+s+".xyz, "+s+", "+r+"\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+s+"\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){var o="";if(a.shadowTarget)o+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+a.shadowTarget+".w\n";if(this._texture){o+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+this._pSpecularTexData+".x\n";r.removeFragmentTempUsage(this._pSpecularTexData)}o+="mul "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+", "+this._pSpecularDataRegister+"\n"+"add "+i+".xyz, "+i+", "+this._pTotalLightColorReg+"\n";r.removeFragmentTempUsage(this._pTotalLightColorReg);return o};e.prototype.iActivate=function(t,e,i){if(this._texture)e.textureVO.activate(t);var r=e.fragmentConstantsIndex;var a=t.fragmentConstantData;a[r]=this._iSpecularR;a[r+1]=this._iSpecularG;a[r+2]=this._iSpecularB;a[r+3]=this._gloss};e.prototype.updateSpecular=function(){this._iSpecularR=(this._specularColor>>16&255)/255*this._specular;this._iSpecularG=(this._specularColor>>8&255)/255*this._specular;this._iSpecularB=(this._specularColor&255)/255*this._specular};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/LightingMethodBase":"awayjs-methodmaterials/lib/methods/LightingMethodBase"}],"awayjs-methodmaterials/lib/methods/SpecularCelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/SpecularCompositeMethod");var o=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=.5}if(i===void 0){i=null}t.call(this,null,i);this._smoothness=.1;this._specularCutOff=.1;this.baseMethod._iModulateMethod=function(t,e,i,a,o){return r.clampSpecular(t,e,i,a,o)};this._specularCutOff=e}Object.defineProperty(e.prototype,"smoothness",{get:function(){return this._smoothness},set:function(t){this._smoothness=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularCutOff",{get:function(){return this._specularCutOff},set:function(t){this._specularCutOff=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=i.secondaryFragmentConstantsIndex;var o=e.fragmentConstantData;o[a]=this._smoothness;o[a+1]=this._specularCutOff};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};e.prototype.clampSpecular=function(t,e,i,r,a){return"sub "+i+".y, "+i+".w, "+this._dataReg+".y\n"+"div "+i+".y, "+i+".y, "+this._dataReg+".x\n"+"sat "+i+".y, "+i+".y\n"+"sge "+i+".w, "+i+".w, "+this._dataReg+".y\n"+"mul "+i+".w, "+i+".w, "+i+".y\n"};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/SpecularCompositeMethod":"awayjs-methodmaterials/lib/methods/SpecularCompositeMethod"}],"awayjs-methodmaterials/lib/methods/SpecularCompositeMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var o=t("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var n=function(t){r(e,t);function e(e,i){var r=this;if(i===void 0){i=null}t.call(this);this._onShaderInvalidatedDelegate=function(t){return r.onShaderInvalidated(t)};this._baseMethod=i||new o;this._baseMethod._iModulateMethod=e;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate)}e.prototype.iInitVO=function(t,e){this._baseMethod.iInitVO(t,e)};e.prototype.iInitConstants=function(t,e){this._baseMethod.iInitConstants(t,e)};Object.defineProperty(e.prototype,"baseMethod",{get:function(){return this._baseMethod},set:function(t){if(this._baseMethod==t)return;this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod=t;this._baseMethod.addEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"gloss",{get:function(){return this._baseMethod.gloss},set:function(t){this._baseMethod.gloss=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specular",{get:function(){return this._baseMethod.specular},set:function(t){this._baseMethod.specular=t},enumerable:true,configurable:true});e.prototype.dispose=function(){this._baseMethod.removeEventListener(a.SHADER_INVALIDATED,this._onShaderInvalidatedDelegate);this._baseMethod.dispose()};Object.defineProperty(e.prototype,"texture",{get:function(){return this._baseMethod.texture},set:function(t){this._baseMethod.texture=t},enumerable:true,configurable:true});e.prototype.iActivate=function(t,e,i){this._baseMethod.iActivate(t,e,i)};e.prototype.iSetRenderState=function(t,e,i,r,a){this._baseMethod.iSetRenderState(t,e,i,r,a)};e.prototype.iDeactivate=function(t,e,i){this._baseMethod.iDeactivate(t,e,i)};e.prototype.iGetVertexCode=function(t,e,i,r){return this._baseMethod.iGetVertexCode(t,e,i,r)};e.prototype.iGetFragmentPreLightingCode=function(t,e,i,r){return this._baseMethod.iGetFragmentPreLightingCode(t,e,i,r)};e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){return this._baseMethod.iGetFragmentCodePerLight(t,e,i,r,a,o)};e.prototype.iGetFragmentCodePerProbe=function(t,e,i,r,a,o){return this._baseMethod.iGetFragmentCodePerProbe(t,e,i,r,a,o)};e.prototype.iGetFragmentPostLightingCode=function(t,e,i,r,a){return this._baseMethod.iGetFragmentPostLightingCode(t,e,i,r,a)};e.prototype.iReset=function(){this._baseMethod.iReset()};e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._baseMethod.iCleanCompilationData()};e.prototype.onShaderInvalidated=function(t){this.iInvalidateShaderProgram()};return e}(o);e.exports=n},{"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":"awayjs-methodmaterials/lib/methods/SpecularBasicMethod","awayjs-renderergl/lib/events/ShadingMethodEvent":undefined}],"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/SpecularCompositeMethod");var o=function(t){r(e,t);function e(e,i){var r=this;if(e===void 0){e=true}if(i===void 0){i=null}t.call(this,null,i);this._fresnelPower=5;this._normalReflectance=.028;this.baseMethod._iModulateMethod=function(t,e,i,a,o){return r.modulateSpecular(t,e,i,a,o)};this._incidentLight=!e}e.prototype.iInitConstants=function(t,e){var i=e.secondaryFragmentConstantsIndex;t.fragmentConstantData[i+2]=1;t.fragmentConstantData[i+3]=0};Object.defineProperty(e.prototype,"basedOnSurface",{get:function(){return!this._incidentLight},set:function(t){if(this._incidentLight!=t)return;this._incidentLight=!t;this.iInvalidateShaderProgram()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"fresnelPower",{get:function(){return this._fresnelPower},set:function(t){this._fresnelPower=t},enumerable:true,configurable:true});e.prototype.iCleanCompilationData=function(){t.prototype.iCleanCompilationData.call(this);this._dataReg=null};Object.defineProperty(e.prototype,"normalReflectance",{get:function(){return this._normalReflectance},set:function(t){this._normalReflectance=t},enumerable:true,configurable:true});e.prototype.iActivate=function(e,i,r){t.prototype.iActivate.call(this,e,i,r);var a=e.fragmentConstantData;var o=i.secondaryFragmentConstantsIndex;a[o]=this._normalReflectance;a[o+1]=this._fresnelPower};e.prototype.iGetFragmentPreLightingCode=function(e,i,r,a){this._dataReg=r.getFreeFragmentConstant();i.secondaryFragmentConstantsIndex=this._dataReg.index*4;return t.prototype.iGetFragmentPreLightingCode.call(this,e,i,r,a)};e.prototype.modulateSpecular=function(t,e,i,r,a){var o;o="dp3 "+i+".y, "+a.viewDirFragment+".xyz, "+(this._incidentLight?i:a.normalFragment)+".xyz\n"+"sub "+i+".y, "+this._dataReg+".z, "+i+".y\n"+"pow "+i+".x, "+i+".y, "+this._dataReg+".y\n"+"sub "+i+".y, "+this._dataReg+".z, "+i+".y\n"+"mul "+i+".y, "+this._dataReg+".x, "+i+".y\n"+"add "+i+".y, "+i+".x, "+i+".y\n"+"mul "+i+".w, "+i+".w, "+i+".y\n";return o};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/SpecularCompositeMethod":"awayjs-methodmaterials/lib/methods/SpecularCompositeMethod"}],"awayjs-methodmaterials/lib/methods/SpecularPhongMethod":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var o=function(t){r(e,t);function e(){t.call(this)}e.prototype.iGetFragmentCodePerLight=function(t,e,i,r,a,o){var n="";var s;if(this._pIsFirstLight){s=this._pTotalLightColorReg}else{s=a.getFreeFragmentVectorTemp();a.addFragmentTempUsages(s,1)}var h=o.viewDirFragment;var d=o.normalFragment;n+="dp3 "+s+".w, "+i+", "+d+"\n"+"add "+s+".w, "+s+".w, "+s+".w\n"+"mul "+s+".xyz, "+d+", "+s+".w\n"+"sub "+s+".xyz, "+s+", "+i+"\n"+"add "+s+".w, "+s+".w, "+o.commons+".w\n"+"sat "+s+".w, "+s+".w\n"+"mul "+s+".xyz, "+s+", "+s+".w\n"+"dp3 "+s+".w, "+s+", "+h+"\n"+"sat "+s+".w, "+s+".w\n";if(this.texture){n+="mul "+this._pSpecularTexData+".w, "+this._pSpecularTexData+".y, "+this._pSpecularDataRegister+".w\n"+"pow "+s+".w, "+s+".w, "+this._pSpecularTexData+".w\n"}else n+="pow "+s+".w, "+s+".w, "+this._pSpecularDataRegister+".w\n";if(t.usesLightFallOff)n+="mul "+s+".w, "+s+".w, "+i+".w\n";if(this._iModulateMethod!=null)n+=this._iModulateMethod(t,e,s,a,o);n+="mul "+s+".xyz, "+r+".xyz, "+s+".w\n";if(!this._pIsFirstLight){n+="add "+this._pTotalLightColorReg+".xyz, "+this._pTotalLightColorReg+".xyz, "+s+".xyz\n";a.removeFragmentTempUsage(s)}this._pIsFirstLight=false;return n};return e}(a);e.exports=o},{"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":"awayjs-methodmaterials/lib/methods/SpecularBasicMethod"}],"awayjs-methodmaterials/lib/render/MethodMaterialRender":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/BlendMode");var o=t("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var n=t("awayjs-stagegl/lib/base/ContextGLCompareMode");var s=t("awayjs-renderergl/lib/render/RenderBase");var h=t("awayjs-methodmaterials/lib/MethodMaterialMode");var d=t("awayjs-methodmaterials/lib/render/passes/MethodPassMode");var u=t("awayjs-methodmaterials/lib/render/passes/MethodPass");var p=function(t){r(e,t);function e(e,i,r,a){t.call(this,e,i,r,a);this._material=i}Object.defineProperty(e.prototype,"numLights",{get:function(){return this._material.lightPicker?this._material.lightPicker.numLightProbes+this._material.lightPicker.numDirectionalLights+this._material.lightPicker.numPointLights+this._material.lightPicker.numCastingDirectionalLights+this._material.lightPicker.numCastingPointLights:0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"numNonCasters",{get:function(){return this._material.lightPicker?this._material.lightPicker.numLightProbes+this._material.lightPicker.numDirectionalLights+this._material.lightPicker.numPointLights:0},enumerable:true,configurable:true});e.prototype._pUpdateRender=function(){t.prototype._pUpdateRender.call(this);this.initPasses();this.setBlendAndCompareModes();this._pClearPasses();if(this._material.mode==h.MULTI_PASS){if(this._casterLightPass)this._pAddPass(this._casterLightPass);if(this._nonCasterLightPasses)for(var e=0;e<this._nonCasterLightPasses.length;++e)this._pAddPass(this._nonCasterLightPasses[e])}if(this._pass)this._pAddPass(this._pass)};e.prototype.initPasses=function(){if(this.numLights==0||this._material.numEffectMethods>0||this._material.mode==h.SINGLE_PASS)this.initEffectPass();else if(this._pass)this.removeEffectPass();if(this._material.shadowMethod&&this._material.mode==h.MULTI_PASS)this.initCasterLightPass();else if(this._casterLightPass)this.removeCasterLightPass();if(this.numNonCasters>0&&this._material.mode==h.MULTI_PASS)this.initNonCasterLightPasses();else if(this._nonCasterLightPasses)this.removeNonCasterLightPasses()};e.prototype.setBlendAndCompareModes=function(){var t=Boolean(this._casterLightPass||this._pass);if(this._casterLightPass){this._casterLightPass.forceSeparateMVP=t;this._casterLightPass.shader.setBlendMode(a.NORMAL);this._casterLightPass.shader.depthCompareMode=this._material.depthCompareMode}if(this._nonCasterLightPasses){var e=0;if(!this._casterLightPass){this._nonCasterLightPasses[0].forceSeparateMVP=t;this._nonCasterLightPasses[0].shader.setBlendMode(a.NORMAL);this._nonCasterLightPasses[0].shader.depthCompareMode=this._material.depthCompareMode;e=1}for(var i=e;i<this._nonCasterLightPasses.length;++i){this._nonCasterLightPasses[i].forceSeparateMVP=t;this._nonCasterLightPasses[i].shader.setBlendMode(a.ADD);this._nonCasterLightPasses[i].shader.depthCompareMode=n.LESS_EQUAL}}if(this._casterLightPass||this._nonCasterLightPasses){this._pRequiresBlending=false;if(this._pass){this._pass.mode=d.EFFECTS;this._pass.forceSeparateMVP=t;this._pass.shader.depthCompareMode=n.LESS_EQUAL;this._pass.shader.setBlendMode(a.LAYER)}}else if(this._pass){this._pRequiresBlending=this._material.blendMode!=a.NORMAL||this._material.alphaBlending||this._material.colorTransform&&this._material.colorTransform.alphaMultiplier<1;this._pass.mode=d.SUPER_SHADER;this._pass.preserveAlpha=this._pRequiresBlending;this._pass.forceSeparateMVP=false;this._pass.colorTransform=this._material.colorTransform;this._pass.shader.setBlendMode(this._material.blendMode==a.NORMAL&&this._pRequiresBlending?a.LAYER:this._material.blendMode);this._pass.shader.depthCompareMode=this._material.depthCompareMode}};e.prototype.initCasterLightPass=function(){if(this._casterLightPass==null)this._casterLightPass=new u(d.LIGHTING,this,this._material,this._renderableClass,this._stage);this._casterLightPass.lightPicker=new o([this._material.shadowMethod.castingLight]);this._casterLightPass.shadowMethod=this._material.shadowMethod;this._casterLightPass.diffuseMethod=this._material.diffuseMethod;this._casterLightPass.ambientMethod=this._material.ambientMethod;this._casterLightPass.normalMethod=this._material.normalMethod;this._casterLightPass.specularMethod=this._material.specularMethod};e.prototype.removeCasterLightPass=function(){this._casterLightPass.dispose();this._pRemovePass(this._casterLightPass);this._casterLightPass=null};e.prototype.initNonCasterLightPasses=function(){this.removeNonCasterLightPasses();var t;var e=this._material.lightPicker.numDirectionalLights;var i=this._material.lightPicker.numPointLights;var r=this._material.lightPicker.numLightProbes;var a=0;var o=0;var n=0;if(!this._casterLightPass){e+=this._material.lightPicker.numCastingDirectionalLights;i+=this._material.lightPicker.numCastingPointLights}this._nonCasterLightPasses=new Array;while(a<e||o<i||n<r){t=new u(d.LIGHTING,this,this._material,this._renderableClass,this._stage);t.includeCasters=this._material.shadowMethod==null;t.directionalLightsOffset=a;t.pointLightsOffset=o;t.lightProbesOffset=n;t.lightPicker=this._material.lightPicker;t.diffuseMethod=this._material.diffuseMethod;t.ambientMethod=this._material.ambientMethod;t.normalMethod=this._material.normalMethod;t.specularMethod=this._material.specularMethod;this._nonCasterLightPasses.push(t);a+=t.numDirectionalLights;o+=t.numPointLights;n+=t.numLightProbes}};e.prototype.removeNonCasterLightPasses=function(){if(!this._nonCasterLightPasses)return;for(var t=0;t<this._nonCasterLightPasses.length;++t)this._pRemovePass(this._nonCasterLightPasses[t]);this._nonCasterLightPasses=null};e.prototype.removeEffectPass=function(){if(this._pass.ambientMethod!=this._material.ambientMethod)this._pass.ambientMethod.dispose();if(this._pass.diffuseMethod!=this._material.diffuseMethod)this._pass.diffuseMethod.dispose();if(this._pass.specularMethod!=this._material.specularMethod)this._pass.specularMethod.dispose();if(this._pass.normalMethod!=this._material.normalMethod)this._pass.normalMethod.dispose();this._pRemovePass(this._pass);this._pass=null};e.prototype.initEffectPass=function(){if(this._pass==null)this._pass=new u(d.SUPER_SHADER,this,this._material,this._renderableClass,this._stage);if(this._material.mode==h.SINGLE_PASS){this._pass.ambientMethod=this._material.ambientMethod;this._pass.diffuseMethod=this._material.diffuseMethod;this._pass.specularMethod=this._material.specularMethod;this._pass.normalMethod=this._material.normalMethod;this._pass.shadowMethod=this._material.shadowMethod}else if(this._material.mode==h.MULTI_PASS){if(this.numLights==0){this._pass.ambientMethod=this._material.ambientMethod}else{this._pass.ambientMethod=null}this._pass.preserveAlpha=false;this._pass.normalMethod=this._material.normalMethod}var t=0;var e;var i=Math.max(this._material.numEffectMethods,this._pass.numEffectMethods);while(t<i){e=this._material.getEffectMethodAt(t);if(e!=this._pass.getEffectMethodAt(t)){this._pass.removeEffectMethodAt(t);if(e!=null){if(t<this._pass.numEffectMethods)this._pass.addEffectMethodAt(e,t);else this._pass.addEffectMethod(e)}}t++}};e.prototype.dispose=function(){t.prototype.dispose.call(this)};return e}(s);e.exports=p},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":"awayjs-methodmaterials/lib/MethodMaterialMode","awayjs-methodmaterials/lib/render/passes/MethodPass":"awayjs-methodmaterials/lib/render/passes/MethodPass","awayjs-methodmaterials/lib/render/passes/MethodPassMode":"awayjs-methodmaterials/lib/render/passes/MethodPassMode","awayjs-renderergl/lib/render/RenderBase":undefined,"awayjs-stagegl/lib/base/ContextGLCompareMode":undefined}],"awayjs-methodmaterials/lib/render/passes/MethodPassMode":[function(t,e,i){var r=function(){function t(){}t.EFFECTS=1;t.LIGHTING=2;t.SUPER_SHADER=3;return t}();e.exports=r},{}],"awayjs-methodmaterials/lib/render/passes/MethodPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/events/Event");var o=t("awayjs-display/lib/materials/LightSources");var n=t("awayjs-renderergl/lib/shaders/LightingShader");var s=t("awayjs-renderergl/lib/events/ShadingMethodEvent");var h=t("awayjs-renderergl/lib/shaders/ShaderBase");var d=t("awayjs-renderergl/lib/render/passes/PassBase");var u=t("awayjs-methodmaterials/lib/data/MethodVO");var p=t("awayjs-methodmaterials/lib/methods/EffectColorTransformMethod");var l=t("awayjs-methodmaterials/lib/render/passes/MethodPassMode");var m=function(t){r(e,t);function e(e,i,r,a,o){var n=this;t.call(this,i,r,a,o);this._maxLights=3;this._mode=3;this._includeCasters=true;this._iMethodVOs=new Array;this._numEffectDependencies=0;this.numDirectionalLights=0;this.numPointLights=0;this.numLightProbes=0;this.pointLightsOffset=0;this.directionalLightsOffset=0;this.lightProbesOffset=0;this._mode=e;this._material=r;this._onLightsChangeDelegate=function(t){return n.onLightsChange(t)};this._onMethodInvalidatedDelegate=function(t){return n.onMethodInvalidated(t)};this.lightPicker=r.lightPicker;if(this._shader==null)this._updateShader()}Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){if(this._mode==t)return;this._mode=t;this._updateLights()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"includeCasters",{get:function(){return this._includeCasters},set:function(t){if(this._includeCasters==t)return;this._includeCasters=t;this._updateLights()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lightPicker",{get:function(){return this._lightPicker},set:function(t){if(this._lightPicker)this._lightPicker.removeEventListener(a.CHANGE,this._onLightsChangeDelegate);this._lightPicker=t;if(this._lightPicker)this._lightPicker.addEventListener(a.CHANGE,this._onLightsChangeDelegate);this._updateLights()},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"enableLightFallOff",{get:function(){return this._material.enableLightFallOff},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseLightSources",{get:function(){return this._material.diffuseLightSources},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularLightSources",{get:function(){return this._material.specularLightSources},enumerable:true,configurable:true});e.prototype._updateShader=function(){if((this.numDirectionalLights||this.numPointLights||this.numLightProbes)&&!(this._shader instanceof n)){if(this._shader!=null)this._shader.dispose();this._shader=new n(this._renderableClass,this,this._stage)}else if(!(this._shader instanceof h)){if(this._shader!=null)this._shader.dispose();this._shader=new h(this._renderableClass,this,this._stage)}};e.prototype._iInitConstantData=function(e){t.prototype._iInitConstantData.call(this,e);var i=this._iMethodVOs.length;for(var r=0;r<i;++r)this._iMethodVOs[r].method.iInitConstants(e,this._iMethodVOs[r])};Object.defineProperty(e.prototype,"colorTransform",{get:function(){return this.colorTransformMethod?this.colorTransformMethod.colorTransform:null},set:function(t){if(t){if(this.colorTransformMethod==null)this.colorTransformMethod=new p;this.colorTransformMethod.colorTransform=t}else if(!t){if(this.colorTransformMethod)this.colorTransformMethod=null}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"colorTransformMethod",{get:function(){return this._iColorTransformMethodVO?this._iColorTransformMethodVO.method:null},set:function(t){if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.method==t)return;if(this._iColorTransformMethodVO){this._removeDependency(this._iColorTransformMethodVO);this._iColorTransformMethodVO=null}if(t){this._iColorTransformMethodVO=new u(t);this._addDependency(this._iColorTransformMethodVO)}},enumerable:true,configurable:true});e.prototype._removeDependency=function(t,e){if(e===void 0){e=false}var i=this._iMethodVOs.indexOf(t);if(!e)this._numEffectDependencies--;t.method.removeEventListener(s.SHADER_INVALIDATED,this._onMethodInvalidatedDelegate);this._iMethodVOs.splice(i,1);this.invalidatePass()};e.prototype._addDependency=function(t,e,i){if(e===void 0){e=false}if(i===void 0){i=-1}t.method.addEventListener(s.SHADER_INVALIDATED,this._onMethodInvalidatedDelegate);if(e){if(i!=-1)this._iMethodVOs.splice(i+this._iMethodVOs.length-this._numEffectDependencies,0,t);else this._iMethodVOs.push(t);this._numEffectDependencies++}else{this._iMethodVOs.splice(this._iMethodVOs.length-this._numEffectDependencies,0,t)}this.invalidatePass()};e.prototype.addEffectMethod=function(t){this._addDependency(new u(t),true)};Object.defineProperty(e.prototype,"numEffectMethods",{get:function(){return this._numEffectDependencies},enumerable:true,configurable:true});e.prototype.hasEffectMethod=function(t){return this.getDependencyForMethod(t)!=null};e.prototype.getEffectMethodAt=function(t){if(t<0||t>this._numEffectDependencies-1)return null;return this._iMethodVOs[t+this._iMethodVOs.length-this._numEffectDependencies].method};e.prototype.addEffectMethodAt=function(t,e){this._addDependency(new u(t),true,e)};e.prototype.removeEffectMethod=function(t){var e=this.getDependencyForMethod(t);if(e!=null)this._removeDependency(e,true)};e.prototype.removeEffectMethodAt=function(t){if(t<0||t>this._numEffectDependencies-1)return;var e=this._iMethodVOs[t+this._iMethodVOs.length-this._numEffectDependencies];if(e!=null)this._removeDependency(e,true)};e.prototype.getDependencyForMethod=function(t){var e=this._iMethodVOs.length;for(var i=0;i<e;++i)if(this._iMethodVOs[i].method==t)return this._iMethodVOs[i];return null};Object.defineProperty(e.prototype,"normalMethod",{get:function(){return this._iNormalMethodVO?this._iNormalMethodVO.method:null},set:function(t){if(this._iNormalMethodVO&&this._iNormalMethodVO.method==t)return;if(this._iNormalMethodVO){this._removeDependency(this._iNormalMethodVO);this._iNormalMethodVO=null}if(t){this._iNormalMethodVO=new u(t);this._addDependency(this._iNormalMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"ambientMethod",{get:function(){return this._iAmbientMethodVO?this._iAmbientMethodVO.method:null},set:function(t){if(this._iAmbientMethodVO&&this._iAmbientMethodVO.method==t)return;if(this._iAmbientMethodVO){this._removeDependency(this._iAmbientMethodVO);this._iAmbientMethodVO=null}if(t){this._iAmbientMethodVO=new u(t);this._addDependency(this._iAmbientMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"shadowMethod",{get:function(){return this._iShadowMethodVO?this._iShadowMethodVO.method:null},set:function(t){if(this._iShadowMethodVO&&this._iShadowMethodVO.method==t)return;if(this._iShadowMethodVO){this._removeDependency(this._iShadowMethodVO);this._iShadowMethodVO=null}if(t){this._iShadowMethodVO=new u(t);this._addDependency(this._iShadowMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"diffuseMethod",{get:function(){return this._iDiffuseMethodVO?this._iDiffuseMethodVO.method:null},set:function(t){if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.method==t)return;if(this._iDiffuseMethodVO){this._removeDependency(this._iDiffuseMethodVO);this._iDiffuseMethodVO=null}if(t){this._iDiffuseMethodVO=new u(t);this._addDependency(this._iDiffuseMethodVO)}},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"specularMethod",{get:function(){return this._iSpecularMethodVO?this._iSpecularMethodVO.method:null},set:function(t){if(this._iSpecularMethodVO&&this._iSpecularMethodVO.method==t)return;if(this._iSpecularMethodVO){this._removeDependency(this._iSpecularMethodVO);this._iSpecularMethodVO=null}if(t){this._iSpecularMethodVO=new u(t);this._addDependency(this._iSpecularMethodVO)}},enumerable:true,configurable:true});e.prototype.dispose=function(){t.prototype.dispose.call(this);if(this._lightPicker)this._lightPicker.removeEventListener(a.CHANGE,this._onLightsChangeDelegate);while(this._iMethodVOs.length)this._removeDependency(this._iMethodVOs[0]);this._iMethodVOs=null};e.prototype.onMethodInvalidated=function(t){this.invalidatePass()};e.prototype._iActivate=function(e){t.prototype._iActivate.call(this,e);var i;var r=this._iMethodVOs.length;for(var a=0;a<r;++a){i=this._iMethodVOs[a];if(i.useMethod)i.method.iActivate(this._shader,i,this._stage)}};e.prototype._iRender=function(e,i,r){t.prototype._iRender.call(this,e,i,r);var a;var o=this._iMethodVOs.length;for(var n=0;n<o;++n){a=this._iMethodVOs[n];if(a.useMethod)a.method.iSetRenderState(this._shader,a,e,this._stage,i)}};e.prototype._iDeactivate=function(){t.prototype._iDeactivate.call(this);
var e;var i=this._iMethodVOs.length;for(var r=0;r<i;++r){e=this._iMethodVOs[r];if(e.useMethod)e.method.iDeactivate(this._shader,e,this._stage)}};e.prototype._iIncludeDependencies=function(e){t.prototype._iIncludeDependencies.call(this,e);e.usesFragmentAnimation=Boolean(this._mode==l.SUPER_SHADER);if(e.useAlphaPremultiplied&&e.usesBlending)e.usesCommonData=true;var i;var r=this._iMethodVOs.length;for(i=0;i<r;++i)this.setupAndCountDependencies(e,this._iMethodVOs[i]);var a=true;var o;for(i=0;i<r;++i){o=this._iMethodVOs[i];if((o.useMethod=o.method.iIsUsed(e))&&!o.method.iUsesTangentSpace())a=false}e.outputsNormals=this._iNormalMethodVO&&this._iNormalMethodVO.useMethod;e.outputsTangentNormals=e.outputsNormals&&this._iNormalMethodVO.method.iOutputsTangentNormals();e.usesTangentSpace=e.outputsTangentNormals&&!e.usesProbes&&a;if(!e.usesTangentSpace){if(e.viewDirDependencies>0){e.globalPosDependencies++}else if(this.numPointLights>0&&e.usesLights){e.globalPosDependencies++;if(Boolean(this._mode&l.EFFECTS))e.usesGlobalPosFragment=true}}};e.prototype.setupAndCountDependencies=function(t,e){e.reset();e.method.iInitVO(t,e);if(e.needsProjection)t.projectionDependencies++;if(e.needsGlobalVertexPos||e.needsGlobalFragmentPos){t.globalPosDependencies++;if(e.needsGlobalFragmentPos)t.usesGlobalPosFragment=true}if(e.needsNormals)t.normalDependencies++;if(e.needsTangents)t.tangentDependencies++;if(e.needsView)t.viewDirDependencies++};e.prototype._iGetPreLightingVertexCode=function(t,e,i){var r="";if(this._iAmbientMethodVO&&this._iAmbientMethodVO.useMethod)r+=this._iAmbientMethodVO.method.iGetVertexCode(t,this._iAmbientMethodVO,e,i);if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod)r+=this._iDiffuseMethodVO.method.iGetVertexCode(t,this._iDiffuseMethodVO,e,i);if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod)r+=this._iSpecularMethodVO.method.iGetVertexCode(t,this._iSpecularMethodVO,e,i);return r};e.prototype._iGetPreLightingFragmentCode=function(t,e,i){var r="";if(this._iAmbientMethodVO&&this._iAmbientMethodVO.useMethod){r+=this._iAmbientMethodVO.method.iGetFragmentCode(t,this._iAmbientMethodVO,i.shadedTarget,e,i);if(this._iAmbientMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iAmbientMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod)r+=this._iDiffuseMethodVO.method.iGetFragmentPreLightingCode(t,this._iDiffuseMethodVO,e,i);if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod)r+=this._iSpecularMethodVO.method.iGetFragmentPreLightingCode(t,this._iSpecularMethodVO,e,i);return r};e.prototype._iGetPerLightDiffuseFragmentCode=function(t,e,i,r,a){return this._iDiffuseMethodVO.method.iGetFragmentCodePerLight(t,this._iDiffuseMethodVO,e,i,r,a)};e.prototype._iGetPerLightSpecularFragmentCode=function(t,e,i,r,a){return this._iSpecularMethodVO.method.iGetFragmentCodePerLight(t,this._iSpecularMethodVO,e,i,r,a)};e.prototype._iGetPerProbeDiffuseFragmentCode=function(t,e,i,r,a){return this._iDiffuseMethodVO.method.iGetFragmentCodePerProbe(t,this._iDiffuseMethodVO,e,i,r,a)};e.prototype._iGetPerProbeSpecularFragmentCode=function(t,e,i,r,a){return this._iSpecularMethodVO.method.iGetFragmentCodePerProbe(t,this._iSpecularMethodVO,e,i,r,a)};e.prototype._iGetPostLightingVertexCode=function(t,e,i){var r="";if(this._iShadowMethodVO)r+=this._iShadowMethodVO.method.iGetVertexCode(t,this._iShadowMethodVO,e,i);return r};e.prototype._iGetPostLightingFragmentCode=function(t,e,i){var r="";if(t.useAlphaPremultiplied&&t.usesBlending){r+="add "+i.shadedTarget+".w, "+i.shadedTarget+".w, "+i.commons+".z\n"+"div "+i.shadedTarget+".xyz, "+i.shadedTarget+", "+i.shadedTarget+".w\n"+"sub "+i.shadedTarget+".w, "+i.shadedTarget+".w, "+i.commons+".z\n"+"sat "+i.shadedTarget+".xyz, "+i.shadedTarget+"\n"}if(this._iShadowMethodVO)r+=this._iShadowMethodVO.method.iGetFragmentCode(t,this._iShadowMethodVO,i.shadowTarget,e,i);if(this._iDiffuseMethodVO&&this._iDiffuseMethodVO.useMethod){r+=this._iDiffuseMethodVO.method.iGetFragmentPostLightingCode(t,this._iDiffuseMethodVO,i.shadedTarget,e,i);if(this._iDiffuseMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iDiffuseMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iSpecularMethodVO&&this._iSpecularMethodVO.useMethod){r+=this._iSpecularMethodVO.method.iGetFragmentPostLightingCode(t,this._iSpecularMethodVO,i.shadedTarget,e,i);if(this._iSpecularMethodVO.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(this._iSpecularMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}if(this._iShadowMethodVO)e.removeFragmentTempUsage(i.shadowTarget);return r};e.prototype._iGetNormalVertexCode=function(t,e,i){return this._iNormalMethodVO.method.iGetVertexCode(t,this._iNormalMethodVO,e,i)};e.prototype._iGetNormalFragmentCode=function(t,e,i){var r=this._iNormalMethodVO.method.iGetFragmentCode(t,this._iNormalMethodVO,i.normalFragment,e,i);if(this._iNormalMethodVO.needsView)e.removeFragmentTempUsage(i.viewDirFragment);if(this._iNormalMethodVO.needsGlobalFragmentPos||this._iNormalMethodVO.needsGlobalVertexPos)e.removeVertexTempUsage(i.globalPositionVertex);return r};e.prototype._iGetVertexCode=function(t,e,i){var r="";var a;var o=this._iMethodVOs.length;for(var n=o-this._numEffectDependencies;n<o;n++){a=this._iMethodVOs[n];if(a.useMethod){r+=a.method.iGetVertexCode(t,a,e,i);if(a.needsGlobalVertexPos||a.needsGlobalFragmentPos)e.removeVertexTempUsage(i.globalPositionVertex)}}if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.useMethod)r+=this._iColorTransformMethodVO.method.iGetVertexCode(t,this._iColorTransformMethodVO,e,i);return r};e.prototype._iGetFragmentCode=function(t,e,i){var r="";var a;if(this.preserveAlpha&&this._numEffectDependencies>0){a=e.getFreeFragmentSingleTemp();e.addFragmentTempUsages(a,1);r+="mov "+a+", "+i.shadedTarget+".w\n"}var o;var n=this._iMethodVOs.length;for(var s=n-this._numEffectDependencies;s<n;s++){o=this._iMethodVOs[s];if(o.useMethod){r+=o.method.iGetFragmentCode(t,o,i.shadedTarget,e,i);if(o.needsNormals)e.removeFragmentTempUsage(i.normalFragment);if(o.needsView)e.removeFragmentTempUsage(i.viewDirFragment)}}if(this.preserveAlpha&&this._numEffectDependencies>0){r+="mov "+i.shadedTarget+".w, "+a+"\n";e.removeFragmentTempUsage(a)}if(this._iColorTransformMethodVO&&this._iColorTransformMethodVO.useMethod)r+=this._iColorTransformMethodVO.method.iGetFragmentCode(t,this._iColorTransformMethodVO,i.shadedTarget,e,i);return r};e.prototype._iUsesShadows=function(t){return Boolean(this._iShadowMethodVO&&(this._lightPicker.castingDirectionalLights.length>0||this._lightPicker.castingPointLights.length>0))};e.prototype._iUsesSpecular=function(t){return Boolean(this._iSpecularMethodVO)};e.prototype._iUsesDiffuse=function(t){return Boolean(this._iDiffuseMethodVO)};e.prototype.onLightsChange=function(t){this._updateLights()};e.prototype._updateLights=function(){var t=this.numDirectionalLights;var e=this.numPointLights;var i=this.numLightProbes;if(this._lightPicker&&this._mode&l.LIGHTING){this.numDirectionalLights=this.calculateNumDirectionalLights(this._lightPicker.numDirectionalLights);this.numPointLights=this.calculateNumPointLights(this._lightPicker.numPointLights);this.numLightProbes=this.calculateNumProbes(this._lightPicker.numLightProbes);if(this._includeCasters){this.numDirectionalLights+=this._lightPicker.numCastingDirectionalLights;this.numPointLights+=this._lightPicker.numCastingPointLights}}else{this.numDirectionalLights=0;this.numPointLights=0;this.numLightProbes=0}if(t!=this.numDirectionalLights||e!=this.numPointLights||i!=this.numLightProbes){this._updateShader();this.invalidatePass()}};e.prototype.calculateNumDirectionalLights=function(t){return Math.min(t-this.directionalLightsOffset,this._maxLights)};e.prototype.calculateNumPointLights=function(t){var e=this._maxLights-this.numDirectionalLights;return Math.min(t-this.pointLightsOffset,e)};e.prototype.calculateNumProbes=function(t){var e=0;if((this.specularLightSources&o.PROBES)!=0)++e;if((this.diffuseLightSources&o.PROBES)!=0)++e;return Math.min(t-this.lightProbesOffset,4/e|0)};return e}(d);e.exports=m},{"awayjs-core/lib/events/Event":undefined,"awayjs-display/lib/materials/LightSources":undefined,"awayjs-methodmaterials/lib/data/MethodVO":"awayjs-methodmaterials/lib/data/MethodVO","awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod","awayjs-methodmaterials/lib/render/passes/MethodPassMode":"awayjs-methodmaterials/lib/render/passes/MethodPassMode","awayjs-renderergl/lib/events/ShadingMethodEvent":undefined,"awayjs-renderergl/lib/render/passes/PassBase":undefined,"awayjs-renderergl/lib/shaders/LightingShader":undefined,"awayjs-renderergl/lib/shaders/ShaderBase":undefined}],"awayjs-methodmaterials/lib/render/passes/SingleObjectDepthPass":[function(t,e,i){var r=this.__extends||function(t,e){for(var i in e)if(e.hasOwnProperty(i))t[i]=e[i];function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var a=t("awayjs-core/lib/data/Image2D");var o=t("awayjs-core/lib/geom/Matrix3D");var n=t("awayjs-display/lib/textures/Single2DTexture");var s=t("awayjs-stagegl/lib/base/ContextGLDrawMode");var h=t("awayjs-stagegl/lib/base/ContextGLProgramType");var d=t("awayjs-renderergl/lib/render/passes/PassBase");var u=t("awayjs-renderergl/lib/vos/SubGeometryVOPool");var p=function(t){r(e,t);function e(e,i,r,a){t.call(this,e,i,r,a);this._textureSize=512;this._polyOffset=new Float32Array([15,0,0,0]);this._projectionTexturesInvalid=true;this._subGeometryVOPool=u.getPool()}Object.defineProperty(e.prototype,"textureSize",{get:function(){return this._textureSize},set:function(t){this._textureSize=t},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"polyOffset",{get:function(){return this._polyOffset[0]},set:function(t){this._polyOffset[0]=t},enumerable:true,configurable:true});e.prototype.dispose=function(){if(this._textures){for(var t in this._textures){var e=this._textures[t];e.dispose()}this._textures=null}};e.prototype.updateProjectionTextures=function(){if(this._textures){for(var t in this._textures){var e=this._textures[t];e.dispose()}}this._textures=new Object;this._projections=new Object;this._projectionTexturesInvalid=false};e.prototype._iGetVertexCode=function(){var t;t="mul vt7, vt1, vc4.x	\n"+"add vt7, vt7, vt0\n"+"mov vt7.w, vt0.w\n";t+="m44 vt2, vt7, vc0\n"+"mov op, vt2\n";t+="div v0, vt2, vt2.w\n";return t};e.prototype._iGetFragmentCode=function(t,e,i){var r="";r+="mul ft0, fc0, v0.z\n"+"frc ft0, ft0\n"+"mul ft1, ft0.yzww, fc1\n"+"sub ft0, ft0, ft1\n"+"mov oc, ft0\n";return r};e.prototype._iGetDepthMap=function(t){return this._textures[t.renderableOwner.id]};e.prototype._iGetProjection=function(t){return this._projections[t.renderableOwner.id]};e.prototype._iRender=function(t,e,i){var r;var d=this._stage.context;var u;var p;var l=this._renderOwner.lightPicker.allPickedLights;var m=t.renderableOwner.id;if(!this._textures[m])this._textures[m]=new n(new a(this._textureSize,this._textureSize));if(!this._projections[m])this._projections[m]=new o;u=l.length;p=l[0];r=p.iGetObjectProjectionMatrix(t.sourceEntity,e,this._projections[m]);this._stage.setRenderTarget(this._textures[m],true);d.clear(1,1,1);d.setProgramConstantsFromMatrix(h.VERTEX,0,r,true);d.setProgramConstantsFromArray(h.FRAGMENT,0,this._enc,2);var c=t.subGeometryVO;var f=c.subGeometry;c.activateVertexBufferVO(0,f.positions,this._stage);c.activateVertexBufferVO(1,f.normals,this._stage);c.getIndexBufferVO(this._stage).draw(s.TRIANGLES,0,c.subGeometry.numElements)};e.prototype._iActivate=function(e){if(this._projectionTexturesInvalid)this.updateProjectionTextures();t.prototype._iActivate.call(this,e);this._stage.context.setProgramConstantsFromArray(h.VERTEX,4,this._polyOffset,1)};return e}(d);e.exports=p},{"awayjs-core/lib/data/Image2D":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-renderergl/lib/render/passes/PassBase":undefined,"awayjs-renderergl/lib/vos/SubGeometryVOPool":undefined,"awayjs-stagegl/lib/base/ContextGLDrawMode":undefined,"awayjs-stagegl/lib/base/ContextGLProgramType":undefined}]},{},[]);


require=function e(t,r,a){function o(n,p){if(!r[n]){if(!t[n]){var s=typeof require=="function"&&require;if(!p&&s)return s(n,!0);if(i)return i(n,!0);var u=new Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[n]={exports:{}};t[n][0].call(l.exports,function(e){var r=t[n][1][e];return o(r?r:e)},l,l.exports,e,t,r,a)}return r[n].exports}var i=typeof require=="function"&&require;for(var n=0;n<a.length;n++)o(a[n]);return o}({"awayjs-player/lib/adapters/AS2ColorAdapter":[function(e,t,r){var a=e("awayjs-display/lib/base/HierarchicalProperties");var o=e("awayjs-core/lib/geom/ColorTransform");var i=function(){function e(e){this._rgb=16777215;this._symbol=e;this._symbol._blockedByScript=true;this._target=e.adaptee._iColorTransform||(e.adaptee._iColorTransform=new o);this._transform={ra:100,rb:0,ga:100,gb:0,ba:100,bb:0,aa:100,ab:0}}e.prototype.getRGB=function(){return this._rgb};e.prototype.setRGB=function(e){this._rgb=e;var t=e>>16&255;var r=e>>8&255;var a=e&255;this.setTransform({ra:t/255*100,ga:r/255*100,ba:a/255*100,aa:100,rb:0,gb:0,bb:0,ab:0})};e.prototype.getTransform=function(){return this._transform};e.prototype.setTransform=function(e){this._transform=e;var t=this._target;t.redMultiplier=e.ra===undefined?1:e.ra/100;t.greenMultiplier=e.ga===undefined?1:e.ga/100;t.blueMultiplier=e.ba===undefined?1:e.ba/100;t.alphaMultiplier=e.aa===undefined?1:e.aa/100;t.redOffset=e.rb||0;t.greenOffset=e.gb||0;t.blueOffset=e.bb||0;t.alphaOffset=e.ab||0;this._symbol.adaptee.pInvalidateHierarchicalProperties(a.COLOR_TRANSFORM)};return e}();t.exports=i},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-display/lib/base/HierarchicalProperties":undefined}],"awayjs-player/lib/adapters/AS2KeyAdapter":[function(e,t,r){var a=function(){function e(){}e.addListener=function(t){e._listeners.push(t)};e.removeListener=function(t){var r=e._listeners;var a=r.indexOf(t);if(a!=-1)r.splice(a,1)};e.isDown=function(t){return e._keys[t]};e.getCode=function(){return e._key};e.getAscii=function(){return e._char};e._onKeyDown=function(t){e._key=t.keyCode;e._char=t.charCode;e._keys[t.keyCode]=true;var r=e._listeners.length;for(var a=0;a<r;a++)if(e._listeners[a].onKeyDown)e._listeners[a].onKeyDown()};e._onKeyUp=function(t){e._keys[t.keyCode]=false;var r=e._listeners.length;for(var a=0;a<r;a++)if(e._listeners[a].onKeyUp)e._listeners[a].onKeyUp()};e._keys=new Array;e._listeners=new Array;e._addListeners=function(){document.onkeydown=function(t){return e._onKeyDown(t)};document.onkeyup=function(t){return e._onKeyUp(t)}}();e.BACKSPACE=8;e.CAPSLOCK=20;e.CONTROL=17;e.DELETEKEY=46;e.DOWN=40;e.END=35;e.ENTER=13;e.ESCAPE=27;e.HOME=36;e.INSERT=45;e.LEFT=37;e.PGDN=34;e.PGUP=33;e.RIGHT=39;e.SHIFT=16;e.SPACE=32;e.TAB=9;e.UP=38;return e}();t.exports=a},{}],"awayjs-player/lib/adapters/AS2MCSoundProps":[function(e,t,r){var a=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function a(){this.constructor=e}a.prototype=t.prototype;e.prototype=new a};var o=e("awayjs-core/lib/events/Event");var i=e("awayjs-core/lib/events/EventDispatcher");var n=function(e){a(t,e);function t(){var t=this;e.call(this);this._volume=1;this._pan=1;this._changeEvent=new o(o.CHANGE);this._loops=0;this._onEndedDelegate=function(e){return t.onEnded(e)}}Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(e){if(this._volume!=e){this._volume=e;this.dispatchEvent(this._changeEvent)}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"pan",{get:function(){return this._pan},set:function(e){if(this._pan!=e){this._pan=e;this.dispatchEvent(this._changeEvent)}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"loops",{get:function(){return this._loops},set:function(e){this._loops=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"audio",{get:function(){return this._audio},set:function(e){if(this._audio){this._audio.removeEventListener("ended",this._onEndedDelegate);this._audio.stop()}this._audio=e;this._loops=0;if(e)e.loop=false;this._audio.addEventListener("ended",this._onEndedDelegate)},enumerable:true,configurable:true});t.prototype.onEnded=function(e){if(this._loops>0){this._audio.currentTime=0;this._audio.play()}else{this._loops=0}};return t}(i);t.exports=n},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/events/EventDispatcher":undefined}],"awayjs-player/lib/adapters/AS2MouseAdapter":[function(e,t,r){var a=function(){function e(){}e.addListener=function(t){e._globalListeners.push(t)};e._globalListeners=[];return e}();t.exports=a},{}],"awayjs-player/lib/adapters/AS2MovieClipAdapter":[function(require,module,exports){var __extends=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function a(){this.constructor=e}a.prototype=t.prototype;e.prototype=new a};var AS2SymbolAdapter=require("awayjs-player/lib/adapters/AS2SymbolAdapter");var AS2MCSoundProps=require("awayjs-player/lib/adapters/AS2MCSoundProps");var MovieClip=require("awayjs-display/lib/entities/MovieClip");var MouseEvent=require("awayjs-display/lib/events/MouseEvent");var Event=require("awayjs-core/lib/events/Event");var Point=require("awayjs-core/lib/geom/Point");var AssetLibrary=require("awayjs-core/lib/library/AssetLibrary");var Color=require("awayjs-player/lib/adapters/AS2ColorAdapter");var System=require("awayjs-player/lib/adapters/AS2SystemAdapter");var Sound=require("awayjs-player/lib/adapters/AS2SoundAdapter");var Key=require("awayjs-player/lib/adapters/AS2KeyAdapter");var Mouse=require("awayjs-player/lib/adapters/AS2MouseAdapter");var Stage=require("awayjs-player/lib/adapters/AS2StageAdapter");var SharedObject=require("awayjs-player/lib/adapters/AS2SharedObjectAdapter");var int=function(e){return Math.floor(e)|0};var String=function(e){return e.toString()};var string=function(e){return e.toString()};var getURL=function(e){return e};var AS2MovieClipAdapter=function(_super){__extends(AS2MovieClipAdapter,_super);function AS2MovieClipAdapter(e,t){_super.call(this,e||new MovieClip,t);this._framescript_vars=[Color,System,Sound,Key,Mouse,Stage,SharedObject];this.__pSoundProps=new AS2MCSoundProps}Object.defineProperty(AS2MovieClipAdapter.prototype,"_framesloaded",{get:function(){return this.adaptee.numFrames},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"_currentframe",{get:function(){return this.adaptee.currentFrameIndex+1},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"_totalframes",{get:function(){return this.adaptee.numFrames},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"enabled",{get:function(){return this.adaptee.mouseEnabled},enumerable:true,configurable:true});AS2MovieClipAdapter.prototype.evalScript=function(str){try{var script=function(){eval(str)}}catch(err){console.log("Syntax error in script:\n",str);console.log(err.message);throw err}return script};AS2MovieClipAdapter.prototype.attachMovie=function(e,t,r,a){if(a===void 0){a=null}var o=AssetLibrary.getAsset(e);var i=o.clone();var n=new AS2MovieClipAdapter(i,this._view);this.adaptee.addChildAtDepth(n.adaptee,r);n.adaptee.name=t;this.registerScriptObject(n.adaptee);return o};AS2MovieClipAdapter.prototype.createEmptyMovieClip=function(e,t){var r=new AS2MovieClipAdapter(null,this._view);r.adaptee.name=e;this.adaptee.addChildAtDepth(r.adaptee,t);this.registerScriptObject(r.adaptee);return r};AS2MovieClipAdapter.prototype.duplicateMovieClip=function(e,t,r){var a=this.adaptee.clone().adapter;a.adaptee.name=e;if(r)for(var o in r)if(a.hasOwnProperty(o))a[o]=r[o];this.adaptee.parent.addChildAtDepth(a.adaptee,t);return a};AS2MovieClipAdapter.prototype.getBytesLoaded=function(){return 1};AS2MovieClipAdapter.prototype.getBytesTotal=function(){return 1};AS2MovieClipAdapter.prototype.getInstanceAtDepth=function(e){return this.adaptee.getChildAtDepth(e)};AS2MovieClipAdapter.prototype.getNextHighestDepth=function(){return this.adaptee.getNextHighestDepth()};AS2MovieClipAdapter.prototype.globalToLocal=function(e){var t=this.adaptee.globalToLocal(new Point(e.x,e.y));e.x=t.x;e.y=t.y};AS2MovieClipAdapter.prototype.gotoAndPlay=function(e){if(e==null)return;if(this._name=="smash")console.log("Smash gotoAndPlay");this.play();this._gotoFrame(e)};AS2MovieClipAdapter.prototype.gotoAndStop=function(e){if(e==null)return;this.stop();this._gotoFrame(e)};AS2MovieClipAdapter.prototype.play=function(){this.adaptee.play()};AS2MovieClipAdapter.prototype.stop=function(){if(this._name=="smash")console.log("Smash stop");this.adaptee.stop()};AS2MovieClipAdapter.prototype.hitTest=function(e,t,r){if(r===void 0){r=false}return this.adaptee.hitTestPoint(e,t,r)};AS2MovieClipAdapter.prototype.localToGlobal=function(e){var t=this.adaptee.localToGlobal(new Point(e.x,e.y));e.x=t.x;e.y=t.y};AS2MovieClipAdapter.prototype.nextFrame=function(){++this.adaptee.currentFrameIndex};AS2MovieClipAdapter.prototype.prevFrame=function(){--this.adaptee.currentFrameIndex};AS2MovieClipAdapter.prototype.setMask=function(e){this.adaptee.masks=[e]};AS2MovieClipAdapter.prototype.swapDepths=function(e){var t=this.adaptee.parent;if(t!=null&&e.parent==t)t.swapChildren(this.adaptee,e)};AS2MovieClipAdapter.prototype.clone=function(e){return new AS2MovieClipAdapter(e,this._view)};Object.defineProperty(AS2MovieClipAdapter.prototype,"onEnterFrame",{get:function(){return this._onEnterFrame},set:function(e){this._onEnterFrame=this._replaceEventListener(Event.ENTER_FRAME,this._onEnterFrame,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onRollOut",{get:function(){return this._onRollOut},set:function(e){this._onRollOut=this._replaceEventListener(MouseEvent.MOUSE_OUT,this._onRollOut,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onRollOver",{get:function(){return this._onRollOver},set:function(e){this._onRollOver=this._replaceEventListener(MouseEvent.MOUSE_OVER,this._onRollOver,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onRelease",{get:function(){return this._onRelease},set:function(e){this._onRelease=this._replaceEventListener(MouseEvent.MOUSE_UP,this._onRelease,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onPress",{get:function(){return this._onPress},set:function(e){this._onPress=this._replaceEventListener(MouseEvent.MOUSE_DOWN,this._onPress,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onMouseDown",{get:function(){return this._onMouseDown},set:function(e){this._onMouseDown=this._replaceEventListener(MouseEvent.MOUSE_DOWN,this._onMouseDown,e)},enumerable:true,configurable:true});Object.defineProperty(AS2MovieClipAdapter.prototype,"onMouseUp",{get:function(){return this._onMouseUp},set:function(e){this._onMouseUp=this._replaceEventListener(MouseEvent.MOUSE_UP,this._onMouseUp,e)},enumerable:true,configurable:true});AS2MovieClipAdapter.prototype.registerScriptObject=function(e){if(e.name)this[e.name]=e.adapter?e.adapter:e};AS2MovieClipAdapter.prototype.unregisterScriptObject=function(e){delete this[e.name];if(e.isAsset(MovieClip)){e.removeButtonListeners()}};AS2MovieClipAdapter.prototype._gotoFrame=function(e){var t=this.adaptee;if(typeof e==="string")t.jumpToLabel(e);else t.currentFrameIndex=e-1};AS2MovieClipAdapter.prototype._replaceEventListener=function(e,t,r){var a=this.adaptee;if(t)a.removeEventListener(e,t);if(r){var o=this;var i=function(){r.call(o)};a.addEventListener(e,i)}return i};return AS2MovieClipAdapter}(AS2SymbolAdapter);module.exports=AS2MovieClipAdapter},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-display/lib/entities/MovieClip":undefined,"awayjs-display/lib/events/MouseEvent":undefined,"awayjs-player/lib/adapters/AS2ColorAdapter":"awayjs-player/lib/adapters/AS2ColorAdapter","awayjs-player/lib/adapters/AS2KeyAdapter":"awayjs-player/lib/adapters/AS2KeyAdapter","awayjs-player/lib/adapters/AS2MCSoundProps":"awayjs-player/lib/adapters/AS2MCSoundProps","awayjs-player/lib/adapters/AS2MouseAdapter":"awayjs-player/lib/adapters/AS2MouseAdapter","awayjs-player/lib/adapters/AS2SharedObjectAdapter":"awayjs-player/lib/adapters/AS2SharedObjectAdapter","awayjs-player/lib/adapters/AS2SoundAdapter":"awayjs-player/lib/adapters/AS2SoundAdapter","awayjs-player/lib/adapters/AS2StageAdapter":"awayjs-player/lib/adapters/AS2StageAdapter","awayjs-player/lib/adapters/AS2SymbolAdapter":"awayjs-player/lib/adapters/AS2SymbolAdapter","awayjs-player/lib/adapters/AS2SystemAdapter":"awayjs-player/lib/adapters/AS2SystemAdapter"}],"awayjs-player/lib/adapters/AS2SharedObjectAdapter":[function(e,t,r){var a=function(){function e(e){this._object_name=e;if(typeof Storage!=="undefined"){this.data=JSON.parse(localStorage.getItem(e))}if(this.data==null){console.log("no shared object found");this.data={}}}e.getLocal=function(t,r,a){return new e(t)};e.prototype.flush=function(){if(typeof Storage!=="undefined"){localStorage.setItem(this._object_name,JSON.stringify(this.data))}else{console.log("no local storage available")}};return e}();t.exports=a},{}],"awayjs-player/lib/adapters/AS2SoundAdapter":[function(e,t,r){var a=e("awayjs-core/lib/events/Event");var o=e("awayjs-player/lib/adapters/AS2MCSoundProps");var i=e("awayjs-core/lib/library/AssetLibrary");var n=function(){function e(t){var r=this;this._vol=0;this._target=t;this._soundProps=t!=null&&t.__pSoundProps?this._target.__pSoundProps:e._globalSoundProps;this._onGlobalChangeDelegate=function(e){return r.onGlobalChange(e)};e._globalSoundProps.addEventListener(a.CHANGE,this._onGlobalChangeDelegate)}Object.defineProperty(e.prototype,"vol",{get:function(){return this._vol},set:function(e){this._vol=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"looping",{get:function(){return this._soundProps.loops},set:function(e){this._soundProps.loops=e},enumerable:true,configurable:true});e.prototype.attachSound=function(e){var t=i.getAsset(e);if(t)this._soundProps.audio=t.clone();this.updateVolume()};e.prototype.getPan=function(){return this._soundProps.pan};e.prototype.setPan=function(e){this._soundProps.pan=e};e.prototype.getVolume=function(){return this._soundProps.volume*100};e.prototype.setVolume=function(e){this._soundProps.volume=e/100;this.updateVolume()};e.prototype.start=function(e,t){if(e===void 0){e=0}if(t===void 0){t=0}if(this._soundProps.audio){this._soundProps.audio.currentTime=e;this._soundProps.loops=t;this._soundProps.audio.play()}};e.prototype.stop=function(e){if(e===void 0){e=null}if(this._soundProps.audio)this._soundProps.audio.stop()};Object.defineProperty(e.prototype,"position",{get:function(){if(this._soundProps.audio)return this._soundProps.audio.currentTime;return 0},set:function(e){if(this._soundProps.audio)this._soundProps.audio.currentTime=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"duration",{get:function(){if(this._soundProps.audio)return this._soundProps.audio.duration;return 0},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"id3",{get:function(){return{}},enumerable:true,configurable:true});e.prototype.onGlobalChange=function(e){this.updateVolume()};e.prototype.updateVolume=function(){if(this._soundProps.audio){var t=this._soundProps.volume*e._globalSoundProps.volume;if(t>1)t=1;if(t<0)t=0;this._soundProps.audio.volume=t}};e._globalSoundProps=new o;return e}();t.exports=n},{"awayjs-core/lib/events/Event":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-player/lib/adapters/AS2MCSoundProps":"awayjs-player/lib/adapters/AS2MCSoundProps"}],"awayjs-player/lib/adapters/AS2StageAdapter":[function(e,t,r){var a=function(){function e(){}e.showMenu=true;return e}();t.exports=a},{}],"awayjs-player/lib/adapters/AS2SymbolAdapter":[function(e,t,r){var a=e("awayjs-core/lib/geom/ColorTransform");var o=e("awayjs-display/lib/base/HierarchicalProperties");var i=e("awayjs-player/lib/adapters/AS2SharedObjectAdapter");var n=e("awayjs-player/lib/adapters/AS2KeyAdapter");var p=e("awayjs-player/lib/adapters/AS2MouseAdapter");var s=e("awayjs-player/lib/adapters/AS2StageAdapter");var u=e("awayjs-display/lib/managers/FrameScriptManager");var l=function(){function e(t,r){this.__quality="high";this._adaptee=t;this._view=r;this._blockedByScript=false;if(e.REFERENCE_TIME===-1)e.REFERENCE_TIME=(new Date).getTime()}Object.defineProperty(e.prototype,"Key",{get:function(){return n},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"Mouse",{get:function(){return p},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"Stage",{get:function(){return s},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"SharedObject",{get:function(){return i},enumerable:true,configurable:true});e.prototype.String=function(e){return e.toString()};e.prototype.string=function(e){return e.toString()};e.prototype.getURL=function(e){return e};e.prototype.isBlockedByScript=function(){return this._blockedByScript};e.prototype.isVisibilityByScript=function(){return this._visibilityByScript};e.prototype.freeFromScript=function(){this._blockedByScript=false;this._visibilityByScript=false};e.prototype.getVersion=function(){return 0};Object.defineProperty(e.prototype,"adaptee",{get:function(){return this._adaptee},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_height",{get:function(){return this._adaptee.height},set:function(e){this._adaptee.height=e;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_name",{get:function(){return this._adaptee.name},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_rotation",{get:function(){return this._adaptee.rotationZ},set:function(e){this._adaptee.rotationZ=e;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_x",{get:function(){return this._adaptee.x},set:function(e){this._adaptee.x=e;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_xmouse",{get:function(){return this._view.getLocalMouseX(this._adaptee)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_y",{get:function(){return this._adaptee.y},set:function(e){this._adaptee.y=e;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_ymouse",{get:function(){return this._view.getLocalMouseY(this._adaptee)},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_xscale",{get:function(){return this._adaptee.scaleX*100},set:function(e){this._adaptee.scaleX=e/100;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_yscale",{get:function(){return this._adaptee.scaleY*100},set:function(e){this._adaptee.scaleY=e/100;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_visible",{get:function(){return this._adaptee.visible},set:function(e){this._adaptee.visible=e;this._visibilityByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_width",{get:function(){return this._adaptee.width},set:function(e){this._adaptee.width=e;this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_touchpoints",{get:function(){return this._view.getLocalTouchPoints(this._adaptee)},enumerable:true,configurable:true});e.prototype.getDepth=function(){return this._adaptee.z};Object.defineProperty(e.prototype,"_quality",{get:function(){return this.__quality},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"quality",{set:function(e){this.__quality=e},enumerable:true,configurable:true});e.prototype.trace=function(e){console.log(e)};e.prototype.getTimer=function(){return(new Date).getTime()-e.REFERENCE_TIME};e.prototype.int=function(e){return e|0};Object.defineProperty(e.prototype,"_alpha",{get:function(){return this.adaptee._iColorTransform?this.adaptee._iColorTransform.alphaMultiplier*100:100},set:function(e){if(!this.adaptee._iColorTransform)this.adaptee._iColorTransform=new a;this.adaptee._iColorTransform.alphaMultiplier=e/100;this.adaptee.pInvalidateHierarchicalProperties(o.COLOR_TRANSFORM);this._blockedByScript=true},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_url",{get:function(){return document.URL},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_global",{get:function(){return null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_level0",{get:function(){return this._root},enumerable:true,configurable:true});e.prototype.clearInterval=function(e){u.clearInterval(e);return};e.prototype.setInterval=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t-0]=arguments[t]}var r;var a;if(typeof e[0]=="function"){r=this;a=e[0]}else{r=e.shift();a=r[e[0]]}e[0]=function(){return a.apply(r,arguments)};return u.setInterval(e[0])};Object.defineProperty(e.prototype,"_level10301",{get:function(){return this._root},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"_root",{get:function(){if(!this.__root){var e=this._parent;this.__root=e?e._root:this}return this.__root},enumerable:true,configurable:true});e.prototype.random=function(e){return Math.floor(Math.random()*e)};Object.defineProperty(e.prototype,"_parent",{get:function(){var e=this.adaptee.parent;return e?e.adapter:null},enumerable:true,configurable:true});e.REFERENCE_TIME=-1;return e}();t.exports=l},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-display/lib/base/HierarchicalProperties":undefined,"awayjs-display/lib/managers/FrameScriptManager":undefined,"awayjs-player/lib/adapters/AS2KeyAdapter":"awayjs-player/lib/adapters/AS2KeyAdapter","awayjs-player/lib/adapters/AS2MouseAdapter":"awayjs-player/lib/adapters/AS2MouseAdapter","awayjs-player/lib/adapters/AS2SharedObjectAdapter":"awayjs-player/lib/adapters/AS2SharedObjectAdapter","awayjs-player/lib/adapters/AS2StageAdapter":"awayjs-player/lib/adapters/AS2StageAdapter"}],"awayjs-player/lib/adapters/AS2SystemAdapter":[function(e,t,r){var a=function(){function e(){}e.security=null;e.capabilities={version:6};return e}();t.exports=a},{}],"awayjs-player/lib/adapters/AS2TextFieldAdapter":[function(e,t,r){var a=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function a(){this.constructor=e}a.prototype=t.prototype;e.prototype=new a};var o=e("awayjs-player/lib/adapters/AS2SymbolAdapter");var i=e("awayjs-display/lib/entities/TextField");var n=function(e){a(t,e);function t(t,r){e.call(this,t||new i,r)}t.prototype.clone=function(e){return new t(e,this._view)};Object.defineProperty(t.prototype,"embedFonts",{get:function(){return this._embedFonts},set:function(e){this._embedFonts=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"text",{get:function(){return this.adaptee.text},set:function(e){this.adaptee.text=e},enumerable:true,configurable:true});return t}(o);t.exports=n},{"awayjs-display/lib/entities/TextField":undefined,"awayjs-player/lib/adapters/AS2SymbolAdapter":"awayjs-player/lib/adapters/AS2SymbolAdapter"}],"awayjs-player/lib/bounds/AxisAlignedBoundingBox2D":[function(e,t,r){var a=this.__extends||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];function a(){this.constructor=e}a.prototype=t.prototype;e.prototype=new a};var o=e("awayjs-display/lib/bounds/AxisAlignedBoundingBox");var i=function(e){a(t,e);function t(t){e.call(this,t)}t.prototype.rayIntersection=function(e,t,r){if(this._pInvalidated)this._pUpdate();var a=this._box.width/2;var o=this._box.height/2;var i=this._box.x+a;var n=this._box.y+o;var p=e.x-i;var s=e.y-n;var u=e.z;var l=t.x;var d=t.y;var c=t.z;var y;var f;var b;var h;if(!b&&c<0){h=-u/c;if(h>0){y=p+h*l;f=s+h*d;if(f>-o&&f<o&&y>-a&&y<a){r.x=0;r.y=0;r.z=1;b=true}}}if(!b&&c>0){h=-u/c;if(h>0){y=p+h*l;f=s+h*d;if(f>-o&&f<o&&y>-a&&y<a){r.x=0;r.y=0;r.z=-1;b=true}}}return b?h:-1};return t}(o);t.exports=o},{"awayjs-display/lib/bounds/AxisAlignedBoundingBox":undefined}],"awayjs-player/lib/factories/AS2SceneGraphFactory":[function(e,t,r){var a=e("awayjs-player/lib/adapters/AS2MovieClipAdapter");var o=e("awayjs-player/lib/adapters/AS2TextFieldAdapter");var i=e("awayjs-display/lib/entities/TextField");var n=e("awayjs-display/lib/entities/MovieClip");var p=function(){function e(e){this._view=e}e.prototype.createMovieClip=function(e){var t=new n(e);t.adapter=new a(t,this._view);return t};e.prototype.createTextField=function(){var e=new i;e.adapter=new o(e,this._view);return e};return e}();t.exports=p},{"awayjs-display/lib/entities/MovieClip":undefined,"awayjs-display/lib/entities/TextField":undefined,"awayjs-player/lib/adapters/AS2MovieClipAdapter":"awayjs-player/lib/adapters/AS2MovieClipAdapter","awayjs-player/lib/adapters/AS2TextFieldAdapter":"awayjs-player/lib/adapters/AS2TextFieldAdapter"}]},{},[]);


require=function e(a,t,r){function s(n,o){if(!t[n]){if(!a[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(i)return i(n,!0);var d=new Error("Cannot find module '"+n+"'");throw d.code="MODULE_NOT_FOUND",d}var h=t[n]={exports:{}};a[n][0].call(h.exports,function(e){var t=a[n][1][e];return s(t?t:e)},h,h.exports,e,a,t,r)}return t[n].exports}var i=typeof require=="function"&&require;for(var n=0;n<r.length;n++)s(r[n]);return s}({"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":[function(e,a,t){var r=e("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function e(){}Object.defineProperty(e.prototype,"awd_file_data",{get:function(){return this._awd_file_data},set:function(e){this._awd_file_data=e},enumerable:true,configurable:true});e.prototype.parseFromBytes=function(){throw new r};return e}();a.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers":[function(e,a,t){var r=e("awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser");var s=e("awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser");var i=e("awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser");var n=e("awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser");var o=e("awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser");var l=e("awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser");var d=e("awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser");var h=e("awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser");var c=e("awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser");var _=e("awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser");var p=e("awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser");var u=e("awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser");var f=e("awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser");var y=e("awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser");var w=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser");var b=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser");var m=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser");var v=e("awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser");var g=e("awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser");var B=e("awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser");var k=e("awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser");var D=e("awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser");var A=e("awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser");var P=e("awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser");var j=e("awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser");var M=e("awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser");var N=e("awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser");var U=e("awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser");var T=function(){function e(){this._supported_asset_blocks={};this._all_block_parsers=new Array;this.add_block_parser(new r,[1]);this.add_block_parser(new s,[11]);this.add_block_parser(new i,[22]);this.add_block_parser(new n,[23,24]);this.add_block_parser(new o,[25]);this.add_block_parser(new v,[31]);this.add_block_parser(new c,[41]);this.add_block_parser(new d,[42]);this.add_block_parser(new U,[44]);this.add_block_parser(new _,[51]);this.add_block_parser(new p,[81]);this.add_block_parser(new l,[82]);this.add_block_parser(new h,[83]);this.add_block_parser(new y,[91]);this.add_block_parser(new f,[92]);this.add_block_parser(new b,[101]);this.add_block_parser(new m,[102]);this.add_block_parser(new w,[103]);this.add_block_parser(new A,[111,112]);this.add_block_parser(new D,[113]);this.add_block_parser(new N,[122]);this.add_block_parser(new u,[133]);this.add_block_parser(new B,[134]);this.add_block_parser(new g,[135]);this.add_block_parser(new k,[136]);this.add_block_parser(new P,[253]);this.add_block_parser(new M,[254]);this.add_block_parser(new j,[255])}e.prototype.add_block_parser=function(e,a){for(var t=0;t<a.length;t++){this._supported_asset_blocks[a[t]]=e}this._all_block_parsers.push(e)};e.prototype.init_parser=function(e){for(var a=0;a<this._all_block_parsers.length;a++){this._all_block_parsers[a].awd_file_data=e}};e.prototype.parseAsset=function(e){var a=this._supported_asset_blocks[e];if(a!=undefined){a.parseFromBytes();return true}return false};return e}();a.exports=T},{"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser","awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser","awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser","awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser","awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser","awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser","awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser","awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser","awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser","awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser","awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser","awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser","awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser"}],"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/VertexAnimator");var n=e("awayjs-renderergl/lib/animators/SkeletonAnimator");var o=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var t=this.awd_file_data.newBlockBytes.readUnsignedShort();var r=this.awd_file_data.parseProperties({1:o.BADDR});e=this.awd_file_data.newBlockBytes.readUnsignedInt();var s=this.awd_file_data.newBlockBytes.readUnsignedShort();var l=new Array;for(var d=0;d<s;d++)l.push(this.awd_file_data.newBlockBytes.readUnsignedInt());var h=this.awd_file_data.newBlockBytes.readUnsignedShort();var c=this.awd_file_data.newBlockBytes.readUnsignedByte()==1;this.awd_file_data.parseUserAttributes();this.awd_file_data.parseUserAttributes();var _;var p=new Array;for(d=0;d<l.length;d++){var u=this.awd_file_data.getAssetByID(l[d]);if(u!=undefined)p.push(u)}var a=this.awd_file_data.getAssetByID(e);if(a==undefined){return undefined}var f;if(t==1){var y=this.awd_file_data.getAssetByID(r.get(1,0));if(y==undefined){return}f=new n(a,y)}else if(t==2)f=new i(a);for(d=0;d<p.length;d++){if(t==1)p[d].animator=f;if(t==2)p[d].animator=f}this.awd_file_data.cur_block.data=f;if(this.awd_file_data.debug)console.log("Parsed a Animator: Name = "+this.awd_file_data.cur_block.name)};return a}(s);a.exports=l},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/VertexAnimator":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedByte();var a;if(e==0){a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t;t=this.awd_file_data.newBlockBytes.readUTFBytes(a);this.awd_file_data.cur_block.dependencies_urls.push(t)}else{a=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=new s;this.awd_file_data.newBlockBytes.readBytes(r,0,a);this.awd_file_data.cur_block.dependencies_data.push(r)}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var i=["external","embed"];console.log("Start parsing a "+i[e]+" AudioFile")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Billboard");var n=e("awayjs-display/lib/materials/BasicMaterial");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=this.awd_file_data.getAssetByID(e);if(a==undefined){a=new n}a.bothSides=true;var t=new i(a);this.awd_file_data.cur_block.data=t;this.awd_file_data.parseProperties(null);t.extra=this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){console.log("Parsed a Library-Billboard: Name = '"+t.name+"| Material-Name = "+a.name)}};return a}(s);a.exports=o},{"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=i.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.newBlockBytes.readUnsignedByte();var a=this.awd_file_data.parseVarStr();if(this.awd_file_data.debug)console.log("Parsed a NameSpaceBlock: ID = "+e+" | String = "+a)};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Camera");var n=e("awayjs-core/lib/projections/PerspectiveProjection");var o=e("awayjs-core/lib/projections/OrthographicProjection");var l=e("awayjs-core/lib/projections/OrthographicOffCenterProjection");var d=e("awayjs-core/lib/geom/Vector3D");var h=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var t="Root (TopLevel)";var r;this.awd_file_data.newBlockBytes.readUnsignedByte();this.awd_file_data.newBlockBytes.readShort();var s=this.awd_file_data.newBlockBytes.readShort();var c=this.awd_file_data.parseProperties({101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,104:this.awd_file_data.propsNrType});switch(s){case 5001:r=new n(c.get(101,60));break;case 5002:r=new o(c.get(101,500));break;case 5003:r=new l(c.get(101,-400),c.get(102,400),c.get(103,-300),c.get(104,300));break;default:console.log("unsupportedLenstype");return}var _=new i(r);_.transform.matrix3D=a;if(e>0){var p=this.awd_file_data.getAssetByID(e);if(p!=undefined){p.addChild(_);t=p.name}}_.name=name;c=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:h.UINT8});_.pivot=new d(c.get(1,0),c.get(2,0),c.get(3,0));_.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=_;if(this.awd_file_data.debug){console.log("Parsed a Camera: Name = '"+_.name+"' | Projectiontype = "+r+" | Parent-Name = "+t)}};return a}(s);a.exports=c},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/OrthographicOffCenterProjection":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=n.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.newBlockBytes.readUnsignedByte()==1;var a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t=this.awd_file_data.parseMatrix3D();var r=this.awd_file_data.parseVarStr();var s;var o;if(a>0)s=this.awd_file_data.getAssetByID(a);var l=this.awd_file_data.newBlockBytes.readShort();var d=this.awd_file_data.newBlockBytes.readShort();var h=this.awd_file_data.parseProperties({1:n.BADDR});switch(d){case 1:var c=h.get(1,0);o=this.awd_file_data.getAssetByID(c);if(o==undefined){return}if(s){s.addChild(o)}o.transform.matrix3D=t;break}if(o){h=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:n.UINT8});o.pivot=new i(h.get(1,0),h.get(2,0),h.get(3,0));o.extra=this.awd_file_data.parseUserAttributes()}if(this.awd_file_data.debug){console.log("Parsed a CommandBlock: Name = '"+r)}};return a}(s);a.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/Vector3D");var i=e("awayjs-display/lib/containers/DisplayObjectContainer");var n=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var o=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;t=new i;e=this.awd_file_data.newBlockBytes.readUnsignedInt();a=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var n="Root (TopLevel)";t.transform.matrix3D=a;if(e>0){var r=this.awd_file_data.getAssetByID(e);if(r!=undefined){r.addChild(t);n=r.name}}if(this.awd_file_data.major_version>2||this.awd_file_data.major_version>=2&&this.awd_file_data.minor_version==1){var l=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:o.UINT8});t.pivot=new s(l.get(1,0),l.get(2,0),l.get(3,0))}else{this.awd_file_data.parseProperties(null)}t.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug){console.log("Parsed a Container: Name = '"+t.name+"' | Parent-Name = "+n)}};return a}(n);a.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-display/lib/base/Geometry");var o=e("awayjs-display/lib/base/CurveSubGeometry");var l=e("awayjs-display/lib/base/TriangleSubGeometry");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t=this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType,2:this.awd_file_data.geoNrType});var r=t.get(1,1);var i=t.get(2,1);var d=0;while(d<a){var h=false;var c;var _,p;var u;var f;_=this.awd_file_data.newBlockBytes.readUnsignedInt();p=this.awd_file_data.newBlockBytes.position+_;var y=this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType,2:this.awd_file_data.geoNrType});while(this.awd_file_data.newBlockBytes.position<p){var w=0;var b,m,v,g;m=this.awd_file_data.newBlockBytes.readUnsignedByte();b=this.awd_file_data.newBlockBytes.readUnsignedByte();v=this.awd_file_data.newBlockBytes.readUnsignedInt();g=this.awd_file_data.newBlockBytes.position+v;var B,k,D;if(m==1){var A=new Array;while(this.awd_file_data.newBlockBytes.position<g){B=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);D=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);A[w++]=B;A[w++]=k;A[w++]=D}}else if(m==2){var P=new Array;while(this.awd_file_data.newBlockBytes.position<g){P[w++]=this.awd_file_data.newBlockBytes.readUnsignedShort()}}else if(m==3){var j=new Array;while(this.awd_file_data.newBlockBytes.position<g){j[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==4){var M=new Array;while(this.awd_file_data.newBlockBytes.position<g){M[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==6){u=Array();while(this.awd_file_data.newBlockBytes.position<g){u[w++]=this.awd_file_data.newBlockBytes.readUnsignedShort()*3}}else if(m==7){f=new Array;while(this.awd_file_data.newBlockBytes.position<g){f[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==8){this.awd_file_data.newBlockBytes.position=g}else if(m==9){this.awd_file_data.newBlockBytes.position=g}else if(m==10){h=true;var N=0;var U=0;var T=0;var S=new Array;var x=new Array;var j=new Array;while(this.awd_file_data.newBlockBytes.position<g){S[N++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);S[N++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);S[N++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);x[U++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);x[U++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);j[T++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);j[T++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else{this.awd_file_data.newBlockBytes.position=g}}this.awd_file_data.parseUserAttributes();if(h){var W=new o(new s);W.setIndices(P);W.setPositions(S);W.setCurves(x);W.setUVs(j);e.addSubGeometry(W);if(this.awd_file_data.debug)console.log("Parsed a CurveSubGeometry")}else{var I=new l(new s);if(f)I.jointsPerVertex=f.length/(A.length/3);if(M)I.autoDeriveNormals=false;if(j)I.autoDeriveUVs=false;if(true){I.autoDeriveTangents=true}I.setIndices(P);I.setPositions(A);I.setNormals(M);I.setUVs(j);I.setTangents(null);I.setJointWeights(f);I.setJointIndices(u);var O=y.get(1,1);var E=y.get(2,1);var F=false;if(r!=O||i!=E){F=true;O=r/O;E=i/E}if(F)I.scaleUV(O,E);e.addSubGeometry(I);if(this.awd_file_data.debug)console.log("Parsed a TriangleSubGeometry")}d++}if(r!=1||i!=1)e.scaleUV(r,i);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TriangleGeometry: Name = "+name)}};return a}(i);a.exports=d},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-display/lib/base/CurveSubGeometry":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var n=e("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var o=e("awayjs-display/lib/entities/DirectionalLight");var l=e("awayjs-display/lib/entities/PointLight");var d=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var s=this.awd_file_data.newBlockBytes.readUnsignedByte();var h=this.awd_file_data.parseProperties({1:this.awd_file_data.propsNrType,2:this.awd_file_data.propsNrType,3:d.COLOR,4:this.awd_file_data.propsNrType,5:this.awd_file_data.propsNrType,6:d.BOOL,7:d.COLOR,8:this.awd_file_data.propsNrType,9:d.UINT8,10:d.UINT8,11:this.awd_file_data.propsNrType,12:d.UINT16,21:this.awd_file_data.matrixNrType,22:this.awd_file_data.matrixNrType,23:this.awd_file_data.matrixNrType});var c=h.get(9,0);var _="Root (TopLevel)";var p=["Unsupported LightType","PointLight","DirectionalLight"];var u=["No ShadowMapper","DirectionalShadowMapper","NearDirectionalShadowMapper","CascadeShadowMapper","CubeMapShadowMapper"];if(s==1){e=new l;e.radius=h.get(1,9e4);e.fallOff=h.get(2,1e5);if(c>0){if(c==4){a=new i}}e.transform.matrix3D=r}if(s==2){e=new o(h.get(21,0),h.get(22,-1),h.get(23,1));if(c>0){if(c==1){a=new n}}}e.name=name;e.color=h.get(3,16777215);e.specular=h.get(4,1);e.diffuse=h.get(5,1);e.ambientColor=h.get(7,16777215);e.ambient=h.get(8,0);if(a){if(a instanceof i){if(h.get(10,1)!=1){a.depthMapSize=this.awd_file_data.getDepthSizeFromEnum(h.get(10,1))}}else{if(h.get(10,2)!=2){a.depthMapSize=this.awd_file_data.getDepthSizeFromEnum(h.get(10,2))}}e.shadowMapper=a;e.castsShadows=true}if(t!=0){var f=this.awd_file_data.getAssetByID(t);if(f!=undefined){f.addChild(e);_=f.name}else{}}else{}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a Light: Name = '"+this.awd_file_data.cur_block.name+"' | Type = "+p[s]+" | Parent-Name = "+_+" | ShadowMapper-Type = "+u[c])};return a}(s);a.exports=h},{"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedShort();var a=new Array;var t=0;var r=0;var s;var n=new Array;for(t=0;t<e;t++){r=this.awd_file_data.newBlockBytes.readUnsignedInt();var o=this.awd_file_data.getAssetByID(r);if(o!=undefined){a.push(o);n.push(o.name)}else{}}if(a.length==0){this.awd_file_data.parseUserAttributes();return undefined}var l=new i(a);this.awd_file_data.cur_block.data=l;this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){console.log("Parsed a StaticLightPicker: Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+n.toString())}};return a}(s);a.exports=n},{"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-methodmaterials/lib/MethodMaterialMode");var n=e("awayjs-methodmaterials/lib/MethodMaterial");var o=e("awayjs-display/lib/materials/BasicMaterial");var l=e("awayjs-display/lib/managers/DefaultMaterialManager");var d=e("awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod");var h=e("awayjs-methodmaterials/lib/methods/DiffuseDepthMethod");var c=e("awayjs-methodmaterials/lib/methods/DiffuseCelMethod");var _=e("awayjs-methodmaterials/lib/methods/DiffuseGradientMethod");var p=e("awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod");var u=e("awayjs-methodmaterials/lib/methods/DiffuseWrapMethod");var f=e("awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod");var y=e("awayjs-methodmaterials/lib/methods/SpecularFresnelMethod");var w=e("awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod");var b=e("awayjs-methodmaterials/lib/methods/SpecularCelMethod");var m=e("awayjs-methodmaterials/lib/methods/SpecularPhongMethod");var v=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var g=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;var s;var g;var B;var k;var D;var r;var A;var P;var D;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();a=this.awd_file_data.newBlockBytes.readUnsignedByte();B=this.awd_file_data.newBlockBytes.readUnsignedByte();if(this.awd_file_data.major_version==2&&this.awd_file_data.major_version==0){t=this.awd_file_data.parseProperties({1:v.INT32,2:v.BADDR,10:this.awd_file_data.propsNrType,11:v.BOOL,12:this.awd_file_data.propsNrType,13:v.BOOL});k=0;while(k<B){var j;j=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();k+=1}var M="";s=this.awd_file_data.parseUserAttributes();if(a===1){M+="Parsed a ColorMaterial(SinglePass): Name = '"+e+"' | ";var N;N=t.get(1,16777215)}else if(a===2){var U=t.get(2,0);var T=undefined;if(U>0){var T=this.awd_file_data.getAssetByID(U)}if(T==undefined){T=l.getDefaultTexture()}r=new n(T)}r.extra=s;r.alphaThreshold=t.get(12,0);r.repeat=t.get(13,false);r.name=e;if(this.awd_file_data.debug){console.log(M)}this.awd_file_data.cur_block.data=r;return}var t=this.awd_file_data.parseProperties({1:v.UINT32,2:v.BADDR,3:v.BADDR,4:v.UINT8,5:v.BOOL,6:v.BOOL,7:v.BOOL,8:v.BOOL,9:v.UINT8,10:this.awd_file_data.propsNrType,11:v.BOOL,12:this.awd_file_data.propsNrType,13:v.BOOL,15:this.awd_file_data.propsNrType,16:v.UINT32,17:v.BADDR,18:this.awd_file_data.propsNrType,19:this.awd_file_data.propsNrType,20:v.UINT32,21:v.BADDR,22:v.BADDR});var S=t.get(4,0);var M="Parsed Material ";if(S>=2){return}if(a<=2){if(S<2){if(a==1){var N=t.get(1,13421772);if(S==1){r=new n(N);r.mode=i.MULTI_PASS;M+="Parsed a ColorMaterial(MultiPass): Name = '"+e+"' | "}else{r=new n(N,t.get(10,1));r.alphaBlending=t.get(11,false);M+="Parsed a ColorMaterial(SinglePass): Name = '"+e+"' | "}}else if(a==2){var U=t.get(2,0);var x=undefined;if(U>0){x=this.awd_file_data.getAssetByID(U)}if(x==undefined){x=l.getDefaultTexture()}r=new n(x);if(S==1){r.mode=i.MULTI_PASS;M+="Parsed a MethodMaterial(MultiPass): Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+x.name}else{r.alpha=t.get(10,1);r.alphaBlending=t.get(11,false);M+="Parsed a MethodMaterial(SinglePass): Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+x.name}}var W=t.get(17,0);var I=undefined;if(W>0){I=this.awd_file_data.getAssetByID(W)}if(I){r.diffuseTexture=I;M+=" | DiffuseTexture-Name = "+I.name
}var O=t.get(3,0);A=undefined;if(O>0){A=this.awd_file_data.getAssetByID(O)}var E=t.get(21,0);P=undefined;if(E>0){P=this.awd_file_data.getAssetByID(E)}var F=t.get(22,0);if(F>0){r.lightPicker=this.awd_file_data.getAssetByID(F)}r.smooth=t.get(5,true);r.mipmap=t.get(6,true);r.bothSides=t.get(7,false);r.alphaPremultiplied=t.get(8,false);r.blendMode=this.awd_file_data.getBlendModeStringFromEnum(t.get(9,0));r.repeat=t.get(13,false);if(A)r.normalMap=A;if(P)r.specularMap=P;r.alphaThreshold=t.get(12,0);r.ambient=t.get(15,1);r.diffuseColor=t.get(16,16777215);r.specular=t.get(18,1);r.gloss=t.get(19,50);r.specularColor=t.get(20,16777215);var k=0;var L;while(k<B){var j;j=this.awd_file_data.newBlockBytes.readUnsignedShort();t=this.awd_file_data.parseProperties({1:v.BADDR,2:v.BADDR,3:v.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,201:v.UINT32,202:v.UINT32,301:v.UINT16,302:v.UINT16,401:v.UINT8,402:v.UINT8,601:v.COLOR,602:v.COLOR,701:v.BOOL,702:v.BOOL,801:v.MTX4x4});switch(j){case 999:L=t.get(1,0);if(L>0){var R=this.awd_file_data.getAssetByID(L);r.addEffectMethod(R);M+=" | EffectMethod-Name = "+R.name}break;case 998:L=t.get(1,0);if(L>0){var C=this.awd_file_data.getAssetByID(L);r.shadowMethod=C;M+=" | EffectMethod-Name = "+C.name}break;case 1:L=t.get(1,0);var G=undefined;if(L>0){G=this.awd_file_data.getAssetByID(L)}if(G==undefined){G=this.awd_file_data.getDefaultCubeTexture()}r.ambientMethod=new d;r.texture=G;M+=" | AmbientEnvMapMethod | EnvMap-Name ="+G.name;break;case 51:r.diffuseMethod=new h;M+=" | DiffuseDepthMethod";break;case 52:L=t.get(1,0);var V=undefined;if(L>0){V=this.awd_file_data.getAssetByID(L)}if(V==undefined){V=l.getDefaultTexture()}r.diffuseMethod=new _(V);M+=" | DiffuseGradientMethod | GradientDiffuseTexture-Name ="+V.name;break;case 53:r.diffuseMethod=new u(t.get(101,5));M+=" | DiffuseWrapMethod";break;case 54:L=t.get(1,0);var V=undefined;if(L>0){V=this.awd_file_data.getAssetByID(L)}if(V==undefined){V=l.getDefaultTexture()}r.diffuseMethod=new p(V,this.awd_file_data.getBlendModeStringFromEnum(t.get(401,10)),false,r.diffuseMethod);M+=" | DiffuseLightMapMethod | LightMapTexture-Name ="+V.name;break;case 55:r.diffuseMethod=new c(t.get(401,3),r.diffuseMethod);r.diffuseMethod.smoothness=t.get(101,.1);M+=" | DiffuseCelMethod";break;case 56:break;case 101:r.specularMethod=new w;M+=" | SpecularAnisotropicMethod";break;case 102:r.specularMethod=new m;M+=" | SpecularPhongMethod";break;case 103:r.specularMethod=new b(t.get(101,.5),r.specularMethod);r.specularMethod.smoothness=t.get(102,.1);M+=" | SpecularCelMethod";break;case 104:r.specularMethod=new y(t.get(701,true),r.specularMethod);r.specularMethod.fresnelPower=t.get(101,5);r.specularMethod.normalReflectance=t.get(102,.1);M+=" | SpecularFresnelMethod";break;case 151:break;case 152:L=t.get(1,0);var V=undefined;if(L>0){V=this.awd_file_data.getAssetByID(L)}if(V==undefined){V=l.getDefaultTexture()}if(r.normalMap==undefined)r.normalMap=V;r.normalMethod=new f(r.normalMap,V);M+=" | NormalSimpleWaterMethod | Second-NormalTexture-Name = "+V.name;break}this.awd_file_data.parseUserAttributes();k+=1}}}else if(a>=3&&a<=7){var N=t.get(1,13421772);M+=N;var W=t.get(2,0);var I=undefined;if(W>0){I=this.awd_file_data.getAssetByID(W)}if(W==undefined){I=l.getDefaultTexture()}var z=new o(I);M+=" texture = "+W+" ";z.bothSides=true;z.preserveAlpha=true;z.alphaBlending=true;z.extra=this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug)console.log(M);this.awd_file_data.cur_block.data=z;return}r.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=r;if(this.awd_file_data.debug){console.log(M)}};return a}(s);a.exports=g},{"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseCelMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod":undefined,"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularCelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularPhongMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Mesh");var n=e("awayjs-display/lib/base/Geometry");var o=e("awayjs-core/lib/geom/Vector3D");var l=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;if(this.awd_file_data.cur_block.type==23){var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r=this.awd_file_data.parseMatrix3D()}this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var s="Root (TopLevel)";var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.getAssetByID(d);if(h==undefined){h=new n}this.awd_file_data.cur_block.geoID=d;var c=new Array;e=this.awd_file_data.newBlockBytes.readUnsignedShort();var _=new Array;a=0;while(a<e){var p;p=this.awd_file_data.newBlockBytes.readUnsignedInt();var u=this.awd_file_data.getAssetByID(p);if(u!=undefined){c.push(u);_.push(u.name)}a++}var f=new i(h,null);if(this.awd_file_data.cur_block.type==23){f.transform.matrix3D=r;if(t>0){var y=this.awd_file_data.getAssetByID(t);if(y!=undefined){y.addChild(f);s=y.name}}}if(c.length>=1&&f.subMeshes.length==1){f.material=c[0]}else if(c.length>1){var w;for(w=0;w<f.subMeshes.length;w++){f.subMeshes[w].material=c[Math.min(c.length-1,w)]}}if(this.awd_file_data.major_version>2||this.awd_file_data.major_version>=2&&this.awd_file_data.minor_version==1){var b=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:l.UINT8,5:l.BOOL});f.pivot=new o(b.get(1,0),b.get(2,0),b.get(3,0));f.castsShadows=b.get(5,true)}else{this.awd_file_data.parseProperties(null)}f.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=f;if(this.awd_file_data.debug){console.log("Parsed a Mesh: Name = '"+name+"' | Parent-Name = "+s+"| Geometry-Name = "+h.name+" | SubMeshes = "+f.subMeshes.length+" | Mat-Names = "+_.toString())}};return a}(s);a.exports=d},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=i.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.parseProperties({1:i.UINT32,2:i.AWDSTRING,3:i.AWDSTRING,4:i.AWDSTRING,5:i.AWDSTRING});if(this.awd_file_data.debug){console.log("Parsed a MetaDataBlock: TimeStamp         = "+e.get(1,0));console.log("                        EncoderName       = "+e.get(2,"unknown"));console.log("                        EncoderVersion    = "+e.get(3,"unknown"));console.log("                        GeneratorName     = "+e.get(4,"unknown"));console.log("                        GeneratorVersion  = "+e.get(5,"unknown"))}};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags");var n=e("awayjs-core/lib/geom/ColorTransform");var o=e("awayjs-core/lib/geom/Matrix3D");var l=e("awayjs-display/lib/base/Timeline");var d=e("awayjs-core/lib/geom/Vector3D");var h=e("awayjs-display/lib/entities/TextField");var c=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var _=function(e){r(a,e);function a(a){if(a===void 0){a=null}e.call(this);this.factory=new c(a)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r=new l;var s=this.factory.createMovieClip(r);this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var c=!!this.awd_file_data.newBlockBytes.readUnsignedByte();var _=this.awd_file_data.newBlockBytes.readUnsignedByte();var p=this.awd_file_data.newBlockBytes.readFloat();var u=1e3/p;var f=0;var y=0;var w=this.awd_file_data.newBlockBytes.readUnsignedShort();for(e=0;e<w;e++){M=this.awd_file_data.newBlockBytes.readUnsignedInt();var b=this.awd_file_data.getAssetByID(M);if(b!=null){r.registerPotentialChild(b)}else{console.log("ERROR when collecting objects for timeline")}}y+=w;var m=this.awd_file_data.newBlockBytes.readUnsignedShort();w+=m;for(e=0;e<m;e++){M=this.awd_file_data.newBlockBytes.readUnsignedInt();f=this.awd_file_data.newBlockBytes.readUnsignedShort();y+=f;var b=this.awd_file_data.getAssetByID(M);if(b!=null){for(a=0;a<f;a++){r.registerPotentialChild(b)}}else{for(a=0;a<f;a++){console.log("ERROR when collecting objects for timeline")}}}var v=this.awd_file_data.newBlockBytes.readUnsignedShort();for(e=0;e<v;e++){M=this.awd_file_data.newBlockBytes.readUnsignedInt();var b=this.awd_file_data.getAssetByID(M);if(b!=null){console.log("ERROR when collecting objects for timeline")}else{}}var g=this.awd_file_data.newBlockBytes.readUnsignedShort();var B=0;var k;var D;var A;var P;var j;var M;var N;var U;var T;var S=0;for(e=0;e<g;e++){k=this.awd_file_data.newBlockBytes.readUnsignedInt()*u;B+=k;D=this.awd_file_data.newBlockBytes.readUnsignedByte();A=this.awd_file_data.newBlockBytes.readUnsignedShort();T=false;for(a=0;a<A;a++){U=this.awd_file_data.newBlockBytes.readUnsignedByte();switch(U){case 1:N=this.awd_file_data.newBlockBytes.readUnsignedShort();var x=new Array;for(t=0;t<N;t++){j=this.awd_file_data.newBlockBytes.readShort();x.push(j)}break;case 2:case 3:P=this.awd_file_data.newBlockBytes.readUnsignedShort();if(U==2){T=true;j=this.awd_file_data.newBlockBytes.readShort();var W=r.getPotentialChildPrototype(P);if(W!=undefined){S++;if(W.isAsset(h)){}}else{console.log("ERROR: could not find the objectID ",P)}}var I=this.awd_file_data.newBlockBytes.readUnsignedShort();if(i.test(I,i.FLAG1)){var O=new o;if(i.test(I,i.FLAG2)){}else{O.rawData[0]=this.awd_file_data.newBlockBytes.readFloat();O.rawData[1]=this.awd_file_data.newBlockBytes.readFloat();O.rawData[4]=this.awd_file_data.newBlockBytes.readFloat();O.rawData[5]=this.awd_file_data.newBlockBytes.readFloat();O.position=new d(this.awd_file_data.newBlockBytes.readFloat(),this.awd_file_data.newBlockBytes.readFloat(),0)}}if(i.test(I,i.FLAG3)){var E=new n;if(i.test(I,i.FLAG4)){}else{E.redMultiplier=this.awd_file_data.newBlockBytes.readFloat();E.greenMultiplier=this.awd_file_data.newBlockBytes.readFloat();E.blueMultiplier=this.awd_file_data.newBlockBytes.readFloat();E.alphaMultiplier=this.awd_file_data.newBlockBytes.readFloat();E.redOffset=this.awd_file_data.newBlockBytes.readShort();E.greenOffset=this.awd_file_data.newBlockBytes.readShort();E.blueOffset=this.awd_file_data.newBlockBytes.readShort();E.alphaOffset=this.awd_file_data.newBlockBytes.readShort()}}if(i.test(I,i.FLAG5)){var F=this.awd_file_data.newBlockBytes.readUnsignedByte();var L=this.awd_file_data.getBlendModeStringFromEnum(F)}if(i.test(I,i.FLAG6)){}if(i.test(I,i.FLAG7)){var R=this.awd_file_data.parseVarStr();if(R.length){}}if(i.test(I,i.FLAG8)){var C=this.awd_file_data.newBlockBytes.readUnsignedShort();var G=new Array;for(var V=0;V<C;V++){G.push(this.awd_file_data.newBlockBytes.readShort())}if(G.length>0){if(G.length==1&&G[0]==-1){}}}break;case 4:P=this.awd_file_data.newBlockBytes.readUnsignedInt();M=this.awd_file_data.newBlockBytes.readUnsignedInt();break;default:break}}if(T){T=false}var z=this.awd_file_data.newBlockBytes.readUnsignedInt();if(z>0){}this.awd_file_data.newBlockBytes.readUnsignedInt()}this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=s;if(this.awd_file_data.debug)console.log("Parsed a TIMELINE: Name = "+name+"| isScene = "+c+"| sceneID = "+_+"| numFrames = "+g)};return a}(s);a.exports=_},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/base/Timeline":undefined,"awayjs-display/lib/entities/TextField":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/prefabs/PrefabBase");var o=e("awayjs-display/lib/prefabs/PrimitiveCapsulePrefab");var l=e("awayjs-display/lib/prefabs/PrimitiveConePrefab");var d=e("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var h=e("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var c=e("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var _=e("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var p=e("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var u=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;var s;var u;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();t=this.awd_file_data.newBlockBytes.readUnsignedByte();s=this.awd_file_data.parseProperties({101:this.awd_file_data.geoNrType,102:this.awd_file_data.geoNrType,103:this.awd_file_data.geoNrType,110:this.awd_file_data.geoNrType,111:this.awd_file_data.geoNrType,301:i.UINT16,302:i.UINT16,303:i.UINT16,701:i.BOOL,702:i.BOOL,703:i.BOOL,704:i.BOOL});var f=["Unsupported Type-ID","PrimitivePlanePrefab","PrimitiveCubePrefab","PrimitiveSpherePrefab","PrimitiveCylinderPrefab","PrimitivesConePrefab","PrimitivesCapsulePrefab","PrimitivesTorusPrefab"];switch(t){case 1:a=new c(s.get(101,100),s.get(102,100),s.get(301,1),s.get(302,1),s.get(701,true),s.get(702,false));break;case 2:a=new d(s.get(101,100),s.get(102,100),s.get(103,100),s.get(301,1),s.get(302,1),s.get(303,1),s.get(701,true));break;case 3:a=new _(s.get(101,50),s.get(301,16),s.get(302,12),s.get(701,true));break;case 4:a=new h(s.get(101,50),s.get(102,50),s.get(103,100),s.get(301,16),s.get(302,1),true,true,true);if(!s.get(701,true))a.topClosed=false;if(!s.get(702,true))a.bottomClosed=false;if(!s.get(703,true))a.yUp=false;break;case 5:a=new l(s.get(101,50),s.get(102,100),s.get(301,16),s.get(302,1),s.get(701,true),s.get(702,true));break;case 6:a=new o(s.get(101,50),s.get(102,100),s.get(301,16),s.get(302,15),s.get(701,true));break;case 7:a=new p(s.get(101,50),s.get(102,50),s.get(301,16),s.get(302,8),s.get(701,true));break;default:a=new n;console.log("ERROR: UNSUPPORTED PREFAB_TYPE");break}if(s.get(110,1)!=1||s.get(111,1)!=1){}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=a;if(this.awd_file_data.debug){if(t<0||t>7){t=0}console.log("Parsed a Primivite: Name = "+this.awd_file_data.cur_block.name+"| type = "+f[t])}};return a}(s);a.exports=u},{"awayjs-display/lib/prefabs/PrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveConePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-methodmaterials/lib/methods/ShadowDitheredMethod");var o=e("awayjs-methodmaterials/lib/methods/ShadowFilteredMethod");var l=e("awayjs-methodmaterials/lib/methods/ShadowHardMethod");var d=e("awayjs-methodmaterials/lib/methods/ShadowNearMethod");var h=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();r=this.awd_file_data.newBlockBytes.readUnsignedInt();var s=this.awd_file_data.getAssetByID(r);if(s==undefined){return}t=this.parseShadowMethodList(s);if(!t)return;this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug){console.log("Parsed a ShadowMapMethodMethod: Name = "+t.name+" | Type = "+t+" | Light-Name = ",s.name)}};a.prototype.parseShadowMethodList=function(e){var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t;var r=this.awd_file_data.parseProperties({1:i.BADDR,2:i.BADDR,3:i.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,201:i.UINT32,202:i.UINT32,301:i.UINT16,302:i.UINT16,401:i.UINT8,402:i.UINT8,601:i.COLOR,602:i.COLOR,701:i.BOOL,702:i.BOOL,801:i.MTX4x4});var s;var c;switch(a){case 1002:s=r.get(1,0);var _=this.awd_file_data.getAssetByID(s);if(_==undefined){return t}t=new d(_);break;case 1101:t=new o(e);t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);break;case 1102:t=new n(e,r.get(201,5));t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);t.range=r.get(103,1);break;case 1103:t=new h(e,r.get(201,5));t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);t.range=r.get(103,1);break;case 1104:t=new l(e);t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);break}this.awd_file_data.parseUserAttributes();return t};return a}(s);a.exports=c},{"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowHardMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowNearMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/ColorTransform");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=e("awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod");var l=e("awayjs-methodmaterials/lib/methods/EffectColorTransformMethod");var d=e("awayjs-methodmaterials/lib/methods/EffectFogMethod");var h=e("awayjs-methodmaterials/lib/methods/EffectRimLightMethod");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();e=this.parseSharedMethodList();this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a EffectMethod: Name = "+e.name+" Type = "+e)}};a.prototype.parseSharedMethodList=function(){var e=this.awd_file_data.newBlockBytes.readUnsignedShort();var a;var t=this.awd_file_data.parseProperties({1:n.BADDR,2:n.BADDR,3:n.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,104:this.awd_file_data.propsNrType,105:this.awd_file_data.propsNrType,106:this.awd_file_data.propsNrType,107:this.awd_file_data.propsNrType,201:n.UINT32,202:n.UINT32,301:n.UINT16,302:n.UINT16,401:n.UINT8,402:n.UINT8,601:n.COLOR,602:n.COLOR,701:n.BOOL,702:n.BOOL});var r;var i;switch(e){case 401:a=new o(t.get(101,new Array(0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)));break;case 402:a=new l;var c=t.get(601,0);a.colorTransform=new s(t.get(102,1),t.get(103,1),t.get(104,1),t.get(101,1),c>>16&255,c>>8&255,c&255,c>>24&255);break;case 403:break;case 404:break;case 406:a=new h(t.get(601,16777215),t.get(101,.4),t.get(101,2));break;case 407:break;case 410:break;case 411:a=new d(t.get(101,0),t.get(102,1e3),t.get(601,8421504));break}this.awd_file_data.parseUserAttributes();return a};return a}(i);a.exports=c},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFogMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectRimLightMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedByte();var t;if(a==0){t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=this.awd_file_data.newBlockBytes.readUTFBytes(t);this.awd_file_data.cur_block.dependencies_urls.push(r)}else{t=this.awd_file_data.newBlockBytes.readUnsignedInt();var i;i=new s;this.awd_file_data.newBlockBytes.readBytes(i,0,t);this.awd_file_data.cur_block.dependencies_data.push(i)}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var o=["external","embed"];console.log("Start parsing a "+o[a]+" Bitmap for Texture")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=this.awd_file_data.newBlockBytes.readUnsignedByte();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();for(a=0;a<6;a++){if(t==0){e=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=this.awd_file_data.newBlockBytes.readUTFBytes(e);this.awd_file_data.cur_block.dependencies_urls.push(r)}else{e=this.awd_file_data.newBlockBytes.readUnsignedInt();var i;i=new s;this.awd_file_data.newBlockBytes.readBytes(i,0,e);this.awd_file_data.cur_block.dependencies_data.push(i)}}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var o=["external","embed"];console.log("Start parsing 6 "+o[t]+" Bitmaps for CubeTexture")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/data/Skeleton");var n=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var t=0;while(t<a){var r;var s;this.awd_file_data.newBlockBytes.readUnsignedShort();r=new n;r.parentIndex=this.awd_file_data.newBlockBytes.readUnsignedShort()-1;r.name=this.awd_file_data.parseVarStr();s=this.awd_file_data.parseMatrix3D();r.inverseBindPose=s.rawData;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();e.joints.push(r);t++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a Skeleton: Name = "+this.awd_file_data.cur_block.name+" | Number of Joints = "+t)};return a}(s);a.exports=o},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var r=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var s=0;while(s<r){a=this.awd_file_data.newBlockBytes.readUnsignedInt();e=this.awd_file_data.newBlockBytes.readUnsignedShort();var n=this.awd_file_data.getAssetByID(a);if(n!=undefined){t.addFrame(n,e)}s++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug)console.log("Parsed a SkeletonClipNode: Name = "+this.awd_file_data.cur_block.name+" | Number of Frames = "+t.frames.length)};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=e("awayjs-renderergl/lib/animators/data/JointPose");var o=e("awayjs-core/lib/geom/Matrix3D");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var t=0;while(t<a){var r;var s;r=new n;s=this.awd_file_data.newBlockBytes.readUnsignedByte();if(s==1){var l=this.awd_file_data.parseMatrix43RawData();var d=new o(l);r.orientation.fromMatrix(d);r.translation.copyFrom(d.position);e.jointPoses[t]=r}t++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a SkeletonPose: Name = "+this.awd_file_data.cur_block.name+" | Number of Joints = "+t)};return a}(s);a.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-display/lib/entities/Skybox");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=undefined;if(e>0){a=this.awd_file_data.getAssetByID(e)}if(a==undefined){a=this.awd_file_data.getDefaultCubeTexture()}var t=new s(a);this.awd_file_data.parseProperties(null);t.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug)console.log("Parsed a Skybox: Name = '"+this.awd_file_data.cur_block.name+"' | CubeTexture-Name = "+a.name)};return a}(i);a.exports=n},{"awayjs-display/lib/entities/Skybox":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-display/lib/text/Font");var o=e("awayjs-display/lib/base/CurveSubGeometry");var l=function(e){r(a,e);
function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var t=0;t<a;++t){var r=this.awd_file_data.parseVarStr();var i=e.get_font_table(r);i.set_font_em_size(this.awd_file_data.newBlockBytes.readUnsignedInt());var l=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var t=0;t<l;++t){var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.newBlockBytes.position+h;while(this.awd_file_data.newBlockBytes.position<c){var _=0;var p,u,f,y;u=this.awd_file_data.newBlockBytes.readUnsignedByte();p=this.awd_file_data.newBlockBytes.readUnsignedByte();f=this.awd_file_data.newBlockBytes.readUnsignedInt();y=this.awd_file_data.newBlockBytes.position+f;if(u==2){var w=new Array;while(this.awd_file_data.newBlockBytes.position<y){w[_++]=this.awd_file_data.newBlockBytes.readUnsignedShort()}}else if(u==10){var b=0;var m=0;var v=0;var g=new Array;var B=new Array;var k=new Array;while(this.awd_file_data.newBlockBytes.position<y){g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);B[m++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);B[m++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k[v++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k[v++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else{this.awd_file_data.newBlockBytes.position=y}}var D=new o(new s);D.setIndices(w);D.setPositions(g);D.setCurves(B);D.setUVs(k);i.set_subgeo_for_char(d.toString(),D)}}this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a font: Name = '"+this.awd_file_data.cur_block.name)}};return a}(i);a.exports=l},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-display/lib/base/CurveSubGeometry":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/text/TextFormat");var o=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var l=function(e){r(a,e);function a(a){if(a===void 0){a=null}e.call(this);this.factory=new o(a)}a.prototype.parseFromBytes=function(){var e=this.factory.createTextField();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedByte();if(a==0){e.type="static"}else if(a==1){e.type="dynamic"}else if(a==2){e.type="input"}else if(a==3){e.type="input";e.displayAsPassword=true}e.width=this.awd_file_data.newBlockBytes.readFloat();e.height=this.awd_file_data.newBlockBytes.readFloat();var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r="";var s;for(var o=0;o<t;o++){var l=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var d=0;d<l;d++){var h=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.getAssetByID(h);if(c==undefined){s=new n}var _=this.awd_file_data.newBlockBytes.readUnsignedInt();if(_>0){var p=this.awd_file_data.newBlockBytes.readUTFBytes(_);r+=p}}}e.textFormat=s;e.text=r;var u=this.awd_file_data.parseProperties({1:i.BOOL,3:i.BOOL,4:i.BOOL,5:i.BOOL,7:i.UINT8,8:i.UINT8,9:i.UINT8});e.selectable=u.get(1,false);e.border=u.get(3,false);e.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TextField: Name = '"+e.name+"| text  = "+r)}};return a}(s);a.exports=l},{"awayjs-display/lib/text/TextFormat":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/text/TextFormat");var o=e("awayjs-display/lib/text/Font");var l=e("awayjs-display/lib/materials/BasicMaterial");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t=this.awd_file_data.parseVarStr();var r=this.awd_file_data.getAssetByID(a);if(r==undefined){r=new o}e.font_name=r.name;var s=r.get_font_table(t);if(s!=null){e.font_style=t;e.font_table=s}var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.getAssetByID(d);if(h==undefined){h=new l}h.bothSides=true;var c=this.awd_file_data.newBlockBytes.readUnsignedByte();var _=[];for(var p=0;p<c;p++){var u=this.awd_file_data.newBlockBytes.readFloat();_.push(u)}e.uv_values=_;var f=this.awd_file_data.parseProperties({1:i.UINT16,2:i.UINT16,3:i.UINT8,4:i.UINT8,5:i.UINT8,6:i.UINT8,7:i.UINT16,8:i.UINT16,9:i.UINT16,10:i.UINT16});e.size=f.get(1,12);e.letterSpacing=f.get(2,0);e.kerning=f.get(4,true);e.indent=f.get(7,0);e.leftMargin=f.get(8,0);e.rightMargin=f.get(9,0);e.size=f.get(1,12);e.letterSpacing=f.get(2,0);e.kerning=f.get(4,true);e.material=h;this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TextFormat: Name = '"+name+" font: "+r.name)}};return a}(s);a.exports=d},{"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-display/lib/text/TextFormat":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var l=e("awayjs-display/lib/base/TriangleSubGeometry");var d=e("awayjs-display/lib/base/Geometry");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=false;if(this.awd_file_data.cur_block.type==111){e=true}var a=1;var t;var r;var i;var h;var c;var _;var p;var u;var f;var y;var w;var b=0;var m;var v;var g=0;var B=0;var k=new Array;var D;var A;var P=new o;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var j=this.awd_file_data.newBlockBytes.readUnsignedInt();var M=this.awd_file_data.getAssetByID(j);if(M==undefined){return}var N=this.awd_file_data.getUVForVertexAnimation(j);if(!e)a=this.awd_file_data.newBlockBytes.readUnsignedShort();t=this.awd_file_data.newBlockBytes.readUnsignedShort();g=this.awd_file_data.newBlockBytes.readUnsignedShort();B=0;while(B<g){k.push(this.awd_file_data.newBlockBytes.readUnsignedShort());B++}D=this.awd_file_data.parseProperties({1:n.BOOL,2:n.BOOL});P.looping=D.get(1,true);P.stitchFinalFrame=D.get(2,false);r=0;while(r<a){h=this.awd_file_data.newBlockBytes.readUnsignedShort();y=new d;i=0;while(i<t){B=0;u=this.awd_file_data.newBlockBytes.readUnsignedInt();f=this.awd_file_data.newBlockBytes.position+u;while(B<g){if(k[B]==1){m=M.subGeometries[i].indices;v=new Array;b=0;while(this.awd_file_data.newBlockBytes.position<f){c=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);_=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);p=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);v[b++]=c;v[b++]=_;v[b++]=p}w=new l(new s);w.setIndices(m);w.setPositions(v);w.setUVs(N[i]);w.setNormals(null);w.setTangents(null);w.autoDeriveNormals=false;w.autoDeriveTangents=false;i++;y.addSubGeometry(w)}else this.awd_file_data.newBlockBytes.position=f;B++}}P.addFrame(y,h);r++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=P;if(this.awd_file_data.debug)console.log("Parsed a VertexClipNode: Name = "+P.name+" | Target-Geometry-Name = "+M.name+" | Number of Frames = "+P.frames.length)};return a}(i);a.exports=h},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var o=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var l=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var d=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t=this.awd_file_data.parseProperties({1:i.UINT16});var r=0;var s=new Array;var h=new Array;while(r<a){e=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.getAssetByID(e);if(c==undefined){}else{if(c instanceof o)h.push(c);if(c instanceof n)s.push(c)}r++}if(h.length==0&&s.length==0){return}this.awd_file_data.parseUserAttributes();if(h.length>0){var _=new l;for(var p=0;p<h.length;p++)_.addAnimation(h[p]);this.awd_file_data.cur_block.data=_;if(this.awd_file_data.debug)console.log("Parsed a VertexAnimationSet: Name = "+_.name+" | Animations = "+_.animations.length+" | Animation-Names = "+_.animationNames.toString());return}else if(s.length>0){var u=new d(t.get(1,4));for(var p=0;p<s.length;p++)u.addAnimation(s[p]);this.awd_file_data.cur_block.data=u;if(this.awd_file_data.debug)console.log("Parsed a SkeletonAnimationSet: Name = "+u.name+" | Animations = "+u.animations.length+" | Animation-Names = "+u.animationNames.toString())}};return a}(s);a.exports=h},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData":[function(e,a,t){var r=e("awayjs-core/lib/data/BlendMode");var s=e("awayjs-core/lib/geom/Matrix3D");var i=e("awayjs-display/lib/managers/DefaultMaterialManager");var n=e("awayjs-display/lib/entities/Mesh");var o=e("awayjs-display/lib/textures/SingleCubeTexture");var l=e("awayjs-display/lib/textures/Single2DTexture");var d=e("awayjs-methodmaterials/lib/MethodMaterial");var h=e("awayjs-parsers/lib/AWD3ParserUtils/AWDProperties");var c=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBlock");var _=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var p=function(){function e(){this._debug=false;this._accuracyOnBlocks=false;this.major_version=0;this.minor_version=0;this._blocks=new Array;this._blocks.push(new c(255,0));this._cur_block=this._blocks[0];this.blendModeDic=new Array;this.blendModeDic.push(r.NORMAL);this.blendModeDic.push(r.ADD);this.blendModeDic.push(r.ALPHA);this.blendModeDic.push(r.DARKEN);this.blendModeDic.push(r.DIFFERENCE);this.blendModeDic.push(r.ERASE);this.blendModeDic.push(r.HARDLIGHT);this.blendModeDic.push(r.INVERT);this.blendModeDic.push(r.LAYER);this.blendModeDic.push(r.LIGHTEN);this.blendModeDic.push(r.MULTIPLY);this.blendModeDic.push(r.NORMAL);this.blendModeDic.push(r.OVERLAY);this.blendModeDic.push(r.SCREEN);this.blendModeDic.push(r.SHADER);this.blendModeDic.push(r.OVERLAY);this._depthSizeDic=new Array;this._depthSizeDic.push(256);this._depthSizeDic.push(512);this._depthSizeDic.push(2048);this._depthSizeDic.push(1024)}e.prototype.getDepthSizeFromEnum=function(e){return this._depthSizeDic[e]};e.prototype.getBlendModeStringFromEnum=function(e){return this.blendModeDic[e]};e.prototype.dispose=function(){for(var e in this._blocks){var a=this._blocks[e];a.dispose()}};Object.defineProperty(e.prototype,"accuracyOnBlocks",{get:function(){return this._accuracyOnBlocks},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyMatrix",{get:function(){return this._accuracyMatrix},set:function(e){this._accuracyMatrix=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyProps",{get:function(){return this._accuracyProps},set:function(e){this._accuracyProps=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyGeo",{get:function(){return this._accuracyGeo},set:function(e){this._accuracyGeo=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"matrixNrType",{get:function(){return this._matrixNrType},set:function(e){this._matrixNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"propsNrType",{get:function(){return this._propsNrType},set:function(e){this._propsNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geoNrType",{get:function(){return this._geoNrType},set:function(e){this._geoNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"newBlockBytes",{get:function(){return this._newBlockBytes},set:function(e){this._newBlockBytes=e},enumerable:true,configurable:true});e.prototype.create_new_block=function(e,a){var t=new c(this._blocks.length,e);this._cur_block=t;this._blocks[a]=t};Object.defineProperty(e.prototype,"cur_block",{get:function(){return this._cur_block},enumerable:true,configurable:true});e.prototype.block_cnt=function(){return this._blocks.length};e.prototype.parseUserAttributes=function(){var e;var a;var t;a=this._newBlockBytes.readUnsignedInt();if(a>0){var r;e={};r=this._newBlockBytes.position+a;while(this._newBlockBytes.position<r){var s;var i;var n;var o;var l;s=this._newBlockBytes.readUnsignedByte();i=this.parseVarStr();n=this._newBlockBytes.readUnsignedByte();o=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+o>r){console.log("           Error in reading attribute # "+t+" = skipped to end of attribute-list");this._newBlockBytes.position=r;return e}switch(n){case _.AWDSTRING:l=this._newBlockBytes.readUTFBytes(o);break;case _.INT8:l=this._newBlockBytes.readByte();break;case _.INT16:l=this._newBlockBytes.readShort();break;case _.INT32:l=this._newBlockBytes.readInt();break;case _.BOOL:case _.UINT8:l=this._newBlockBytes.readUnsignedByte();break;case _.UINT16:l=this._newBlockBytes.readUnsignedShort();break;case _.UINT32:case _.BADDR:l=this._newBlockBytes.readUnsignedInt();break;case _.FLOAT32:l=this._newBlockBytes.readFloat();break;case _.FLOAT64:l=this._newBlockBytes.readDouble();break;default:l="unimplemented attribute type "+n;this._newBlockBytes.position+=o;break}if(this._debug){console.log("attribute = name: "+i+"  / value = "+l)}e[i]=l;t+=1}}return e};e.prototype.parseProperties=function(e){var a;var t;var r=0;var s=new h;t=this._newBlockBytes.readUnsignedInt();a=this._newBlockBytes.position+t;if(e){while(this._newBlockBytes.position<a){var i;var n;var o;n=this._newBlockBytes.readUnsignedShort();i=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+i>a){console.log("           Error in reading property # "+r+" = skipped to end of propertie-list");this._newBlockBytes.position=a;return s}if(e.hasOwnProperty(n.toString())){o=e[n];s.set(n,this.parseAttrValue(o,i))}else{this._newBlockBytes.position+=i}r+=1}}else{this._newBlockBytes.position=a}return s};e.prototype.parseAttrValue=function(e,a){var t;var r;switch(e){case _.BOOL:case _.INT8:t=1;r=this._newBlockBytes.readByte;break;case _.INT16:t=2;r=this._newBlockBytes.readShort;break;case _.INT32:t=4;r=this._newBlockBytes.readInt;break;case _.UINT8:t=1;r=this._newBlockBytes.readUnsignedByte;break;case _.UINT16:t=2;r=this._newBlockBytes.readUnsignedShort;break;case _.UINT32:case _.COLOR:case _.BADDR:t=4;r=this._newBlockBytes.readUnsignedInt;break;case _.FLOAT32:t=4;r=this._newBlockBytes.readFloat;break;case _.FLOAT64:t=8;r=this._newBlockBytes.readDouble;break;case _.AWDSTRING:return this._newBlockBytes.readUTFBytes(a);case _.VECTOR2x1:case _.VECTOR3x1:case _.VECTOR4x1:case _.MTX3x2:case _.MTX3x3:case _.MTX4x3:case _.MTX4x4:t=8;r=this._newBlockBytes.readDouble;break}if(t<a){var s=[];var i=0;var n=a/t;while(i<n){s.push(r.apply(this._newBlockBytes));i++}return s}else{var o=r.apply(this._newBlockBytes);return o}};e.prototype.getUVForVertexAnimation=function(e){if(this._blocks[e].data instanceof n)e=this._blocks[e].geoID;if(this._blocks[e].uvsForVertexAnimation)return this._blocks[e].uvsForVertexAnimation;var a=this._blocks[e].data;var t=0;var r;this._blocks[e].uvsForVertexAnimation=new Array;while(t<a.subGeometries.length){r=a.subGeometries[t];this._blocks[e].uvsForVertexAnimation.push(r.uvs.get(r.numVertices));t++}return this._blocks[e].uvsForVertexAnimation};e.prototype.parseVarStr=function(){var e=this._newBlockBytes.readUnsignedShort();return this._newBlockBytes.readUTFBytes(e)};e.prototype.getBlockByID=function(e){return this._blocks[e]};e.prototype.getAssetByID=function(e){return this._blocks[e].data};e.prototype.getDefaultAsset=function(e){switch(true){case e==o.assetType:return this.getDefaultCubeTexture();break;case e==l.assetType:return i.getDefaultTexture();break;case e==d.assetType:return i.getDefaultMaterial();break;default:break}return null};e.prototype.getDefaultCubeTexture=function(){return this._defaultCubeTexture};e.prototype.readNumber=function(e){if(e===void 0){e=false}if(e)return this._newBlockBytes.readDouble();return this._newBlockBytes.readFloat()};e.prototype.parseMatrix3D=function(){return new s(this.parseMatrix43RawData())};e.prototype.parseMatrix32RawData=function(){var e;var a=new Array(6);for(e=0;e<6;e++){a[e]=this._newBlockBytes.readFloat()}return a};e.prototype.parseMatrix43RawData=function(){var e=new Float32Array(16);e[0]=this.readNumber(this._accuracyMatrix);e[1]=this.readNumber(this._accuracyMatrix);e[2]=this.readNumber(this._accuracyMatrix);e[3]=0;e[4]=this.readNumber(this._accuracyMatrix);e[5]=this.readNumber(this._accuracyMatrix);e[6]=this.readNumber(this._accuracyMatrix);e[7]=0;e[8]=this.readNumber(this._accuracyMatrix);e[9]=this.readNumber(this._accuracyMatrix);e[10]=this.readNumber(this._accuracyMatrix);e[11]=0;e[12]=this.readNumber(this._accuracyMatrix);e[13]=this.readNumber(this._accuracyMatrix);e[14]=this.readNumber(this._accuracyMatrix);e[15]=1;if(isNaN(e[0])){e[0]=1;e[1]=0;e[2]=0;e[4]=0;e[5]=1;e[6]=0;e[8]=0;e[9]=0;e[10]=1;e[12]=0;e[13]=0;e[14]=0}return e};return e}();a.exports=p},{"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock","awayjs-parsers/lib/AWD3ParserUtils/AWDProperties":"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties"}],"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":[function(e,a,t){var r=function(){function e(){}e.BLOCKSTATE_FINALIZE=0;e.BLOCKSTATE_INVALID=1;e.BLOCKSTATE_LOAD_DEPENDENICES=2;e.BLOCKSTATE_NO_ASSET=3;e.COMPRESSIONMODE_LZMA="lzma";e.UNCOMPRESSED=0;e.DEFLATE=1;e.LZMA=2;e.INT8=1;e.INT16=2;e.INT32=3;e.UINT8=4;e.UINT16=5;e.UINT32=6;e.FLOAT32=7;e.FLOAT64=8;e.BOOL=21;e.COLOR=22;e.BADDR=23;e.AWDSTRING=31;e.AWDBYTEARRAY=32;e.VECTOR2x1=41;e.VECTOR3x1=42;e.VECTOR4x1=43;e.MTX3x2=44;e.MTX3x3=45;e.MTX4x3=46;e.MTX4x4=47;return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":[function(e,a,t){var r=function(){function e(){}e.test=function(e,a){return(e&a)==a};e.FLAG1=1;e.FLAG2=2;e.FLAG3=4;e.FLAG4=8;e.FLAG5=16;e.FLAG6=32;e.FLAG7=64;e.FLAG8=128;e.FLAG9=256;e.FLAG10=512;e.FLAG11=1024;e.FLAG12=2048;e.FLAG13=4096;e.FLAG14=8192;e.FLAG15=16384;e.FLAG16=32768;return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":[function(e,a,t){var r=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var s=function(){function e(e,a){this.type=a;this.id=e;this.state=r.BLOCKSTATE_FINALIZE;this.dependencies_data=Array();this.dependencies_urls=Array();if(a==83){this.loaded_dependencies=Array(6)}this.loaded_dependencies_cnt=0}e.prototype.dispose=function(){this.id=null;this.bytes=null;this.errorMessages=null;this.uvsForVertexAnimation=null};e.prototype.addError=function(e){if(!this.errorMessages)this.errorMessages=new Array;this.errorMessages.push(e)};return e}();a.exports=s},{"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties":[function(e,a,t){var r=function(){function e(){}e.prototype.set=function(e,a){this[e.toString()]=a};e.prototype.get=function(e,a){if(this.hasOwnProperty(e.toString())){return this[e.toString()]}else{return a}};return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3Parser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/data/BitmapImageCube");var i=e("awayjs-core/lib/net/URLLoaderDataFormat");var n=e("awayjs-core/lib/net/URLRequest");var o=e("awayjs-core/lib/parsers/ParserBase");var l=e("awayjs-core/lib/parsers/ParserUtils");var d=e("awayjs-core/lib/utils/ByteArray");var h=e("awayjs-display/lib/base/DisplayObject");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var _=e("awayjs-display/lib/textures/SingleCubeTexture");var p=e("awayjs-display/lib/textures/Single2DTexture");var u=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags");var f=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers");var y=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData");var w=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var b=function(e){r(a,e);function a(a){if(a===void 0){a=undefined}e.call(this,i.ARRAY_BUFFER);this._debug=false;this._startedParsing=false;this._parsed_header=false;this.total_time=0;this.geom_time=0;this.timeline_time=0;this._block_parser=a;if(this._block_parser==undefined){this._block_parser=new f}this._awd_data=new y;this._block_parser.init_parser(this._awd_data)}a.supportsType=function(e){e=e.toLowerCase();return e=="awd"};a.supportsData=function(e){return l.toString(e,3)=="AWD"};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a=this._awd_data.getBlockByID(parseInt(e.id));if(a.type==82){var t=new p(e.assets[0]);a.data=t;this._pFinalizeAsset(t,a.name);if(this._debug){console.log("Successfully loaded Bitmap for texture");console.log("Parsed texture: Name = "+a.name)}}else if(a.type==44){if(this._debug){console.log("Successfully loaded Sound into AudioAsset");console.log("Loaded Sound: Name = "+a.name)}}else if(a.type==83){a.loaded_dependencies[e.sub_id]=e.assets[0];a.loaded_dependencies_cnt++;if(a.loaded_dependencies_cnt==6){if(this._debug){console.log("Successfully loaded Bitmap "+e.sub_id+" / 6 for Cubetexture")}var r=new s(a.loaded_dependencies[0].width);for(var i=0;i<6;i++)r.draw(i,a.loaded_dependencies[i]);var n=new _(r);a.data=n;this._pFinalizeAsset(n,a.name);if(this._debug){console.log("Parsed CubeTexture: Name = "+a.name)}}}}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._iResolveDependencyName=function(e,a){var t=a.name;if(a){var r=this._awd_data.getBlockByID(parseInt(e.id));a.resetAssetPath(r.name,null,true)}var s=a.name;a.name=t;return s};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true}if(!this._parsed_header){this.parseHeader();switch(this._compression){case w.DEFLATE:case w.LZMA:this._pDieWithError("Compressed AWD formats not yet supported");break;case w.UNCOMPRESSED:this._body=this._byteData;break}this._parsed_header=true}if(this._body){while(this._body.getBytesAvailable()>0&&!this.parsingPaused){this.parseNextBlock()}if(this._body.getBytesAvailable()==0){this.dispose();return o.PARSING_DONE}else{return o.MORE_TO_PARSE}}else{switch(this._compression){case w.DEFLATE:case w.LZMA:if(this._debug){console.log("(!) AWD3Utils Error: Compressed AWD formats not yet supported (!)")}break}return o.PARSING_DONE}};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new c};a.prototype.dispose=function(){this._awd_data.dispose()};a.prototype.parseNextBlock=function(){var e=this._body.readUnsignedInt();var a=this._body.readUnsignedByte();var t=this._body.readUnsignedByte();var r=this._body.readUnsignedByte();var s=this._body.readUnsignedInt();var i=u.test(r,u.FLAG4);var o=u.test(r,u.FLAG5);if(this._awd_data.accuracyOnBlocks){this._awd_data.accuracyMatrix=u.test(r,u.FLAG1);this._awd_data.accuracyGeo=u.test(r,u.FLAG2);this._awd_data.accuracyProps=u.test(r,u.FLAG3);this._awd_data.geoNrType=w.FLOAT32;if(this._awd_data.accuracyGeo){this._awd_data.geoNrType=w.FLOAT64}this._awd_data.matrixNrType=w.FLOAT32;if(this._awd_data.accuracyMatrix){this._awd_data.matrixNrType=w.FLOAT64}this._awd_data.propsNrType=w.FLOAT32;if(this._awd_data.accuracyProps){this._awd_data.propsNrType=w.FLOAT64}}var c=this._body.position+s;if(s>this._body.getBytesAvailable()){this._pDieWithError("AWD2 block length is bigger than the bytes that are available!");this._body.position+=this._body.getBytesAvailable();return}var _=new d;this._body.readBytes(_,0,s);this._awd_data.newBlockBytes=_;if(i){this._pDieWithError("Compressed AWD formats not yet supported")}this._awd_data.newBlockBytes.position=0;this._awd_data.create_new_block(t,e);if(i){this._pDieWithError("Compressed AWD formats not yet supported")}console.log("AWDBlock:  ID = "+e+" | TypeID = "+t+" | Compression = "+i+" | Matrix-Precision = "+this._awd_data.accuracyMatrix+" | Geometry-Precision = "+this._awd_data.accuracyGeo+" | Properties-Precision = "+this._awd_data.accuracyProps);var p=performance.now();if(this._block_parser.parseAsset(t)){if(this._awd_data.cur_block.state==w.BLOCKSTATE_FINALIZE){this._pFinalizeAsset(this._awd_data.cur_block.data,this._awd_data.cur_block.name);if(this._awd_data.cur_block.data instanceof h){if(this._awd_data.cur_block.data.parent==undefined){this._pContent.addChild(this._awd_data.cur_block.data)}}}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_INVALID){console.log("ERROR while parsing block - type = ",t," id = ",e)}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_LOAD_DEPENDENICES){for(var f=0;f<this._awd_data.cur_block.dependencies_urls.length;f++){this._pAddDependency(this._awd_data.cur_block.id.toString(),new n(this._awd_data.cur_block.dependencies_urls[f]),false,null,true,f)}for(var f=0;f<this._awd_data.cur_block.dependencies_data.length;f++){if(t==82||t==83){this._pAddDependency(this._awd_data.cur_block.id.toString(),null,false,l.byteArrayToImage(this._awd_data.cur_block.dependencies_data[f]),true,f)}else if(t==44){}}this._pPauseAndRetrieveDependencies()}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_NO_ASSET){}}else{console.log("Encountered unknown blocktype - type = ",t," id = ",e)}var y=performance.now();var b=y-p;this.total_time+=b;if(t==1){this.geom_time+=b}else if(t==133){this.timeline_time+=b}console.log("'parsed '"+t+"'  block in "+b+" ms"," total: ",this.total_time," geom: ",this.geom_time,"timelines:",this.timeline_time);this._body.position=c;this._awd_data.newBlockBytes=null};a.prototype.parseHeader=function(){var e;var a;this._byteData.position=3;this._awd_data.major_version=this._byteData.readUnsignedByte();this._awd_data.minor_version=this._byteData.readUnsignedByte();e=this._byteData.readUnsignedShort();this._streaming=u.test(e,u.FLAG1);if(this._awd_data.major_version==2&&this._awd_data.minor_version==1){this._awd_data.accuracyMatrix=u.test(e,u.FLAG2);this._awd_data.accuracyGeo=u.test(e,u.FLAG3);this._awd_data.accuracyProps=u.test(e,u.FLAG4)}this._awd_data.geoNrType=w.FLOAT32;if(this._awd_data.accuracyGeo){this._awd_data.geoNrType=w.FLOAT64}this._awd_data.matrixNrType=w.FLOAT32;if(this._awd_data.accuracyMatrix){this._awd_data.matrixNrType=w.FLOAT64}this._awd_data.propsNrType=w.FLOAT32;if(this._awd_data.accuracyProps){this._awd_data.propsNrType=w.FLOAT64}this._compression=this._byteData.readUnsignedByte();if(this._debug){console.log("Import AWDFile of version = "+this._awd_data.major_version+" - "+this._awd_data.minor_version);console.log("Global Settings = Compression = "+this._compression+" | Streaming = "+this._streaming+" | Matrix-Precision = "+this._awd_data.accuracyMatrix+" | Geometry-Precision = "+this._awd_data.accuracyGeo+" | Properties-Precision = "+this._awd_data.accuracyProps)}a=this._byteData.readUnsignedInt();if(!this._streaming&&a!=this._byteData.getBytesAvailable()){this._pDieWithError("AWD2 body length does not match header integrity field")}};return a}(o);a.exports=b},{"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/base/DisplayObject":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers","awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData":"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags"}],"awayjs-parsers/lib/AWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/attributes/Float2Attributes");var n=e("awayjs-core/lib/data/BitmapImageCube");
var o=e("awayjs-core/lib/data/BlendMode");var l=e("awayjs-core/lib/geom/ColorTransform");var d=e("awayjs-core/lib/geom/Matrix3D");var h=e("awayjs-core/lib/geom/Vector3D");var c=e("awayjs-core/lib/net/URLLoaderDataFormat");var _=e("awayjs-core/lib/net/URLRequest");var p=e("awayjs-core/lib/parsers/ParserBase");var u=e("awayjs-core/lib/parsers/ParserUtils");var f=e("awayjs-core/lib/projections/PerspectiveProjection");var y=e("awayjs-core/lib/projections/OrthographicProjection");var w=e("awayjs-core/lib/projections/OrthographicOffCenterProjection");var b=e("awayjs-core/lib/utils/ByteArray");var m=e("awayjs-display/lib/containers/DisplayObjectContainer");var v=e("awayjs-display/lib/base/Geometry");var g=e("awayjs-display/lib/base/CurveSubGeometry");var B=e("awayjs-display/lib/base/TriangleSubGeometry");var k=e("awayjs-display/lib/entities/DirectionalLight");var D=e("awayjs-display/lib/entities/PointLight");var A=e("awayjs-display/lib/entities/Camera");var P=e("awayjs-display/lib/entities/Mesh");var j=e("awayjs-display/lib/entities/Billboard");var M=e("awayjs-display/lib/entities/Skybox");var N=e("awayjs-display/lib/managers/DefaultMaterialManager");var U=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var T=e("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var S=e("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var x=e("awayjs-display/lib/prefabs/PrefabBase");var W=e("awayjs-display/lib/prefabs/PrimitiveCapsulePrefab");var I=e("awayjs-display/lib/prefabs/PrimitiveConePrefab");var O=e("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var E=e("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var F=e("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var L=e("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var R=e("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var C=e("awayjs-display/lib/textures/SingleCubeTexture");var G=e("awayjs-display/lib/textures/Single2DTexture");var V=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var z=e("awayjs-renderergl/lib/animators/VertexAnimator");var K=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var H=e("awayjs-renderergl/lib/animators/SkeletonAnimator");var J=e("awayjs-renderergl/lib/animators/data/JointPose");var Y=e("awayjs-renderergl/lib/animators/data/Skeleton");var X=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var Q=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var q=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var Z=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var $=e("awayjs-methodmaterials/lib/MethodMaterialMode");var ea=e("awayjs-methodmaterials/lib/MethodMaterial");var aa=e("awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod");var ta=e("awayjs-methodmaterials/lib/methods/DiffuseDepthMethod");var ra=e("awayjs-methodmaterials/lib/methods/DiffuseCelMethod");var sa=e("awayjs-methodmaterials/lib/methods/DiffuseGradientMethod");var ia=e("awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod");var na=e("awayjs-methodmaterials/lib/methods/DiffuseWrapMethod");var oa=e("awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod");var la=e("awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod");var da=e("awayjs-methodmaterials/lib/methods/EffectColorTransformMethod");var ha=e("awayjs-methodmaterials/lib/methods/EffectEnvMapMethod");var ca=e("awayjs-methodmaterials/lib/methods/EffectFogMethod");var _a=e("awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod");var pa=e("awayjs-methodmaterials/lib/methods/EffectLightMapMethod");var ua=e("awayjs-methodmaterials/lib/methods/EffectRimLightMethod");var fa=e("awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod");var ya=e("awayjs-methodmaterials/lib/methods/ShadowDitheredMethod");var wa=e("awayjs-methodmaterials/lib/methods/ShadowFilteredMethod");var ba=e("awayjs-methodmaterials/lib/methods/SpecularFresnelMethod");var ma=e("awayjs-methodmaterials/lib/methods/ShadowHardMethod");var va=e("awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod");var ga=e("awayjs-methodmaterials/lib/methods/SpecularCelMethod");var Ba=e("awayjs-methodmaterials/lib/methods/SpecularPhongMethod");var ka=e("awayjs-methodmaterials/lib/methods/ShadowNearMethod");var Da=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var Aa=e("awayjs-display/lib/materials/BasicMaterial");var Pa=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var ja=e("awayjs-display/lib/base/Timeline");var Ma=e("awayjs-display/lib/text/Font");var Na=e("awayjs-display/lib/text/TextFormat");var Ua=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBlock");var Ta=function(e){r(a,e);function a(t){if(t===void 0){t=null}e.call(this,c.ARRAY_BUFFER);this._debug=false;this._debugTimers=true;this._startedParsing=false;this._texture_users={};this._parsed_header=false;this._time_all=0;this._time_geom=0;this._time_geom_bytes=0;this._time_timeline=0;this._time_fonts=0;this._time_textfields=0;this._time_sounds=0;this._time_textures=0;this._time_materials=0;this._time_meshes=0;this._num_geom=0;this._num_timeline=0;this._num_fonts=0;this._num_textfields=0;this._num_sounds=0;this._num_textures=0;this._num_materials=0;this._num_meshes=0;this.shadowMethodListProperties={1:a.BADDR,2:a.BADDR,3:a.BADDR,101:a.PROPERTY_NUMBER,102:a.PROPERTY_NUMBER,103:a.PROPERTY_NUMBER,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL,801:a.MTX4x4};this.meshPoseAnimationProperties={1:a.BOOL,2:a.BOOL};this.sharedMethodListProperties={1:a.BADDR,2:a.BADDR,3:a.BADDR,101:a.PROPERTY_NUMBER,102:a.PROPERTY_NUMBER,103:a.PROPERTY_NUMBER,104:a.PROPERTY_NUMBER,105:a.PROPERTY_NUMBER,106:a.PROPERTY_NUMBER,107:a.PROPERTY_NUMBER,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL};this._view=t;this._blocks=new Array;this._blocks[0]=new Ua(0,255);this._blocks[0].data=null;this.blendModeDic=new Array;this.blendModeDic.push(o.NORMAL);this.blendModeDic.push(o.ADD);this.blendModeDic.push(o.ALPHA);this.blendModeDic.push(o.DARKEN);this.blendModeDic.push(o.DIFFERENCE);this.blendModeDic.push(o.ERASE);this.blendModeDic.push(o.HARDLIGHT);this.blendModeDic.push(o.INVERT);this.blendModeDic.push(o.LAYER);this.blendModeDic.push(o.LIGHTEN);this.blendModeDic.push(o.MULTIPLY);this.blendModeDic.push(o.NORMAL);this.blendModeDic.push(o.OVERLAY);this.blendModeDic.push(o.SCREEN);this.blendModeDic.push(o.SHADER);this.blendModeDic.push(o.OVERLAY);this._depthSizeDic=new Array;this._depthSizeDic.push(256);this._depthSizeDic.push(512);this._depthSizeDic.push(2048);this._depthSizeDic.push(1024);this._version=Array()}a.supportsType=function(e){e=e.toLowerCase();return e=="awd"};a.supportsData=function(e){return u.toString(e,3)=="AWD"};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a=this._blocks[parseInt(e.id)];if(a.type==82){var t=new G(e.assets[0]);a.data=t;this._pFinalizeAsset(t,a.name);if(this._debug)console.log("Parsed Texture: Name = "+a.name)}else if(a.type==44){var r=e.assets[0];a.data=r;this._pFinalizeAsset(r,a.name);if(this._debug)console.log("Parsed WaveAudio: Name = "+a.name)}else if(a.type==83){a.loaded_dependencies[e.sub_id]=e.assets[0];a.loaded_dependencies_cnt++;if(this._debug)console.log("Successfully loaded Bitmap "+e.sub_id+" / 6 for Cubetexture");if(a.loaded_dependencies_cnt==6){var s=new n(a.loaded_dependencies[0].width);for(var i=0;i<6;i++)s.draw(i,a.loaded_dependencies[i]);var o=new C(s);a.data=o;this._pFinalizeAsset(o,a.name);if(this._debug)console.log("Parsed CubeTexture: Name = "+a.name)}}if(this._debugTimers&&!this._isParsing)this.updateTimers(a.type)}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._iResolveDependencyName=function(e,a){var t=a.name;if(a){var r=this._blocks[parseInt(e.id)];a.resetAssetPath(r.name,null,true)}var s=a.name;a.name=t;return s};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true}if(!this._parsed_header){this.parseHeader();switch(this._compression){case a.DEFLATE:case a.LZMA:this._pDieWithError("Compressed AWD formats not yet supported");break;case a.UNCOMPRESSED:this._body=this._byteData;break}this._parsed_header=true}if(this._body){while(this._body.getBytesAvailable()>0&&!this.parsingPaused)this.parseNextBlock();if(this._body.getBytesAvailable()==0){this.dispose();if(this._debugTimers)console.log("Parsing total: "+(this._time_all|0)+"ms"," | geoms: "+this._num_geom+", "+(this._time_geom|0)+"ms"," | geoms bytes: "+this._num_geom+", "+(this._time_geom_bytes|0)+"ms"," | timelines: "+this._num_timeline+", "+(this._time_timeline|0)+"ms"," | fonts: "+this._num_fonts+", "+(this._time_fonts|0)+"ms"," | sounds: "+this._num_sounds+", "+(this._time_sounds|0)+"ms"," | mats: "+this._num_materials+", "+(this._time_materials|0)+"ms"," | textures: "+this._num_textures+", "+(this._time_textures|0)+"ms"," | meshes: "+this._num_meshes+", "+(this._time_meshes|0)+"ms");return p.PARSING_DONE}else{return p.MORE_TO_PARSE}}else{switch(this._compression){case a.DEFLATE:case a.LZMA:if(this._debug)console.log("(!) AWDParser Error: Compressed AWD formats not yet supported (!)");break}return p.PARSING_DONE}};a.prototype._pStartParsing=function(a){this._pContent=new m;e.prototype._pStartParsing.call(this,a)};a.prototype.dispose=function(){for(var e in this._blocks){var a=this._blocks[e];a.dispose()}};a.prototype.parseNextBlock=function(){var e;var a=false;var t;var r;var s;var i;if(this._debugTimers)this.start_timeing=performance.now();this._cur_block_id=this._body.readUnsignedInt();t=this._body.readUnsignedByte();r=this._body.readUnsignedByte();s=this._body.readUnsignedByte();i=this._body.readUnsignedInt();var n=xa.test(s,xa.FLAG4);var o=xa.test(s,xa.FLAG5);if(this._accuracyOnBlocks){this._accuracyMatrix=xa.test(s,xa.FLAG1);this._accuracyGeo=xa.test(s,xa.FLAG2);this._accuracyProps=xa.test(s,xa.FLAG3)}var l=this._body.position+i;if(i>this._body.getBytesAvailable()){this._pDieWithError("AWD2 block length is bigger than the bytes that are available!");this._body.position+=this._body.getBytesAvailable();return}if(n){this._pDieWithError("Compressed AWD formats not yet supported");this._newBlockBytes=new b;this._body.readBytes(this._newBlockBytes,0,i);this._newBlockBytes.position=0}else{this._newBlockBytes=this._body}e=new Ua(this._cur_block_id,r);e.len=i;var d=this._newBlockBytes.position+i;if(n){this._pDieWithError("Compressed AWD formats not yet supported")}if(this._debug)console.log("AWDBlock:  ID = "+this._cur_block_id+" | TypeID = "+r+" | Compression = "+n+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps);this._blocks[this._cur_block_id]=e;if(this._version[0]==3&&this._version[1]==0){var h=new Pa(this._view);switch(r){case 24:this.parseMeshLibraryBlock(this._cur_block_id);a=true;break;case 25:this.parseBillBoardLibraryBlock(this._cur_block_id);a=true;break;case 44:this.parseAudioBlock(this._cur_block_id,h);a=true;break;case 133:this.parseTimeLine(this._cur_block_id,h);a=true;break;case 134:this.paresTextField(this._cur_block_id,h);a=true;break;case 135:this.parseTesselatedFont(this._cur_block_id);a=true;break;case 136:this.parseTextFormat(this._cur_block_id);a=true;break}}if(this._version[0]>2||this._version[0]>=2&&this._version[1]>=1){switch(r){case 11:this.parsePrimitves(this._cur_block_id);a=true;break;case 31:this.parseSkyboxInstance(this._cur_block_id);a=true;break;case 41:this.parseLight(this._cur_block_id);a=true;break;case 42:this.parseCamera(this._cur_block_id);a=true;break;case 51:this.parseLightPicker(this._cur_block_id);a=true;break;case 81:this.parseMaterial_v1(this._cur_block_id);a=true;break;case 83:this.parseCubeTexture(this._cur_block_id);a=true;break;case 91:this.parseSharedMethodBlock(this._cur_block_id);a=true;break;case 92:this.parseShadowMethodBlock(this._cur_block_id);a=true;break;case 111:this.parseMeshPoseAnimation(this._cur_block_id,true);a=true;break;case 112:this.parseMeshPoseAnimation(this._cur_block_id);a=true;break;case 113:this.parseVertexAnimationSet(this._cur_block_id);a=true;break;case 122:this.parseAnimatorSet(this._cur_block_id);a=true;break;case 253:this.parseCommand(this._cur_block_id);a=true;break}}if(a==false){switch(r){case 1:this.parseGeometry(this._cur_block_id);break;case 22:this.parseContainer(this._cur_block_id);break;case 23:this.parseMeshInstance(this._cur_block_id);break;case 81:this.parseMaterial(this._cur_block_id);break;case 82:this.parseTexture(this._cur_block_id);break;case 101:this.parseSkeleton(this._cur_block_id);break;case 102:this.parseSkeletonPose(this._cur_block_id);break;case 103:this.parseSkeletonAnimation(this._cur_block_id);break;case 121:case 254:this.parseNameSpace(this._cur_block_id);break;case 255:this.parseMetaData(this._cur_block_id);break;default:if(this._debug)console.log("AWDBlock:   Unknown BlockType  (BlockID = "+this._cur_block_id+") - Skip "+i+" bytes");this._newBlockBytes.position+=i;break}}if(this._debug){if(this._newBlockBytes.position!=d)console.log("  (!)(!)(!) Error while reading AWDBlock ID "+this._cur_block_id+" = skip to next block");if(e.errorMessages){var i=e.errorMessages.length;for(var c=0;c<i;c++)console.log("        (!) Error: "+e.errorMessages[c]+" (!)")}console.log("\n")}if(this._debugTimers&&!this.parsingPaused)this.updateTimers(r);this._body.position=l;this._newBlockBytes=null};a.prototype.updateTimers=function(e){var a=performance.now();var t=a-this.start_timeing;this._time_all+=t;if(e==1){this._time_geom+=t;this._num_geom++}else if(e==133){this._time_timeline+=t;this._num_timeline++}else if(e==135){this._time_fonts+=t;this._num_fonts++}else if(e==134){this._time_textfields+=t;this._num_textfields++}else if(e==44){this._time_sounds+=t;this._num_sounds++}else if(e==82){this._time_textures+=t;this._num_textures++}else if(e==81){this._time_materials+=t;this._num_materials++}else if(e==24){this._time_meshes+=t;this._num_meshes++}};a.prototype.parseTesselatedFont=function(e){var a=this.parseVarStr();this._blocks[e].name=a;var t=this._newBlockBytes.readUnsignedInt();var r;var i;var n;var o=new Ma;var l;var d;var h;var c,_,p,u;for(var f=0;f<t;++f){i=this.parseVarStr();n=o.get_font_table(i);n.set_font_em_size(this._newBlockBytes.readUnsignedInt());n.set_whitespace_width(this._newBlockBytes.readUnsignedInt());r=this._newBlockBytes.readUnsignedInt();for(var y=0;y<r;++y){l=this._newBlockBytes.readUnsignedInt();d=this._newBlockBytes.readUnsignedInt();h=this._newBlockBytes.position+d;while(this._newBlockBytes.position<h){_=this._newBlockBytes.readUnsignedByte();c=this._newBlockBytes.readUnsignedByte();p=this._newBlockBytes.readUnsignedInt();u=this._newBlockBytes.position+p;if(_==2){var w=new Array;for(var m=0;this._newBlockBytes.position<u;m++)w[m]=this._newBlockBytes.readUnsignedShort()}else if(_==10){var v=new b(p);this._newBlockBytes.readBytes(v,0,p)}else{this._newBlockBytes.position=u}}if(v){var B=new s(20,p/20);B.bufferView=new Uint8Array(v.arraybytes);var k=new g(B);k.autoDeriveUVs=false;n.set_subgeo_for_char(l.toString(),k)}}}this.parseProperties(null);this.parseUserAttributes();this._pFinalizeAsset(o,a);this._blocks[e].data=o;if(this._debug)console.log("Parsed a font: Name = '"+a)};a.prototype.parseTextFormat=function(e){var t=this.parseVarStr();this._blocks[e].name=t;var r=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var s=this.parseVarStr();var i=new Na;i.font_name=r.name;var n=r.get_font_table(s);if(n!=null){i.font_style=s;i.font_table=n}var o=this._blocks[this._newBlockBytes.readUnsignedInt()].data;o.bothSides=true;var l=this._newBlockBytes.readUnsignedByte();var d=[];for(var h=0;h<l;h++)d[h]=this._newBlockBytes.readFloat();i.uv_values=d;var c=this.parseProperties(a.textFormatProperties);i.size=c.get(1,12);i.letterSpacing=c.get(2,0);i.kerning=c.get(4,true);var _=c.get(6,0);if(_==1){i.align="right"}else if(_==2){i.align="center"}i.indent=c.get(7,0);i.leftMargin=c.get(8,0);i.rightMargin=c.get(9,0);i.material=o;this.parseUserAttributes();this._pFinalizeAsset(i,t);this._blocks[e].data=i;if(this._debug)console.log("Parsed a TextFormat: Name = '"+t+" font: "+r.name)};a.prototype.paresTextField=function(e,t){var r=this.parseVarStr();this._blocks[e].name=r;var s=t.createTextField();var i=this._newBlockBytes.readUnsignedByte();s.type=a.textFieldTypes[i];if(i==3)s.displayAsPassword=true;s.textWidth=Math.abs(this._newBlockBytes.readFloat());s.textHeight=Math.abs(this._newBlockBytes.readFloat());var n=this._newBlockBytes.readUnsignedInt();var o="";for(var l=0;l<n;l++){var d=this._newBlockBytes.readUnsignedInt();for(var h=0;h<d;h++){var c=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var _=this._newBlockBytes.readUnsignedInt();if(_>0){var p=this._newBlockBytes.readUTFBytes(_);o+=p}}}s.textFormat=c;s.text=o;var u=this.parseProperties(a.textFieldProperties);s.selectable=u.get(1,false);s.border=u.get(3,false);s.extra=this.parseUserAttributes();this._pFinalizeAsset(s,r);this._blocks[e].data=s;if(this._debug)console.log("Parsed a TextField: Name = '"+r+"| text  = "+o)};a.prototype.parseBillBoardLibraryBlock=function(e){var a=this.parseVarStr();var t=this._blocks[this._newBlockBytes.readUnsignedInt()].data;t.bothSides=true;var r=new j(t);this.parseProperties(null);r.extra=this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug)console.log("Parsed a Library-Billboard: Name = '"+a+"| Material-Name = "+t.name)};a.prototype.parseMeshLibraryBlock=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedInt();var r=this._blocks[t].data;this._blocks[e].geoID=t;var s=this._newBlockBytes.readUnsignedShort();var i=new Array;var n=new Array;var o;for(var l=0;l<s;l++){o=this._blocks[this._newBlockBytes.readUnsignedInt()].data||N.getDefaultMaterial();o.alphaBlending=true;o.useColorTransform=true;i[l]=o;n[l]=o.name}var d=performance.now();var h=new P(r,null);var c=performance.now();var _=c-d;this._time_geom_bytes+=_;if(i.length>=1&&h.subMeshes.length==1){h.material=i[0]}else if(i.length>1){for(var p=0;p<h.subMeshes.length;p++)h.subMeshes[p].material=i[Math.min(i.length-1,p)]}this.parseProperties(null);h.extra=this.parseUserAttributes();this._pFinalizeAsset(h,a);this._blocks[e].data=h;if(this._debug)console.log("Parsed a Library-Mesh: Name = '"+a+"| Geometry-Name = "+r.name+" | SubMeshes = "+h.subMeshes.length+" | Mat-Names = "+n)};a.prototype.parseAudioBlock=function(e,a){this._blocks[e].name=this.parseVarStr();var t=this._newBlockBytes.readUnsignedByte();var r;if(t==0){r=this._newBlockBytes.readUnsignedInt();var s;s=this._newBlockBytes.readUTFBytes(r);this._pAddDependency(this._cur_block_id.toString(),new _(s),false,null,true)}else{r=this._newBlockBytes.readUnsignedInt();var i=new b(r);this._newBlockBytes.readBytes(i,0,r);this._pAddDependency(this._cur_block_id.toString(),null,false,i,true)}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();if(this._debug)console.log("Start parsing a "+["external","embed"][t]+" Audio file")};a.prototype.parseTimeLine=function(e,a){var t;var r;var s;var i=new ja;var n=a.createMovieClip(i);var o=this.parseVarStr();var l=!!this._newBlockBytes.readUnsignedByte();var d=this._newBlockBytes.readUnsignedByte();var h=this._newBlockBytes.readFloat();var c=this._newBlockBytes.readUnsignedShort();for(t=0;t<c;t++){s=this._blocks[this._newBlockBytes.readUnsignedInt()].data;if(s!=null){i.registerPotentialChild(s)}else{console.log("ERROR when collecting objects for timeline")}}var _=c;var p=this._newBlockBytes.readUnsignedShort();for(t=0;t<p;t++){s=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var u=this._newBlockBytes.readUnsignedShort();_+=u;if(s!=null){for(r=0;r<u;r++)i.registerPotentialChild(s)}else{for(r=0;r<u;r++){console.log("ERROR when collecting objects for timeline")}}}if(this._debug)console.log("Parsed "+(c+p)+" potential childs. They will be used by "+_+" instances.");var f=this._newBlockBytes.readUnsignedShort();var y=this._newBlockBytes.readUnsignedByte();var w=0;var m=0;var v=0;var g=0;for(t=0;t<y;t++){if(g<6)v=g;else v=this._newBlockBytes.readUnsignedByte();m=this._newBlockBytes.readUnsignedByte();w=this._newBlockBytes.readUnsignedInt();if(w>0){var B=new b(w);this._newBlockBytes.readBytes(B,0,w);var k;switch(m){case 1:k=new Uint8Array(B.arraybytes);break;case 2:k=new Uint16Array(B.arraybytes);break;case 4:k=new Uint32Array(B.arraybytes);break}switch(v){case 0:i.keyframe_durations=k;i.numKeyFrames=w/m;break;case 1:i.frame_command_indices=k;break;case 2:i.frame_recipe=k;break;case 3:i.command_length_stream=k;break;case 4:i.command_index_stream=k;break;case 5:i.add_child_stream=k;break;case 6:i.remove_child_stream=k;break;case 7:i.update_child_stream=k;break;case 8:i.update_child_props_indices_stream=k;break;case 9:i.update_child_props_length_stream=k;break;case 10:i.property_type_stream=k;break;case 11:i.property_index_stream=k;break;case 12:i.properties_stream_int=k;break}}g++}var D=0;var A;y=this._newBlockBytes.readUnsignedByte();for(t=0;t<y;t++){v=this._newBlockBytes.readUnsignedByte();switch(v){case 0:w=this._newBlockBytes.readUnsignedInt();A=new b(w);this._newBlockBytes.readBytes(A,0,w);i.properties_stream_f32_mtx_scale_rot=new Float32Array(A.arraybytes);break;case 1:w=this._newBlockBytes.readUnsignedInt();A=new b(w);this._newBlockBytes.readBytes(A,0,w);i.properties_stream_f32_mtx_pos=new Float32Array(A.arraybytes);break;case 2:w=this._newBlockBytes.readUnsignedInt();A=new b(w);this._newBlockBytes.readBytes(A,0,w);i.properties_stream_f32_mtx_all=new Float32Array(A.arraybytes);break;case 3:w=this._newBlockBytes.readUnsignedInt();A=new b(w);this._newBlockBytes.readBytes(A,0,w);i.properties_stream_f32_ct=new Float32Array(A.arraybytes);break;case 4:w=this._newBlockBytes.readUnsignedShort();for(D=0;D<w;D++){i._labels[this.parseVarStr()]=this._newBlockBytes.readUnsignedShort()}break;case 5:w=this._newBlockBytes.readUnsignedShort();var P=[];for(D=0;D<w;D++){P.push(this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedShort()))}i.properties_stream_strings=P;break;case 6:w=this._newBlockBytes.readUnsignedShort();for(D=0;D<w;D++){var j=this._newBlockBytes.readUnsignedShort();var M=this._newBlockBytes.readUnsignedInt();i.add_framescript(this._newBlockBytes.readUTFBytes(M),j)}break}}i.init();this.parseProperties(null);this.parseUserAttributes();this._pFinalizeAsset(n,o);this._blocks[e].data=n;if(this._debug)console.log("Parsed a TIMELINE: Name = "+o+"| isScene = "+l+"| sceneID = "+d+"| numFrames = ")};a.prototype.parseGeometry=function(e){var t=new v;var r=this.parseVarStr();var n=this._newBlockBytes.readUnsignedShort();var o=this.parseProperties(a.geometryProperties);var l=o.get(1,1);var d=o.get(2,1);for(var h=0;h<n;h++){var c=false;var _,p;var u;var f;_=this._newBlockBytes.readUnsignedInt();p=this._newBlockBytes.position+_;var y=this.parseProperties(a.subGeometryProperties);while(this._newBlockBytes.position<p){var w=0;var m,k,D,A;k=this._newBlockBytes.readUnsignedByte();m=this._newBlockBytes.readUnsignedByte();D=this._newBlockBytes.readUnsignedInt();A=this._newBlockBytes.position+D;var P,j,M;if(k==1){var N=new Array;while(this._newBlockBytes.position<A){P=this.readNumber(this._accuracyGeo);j=this.readNumber(this._accuracyGeo);M=this.readNumber(this._accuracyGeo);N[w++]=P;N[w++]=j;N[w++]=M}}else if(k==2){var U=new Array;while(this._newBlockBytes.position<A)U[w++]=this._newBlockBytes.readUnsignedShort()}else if(k==3){var T=new Array;while(this._newBlockBytes.position<A)T[w++]=this.readNumber(this._accuracyGeo)}else if(k==4){var S=new Array;while(this._newBlockBytes.position<A)S[w++]=this.readNumber(this._accuracyGeo)}else if(k==6){u=Array();while(this._newBlockBytes.position<A)u[w++]=this._newBlockBytes.readUnsignedShort()*3}else if(k==7){f=new Array;while(this._newBlockBytes.position<A)f[w++]=this.readNumber(this._accuracyGeo)}else if(k==8){this._newBlockBytes.position=A}else if(k==9){this._newBlockBytes.position=A}else if(k==10){c=true;var x=new b(D);this._newBlockBytes.readBytes(x,0,D)}else{this._newBlockBytes.position=A}}this.parseUserAttributes();if(c){var W=new s(28,D/28);W.bufferView=new Uint8Array(x.arraybytes);var I=new g(W);I.setUVs(new i(W));t.addSubGeometry(I);if(this._debug)console.log("Parsed a CurveSubGeometry")}else{var O=new B(new s);if(f)O.jointsPerVertex=f.length/(N.length/3);if(S)O.autoDeriveNormals=false;if(T)O.autoDeriveUVs=false;O.autoDeriveTangents=true;O.setIndices(U);O.setPositions(N);O.setNormals(S);O.setUVs(T);O.setTangents(null);O.setJointWeights(f);O.setJointIndices(u);var E=y.get(1,1);var F=y.get(2,1);var L=false;if(l!=E||d!=F){L=true;E=l/E;F=d/F}if(L)O.scaleUV(E,F);t.addSubGeometry(O);if(this._debug)console.log("Parsed a TriangleSubGeometry")}}if(l!=1||d!=1)t.scaleUV(l,d);this.parseUserAttributes();this._pFinalizeAsset(t,r);this._blocks[e].data=t;if(this._debug)console.log("Parsed a TriangleGeometry: Name = "+r)};a.prototype.parsePrimitves=function(e){var t;var r;var s;var i;var n;var o;t=this.parseVarStr();s=this._newBlockBytes.readUnsignedByte();n=this.parseProperties(a.primitiveProperties);switch(s){case 1:r=new F(n.get(101,100),n.get(102,100),n.get(301,1),n.get(302,1),n.get(701,true),n.get(702,false));break;case 2:r=new O(n.get(101,100),n.get(102,100),n.get(103,100),n.get(301,1),n.get(302,1),n.get(303,1),n.get(701,true));break;case 3:r=new L(n.get(101,50),n.get(301,16),n.get(302,12),n.get(701,true));break;case 4:r=new E(n.get(101,50),n.get(102,50),n.get(103,100),n.get(301,16),n.get(302,1),true,true,true);if(!n.get(701,true))r.topClosed=false;if(!n.get(702,true))r.bottomClosed=false;if(!n.get(703,true))r.yUp=false;break;case 5:r=new I(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,1),n.get(701,true),n.get(702,true));break;case 6:r=new W(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,15),n.get(701,true));break;case 7:r=new R(n.get(101,50),n.get(102,50),n.get(301,16),n.get(302,8),n.get(701,true));break;default:r=new x;console.log("ERROR: UNSUPPORTED PREFAB_TYPE");break}if(n.get(110,1)!=1||n.get(111,1)!=1){}this.parseUserAttributes();r.name=t;this._pFinalizeAsset(r,t);this._blocks[e].data=r;if(this._debug){if(s<0||s>7)s=0;console.log("Parsed a Primivite: Name = "+t+"| type = "+a.primitiveTypes[s])}};a.prototype.parseContainer=function(e){var t;var r;var s;var i=this._blocks[this._newBlockBytes.readUnsignedInt()].data;r=this.parseMatrix3D();t=this.parseVarStr();var n="Root (TopLevel)";s=new m;s.transform.matrix3D=r;if(i){i.addChild(s);n=i.name}else{this._pContent.addChild(s)}if(this._version[0]==2&&this._version[1]==1){var o=this.parseProperties(a.containerProperties);s.pivot=new h(o.get(1,0),o.get(2,0),o.get(3,0))}else{this.parseProperties(null)}s.extra=this.parseUserAttributes();this._pFinalizeAsset(s,t);this._blocks[e].data=s;if(this._debug)console.log("Parsed a Container: Name = '"+t+"' | Parent-Name = "+n)};a.prototype.parseMeshInstance=function(e){var t=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var r=this.parseMatrix3D();var s=this.parseVarStr();var i=this._newBlockBytes.readUnsignedInt();var n=this._blocks[i].data;var o;var l;var d=false;if(n.isAsset(v)){o=n}else{d=true;l=n}this._blocks[e].geoID=i;var c=this._newBlockBytes.readUnsignedShort();var _=new Array;var p=new Array;var u;for(var f=0;f<c;f++){u=this._blocks[this._newBlockBytes.readUnsignedInt()].data||N.getDefaultMaterial();_[f]=u;p[f]=u.name}var y=d?l.getNewObject():new P(o,null);y.transform.matrix3D=r;var w="Root (TopLevel)";if(t){t.addChild(y);w=t.name}else{this._pContent.addChild(y)}if(_.length>=1&&y.subMeshes.length==1){y.material=_[0]}else if(_.length>1){for(var b=0;b<y.subMeshes.length;b++)y.subMeshes[b].material=_[Math.min(_.length-1,b)]}if(this._version[0]==2&&this._version[1]==1){var m=this.parseProperties(a.meshInstanceProperties);y.pivot=new h(m.get(1,0),m.get(2,0),m.get(3,0));y.castsShadows=m.get(5,true)}else{this.parseProperties(null)}y.extra=this.parseUserAttributes();this._pFinalizeAsset(y,s);this._blocks[e].data=y;if(this._debug){if(d)console.log("Parsed a Mesh for Prefab: Name = '"+s+"' | Parent-Name = "+w+"| Prefab-Name = "+l.name+" | SubMeshes = "+y.subMeshes.length+" | Mat-Names = "+p);else console.log("Parsed a Mesh for Geometry: Name = '"+s+"' | Parent-Name = "+w+"| Geometry-Name = "+o.name+" | SubMeshes = "+y.subMeshes.length+" | Mat-Names = "+p)}};a.prototype.parseSkyboxInstance=function(e){var a=this.parseVarStr();var t=new M;var r=this._blocks[this._newBlockBytes.readUnsignedInt()].data||N.getDefaultTexture(t);t.cubeMap=r;this.parseProperties(null);t.extra=this.parseUserAttributes();this._pFinalizeAsset(t,a);this._blocks[e].data=t;if(this._debug)console.log("Parsed a Skybox: Name = '"+a+"' | CubeTexture-Name = "+r.name)};a.prototype.parseLight=function(e){var t;var r;var s=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var i=this.parseMatrix3D();var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var l=this.parseProperties(a.lightProperties);var d=l.get(9,0);var h=["Unsupported LightType","PointLight","DirectionalLight"];var c=["No ShadowMapper","DirectionalShadowMapper","NearDirectionalShadowMapper","CascadeShadowMapper","CubeMapShadowMapper"];if(o==1){t=new D;t.radius=l.get(1,9e4);t.fallOff=l.get(2,1e5);if(d>0){if(d==4){r=new T}}t.transform.matrix3D=i}if(o==2){t=new k(l.get(21,0),l.get(22,-1),l.get(23,1));if(d>0){if(d==1){r=new S}}}t.color=l.get(3,16777215);t.specular=l.get(4,1);t.diffuse=l.get(5,1);t.ambientColor=l.get(7,16777215);t.ambient=l.get(8,0);if(r){if(r instanceof T){if(l.get(10,1)!=1)r.depthMapSize=this._depthSizeDic[l.get(10,1)]}else{if(l.get(10,2)!=2)r.depthMapSize=this._depthSizeDic[l.get(10,2)]}t.shadowMapper=r;t.castsShadows=true}var _="Root (TopLevel)";if(s){s.addChild(t);_=s.name}else{this._pContent.addChild(t)}this.parseUserAttributes();this._pFinalizeAsset(t,n);this._blocks[e].data=t;if(this._debug)console.log("Parsed a Light: Name = '"+n+"' | Type = "+h[o]+" | Parent-Name = "+_+" | ShadowMapper-Type = "+c[d])};a.prototype.parseCamera=function(e){var t=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var r=this.parseMatrix3D();var s=this.parseVarStr();var i;this._newBlockBytes.readUnsignedByte();this._newBlockBytes.readShort();var n=this._newBlockBytes.readShort();var o=this.parseProperties(a.cameraProperties);switch(n){case 5001:i=new f(o.get(101,60));break;case 5002:i=new y(o.get(101,500));break;case 5003:i=new w(o.get(101,-400),o.get(102,400),o.get(103,-300),o.get(104,300));break;default:console.log("unsupportedLenstype");return}var l=new A(i);l.transform.matrix3D=r;var d="Root (TopLevel)";if(t){t.addChild(l);d=t.name}else{this._pContent.addChild(l)}l.name=s;o=this.parseProperties(a.cameraPivotProperties);l.pivot=new h(o.get(1,0),o.get(2,0),o.get(3,0));l.extra=this.parseUserAttributes();this._pFinalizeAsset(l,s);this._blocks[e].data=l;if(this._debug)console.log("Parsed a Camera: Name = '"+s+"' | Projectiontype = "+i+" | Parent-Name = "+d)};a.prototype.parseLightPicker=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();var r=new Array;var s=new Array;for(var i=0;i<t;i++){var n=this._blocks[this._newBlockBytes.readUnsignedInt()].data;r.push(n);s.push(n.name)}if(r.length==0){this._blocks[e].addError("Could not create this LightPicker, cause no Light was found.");this.parseUserAttributes();return}var o=new U(r);o.name=a;this.parseUserAttributes();this._pFinalizeAsset(o,a);this._blocks[e].data=o;if(this._debug)console.log("Parsed a StaticLightPicker: Name = '"+a+"' | Texture-Name = "+s)};a.prototype.parseMaterial=function(e){var t;var r;var s;var i;var n;var o;var l;var d;t=this.parseVarStr();r=this._newBlockBytes.readUnsignedByte();o=this._newBlockBytes.readUnsignedByte();s=this.parseProperties(a.materialProperties);l=0;while(l<o){var h;h=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);this.parseUserAttributes();l+=1
}var c="";if(r===1){c+="Parsed a ColorMaterial(SinglePass): Name = '"+t+"' | ";var _=s.get(1,16777215);if(this.materialMode<2){i=new ea(_,s.get(10,1))}else{i=new ea(_);i.mode=$.MULTI_PASS}}else if(r===2){var p=this._blocks[s.get(2,0)].data;i=new ea(p);if(this.materialMode<2){i.alphaBlending=s.get(11,false);i.alpha=s.get(10,1);c+="Parsed a MethodMaterial(SinglePass): Name = '"+t+"'"+(p?" | Texture-Name = "+p.name:"")}else{i.mode=$.MULTI_PASS;c+="Parsed a MethodMaterial(MultiPass): Name = '"+t+"'"+(p?" | Texture-Name = "+p.name:"")}}i.extra=this.parseUserAttributes();i.alphaThreshold=s.get(12,0);i.repeat=s.get(13,false);this._pFinalizeAsset(i,t);this._blocks[e].data=i;if(this._debug)console.log(c)};a.prototype.parseMaterial_v1=function(e){var t;var r;var s;var i;var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var l=this._newBlockBytes.readUnsignedByte();var d=this.parseProperties(a.material_v1Properties);var h=d.get(4,0);var c="Parsed Material ";if(h>=2){this._blocks[e].addError("Material-spezialType '"+h+"' is not supported, can only be 0:singlePass, 1:MultiPass !");return}if(o<=2){if(this.materialMode==1)h=0;else if(this.materialMode==2)h=1;if(h<2){if(o==1){var _=d.get(1,13421772);if(h==1){t=new ea(_);t.mode=$.MULTI_PASS;c+="Parsed a ColorMaterial(MultiPass): Name = '"+n+"' | "}else{t=new ea(_,d.get(10,1));t.alphaBlending=d.get(11,false);c+="Parsed a ColorMaterial(SinglePass): Name = '"+n+"' | "}}else if(o==2){var p=this._blocks[d.get(2,0)].data;t=new ea(p);if(h==1){t.mode=$.MULTI_PASS;c+="Parsed a MethodMaterial(MultiPass): Name = '"+n+"'"+(p?" | Texture-Name = "+p.name:"")}else{t.alpha=d.get(10,1);t.alphaBlending=d.get(11,false);c+="Parsed a MethodMaterial(SinglePass): Name = '"+n+"'"+(p?" | Texture-Name = "+p.name:"")}}r=this._blocks[d.get(17,0)].data;s=this._blocks[d.get(3,0)].data;i=this._blocks[d.get(21,0)].data;t.lightPicker=this._blocks[d.get(22,0)].data;t.smooth=d.get(5,true);t.mipmap=d.get(6,true);t.bothSides=d.get(7,false);t.alphaPremultiplied=d.get(8,false);t.blendMode=this.blendModeDic[d.get(9,0)];t.repeat=d.get(13,false);if(r){t.diffuseTexture=r;c+=" | DiffuseTexture-Name = "+r.name}if(s){t.normalMap=s;c+=" | NormalTexture-Name = "+s.name}if(i){t.specularMap=i;c+=" | SpecularTexture-Name = "+i.name}t.alphaThreshold=d.get(12,0);t.ambient=d.get(15,1);t.diffuseColor=d.get(16,16777215);t.specular=d.get(18,1);t.gloss=d.get(19,50);t.specularColor=d.get(20,16777215);for(var u=0;u<l;u++){var f;f=this._newBlockBytes.readUnsignedShort();d=this.parseProperties(a.method_v1Properties);switch(f){case 999:var y=this._blocks[d.get(1,0)].data;t.addEffectMethod(y);c+=" | EffectMethod-Name = "+y.name;break;case 998:var w=this._blocks[d.get(1,0)].data;t.shadowMethod=w;c+=" | ShadowMethod-Name = "+w.name;break;case 1:var b=this._blocks[d.get(1,0)].data;t.ambientMethod=new aa;t.texture=b;c+=" | AmbientEnvMapMethod | EnvMap-Name ="+b.name;break;case 51:t.diffuseMethod=new ta;c+=" | DiffuseDepthMethod";break;case 52:var p=this._blocks[d.get(1,0)].data;t.diffuseMethod=new sa(p);c+=" | DiffuseGradientMethod | GradientDiffuseTexture-Name ="+p.name;break;case 53:t.diffuseMethod=new na(d.get(101,5));c+=" | DiffuseWrapMethod";break;case 54:var p=this._blocks[d.get(1,0)].data;t.diffuseMethod=new ia(p,this.blendModeDic[d.get(401,10)],false,t.diffuseMethod);c+=" | DiffuseLightMapMethod | LightMapTexture-Name ="+p.name;break;case 55:t.diffuseMethod=new ra(d.get(401,3),t.diffuseMethod);t.diffuseMethod.smoothness=d.get(101,.1);c+=" | DiffuseCelMethod";break;case 56:break;case 101:t.specularMethod=new va;c+=" | SpecularAnisotropicMethod";break;case 102:t.specularMethod=new Ba;c+=" | SpecularPhongMethod";break;case 103:t.specularMethod=new ga(d.get(101,.5),t.specularMethod);t.specularMethod.smoothness=d.get(102,.1);c+=" | SpecularCelMethod";break;case 104:t.specularMethod=new ba(d.get(701,true),t.specularMethod);t.specularMethod.fresnelPower=d.get(101,5);t.specularMethod.normalReflectance=d.get(102,.1);c+=" | SpecularFresnelMethod";break;case 151:break;case 152:var p=this._blocks[d.get(1,0)].data;t.normalMap=p;t.normalMethod=new fa(t.normalMap,p);c+=" | NormalSimpleWaterMethod | Second-NormalTexture-Name = "+p.name;break}this.parseUserAttributes()}}}else if(o>=3&&o<=7){var _=d.get(1,13421772);c+=_;var r=this._blocks[d.get(2,0)].data;var m=new Aa(r);m.bothSides=true;m.preserveAlpha=true;m.alphaBlending=true;m.extra=this.parseUserAttributes();this._pFinalizeAsset(m,n);this._blocks[e].data=m;if(this._debug)console.log(c);return}t.extra=this.parseUserAttributes();this._pFinalizeAsset(t,n);this._blocks[e].data=t;if(this._debug)console.log(c)};a.prototype.parseTexture=function(e){var a;this._blocks[e].name=this.parseVarStr();var t=this._newBlockBytes.readUnsignedByte();this._texture_users[this._cur_block_id]=[];if(t==0){var r=this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedInt());this._pAddDependency(this._cur_block_id.toString(),new _(r),false,null,true)}else{var s=this._newBlockBytes.readUnsignedInt();var i=new b(s);this._newBlockBytes.readBytes(i,0,s);this._pAddDependency(this._cur_block_id.toString(),null,false,u.byteArrayToImage(i),true)}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._blocks[e].data=a;this._pPauseAndRetrieveDependencies();if(this._debug)console.log("Start parsing a "+["external","embed"][t]+" Bitmap for Texture")};a.prototype.parseCubeTexture=function(e){var a;var t;var r;this._texture_users[this._cur_block_id]=[];var s=this._newBlockBytes.readUnsignedByte();this._blocks[e].name=this.parseVarStr();for(r=0;r<6;r++){this._texture_users[this._cur_block_id]=[];if(s==0){a=this._newBlockBytes.readUnsignedInt();var i;i=this._newBlockBytes.readUTFBytes(a);this._pAddDependency(this._cur_block_id.toString(),new _(i),false,null,true,r)}else{a=this._newBlockBytes.readUnsignedInt();var n=new b(a);this._newBlockBytes.readBytes(n,0,a);this._pAddDependency(this._cur_block_id.toString(),null,false,u.byteArrayToImage(n),true,r)}}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();this._blocks[e].data=t;if(this._debug)console.log("Start parsing 6 "+["external","embed"][s]+" Bitmaps for CubeTexture")};a.prototype.parseSharedMethodBlock=function(e){var a;this._blocks[e].name=this.parseVarStr();a=this.parseSharedMethodList(e);this.parseUserAttributes();this._blocks[e].data=a;this._pFinalizeAsset(a,this._blocks[e].name);this._blocks[e].data=a;if(this._debug)console.log("Parsed a EffectMethod: Name = "+a.name+" Type = "+a)};a.prototype.parseShadowMethodBlock=function(e){this._blocks[e].name=this.parseVarStr();var a=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var t=this.parseShadowMethodList(a,e);if(!t)return;this.parseUserAttributes();this._pFinalizeAsset(t,this._blocks[e].name);this._blocks[e].data=t;if(this._debug)console.log("Parsed a ShadowMapMethodMethod: Name = "+t.name+" | Type = "+t+" | Light-Name = ",a.name)};a.prototype.parseCommand=function(e){var t=this._newBlockBytes.readUnsignedByte()==1;var r=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var s;var i=this.parseMatrix3D();var n=this.parseVarStr();var o=this._newBlockBytes.readShort();var l=this._newBlockBytes.readShort();var d=this.parseProperties(a.commandProperties);switch(l){case 1:s=this._blocks[d.get(1,0)].data;s.transform.matrix3D=i;if(r)r.addChild(s);break}if(s){d=this.parseProperties(a.targetProperties);s.pivot=new h(d.get(1,0),d.get(2,0),d.get(3,0));s.extra=this.parseUserAttributes()}this._blocks[e].data=s;if(this._debug)console.log("Parsed a CommandBlock: Name = '"+n)};a.prototype.parseMetaData=function(e){var t=this.parseProperties(a.metaDataProperties);if(this._debug){console.log("Parsed a MetaDataBlock: TimeStamp         = "+t.get(1,0));console.log("                        EncoderName       = "+t.get(2,"unknown"));console.log("                        EncoderVersion    = "+t.get(3,"unknown"));console.log("                        GeneratorName     = "+t.get(4,"unknown"));console.log("                        GeneratorVersion  = "+t.get(5,"unknown"))}};a.prototype.parseNameSpace=function(e){var a=this._newBlockBytes.readUnsignedByte();var t=this.parseVarStr();if(this._debug)console.log("Parsed a NameSpaceBlock: ID = "+a+" | String = "+t)};a.prototype.parseShadowMethodList=function(e,a){var t=this._newBlockBytes.readUnsignedShort();var r;var s=this.parseProperties(this.shadowMethodListProperties);var i;var n;switch(t){case 1002:r=new ka(this._blocks[s.get(1,0)].data);break;case 1101:r=new wa(e);r.alpha=s.get(101,1);r.epsilon=s.get(102,.002);break;case 1102:r=new ya(e,s.get(201,5));r.alpha=s.get(101,1);r.epsilon=s.get(102,.002);r.range=s.get(103,1);break;case 1103:r=new Da(e,s.get(201,5));r.alpha=s.get(101,1);r.epsilon=s.get(102,.002);r.range=s.get(103,1);break;case 1104:r=new ma(e);r.alpha=s.get(101,1);r.epsilon=s.get(102,.002);break}this.parseUserAttributes();return r};a.prototype.parseSkeleton=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();var r=new Y;this.parseProperties(null);for(var s=0;s<t;s++){var i;var n;this._newBlockBytes.readUnsignedShort();i=new Q;i.parentIndex=this._newBlockBytes.readUnsignedShort()-1;i.name=this.parseVarStr();n=this.parseMatrix3D();i.inverseBindPose=n.rawData;this.parseProperties(null);this.parseUserAttributes();r.joints.push(i)}this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug)console.log("Parsed a Skeleton: Name = "+r.name+" | Number of Joints = "+s)};a.prototype.parseSkeletonPose=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);var r=new X;for(var s=0;s<t;s++){var i;var n;i=new J;n=this._newBlockBytes.readUnsignedByte();if(n==1){var o=this.parseMatrix43RawData();var l=new d(o);i.orientation.fromMatrix(l);i.translation.copyFrom(l.position);r.jointPoses[s]=i}}this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug)console.log("Parsed a SkeletonPose: Name = "+r.name+" | Number of Joints = "+s)};a.prototype.parseSkeletonAnimation=function(e){var a;var t;var r=this.parseVarStr();var s=new q;var i=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);for(var n=0;n<i;n++){t=this._newBlockBytes.readUnsignedInt();a=this._newBlockBytes.readUnsignedShort();s.addFrame(this._blocks[t].data,a)}if(s.frames.length==0){this._blocks[e].addError("Could not this SkeletonClipNode, because no Frames where set.");return}this.parseUserAttributes();this._pFinalizeAsset(s,r);this._blocks[e].data=s;if(this._debug)console.log("Parsed a SkeletonClipNode: Name = "+s.name+" | Number of Frames = "+s.frames.length)};a.prototype.parseMeshPoseAnimation=function(e,a){if(a===void 0){a=false}var t;var r;var i;var n;var o;var l;var d;var h=0;var c=new Z;var _;var p;var u=new Array;var f;var y=this.parseVarStr();var w=this._newBlockBytes.readUnsignedInt();var b=this._blocks[w].data;var m=this.getUVForVertexAnimation(w);var g=!a?this._newBlockBytes.readUnsignedShort():1;var k=this._newBlockBytes.readUnsignedShort();var D=this._newBlockBytes.readUnsignedShort();for(var A=0;A<D;A++)u.push(this._newBlockBytes.readUnsignedShort());f=this.parseProperties(this.meshPoseAnimationProperties);c.looping=f.get(1,true);c.stitchFinalFrame=f.get(2,false);var P;for(var j=0;j<g;j++){P=this._newBlockBytes.readUnsignedShort();b=new v;t=0;while(t<k){A=0;o=this._newBlockBytes.readUnsignedInt();l=this._newBlockBytes.position+o;while(A<D){if(u[A]==1){_=b.subGeometries[t].indices;p=new Array;h=0;while(this._newBlockBytes.position<l){r=this.readNumber(this._accuracyGeo);i=this.readNumber(this._accuracyGeo);n=this.readNumber(this._accuracyGeo);p[h++]=r;p[h++]=i;p[h++]=n}d=new B(new s);d.setIndices(_);d.setPositions(p);d.setUVs(m[t]);d.setNormals(null);d.setTangents(null);d.autoDeriveNormals=false;d.autoDeriveTangents=false;t++;b.addSubGeometry(d)}else this._newBlockBytes.position=l;A++}}c.addFrame(b,P)}this.parseUserAttributes();this._pFinalizeAsset(c,y);this._blocks[e].data=c;if(this._debug)console.log("Parsed a VertexClipNode: Name = "+c.name+" | Target-Geometry-Name = "+b.name+" | Number of Frames = "+c.frames.length)};a.prototype.parseVertexAnimationSet=function(e){var t=this.parseVarStr();var r=this._newBlockBytes.readUnsignedShort();var s=this.parseProperties(a.vertexAnimationSetProperties);var i=new Array;var n=new Array;var o;for(var l=0;l<r;l++){o=this._blocks[this._newBlockBytes.readUnsignedInt()].data;if(o instanceof Z)n.push(o);else if(o instanceof q)i.push(o)}if(n.length==0&&i.length==0){this._blocks[e].addError("Could not create this AnimationSet, because it contains no animations");return}this.parseUserAttributes();if(n.length>0){var d=new V;for(var h=0;h<n.length;h++)d.addAnimation(n[h]);this._pFinalizeAsset(d,t);this._blocks[e].data=d;if(this._debug)console.log("Parsed a VertexAnimationSet: Name = "+t+" | Animations = "+d.animations.length+" | Animation-Names = "+d.animationNames)}else if(i.length>0){var c=new K(s.get(1,4));for(var h=0;h<i.length;h++)c.addAnimation(i[h]);this._pFinalizeAsset(c,t);this._blocks[e].data=c;if(this._debug)console.log("Parsed a SkeletonAnimationSet: Name = "+t+" | Animations = "+c.animations.length+" | Animation-Names = "+c.animationNames)}};a.prototype.parseAnimatorSet=function(e){var t=this.parseVarStr();var r=this._newBlockBytes.readUnsignedShort();var s=this.parseProperties(a.animatorSetProperties);var i=this._blocks[this._newBlockBytes.readUnsignedInt()].data;var n=new Array;var o=this._newBlockBytes.readUnsignedShort();for(var l=0;l<o;l++)n.push(this._blocks[this._newBlockBytes.readUnsignedInt()].data);var d=this._newBlockBytes.readUnsignedShort();var h=this._newBlockBytes.readUnsignedByte()==1;this.parseUserAttributes();this.parseUserAttributes();var c;if(r==1)c=new H(i,this._blocks[s.get(1,0)].data);else if(r==2)c=new z(i);this._pFinalizeAsset(c,t);this._blocks[e].data=c;for(l=0;l<n.length;l++){if(r==1)n[l].animator=c;else if(r==2)n[l].animator=c}if(this._debug)console.log("Parsed a Animator: Name = "+t)};a.prototype.parseSharedMethodList=function(e){var a=this._newBlockBytes.readUnsignedShort();var t;var r=this.parseProperties(this.sharedMethodListProperties);switch(a){case 401:t=new la(r.get(101,new Array(0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)));break;case 402:t=new da;var s=r.get(601,0);t.colorTransform=new l(r.get(102,1),r.get(103,1),r.get(104,1),r.get(101,1),s>>16&255,s>>8&255,s&255,s>>24&255);break;case 403:t=new ha(this._blocks[r.get(1,0)].data,r.get(101,1));var i=r.get(2,0);if(i>0){}break;case 404:t=new pa(this._blocks[r.get(1,0)].data,this.blendModeDic[r.get(401,10)]);break;case 406:t=new ua(r.get(601,16777215),r.get(101,.4),r.get(101,2));break;case 407:t=new oa(this._blocks[r.get(1,0)].data,r.get(701,false));break;case 410:t=new _a(this._blocks[r.get(1,0)].data,r.get(101,1));break;case 411:t=new ca(r.get(101,0),r.get(102,1e3),r.get(601,8421504));break}this.parseUserAttributes();return t};a.prototype.parseUserAttributes=function(){var e=this._newBlockBytes.readUnsignedInt();if(e>0){var t=this._newBlockBytes.position+e;var r={};for(var s=0;this._newBlockBytes.position<t;s++){var i;var n;var o;var l;var d;i=this._newBlockBytes.readUnsignedByte();n=this.parseVarStr();o=this._newBlockBytes.readUnsignedByte();l=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+l>t){console.log("           Error in reading attribute # "+s+" = skipped to end of attribute-list");this._newBlockBytes.position=t;return r}switch(o){case a.AWDSTRING:d=this._newBlockBytes.readUTFBytes(l);break;case a.INT8:d=this._newBlockBytes.readByte();break;case a.INT16:d=this._newBlockBytes.readShort();break;case a.INT32:d=this._newBlockBytes.readInt();break;case a.BOOL:case a.UINT8:d=this._newBlockBytes.readUnsignedByte();break;case a.UINT16:d=this._newBlockBytes.readUnsignedShort();break;case a.UINT32:case a.BADDR:d=this._newBlockBytes.readUnsignedInt();break;case a.FLOAT32:d=this._newBlockBytes.readFloat();break;case a.FLOAT64:d=this._newBlockBytes.readDouble();break;default:d="unimplemented attribute type "+o;this._newBlockBytes.position+=l;break}r[n]=d;if(this._debug)console.log("attribute = name: "+n+"  / value = "+d)}}return r};a.prototype.parseProperties=function(e){var a=this._newBlockBytes.readUnsignedInt();var t=new Sa;var r=this._newBlockBytes.position+a;if(e){var s;var i;var n;for(var o=0;this._newBlockBytes.position<r;o++){i=this._newBlockBytes.readUnsignedShort();s=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+s>r){console.log("           Error in reading property # "+o+" = skipped to end of propertie-list");this._newBlockBytes.position=r;return t}if(e[i]){n=e[i];t.set(i,this.parseAttrValue(n,s))}else{this._newBlockBytes.position+=s}}}else{this._newBlockBytes.position=r}return t};a.prototype.parseAttrValue=function(e,t){var r;var s;var i;switch(e){case a.BOOL:case a.INT8:r=1;s=this._newBlockBytes.readByte;break;case a.INT16:r=2;s=this._newBlockBytes.readShort;break;case a.INT32:r=4;s=this._newBlockBytes.readInt;break;case a.UINT8:r=1;s=this._newBlockBytes.readUnsignedByte;break;case a.UINT16:r=2;s=this._newBlockBytes.readUnsignedShort;break;case a.UINT32:case a.COLOR:case a.BADDR:r=4;s=this._newBlockBytes.readUnsignedInt;break;case a.FLOAT32:r=4;s=this._newBlockBytes.readFloat;break;case a.FLOAT64:r=8;s=this._newBlockBytes.readDouble;break;case a.AWDSTRING:return this._newBlockBytes.readUTFBytes(t);case a.VECTOR2x1:case a.VECTOR3x1:case a.VECTOR4x1:case a.MTX3x2:case a.MTX3x3:case a.MTX4x3:case a.MTX4x4:r=8;s=this._newBlockBytes.readDouble;break;case a.GEO_NUMBER:i=this._accuracyGeo;case a.MATRIX_NUMBER:i=this._accuracyMatrix;case a.PROPERTY_NUMBER:i=this._accuracyProps;default:if(i){r=8;s=this._newBlockBytes.readDouble}else{r=4;s=this._newBlockBytes.readFloat}}if(r<t){var n=[];var o=t/r;for(var l=0;l<o;l++)n[l]=s.call(this._newBlockBytes);return n}else{return s.call(this._newBlockBytes)}};a.prototype.parseHeader=function(){this._byteData.position=3;this._version[0]=this._byteData.readUnsignedByte();this._version[1]=this._byteData.readUnsignedByte();var e=this._byteData.readUnsignedShort();this._streaming=xa.test(e,xa.FLAG1);if(this._version[0]==2&&this._version[1]==1){this._accuracyMatrix=xa.test(e,xa.FLAG2);this._accuracyGeo=xa.test(e,xa.FLAG3);this._accuracyProps=xa.test(e,xa.FLAG4)}this._compression=this._byteData.readUnsignedByte();if(this._debug){console.log("Import AWDFile of version = "+this._version[0]+" - "+this._version[1]);console.log("Global Settings = Compression = "+this._compression+" | Streaming = "+this._streaming+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps)}var a=this._byteData.readUnsignedInt();if(!this._streaming&&a!=this._byteData.getBytesAvailable())this._pDieWithError("AWD2 body length does not match header integrity field")};a.prototype.getUVForVertexAnimation=function(e){if(this._blocks[e].data instanceof P)e=this._blocks[e].geoID;if(this._blocks[e].uvsForVertexAnimation)return this._blocks[e].uvsForVertexAnimation;var a=this._blocks[e].data;var t;var r=this._blocks[e].uvsForVertexAnimation=new Array;var s=a.subGeometries.length;for(var i=0;i<s;i++){t=a.subGeometries[i];r[i]=t.uvs.get(t.numVertices)}return this._blocks[e].uvsForVertexAnimation};a.prototype.parseVarStr=function(){return this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedShort())};a.prototype.readNumber=function(e){if(e===void 0){e=false}if(e)return this._newBlockBytes.readDouble();return this._newBlockBytes.readFloat()};a.prototype.parseMatrix3D=function(){return new d(this.parseMatrix43RawData())};a.prototype.parseMatrix32RawData=function(){var e=new Array(6);for(var a=0;a<6;a++)e[a]=this._newBlockBytes.readFloat();return e};a.prototype.parseMatrix43RawData=function(){var e=new Float32Array(16);e[0]=this.readNumber(this._accuracyMatrix);e[1]=this.readNumber(this._accuracyMatrix);e[2]=this.readNumber(this._accuracyMatrix);e[3]=0;e[4]=this.readNumber(this._accuracyMatrix);e[5]=this.readNumber(this._accuracyMatrix);e[6]=this.readNumber(this._accuracyMatrix);e[7]=0;e[8]=this.readNumber(this._accuracyMatrix);e[9]=this.readNumber(this._accuracyMatrix);e[10]=this.readNumber(this._accuracyMatrix);e[11]=0;e[12]=this.readNumber(this._accuracyMatrix);e[13]=this.readNumber(this._accuracyMatrix);e[14]=this.readNumber(this._accuracyMatrix);e[15]=1;if(isNaN(e[0])){e[0]=1;e[1]=0;e[2]=0;e[4]=0;e[5]=1;e[6]=0;e[8]=0;e[9]=0;e[10]=1;e[12]=0;e[13]=0;e[14]=0}return e};a.COMPRESSIONMODE_LZMA="lzma";a.UNCOMPRESSED=0;a.DEFLATE=1;a.LZMA=2;a.INT8=1;a.INT16=2;a.INT32=3;a.UINT8=4;a.UINT16=5;a.UINT32=6;a.FLOAT32=7;a.FLOAT64=8;a.BOOL=21;a.COLOR=22;a.BADDR=23;a.AWDSTRING=31;a.AWDBYTEARRAY=32;a.VECTOR2x1=41;a.VECTOR3x1=42;a.VECTOR4x1=43;a.MTX3x2=44;a.MTX3x3=45;a.MTX4x3=46;a.MTX4x4=47;a.GEO_NUMBER=48;a.MATRIX_NUMBER=49;a.PROPERTY_NUMBER=50;a.textFormatProperties={1:a.UINT16,2:a.UINT16,3:a.UINT8,4:a.UINT8,5:a.UINT8,6:a.UINT8,7:a.UINT16,8:a.UINT16,9:a.UINT16,10:a.UINT16};a.textFieldProperties={1:a.BOOL,3:a.BOOL,4:a.BOOL,5:a.BOOL,7:a.UINT8,8:a.UINT8,9:a.UINT8};a.textFieldTypes=["static","dynamic","input","input"];a.geometryProperties={1:a.GEO_NUMBER,2:a.GEO_NUMBER};a.subGeometryProperties={1:a.GEO_NUMBER,2:a.GEO_NUMBER};a.primitiveProperties={101:a.GEO_NUMBER,102:a.GEO_NUMBER,103:a.GEO_NUMBER,110:a.GEO_NUMBER,111:a.GEO_NUMBER,301:a.UINT16,302:a.UINT16,303:a.UINT16,701:a.BOOL,702:a.BOOL,703:a.BOOL,704:a.BOOL};a.primitiveTypes=["Unsupported Type-ID","PrimitivePlanePrefab","PrimitiveCubePrefab","PrimitiveSpherePrefab","PrimitiveCylinderPrefab","PrimitivesConePrefab","PrimitivesCapsulePrefab","PrimitivesTorusPrefab"];a.containerProperties={1:a.MATRIX_NUMBER,2:a.MATRIX_NUMBER,3:a.MATRIX_NUMBER,4:a.UINT8};a.meshInstanceProperties={1:a.MATRIX_NUMBER,2:a.MATRIX_NUMBER,3:a.MATRIX_NUMBER,4:a.UINT8,5:a.BOOL};a.lightProperties={1:a.PROPERTY_NUMBER,2:a.PROPERTY_NUMBER,3:a.COLOR,4:a.PROPERTY_NUMBER,5:a.PROPERTY_NUMBER,6:a.BOOL,7:a.COLOR,8:a.PROPERTY_NUMBER,9:a.UINT8,10:a.UINT8,11:a.PROPERTY_NUMBER,12:a.UINT16,21:a.MATRIX_NUMBER,22:a.MATRIX_NUMBER,23:a.MATRIX_NUMBER};a.cameraProperties={101:a.PROPERTY_NUMBER,102:a.PROPERTY_NUMBER,103:a.PROPERTY_NUMBER,104:a.PROPERTY_NUMBER};a.cameraPivotProperties={1:a.MATRIX_NUMBER,2:a.MATRIX_NUMBER,3:a.MATRIX_NUMBER,4:a.UINT8};a.materialProperties={1:a.INT32,2:a.BADDR,10:a.PROPERTY_NUMBER,11:a.BOOL,12:a.PROPERTY_NUMBER,13:a.BOOL};a.material_v1Properties={1:a.UINT32,2:a.BADDR,3:a.BADDR,4:a.UINT8,5:a.BOOL,6:a.BOOL,7:a.BOOL,8:a.BOOL,9:a.UINT8,10:a.PROPERTY_NUMBER,11:a.BOOL,12:a.PROPERTY_NUMBER,13:a.BOOL,15:a.PROPERTY_NUMBER,16:a.UINT32,17:a.BADDR,18:a.PROPERTY_NUMBER,19:a.PROPERTY_NUMBER,20:a.UINT32,21:a.BADDR,22:a.BADDR};a.method_v1Properties={1:a.BADDR,2:a.BADDR,3:a.BADDR,101:a.PROPERTY_NUMBER,102:a.PROPERTY_NUMBER,103:a.PROPERTY_NUMBER,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL,801:a.MTX4x4};a.commandProperties={1:a.BADDR};a.targetProperties={1:a.MATRIX_NUMBER,2:a.MATRIX_NUMBER,3:a.MATRIX_NUMBER,4:a.UINT8};a.metaDataProperties={1:a.UINT32,2:a.AWDSTRING,3:a.AWDSTRING,4:a.AWDSTRING,5:a.AWDSTRING};a.vertexAnimationSetProperties={1:a.UINT16};a.animatorSetProperties={1:a.BADDR};return a}(p);var Sa=function(){function e(){}e.prototype.set=function(e,a){this[e]=a};e.prototype.get=function(e,a){return this[e]||a};return e}();var xa=function(){function e(){}e.test=function(e,a){return(e&a)==a};e.FLAG1=1;e.FLAG2=2;e.FLAG3=4;e.FLAG4=8;e.FLAG5=16;e.FLAG6=32;e.FLAG7=64;e.FLAG8=128;e.FLAG9=256;e.FLAG10=512;e.FLAG11=1024;e.FLAG12=2048;e.FLAG13=4096;e.FLAG14=8192;e.FLAG15=16384;e.FLAG16=32768;return e}();a.exports=Ta},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/projections/OrthographicOffCenterProjection":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/base/CurveSubGeometry":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/Timeline":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/entities/Skybox":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-display/lib/prefabs/PrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveConePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-display/lib/text/TextFormat":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseCelMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFogMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectRimLightMethod":undefined,"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowHardMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowNearMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularCelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularPhongMethod":undefined,"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/VertexAnimator":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/MD2Parser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/net/URLLoaderDataFormat");var n=e("awayjs-core/lib/net/URLRequest");var o=e("awayjs-core/lib/parsers/ParserBase");var l=e("awayjs-core/lib/parsers/ParserUtils");var d=e("awayjs-display/lib/base/Geometry");var h=e("awayjs-display/lib/base/TriangleSubGeometry");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var _=e("awayjs-display/lib/entities/Mesh");var p=e("awayjs-display/lib/managers/DefaultMaterialManager");var u=e("awayjs-display/lib/textures/Single2DTexture");var f=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var y=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var w=e("awayjs-methodmaterials/lib/MethodMaterial");var b=e("awayjs-methodmaterials/lib/MethodMaterialMode");var m=function(e){r(a,e);function a(a,t){if(a===void 0){a="jpg"}if(t===void 0){t=true}e.call(this,i.ARRAY_BUFFER);this._clipNodes=new Object;this._animationSet=new y;this.materialFinal=false;this.geoCreated=false;this._textureType=a;this._ignoreTexturePath=t}a.supportsType=function(e){e=e.toLowerCase();return e=="md2"};a.supportsData=function(e){return l.toString(e,4)=="IDP2"};a.prototype._iResolveDependency=function(e){if(e.assets.length!=1)return;var a=new u(e.assets[0]);if(a){var t=new w(a);if(this.materialMode>=2)t.mode=b.MULTI_PASS;this._pContent.addChild(this._mesh);t.name=this._mesh.material.name;this._mesh.material=t;this._pFinalizeAsset(t);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this.materialFinal=true};a.prototype._iResolveDependencyFailure=function(e){if(this.materialMode<2){this._mesh.material=p.getDefaultMaterial()}else{this._mesh.material=new w(p.getDefaultTexture());this._mesh.material.mode=b.MULTI_PASS}this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh);this.materialFinal=true};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true;this._byteData.position=0}while(this._pHasTime()){if(!this._parsedHeader){this._geometry=new d;this._mesh=new _(this._geometry,null);if(this.materialMode<2){this._mesh.material=p.getDefaultMaterial()}else{this._mesh.material=new w(p.getDefaultTexture());this._mesh.material.mode=b.MULTI_PASS}this.parseHeader();this.parseMaterialNames()}else if(!this._parsedUV){this.parseUV()}else if(!this._parsedFaces){this.parseFaces()}else if(!this._parsedFrames){this.parseFrames()}else if(this.geoCreated&&this.materialFinal){return o.PARSING_DONE}else if(!this.geoCreated){this.geoCreated=true;this._geometry.addSubGeometry(this._firstSubGeom.clone());this._mesh.name="";if(this.materialFinal){this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this._pPauseAndRetrieveDependencies()}}return o.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){this._pContent=new c;e.prototype._pStartParsing.call(this,a)};a.prototype.parseHeader=function(){this._ident=this._byteData.readInt();this._version=this._byteData.readInt();this._skinWidth=this._byteData.readInt();this._skinHeight=this._byteData.readInt();
this._byteData.readInt();this._numSkins=this._byteData.readInt();this._numVertices=this._byteData.readInt();this._numST=this._byteData.readInt();this._numTris=this._byteData.readInt();this._byteData.readInt();this._numFrames=this._byteData.readInt();this._offsetSkins=this._byteData.readInt();this._offsetST=this._byteData.readInt();this._offsetTris=this._byteData.readInt();this._offsetFrames=this._byteData.readInt();this._byteData.readInt();this._offsetEnd=this._byteData.readInt();this._parsedHeader=true};a.prototype.parseMaterialNames=function(){var e;var a;var t;var r;this._materialNames=new Array;this._byteData.position=this._offsetSkins;var s=new RegExp("[^a-zA-Z0-9\\_/.]","g");for(var i=0;i<this._numSkins;++i){a=this._byteData.readUTFBytes(64);a=a.replace(s,"");t=a.lastIndexOf(".");if(this._ignoreTexturePath)r=a.lastIndexOf("/");if(a.toLowerCase().indexOf(".jpg")==-1&&a.toLowerCase().indexOf(".png")==-1){a=a.substring(r+1,t);e=a+"."+this._textureType}else{e=a}this._materialNames[i]=a;if(this.dependencies.length==0)this._pAddDependency(a,new n(e))}if(this._materialNames.length>0)this._mesh.material.name=this._materialNames[0];else this.materialFinal=true};a.prototype.parseUV=function(){var e=0;this._uvs=new Array(this._numST*2);this._byteData.position=this._offsetST;for(var a=0;a<this._numST;a++){this._uvs[e++]=this._byteData.readShort()/this._skinWidth;this._uvs[e++]=this._byteData.readShort()/this._skinHeight}this._parsedUV=true};a.prototype.parseFaces=function(){var e,a,t,r,s,i;var n;this._vertIndices=new Array;this._uvIndices=new Array;this._indices=new Array;this._byteData.position=this._offsetTris;for(n=0;n<this._numTris;n++){e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedShort();t=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedShort();this.addIndex(e,r);this.addIndex(a,s);this.addIndex(t,i)}var o=this._uvIndices.length;this._finalUV=new Array(o*2);for(n=0;n<o;++n){this._finalUV[n<<1]=this._uvs[this._uvIndices[n]<<1];this._finalUV[(n<<1)+1]=this._uvs[(this._uvIndices[n]<<1)+1]}this._parsedFaces=true};a.prototype.addIndex=function(e,a){var t=this.findIndex(e,a);if(t==-1){this._indices.push(this._vertIndices.length);this._vertIndices.push(e);this._uvIndices.push(a)}else this._indices.push(t)};a.prototype.findIndex=function(e,a){var t=this._vertIndices.length;for(var r=0;r<t;++r){if(this._vertIndices[r]==e&&this._uvIndices[r]==a)return r}return-1};a.prototype.parseFrames=function(){var e,t,r;var i,n,o;var l;var c;var _=this._vertIndices.length;var p;var u;var y,w,b;var m="";var v=null;this._byteData.position=this._offsetFrames;for(y=0;y<this._numFrames;y++){u=new Array;p=new Array(_*3);e=this._byteData.readFloat();t=this._byteData.readFloat();r=this._byteData.readFloat();i=this._byteData.readFloat();n=this._byteData.readFloat();o=this._byteData.readFloat();m=this.readFrameName();for(w=0;w<this._numVertices;w++,this._byteData.position++)u.push(e*this._byteData.readUnsignedByte()+i,t*this._byteData.readUnsignedByte()+n,r*this._byteData.readUnsignedByte()+o);b=0;for(w=0;w<_;w++){p[b++]=u[this._vertIndices[w]*3];p[b++]=u[this._vertIndices[w]*3+2];p[b++]=u[this._vertIndices[w]*3+1]}c=new h(new s);if(this._firstSubGeom==null)this._firstSubGeom=c;l=new d;l.addSubGeometry(c);c.setIndices(this._indices);c.setPositions(p);c.setUVs(this._finalUV);c.setNormals(null);c.setTangents(null);c.autoDeriveNormals=false;c.autoDeriveTangents=false;var g=this._clipNodes[m];if(!g){if(v){this._pFinalizeAsset(v);this._animationSet.addAnimation(v)}g=new f;g.name=m;g.stitchFinalFrame=true;this._clipNodes[m]=g;v=g}g.addFrame(l,1e3/a.FPS)}if(v){this._pFinalizeAsset(v);this._animationSet.addAnimation(v)}this._pFinalizeAsset(this._animationSet);this._parsedFrames=true};a.prototype.readFrameName=function(){var e="";var a=0;for(var t=0;t<16;t++){var r=this._byteData.readUnsignedByte();if(Math.floor(r)>57&&Math.floor(r)<=122&&a==0)e+=String.fromCharCode(r);if(Math.floor(r)>=48&&Math.floor(r)<=57)a++}return e};a.FPS=6;return a}(o);a.exports=m},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/MD5AnimParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/Quaternion");var i=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-core/lib/net/URLLoaderDataFormat");var o=e("awayjs-core/lib/parsers/ParserBase");var l=e("awayjs-renderergl/lib/animators/data/JointPose");var d=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var h=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var c=function(e){r(a,e);function a(a,t){if(a===void 0){a=null}if(t===void 0){t=0}e.call(this,n.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new s;var r=new s;var o=new s;r.fromAxisAngle(i.X_AXIS,-Math.PI*.5);o.fromAxisAngle(i.Y_AXIS,-Math.PI*.5);this._rotationQuat.multiply(o,r);if(a){this._rotationQuat.multiply(o,r);r.fromAxisAngle(a,t);this._rotationQuat.multiply(r,this._rotationQuat)}}a.supportsType=function(e){e=e.toLowerCase();return e=="md5anim"};a.supportsData=function(e){return false};a.prototype._pProceedParsing=function(){var e;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){e=this.getNextToken();switch(e){case a.COMMENT_TOKEN:this.ignoreLine();break;case"":break;case a.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case a.COMMAND_LINE_TOKEN:this.parseCMD();break;case a.NUM_FRAMES_TOKEN:this._numFrames=this.getNextInt();this._bounds=new Array;this._frameData=new Array;break;case a.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._hierarchy=new Array(this._numJoints);this._baseFrameData=new Array(this._numJoints);break;case a.FRAME_RATE_TOKEN:this._frameRate=this.getNextInt();break;case a.NUM_ANIMATED_COMPONENTS_TOKEN:this._numAnimatedComponents=this.getNextInt();break;case a.HIERARCHY_TOKEN:this.parseHierarchy();break;case a.BOUNDS_TOKEN:this.parseBounds();break;case a.BASE_FRAME_TOKEN:this.parseBaseFrame();break;case a.FRAME_TOKEN:this.parseFrame();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this._clip=new h;this.translateClip();this._pFinalizeAsset(this._clip);return o.PARSING_DONE}}return o.MORE_TO_PARSE};a.prototype.translateClip=function(){for(var e=0;e<this._numFrames;++e)this._clip.addFrame(this.translatePose(this._frameData[e]),1e3/this._frameRate)};a.prototype.translatePose=function(e){var a;var t;var r;var n;var o;var h=new i;var c=new s;var _=e.components;var p=new d;var u=p.jointPoses;for(var f=0;f<this._numJoints;++f){o=0;t=new l;a=this._hierarchy[f];r=this._baseFrameData[f];n=a.flags;h.x=r.position.x;h.y=r.position.y;h.z=r.position.z;c.x=r.orientation.x;c.y=r.orientation.y;c.z=r.orientation.z;if(n&1)h.x=_[a.startIndex+o++];if(n&2)h.y=_[a.startIndex+o++];if(n&4)h.z=_[a.startIndex+o++];if(n&8)c.x=_[a.startIndex+o++];if(n&16)c.y=_[a.startIndex+o++];if(n&32)c.z=_[a.startIndex+o++];var y=1-c.x*c.x-c.y*c.y-c.z*c.z;c.w=y<0?0:-Math.sqrt(y);if(a.parentIndex<0){t.orientation.multiply(this._rotationQuat,c);t.translation=this._rotationQuat.rotatePoint(h)}else{t.orientation.copyFrom(c);t.translation.x=h.x;t.translation.y=h.y;t.translation.z=h.z}t.orientation.y=-t.orientation.y;t.orientation.z=-t.orientation.z;t.translation.x=-t.translation.x;u[f]=t}return p};a.prototype.parseHierarchy=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new f;t.name=this.parseLiteralstring();t.parentIndex=this.getNextInt();t.flags=this.getNextInt();t.startIndex=this.getNextInt();this._hierarchy[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseBounds=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new p;t.min=this.parseVector3D();t.max=this.parseVector3D();this._bounds[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseBaseFrame=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new _;t.position=this.parseVector3D();t.orientation=this.parseQuaternion();this._baseFrameData[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseFrame=function(){var e;var t;var r;var s;s=this.getNextInt();r=this.getNextToken();if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new u;t.components=new Array(this._numAnimatedComponents);for(var i=0;i<this._numAnimatedComponents;++i)t.components[i]=this.getNextNumber();this._frameData[s]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};a.prototype.getNextToken=function(){var e;var t="";while(!this._reachedEOF){e=this.getNextChar();if(e==" "||e=="\r"||e=="\n"||e=="	"){if(t!=a.COMMENT_TOKEN)this.skipWhiteSpace();if(t!="")return t}else t+=e;if(t==a.COMMENT_TOKEN)return t}return t};a.prototype.skipWhiteSpace=function(){var e;do e=this.getNextChar();while(e=="\n"||e==" "||e=="\r"||e=="	");this.putBack()};a.prototype.ignoreLine=function(){var e;while(!this._reachedEOF&&e!="\n")e=this.getNextChar()};a.prototype.getNextChar=function(){var e=this._textData.charAt(this._parseIndex++);if(e=="\n"){++this._line;this._charLineIndex=0}else if(e!="\r")++this._charLineIndex;if(this._parseIndex==this._textData.length)this._reachedEOF=true;return e};a.prototype.getNextInt=function(){var e=parseInt(this.getNextToken());if(isNaN(e))this.sendParseError("int type");return e};a.prototype.getNextNumber=function(){var e=parseFloat(this.getNextToken());if(isNaN(e))this.sendParseError("float type");return e};a.prototype.parseVector3D=function(){var e=new i;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseQuaternion=function(){var e=new s;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();var t=1-e.x*e.x-e.y*e.y-e.z*e.z;e.w=t<0?0:-Math.sqrt(t);if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseCMD=function(){this.parseLiteralstring()};a.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var e=this.getNextChar();var a="";if(e!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();e=this.getNextChar();if(e!='"')a+=e}while(e!='"');return a};a.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};a.prototype.sendParseError=function(e){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+e+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};a.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};a.VERSION_TOKEN="MD5Version";a.COMMAND_LINE_TOKEN="commandline";a.NUM_FRAMES_TOKEN="numFrames";a.NUM_JOINTS_TOKEN="numJoints";a.FRAME_RATE_TOKEN="frameRate";a.NUM_ANIMATED_COMPONENTS_TOKEN="numAnimatedComponents";a.HIERARCHY_TOKEN="hierarchy";a.BOUNDS_TOKEN="bounds";a.BASE_FRAME_TOKEN="baseframe";a.FRAME_TOKEN="frame";a.COMMENT_TOKEN="//";return a}(o);var _=function(){function e(){}return e}();var p=function(){function e(){}return e}();var u=function(){function e(){}return e}();var f=function(){function e(){}return e}();a.exports=c},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined}],"awayjs-parsers/lib/MD5MeshParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/geom/Quaternion");var n=e("awayjs-core/lib/geom/Vector3D");var o=e("awayjs-core/lib/net/URLLoaderDataFormat");var l=e("awayjs-core/lib/parsers/ParserBase");var d=e("awayjs-display/lib/base/Geometry");var h=e("awayjs-display/lib/base/TriangleSubGeometry");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var _=e("awayjs-display/lib/entities/Mesh");var p=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var u=e("awayjs-renderergl/lib/animators/data/Skeleton");var f=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var y=function(e){r(a,e);function a(a,t){if(a===void 0){a=null}if(t===void 0){t=0}e.call(this,o.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new i;this._rotationQuat.fromAxisAngle(n.X_AXIS,-Math.PI*.5);if(a){var r=new i;r.fromAxisAngle(a,t);this._rotationQuat.multiply(this._rotationQuat,r)}}a.supportsType=function(e){e=e.toLowerCase();return e=="md5mesh"};a.supportsData=function(e){return false};a.prototype._pProceedParsing=function(){var e;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){e=this.getNextToken();switch(e){case a.COMMENT_TOKEN:this.ignoreLine();break;case a.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case a.COMMAND_LINE_TOKEN:this.parseCMD();break;case a.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._bindPoses=new Array(this._numJoints);break;case a.NUM_MESHES_TOKEN:this._numMeshes=this.getNextInt();break;case a.JOINTS_TOKEN:this.parseJoints();break;case a.MESH_TOKEN:this.parseMesh();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this.calculateMaxJointCount();this._animationSet=new p(this._maxJointCount);this._mesh=new _(new d,null);this._geometry=this._mesh.geometry;for(var t=0;t<this._meshData.length;++t)this._geometry.addSubGeometry(this.translateGeom(this._meshData[t].vertexData,this._meshData[t].weightData,this._meshData[t].indices));this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._geometry);this._pFinalizeAsset(this._mesh);this._pFinalizeAsset(this._skeleton);this._pFinalizeAsset(this._animationSet);return l.PARSING_DONE}}return l.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){this._pContent=new c;e.prototype._pStartParsing.call(this,a)};a.prototype.calculateMaxJointCount=function(){this._maxJointCount=0;var e=this._meshData.length;for(var a=0;a<e;++a){var t=this._meshData[a];var r=t.vertexData;var s=r.length;for(var i=0;i<s;++i){var n=this.countZeroWeightJoints(r[i],t.weightData);var o=r[i].countWeight-n;if(o>this._maxJointCount)this._maxJointCount=o}}};a.prototype.countZeroWeightJoints=function(e,a){var t=e.startWeight;var r=e.startWeight+e.countWeight;var s=0;var i;for(var n=t;n<r;++n){i=a[n].bias;if(i==0)++s}return s};a.prototype.parseJoints=function(){var e;var t;var r;var s;var i=0;var n=this.getNextToken();if(n!="{")this.sendUnknownKeywordError();this._skeleton=new u;do{if(this._reachedEOF)this.sendEOFError();t=new f;t.name=this.parseLiteralstring();t.parentIndex=this.getNextInt();r=this.parseVector3D();r=this._rotationQuat.rotatePoint(r);s=this.parseQuaternion();this._bindPoses[i]=s.toMatrix3D();this._bindPoses[i].appendTranslation(r.x,r.y,r.z);var o=this._bindPoses[i].clone();o.invert();t.inverseBindPose=o.rawData;this._skeleton.joints[i++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};a.prototype.parseMesh=function(){var e=this.getNextToken();var t;var r;var s;var i;if(e!="{")this.sendUnknownKeywordError();if(this._shaders==null)this._shaders=new Array;while(t!="}"){t=this.getNextToken();switch(t){case a.COMMENT_TOKEN:this.ignoreLine();break;case a.MESH_SHADER_TOKEN:this._shaders.push(this.parseLiteralstring());break;case a.MESH_NUM_VERTS_TOKEN:r=new Array(this.getNextInt());break;case a.MESH_NUM_TRIS_TOKEN:i=new Array(this.getNextInt()*3);break;case a.MESH_NUM_WEIGHTS_TOKEN:s=new Array(this.getNextInt());break;case a.MESH_VERT_TOKEN:this.parseVertex(r);break;case a.MESH_TRI_TOKEN:this.parseTri(i);break;case a.MESH_WEIGHT_TOKEN:this.parseJoint(s);break}}if(this._meshData==null)this._meshData=new Array;var n=this._meshData.length;this._meshData[n]=new m;this._meshData[n].vertexData=r;this._meshData[n].weightData=s;this._meshData[n].indices=i};a.prototype.translateGeom=function(e,a,t){var r=e.length;var i,n,o;var l;var d;var c;var _;var p=new h(new s);var u=new Array(r*2);var f=new Array(r*3);var y=new Array(r*this._maxJointCount);var w=new Array(r*this._maxJointCount);var b=0;var m;for(var v=0;v<r;++v){l=e[v];i=l.index*3;n=i+1;o=i+2;f[i]=f[n]=f[o]=0;m=0;for(var g=0;g<l.countWeight;++g){d=a[l.startWeight+g];if(d.bias>0){c=this._bindPoses[d.joint];_=c.transformVector(d.pos);f[i]+=_.x*d.bias;f[n]+=_.y*d.bias;f[o]+=_.z*d.bias;y[b]=d.joint*3;w[b++]=d.bias;++m}}for(g=m;g<this._maxJointCount;++g){y[b]=0;w[b++]=0}i=l.index<<1;u[i++]=l.s;u[i]=l.t}p.jointsPerVertex=this._maxJointCount;p.setIndices(t);p.setPositions(f);p.setUVs(u);p.setJointIndices(y);p.setJointWeights(w);p.setNormals(null);p.setTangents(null);p.autoDeriveTangents=false;p.autoDeriveNormals=false;return p};a.prototype.parseTri=function(e){var a=this.getNextInt()*3;e[a]=this.getNextInt();e[a+1]=this.getNextInt();e[a+2]=this.getNextInt()};a.prototype.parseJoint=function(e){var a=new b;a.index=this.getNextInt();a.joint=this.getNextInt();a.bias=this.getNextNumber();a.pos=this.parseVector3D();e[a.index]=a};a.prototype.parseVertex=function(e){var a=new w;a.index=this.getNextInt();this.parseUV(a);a.startWeight=this.getNextInt();a.countWeight=this.getNextInt();e[a.index]=a};a.prototype.parseUV=function(e){var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.s=this.getNextNumber();e.t=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")")};a.prototype.getNextToken=function(){var e;var t="";while(!this._reachedEOF){e=this.getNextChar();if(e==" "||e=="\r"||e=="\n"||e=="	"){if(t!=a.COMMENT_TOKEN)this.skipWhiteSpace();if(t!="")return t}else t+=e;if(t==a.COMMENT_TOKEN)return t}return t};a.prototype.skipWhiteSpace=function(){var e;do e=this.getNextChar();while(e=="\n"||e==" "||e=="\r"||e=="	");this.putBack()};a.prototype.ignoreLine=function(){var e;while(!this._reachedEOF&&e!="\n")e=this.getNextChar()};a.prototype.getNextChar=function(){var e=this._textData.charAt(this._parseIndex++);if(e=="\n"){++this._line;this._charLineIndex=0}else if(e!="\r")++this._charLineIndex;if(this._parseIndex>=this._textData.length)this._reachedEOF=true;return e};a.prototype.getNextInt=function(){var e=parseInt(this.getNextToken());if(isNaN(e))this.sendParseError("int type");return e};a.prototype.getNextNumber=function(){var e=parseFloat(this.getNextToken());if(isNaN(e))this.sendParseError("float type");return e};a.prototype.parseVector3D=function(){var e=new n;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=-this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseQuaternion=function(){var e=new i;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=-this.getNextNumber();e.z=-this.getNextNumber();var t=1-e.x*e.x-e.y*e.y-e.z*e.z;e.w=t<0?0:-Math.sqrt(t);if(this.getNextToken()!=")")this.sendParseError(")");var r=new i;r.multiply(this._rotationQuat,e);return r};a.prototype.parseCMD=function(){this.parseLiteralstring()};a.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var e=this.getNextChar();var a="";if(e!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();e=this.getNextChar();if(e!='"')a+=e}while(e!='"');return a};a.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};a.prototype.sendParseError=function(e){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+e+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};a.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};a.VERSION_TOKEN="MD5Version";a.COMMAND_LINE_TOKEN="commandline";a.NUM_JOINTS_TOKEN="numJoints";a.NUM_MESHES_TOKEN="numMeshes";a.COMMENT_TOKEN="//";a.JOINTS_TOKEN="joints";a.MESH_TOKEN="mesh";a.MESH_SHADER_TOKEN="shader";a.MESH_NUM_VERTS_TOKEN="numverts";a.MESH_VERT_TOKEN="vert";a.MESH_NUM_TRIS_TOKEN="numtris";a.MESH_TRI_TOKEN="tri";a.MESH_NUM_WEIGHTS_TOKEN="numweights";a.MESH_WEIGHT_TOKEN="weight";return a}(l);var w=function(){function e(){}return e}();var b=function(){function e(){}return e}();var m=function(){function e(){}return e}();a.exports=y},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined}],"awayjs-parsers/lib/Max3DSParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/BitmapImage2D");var n=e("awayjs-core/lib/geom/Matrix3D");var o=e("awayjs-core/lib/geom/Vector3D");var l=e("awayjs-core/lib/net/URLLoaderDataFormat");var d=e("awayjs-core/lib/net/URLRequest");var h=e("awayjs-core/lib/parsers/ParserBase");var c=e("awayjs-core/lib/parsers/ParserUtils");var _=e("awayjs-display/lib/base/Geometry");var p=e("awayjs-display/lib/base/TriangleSubGeometry");var u=e("awayjs-display/lib/containers/DisplayObjectContainer");var f=e("awayjs-display/lib/entities/Mesh");var y=e("awayjs-display/lib/managers/DefaultMaterialManager");var w=e("awayjs-display/lib/textures/Single2DTexture");var b=e("awayjs-methodmaterials/lib/MethodMaterial");var m=e("awayjs-methodmaterials/lib/MethodMaterialMode");var v=function(e){r(a,e);function a(a){if(a===void 0){a=true}e.call(this,l.ARRAY_BUFFER);this._useSmoothingGroups=a}a.supportsType=function(e){e=e.toLowerCase();return e=="3ds"};a.supportsData=function(e){var a;a=c.toByteArray(e);if(a){a.position=0;if(a.readShort()==19789)return true}return false};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a;a=e.assets[0];if(a.isAsset(i)){var t;t=this._textures[e.id];t.texture=new w(a)}}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._pProceedParsing=function(){if(!this._byteData){this._byteData=this._pGetByteData();this._byteData.position=0;this._textures={};this._materials={};this._unfinalized_objects={}}while(this._pHasTime()){if(this._cur_mat&&this._byteData.position>=this._cur_mat_end)this.finalizeCurrentMaterial();else if(this._cur_obj&&this._byteData.position>=this._cur_obj_end){this._unfinalized_objects[this._cur_obj.name]=this._cur_obj;this._cur_obj_end=Number.MAX_VALUE;this._cur_obj=null}if(this._byteData.getBytesAvailable()>0){var e;var a;var t;e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedInt();t=this._byteData.position+(a-6);switch(e){case 19789:case 15677:case 45056:continue;break;case 45055:this._cur_mat_end=t;this._cur_mat=this.parseMaterial();break;case 16384:this._cur_obj_end=t;this._cur_obj=new k;this._cur_obj.name=this.readNulTermstring();this._cur_obj.materials=new Array;this._cur_obj.materialFaces={};break;case 16640:this._cur_obj.type=f.assetType;break;case 16656:this.parseVertexList();break;case 16672:this.parseFaceList();break;case 16704:this.parseUVList();break;case 16688:this.parseFaceMaterialList();break;case 16736:this._cur_obj.transform=this.readTransform();break;case 45058:this.parseObjectAnimation(t);break;case 16720:this.parseSmoothingGroups();break;default:this._byteData.position+=a-6;break}if(this.dependencies.length){this._pPauseAndRetrieveDependencies();break}}}if(this._byteData.getBytesAvailable()||this._cur_obj||this._cur_mat){return h.MORE_TO_PARSE}else{var r;for(r in this._unfinalized_objects){var s;s=this.constructObject(this._unfinalized_objects[r]);if(s){this._pContent.addChild(s);this._pFinalizeAsset(s,r)}}return h.PARSING_DONE}};a.prototype._pStartParsing=function(a){this._pContent=new u;e.prototype._pStartParsing.call(this,a)};a.prototype.parseMaterial=function(){var e;e=new B;while(this._byteData.position<this._cur_mat_end){var a;var t;var r;a=this._byteData.readUnsignedShort();t=this._byteData.readUnsignedInt();r=this._byteData.position+(t-6);switch(a){case 40960:e.name=this.readNulTermstring();break;case 40976:e.ambientColor=this.readColor();break;case 40992:e.diffuseColor=this.readColor();break;case 41008:e.specularColor=this.readColor();break;case 41089:e.twoSided=true;break;case 41472:e.colorMap=this.parseTexture(r);break;case 41476:e.specularMap=this.parseTexture(r);break;default:this._byteData.position=r;break}}return e};a.prototype.parseTexture=function(e){var a;a=new D;while(this._byteData.position<e){var t;var r;t=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedInt();switch(t){case 41728:a.url=this.readNulTermstring();break;default:this._byteData.position+=r-6;break}}this._textures[a.url]=a;this._pAddDependency(a.url,new d(a.url));return a};a.prototype.parseVertexList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.verts=new Array(t*3);e=0;a=this._cur_obj.verts.length;while(e<a){var r,s,i;r=this._byteData.readFloat();s=this._byteData.readFloat();i=this._byteData.readFloat();this._cur_obj.verts[e++]=r;this._cur_obj.verts[e++]=i;this._cur_obj.verts[e++]=s}};a.prototype.parseFaceList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.indices=new Array(t*3);e=0;a=this._cur_obj.indices.length;while(e<a){var r,s,i;r=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedShort();this._cur_obj.indices[e++]=r;this._cur_obj.indices[e++]=i;this._cur_obj.indices[e++]=s;this._byteData.position+=2}this._cur_obj.smoothingGroups=new Array(t)};a.prototype.parseSmoothingGroups=function(){var e=this._cur_obj.indices.length/3;var a=0;while(a<e){this._cur_obj.smoothingGroups[a]=this._byteData.readUnsignedInt();a++}};a.prototype.parseUVList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.uvs=new Array(t*2);e=0;a=this._cur_obj.uvs.length;while(e<a){this._cur_obj.uvs[e++]=this._byteData.readFloat();this._cur_obj.uvs[e++]=1-this._byteData.readFloat()}};a.prototype.parseFaceMaterialList=function(){var e;var a;var t;var r;e=this.readNulTermstring();a=this._byteData.readUnsignedShort();r=new Array(a);t=0;while(t<r.length)r[t++]=this._byteData.readUnsignedShort();this._cur_obj.materials.push(e);this._cur_obj.materialFaces[e]=r};a.prototype.parseObjectAnimation=function(e){var a;var t;var r;var s;var i;r=new o;while(this._byteData.position<e){var n;var l;n=this._byteData.readUnsignedShort();l=this._byteData.readUnsignedInt();switch(n){case 45072:s=this.readNulTermstring();this._byteData.position+=4;i=this._byteData.readShort();break;case 45075:r.x=this._byteData.readFloat();r.z=this._byteData.readFloat();r.y=this._byteData.readFloat();break;default:this._byteData.position+=l-6;break}}if(s!="$$$DUMMY"&&this._unfinalized_objects.hasOwnProperty(s)){a=this._unfinalized_objects[s];t=this.constructObject(a,r);if(t){this._pContent.addChild(t);this._pFinalizeAsset(t,a.name)}delete this._unfinalized_objects[s]}};a.prototype.constructObject=function(e,a){if(a===void 0){a=null}if(e.type==f.assetType){var t;var r;var i;var o;var l;var d;var h;var c;if(e.materials.length>1)console.log("The Away3D 3DS parser does not support multiple materials per mesh at this point.");if(!e.indices||e.indices.length==0)return null;h=new Array(e.verts.length/3);c=new Array(e.indices.length/3);this.prepareData(h,c,e);if(this._useSmoothingGroups)this.applySmoothGroups(h,c);e.verts=new Array(h.length*3);for(t=0;t<h.length;t++){e.verts[t*3]=h[t].x;e.verts[t*3+1]=h[t].y;e.verts[t*3+2]=h[t].z}e.indices=new Array(c.length*3);for(t=0;t<c.length;t++){e.indices[t*3]=c[t].a;e.indices[t*3+1]=c[t].b;e.indices[t*3+2]=c[t].c}if(e.uvs){e.uvs=new Array(h.length*2);for(t=0;t<h.length;t++){e.uvs[t*2]=h[t].u;e.uvs[t*2+1]=h[t].v}}i=new _;r=new p(new s);r.setIndices(e.indices);r.setPositions(e.verts);r.setUVs(e.uvs);i.addSubGeometry(r);if(e.materials.length>0){var u;u=e.materials[0];o=this._materials[u].material}if(a){if(e.transform){d=new n(e.transform);d.rawData[12]=0;d.rawData[13]=0;d.rawData[14]=0;a=d.transformVector(a)}a.scaleBy(-1);d=new n;d.appendTranslation(a.x,a.y,a.z);i.applyTransformation(d)}if(e.transform){d=new n(e.transform);d.invert();i.applyTransformation(d)}this._pFinalizeAsset(i,e.name.concat("_geom"));l=new f(i,o);l.transform.matrix3D=new n(e.transform);return l}return null};a.prototype.prepareData=function(e,a,t){var r;var s;var i;var n=t.verts.length;for(r=0,s=0,i=0;r<n;){var o=new A;o.x=t.verts[r++];o.y=t.verts[r++];o.z=t.verts[r++];if(t.uvs){o.u=t.uvs[s++];o.v=t.uvs[s++]}e[i++]=o}n=t.indices.length;for(r=0,i=0;r<n;){var l=new g;l.a=t.indices[r++];l.b=t.indices[r++];l.c=t.indices[r++];l.smoothGroup=t.smoothingGroups[i]||0;a[i++]=l}};a.prototype.applySmoothGroups=function(e,a){var t;var r;var s;var i;var n;var o=e.length;var l=a.length;var d=new Array(o);for(t=0;t<o;t++)d[t]=new Array;for(t=0;t<l;t++){var h=a[t];for(r=0;r<3;r++){var c=d[r==0?h.a:r==1?h.b:h.c];var _=h.smoothGroup;for(s=c.length-1;s>=0;s--){if((_&c[s])>0){_|=c[s];c.splice(s,1);s=c.length-1}}c.push(_)}}var p=new Array(o);for(t=0;t<o;t++){if((n=d[t].length)<1)continue;
var u=new Array(n);p[t]=u;u[0]=t;var f=e[t];for(r=1;r<n;r++){var y=new A;y.x=f.x;y.y=f.y;y.z=f.z;y.u=f.u;y.v=f.v;u[r]=e.length;e.push(y)}}o=e.length;for(t=0;t<l;t++){h=a[t];_=h.smoothGroup;for(r=0;r<3;r++){s=r==0?h.a:r==1?h.b:h.c;c=d[s];n=c.length;u=p[s];for(i=0;i<n;i++){if(_==0&&c[i]==0||(_&c[i])>0){var w=u[i];if(_==0){c.splice(i,1);u.splice(i,1)}if(r==0)h.a=w;else if(r==1)h.b=w;else h.c=w;i=n}}}}};a.prototype.finalizeCurrentMaterial=function(){var e;if(this._cur_mat.colorMap)e=new b(this._cur_mat.colorMap.texture||y.getDefaultTexture());else e=new b(this._cur_mat.ambientColor);e.diffuseColor=this._cur_mat.diffuseColor;e.specularColor=this._cur_mat.specularColor;if(this.materialMode>=2)e.mode=m.MULTI_PASS;e.bothSides=this._cur_mat.twoSided;this._pFinalizeAsset(e,this._cur_mat.name);this._materials[this._cur_mat.name]=this._cur_mat;this._cur_mat.material=e;this._cur_mat=null};a.prototype.readNulTermstring=function(){var e;var a="";while((e=this._byteData.readUnsignedByte())>0)a+=String.fromCharCode(e);return a};a.prototype.readTransform=function(){var e=new Float32Array(16);e[0]=this._byteData.readFloat();e[2]=this._byteData.readFloat();e[1]=this._byteData.readFloat();e[3]=0;e[8]=this._byteData.readFloat();e[10]=this._byteData.readFloat();e[9]=this._byteData.readFloat();e[11]=0;e[4]=this._byteData.readFloat();e[6]=this._byteData.readFloat();e[5]=this._byteData.readFloat();e[7]=0;e[12]=this._byteData.readFloat();e[14]=this._byteData.readFloat();e[13]=this._byteData.readFloat();e[15]=1;return e};a.prototype.readColor=function(){var e;var a;var t,r,s;e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedInt();switch(e){case 16:t=this._byteData.readFloat()*255;r=this._byteData.readFloat()*255;s=this._byteData.readFloat()*255;break;case 17:t=this._byteData.readUnsignedByte();r=this._byteData.readUnsignedByte();s=this._byteData.readUnsignedByte();break;default:this._byteData.position+=a-6;break}return t<<16|r<<8|s};return a}(h);var g=function(){function e(){}return e}();var B=function(){function e(){}return e}();var k=function(){function e(){}return e}();var D=function(){function e(){}return e}();var A=function(){function e(){}return e}();a.exports=v},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined}],"awayjs-parsers/lib/OBJParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/BitmapImage2D");var n=e("awayjs-core/lib/net/URLLoaderDataFormat");var o=e("awayjs-core/lib/net/URLRequest");var l=e("awayjs-core/lib/parsers/ParserBase");var d=e("awayjs-core/lib/parsers/ParserUtils");var h=e("awayjs-display/lib/base/TriangleSubGeometry");var c=e("awayjs-display/lib/base/Geometry");var _=e("awayjs-display/lib/containers/DisplayObjectContainer");var p=e("awayjs-display/lib/entities/Mesh");var u=e("awayjs-display/lib/managers/DefaultMaterialManager");var f=e("awayjs-display/lib/textures/Single2DTexture");var y=e("awayjs-methodmaterials/lib/MethodMaterial");var w=e("awayjs-methodmaterials/lib/MethodMaterialMode");var b=e("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var m=function(e){r(a,e);function a(a){if(a===void 0){a=1}e.call(this,n.TEXT);this._mtlLibLoaded=true;this._activeMaterialID="";this._scale=a}Object.defineProperty(a.prototype,"scale",{set:function(e){this._scale=e},enumerable:true,configurable:true});a.supportsType=function(e){e=e.toLowerCase();return e=="obj"};a.supportsData=function(e){var a=d.toString(e);var t=false;var r=false;if(a){t=a.indexOf("\nv ")!=-1;r=a.indexOf("\nf ")!=-1}return t&&r};a.prototype._iResolveDependency=function(e){if(e.id=="mtl"){var a=d.toString(e.data);this.parseMtl(a)}else{var t;if(e.assets.length!=1){return}t=e.assets[0];if(t.isAsset(i)){var r=new D;r.materialID=e.id;r.texture=new f(t);this._materialLoaded.push(r);if(this._meshes.length>0){this.applyMaterial(r)}}}};a.prototype._iResolveDependencyFailure=function(e){if(e.id=="mtl"){this._mtlLib=false;this._mtlLibLoaded=false}else{var a=new D;a.materialID=e.id;this._materialLoaded.push(a)}if(this._meshes.length>0)this.applyMaterial(a)};a.prototype._pProceedParsing=function(){var e;var a=String.fromCharCode(10);var t;if(!this._startedParsing){this._textData=this._pGetTextData();this._textData=this._textData.replace(/\\[\r\n]+\s*/gm," ")}if(this._textData.indexOf(a)==-1)a=String.fromCharCode(13);if(!this._startedParsing){this._startedParsing=true;this._vertices=new Array;this._vertexNormals=new Array;this._materialIDs=new Array;this._materialLoaded=new Array;this._meshes=new Array;this._uvs=new Array;this._stringLength=this._textData.length;this._charIndex=this._textData.indexOf(a,0);this._oldIndex=0;this._objects=new Array;this._objectIndex=0}while(this._charIndex<this._stringLength&&this._pHasTime()){this._charIndex=this._textData.indexOf(a,this._oldIndex);if(this._charIndex==-1)this._charIndex=this._stringLength;e=this._textData.substring(this._oldIndex,this._charIndex);e=e.split("\r").join("");e=e.replace("  "," ");t=e.split(" ");this._oldIndex=this._charIndex+1;this.parseLine(t);if(this.parsingPaused){return l.MORE_TO_PARSE}}if(this._charIndex>=this._stringLength){if(this._mtlLib&&!this._mtlLibLoaded){return l.MORE_TO_PARSE}this.translate();this.applyMaterials();return l.PARSING_DONE}return l.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){this._pContent=new _;e.prototype._pStartParsing.call(this,a)};a.prototype.parseLine=function(e){switch(e[0]){case"mtllib":this._mtlLib=true;this._mtlLibLoaded=false;this.loadMtl(e[1]);break;case"g":this.createGroup(e);break;case"o":this.createObject(e);break;case"usemtl":if(this._mtlLib){if(!e[1])e[1]="def000";this._materialIDs.push(e[1]);this._activeMaterialID=e[1];if(this._currentGroup)this._currentGroup.materialID=this._activeMaterialID}break;case"v":this.parseVertex(e);break;case"vt":this.parseUV(e);break;case"vn":this.parseVertexNormal(e);break;case"f":this.parseFace(e)}};a.prototype.translate=function(){for(var e=0;e<this._objects.length;++e){var a=this._objects[e].groups;var t=a.length;var r;var s;var i;var n;var o;var l;var d;for(var h=0;h<t;++h){i=new c;r=a[h].materialGroups;s=r.length;for(o=0;o<s;++o)this.translateMaterialGroup(r[o],i);if(i.subGeometries.length==0)continue;this._pFinalizeAsset(i);d=new y(u.getDefaultTexture());if(this.materialMode>=2)d.mode=w.MULTI_PASS;n=new p(i,d);if(this._objects[e].name){n.name=this._objects[e].name}else if(a[h].name){n.name=a[h].name}else{n.name=""}this._meshes.push(n);if(a[h].materialID!="")d.name=a[h].materialID+"~"+n.name;else d.name=this._lastMtlID+"~"+n.name;if(n.subMeshes.length>1){for(l=1;l<n.subMeshes.length;++l)n.subMeshes[l].material=d}this._pContent.addChild(n);this._pFinalizeAsset(n)}}};a.prototype.translateMaterialGroup=function(e,a){var t=e.faces;var r;var i=t.length;var n;var o;var l=new Array;var d=new Array;var c=new Array;var _=new Array;this._realIndices=[];this._vertexIndex=0;var p;for(var u=0;u<i;++u){r=t[u];n=r.indexIds.length-1;for(p=1;p<n;++p){this.translateVertexData(r,p,l,d,_,c);this.translateVertexData(r,0,l,d,_,c);this.translateVertexData(r,p+1,l,d,_,c)}}if(l.length>0){o=new h(new s);o.autoDeriveNormals=c.length?false:true;o.setIndices(_);o.setPositions(l);o.setNormals(c);o.setUVs(d);a.addSubGeometry(o)}};a.prototype.translateVertexData=function(e,a,t,r,s,i){var n;var o;var l;var d;if(!this._realIndices[e.indexIds[a]]){n=this._vertexIndex;this._realIndices[e.indexIds[a]]=++this._vertexIndex;o=this._vertices[e.vertexIndices[a]-1];t.push(o.x*this._scale,o.y*this._scale,o.z*this._scale);if(e.normalIndices.length>0){l=this._vertexNormals[e.normalIndices[a]-1];i.push(l.x,l.y,l.z)}if(e.uvIndices.length>0){try{d=this._uvs[e.uvIndices[a]-1];r.push(d.u,d.v)}catch(h){switch(a){case 0:r.push(0,1);break;case 1:r.push(.5,0);break;case 2:r.push(1,1)}}}}else{n=this._realIndices[e.indexIds[a]]-1}s.push(n)};a.prototype.createObject=function(e){this._currentGroup=null;this._currentMaterialGroup=null;this._objects.push(this._currentObject=new v);if(e)this._currentObject.name=e[1]};a.prototype.createGroup=function(e){if(!this._currentObject)this.createObject(null);this._currentGroup=new g;this._currentGroup.materialID=this._activeMaterialID;if(e)this._currentGroup.name=e[1];this._currentObject.groups.push(this._currentGroup);this.createMaterialGroup(null)};a.prototype.createMaterialGroup=function(e){this._currentMaterialGroup=new B;if(e)this._currentMaterialGroup.url=e[1];this._currentGroup.materialGroups.push(this._currentMaterialGroup)};a.prototype.parseVertex=function(e){var a,t,r;if(e.length>4){var s=[];var i;for(var n=1;n<e.length;++n){i=parseFloat(e[n]);if(!isNaN(i))s.push(i)}a=s[0];t=s[1];r=-s[2];this._vertices.push(new j(a,t,r))}else{a=parseFloat(e[1]);t=parseFloat(e[2]);r=-parseFloat(e[3]);this._vertices.push(new j(a,t,r))}};a.prototype.parseUV=function(e){if(e.length>3){var a=[];var t;for(var r=1;r<e.length;++r){t=parseFloat(e[r]);if(!isNaN(t))a.push(t)}this._uvs.push(new P(a[0],1-a[1]))}else{this._uvs.push(new P(parseFloat(e[1]),1-parseFloat(e[2])))}};a.prototype.parseVertexNormal=function(e){if(e.length>4){var a=[];var t;for(var r=1;r<e.length;++r){t=parseFloat(e[r]);if(!isNaN(t))a.push(t)}this._vertexNormals.push(new j(a[0],a[1],-a[2]))}else{this._vertexNormals.push(new j(parseFloat(e[1]),parseFloat(e[2]),-parseFloat(e[3])))}};a.prototype.parseFace=function(e){var a=e.length;var t=new A;if(!this._currentGroup){this.createGroup(null)}var r;for(var s=1;s<a;++s){if(e[s]==""){continue}r=e[s].split("/");t.vertexIndices.push(this.parseIndex(parseInt(r[0]),this._vertices.length));if(r[1]&&String(r[1]).length>0)t.uvIndices.push(this.parseIndex(parseInt(r[1]),this._uvs.length));if(r[2]&&String(r[2]).length>0)t.normalIndices.push(this.parseIndex(parseInt(r[2]),this._vertexNormals.length));t.indexIds.push(e[s])}this._currentMaterialGroup.faces.push(t)};a.prototype.parseIndex=function(e,a){if(e<0)return e+a+1;else return e};a.prototype.parseMtl=function(e){var a=e.split("newmtl");var t;var r;var s;var i;var n;var l;var d;var h;var c;var _;var p;var u;for(var f=0;f<a.length;++f){t=a[f].split("\r").join("").split("\n");if(t.length==1)t=a[f].split(String.fromCharCode(13));d=h=c=16777215;_=0;n=false;l=false;p=1;u="";for(s=0;s<t.length;++s){t[s]=t[s].replace(/\s+$/,"");if(t[s].substring(0,1)!="#"&&(s==0||t[s]!="")){r=t[s].split(" ");if(String(r[0]).charCodeAt(0)==9||String(r[0]).charCodeAt(0)==32)r[0]=r[0].substring(1,r[0].length);if(s==0){this._lastMtlID=r.join("");this._lastMtlID=this._lastMtlID==""?"def000":this._lastMtlID}else{switch(r[0]){case"Ka":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3])))h=r[1]*255<<16|r[2]*255<<8|r[3]*255;break;case"Ks":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){c=r[1]*255<<16|r[2]*255<<8|r[3]*255;n=true}break;case"Ns":if(r[1]&&!isNaN(Number(r[1])))_=Number(r[1])*.001;if(_==0)n=false;break;case"Kd":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){d=r[1]*255<<16|r[2]*255<<8|r[3]*255;l=true}break;case"tr":case"d":if(r[1]&&!isNaN(Number(r[1])))p=Number(r[1]);break;case"map_Kd":u=this.parseMapKdString(r);u=u.replace(/\\/g,"/")}}}}if(u!=""){if(n){i=new b;i.specularColor=c;i.specular=_;var m=new k;m.alpha=p;m.basicSpecularMethod=i;m.materialID=this._lastMtlID;if(!this._materialSpecularData)this._materialSpecularData=new Array;this._materialSpecularData.push(m)}this._pAddDependency(this._lastMtlID,new o(u))}else if(l&&!isNaN(h)){var v=new D;v.materialID=this._lastMtlID;if(p==0)console.log("Warning: an alpha value of 0 was found in mtl color tag (Tr or d) ref:"+this._lastMtlID+", mesh(es) using it will be invisible!");var g;if(this.materialMode<2){g=new y(h);var B=g;B.alpha=p;B.diffuseColor=d;B.repeat=true;if(n){B.specularColor=c;B.specular=_}}else{g=new y(h);g.mode=w.MULTI_PASS;var A=g;A.diffuseColor=d;A.repeat=true;if(n){A.specularColor=c;A.specular=_}}v.cm=g;this._materialLoaded.push(v);if(this._meshes.length>0)this.applyMaterial(v)}}this._mtlLibLoaded=true};a.prototype.parseMapKdString=function(e){var a="";var t;var r;for(t=1;t<e.length;){switch(e[t]){case"-blendu":case"-blendv":case"-cc":case"-clamp":case"-texres":t+=2;break;case"-mm":t+=3;break;case"-o":case"-s":case"-t":t+=4;continue;default:r=true;break}if(r)break}for(t;t<e.length;t++){a+=e[t];a+=" "}a=a.replace(/\s+$/,"");return a};a.prototype.loadMtl=function(e){this._pAddDependency("mtl",new o(e),true);this._pPauseAndRetrieveDependencies()};a.prototype.applyMaterial=function(e){var a;var t;var r;var s;var i;for(var n=0;n<this._meshes.length;++n){t=this._meshes[n];a=t.material.name.split("~");if(a[0]==e.materialID){if(e.cm){if(t.material)t.material=null;t.material=e.cm}else if(e.texture){if(this.materialMode<2){r=t.material;r.texture=e.texture;r.color=e.color;r.alpha=e.alpha;r.repeat=true;if(e.specularMethod){r.specularMethod=null;r.specularMethod=e.specularMethod}else if(this._materialSpecularData){for(s=0;s<this._materialSpecularData.length;++s){i=this._materialSpecularData[s];if(i.materialID==e.materialID){r.specularMethod=null;r.specularMethod=i.basicSpecularMethod;r.color=i.color;r.alpha=i.alpha;break}}}}else{r=t.material;r.mode=w.MULTI_PASS;r.texture=e.texture;r.color=e.color;r.repeat=true;if(e.specularMethod){r.specularMethod=null;r.specularMethod=e.specularMethod}else if(this._materialSpecularData){for(s=0;s<this._materialSpecularData.length;++s){i=this._materialSpecularData[s];if(i.materialID==e.materialID){r.specularMethod=null;r.specularMethod=i.basicSpecularMethod;r.color=i.color;break}}}}}t.material.name=a[1]?a[1]:a[0];this._meshes.splice(n,1);--n}}if(e.cm||r)this._pFinalizeAsset(e.cm||r)};a.prototype.applyMaterials=function(){if(this._materialLoaded.length==0)return;for(var e=0;e<this._materialLoaded.length;++e)this.applyMaterial(this._materialLoaded[e])};return a}(l);var v=function(){function e(){this.groups=new Array}return e}();var g=function(){function e(){this.materialGroups=new Array}return e}();var B=function(){function e(){this.faces=new Array}return e}();var k=function(){function e(){this.color=16777215;this.alpha=1}return e}();var D=function(){function e(){this.color=16777215;this.alpha=1}return e}();var A=function(){function e(){this.vertexIndices=new Array;this.uvIndices=new Array;this.normalIndices=new Array;this.indexIds=new Array}return e}();var P=function(){function e(e,a){if(e===void 0){e=0}if(a===void 0){a=0}this._u=e;this._v=a}Object.defineProperty(e.prototype,"v",{get:function(){return this._v},set:function(e){this._v=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"u",{get:function(){return this._u},set:function(e){this._u=e},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._u,this._v)};e.prototype.toString=function(){return this._u+","+this._v};return e}();var j=function(){function e(e,a,t,r){if(e===void 0){e=0}if(a===void 0){a=0}if(t===void 0){t=0}if(r===void 0){r=0}this._x=e;this._y=a;this._z=t;this._index=r}Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(e){this._index=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(e){this._z=e},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._x,this._y,this._z)};return e}();a.exports=m},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/base/Geometry":undefined,"awayjs-display/lib/base/TriangleSubGeometry":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":undefined}],"awayjs-parsers/lib/Parsers":[function(e,a,t){var r=e("awayjs-core/lib/library/LoaderSession");var s=e("awayjs-parsers/lib/AWDParser");var i=e("awayjs-parsers/lib/Max3DSParser");var n=e("awayjs-parsers/lib/MD2Parser");var o=e("awayjs-parsers/lib/OBJParser");var l=function(){function e(){}e.enableAllBundled=function(){r.enableParsers(e.ALL_BUNDLED)};e.ALL_BUNDLED=Array(s,i,n,o);return e}();a.exports=l},{"awayjs-core/lib/library/LoaderSession":undefined,"awayjs-parsers/lib/AWDParser":"awayjs-parsers/lib/AWDParser","awayjs-parsers/lib/MD2Parser":"awayjs-parsers/lib/MD2Parser","awayjs-parsers/lib/Max3DSParser":"awayjs-parsers/lib/Max3DSParser","awayjs-parsers/lib/OBJParser":"awayjs-parsers/lib/OBJParser"}]},{},[]);



//# sourceMappingURL=awayjs-dist-require.js.map
(function e(t,i,o){function n(r,a){if(!i[r]){if(!t[r]){var l=typeof require=="function"&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return n(i?i:e)},c,c.exports,e,t,i,o)}return i[r].exports}var s=typeof require=="function"&&require;for(var r=0;r<o.length;r++)n(o[r]);return n})({"./src/AWD3Viewer.ts":[function(e,t,i){var o=e("awayjs-core/lib/library/AssetLibrary");var n=e("awayjs-core/lib/events/AssetEvent");var s=e("awayjs-core/lib/net/URLRequest");var r=e("awayjs-core/lib/events/LoaderEvent");var a=e("awayjs-core/lib/projections/OrthographicProjection");var l=e("awayjs-core/lib/utils/RequestAnimationFrame");var h=e("awayjs-display/lib/containers/View");var c=e("awayjs-display/lib/entities/Mesh");var p=e("awayjs-display/lib/entities/Billboard");var d=e("awayjs-display/lib/controllers/HoverController");var _=e("awayjs-display/lib/containers/Loader");var u=e("awayjs-player/lib/renderer/Renderer2D");var y=e("awayjs-parsers/lib/AWDParser");var v=e("awayjs-player/lib/partition/Partition2D");var w=e("awayjs-player/lib/display/MovieClip");var f=e("awayjs-core/lib/projections/CoordinateSystem");var m=e("awayjs-core/lib/projections/PerspectiveProjection");var j=e("awayjs-display/lib/entities/Camera");var b=e("awayjs-display/lib/entities/TextField");var g=function(){function e(){this._time=0;this.init()}e.prototype.init=function(){var e=this;this.initEngine();var t=document.createElement("div");t.style.cssFloat="none";t.style.position="absolute";t.style.bottom="30px";t.style.width="600px";t.style.left="50%";t.style.marginLeft="-300px";t.style.padding="20px";t.style.textAlign="center";var i=document.createElement("div");i.style.cssFloat="none";i.style.position="absolute";i.style.bottom="0px";i.style.width="600px";i.style.left="50%";i.style.marginLeft="-300px";i.style.padding="20px";i.style.textAlign="center";this.loaded_display_objects=new Array;this.dropDown=document.createElement("select");this.dropDown.name="selectTestDropDown";this.dropDown.id="selectTest";this.previousBtn=document.createElement("button");this.previousBtn.innerHTML="<<";this.previousBtn.id="previous";this.nextBtn=document.createElement("button");this.nextBtn.innerHTML=">>";this.nextBtn.id="next";this.playBtn=document.createElement("button");this.playBtn.innerHTML="||";this.playBtn.id="previous";this.stopBtn=document.createElement("button");this.stopBtn.innerHTML="stop";this.stopBtn.id="previous";t.appendChild(this.previousBtn);t.appendChild(this.dropDown);t.appendChild(this.nextBtn);i.appendChild(this.playBtn);i.appendChild(this.stopBtn);document.body.appendChild(t);document.body.appendChild(i);this.dropDown.onchange=function(t){return e.dropDownChange(t)};this.previousBtn.onclick=function(){return e.nagigateBy(-1)};this.nextBtn.onclick=function(){return e.nagigateBy(1)};this.playBtn.onclick=function(){return e.toggle_playback()};this.stopBtn.onclick=function(){return e.stop_playback()};this.initObjects();this.initListeners()};e.prototype.dropDownChange=function(e){this.dropDown.options[this.dropDown.selectedIndex].value;this.counter=this.dropDown.selectedIndex;var t=parseInt(this.dropDown.options[this.dropDown.selectedIndex].value);if(!isNaN(t)){this.navigateToSection(this.loaded_display_objects[t])}};e.prototype.stop_playback=function(){this.playBtn.innerHTML="play";this._rootTimeLine.stop();this._rootTimeLine.currentFrameIndex=0};e.prototype.toggle_playback=function(){if(this.playBtn.innerHTML=="||"){this.playBtn.innerHTML="play";this._rootTimeLine.stop()}else if(this.playBtn.innerHTML=="play"){this.playBtn.innerHTML="||";this._rootTimeLine.play()}};e.prototype.nagigateBy=function(e){if(e===void 0){e=1}var t=this.loaded_display_objects.length;var i=this.counter+e;if(i<0){i=this.loaded_display_objects.length-1}else if(i>this.loaded_display_objects.length-1){i=0}var o=this.loaded_display_objects[i];this.navigateToSection(o);this.dropDown.selectedIndex=i;this.counter=i};e.prototype.navigateToSection=function(e){this.playBtn.innerHTML="||";console.log(e.name);var t=this._view.scene.numChildren;while(t--){this._view.scene.removeChildAt(t)}this._view.scene.addChild(e);e.visible=true;e.currentFrameIndex=0;e.play();this._rootTimeLine=e;console.log("added child = ",e.name)};e.prototype.init_dropDown=function(){for(var e=0;e<this.loaded_display_objects.length;e++){var t=new Option(this.loaded_display_objects[e].name,String(e));this.dropDown.add(t)}this.counter=this.loaded_display_objects.length-1;this.dropDown.selectedIndex=this.loaded_display_objects.length-1};e.prototype.initEngine=function(){this._view=new h(new u);this._view.backgroundColor=16777215;this._stage_width=550;this._stage_height=400;this._isperspective=true;this._projection=new m;this._projection.coordinateSystem=f.RIGHT_HANDED;this._projection.focalLength=1e3;this._projection.preserveFocalLength=true;this._projection.originX=.5;this._projection.originY=.5;this._camera_perspective=new j;this._camera_perspective.projection=this._projection;this._hoverControl=new d(this._camera_perspective,null,180,0,1e3);this._ortho_projection=new a(500);this._ortho_projection.coordinateSystem=f.RIGHT_HANDED;this._ortho_projection.far=5e5;this._ortho_projection.near=.1;this._ortho_projection.originX=.5;this._ortho_projection.originY=.5;this._camera_ortho=new j;this._camera_ortho.projection=this._ortho_projection;this._view.camera=this._camera_perspective;this._camera_ortho.x=0;this._camera_ortho.y=0;this._camera_ortho.scaleY=-1;this._camera_ortho.z=0};e.prototype.initObjects=function(){var e=this;o.enableParser(y);var t=new _;t.addEventListener(n.ASSET_COMPLETE,function(t){return e.onAssetComplete(t)});t.addEventListener(r.RESOURCE_COMPLETE,function(t){return e.onRessourceComplete(t)});t.load(new s("assets/AWD3/AwayJEscher.awd"))};e.prototype.initListeners=function(){var e=this;window.onresize=function(t){return e.onResize(t)};document.onkeydown=function(t){return e.onKeyDown(t)};document.onmousedown=function(t){return e.onMouseDown(t)};document.onmouseup=function(t){return e.onMouseUp(t)};document.onmousemove=function(t){return e.onMouseMove(t)};document.onmousewheel=function(t){return e.onMouseWheel(t)};this.onResize();this._timer=new l(this.onEnterFrame,this);this._timer.start()};e.prototype.onAssetComplete=function(e){if(e.asset.isAsset(b)){var t=e.asset}else if(e.asset.isAsset(c)){var i=e.asset}else if(e.asset.isAsset(p)){var o=e.asset}else if(e.asset.isAsset(w)){var n=e.asset;this.loaded_display_objects.push(n);this._rootTimeLine=n;this._rootTimeLine.partition=new v(this._rootTimeLine)}};e.prototype.onRessourceComplete=function(e){if(this._rootTimeLine){this._view.scene.addChild(this._rootTimeLine);this._rootTimeLine.x=-this._stage_width/2;this._rootTimeLine.y=-this._stage_height/2}this.init_dropDown()};e.prototype.onEnterFrame=function(e){this._time+=e;if(this._rootTimeLine!=undefined){this._rootTimeLine.update(e)}this._view.render()};e.prototype.onKeyDown=function(e){console.log("keycode = "+e.keyCode);if(e.keyCode==80){this._isperspective=true;this._view.camera=this._camera_perspective}if(e.keyCode==79){this._isperspective=false;this._view.camera=this._camera_ortho}if(e.keyCode==81){if(this._isperspective){this._hoverControl.distance+=5}else{this._ortho_projection.projectionHeight+=5}}else if(e.keyCode==87){if(this._isperspective){this._hoverControl.distance-=5}else{this._ortho_projection.projectionHeight-=5}}if(e.keyCode==65){if(this._isperspective){this._hoverControl.distance+=50}else{this._ortho_projection.projectionHeight+=50}}else if(e.keyCode==83){if(this._isperspective){this._hoverControl.distance-=50}else{this._ortho_projection.projectionHeight-=50}}};e.prototype.onMouseDown=function(e){this._lastPanAngle=this._hoverControl.panAngle;this._lastTiltAngle=this._hoverControl.tiltAngle;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY;this._move=true};e.prototype.onMouseUp=function(e){this._move=false};e.prototype.onMouseMove=function(e){if(this._move){if(this._isperspective){this._hoverControl.panAngle=.3*(e.clientX-this._lastMouseX)+this._lastPanAngle;this._hoverControl.tiltAngle=-.3*(e.clientY-this._lastMouseY)+this._lastTiltAngle}else{if(e.clientX>this._lastMouseX+10)this._camera_ortho.x-=10;else if(e.clientX>this._lastMouseX)this._camera_ortho.x--;else if(e.clientX<this._lastMouseX-10)this._camera_ortho.x+=10;else if(e.clientX<this._lastMouseX)this._camera_ortho.x++;if(e.clientY>this._lastMouseY+10)this._camera_ortho.y-=10;else if(e.clientY>this._lastMouseY)this._camera_ortho.y--;else if(e.clientY<this._lastMouseY-10)this._camera_ortho.y+=10;else if(e.clientY<this._lastMouseY)this._camera_ortho.y++;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY}}};e.prototype.onMouseWheel=function(e){if(this._isperspective){this._hoverControl.distance-=e.wheelDelta*5;if(this._hoverControl.distance<100){this._hoverControl.distance=100}}else{this._ortho_projection.projectionHeight-=e.wheelDelta*5;if(this._ortho_projection.projectionHeight<5){this._ortho_projection.projectionHeight=5}}};e.prototype.onResize=function(e){if(e===void 0){e=null}this._view.y=0;this._view.x=0;this._view.width=window.innerWidth;this._view.height=window.innerHeight};return e}();window.onload=function(){new g}},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/projections/CoordinateSystem":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-display/lib/containers/Loader":undefined,"awayjs-display/lib/containers/View":undefined,"awayjs-display/lib/controllers/HoverController":undefined,"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/TextField":undefined,"awayjs-parsers/lib/AWDParser":undefined,"awayjs-player/lib/display/MovieClip":undefined,"awayjs-player/lib/partition/Partition2D":undefined,"awayjs-player/lib/renderer/Renderer2D":undefined}]},{},["./src/AWD3Viewer.ts"]);

//# sourceMappingURL=AWD3Viewer.js.map
(function e(t,i,o){function r(n,a){if(!i[n]){if(!t[n]){var h=typeof require=="function"&&require;if(!a&&h)return h(n,!0);if(s)return s(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[n]={exports:{}};t[n][0].call(l.exports,function(e){var i=t[n][1][e];return r(i?i:e)},l,l.exports,e,t,i,o)}return i[n].exports}var s=typeof require=="function"&&require;for(var n=0;n<o.length;n++)r(o[n]);return r})({1:[function(e,t,i){var o=e("awayjs-core/lib/library/AssetLibrary");var r=e("awayjs-core/lib/library/AssetType");var s=e("awayjs-core/lib/events/AssetEvent");var n=e("awayjs-core/lib/net/URLRequest");var a=e("awayjs-core/lib/events/LoaderEvent");var h=e("awayjs-core/lib/projections/OrthographicProjection");var c=e("awayjs-core/lib/utils/RequestAnimationFrame");var l=e("awayjs-display/lib/containers/View");var _=e("awayjs-display/lib/controllers/HoverController");var p=e("awayjs-display/lib/containers/Loader");var u=e("awayjs-renderergl/lib/DefaultRenderer");var d=e("awayjs-parsers/lib/AWDParser");var f=e("awayjs-player/lib/fl/partition/Partition2D");var y=e("awayjs-core/lib/projections/CoordinateSystem");var v=e("awayjs-core/lib/projections/PerspectiveProjection");var w=e("awayjs-display/lib/entities/Camera");var j=function(){function e(){this._time=0;this.init()}e.prototype.init=function(){this.initEngine();this.initObjects();this.initListeners()};e.prototype.initEngine=function(){this._view=new l(new u);this._view.backgroundColor=16777215;this._stage_width=550;this._stage_height=400;this._isperspective=true;this._projection=new v;this._projection.coordinateSystem=y.RIGHT_HANDED;this._projection.focalLength=1e3;this._projection.preserveFocalLength=true;this._projection.originX=.5;this._projection.originY=.5;this._camera_perspective=new w;this._camera_perspective.projection=this._projection;this._hoverControl=new _(this._camera_perspective,null,180,0,1e3);this._ortho_projection=new h(500);this._ortho_projection.coordinateSystem=y.RIGHT_HANDED;this._ortho_projection.far=5e5;this._ortho_projection.near=.1;this._ortho_projection.originX=.5;this._ortho_projection.originY=.5;this._camera_ortho=new w;this._camera_ortho.projection=this._ortho_projection;this._view.camera=this._camera_perspective;this._camera_ortho.x=0;this._camera_ortho.y=0;this._camera_ortho.scaleY=-1;this._camera_ortho.z=0};e.prototype.initObjects=function(){var e=this;o.enableParser(d);var t=new p;t.addEventListener(s.ASSET_COMPLETE,function(t){return e.onAssetComplete(t)});t.addEventListener(a.RESOURCE_COMPLETE,function(t){return e.onRessourceComplete(t)});t.load(new n("assets/AWD3/ScareCrow.awd"))};e.prototype.initListeners=function(){var e=this;window.onresize=function(t){return e.onResize(t)};document.onkeydown=function(t){return e.onKeyDown(t)};document.onmousedown=function(t){return e.onMouseDown(t)};document.onmouseup=function(t){return e.onMouseUp(t)};document.onmousemove=function(t){return e.onMouseMove(t)};document.onmousewheel=function(t){return e.onMouseWheel(t)};this.onResize();this._timer=new c(this.onEnterFrame,this);this._timer.start()};e.prototype.onAssetComplete=function(e){if(e.asset.assetType==r.TIMELINE){this._rootTimeLine=e.asset;this._rootTimeLine.partition=new f(this._rootTimeLine)}};e.prototype.onRessourceComplete=function(e){if(this._rootTimeLine){this._view.scene.addChild(this._rootTimeLine);this._rootTimeLine.x=-this._stage_width/2;this._rootTimeLine.y=-this._stage_height/2}};e.prototype.onEnterFrame=function(e){this._time+=e;if(this._rootTimeLine!=undefined){this._rootTimeLine.update(e)}this._view.render()};e.prototype.onKeyDown=function(e){console.log("keycode = "+e.keyCode);if(e.keyCode==80){this._isperspective=true;this._view.camera=this._camera_perspective}if(e.keyCode==79){this._isperspective=false;this._view.camera=this._camera_ortho}if(e.keyCode==81){if(this._isperspective){this._hoverControl.distance+=5}else{this._ortho_projection.projectionHeight+=5}}else if(e.keyCode==87){if(this._isperspective){this._hoverControl.distance-=5}else{this._ortho_projection.projectionHeight-=5}}if(e.keyCode==65){if(this._isperspective){this._hoverControl.distance+=50}else{this._ortho_projection.projectionHeight+=50}}else if(e.keyCode==83){if(this._isperspective){this._hoverControl.distance-=50}else{this._ortho_projection.projectionHeight-=50}}};e.prototype.onMouseDown=function(e){this._lastPanAngle=this._hoverControl.panAngle;this._lastTiltAngle=this._hoverControl.tiltAngle;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY;this._move=true};e.prototype.onMouseUp=function(e){this._move=false};e.prototype.onMouseMove=function(e){if(this._move){if(this._isperspective){this._hoverControl.panAngle=.3*(e.clientX-this._lastMouseX)+this._lastPanAngle;this._hoverControl.tiltAngle=-.3*(e.clientY-this._lastMouseY)+this._lastTiltAngle}else{if(e.clientX>this._lastMouseX+10)this._camera_ortho.x-=10;else if(e.clientX>this._lastMouseX)this._camera_ortho.x--;else if(e.clientX<this._lastMouseX-10)this._camera_ortho.x+=10;else if(e.clientX<this._lastMouseX)this._camera_ortho.x++;if(e.clientY>this._lastMouseY+10)this._camera_ortho.y-=10;else if(e.clientY>this._lastMouseY)this._camera_ortho.y--;else if(e.clientY<this._lastMouseY-10)this._camera_ortho.y+=10;else if(e.clientY<this._lastMouseY)this._camera_ortho.y++;this._lastMouseX=e.clientX;this._lastMouseY=e.clientY}}};e.prototype.onMouseWheel=function(e){if(this._isperspective){this._hoverControl.distance-=e.wheelDelta*5;if(this._hoverControl.distance<100){this._hoverControl.distance=100}}else{this._ortho_projection.projectionHeight-=e.wheelDelta*5;if(this._ortho_projection.projectionHeight<5){this._ortho_projection.projectionHeight=5}}};e.prototype.onResize=function(e){if(e===void 0){e=null}this._view.y=0;this._view.x=0;this._view.width=window.innerWidth;this._view.height=window.innerHeight};return e}();window.onload=function(){new j}},{"awayjs-core/lib/events/AssetEvent":undefined,"awayjs-core/lib/events/LoaderEvent":undefined,"awayjs-core/lib/library/AssetLibrary":undefined,"awayjs-core/lib/library/AssetType":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/projections/CoordinateSystem":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/utils/RequestAnimationFrame":undefined,"awayjs-display/lib/containers/Loader":undefined,"awayjs-display/lib/containers/View":undefined,"awayjs-display/lib/controllers/HoverController":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-parsers/lib/AWDParser":undefined,"awayjs-player/lib/fl/partition/Partition2D":undefined,"awayjs-renderergl/lib/DefaultRenderer":undefined}]},{},[1]);

//# sourceMappingURL=AWD3Viewer.js.map
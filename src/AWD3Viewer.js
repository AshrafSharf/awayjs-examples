/*

AWD3 file loading example in AwayJS

Demonstrates:

How to use the Loader object to load an embedded internal awd model.

Code by Rob Bateman
rob@infiniteturtles.co.uk
http://www.infiniteturtles.co.uk

This code is distributed under the MIT License

Copyright (c) The Away Foundation http://www.theawayfoundation.org

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
var AssetLibrary = require("awayjs-core/lib/library/AssetLibrary");
var AssetType = require("awayjs-core/lib/library/AssetType");
var AssetEvent = require("awayjs-core/lib/events/AssetEvent");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var LoaderEvent = require("awayjs-core/lib/events/LoaderEvent");
var OrthographicProjection = require("awayjs-core/lib/projections/OrthographicProjection");
var RequestAnimationFrame = require("awayjs-core/lib/utils/RequestAnimationFrame");
var View = require("awayjs-display/lib/containers/View");
var Loader = require("awayjs-display/lib/containers/Loader");
var RenderableNullSort = require("awayjs-display/lib/sort/RenderableNullSort");
var DefaultRenderer = require("awayjs-renderergl/lib/DefaultRenderer");
var MethodRendererPool = require("awayjs-methodmaterials/lib/pool/MethodRendererPool");
var AWDParser = require("awayjs-parsers/lib/AWDParser");
var Partition2D = require("awayjs-player/lib/fl/partition/Partition2D");
var AWD3Viewer = (function () {
    /**
     * Constructor
     */
    function AWD3Viewer() {
        this._time = 0;
        this.init();
    }
    /**
     * Global initialise function
     */
    AWD3Viewer.prototype.init = function () {
        this.initEngine();
        this.initObjects();
        this.initListeners();
    };
    /**
     * Initialise the engine
     */
    AWD3Viewer.prototype.initEngine = function () {
        //create the view
        this._view = new View(new DefaultRenderer(MethodRendererPool));
        this._view.renderer.renderableSorter = new RenderableNullSort();
        this._view.backgroundColor = 0xffffff;
        this._view.camera.projection = new OrthographicProjection(500);
        this._view.camera.projection.far = 500000;
        this._view.camera.projection.near = 0.1;
        this._view.camera.x = 0;
        this._view.camera.y = 0;
        this._view.camera.z = 300;
        this._view.camera.rotationX = -180;
        this._view.camera.rotationY = 0;
        this._view.camera.rotationZ = -180;
        //create custom lens
        // this._view.camera.projection = new OrthographicOffCenterProjection(0, 550, -400, 0);
        //  this._view.camera.projection.far = 500000;
        //  this._view.camera.projection.near = 0.1;
        /*
            //setup controller to be used on the camera
            this._cameraController = new HoverController(this._view.camera, null, 0, 0, 300, 10, 90);
            this._cameraController.lookAtPosition = new Vector3D(0, 50, 0);
            this._cameraController.tiltAngle = 0;
            this._cameraController.panAngle = 0;
            this._cameraController.minTiltAngle = 5;
            this._cameraController.maxTiltAngle = 60;
            this._cameraController.autoUpdate = false;
        */
    };
    /**
     * Initialise the scene objects
     */
    AWD3Viewer.prototype.initObjects = function () {
        var _this = this;
        AssetLibrary.enableParser(AWDParser);
        //kickoff asset loading
        var loader = new Loader();
        loader.addEventListener(AssetEvent.ASSET_COMPLETE, function (event) { return _this.onAssetComplete(event); });
        loader.addEventListener(LoaderEvent.RESOURCE_COMPLETE, function (event) { return _this.onRessourceComplete(event); });
        //loader.load(new URLRequest(document.getElementById("awdPath").innerHTML));
        loader.load(new URLRequest("assets/AWD3/ScareCrow.awd"));
        //loader.load(new URLRequest("assets/AWD3/NestedTween.awd"));
        //loader.load(new URLRequest("assets/AWD3/SimpleShape.awd"));
        //loader.load(new URLRequest("assets/AWD3/ComplexShape.awd"));
        //loader.load(new URLRequest("assets/AWD3/Simple_mask_test.awd"));
    };
    /**
     * Initialise the listeners
     */
    AWD3Viewer.prototype.initListeners = function () {
        var _this = this;
        window.onresize = function (event) { return _this.onResize(event); };
        document.onkeydown = function (event) { return _this.onKeyDown(event); };
        document.onmousedown = function (event) { return _this.onMouseDown(event); };
        document.onmouseup = function (event) { return _this.onMouseUp(event); };
        document.onmousemove = function (event) { return _this.onMouseMove(event); };
        document.onmousewheel = function (event) { return _this.onMouseWheel(event); };
        this.onResize();
        this._timer = new RequestAnimationFrame(this.onEnterFrame, this);
        this._timer.start();
    };
    /**
     * loader listener for asset complete events
     */
    AWD3Viewer.prototype.onAssetComplete = function (event) {
        if (event.asset.assetType == AssetType.TIMELINE) {
            this._rootTimeLine = event.asset;
            this._rootTimeLine.partition = new Partition2D(this._rootTimeLine);
        }
    };
    /**
     * loader listener for asset complete events
     */
    AWD3Viewer.prototype.onRessourceComplete = function (event) {
        if (this._rootTimeLine) {
            //console.log("LOADING A ROOT name = " + this._rootTimeLine.name + " duration=" + this._rootTimeLine.duration);
            this._view.scene.addChild(this._rootTimeLine);
        }
    };
    /**
     * Render loop
     */
    AWD3Viewer.prototype.onEnterFrame = function (dt) {
        this._time += dt;
        //update camera controler
        // this._cameraController.update();
        if (this._rootTimeLine != undefined) {
            //console.log("RENDER = ");
            this._rootTimeLine.update(dt);
        }
        //console.log("RENDER = ");
        //update view
        this._view.render();
    };
    AWD3Viewer.prototype.onKeyDown = function (event) {
        if (event.keyCode == 109) {
            var test = this._view.camera.projection;
            test.projectionHeight += 5;
        }
        else if (event.keyCode == 107) {
            var test = this._view.camera.projection;
            test.projectionHeight -= 5;
        }
    };
    AWD3Viewer.prototype.onMouseDown = function (event) {
        /*  this._lastPanAngle = this._cameraController.panAngle;
          this._lastTiltAngle = this._cameraController.tiltAngle;
          this._move = true;*/
        this._lastMouseX = event.clientX;
        this._lastMouseY = event.clientY;
        this._move = true;
    };
    AWD3Viewer.prototype.onMouseUp = function (event) {
        this._move = false;
    };
    AWD3Viewer.prototype.onMouseMove = function (event) {
        if (this._move) {
            if (event.clientX > (this._lastMouseX + 10))
                this._view.camera.x += 10;
            else if (event.clientX > this._lastMouseX)
                this._view.camera.x++;
            else if (event.clientX < (this._lastMouseX - 10))
                this._view.camera.x -= 10;
            else if (event.clientX < this._lastMouseX)
                this._view.camera.x--;
            if (event.clientY > (this._lastMouseY + 10))
                this._view.camera.y += 10;
            else if (event.clientY > this._lastMouseY)
                this._view.camera.y++;
            else if (event.clientY < (this._lastMouseY - 10))
                this._view.camera.y -= 10;
            else if (event.clientY < this._lastMouseY)
                this._view.camera.y--;
            this._lastMouseX = event.clientX;
            this._lastMouseY = event.clientY;
        }
    };
    AWD3Viewer.prototype.onMouseWheel = function (event) {
        /* this._cameraController.distance -= event.wheelDelta * 5;
     
         if (this._cameraController.distance < 100) {
           this._cameraController.distance = 100;
         } else if (this._cameraController.distance > 2000) {
           this._cameraController.distance = 2000;
         }
         */
    };
    AWD3Viewer.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this._view.y = 0;
        this._view.x = 0;
        this._view.width = window.innerWidth;
        this._view.height = window.innerHeight;
    };
    return AWD3Viewer;
})();
window.onload = function () {
    new AWD3Viewer();
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9BV0QzVmlld2VyLnRzIl0sIm5hbWVzIjpbIkFXRDNWaWV3ZXIiLCJBV0QzVmlld2VyLmNvbnN0cnVjdG9yIiwiQVdEM1ZpZXdlci5pbml0IiwiQVdEM1ZpZXdlci5pbml0RW5naW5lIiwiQVdEM1ZpZXdlci5pbml0T2JqZWN0cyIsIkFXRDNWaWV3ZXIuaW5pdExpc3RlbmVycyIsIkFXRDNWaWV3ZXIub25Bc3NldENvbXBsZXRlIiwiQVdEM1ZpZXdlci5vblJlc3NvdXJjZUNvbXBsZXRlIiwiQVdEM1ZpZXdlci5vbkVudGVyRnJhbWUiLCJBV0QzVmlld2VyLm9uS2V5RG93biIsIkFXRDNWaWV3ZXIub25Nb3VzZURvd24iLCJBV0QzVmlld2VyLm9uTW91c2VVcCIsIkFXRDNWaWV3ZXIub25Nb3VzZU1vdmUiLCJBV0QzVmlld2VyLm9uTW91c2VXaGVlbCIsIkFXRDNWaWV3ZXIub25SZXNpemUiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBa0NFO0FBRUYsSUFBTyxZQUFZLFdBQWUsc0NBQXNDLENBQUMsQ0FBQztBQUMxRSxJQUFPLFNBQVMsV0FBZSxtQ0FBbUMsQ0FBQyxDQUFDO0FBQ3BFLElBQU8sVUFBVSxXQUFlLG1DQUFtQyxDQUFDLENBQUM7QUFDckUsSUFBTyxVQUFVLFdBQWUsZ0NBQWdDLENBQUMsQ0FBQztBQUNsRSxJQUFPLFdBQVcsV0FBZSxvQ0FBb0MsQ0FBQyxDQUFDO0FBR3ZFLElBQU8sc0JBQXNCLFdBQVksb0RBQW9ELENBQUMsQ0FBQztBQUUvRixJQUFPLHFCQUFxQixXQUFZLDZDQUE2QyxDQUFDLENBQUM7QUFFdkYsSUFBTyxJQUFJLFdBQWlCLG9DQUFvQyxDQUFDLENBQUM7QUFLbEUsSUFBTyxNQUFNLFdBQWdCLHNDQUFzQyxDQUFDLENBQUM7QUFFckUsSUFBTyxrQkFBa0IsV0FBYSw0Q0FBNEMsQ0FBQyxDQUFDO0FBR3BGLElBQU8sZUFBZSxXQUFjLHVDQUF1QyxDQUFDLENBQUM7QUFHN0UsSUFBTyxrQkFBa0IsV0FBYSxvREFBb0QsQ0FBQyxDQUFDO0FBRTVGLElBQU8sU0FBUyxXQUFlLDhCQUE4QixDQUFDLENBQUM7QUFDL0QsSUFBTyxXQUFXLFdBQWUsNENBQTRDLENBQUMsQ0FBQztBQUcvRSxJQUFNLFVBQVU7SUFlZEE7O09BRUdBO0lBQ0hBLFNBbEJJQSxVQUFVQTtRQVFOQyxVQUFLQSxHQUFXQSxDQUFDQSxDQUFDQTtRQVl4QkEsSUFBSUEsQ0FBQ0EsSUFBSUEsRUFBRUEsQ0FBQ0E7SUFDZEEsQ0FBQ0E7SUFFREQ7O09BRUdBO0lBQ0tBLHlCQUFJQSxHQUFaQTtRQUVFRSxJQUFJQSxDQUFDQSxVQUFVQSxFQUFFQSxDQUFDQTtRQUNsQkEsSUFBSUEsQ0FBQ0EsV0FBV0EsRUFBRUEsQ0FBQ0E7UUFDbkJBLElBQUlBLENBQUNBLGFBQWFBLEVBQUVBLENBQUNBO0lBQ3ZCQSxDQUFDQTtJQUVERjs7T0FFR0E7SUFDS0EsK0JBQVVBLEdBQWxCQTtRQUVFRyxBQUNBQSxpQkFEaUJBO1FBQ2pCQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxJQUFJQSxDQUFDQSxJQUFJQSxlQUFlQSxDQUFDQSxrQkFBa0JBLENBQUNBLENBQUNBLENBQUNBO1FBQy9EQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxRQUFRQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLElBQUlBLGtCQUFrQkEsRUFBRUEsQ0FBQ0E7UUFDaEVBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLGVBQWVBLEdBQUdBLFFBQVFBLENBQUNBO1FBRXBDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxzQkFBc0JBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQy9EQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxDQUFDQSxHQUFHQSxHQUFHQSxNQUFNQSxDQUFDQTtRQUMxQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsR0FBR0EsR0FBR0EsQ0FBQ0E7UUFDeENBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLENBQUNBO1FBQ3RCQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxDQUFDQTtRQUN0QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDeEJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLFNBQVNBLEdBQUNBLENBQUNBLEdBQUdBLENBQUNBO1FBQ2pDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxTQUFTQSxHQUFDQSxDQUFDQSxDQUFDQTtRQUM5QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsU0FBU0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0E7UUFDbkNBLG9CQUFvQkE7UUFDckJBLHVGQUF1RkE7UUFDeEZBLDhDQUE4Q0E7UUFDOUNBLDRDQUE0Q0E7UUFFOUNBOzs7Ozs7Ozs7VUFTRUE7SUFDQUEsQ0FBQ0E7SUFFREg7O09BRUdBO0lBQ0tBLGdDQUFXQSxHQUFuQkE7UUFBQUksaUJBZ0JDQTtRQWRDQSxZQUFZQSxDQUFDQSxZQUFZQSxDQUFDQSxTQUFTQSxDQUFDQSxDQUFDQTtRQUVyQ0EsQUFDQUEsdUJBRHVCQTtZQUNuQkEsTUFBTUEsR0FBVUEsSUFBSUEsTUFBTUEsRUFBRUEsQ0FBQ0E7UUFDakNBLE1BQU1BLENBQUNBLGdCQUFnQkEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsY0FBY0EsRUFBRUEsVUFBQ0EsS0FBaUJBLElBQUtBLE9BQUFBLEtBQUlBLENBQUNBLGVBQWVBLENBQUNBLEtBQUtBLENBQUNBLEVBQTNCQSxDQUEyQkEsQ0FBQ0EsQ0FBQ0E7UUFDdkdBLE1BQU1BLENBQUNBLGdCQUFnQkEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsaUJBQWlCQSxFQUFFQSxVQUFDQSxLQUFrQkEsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxLQUFLQSxDQUFDQSxFQUEvQkEsQ0FBK0JBLENBQUNBLENBQUNBO1FBR2hIQSxBQUNBQSw0RUFENEVBO1FBQzVFQSxNQUFNQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxVQUFVQSxDQUFDQSwyQkFBMkJBLENBQUNBLENBQUNBLENBQUNBO1FBQ3pEQSw2REFBNkRBO1FBQzdEQSw2REFBNkRBO1FBQzdEQSw4REFBOERBO1FBQzlEQSxrRUFBa0VBO0lBQ3BFQSxDQUFDQTtJQUVESjs7T0FFR0E7SUFDS0Esa0NBQWFBLEdBQXJCQTtRQUFBSyxpQkFjQ0E7UUFaQ0EsTUFBTUEsQ0FBQ0EsUUFBUUEsR0FBSUEsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBcEJBLENBQW9CQSxDQUFDQTtRQUVqREEsUUFBUUEsQ0FBQ0EsU0FBU0EsR0FBR0EsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBckJBLENBQXFCQSxDQUFDQTtRQUN4REEsUUFBUUEsQ0FBQ0EsV0FBV0EsR0FBR0EsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBdkJBLENBQXVCQSxDQUFDQTtRQUMxREEsUUFBUUEsQ0FBQ0EsU0FBU0EsR0FBR0EsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBckJBLENBQXFCQSxDQUFDQTtRQUN0REEsUUFBUUEsQ0FBQ0EsV0FBV0EsR0FBR0EsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBdkJBLENBQXVCQSxDQUFDQTtRQUMxREEsUUFBUUEsQ0FBQ0EsWUFBWUEsR0FBR0EsVUFBQ0EsS0FBS0EsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBeEJBLENBQXdCQSxDQUFDQTtRQUU1REEsSUFBSUEsQ0FBQ0EsUUFBUUEsRUFBRUEsQ0FBQ0E7UUFFaEJBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLElBQUlBLHFCQUFxQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDakVBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO0lBQ3RCQSxDQUFDQTtJQUVETDs7T0FFR0E7SUFDS0Esb0NBQWVBLEdBQXZCQSxVQUF3QkEsS0FBaUJBO1FBRXZDTSxFQUFFQSxDQUFBQSxDQUFDQSxLQUFLQSxDQUFDQSxLQUFLQSxDQUFDQSxTQUFTQSxJQUFJQSxTQUFTQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUMvQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsR0FBZUEsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0E7WUFDM0NBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFNBQVNBLEdBQUdBLElBQUlBLFdBQVdBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBO1FBQ3ZFQSxDQUFDQTtJQUNIQSxDQUFDQTtJQUVETjs7T0FFR0E7SUFDS0Esd0NBQW1CQSxHQUEzQkEsVUFBNEJBLEtBQWtCQTtRQUM1Q08sRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdkJBLEFBQ0FBLCtHQUQrR0E7WUFDL0dBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLEtBQUtBLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLENBQUNBO1FBR2hEQSxDQUFDQTtJQUNIQSxDQUFDQTtJQUVEUDs7T0FFR0E7SUFDS0EsaUNBQVlBLEdBQXBCQSxVQUFxQkEsRUFBVUE7UUFDN0JRLElBQUlBLENBQUNBLEtBQUtBLElBQUlBLEVBQUVBLENBQUNBO1FBRWpCQSxBQUdBQSx5QkFIeUJBO1FBQzFCQSxtQ0FBbUNBO1FBRWxDQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxhQUFhQSxJQUFJQSxTQUFTQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNwQ0EsQUFDQUEsMkJBRDJCQTtZQUMzQkEsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0E7UUFDaENBLENBQUNBO1FBQ0RBLEFBRUFBLDJCQUYyQkE7UUFDM0JBLGFBQWFBO1FBQ2JBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBO0lBQ3RCQSxDQUFDQTtJQUVTUiw4QkFBU0EsR0FBakJBLFVBQWtCQSxLQUFLQTtRQUNuQlMsRUFBRUEsQ0FBQUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsT0FBT0EsSUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7WUFDbkJBLElBQUlBLElBQUlBLEdBQW1EQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxDQUFDQTtZQUN4RkEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxJQUFFQSxDQUFDQSxDQUFDQTtRQUM3QkEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsT0FBT0EsSUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQUEsQ0FBQ0E7WUFDeEJBLElBQUlBLElBQUlBLEdBQW1EQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQSxVQUFVQSxDQUFDQTtZQUN4RkEsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxJQUFFQSxDQUFDQSxDQUFDQTtRQUM3QkEsQ0FBQ0E7SUFDTEEsQ0FBQ0E7SUFFS1QsZ0NBQVdBLEdBQW5CQSxVQUFvQkEsS0FBS0E7UUFFekJVLEFBR0VBOzs4QkFEb0JBO1FBQ3BCQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQTtRQUNqQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsQ0FBQ0EsT0FBT0EsQ0FBQ0E7UUFDakNBLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLElBQUlBLENBQUNBO0lBQ3BCQSxDQUFDQTtJQUVPViw4QkFBU0EsR0FBakJBLFVBQWtCQSxLQUFLQTtRQUVyQlcsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsS0FBS0EsQ0FBQ0E7SUFDckJBLENBQUNBO0lBRU9YLGdDQUFXQSxHQUFuQkEsVUFBb0JBLEtBQUtBO1FBRXZCWSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNiQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLElBQUVBLEVBQUVBLENBQUNBO1lBQzVCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEVBQUVBLENBQUNBO1lBQzFCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtnQkFDMUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLElBQUVBLEVBQUVBLENBQUNBO1lBQzVCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEVBQUVBLENBQUNBO1lBQzFCQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLElBQUVBLEVBQUVBLENBQUNBO1lBQzVCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEVBQUVBLENBQUNBO1lBQzFCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtnQkFDMUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLElBQUVBLEVBQUVBLENBQUNBO1lBQzVCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFFQSxLQUFLQSxDQUFDQSxPQUFPQSxHQUFDQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQTtnQkFDckNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEVBQUVBLENBQUNBO1lBQzFCQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQTtZQUNqQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsQ0FBQ0EsT0FBT0EsQ0FBQ0E7UUFHckNBLENBQUNBO0lBQ0hBLENBQUNBO0lBRU9aLGlDQUFZQSxHQUFwQkEsVUFBcUJBLEtBQUtBO1FBR3pCYTs7Ozs7OztXQU9HQTtJQUNKQSxDQUFDQTtJQUVPYiw2QkFBUUEsR0FBaEJBLFVBQWlCQSxLQUFZQTtRQUFaYyxxQkFBWUEsR0FBWkEsWUFBWUE7UUFFM0JBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLEdBQVdBLENBQUNBLENBQUNBO1FBQ3pCQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxHQUFXQSxDQUFDQSxDQUFDQTtRQUN6QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsS0FBS0EsR0FBT0EsTUFBTUEsQ0FBQ0EsVUFBVUEsQ0FBQ0E7UUFDekNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQU1BLE1BQU1BLENBQUNBLFdBQVdBLENBQUNBO0lBQzVDQSxDQUFDQTtJQUVIZCxpQkFBQ0E7QUFBREEsQ0EvTkEsQUErTkNBLElBQUE7QUFFRCxNQUFNLENBQUMsTUFBTSxHQUFHO0lBQ2YsSUFBSSxVQUFVLEVBQUUsQ0FBQztBQUNsQixDQUFDLENBQUMiLCJmaWxlIjoiQVdEM1ZpZXdlci5qcyIsInNvdXJjZVJvb3QiOiIuLyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcblxyXG5BV0QzIGZpbGUgbG9hZGluZyBleGFtcGxlIGluIEF3YXlKU1xyXG5cclxuRGVtb25zdHJhdGVzOlxyXG5cclxuSG93IHRvIHVzZSB0aGUgTG9hZGVyIG9iamVjdCB0byBsb2FkIGFuIGVtYmVkZGVkIGludGVybmFsIGF3ZCBtb2RlbC5cclxuXHJcbkNvZGUgYnkgUm9iIEJhdGVtYW5cclxucm9iQGluZmluaXRldHVydGxlcy5jby51a1xyXG5odHRwOi8vd3d3LmluZmluaXRldHVydGxlcy5jby51a1xyXG5cclxuVGhpcyBjb2RlIGlzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgTGljZW5zZVxyXG5cclxuQ29weXJpZ2h0IChjKSBUaGUgQXdheSBGb3VuZGF0aW9uIGh0dHA6Ly93d3cudGhlYXdheWZvdW5kYXRpb24ub3JnXHJcblxyXG5QZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5XHJcbm9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIOKAnFNvZnR3YXJl4oCdKSwgdG8gZGVhbFxyXG5pbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXHJcbnRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcclxuY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXHJcbmZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XHJcblxyXG5UaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpblxyXG5hbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cclxuXHJcblRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCDigJxBUyBJU+KAnSwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxyXG5JTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcclxuRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFXHJcbkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVJcclxuTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcclxuT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTlxyXG5USEUgU09GVFdBUkUuXHJcblxyXG4qL1xyXG5cclxuaW1wb3J0IEFzc2V0TGlicmFyeVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbGlicmFyeS9Bc3NldExpYnJhcnlcIik7XHJcbmltcG9ydCBBc3NldFR5cGVcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2xpYnJhcnkvQXNzZXRUeXBlXCIpO1xyXG5pbXBvcnQgQXNzZXRFdmVudFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL0Fzc2V0RXZlbnRcIik7XHJcbmltcG9ydCBVUkxSZXF1ZXN0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMUmVxdWVzdFwiKTtcclxuaW1wb3J0IExvYWRlckV2ZW50XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvTG9hZGVyRXZlbnRcIik7XHJcbmltcG9ydCBWZWN0b3IzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xyXG5pbXBvcnQgT3J0aG9ncmFwaGljT2ZmQ2VudGVyUHJvamVjdGlvblx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvcHJvamVjdGlvbnMvT3J0aG9ncmFwaGljT2ZmQ2VudGVyUHJvamVjdGlvblwiKTtcclxuaW1wb3J0IE9ydGhvZ3JhcGhpY1Byb2plY3Rpb25cdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3Byb2plY3Rpb25zL09ydGhvZ3JhcGhpY1Byb2plY3Rpb25cIik7XHJcbmltcG9ydCBLZXlib2FyZFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91aS9LZXlib2FyZFwiKTtcclxuaW1wb3J0IFJlcXVlc3RBbmltYXRpb25GcmFtZVx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdXRpbHMvUmVxdWVzdEFuaW1hdGlvbkZyYW1lXCIpO1xyXG5cclxuaW1wb3J0IFZpZXdcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL1ZpZXdcIik7XHJcbmltcG9ydCBNZXNoXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvTWVzaFwiKTtcclxuaW1wb3J0IENvbnRhaW5lclx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvY29udGFpbmVycy9EaXNwbGF5T2JqZWN0Q29udGFpbmVyXCIpO1xyXG5pbXBvcnQgR2VvbWV0cnlcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9HZW9tZXRyeVwiKTtcclxuaW1wb3J0IEhvdmVyQ29udHJvbGxlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRyb2xsZXJzL0hvdmVyQ29udHJvbGxlclwiKTtcclxuaW1wb3J0IExvYWRlclx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL0xvYWRlclwiKTtcclxuaW1wb3J0IENvbG9yTWF0ZXJpYWxcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYXRlcmlhbHMvQmFzaWNNYXRlcmlhbFwiKTtcclxuaW1wb3J0IFJlbmRlcmFibGVOdWxsU29ydFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9zb3J0L1JlbmRlcmFibGVOdWxsU29ydFwiKTtcclxuaW1wb3J0IFByaW1pdGl2ZUN1YmVQcmVmYWJcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDdWJlUHJlZmFiXCIpO1xyXG5cclxuaW1wb3J0IERlZmF1bHRSZW5kZXJlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL0RlZmF1bHRSZW5kZXJlclwiKTtcclxuXHJcbmltcG9ydCBNZXRob2RNYXRlcmlhbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvTWV0aG9kTWF0ZXJpYWxcIik7XHJcbmltcG9ydCBNZXRob2RSZW5kZXJlclBvb2xcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9wb29sL01ldGhvZFJlbmRlcmVyUG9vbFwiKTtcclxuXHJcbmltcG9ydCBBV0RQYXJzZXJcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXBhcnNlcnMvbGliL0FXRFBhcnNlclwiKTtcclxuaW1wb3J0IFBhcnRpdGlvbjJEXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1wbGF5ZXIvbGliL2ZsL3BhcnRpdGlvbi9QYXJ0aXRpb24yRFwiKTtcclxuaW1wb3J0IE1vdmllQ2xpcFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcGxheWVyL2xpYi9mbC9kaXNwbGF5L01vdmllQ2xpcFwiKTtcclxuXHJcbmNsYXNzIEFXRDNWaWV3ZXJcclxue1xyXG4gIC8vZW5naW5lIHZhcmlhYmxlc1xyXG4gIHByaXZhdGUgX3ZpZXc6IFZpZXc7XHJcblxyXG4gIHByaXZhdGUgX3Jvb3RUaW1lTGluZTogTW92aWVDbGlwO1xyXG5cclxuICBwcml2YXRlIF90aW1lcjogUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xyXG4gIHByaXZhdGUgX3RpbWU6IG51bWJlciA9IDA7XHJcblxyXG4gIC8vbmF2aWdhdGlvblxyXG4gIHByaXZhdGUgX2xhc3RNb3VzZVg6IG51bWJlcjtcclxuICBwcml2YXRlIF9sYXN0TW91c2VZOiBudW1iZXI7XHJcbiAgcHJpdmF0ZSBfbW92ZTogYm9vbGVhbjtcclxuXHJcbiAgLyoqXHJcbiAgICogQ29uc3RydWN0b3JcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcigpXHJcbiAge1xyXG4gICAgdGhpcy5pbml0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHbG9iYWwgaW5pdGlhbGlzZSBmdW5jdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgaW5pdCgpOiB2b2lkXHJcbiAge1xyXG4gICAgdGhpcy5pbml0RW5naW5lKCk7XHJcbiAgICB0aGlzLmluaXRPYmplY3RzKCk7XHJcbiAgICB0aGlzLmluaXRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpc2UgdGhlIGVuZ2luZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgaW5pdEVuZ2luZSgpOiB2b2lkXHJcbiAge1xyXG4gICAgLy9jcmVhdGUgdGhlIHZpZXdcclxuICAgIHRoaXMuX3ZpZXcgPSBuZXcgVmlldyhuZXcgRGVmYXVsdFJlbmRlcmVyKE1ldGhvZFJlbmRlcmVyUG9vbCkpO1xyXG4gICAgdGhpcy5fdmlldy5yZW5kZXJlci5yZW5kZXJhYmxlU29ydGVyID0gbmV3IFJlbmRlcmFibGVOdWxsU29ydCgpO1xyXG4gICAgdGhpcy5fdmlldy5iYWNrZ3JvdW5kQ29sb3IgPSAweGZmZmZmZjtcclxuXHJcbiAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnByb2plY3Rpb24gPSBuZXcgT3J0aG9ncmFwaGljUHJvamVjdGlvbig1MDApO1xyXG4gICAgICB0aGlzLl92aWV3LmNhbWVyYS5wcm9qZWN0aW9uLmZhciA9IDUwMDAwMDtcclxuICAgICAgdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbi5uZWFyID0gMC4xO1xyXG4gICAgICB0aGlzLl92aWV3LmNhbWVyYS54PTA7XHJcbiAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnk9MDtcclxuICAgICAgdGhpcy5fdmlldy5jYW1lcmEuej0zMDA7XHJcbiAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnJvdGF0aW9uWD0tMTgwO1xyXG4gICAgICB0aGlzLl92aWV3LmNhbWVyYS5yb3RhdGlvblk9MDtcclxuICAgICAgdGhpcy5fdmlldy5jYW1lcmEucm90YXRpb25aPS0xODA7XHJcbiAgICAvL2NyZWF0ZSBjdXN0b20gbGVuc1xyXG4gICAvLyB0aGlzLl92aWV3LmNhbWVyYS5wcm9qZWN0aW9uID0gbmV3IE9ydGhvZ3JhcGhpY09mZkNlbnRlclByb2plY3Rpb24oMCwgNTUwLCAtNDAwLCAwKTtcclxuICAvLyAgdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbi5mYXIgPSA1MDAwMDA7XHJcbiAgLy8gIHRoaXMuX3ZpZXcuY2FtZXJhLnByb2plY3Rpb24ubmVhciA9IDAuMTtcclxuXHJcbi8qXHJcbiAgICAvL3NldHVwIGNvbnRyb2xsZXIgdG8gYmUgdXNlZCBvbiB0aGUgY2FtZXJhXHJcbiAgICB0aGlzLl9jYW1lcmFDb250cm9sbGVyID0gbmV3IEhvdmVyQ29udHJvbGxlcih0aGlzLl92aWV3LmNhbWVyYSwgbnVsbCwgMCwgMCwgMzAwLCAxMCwgOTApO1xyXG4gICAgdGhpcy5fY2FtZXJhQ29udHJvbGxlci5sb29rQXRQb3NpdGlvbiA9IG5ldyBWZWN0b3IzRCgwLCA1MCwgMCk7XHJcbiAgICB0aGlzLl9jYW1lcmFDb250cm9sbGVyLnRpbHRBbmdsZSA9IDA7XHJcbiAgICB0aGlzLl9jYW1lcmFDb250cm9sbGVyLnBhbkFuZ2xlID0gMDtcclxuICAgIHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIubWluVGlsdEFuZ2xlID0gNTtcclxuICAgIHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIubWF4VGlsdEFuZ2xlID0gNjA7XHJcbiAgICB0aGlzLl9jYW1lcmFDb250cm9sbGVyLmF1dG9VcGRhdGUgPSBmYWxzZTtcclxuKi9cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpc2UgdGhlIHNjZW5lIG9iamVjdHNcclxuICAgKi9cclxuICBwcml2YXRlIGluaXRPYmplY3RzKCk6IHZvaWRcclxuICB7XHJcbiAgICBBc3NldExpYnJhcnkuZW5hYmxlUGFyc2VyKEFXRFBhcnNlcik7XHJcblxyXG4gICAgLy9raWNrb2ZmIGFzc2V0IGxvYWRpbmdcclxuICAgIHZhciBsb2FkZXI6TG9hZGVyID0gbmV3IExvYWRlcigpO1xyXG4gICAgbG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoQXNzZXRFdmVudC5BU1NFVF9DT01QTEVURSwgKGV2ZW50OiBBc3NldEV2ZW50KSA9PiB0aGlzLm9uQXNzZXRDb21wbGV0ZShldmVudCkpO1xyXG4gICAgbG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoTG9hZGVyRXZlbnQuUkVTT1VSQ0VfQ09NUExFVEUsIChldmVudDogTG9hZGVyRXZlbnQpID0+IHRoaXMub25SZXNzb3VyY2VDb21wbGV0ZShldmVudCkpO1xyXG5cclxuXHJcbiAgICAvL2xvYWRlci5sb2FkKG5ldyBVUkxSZXF1ZXN0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXdkUGF0aFwiKS5pbm5lckhUTUwpKTtcclxuICAgIGxvYWRlci5sb2FkKG5ldyBVUkxSZXF1ZXN0KFwiYXNzZXRzL0FXRDMvU2NhcmVDcm93LmF3ZFwiKSk7XHJcbiAgICAvL2xvYWRlci5sb2FkKG5ldyBVUkxSZXF1ZXN0KFwiYXNzZXRzL0FXRDMvTmVzdGVkVHdlZW4uYXdkXCIpKTtcclxuICAgIC8vbG9hZGVyLmxvYWQobmV3IFVSTFJlcXVlc3QoXCJhc3NldHMvQVdEMy9TaW1wbGVTaGFwZS5hd2RcIikpO1xyXG4gICAgLy9sb2FkZXIubG9hZChuZXcgVVJMUmVxdWVzdChcImFzc2V0cy9BV0QzL0NvbXBsZXhTaGFwZS5hd2RcIikpO1xyXG4gICAgLy9sb2FkZXIubG9hZChuZXcgVVJMUmVxdWVzdChcImFzc2V0cy9BV0QzL1NpbXBsZV9tYXNrX3Rlc3QuYXdkXCIpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpc2UgdGhlIGxpc3RlbmVyc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgaW5pdExpc3RlbmVycygpOiB2b2lkXHJcbiAge1xyXG4gICAgd2luZG93Lm9ucmVzaXplICA9IChldmVudCkgPT4gdGhpcy5vblJlc2l6ZShldmVudCk7XHJcblxyXG4gICAgICBkb2N1bWVudC5vbmtleWRvd24gPSAoZXZlbnQpID0+IHRoaXMub25LZXlEb3duKGV2ZW50KTtcclxuICAgIGRvY3VtZW50Lm9ubW91c2Vkb3duID0gKGV2ZW50KSA9PiB0aGlzLm9uTW91c2VEb3duKGV2ZW50KTtcclxuICAgIGRvY3VtZW50Lm9ubW91c2V1cCA9IChldmVudCkgPT4gdGhpcy5vbk1vdXNlVXAoZXZlbnQpO1xyXG4gICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSAoZXZlbnQpID0+IHRoaXMub25Nb3VzZU1vdmUoZXZlbnQpO1xyXG4gICAgZG9jdW1lbnQub25tb3VzZXdoZWVsID0gKGV2ZW50KSA9PiB0aGlzLm9uTW91c2VXaGVlbChldmVudCk7XHJcblxyXG4gICAgdGhpcy5vblJlc2l6ZSgpO1xyXG5cclxuICAgIHRoaXMuX3RpbWVyID0gbmV3IFJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLm9uRW50ZXJGcmFtZSwgdGhpcyk7XHJcbiAgICB0aGlzLl90aW1lci5zdGFydCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbG9hZGVyIGxpc3RlbmVyIGZvciBhc3NldCBjb21wbGV0ZSBldmVudHNcclxuICAgKi9cclxuICBwcml2YXRlIG9uQXNzZXRDb21wbGV0ZShldmVudDogQXNzZXRFdmVudCk6IHZvaWRcclxuICB7XHJcbiAgICBpZihldmVudC5hc3NldC5hc3NldFR5cGUgPT0gQXNzZXRUeXBlLlRJTUVMSU5FKSB7XHJcbiAgICAgIHRoaXMuX3Jvb3RUaW1lTGluZSA9IDxNb3ZpZUNsaXA+IGV2ZW50LmFzc2V0O1xyXG4gICAgICAgIHRoaXMuX3Jvb3RUaW1lTGluZS5wYXJ0aXRpb24gPSBuZXcgUGFydGl0aW9uMkQodGhpcy5fcm9vdFRpbWVMaW5lKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIGxvYWRlciBsaXN0ZW5lciBmb3IgYXNzZXQgY29tcGxldGUgZXZlbnRzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvblJlc3NvdXJjZUNvbXBsZXRlKGV2ZW50OiBMb2FkZXJFdmVudCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuX3Jvb3RUaW1lTGluZSkge1xyXG4gICAgICAvL2NvbnNvbGUubG9nKFwiTE9BRElORyBBIFJPT1QgbmFtZSA9IFwiICsgdGhpcy5fcm9vdFRpbWVMaW5lLm5hbWUgKyBcIiBkdXJhdGlvbj1cIiArIHRoaXMuX3Jvb3RUaW1lTGluZS5kdXJhdGlvbik7XHJcbiAgICAgIHRoaXMuX3ZpZXcuc2NlbmUuYWRkQ2hpbGQodGhpcy5fcm9vdFRpbWVMaW5lKTtcclxuICAgICAgLy8gYXV0b3BsYXkgbGlrZSBpbiBGbGFzaFxyXG4gICAgICAvL3RoaXMuX3Jvb3RUaW1lTGluZS5wbGF5KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW5kZXIgbG9vcFxyXG4gICAqL1xyXG4gIHByaXZhdGUgb25FbnRlckZyYW1lKGR0OiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHRoaXMuX3RpbWUgKz0gZHQ7XHJcblxyXG4gICAgLy91cGRhdGUgY2FtZXJhIGNvbnRyb2xlclxyXG4gICAvLyB0aGlzLl9jYW1lcmFDb250cm9sbGVyLnVwZGF0ZSgpO1xyXG5cclxuICAgIGlmICh0aGlzLl9yb290VGltZUxpbmUgIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIC8vY29uc29sZS5sb2coXCJSRU5ERVIgPSBcIik7XHJcbiAgICAgIHRoaXMuX3Jvb3RUaW1lTGluZS51cGRhdGUoZHQpO1xyXG4gICAgfVxyXG4gICAgLy9jb25zb2xlLmxvZyhcIlJFTkRFUiA9IFwiKTtcclxuICAgIC8vdXBkYXRlIHZpZXdcclxuICAgIHRoaXMuX3ZpZXcucmVuZGVyKCk7XHJcbiAgfVxyXG5cclxuICAgIHByaXZhdGUgb25LZXlEb3duKGV2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgaWYoZXZlbnQua2V5Q29kZT09MTA5KXtcclxuICAgICAgICAgICAgdmFyIHRlc3Q6T3J0aG9ncmFwaGljUHJvamVjdGlvbiA9IDxPcnRob2dyYXBoaWNQcm9qZWN0aW9uPiB0aGlzLl92aWV3LmNhbWVyYS5wcm9qZWN0aW9uO1xyXG4gICAgICAgICAgICB0ZXN0LnByb2plY3Rpb25IZWlnaHQrPTU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoZXZlbnQua2V5Q29kZT09MTA3KXtcclxuICAgICAgICAgICAgdmFyIHRlc3Q6T3J0aG9ncmFwaGljUHJvamVjdGlvbiA9IDxPcnRob2dyYXBoaWNQcm9qZWN0aW9uPiB0aGlzLl92aWV3LmNhbWVyYS5wcm9qZWN0aW9uO1xyXG4gICAgICAgICAgICB0ZXN0LnByb2plY3Rpb25IZWlnaHQtPTU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICBwcml2YXRlIG9uTW91c2VEb3duKGV2ZW50KTogdm9pZFxyXG4gIHtcclxuICAvKiAgdGhpcy5fbGFzdFBhbkFuZ2xlID0gdGhpcy5fY2FtZXJhQ29udHJvbGxlci5wYW5BbmdsZTtcclxuICAgIHRoaXMuX2xhc3RUaWx0QW5nbGUgPSB0aGlzLl9jYW1lcmFDb250cm9sbGVyLnRpbHRBbmdsZTtcclxuICAgIHRoaXMuX21vdmUgPSB0cnVlOyovXHJcbiAgICB0aGlzLl9sYXN0TW91c2VYID0gZXZlbnQuY2xpZW50WDtcclxuICAgIHRoaXMuX2xhc3RNb3VzZVkgPSBldmVudC5jbGllbnRZO1xyXG4gICAgdGhpcy5fbW92ZSA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uTW91c2VVcChldmVudCk6IHZvaWRcclxuICB7XHJcbiAgICB0aGlzLl9tb3ZlID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uTW91c2VNb3ZlKGV2ZW50KVxyXG4gIHtcclxuICAgIGlmICh0aGlzLl9tb3ZlKSB7XHJcbiAgICAgICAgaWYgKCBldmVudC5jbGllbnRYPih0aGlzLl9sYXN0TW91c2VYKzEwKSlcclxuICAgICAgICAgICAgdGhpcy5fdmlldy5jYW1lcmEueCs9MTA7XHJcbiAgICAgICAgZWxzZSBpZiAoIGV2ZW50LmNsaWVudFg+dGhpcy5fbGFzdE1vdXNlWClcclxuICAgICAgICAgICAgdGhpcy5fdmlldy5jYW1lcmEueCsrO1xyXG4gICAgICAgIGVsc2UgaWYgKCBldmVudC5jbGllbnRYPCh0aGlzLl9sYXN0TW91c2VYLTEwKSlcclxuICAgICAgICAgICAgdGhpcy5fdmlldy5jYW1lcmEueC09MTA7XHJcbiAgICAgICAgZWxzZSBpZiAoIGV2ZW50LmNsaWVudFg8dGhpcy5fbGFzdE1vdXNlWClcclxuICAgICAgICAgICAgdGhpcy5fdmlldy5jYW1lcmEueC0tO1xyXG4gICAgICAgIGlmICggZXZlbnQuY2xpZW50WT4odGhpcy5fbGFzdE1vdXNlWSsxMCkpXHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnkrPTEwO1xyXG4gICAgICAgIGVsc2UgaWYgKCBldmVudC5jbGllbnRZPnRoaXMuX2xhc3RNb3VzZVkpXHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnkrKztcclxuICAgICAgICBlbHNlIGlmICggZXZlbnQuY2xpZW50WTwodGhpcy5fbGFzdE1vdXNlWS0xMCkpXHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnktPTEwO1xyXG4gICAgICAgIGVsc2UgaWYgKCBldmVudC5jbGllbnRZPHRoaXMuX2xhc3RNb3VzZVkpXHJcbiAgICAgICAgICAgIHRoaXMuX3ZpZXcuY2FtZXJhLnktLTtcclxuICAgICAgICB0aGlzLl9sYXN0TW91c2VYID0gZXZlbnQuY2xpZW50WDtcclxuICAgICAgICB0aGlzLl9sYXN0TW91c2VZID0gZXZlbnQuY2xpZW50WTtcclxuICAgICAgLy90aGlzLl9jYW1lcmFDb250cm9sbGVyLnBhbkFuZ2xlID0gMC4zKihldmVudC5jbGllbnRYIC0gdGhpcy5fbGFzdE1vdXNlWCkgKyB0aGlzLl9sYXN0UGFuQW5nbGU7XHJcbiAgICAgIC8vdGhpcy5fY2FtZXJhQ29udHJvbGxlci50aWx0QW5nbGUgPSAwLjMqKGV2ZW50LmNsaWVudFkgLSB0aGlzLl9sYXN0TW91c2VZKSArIHRoaXMuX2xhc3RUaWx0QW5nbGU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG9uTW91c2VXaGVlbChldmVudCk6IHZvaWRcclxuICB7XHJcblxyXG4gICAvKiB0aGlzLl9jYW1lcmFDb250cm9sbGVyLmRpc3RhbmNlIC09IGV2ZW50LndoZWVsRGVsdGEgKiA1O1xyXG5cclxuICAgIGlmICh0aGlzLl9jYW1lcmFDb250cm9sbGVyLmRpc3RhbmNlIDwgMTAwKSB7XHJcbiAgICAgIHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuZGlzdGFuY2UgPSAxMDA7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuZGlzdGFuY2UgPiAyMDAwKSB7XHJcbiAgICAgIHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuZGlzdGFuY2UgPSAyMDAwO1xyXG4gICAgfVxyXG4gICAgKi9cclxuICB9XHJcblxyXG4gIHByaXZhdGUgb25SZXNpemUoZXZlbnQgPSBudWxsKTogdm9pZFxyXG4gIHtcclxuICAgIHRoaXMuX3ZpZXcueSAgICAgICAgID0gMDtcclxuICAgIHRoaXMuX3ZpZXcueCAgICAgICAgID0gMDtcclxuICAgIHRoaXMuX3ZpZXcud2lkdGggICAgID0gd2luZG93LmlubmVyV2lkdGg7XHJcbiAgICB0aGlzLl92aWV3LmhlaWdodCAgICA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuICB9XHJcblxyXG59XHJcblxyXG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cdG5ldyBBV0QzVmlld2VyKCk7XHJcbn07XHJcbiJdfQ==